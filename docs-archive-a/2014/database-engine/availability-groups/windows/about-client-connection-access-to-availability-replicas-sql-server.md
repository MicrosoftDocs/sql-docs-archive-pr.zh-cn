---
title: 关于对可用性副本的客户端连接访问 (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], readable secondary replicas
- active secondary replicas [SQL Server], read-only access to
- Availability Groups [SQL Server], configuring
- Availability Groups [SQL Server], client connectivity
- Availability Groups [SQL Server], active secondary replicas
ms.assetid: 29027e46-43e4-4b45-b650-c4cdeacdf552
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 79e61f29957d90a429d8a0c66782ca7cf2e7bd4c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87690160"
---
# <a name="about-client-connection-access-to-availability-replicas-sql-server"></a><span data-ttu-id="836b9-102">关于对可用性副本的客户端连接访问 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="836b9-102">About Client Connection Access to Availability Replicas (SQL Server)</span></span>
  <span data-ttu-id="836b9-103">在 AlwaysOn 可用性组中，您可以配置一个或多个可用性副本，以便在辅助角色下运行时（即作为辅助副本运行时）允许只读连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-103">In an AlwaysOn availability group, you can configure one or more availability replicas to allow read-only connections when running under the secondary role (that is, when running as a secondary replica).</span></span> <span data-ttu-id="836b9-104">还可以将每个可用性副本配置为在主角色下运行时（即作为主副本运行时）允许或排除只读连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-104">You can also configure each availability replica to allow or exclude read-only connections when running under the primary role (that is, when running as the primary replica).</span></span>  
  
 <span data-ttu-id="836b9-105">为了便于客户端访问给定可用性组的主数据库或辅助数据库，您应该定义可用性组侦听器。</span><span class="sxs-lookup"><span data-stu-id="836b9-105">To facilitate client access to primary or secondary databases of a given availability group, you should define an availability group listener.</span></span> <span data-ttu-id="836b9-106">默认情况下，可用性组侦听器将传入连接定向到主副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-106">By default, the availability group listener directs incoming connections to the primary replica.</span></span> <span data-ttu-id="836b9-107">不过，您可以对可用性组进行配置以便支持只读路由，这使其可用性组侦听器能够将读意向应用程序的连接请求重定向到可读取的辅助副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-107">However, you can configure an availability group to support read-only routing, which enables its availability group listener to redirect the connection requests of read-intent applications to a readable secondary replica.</span></span> <span data-ttu-id="836b9-108">有关详细信息，请参阅 [为可用性组配置只读路由 (SQL Server)](configure-read-only-routing-for-an-availability-group-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-108">For more information, see [Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md).</span></span>  
  
 <span data-ttu-id="836b9-109">在故障转移期间，辅助副本转换为主角色，以前的主副本转换为辅助角色。</span><span class="sxs-lookup"><span data-stu-id="836b9-109">During a failover, a secondary replica transitions to the primary role and the former primary replica transitions to the secondary role.</span></span> <span data-ttu-id="836b9-110">在故障转移过程中，所有到主副本或辅助副本的客户端连接都将终止。</span><span class="sxs-lookup"><span data-stu-id="836b9-110">During the failover process, all client connections to both the primary replica and secondary replicas are terminated.</span></span> <span data-ttu-id="836b9-111">故障转移之后，在将客户端重新连接到可用性组侦听器时，侦听器将客户端重新连接到新的主副本，只有读意向连接请求除外。</span><span class="sxs-lookup"><span data-stu-id="836b9-111">After the failover, when a client reconnects to the availability group listener, the listener reconnects the client to the new primary replica, except for a read-intent connect request.</span></span> <span data-ttu-id="836b9-112">如果在承载新的主副本以及至少一个可读取辅助副本的客户端和服务器实例上配置了只读路由，则读意向连接请求将被重新路由到支持客户端要求的连接访问类型的辅助副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-112">If read-only routing is configured on the client and on the server instances that hosts the new primary replica and on at least one readable secondary replica, read-intent connection requests are re-routed to a secondary replica that supports the type of connection access that the client requires.</span></span> <span data-ttu-id="836b9-113">若要确保在故障转移之后获得良好的客户端体验，务必为每个可用性副本的辅助角色和主角色配置连接访问。</span><span class="sxs-lookup"><span data-stu-id="836b9-113">To ensure a graceful client experience after a failover, it is important to configure connection access for both the secondary and primary roles of every availability replica.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="836b9-114">有关处理客户端连接请求的可用性组侦听程序的信息，请参阅 [可用性组侦听程序、客户端连接和应用程序故障转移 (SQL Server)](../../listeners-client-connectivity-application-failover.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-114">For information about the availability group listener, which handles client connection requests, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
 <span data-ttu-id="836b9-115">**本主题内容：**</span><span class="sxs-lookup"><span data-stu-id="836b9-115">**In This Topic:**</span></span>  
  
-   [<span data-ttu-id="836b9-116">辅助角色支持的连接访问类型</span><span class="sxs-lookup"><span data-stu-id="836b9-116">Types of Connection Access Supported by the Secondary Role</span></span>](#ConnectAccessForSecondary)  
  
-   [<span data-ttu-id="836b9-117">主角色支持的连接访问类型</span><span class="sxs-lookup"><span data-stu-id="836b9-117">Types of Connection Access Supported by the Primary Role</span></span>](#ConnectAccessForPrimary)  
  
-   [<span data-ttu-id="836b9-118">连接访问配置如何影响客户端连接</span><span class="sxs-lookup"><span data-stu-id="836b9-118">How the Connection Access Configuration Affects Client Connectivity</span></span>](#HowConnectionAccessAffectsConnectivity)  
  
-   [<span data-ttu-id="836b9-119">相关任务</span><span class="sxs-lookup"><span data-stu-id="836b9-119">Related Tasks</span></span>](#RelatedTasks)  
  
-   [<span data-ttu-id="836b9-120">相关内容</span><span class="sxs-lookup"><span data-stu-id="836b9-120">Related Content</span></span>](#RelatedContent)  
  
##  <a name="types-of-connection-access-supported-by-the-secondary-role"></a><a name="ConnectAccessForSecondary"></a> <span data-ttu-id="836b9-121">辅助角色支持的连接访问类型</span><span class="sxs-lookup"><span data-stu-id="836b9-121">Types of Connection Access Supported by the Secondary Role</span></span>  
 <span data-ttu-id="836b9-122">辅助角色对于客户端连接支持三种备选方式，如下所示：</span><span class="sxs-lookup"><span data-stu-id="836b9-122">The secondary role supports three alternatives for client connections, as follows:</span></span>  
  
 <span data-ttu-id="836b9-123">无连接</span><span class="sxs-lookup"><span data-stu-id="836b9-123">No connections</span></span>  
 <span data-ttu-id="836b9-124">不允许任何用户连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-124">No user connections are allowed.</span></span> <span data-ttu-id="836b9-125">辅助数据库不可用于读访问。</span><span class="sxs-lookup"><span data-stu-id="836b9-125">Secondary databases are not available for read access.</span></span> <span data-ttu-id="836b9-126">这是辅助角色中的默认行为。</span><span class="sxs-lookup"><span data-stu-id="836b9-126">This is the default behavior in the secondary role.</span></span>  
  
 <span data-ttu-id="836b9-127">仅读意向连接</span><span class="sxs-lookup"><span data-stu-id="836b9-127">Only read-intent connections</span></span>  
 <span data-ttu-id="836b9-128">辅助数据库 () 仅可用于 `Application Intent` 连接属性设置为 `ReadOnly` (*读意向连接*) 的连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-128">The secondary database(s) are available only for connection for which the `Application Intent` connection property is set to `ReadOnly` (*read-intent connections*).</span></span>  
  
 <span data-ttu-id="836b9-129">有关此连接属性的信息，请参阅 [对高可用性、灾难恢复的 SQL Server Native Client 支持](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-129">For information about this connection property, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
 <span data-ttu-id="836b9-130">允许任何只读连接</span><span class="sxs-lookup"><span data-stu-id="836b9-130">Allow any read-only connection</span></span>  
 <span data-ttu-id="836b9-131">辅助数据库全部可用于读访问连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-131">The secondary database(s) are all available for read access connections.</span></span> <span data-ttu-id="836b9-132">此选项允许较低版本的客户端进行连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-132">This option allows lower versioned clients to connect.</span></span>  
  
 <span data-ttu-id="836b9-133">有关详细信息，请参阅 [配置对可用性副本的只读访问 (SQL Server)](configure-read-only-access-on-an-availability-replica-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-133">For more information, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md).</span></span>  
  
##  <a name="types-of-connection-access-supported-by-the-primary-role"></a><a name="ConnectAccessForPrimary"></a> <span data-ttu-id="836b9-134">主角色支持的连接访问类型</span><span class="sxs-lookup"><span data-stu-id="836b9-134">Types of Connection Access Supported by the Primary Role</span></span>  
 <span data-ttu-id="836b9-135">主角色对于客户端连接支持两种备选方式，如下所示：</span><span class="sxs-lookup"><span data-stu-id="836b9-135">The primary role supports two alternatives for client connections, as follows:</span></span>  
  
 <span data-ttu-id="836b9-136">允许所有连接</span><span class="sxs-lookup"><span data-stu-id="836b9-136">All connections are allowed</span></span>  
 <span data-ttu-id="836b9-137">主数据库同时允许读写连接和只读连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-137">Both read-write and read-only connections are allowed to primary databases.</span></span> <span data-ttu-id="836b9-138">这是主角色的默认行为。</span><span class="sxs-lookup"><span data-stu-id="836b9-138">This is the default behavior for the primary role.</span></span>  
  
 <span data-ttu-id="836b9-139">仅允许读/写连接</span><span class="sxs-lookup"><span data-stu-id="836b9-139">Allow only read-write connections</span></span>  
 <span data-ttu-id="836b9-140">如果 `Application Intent` 连接属性设置为**ReadWrite**或未设置，则允许连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-140">When the `Application Intent` connection property is set to **ReadWrite** or is not set, the connection is allowed.</span></span> <span data-ttu-id="836b9-141">`Application Intent`不允许连接字符串关键字设置为的连接 `ReadOnly` 。</span><span class="sxs-lookup"><span data-stu-id="836b9-141">Connections for which the `Application Intent` connection string keyword is set to `ReadOnly` are not allowed.</span></span> <span data-ttu-id="836b9-142">仅允许读写连接可帮助防止您的客户错误地将读意向工作负荷连接到主副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-142">Allowing only read-write connections can help prevent your customers from connecting a read-intent work load to the primary replica by mistake.</span></span>  
  
 <span data-ttu-id="836b9-143">有关此连接属性的信息，请参阅 [Using Connection String Keywords with SQL Server Native Client](../../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-143">For information about this connection property, see [Using Connection String Keywords with SQL Server Native Client](../../../relational-databases/native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="836b9-144">有关详细信息，请参阅 [配置对可用性副本的只读访问 (SQL Server)](configure-read-only-access-on-an-availability-replica-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-144">For more information, see [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md).</span></span>  
  
##  <a name="how-the-connection-access-configuration-affects-client-connectivity"></a><a name="HowConnectionAccessAffectsConnectivity"></a> <span data-ttu-id="836b9-145">连接访问配置如何影响客户端连接</span><span class="sxs-lookup"><span data-stu-id="836b9-145">How the Connection Access Configuration Affects Client Connectivity</span></span>  
 <span data-ttu-id="836b9-146">副本的连接访问设置决定连接尝试是失败还是成功。</span><span class="sxs-lookup"><span data-stu-id="836b9-146">The connection access settings of a replica determine whether a connection attempt fails or succeeds.</span></span> <span data-ttu-id="836b9-147">下表简要说明对于每个连接访问设置，给定连接尝试是失败还是成功。</span><span class="sxs-lookup"><span data-stu-id="836b9-147">The following table summarizes whether a given connection attempt succeeds or fails for each the connection-access setting.</span></span>  
  
|<span data-ttu-id="836b9-148">副本角色</span><span class="sxs-lookup"><span data-stu-id="836b9-148">Replica Role</span></span>|<span data-ttu-id="836b9-149">副本上支持的连接访问</span><span class="sxs-lookup"><span data-stu-id="836b9-149">Connection Access Supported on Replica</span></span>|<span data-ttu-id="836b9-150">连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-150">Connection Intent</span></span>|<span data-ttu-id="836b9-151">连接尝试结果</span><span class="sxs-lookup"><span data-stu-id="836b9-151">Connection-Attempt Result</span></span>|  
|------------------|--------------------------------------------|-----------------------|--------------------------------|  
|<span data-ttu-id="836b9-152">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-152">Secondary</span></span>|<span data-ttu-id="836b9-153">全部</span><span class="sxs-lookup"><span data-stu-id="836b9-153">All</span></span>|<span data-ttu-id="836b9-154">指定了读意向、读写意向或未指定连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-154">Read-intent, read-write, or no connection intent specified</span></span>|<span data-ttu-id="836b9-155">Success</span><span class="sxs-lookup"><span data-stu-id="836b9-155">Success</span></span>|  
|<span data-ttu-id="836b9-156">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-156">Secondary</span></span>|<span data-ttu-id="836b9-157">无（这是默认辅助行为。）</span><span class="sxs-lookup"><span data-stu-id="836b9-157">None (This is the default secondary behavior.)</span></span>|<span data-ttu-id="836b9-158">指定了读意向、读写意向或未指定连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-158">Read-intent, read-write, or no connection intent specified</span></span>|<span data-ttu-id="836b9-159">失败</span><span class="sxs-lookup"><span data-stu-id="836b9-159">Failure</span></span>|  
|<span data-ttu-id="836b9-160">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-160">Secondary</span></span>|<span data-ttu-id="836b9-161">仅限读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-161">Read-intent only</span></span>|<span data-ttu-id="836b9-162">读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-162">Read-intent</span></span>|<span data-ttu-id="836b9-163">Success</span><span class="sxs-lookup"><span data-stu-id="836b9-163">Success</span></span>|  
|<span data-ttu-id="836b9-164">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-164">Secondary</span></span>|<span data-ttu-id="836b9-165">仅限读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-165">Read-intent only</span></span>|<span data-ttu-id="836b9-166">指定了读写意向或未指定连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-166">Read-write or no connection intent specified</span></span>|<span data-ttu-id="836b9-167">失败</span><span class="sxs-lookup"><span data-stu-id="836b9-167">Failure</span></span>|  
|<span data-ttu-id="836b9-168">主要</span><span class="sxs-lookup"><span data-stu-id="836b9-168">Primary</span></span>|<span data-ttu-id="836b9-169">所有（这是默认主要行为。）</span><span class="sxs-lookup"><span data-stu-id="836b9-169">All (This is the default primary behavior.)</span></span>|<span data-ttu-id="836b9-170">指定了只读意向、读写意向或未指定连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-170">Read-only, read-write, or no connection intent specified</span></span>|<span data-ttu-id="836b9-171">Success</span><span class="sxs-lookup"><span data-stu-id="836b9-171">Success</span></span>|  
|<span data-ttu-id="836b9-172">主要</span><span class="sxs-lookup"><span data-stu-id="836b9-172">Primary</span></span>|<span data-ttu-id="836b9-173">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-173">Read-write</span></span>|<span data-ttu-id="836b9-174">仅限读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-174">Read-intent only</span></span>|<span data-ttu-id="836b9-175">失败</span><span class="sxs-lookup"><span data-stu-id="836b9-175">Failure</span></span>|  
|<span data-ttu-id="836b9-176">主要</span><span class="sxs-lookup"><span data-stu-id="836b9-176">Primary</span></span>|<span data-ttu-id="836b9-177">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-177">Read-write</span></span>|<span data-ttu-id="836b9-178">指定了读写意向或未指定连接意向</span><span class="sxs-lookup"><span data-stu-id="836b9-178">Read-write or no connection intent specified</span></span>|<span data-ttu-id="836b9-179">Success</span><span class="sxs-lookup"><span data-stu-id="836b9-179">Success</span></span>|  
  
 <span data-ttu-id="836b9-180">有关配置可用性组接受到其副本的客户端连接的信息，请参阅， [可用性组侦听程序、客户端连接和应用程序故障转移 (SQL Server)](../../listeners-client-connectivity-application-failover.md)。</span><span class="sxs-lookup"><span data-stu-id="836b9-180">For information about configuring an availability group to accept client connections to its replicas, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
### <a name="example-connection-access-configuration"></a><span data-ttu-id="836b9-181">连接访问配置示例</span><span class="sxs-lookup"><span data-stu-id="836b9-181">Example Connection-Access Configuration</span></span>  
 <span data-ttu-id="836b9-182">根据将不同可用性副本配置为进行连接访问的方式，在可用性组故障转移之后，对于客户端连接的支持可能会有所变化。</span><span class="sxs-lookup"><span data-stu-id="836b9-182">Depending on how different availability replicas are configured for connection access, support for client connections might change after an availability group fails over.</span></span> <span data-ttu-id="836b9-183">例如，请考虑要在远程异步提交辅助副本上对其执行报告的一个可用性组。</span><span class="sxs-lookup"><span data-stu-id="836b9-183">For example, consider an availability group for which reporting is performed on remote asynchronous-commit secondary replicas.</span></span> <span data-ttu-id="836b9-184">此可用性组中数据库的所有只读应用程序都会将其 `Application Intent` 连接属性设置为 `ReadOnly`，以使所有只读连接为读意向连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-184">All of the read-only applications for the databases in this availability group set their `Application Intent` connection property to `ReadOnly`, so that all read-only connections are read-intent connections.</span></span>  
  
 <span data-ttu-id="836b9-185">在本例中，可用性组在主计算中心具有两个同步提交副本，在附属站点拥有两个异步提交副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-185">This example availability group possesses two synchronous-commit replicas at the main computing center and two asynchronous-commit replicas at a satellite site.</span></span> <span data-ttu-id="836b9-186">对于主角色，所有副本都配置为允许读写访问，这样，在所有情况下可防止与主副本进行读意向连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-186">For the primary role, all the replicas are configured for read-write access, which prevents read-intent connections to the primary replica in all situations.</span></span> <span data-ttu-id="836b9-187">同步提交辅助角色使用默认连接访问配置（“无”），这样可以防止在辅助角色下进行的所有客户端连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-187">The synchronous commit secondary role uses the default connection-access configuration ("none"), which prevents all client connections under the secondary role.</span></span>  <span data-ttu-id="836b9-188">与此相反，异步提交副本配置为允许在辅助角色下进行读意向连接。</span><span class="sxs-lookup"><span data-stu-id="836b9-188">In contrast, the asynchronous commit replicas are configured to permit read-intent connections under the secondary role.</span></span> <span data-ttu-id="836b9-189">下表概述了该示例配置：</span><span class="sxs-lookup"><span data-stu-id="836b9-189">The following table summarize this example configuration:</span></span>  
  
|<span data-ttu-id="836b9-190">副本</span><span class="sxs-lookup"><span data-stu-id="836b9-190">Replica</span></span>|<span data-ttu-id="836b9-191">提交模式</span><span class="sxs-lookup"><span data-stu-id="836b9-191">Commit Mode</span></span>|<span data-ttu-id="836b9-192">初始角色</span><span class="sxs-lookup"><span data-stu-id="836b9-192">Initial Role</span></span>|<span data-ttu-id="836b9-193">辅助角色的连接访问</span><span class="sxs-lookup"><span data-stu-id="836b9-193">Connection Access for Secondary Role</span></span>|<span data-ttu-id="836b9-194">主角色的连接访问</span><span class="sxs-lookup"><span data-stu-id="836b9-194">Connection Access for Primary Role</span></span>|  
|-------------|-----------------|------------------|------------------------------------------|----------------------------------------|  
|<span data-ttu-id="836b9-195">Replica1</span><span class="sxs-lookup"><span data-stu-id="836b9-195">Replica1</span></span>|<span data-ttu-id="836b9-196">同步</span><span class="sxs-lookup"><span data-stu-id="836b9-196">Synchronous</span></span>|<span data-ttu-id="836b9-197">主要</span><span class="sxs-lookup"><span data-stu-id="836b9-197">Primary</span></span>|<span data-ttu-id="836b9-198">无</span><span class="sxs-lookup"><span data-stu-id="836b9-198">None</span></span>|<span data-ttu-id="836b9-199">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-199">Read-write</span></span>|  
|<span data-ttu-id="836b9-200">Replica2</span><span class="sxs-lookup"><span data-stu-id="836b9-200">Replica2</span></span>|<span data-ttu-id="836b9-201">Synchronous</span><span class="sxs-lookup"><span data-stu-id="836b9-201">Synchronous</span></span>|<span data-ttu-id="836b9-202">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-202">Secondary</span></span>|<span data-ttu-id="836b9-203">无</span><span class="sxs-lookup"><span data-stu-id="836b9-203">None</span></span>|<span data-ttu-id="836b9-204">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-204">Read-write</span></span>|  
|<span data-ttu-id="836b9-205">Replica3</span><span class="sxs-lookup"><span data-stu-id="836b9-205">Replica3</span></span>|<span data-ttu-id="836b9-206">异步</span><span class="sxs-lookup"><span data-stu-id="836b9-206">Asynchronous</span></span>|<span data-ttu-id="836b9-207">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-207">Secondary</span></span>|<span data-ttu-id="836b9-208">仅读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-208">Read-intentonly</span></span>|<span data-ttu-id="836b9-209">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-209">Read-write</span></span>|  
|<span data-ttu-id="836b9-210">Replica4</span><span class="sxs-lookup"><span data-stu-id="836b9-210">Replica4</span></span>|<span data-ttu-id="836b9-211">异步</span><span class="sxs-lookup"><span data-stu-id="836b9-211">Asynchronous</span></span>|<span data-ttu-id="836b9-212">辅助副本</span><span class="sxs-lookup"><span data-stu-id="836b9-212">Secondary</span></span>|<span data-ttu-id="836b9-213">仅限读意向</span><span class="sxs-lookup"><span data-stu-id="836b9-213">Read-intent only</span></span>|<span data-ttu-id="836b9-214">读写</span><span class="sxs-lookup"><span data-stu-id="836b9-214">Read-write</span></span>|  
  
 <span data-ttu-id="836b9-215">通常，在此示例方案中，仅在同步提交副本之间发生故障转移，但在故障转移之后，读意向应用程序立即可以重新连接到其中一个异步提交辅助副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-215">Typically, in this example scenario, failovers occur only between the synchronous-commit replicas, and  immediately after the failover, read-intent applications are able to reconnect to one of the asynchronous-commit secondary replicas.</span></span> <span data-ttu-id="836b9-216">然而，当主计算中心发生灾难时，两个同步提交副本都将丢失。</span><span class="sxs-lookup"><span data-stu-id="836b9-216">However, when a disaster occurs at the main computing center both synchronous-commit replicas are lost.</span></span> <span data-ttu-id="836b9-217">附属站点的数据库管理员通过强制手动故障转移到异步提交辅助副本来进行响应。</span><span class="sxs-lookup"><span data-stu-id="836b9-217">The database administrator at the satellite site responds by performing a forced manual failover to an asynchronous-commit secondary replica.</span></span> <span data-ttu-id="836b9-218">其余辅助副本上的辅助数据库已由于强制故障转移而被挂起，而使它们不可用于只读工作负载。</span><span class="sxs-lookup"><span data-stu-id="836b9-218">The secondary databases on the remaining secondary replica are suspended by the forced failover, making them unavailable for read-only workloads.</span></span> <span data-ttu-id="836b9-219">新的主副本（配置为读写连接）可防止读意向工作负荷与读写工作负荷发生争用。</span><span class="sxs-lookup"><span data-stu-id="836b9-219">The new primary replica, which is configured for read-write connections, prevents the read-intent workload from competing with the read-write workload.</span></span> <span data-ttu-id="836b9-220">这意味着，除非数据库管理员对于其他异步提交辅助副本恢复辅助数据库，否则读意向客户端无法连接到任何可用性副本。</span><span class="sxs-lookup"><span data-stu-id="836b9-220">This means that until the database administrator resumes the secondary databases on the remaining asynchronous-commit secondary replica, read-intent clients cannot connect to any availability replica.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="836b9-221">相关任务</span><span class="sxs-lookup"><span data-stu-id="836b9-221">Related Tasks</span></span>  
  
-   [<span data-ttu-id="836b9-222">配置对可用性副本的只读访问 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="836b9-222">Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;</span></span>](configure-read-only-access-on-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="836b9-223">为可用性组配置只读路由 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="836b9-223">Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;</span></span>](configure-read-only-routing-for-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="836b9-224">监视可用性组 (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="836b9-224">Monitor Availability Groups &#40;Transact-SQL&#41;</span></span>](monitor-availability-groups-transact-sql.md)  
  
-   [<span data-ttu-id="836b9-225">查看可用性副本属性 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="836b9-225">View Availability Replica Properties &#40;SQL Server&#41;</span></span>](view-availability-replica-properties-sql-server.md)  
  
-   [<span data-ttu-id="836b9-226">使用“新建可用性组”对话框 (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="836b9-226">Use the New Availability Group Dialog Box &#40;SQL Server Management Studio&#41;</span></span>](use-the-new-availability-group-dialog-box-sql-server-management-studio.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="836b9-227">相关内容</span><span class="sxs-lookup"><span data-stu-id="836b9-227">Related Content</span></span>  
  
-   [<span data-ttu-id="836b9-228">用于高可用性和灾难恢复的 Microsoft SQL Server AlwaysOn 解决方案指南</span><span class="sxs-lookup"><span data-stu-id="836b9-228">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="836b9-229">SQL Server AlwaysOn 团队博客：SQL Server AlwaysOn 官方团队博客</span><span class="sxs-lookup"><span data-stu-id="836b9-229">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="836b9-230">另请参阅</span><span class="sxs-lookup"><span data-stu-id="836b9-230">See Also</span></span>  
 <span data-ttu-id="836b9-231">[AlwaysOn 可用性组 &#40;SQL Server 概述&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="836b9-231">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="836b9-232">[可用性组侦听程序、客户端连接和应用程序故障转移 &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="836b9-232">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 [<span data-ttu-id="836b9-233">统计信息</span><span class="sxs-lookup"><span data-stu-id="836b9-233">Statistics</span></span>](../../../relational-databases/statistics/statistics.md)  
  
  
