---
title: 使用扩展保护连接到数据库引擎 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- spoofing attacks
- service binding
- luring attacks
- Schannel
- channel binding
- Extended Protection
ms.assetid: ecfd783e-7dbb-4a6c-b5ab-c6c27d5dd57f
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 718e5c9897f0883734d460e34ca26bba4f759a54
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588022"
---
# <a name="connect-to-the-database-engine-using-extended-protection"></a><span data-ttu-id="fe8a3-102">使用扩展保护连接到数据库引擎</span><span class="sxs-lookup"><span data-stu-id="fe8a3-102">Connect to the Database Engine Using Extended Protection</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fe8a3-103">自  始支持扩展保护 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-103">supports **Extended Protection** beginning with [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)].</span></span> <span data-ttu-id="fe8a3-104">**针对验证的扩展保护** 是操作系统实现的一项网络组件功能。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-104">**Extended Protection for Authentication** is a feature of the network components implemented by the operating system.</span></span> <span data-ttu-id="fe8a3-105">Windows 7 和 Windows Server 2008 R2 支持**扩展保护** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-105">**Extended Protection** is supported in Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="fe8a3-106">旧**操作系统的 Service Pack 中包括** 扩展保护 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 功能。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-106">**Extended Protection** is included in service packs for older [!INCLUDE[msCoName](../../includes/msconame-md.md)] operating systems.</span></span> <span data-ttu-id="fe8a3-107">使用**扩展保护**进行连接时，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 会更安全。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-107">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is more secure when connections are made using **Extended Protection**.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="fe8a3-108">默认情况下，Windows 不启用 **扩展保护** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-108">Windows does not enable **Extended Protection** by default.</span></span> <span data-ttu-id="fe8a3-109">有关如何在 Windows 中启用 **扩展保护** 的信息，请参阅 [针对验证的扩展保护](https://support.microsoft.com/kb/968389)。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-109">For information about how to enable **Extended Protection** in Windows, see [Extended Protection for Authentication](https://support.microsoft.com/kb/968389).</span></span>  
  
## <a name="description-of-extended-protection"></a><span data-ttu-id="fe8a3-110">扩展保护的描述</span><span class="sxs-lookup"><span data-stu-id="fe8a3-110">Description of Extended Protection</span></span>  
 <span data-ttu-id="fe8a3-111">**扩展保护** 使用服务绑定和渠道绑定来帮助防止身份验证中继攻击。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-111">**Extended Protection** uses service binding and channel binding to help prevent an authentication relay attack.</span></span> <span data-ttu-id="fe8a3-112">在身份验证中继攻击中，可以执行 NTLM 身份验证的客户端（例如，Windows Explorer、 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Outlook、.NET SqlClient 应用程序等）连接到攻击者（例如，恶意的 CIFS 文件服务器）。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-112">In an authentication relay attack, a client that can perform NTLM authentication (for example, Windows Explorer, [!INCLUDE[msCoName](../../includes/msconame-md.md)] Outlook, a .NET SqlClient application, etc.), connects to an attacker (for example, a malicious CIFS file server).</span></span> <span data-ttu-id="fe8a3-113">攻击者使用客户端的凭据来伪装成此客户端并经受服务（例如，[!INCLUDE[ssDE](../../includes/ssde-md.md)] 服务的实例）对其进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-113">The attacker uses the client's credentials to masquerade as the client and authenticate to a service (for example, an instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service).</span></span>  
  
 <span data-ttu-id="fe8a3-114">这种攻击具有两种变体：</span><span class="sxs-lookup"><span data-stu-id="fe8a3-114">There are two variations of this attack:</span></span>  
  
-   <span data-ttu-id="fe8a3-115">在引诱攻击中，客户端被引诱而自主连接到攻击者。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-115">In a luring attack, the client is lured to voluntarily connect to the attacker.</span></span>  
  
-   <span data-ttu-id="fe8a3-116">在假冒攻击中，客户端打算连接到有效的服务，但没觉察到 DNS 和 IP 路由之一或两者已受到感染而将连接重定向到攻击者。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-116">In a spoofing attack, the client intends to connect to a valid service, but is unaware that one or both of DNS and IP routing are poisoned to redirect the connection to the attacker instead.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fe8a3-117">支持服务绑定和渠道绑定，以帮助减少在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例上出现这些攻击。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-117">supports service binding and channel binding to help reduce these attacks on [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instances.</span></span>  
  
### <a name="service-binding"></a><span data-ttu-id="fe8a3-118">服务绑定</span><span class="sxs-lookup"><span data-stu-id="fe8a3-118">Service Binding</span></span>  
 <span data-ttu-id="fe8a3-119">服务绑定解决引诱攻击，它是通过要求客户端发送该客户端要连接到的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务的一个签名服务主体名称 (SPN) 来实现的。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-119">Service binding addresses luring attacks by requiring a client to send a signed service principal name (SPN) of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service that the client intends to connect to.</span></span> <span data-ttu-id="fe8a3-120">作为身份验证响应的一部分，此服务验证在数据包中收到的 SPN 与其自己的 SPN 匹配。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-120">As part of the authentication response, the service validates that the SPN received in the packet matches its own SPN.</span></span> <span data-ttu-id="fe8a3-121">如果客户端被引诱连接到攻击者，则客户端将包含攻击者的已签名 SPN。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-121">If a client is lured to connect to an attacker, the client will include the signed SPN of the attacker.</span></span> <span data-ttu-id="fe8a3-122">攻击者无法作为客户端来中继数据包以对实际 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务进行身份验证，因为它包含攻击者的 SPN。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-122">The attacker cannot relay the packet to authenticate to the real [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service as the client, because it would include the SPN of the attacker.</span></span> <span data-ttu-id="fe8a3-123">服务绑定引发的成本是一次性的且微不足道，但它无法解决假冒攻击。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-123">Service binding incurs a one-time, negligible cost, but it does not address spoofing attacks.</span></span> <span data-ttu-id="fe8a3-124">客户端应用程序不使用加密方式连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]时，发生服务绑定。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-124">Service Binding occurs when a client application does not use encryption to connect to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
### <a name="channel-binding"></a><span data-ttu-id="fe8a3-125">渠道绑定</span><span class="sxs-lookup"><span data-stu-id="fe8a3-125">Channel Binding</span></span>  
 <span data-ttu-id="fe8a3-126">通道绑定在客户端与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务的实例之间建立安全通道 (Schannel)。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-126">Channel binding establishes a secure channel (Schannel) between a client and an instance of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service.</span></span> <span data-ttu-id="fe8a3-127">此服务通过将客户端特定于该通道的通道绑定标记 (CBT) 与其自己的 CBT 进行比较，以验证客户端的身份。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-127">The service verifies the authenticity of the client by comparing the client's channel binding token (CBT) specific to that channel, with its own CBT.</span></span> <span data-ttu-id="fe8a3-128">渠道绑定可同时解决引诱攻击和假冒攻击。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-128">Channel binding addresses both luring and spoofing attacks.</span></span> <span data-ttu-id="fe8a3-129">然而，它引发的运行时成本较高，因为它要求对所有会话流量进行传输层安全 (TLS) 加密。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-129">However, it incurs a larger runtime cost, because it requires Transport Layer Security (TLS) encryption of all the session traffic.</span></span> <span data-ttu-id="fe8a3-130">客户端应用程序使用加密方式连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]时，发生通道绑定，这与加密由客户端还是服务器实施无关。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-130">Channel Binding occurs when a client application uses encryption to connect to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], regardless of whether encryption is enforced by the client or by the server.</span></span>  
  
> [!WARNING]  
>  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fe8a3-131">的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 数据提供程序支持 TLS 1.0 和 SSL 3.0。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-131">and [!INCLUDE[msCoName](../../includes/msconame-md.md)] data providers for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] support TLS 1.0 and SSL 3.0.</span></span> <span data-ttu-id="fe8a3-132">如果通过在操作系统 SChannel 层中进行更改来强制使用不同的协议（例如 TLS 1.1 或 TLS 1.2），你可能无法连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-132">If you enforce a different protocol (such as TLS 1.1 or TLS 1.2) by making changes in the operating system SChannel layer, your connections to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might fail.</span></span>  
  
### <a name="operating-system-support"></a><span data-ttu-id="fe8a3-133">操作系统支持</span><span class="sxs-lookup"><span data-stu-id="fe8a3-133">Operating System Support</span></span>  
 <span data-ttu-id="fe8a3-134">以下链接提供有关 Windows 如何支持 **扩展保护**的详细信息：</span><span class="sxs-lookup"><span data-stu-id="fe8a3-134">The following links provide more information about how Windows supports **Extended Protection**:</span></span>  
  
-   [<span data-ttu-id="fe8a3-135">具有扩展保护的集成 Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="fe8a3-135">Integrated Windows Authentication with Extended Protection</span></span>](https://msdn.microsoft.com/library/dd639324.aspx)  
  
-   [<span data-ttu-id="fe8a3-136">Microsoft 安全建议 (973811)，针对验证的扩展保护</span><span class="sxs-lookup"><span data-stu-id="fe8a3-136">Microsoft Security Advisory (973811), Extended Protection for Authentication</span></span>](https://support.microsoft.com//help/973811/microsoft-security-advisory-extended-protection-for-authentication)  
  
## <a name="settings"></a><span data-ttu-id="fe8a3-137">设置</span><span class="sxs-lookup"><span data-stu-id="fe8a3-137">Settings</span></span>  
 <span data-ttu-id="fe8a3-138">三种 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 连接设置可影响服务绑定和渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-138">There are three [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connection settings that affect service binding and channel binding.</span></span> <span data-ttu-id="fe8a3-139">可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 配置管理器或使用 WMI 来配置这些设置，并可以使用基于策略的管理的 **服务器协议设置** 方面来查看这些设置。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-139">The settings can be configured by using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, or by using WMI, and can by viewed by using the **Server Protocol Settings** facet of Policy Based Management.</span></span>  
  
-   <span data-ttu-id="fe8a3-140">**强行加密**</span><span class="sxs-lookup"><span data-stu-id="fe8a3-140">**Force Encryption**</span></span>  
  
     <span data-ttu-id="fe8a3-141">可能的值为 **“打开”** 和 **“关闭”** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-141">Possible values are **On** and **Off**.</span></span> <span data-ttu-id="fe8a3-142">若要使用渠道绑定，“强行加密”  必须设置为“打开” ，所有客户端都将强制进行加密。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-142">To use channel binding, **Force Encryption** must be set to **On**, and all clients will be forced to encrypt.</span></span> <span data-ttu-id="fe8a3-143">如果为 **“关闭”** ，则只确保服务绑定。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-143">If it is **Off**, only service binding is guaranteed.</span></span> <span data-ttu-id="fe8a3-144">**“强行加密”** 位于 **配置管理器中的“MSSQLSERVER 的协议属性”（“标志”选项卡）** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 上。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-144">**Force Encryption** is on the **Protocols for MSSQLSERVER Properties (Flags Tab)** in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   <span data-ttu-id="fe8a3-145">**扩展保护**</span><span class="sxs-lookup"><span data-stu-id="fe8a3-145">**Extended Protection**</span></span>  
  
     <span data-ttu-id="fe8a3-146">可能的值为 **“关闭”** 、 **“允许”** 和 **“必需”** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-146">Possible values are **Off**, **Allowed**, and **Required**.</span></span> <span data-ttu-id="fe8a3-147">通过 **扩展保护** 变量，用户可以为每个  实例配置扩展保护 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 级别。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-147">The **Extended Protection** variable lets users configure the **Extended Protection** level for each [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="fe8a3-148">**“扩展保护”** 位于 **配置管理器中的“MSSQLSERVER 的协议属性”（“高级”选项卡）** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 上。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-148">**Extended Protection** is on the **Protocols for MSSQLSERVER Properties (Advanced Tab)** in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
    -   <span data-ttu-id="fe8a3-149">当设置为 **“关闭”** 时，禁用 **扩展保护** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-149">When set to **Off**, **Extended Protection** is disabled.</span></span> <span data-ttu-id="fe8a3-150">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的实例将接受来自任何客户端的连接，不管该客户端是否受保护。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-150">The instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] will accept connections from any client regardless of whether the client is protected or not.</span></span> <span data-ttu-id="fe8a3-151">**“关闭”** 选项虽与旧的和未打补丁的操作系统兼容，但安全性较差。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-151">**Off** is compatible with older and unpatched operating systems, but is less secure.</span></span> <span data-ttu-id="fe8a3-152">当您知道客户端操作系统不支持扩展保护时，请使用此设置。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-152">Use this setting when you know that the client operating systems do not support extended protection.</span></span>  
  
    -   <span data-ttu-id="fe8a3-153">当设置为 **“允许”** 时，来自支持 **扩展保护** 的操作系统的连接需要 **扩展保护**。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-153">When set to **Allowed**, **Extended Protection** is required for connections from operating systems that support **Extended Protection**.</span></span> <span data-ttu-id="fe8a3-154">来自不支持**扩展保护** 的操作系统的连接将忽略 **扩展保护**。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-154">**Extended Protection** is ignored for connections from operating systems that do not support **Extended Protection**.</span></span> <span data-ttu-id="fe8a3-155">来自运行在受保护客户端操作系统上的不受保护客户端应用程序的连接被拒绝。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-155">Connections from unprotected client applications that are running on protected client operating systems are rejected.</span></span> <span data-ttu-id="fe8a3-156">此设置虽比 **“关闭”** 更安全，但仍不是最安全的设置。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-156">This setting is more secure than **Off**, but is not the most secure setting.</span></span> <span data-ttu-id="fe8a3-157">在混合环境（即有些操作系统支持 **扩展保护** ，有些不支持）中使用此设置。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-157">Use this setting in mixed environments, where some operating systems support **Extended Protection** and some do not.</span></span>  
  
    -   <span data-ttu-id="fe8a3-158">当设置为 **“必需”** 时，只接受来自受保护操作系统上受保护应用程序的连接。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-158">When set to **Required**, only connections from protected applications on protected operating systems are accepted.</span></span> <span data-ttu-id="fe8a3-159">此设置是最安全的，但来自不支持 **扩展保护** 的操作系统或应用程序的连接将无法连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-159">This setting is the most secure but connections from operating systems or applications that do not support **Extended Protection** will not be able to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="fe8a3-160">**接受的 NTLM SPN**</span><span class="sxs-lookup"><span data-stu-id="fe8a3-160">**Accepted NTLM SPNs**</span></span>  
  
     <span data-ttu-id="fe8a3-161">当多个 SPN 知道一个服务器时，需要 **“接受的 NTLM SPN”** 变量。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-161">The **Accepted NTLM SPNs** variable is needed when a server is known by more than one SPN.</span></span> <span data-ttu-id="fe8a3-162">当客户端尝试使用服务器不知道的有效 SPN 连接到服务器时，服务绑定将失败。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-162">When a client attempts to connect to the server by using a valid SPN that the server does not know, service binding will fail.</span></span> <span data-ttu-id="fe8a3-163">为避免此问题，用户可以使用 **“接受的 NTLM SPN”** 指定表示服务器的多个 SPN。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-163">To avoid this problem, users can specify several SPNs that represent the server by using **Accepted NTLM SPNs**.</span></span> <span data-ttu-id="fe8a3-164">**“接受的 NTLM SPN”** 是一系列由分号分隔的 SPN。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-164">**Accepted NTLM SPNs** is a series of SPNs separated my semicolons.</span></span> <span data-ttu-id="fe8a3-165">例如，若要允许 SPN **MSSQLSvc/ HostName1.Contoso.com** 和 **MSSQLSvc/ HostName2.Contoso.com**，请在“接受的 NTLM SPN”  框中键入 **MSSQLSvc/HostName1.Contoso.com;MSSQLSvc/HostName2.Contoso.com** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-165">For example, to allow the SPNs **MSSQLSvc/ HostName1.Contoso.com** and **MSSQLSvc/ HostName2.Contoso.com**, type **MSSQLSvc/HostName1.Contoso.com;MSSQLSvc/HostName2.Contoso.com** in the **Accepted NTLM SPNs** box.</span></span> <span data-ttu-id="fe8a3-166">变量的最大长度为 2048 个字符。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-166">The variable has a maximum length of 2,048 characters.</span></span> <span data-ttu-id="fe8a3-167">**“接受的 NTLM SPN”** 位于 **配置管理器中的“MSSQLSERVER 的协议属性”（“高级”选项卡）** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 上。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-167">**Accepted NTLM SPNs** is on the **Protocols for MSSQLSERVER Properties (Advanced Tab)** in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
## <a name="enabling-extended-protection-for-the-database-engine"></a><span data-ttu-id="fe8a3-168">为数据库引擎启用扩展保护</span><span class="sxs-lookup"><span data-stu-id="fe8a3-168">Enabling Extended Protection for the Database Engine</span></span>  
 <span data-ttu-id="fe8a3-169">若要使用 **扩展保护**，服务器和客户端都必须具有支持 **扩展保护**的操作系统，并且必须在操作系统上启用 **扩展保护** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-169">To use **Extended Protection**, both the server and the client must have an operating system on that supports **Extended Protection**, and **Extended Protection** must be enabled on the operating system.</span></span> <span data-ttu-id="fe8a3-170">有关如何为操作系统启用 **扩展保护** 的详细信息，请参阅 [针对验证的扩展保护](https://support.microsoft.com/kb/968389)。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-170">For more information about how to enable **Extended Protection** for the operating system, see [Extended Protection for Authentication](https://support.microsoft.com/kb/968389).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="fe8a3-171">自  始支持扩展保护 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-171">supports **Extended Protection** beginning with [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)].</span></span> <span data-ttu-id="fe8a3-172"> 的某些早期版本的扩展保护 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 将在后续的更新中提供。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-172">**Extended Protection** for some earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] will be made available in future updates.</span></span> <span data-ttu-id="fe8a3-173">在服务器计算机上启用 **扩展保护** 之后，使用以下步骤启用 **扩展保护**：</span><span class="sxs-lookup"><span data-stu-id="fe8a3-173">After enabling **Extended Protection** on the server computer, use the following steps to enable **Extended Protection**:</span></span>  
  
1.  <span data-ttu-id="fe8a3-174">在 **“开始”** 菜单上，选择 **“所有程序”** ，指向 **Microsoft SQL Server** ，再单击 **“SQL Server 配置管理器”** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-174">On the **Start** menu, choose **All Programs**, point to **Microsoft SQL Server** and then click **SQL Server Configuration Manager**.</span></span>  
  
2.  <span data-ttu-id="fe8a3-175">展开 " **SQL Server 网络配置**"，然后右键单击 "**协议** *\<*InstanceName*>* "，然后单击 "**属性**"。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-175">Expand **SQL Server Network Configuration**, and then right-click **Protocols for** *\<*InstanceName*>*, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="fe8a3-176">对于渠道绑定和服务绑定，同时在 **“高级”** 选项卡上将 **“扩展保护”** 设置为适当的设置。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-176">For both channel binding and service binding, on the **Advanced** tab, set **Extended Protection** to the appropriate setting.</span></span>  
  
4.  <span data-ttu-id="fe8a3-177">或者，当多个 SPN 知道一个服务器时，在 **“高级”** 选项卡上按照“设置”部分所述配置 **“接受的 NTLM SPN”** 字段。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-177">Optionally, when a server is known by more than one SPN, on the **Advanced** tab configure the **Accepted NTLM SPNs** field as described in the "Settings" section.</span></span>  
  
5.  <span data-ttu-id="fe8a3-178">对于渠道绑定，在 **“标志”** 选项卡上，将 **“强行加密”** 设置为 **“打开”** 。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-178">For channel binding, on the **Flags** tab, set **Force Encryption** to **On**.</span></span>  
  
6.  <span data-ttu-id="fe8a3-179">重新启动 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 服务。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-179">Restart the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service.</span></span>  
  
## <a name="configuring-other-sql-server-components"></a><span data-ttu-id="fe8a3-180">配置其他 SQL Server 组件</span><span class="sxs-lookup"><span data-stu-id="fe8a3-180">Configuring Other SQL Server Components</span></span>  
 <span data-ttu-id="fe8a3-181">有关如何配置 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]的详细信息，请参阅 [Reporting Services 针对身份验证的扩展保护](../../reporting-services/security/extended-protection-for-authentication-with-reporting-services.md)。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-181">For more information about how to configure [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Extended Protection for Authentication with Reporting Services](../../reporting-services/security/extended-protection-for-authentication-with-reporting-services.md).</span></span>  
  
 <span data-ttu-id="fe8a3-182">当通过 HTTP 连接或 HTTPS 连接使用 IIS 访问 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据时， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 可以利用 IIS 提供的扩展保护。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-182">When using IIS to access [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data using an HTTP or HTTPs connection, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can take advantage of Extended Protection provided by IIS.</span></span> <span data-ttu-id="fe8a3-183">有关配置 IIS 使用扩展保护的详细信息，请参阅 [Configure Extended Protection in IIS 7.5（在 IIS 7.5 中配置扩展保护）](https://go.microsoft.com/fwlink/?LinkId=181105)。</span><span class="sxs-lookup"><span data-stu-id="fe8a3-183">For more information about how to configure IIS to use Extended Protection, see [Configure Extended Protection in IIS 7.5](https://go.microsoft.com/fwlink/?LinkId=181105).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fe8a3-184">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fe8a3-184">See Also</span></span>  
 <span data-ttu-id="fe8a3-185">[服务器网络配置](server-network-configuration.md) </span><span class="sxs-lookup"><span data-stu-id="fe8a3-185">[Server Network Configuration](server-network-configuration.md) </span></span>  
 <span data-ttu-id="fe8a3-186">[客户端网络配置](client-network-configuration.md) </span><span class="sxs-lookup"><span data-stu-id="fe8a3-186">[Client Network Configuration](client-network-configuration.md) </span></span>  
 <span data-ttu-id="fe8a3-187">[针对验证的扩展保护概述](https://go.microsoft.com/fwlink/?LinkID=177943) </span><span class="sxs-lookup"><span data-stu-id="fe8a3-187">[Extended Protection for Authentication Overview](https://go.microsoft.com/fwlink/?LinkID=177943) </span></span>  
 [<span data-ttu-id="fe8a3-188">具有扩展保护的集成 Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="fe8a3-188">Integrated Windows Authentication with Extended Protection</span></span>](https://go.microsoft.com/fwlink/?LinkId=179922)  
  
  
