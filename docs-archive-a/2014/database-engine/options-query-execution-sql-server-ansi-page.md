---
title: 选项 (查询执行-SQL Server-ANSI 页面) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- VS.ToolsOptionsPages.QueryExecution.SqlServer.SqlExecutionAnsi
ms.assetid: 0f4c6887-0562-417e-806c-b5cffb1e7c5c
author: rothja
ms.author: jroth
ms.openlocfilehash: 198505c5d14b9fda510d4635dbaa3d3d49483ddf
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87590346"
---
# <a name="options-query-execution-sql-server-ansi-page"></a><span data-ttu-id="12403-102">选项 (查询执行-SQL Server-ANSI 页面) </span><span class="sxs-lookup"><span data-stu-id="12403-102">Options (Query Execution-SQL Server-ANSI Page)</span></span>
  <span data-ttu-id="12403-103">这些 ANSI (ISO) 标准 SET 选项共同定义了用户查询、运行触发器或存储过程执行期间的查询处理环境。</span><span class="sxs-lookup"><span data-stu-id="12403-103">Together, these ANSI (ISO) standard SET options define the query processing environment for the duration of the user's query, a running trigger, or a stored procedure.</span></span> <span data-ttu-id="12403-104">不过，这些 SET 选项并未包括遵守 ISO 标准所需的所有选项。</span><span class="sxs-lookup"><span data-stu-id="12403-104">These SET options, however, do not include all of the options required to conform to the ISO standard.</span></span> <span data-ttu-id="12403-105">使用此页可以指定 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 将使用 ISO 标准中指定的全部或部分设置运行查询。</span><span class="sxs-lookup"><span data-stu-id="12403-105">Use this page to specify that [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] will run the queries using all or a portion of the settings specified in the ISO standard.</span></span> <span data-ttu-id="12403-106">对这些选项所做的更改只应用于新的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 查询。</span><span class="sxs-lookup"><span data-stu-id="12403-106">Changes to these options are applied only to new [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] queries.</span></span> <span data-ttu-id="12403-107">若要更改当前查询的选项，请在 "**查询**" 菜单上单击 "**查询选项**"，或在 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 查询窗口中右键单击并选择 "**查询选项**"。</span><span class="sxs-lookup"><span data-stu-id="12403-107">To change the options for the current queries, click **Query Options** on the **Query** menu, or right-click in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Query window and select **Query Options**.</span></span> <span data-ttu-id="12403-108">在 **“查询选项”** 对话框中的 **“执行”** 下，单击 **ANSI**。</span><span class="sxs-lookup"><span data-stu-id="12403-108">In the **Query Options** dialog box, under **Execution**, click **ANSI**.</span></span>  
  
## <a name="ui-element-list"></a><span data-ttu-id="12403-109">UI 元素列表</span><span class="sxs-lookup"><span data-stu-id="12403-109">UI element list</span></span>  
 <span data-ttu-id="12403-110">**SET ANSI_DEFAULTS**</span><span class="sxs-lookup"><span data-stu-id="12403-110">**SET ANSI_DEFAULTS**</span></span>  
 <span data-ttu-id="12403-111">选中此复选框可以选择所有默认的 ISO 设置。</span><span class="sxs-lookup"><span data-stu-id="12403-111">Select this check box to select all of the default ISO settings.</span></span> <span data-ttu-id="12403-112">默认情况下，不会选择所有 ISO 选项。</span><span class="sxs-lookup"><span data-stu-id="12403-112">Not all ISO options are selected by default.</span></span>  
  
 <span data-ttu-id="12403-113">**SET QUOTED_IDENTIFIER**</span><span class="sxs-lookup"><span data-stu-id="12403-113">**SET QUOTED_IDENTIFIER**</span></span>  
 <span data-ttu-id="12403-114">如果选中此复选框，则 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 将遵从有关引号分隔标识符和文字字符串的 ISO 规则。</span><span class="sxs-lookup"><span data-stu-id="12403-114">When this check box is selected, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] follows the ISO rules regarding quotation mark delimiting identifiers and literal strings.</span></span> <span data-ttu-id="12403-115">由引号分隔的标识符可以是 Transact-SQL 保留关键字，也可以包含 Transact-SQL 标识符语法规则通常不允许的字符。</span><span class="sxs-lookup"><span data-stu-id="12403-115">Identifiers delimited by quotation marks can be either Transact-SQL reserved keywords or can contain characters not usually allowed by the Transact-SQL syntax rules for identifiers.</span></span> <span data-ttu-id="12403-116">默认情况下，此复选框为选中状态。</span><span class="sxs-lookup"><span data-stu-id="12403-116">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="12403-117">**SET ANSI_NULL_DFLT_ON**</span><span class="sxs-lookup"><span data-stu-id="12403-117">**SET ANSI_NULL_DFLT_ON**</span></span>  
 <span data-ttu-id="12403-118">当设置了此值时，在 CREATE TABLE 或 ALTER TABLE 语句执行过程中，没有显式定义为 NOT NULL 的所有用户定义的数据类型或列都将默认为允许空值。</span><span class="sxs-lookup"><span data-stu-id="12403-118">When this value is set, all user-defined data types or columns that are not explicitly defined as NOT NULL during a CREATE TABLE or ALTER TABLE statement default to allowing null values.</span></span> <span data-ttu-id="12403-119">默认情况下，此复选框为选中状态。</span><span class="sxs-lookup"><span data-stu-id="12403-119">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="12403-120">**SET IMPLICIT_TRANSACTIONS**</span><span class="sxs-lookup"><span data-stu-id="12403-120">**SET IMPLICIT_TRANSACTIONS**</span></span>  
 <span data-ttu-id="12403-121">如果选中此复选框，则 SET IMPLICIT_TRANSACTIONS 将连接设置为隐式事务模式。</span><span class="sxs-lookup"><span data-stu-id="12403-121">When this check box is selected, SET IMPLICIT_TRANSACTIONS sets the connection into implicit transaction mode.</span></span> <span data-ttu-id="12403-122">如果清除此复选框，则会将连接返回到自动提交事务模式。</span><span class="sxs-lookup"><span data-stu-id="12403-122">When this check box is cleared, it returns the connection to autocommit transaction mode.</span></span> <span data-ttu-id="12403-123">若要查看在选中此复选框时可启动隐式事务的语句，请参阅 [SET IMPLICIT_TRANSACTIONS (Transact-SQL)](/sql/t-sql/statements/set-implicit-transactions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="12403-123">To review the statements that start an implicit transaction when selected, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span> <span data-ttu-id="12403-124">默认情况下清除此复选框。</span><span class="sxs-lookup"><span data-stu-id="12403-124">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="12403-125">**SET CURSOR_CLOSE_ON_COMMIT**</span><span class="sxs-lookup"><span data-stu-id="12403-125">**SET CURSOR_CLOSE_ON_COMMIT**</span></span>  
 <span data-ttu-id="12403-126">如果选中此复选框，则在提交事务时，所有打开的游标都将自动关闭（符合 ISO 标准）。</span><span class="sxs-lookup"><span data-stu-id="12403-126">When this check box is selected, any open cursors are closed automatically (in compliance with ISO) when a transaction is committed.</span></span> <span data-ttu-id="12403-127">当此值设置为 OFF 时，游标仍然在各事务边界间保持打开状态，并且仅当连接关闭或被显式关闭时，才会关闭游标。</span><span class="sxs-lookup"><span data-stu-id="12403-127">When this value is set to OFF, cursors remain open across transaction boundaries, closing only when the connection is closed or when they are explicitly closed.</span></span> <span data-ttu-id="12403-128">默认情况下清除此复选框。</span><span class="sxs-lookup"><span data-stu-id="12403-128">This check box is cleared by default.</span></span>  
  
 <span data-ttu-id="12403-129">**SET ANSI_PADDING**</span><span class="sxs-lookup"><span data-stu-id="12403-129">**SET ANSI_PADDING**</span></span>  
 <span data-ttu-id="12403-130">对于长度小于列定义大小的值名称，以及在 **char**、 **varchar**、 **binary**和 **varbinary** 数据中含有尾随空格的值，对列存储这些值名称和值的方式进行控制。</span><span class="sxs-lookup"><span data-stu-id="12403-130">Controls the way the column stores value names shorter than the defined size of the column, and the way the column stores values that have trailing blanks in **char**, **varchar**, **binary**, and **varbinary** data.</span></span> <span data-ttu-id="12403-131">此设置只影响新列的定义。</span><span class="sxs-lookup"><span data-stu-id="12403-131">This setting affects only the definition of new columns.</span></span> <span data-ttu-id="12403-132">创建列后， [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 会基于创建列时的设置存储这些值。</span><span class="sxs-lookup"><span data-stu-id="12403-132">After the column is created, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] stores the values based on the setting when the column was created.</span></span> <span data-ttu-id="12403-133">以后对此设置的更改不会影响现有的列。</span><span class="sxs-lookup"><span data-stu-id="12403-133">Existing columns are not affected by a later change to this setting.</span></span> <span data-ttu-id="12403-134">默认情况下，此复选框为选中状态。</span><span class="sxs-lookup"><span data-stu-id="12403-134">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="12403-135">**SET ANSI_WARNINGS**</span><span class="sxs-lookup"><span data-stu-id="12403-135">**SET ANSI_WARNINGS**</span></span>  
 <span data-ttu-id="12403-136">指定对几种错误条件采用 ISO 标准行为：</span><span class="sxs-lookup"><span data-stu-id="12403-136">Specifies ISO standard behavior for several error conditions:</span></span>  
  
-   <span data-ttu-id="12403-137">选中此复选框后，如果在聚合函数（如 SUM、AVG、MAX、MIN、STDEV、STDEVP、VAR、VARP 或 COUNT）中出现了空值，则会生成一条警告消息。</span><span class="sxs-lookup"><span data-stu-id="12403-137">When this check box is selected, if null values appear in aggregate functions (such as SUM, AVG, MAX, MIN, STDEV, STDEVP, VAR, VARP, or COUNT), a warning message is generated.</span></span> <span data-ttu-id="12403-138">当设置为 OFF 时，不发出警告。</span><span class="sxs-lookup"><span data-stu-id="12403-138">When OFF, no warning is issued.</span></span>  
  
-   <span data-ttu-id="12403-139">如果清除此复选框，则在发生被零除错误和算术溢出错误时，将导致语句回滚并生成一条错误信息。</span><span class="sxs-lookup"><span data-stu-id="12403-139">When this check box is cleared, divide-by-zero and arithmetic overflow errors cause the statement to be rolled back and an error message to be generated.</span></span> <span data-ttu-id="12403-140">如果设置为 OFF，则在发生被零除错误和算术溢出错误时，将导致返回空值。</span><span class="sxs-lookup"><span data-stu-id="12403-140">When OFF, divide-by-zero and arithmetic overflow errors cause null values to be returned.</span></span> <span data-ttu-id="12403-141">如果尝试对 **character**、**Unicode** 或 **binary** 列执行 INSERT 或 UPDATE 操作，而这些列中的新值长度超出列的最大大小，那么，在发生被零除错误或算术溢出错误时，将导致返回空值。</span><span class="sxs-lookup"><span data-stu-id="12403-141">The behavior in which a divide-by-zero or arithmetic overflow error causes null values to be returned occurs if an INSERT or UPDATE operation is attempted on a **character**, **Unicode**, or **binary** column in which the length of a new value exceeds the maximum size of the column.</span></span> <span data-ttu-id="12403-142">如果 SET ANSI_WARNINGS 为 ON，则根据 ISO 标准，将取消 INSERT 或 UPDATE 操作。</span><span class="sxs-lookup"><span data-stu-id="12403-142">If SET ANSI_WARNINGS is ON, the INSERT or UPDATE operation is canceled as specified by the ISO standard.</span></span> <span data-ttu-id="12403-143">字符列的尾随空格和二进制列的尾随零都将被忽略。</span><span class="sxs-lookup"><span data-stu-id="12403-143">Trailing blanks are ignored for character columns and trailing nulls are ignored for binary columns.</span></span> <span data-ttu-id="12403-144">设置为 OFF 时，数据将剪裁为列的大小，并且语句执行成功。</span><span class="sxs-lookup"><span data-stu-id="12403-144">When OFF, data is truncated to the size of the column and the statement succeeds.</span></span>  
  
 <span data-ttu-id="12403-145">默认情况下，此复选框为选中状态。</span><span class="sxs-lookup"><span data-stu-id="12403-145">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="12403-146">**SET ANSI_NULLS**</span><span class="sxs-lookup"><span data-stu-id="12403-146">**SET ANSI_NULLS**</span></span>  
 -   <span data-ttu-id="12403-147">指定在与 Null 值一起使用等于 (=) 和不等于 (<>) 比较运算符时采用符合 ISO 标准的行为。</span><span class="sxs-lookup"><span data-stu-id="12403-147">Specifies ISO compliant behavior of the equals (=) and not equal to (<>) comparison operators when used with null values.</span></span> <span data-ttu-id="12403-148">当选中 SET ANSI_NULLS 时，所有与 Null 值进行比较求得的值均为 UNKNOWN，这是符合 ISO 标准的行为。</span><span class="sxs-lookup"><span data-stu-id="12403-148">When SET ANSI_NULLS is selected, all comparisons against a null value evaluate to UNKNOWN, the ISO compliant behavior.</span></span> <span data-ttu-id="12403-149">如果未选中 SET ANSI_NULLS，则所有数据与空值的比较求得的值为 TRUE。</span><span class="sxs-lookup"><span data-stu-id="12403-149">When SET ANSI_NULLS is not selected, comparisons of all data against a null value evaluate to TRUE.</span></span> <span data-ttu-id="12403-150">默认情况下，此复选框为选中状态。</span><span class="sxs-lookup"><span data-stu-id="12403-150">This check box is selected by default.</span></span>  
  
 <span data-ttu-id="12403-151">**重置为默认值**</span><span class="sxs-lookup"><span data-stu-id="12403-151">**Reset to Default**</span></span>  
 <span data-ttu-id="12403-152">将此页上的所有值重置为原始默认值。</span><span class="sxs-lookup"><span data-stu-id="12403-152">Resets all values on this page to the original default values.</span></span>  
  
  
