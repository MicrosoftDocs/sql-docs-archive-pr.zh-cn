---
title: 安装 SQL Server，并使用 SMB 文件共享作为存储选项 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
ms.assetid: 8b7810b2-637e-46a3-9fe1-d055898ba639
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 3d59c2861e2419d76d3dc8e3fc3aaab91bf1e99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688160"
---
# <a name="install-sql-server-with-smb-fileshare-as-a-storage-option"></a><span data-ttu-id="8b4ad-102">安装 SQL Server，并使用 SMB 文件共享作为存储选项</span><span class="sxs-lookup"><span data-stu-id="8b4ad-102">Install SQL Server with SMB Fileshare as a Storage Option</span></span>
  <span data-ttu-id="8b4ad-103">从 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 开始，在安装系统数据库（Master、Model、MSDB 和 TempDB）和[!INCLUDE[ssDE](../../includes/ssde-md.md)]用户数据库时可以选择 Server Message Block (SMB) 文件服务器作为存储。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-103">Starting [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], system databases (Master, Model, MSDB, and TempDB), and [!INCLUDE[ssDE](../../includes/ssde-md.md)] user databases can be installed with Server Message Block (SMB) file server as a storage option.</span></span> <span data-ttu-id="8b4ad-104">这同时适用于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 独立安装和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 故障转移群集安装 (FCI)。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-104">This applies to both [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stand-alone and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster installations (FCI).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8b4ad-105">当前 SMB 文件共享上不支持 Filestream。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-105">Filestream is currently not supported on an SMB file share.</span></span>  
  
## <a name="installation-considerations"></a><span data-ttu-id="8b4ad-106">安装注意事项</span><span class="sxs-lookup"><span data-stu-id="8b4ad-106">Installation Considerations</span></span>  
  
### <a name="smb-file-share-formats"></a><span data-ttu-id="8b4ad-107">SMB 文件共享格式：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-107">SMB File share Formats:</span></span>  
 <span data-ttu-id="8b4ad-108">在指定 SMB 文件共享时，下面是针对独立和 FCI 数据库的支持的通用命名约定 (UNC) 路径格式：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-108">While specifying the SMB file share, the following are supported Universal Naming Convention (UNC) Path formats for standalone and FCI databases:</span></span>  
  
-   <span data-ttu-id="8b4ad-109">\\\ServerName\ShareName</span><span class="sxs-lookup"><span data-stu-id="8b4ad-109">\\\ServerName\ShareName</span></span>\  
  
-   <span data-ttu-id="8b4ad-110">\\\ServerName\ShareName</span><span class="sxs-lookup"><span data-stu-id="8b4ad-110">\\\ServerName\ShareName</span></span>  
  
 <span data-ttu-id="8b4ad-111">有关通用命名约定的详细信息，请参阅[UNC](https://go.microsoft.com/fwlink/?LinkId=245534) (https://go.microsoft.com/fwlink/?LinkId=245534) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-111">For more information about Universal Naming Convention, see [UNC](https://go.microsoft.com/fwlink/?LinkId=245534) (https://go.microsoft.com/fwlink/?LinkId=245534).</span></span>  
  
 <span data-ttu-id="8b4ad-112">不支持环回 UNC 路径（其服务器名称为 localhost、127.0.0.1 或本地计算机名称的 UNC 路径）。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-112">The loopback UNC path (a UNC path whose server name is localhost, 127.0.0.1, or the local machine name) is not supported.</span></span> <span data-ttu-id="8b4ad-113">作为一种特殊情况，如果 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 使用的文件服务器群集承载在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 所运行的同一节点上，则也不受支持。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-113">As a special case, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using File Server Cluster which is hosted on the same node [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running is also not supported.</span></span> <span data-ttu-id="8b4ad-114">若要防止出现这种情况，建议在单独的 Windows 群集中创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 与文件服务器群集。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-114">To prevent this situation, it is recommended that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and File Server Cluster to be created on separated Windows Clusters.</span></span>  
  
 <span data-ttu-id="8b4ad-115">不支持以下 UNC 路径格式：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-115">The below UNC path formats are not supported:</span></span>  
  
-   <span data-ttu-id="8b4ad-116">环回路径，例如 \\\localhost\\..\ 或 \\\127.0.0.1\\...</span><span class="sxs-lookup"><span data-stu-id="8b4ad-116">Loopback path, e.g., \\\localhost\\..\ or \\\127.0.0.1\\...</span></span>\  
  
-   <span data-ttu-id="8b4ad-117">管理共享，例如 \\\servername\x$</span><span class="sxs-lookup"><span data-stu-id="8b4ad-117">Administrative shares, e.g., \\\servername\x$</span></span>  
  
-   <span data-ttu-id="8b4ad-118">其他 UNC 路径格式，例如 \\\\?\x:</span><span class="sxs-lookup"><span data-stu-id="8b4ad-118">Other UNC path formats like \\\\?\x:</span></span>\  
  
-   <span data-ttu-id="8b4ad-119">映射的网络驱动器。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-119">Mapped network drives.</span></span>  
  
### <a name="supported-data-definition-language-ddl-statements"></a><span data-ttu-id="8b4ad-120">支持的数据定义语言 (DDL) 语句</span><span class="sxs-lookup"><span data-stu-id="8b4ad-120">Supported Data Definition Language (DDL) statements</span></span>  
 <span data-ttu-id="8b4ad-121">以下 [!INCLUDE[tsql](../../includes/tsql-md.md)] DDL 语句和数据库引擎存储过程支持 SMB 文件共享：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-121">The following [!INCLUDE[tsql](../../includes/tsql-md.md)] DDL statements and database engine stored procedures support SMB file shares:</span></span>  
  
1.  [<span data-ttu-id="8b4ad-122">CREATE DATABASE (SQL Server Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8b4ad-122">CREATE DATABASE &#40;SQL Server Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-database-sql-server-transact-sql)  
  
2.  [<span data-ttu-id="8b4ad-123">ALTER DATABASE (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8b4ad-123">ALTER DATABASE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-database-transact-sql)  
  
3.  [<span data-ttu-id="8b4ad-124">RESTORE &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="8b4ad-124">RESTORE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-transact-sql)  
  
4.  [<span data-ttu-id="8b4ad-125">BACKUP (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8b4ad-125">BACKUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/backup-transact-sql)  
  
5.  [<span data-ttu-id="8b4ad-126">sp_attach_db (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8b4ad-126">sp_attach_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql)  
  
6.  [<span data-ttu-id="8b4ad-127">sp_attach_single_file_db (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="8b4ad-127">sp_attach_single_file_db &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-attach-single-file-db-transact-sql)  
  
### <a name="installation-options"></a><span data-ttu-id="8b4ad-128">安装选项</span><span class="sxs-lookup"><span data-stu-id="8b4ad-128">Installation options</span></span>  
  
-   <span data-ttu-id="8b4ad-129">在安装程序 UI“数据库引擎配置”页的“数据目录”选项卡上，将参数“数据根目录”设置为“\\\fileserver1\share1\"”。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-129">In setup UI "Database Engine Configuration" page, "Data Directories" tab, set the parameter "Data root directory as "\\\fileserver1\share1\".</span></span>  
  
-   <span data-ttu-id="8b4ad-130">在命令提示安装中，将“/INSTALLSQLDATADIR”指定为“\\\fileserver1\share1\"”。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-130">In command prompt installation, specify the "/INSTALLSQLDATADIR" as "\\\fileserver1\share1\".</span></span>  
  
     <span data-ttu-id="8b4ad-131">下面是使用 SMB 文件共享选项在独立服务器上安装 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的语法示例：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-131">Here is the sample syntax to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on a Standalone server using SMB file share option:</span></span>  
  
    ```  
    Setup.exe /q /ACTION=Install /FEATURES=SQL /INSTANCENAME=MSSQLSERVER /SQLSVCACCOUNT="<DomainName\UserName>" /SQLSVCPASSWORD="<StrongPassword>" /SQLSYSADMINACCOUNTS="<DomainName\UserName>" /AGTSVCACCOUNT="<DomainName\UserName>" /AGTSVCPASSWORD="<StrongPassword>" /INSTALLSQLDATADIR="\\FileServer\Share1\" /IACCEPTSQLSERVERLICENSETERMS  
    ```  
  
     <span data-ttu-id="8b4ad-132">安装具有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 的单节点 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]故障转移群集实例（默认实例）：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-132">To install a single-node [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover cluster instance with the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], default instance:</span></span>  
  
    ```  
    setup.exe /q /ACTION=InstallFailoverCluster /InstanceName=MSSQLSERVER /INDICATEPROGRESS /ASSYSADMINACCOUNTS="<DomainName\UserName>" /ASDATADIR=<Drive>:\OLAP\Data /ASLOGDIR=<Drive>:\OLAP\Log /ASBACKUPDIR=<Drive>:\OLAP\Backup /ASCONFIGDIR=<Drive>:\OLAP\Config /ASTEMPDIR=<Drive>:\OLAP\Temp /FAILOVERCLUSTERDISKS="<Cluster Disk Resource Name - for example, 'Disk S:'" /FAILOVERCLUSTERNETWORKNAME="<Insert Network Name>" /FAILOVERCLUSTERIPADDRESSES="IPv4;xx.xxx.xx.xx;Cluster Network;xxx.xxx.xxx.x" /FAILOVERCLUSTERGROUP="MSSQLSERVER" /Features=AS,SQL /ASSVCACCOUNT="<DomainName\UserName>" /ASSVCPASSWORD="xxxxxxxxxxx" /AGTSVCACCOUNT="<DomainName\UserName>" /AGTSVCPASSWORD="xxxxxxxxxxx" /INSTALLSQLDATADIR="\\FileServer\Share1\" /SQLCOLLATION="SQL_Latin1_General_CP1_CS_AS" /SQLSVCACCOUNT="<DomainName\UserName>" /SQLSVCPASSWORD="xxxxxxxxxxx" /SQLSYSADMINACCOUNTS="<DomainName\UserName> /IACCEPTSQLSERVERLICENSETERMS  
    ```  
  
     <span data-ttu-id="8b4ad-133">有关中各种命令行参数选项的用法的详细信息 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] ，请参阅[从命令提示符安装 SQL Server 2014](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md)。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-133">For more information about the usage of various command line parameter options in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], see [Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md).</span></span>  
  
## <a name="operating-system-considerations-smb-protocol-vs-ssnoversion"></a><span data-ttu-id="8b4ad-134">操作系统注意事项（SMB 协议与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]）</span><span class="sxs-lookup"><span data-stu-id="8b4ad-134">Operating System Considerations (SMB Protocol vs. [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)])</span></span>  
 <span data-ttu-id="8b4ad-135">不同的 Windows 操作系统具有不同的 SMB 协议版本，并且 SMB 协议版本对于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]而言是透明的。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-135">Different Windows operating systems has different SMB protocol versions, and the SMB protocol version is transparent to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8b4ad-136">您可以就 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]而言发现不同 SMB 协议版本的好处。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-136">You can find the benefits of different SMB protocol versions with respect to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
|<span data-ttu-id="8b4ad-137">操作系统</span><span class="sxs-lookup"><span data-stu-id="8b4ad-137">Operating System</span></span>|<span data-ttu-id="8b4ad-138">SMB2 协议版本</span><span class="sxs-lookup"><span data-stu-id="8b4ad-138">SMB2 protocol version</span></span>|<span data-ttu-id="8b4ad-139">优势 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="8b4ad-139">Benefits to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span></span>|  
|----------------------|---------------------------|-------------------------------------------|  
|[!INCLUDE[firstref_longhorn](../../includes/firstref-longhorn-md.md)] <span data-ttu-id="8b4ad-140">SP 2</span><span class="sxs-lookup"><span data-stu-id="8b4ad-140">SP 2</span></span>|<span data-ttu-id="8b4ad-141">2.0</span><span class="sxs-lookup"><span data-stu-id="8b4ad-141">2.0</span></span>|<span data-ttu-id="8b4ad-142">与以前的 SMB 版本相比改进的性能。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-142">Improved performance over previous SMB versions.</span></span><br /><br /> <span data-ttu-id="8b4ad-143">持续性，帮助从临时网络问题恢复。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-143">Durability, which helps recover from temporary network glitches.</span></span>|  
|[!INCLUDE[winserver2008r2](../../includes/winserver2008r2-md.md)] <span data-ttu-id="8b4ad-144">SP 1，包含 Server Core</span><span class="sxs-lookup"><span data-stu-id="8b4ad-144">SP 1, including Server Core</span></span>|<span data-ttu-id="8b4ad-145">2.1</span><span class="sxs-lookup"><span data-stu-id="8b4ad-145">2.1</span></span>|<span data-ttu-id="8b4ad-146">支持大型 MTU，这有利于大型数据传输，例如 SQL 备份和还原。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-146">Support for large MTU, which benefits large data transfers, such as SQL backup and restore.</span></span> <span data-ttu-id="8b4ad-147">此功能必须由用户启用。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-147">This capability must be enabled by user.</span></span> <span data-ttu-id="8b4ad-148">有关如何启用此功能的详细信息，请参阅 [SMB 中的新增功能](https://go.microsoft.com/fwlink/?LinkID=237319) (https://go.microsoft.com/fwlink/?LinkID=237319) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-148">For more details on how to enable this capability, see [What's New in SMB](https://go.microsoft.com/fwlink/?LinkID=237319) (https://go.microsoft.com/fwlink/?LinkID=237319).</span></span><br /><br /> <span data-ttu-id="8b4ad-149">针对 SQL OLTP 样式工作负荷的显著的性能改进。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-149">Significant performance improvements, specifically for SQL OLTP style workloads.</span></span> <span data-ttu-id="8b4ad-150">这些性能改进要求应用修补程序。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-150">These performance improvements require applying a hotfix.</span></span> <span data-ttu-id="8b4ad-151">有关控件的详细信息，请参阅[此处](https://go.microsoft.com/fwlink/?LinkId=237320) (https://go.microsoft.com/fwlink/?LinkId=237320) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-151">For more information on the hotfix, see [this](https://go.microsoft.com/fwlink/?LinkId=237320) (https://go.microsoft.com/fwlink/?LinkId=237320).</span></span>|  
|[!INCLUDE[win8srv](../../includes/win8srv-md.md)]<span data-ttu-id="8b4ad-152">，包含 Server Core</span><span class="sxs-lookup"><span data-stu-id="8b4ad-152">, including Server Core</span></span>|<span data-ttu-id="8b4ad-153">3.0</span><span class="sxs-lookup"><span data-stu-id="8b4ad-153">3.0</span></span>|<span data-ttu-id="8b4ad-154">支持文件共享的透明故障转移，提供零停机时间，并且在文件服务器群集配置中，无需 SQL DBA 或文件服务器管理员参与。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-154">Support for transparent failover of file shares providing zero downtime with no administrator intervention required for SQL DBA or file server administrator in file server cluster configurations.</span></span><br /><br /> <span data-ttu-id="8b4ad-155">支持同时使用多个网络接口的 IO，并且可承受网络接口故障。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-155">Support for IO using multiple network interfaces simultaneously, as well as tolerance to network interface failure.</span></span><br /><br /> <span data-ttu-id="8b4ad-156">支持具有 RDMA 功能的网络接口。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-156">Support for network interfaces with RDMA capabilities.</span></span><br /><br /> <span data-ttu-id="8b4ad-157">有关这些功能和服务器消息块的详细信息，请参阅 [服务器消息块概述](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-157">For more information on these features and Server Message Block, see [Server Message Block overview](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174).</span></span><br /><br /> <span data-ttu-id="8b4ad-158">通过持续可用性支持向外扩展文件服务器 (SoFS)。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-158">Support for Scale Out File Server (SoFS) with continuous availability.</span></span>|  
|[!INCLUDE[win8srv](../../includes/win8srv-md.md)] <span data-ttu-id="8b4ad-159">R2，包含 Server Core</span><span class="sxs-lookup"><span data-stu-id="8b4ad-159">R2, including Server Core</span></span>|<span data-ttu-id="8b4ad-160">3.2</span><span class="sxs-lookup"><span data-stu-id="8b4ad-160">3.2</span></span>|<span data-ttu-id="8b4ad-161">支持文件共享的透明故障转移，提供零停机时间，并且在文件服务器群集配置中，无需 SQL DBA 或文件服务器管理员参与。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-161">Support for transparent failover of file shares providing zero downtime with no administrator intervention required for SQL DBA or file server administrator in file server cluster configurations.</span></span><br /><br /> <span data-ttu-id="8b4ad-162">支持同时使用多个网络接口的 IO，并且使用 SMB 多通道可承受网络接口故障。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-162">Support for IO using multiple network interfaces simultaneously, as well as tolerance to network interface failure, using SMB Multichannel.</span></span><br /><br /> <span data-ttu-id="8b4ad-163">使用 SMB Direct 支持具有 RDMA 功能的网络接口。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-163">Support for network interfaces with RDMA capabilities using SMB Direct.</span></span><br /><br /> <span data-ttu-id="8b4ad-164">有关这些功能和服务器消息块的详细信息，请参阅 [服务器消息块概述](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-164">For more information on these features and Server Message Block, see [Server Message Block overview](https://go.microsoft.com/fwlink/?LinkId=253174) (https://go.microsoft.com/fwlink/?LinkId=253174).</span></span><br /><br /> <span data-ttu-id="8b4ad-165">通过持续可用性支持向外扩展文件服务器 (SoFS)。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-165">Support for Scale Out File Server (SoFS) with continuous availability.</span></span><br /><br /> <span data-ttu-id="8b4ad-166">针对 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] OLTP 所共有的小型随机读/写 I/O 进行优化。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-166">Optimized for small random read/write I/O common to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] OLTP.</span></span><br /><br /> <span data-ttu-id="8b4ad-167">默认情况下启用最大传输单位 (MTU)，这可以显著增强大型连续传输（例如 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据仓库和数据库备份或还原）的性能。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-167">Maximum Transmission Unit (MTU) is turned on by default, which significantly enhances performance in large sequential transfers like [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data warehouse and database backup or restore.</span></span>|  
  
## <a name="security-considerations"></a><span data-ttu-id="8b4ad-168">安全注意事项</span><span class="sxs-lookup"><span data-stu-id="8b4ad-168">Security Considerations</span></span>  
  
-   <span data-ttu-id="8b4ad-169">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务帐户和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理服务帐户应具有对 SMB 共享文件夹的 FULL CONTROL 共享权限和 NTFS 权限。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-169">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] agent service account should have FULL CONTROL share permissions and NTFS permissions on the SMB share folders.</span></span> <span data-ttu-id="8b4ad-170">使用 SMB 文件服务器时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务帐户可以是域帐户或系统帐户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account can be a domain account or a system account if an SMB file server is used.</span></span> <span data-ttu-id="8b4ad-171">有关共享和 NTFS 权限的详细信息，请参阅 [文件服务器上的共享和 NTFS 权限](https://go.microsoft.com/fwlink/?LinkId=245535) (https://go.microsoft.com/fwlink/?LinkId=245535) 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-171">For more information about share and NTFS permissions, see [Share and NTFS Permissions on a File Server](https://go.microsoft.com/fwlink/?LinkId=245535) (https://go.microsoft.com/fwlink/?LinkId=245535).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="8b4ad-172">对 SMB 共享文件夹的 FULL CONTROL 共享权限和 NTFS 权限应被限制为： [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务帐户、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理服务帐户和具有管理服务器角色的 Windows 用户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-172">The FULL CONTROL share permissions and NTFS permissions on the SMB share folders should be restricted to: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account and windows users with admin server roles.</span></span>  
  
     <span data-ttu-id="8b4ad-173">建议将域帐户用作 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 服务帐户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-173">It is recommended to use domain account as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account.</span></span> <span data-ttu-id="8b4ad-174">如果系统帐户用作服务帐户，则按以下格式为计算机帐户授予权限： _<domain_name>_ **\\** _<computer_name>_ **$** 。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-174">If system account is used as a service account, grant the permissions for the machine account in the format: _<domain_name>_**\\**_<computer_name>_**$**.</span></span>  
  
    > [!NOTE]  
    >  -   <span data-ttu-id="8b4ad-175">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装过程中，如果 SMB 文件共享指定为存储选项，则需要将域帐户指定为服务帐户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-175">During [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup, it is required to specify domain account as a service account if SMB file share is specified as a storage option.</span></span> <span data-ttu-id="8b4ad-176">对于 SMB 文件共享，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装后系统帐户只能指定为服务帐户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-176">With SMB file share, System account can only be specified as a service account post [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation.</span></span>  
    > -   <span data-ttu-id="8b4ad-177">虚拟帐户无法通过身份验证，因而无法访问远程位置。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-177">Virtual accounts cannot be authenticated to a remote location.</span></span> <span data-ttu-id="8b4ad-178">所有虚拟帐户均使用计算机帐户的权限。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-178">All virtual accounts use the permission of machine account.</span></span> <span data-ttu-id="8b4ad-179">以 _<domain_name>_ **\\** _<computer_name>_ **$** 格式设置计算机帐户。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-179">Provision the machine account in the format _<domain_name>_**\\**_<computer_name>_**$**.</span></span>  
  
-   <span data-ttu-id="8b4ad-180">用于安装 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的帐户应该对用作数据目录的 SMB 文件共享文件夹或群集安装过程中的任何其他数据文件夹（用户数据库目录、用户数据库日志目录、TempDB 目录、TempDB 日志目录、备份目录）具有 FULL CONTROL 权限。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-180">The account used to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should have FULL CONTROL permissions on the SMB file share folder used as the data directory, or any other data folders (User database directory, user database log directory, TempDB directory, TempDB log directory, backup directory) during Cluster Setup.</span></span>  
  
-   <span data-ttu-id="8b4ad-181">用于安装 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的帐户应具有对 SMB 文件服务器的 SeSecurityPrivilege 特权。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-181">The account used to install [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should be granted SeSecurityPrivilege privileges on the SMB file server.</span></span> <span data-ttu-id="8b4ad-182">若要授予此特权，请使用文件服务器上的“本地安全策略”控制台将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装帐户添加到“管理审核和安全日志”策略中。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-182">To grant this privilege, use the Local Security Policy console on the file server to add the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup account to the Manage auditing and security log policy.</span></span> <span data-ttu-id="8b4ad-183">在“本地安全策略”控制台中“本地策略”下的“用户权限分配”部分可以找到此设置。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-183">This setting is available in the User Rights Assignments section under Local Policies in the Local Security Policy console.</span></span>  
  
## <a name="known-issues"></a><span data-ttu-id="8b4ad-184">已知问题</span><span class="sxs-lookup"><span data-stu-id="8b4ad-184">Known Issues</span></span>  
  
-   <span data-ttu-id="8b4ad-185">在您分离网络连接的存储设备上的某一 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 数据库后，如果尝试重新连接该 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库，则可能会遇到数据库权限问题。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-185">After you detach a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] database that resides on network-attached storage, you might run into database permission issue while trying to reattach the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="8b4ad-186">该问题在[此知识库文章](https://go.microsoft.com/fwlink/?LinkId=237321) (https://go.microsoft.com/fwlink/?LinkId=237321) 中定义。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-186">The issue is defined in [this KB article](https://go.microsoft.com/fwlink/?LinkId=237321) (https://go.microsoft.com/fwlink/?LinkId=237321).</span></span> <span data-ttu-id="8b4ad-187">若要解决此问题，请参阅该知识库文章中的 **详细信息** 部分。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-187">To work around this issue, see the **More Information** section in the KB article.</span></span>  
  
-   <span data-ttu-id="8b4ad-188">有些第三方（如 NetApp）设备并不支持所有 SQL Server API 调用。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-188">Some third parties, like NetApp device do not support all SQL Server API calls.</span></span> <span data-ttu-id="8b4ad-189">在这些情况中，你可能会收到：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-189">With these you might get:</span></span>   
    <span data-ttu-id="8b4ad-190">2015-06-04 13：14： 19.97 spid9s 错误：17053，严重性：16，状态：1。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-190">2015-06-04 13:14:19.97 spid9s      Error: 17053, Severity: 16, State: 1.</span></span>  
    <span data-ttu-id="8b4ad-191">2015-06-04 13：14： 19.97 spid9s DoDevIoCtlOut ( # A1 Getoverlappedresult 期间 ( # A3：操作系统错误 1 (错误的函数。 ) 遇到。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-191">2015-06-04 13:14:19.97 spid9s      DoDevIoCtlOut() GetOverlappedResult() : Operating system error 1(Incorrect function.) encountered.</span></span>  
  
     <span data-ttu-id="8b4ad-192">对于 NTFS，该错误不会产生任何影响。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-192">For NTFS, the error is harmless.</span></span>  <span data-ttu-id="8b4ad-193">但对于 ReFS，该错误则可能会导致性能明显下降。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-193">but for ReFS, it can lead to significant performance degradation.</span></span>  
  
-   <span data-ttu-id="8b4ad-194">如果将 SMB 文件共享作为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]群集实例的存储选项，默认情况下无法将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 故障转移群集诊断日志写入该文件共享，因为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 资源 DLL 缺乏对该文件共享的读/写权限。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-194">If SMB file share is used as a storage option for a clustered instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], by default the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Failover Cluster Diagnostics Log cannot be written to the file share because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resource DLL lacks the read/write permission on the file share.</span></span> <span data-ttu-id="8b4ad-195">若要解决此问题，请尝试使用以下方法之一：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-195">To resolve this issue, try one of the following methods:</span></span>  
  
    1.  <span data-ttu-id="8b4ad-196">将对该文件共享的读/写权限授予群集中的所有计算机对象。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-196">Grant read/write permissions on the file share to all computer objects in the cluster.</span></span>  
  
    2.  <span data-ttu-id="8b4ad-197">将诊断日志的位置设置为本地文件路径。</span><span class="sxs-lookup"><span data-stu-id="8b4ad-197">Set the location of the diagnostic logs to a local file path.</span></span> <span data-ttu-id="8b4ad-198">请参阅以下示例：</span><span class="sxs-lookup"><span data-stu-id="8b4ad-198">See the following example:</span></span>  
  
        ```sql  
        ALTER SERVER CONFIGURATION  
        SET DIAGNOSTICS LOG PATH = 'C:\logs';  
        ```  
  
## <a name="see-also"></a><span data-ttu-id="8b4ad-199">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8b4ad-199">See Also</span></span>  
 <span data-ttu-id="8b4ad-200">[计划 SQL Server 安装](../../../2014/sql-server/install/planning-a-sql-server-installation.md) </span><span class="sxs-lookup"><span data-stu-id="8b4ad-200">[Planning a SQL Server Installation](../../../2014/sql-server/install/planning-a-sql-server-installation.md) </span></span>  
 <span data-ttu-id="8b4ad-201">[安装操作指南主题](../../../2014/sql-server/install/installation-how-to-topics.md) </span><span class="sxs-lookup"><span data-stu-id="8b4ad-201">[Installation How-to Topics](../../../2014/sql-server/install/installation-how-to-topics.md) </span></span>  
 [<span data-ttu-id="8b4ad-202">配置 Windows 服务帐户和权限</span><span class="sxs-lookup"><span data-stu-id="8b4ad-202">Configure Windows Service Accounts and Permissions</span></span>](../configure-windows/configure-windows-service-accounts-and-permissions.md)  
  
  
