---
title: 安装 SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
ms.assetid: 854c0b2f-02d2-46a4-a8cc-6b7a5d191cf8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 53a2a295e6c38fead219e876cfedf040c2188b52
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688184"
---
# <a name="install-sql-server-powershell"></a><span data-ttu-id="dae77-102">安装 SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="dae77-102">Install SQL Server PowerShell</span></span>
  <span data-ttu-id="dae77-103">如果 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装程序检测到您已选择了包含 PowerShell 组件的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能，但未安装 Windows PowerShell 2.0，则该安装程序将停止运行。</span><span class="sxs-lookup"><span data-stu-id="dae77-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup will stop if it detects that you have selected [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that include PowerShell components, but Windows PowerShell 2.0 is not installed.</span></span> <span data-ttu-id="dae77-104">您必须通过使用 Windows Management Framework 安装 PowerShell，然后重新运行安装程序。</span><span class="sxs-lookup"><span data-stu-id="dae77-104">You must install PowerShell by using the Windows Management Framework, and then rerun Setup.</span></span>  
  
## <a name="installing-ssnoversion-powershell-support"></a><span data-ttu-id="dae77-105">安装 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 支持</span><span class="sxs-lookup"><span data-stu-id="dae77-105">Installing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell Support</span></span>  
 <span data-ttu-id="dae77-106">您通过使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装程序安装为 Windows PowerShell 提供 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 支持的软件。</span><span class="sxs-lookup"><span data-stu-id="dae77-106">You install the software that provides [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] support for Windows PowerShell by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup.</span></span> <span data-ttu-id="dae77-107">在您选择要求 PowerShell 支持的任何 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能时，安装程序将检查是否安装了 Windows PowerShell 2.0。</span><span class="sxs-lookup"><span data-stu-id="dae77-107">When you select any [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features that require PowerShell support, Setup checks that Windows PowerShell 2.0 is installed.</span></span> <span data-ttu-id="dae77-108">如果存在 PowerShell 2.0，安装程序然后将安装以下 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 组件：</span><span class="sxs-lookup"><span data-stu-id="dae77-108">If PowerShell 2.0 is present, Setup then installs the following [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell components:</span></span>  
  
-   <span data-ttu-id="dae77-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 管理单元。这些管理单元是 dll 文件，可用来实现两种类型的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Windows PowerShell 支持：</span><span class="sxs-lookup"><span data-stu-id="dae77-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The snap-ins are dll files that implement two types of Windows PowerShell support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]:</span></span>  
  
    -   <span data-ttu-id="dae77-110">一组 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlet。</span><span class="sxs-lookup"><span data-stu-id="dae77-110">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets.</span></span> <span data-ttu-id="dae77-111">Cmdlet 是用来实现特定操作的命令。</span><span class="sxs-lookup"><span data-stu-id="dae77-111">Cmdlets are commands that implement a specific action.</span></span> <span data-ttu-id="dae77-112">例如， **Invoke-Sqlcmd** 可用于运行 [!INCLUDE[tsql](../../includes/tsql-md.md)] 或 XQuery 脚本，而这些脚本也可使用 **sqlcmd** 实用工具运行， **Invoke-PolicyEvaluation** 用于报告 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 对象是否符合基于策略的管理策略。</span><span class="sxs-lookup"><span data-stu-id="dae77-112">For example, **Invoke-Sqlcmd** runs a [!INCLUDE[tsql](../../includes/tsql-md.md)] or XQuery script that can also be run by using the **sqlcmd** utility, and **Invoke-PolicyEvaluation** reports whether [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects comply with policy-based management policies.</span></span>  
  
    -   <span data-ttu-id="dae77-113">一个 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 提供程序。</span><span class="sxs-lookup"><span data-stu-id="dae77-113">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="dae77-114">通过该提供程序，可以使用类似于文件系统路径的路径，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 对象的层次结构中导航。</span><span class="sxs-lookup"><span data-stu-id="dae77-114">The provider lets you navigate the hierarchy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] objects using a path similar to a file system path.</span></span> <span data-ttu-id="dae77-115">每个对象都与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 管理对象模型中的一个类关联。</span><span class="sxs-lookup"><span data-stu-id="dae77-115">Each object is associated with a class from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management object models.</span></span> <span data-ttu-id="dae77-116">您可以使用该类的方法和属性来针对对象执行工作。</span><span class="sxs-lookup"><span data-stu-id="dae77-116">You can use the methods and properties of the class to perform work on the objects.</span></span> <span data-ttu-id="dae77-117">例如，如果通过 cd 切换到路径中的某个数据库对象，则可以使用 Microsoft.SqlServer.Managment.SMO.Database 类的方法和属性来管理该数据库。</span><span class="sxs-lookup"><span data-stu-id="dae77-117">For example, if you cd to a databases object in a path, you can use the methods and properties of the Microsoft.SqlServer.Managment.SMO.Database class to manage the database.</span></span>  
  
-   <span data-ttu-id="dae77-118">导入到 Windows PowerShell 2.0 会话中以便加载管理单元的**sqlps**模块 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="dae77-118">The **sqlps** module that is imported into Windows PowerShell 2.0 sessions to load the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins.</span></span>  
  
-   <span data-ttu-id="dae77-119">不推荐使用的**sqlps**实用工具，用于启动 Windows PowerShell 2.0 会话并导入**sqlps**模块。</span><span class="sxs-lookup"><span data-stu-id="dae77-119">The deprecated **sqlps** utility that starts a Windows PowerShell 2.0 session and imports the **sqlps** module.</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="dae77-120">支持从对象资源管理器树启动 Windows PowerShell 会话。</span><span class="sxs-lookup"><span data-stu-id="dae77-120">supports starting Windows PowerShell sessions from the Object Explorer tree.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="dae77-121">代理支持 Windows PowerShell 作业步骤。</span><span class="sxs-lookup"><span data-stu-id="dae77-121">Agent supports Windows PowerShell job steps.</span></span>  
  
 <span data-ttu-id="dae77-122">如果 Windows PowerShell 2.0 尚未安装或已卸载，则必须按照[Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214)页上的说明进行安装。</span><span class="sxs-lookup"><span data-stu-id="dae77-122">If Windows PowerShell 2.0 has not been installed, or has been uninstalled, you must install it by following the instructions on the [Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214) page.</span></span>  
  
 <span data-ttu-id="dae77-123">如果在安装程序完成后卸载了 Windows PowerShell，用于 Windows PowerShell 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能将无法使用。</span><span class="sxs-lookup"><span data-stu-id="dae77-123">If Windows PowerShell is uninstalled after Setup finishes, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] features for Windows PowerShell will not function.</span></span> <span data-ttu-id="dae77-124">Windows PowerShell 可由 Windows 用户卸载，某些 Windows 操作系统升级可能会要求卸载 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="dae77-124">Windows PowerShell can be uninstalled by Windows users, and uninstalling Windows PowerShell might be required by some Windows operating system upgrades.</span></span> <span data-ttu-id="dae77-125">若要使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell 功能，您必须通过使用 Windows Management Framework 重新安装 PowerShell 2.0。</span><span class="sxs-lookup"><span data-stu-id="dae77-125">To use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell features, you must reinstall PowerShell 2.0 by using the Windows Management Framework.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dae77-126">另请参阅</span><span class="sxs-lookup"><span data-stu-id="dae77-126">See Also</span></span>  
 [<span data-ttu-id="dae77-127">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="dae77-127">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)  
  
  
