---
title: 升级 PowerPivot for SharePoint |Microsoft Docs
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 80ba9e43-f3f0-4730-9fb1-2afd2dd3e6fc
author: Minewiskan
ms.author: owend
ms.openlocfilehash: bebcfed02aa30ffc686b2a74807b6a4cc3955c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580348"
---
# <a name="upgrade-powerpivot-for-sharepoint"></a><span data-ttu-id="8a0ca-102">升级 PowerPivot for SharePoint</span><span class="sxs-lookup"><span data-stu-id="8a0ca-102">Upgrade PowerPivot for SharePoint</span></span>
  <span data-ttu-id="8a0ca-103">本主题概述将 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 的部署升级到 [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)]所需的步骤。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-103">This topic summarizes the steps required to upgrade a deployment of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] to [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span></span> <span data-ttu-id="8a0ca-104">具体步骤取决于你的环境当前正在运行的 SharePoint 版本，并包括 PowerPivot for SharePoint 外接程序 (**spPowerPivot.msi**) 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-104">The specific steps depend on the version of SharePoint your environment is currently running and include the PowerPivot for SharePoint Add-in (**spPowerPivot.msi**).</span></span>  
  
 <span data-ttu-id="8a0ca-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="8a0ca-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span></span>  
  
 <span data-ttu-id="8a0ca-106">有关发行说明，请参阅[SQL Server 2014 发行说明](https://go.microsoft.com/fwlink/?LinkID=296445)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-106">For release notes, see [SQL Server 2014 Release Notes](https://go.microsoft.com/fwlink/?LinkID=296445).</span></span>  
  

  
## <a name="background"></a><span data-ttu-id="8a0ca-107">背景</span><span class="sxs-lookup"><span data-stu-id="8a0ca-107">Background</span></span>  
  
-   <span data-ttu-id="8a0ca-108">如果要对具有两个或更多 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 实例的多服务器 SharePoint 2010 场进行升级，则必须在完全升级每个服务器 **后** ，才能继续对下一服务器进行升级。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-108">If you are upgrading a multi-server SharePoint 2010 farm that has two or more [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instances, you must fully upgrade each server **before** continuing to the next server.</span></span> <span data-ttu-id="8a0ca-109">完全升级包括运行 SQL Server 安装程序以升级 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 程序文件，然后执行 SharePoint 升级操作以便配置升级后的服务。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-109">A full upgrade includes running SQL Server Setup to upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] program files, followed by SharePoint upgrade actions that configure the upgraded services.</span></span> <span data-ttu-id="8a0ca-110">在适当的 PowerPivot 配置工具或 Windows PowerShell 中执行升级操作之前，服务器的可用性将受到限制。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-110">Server availability will be limited until you run upgrade actions in the appropriate PowerPivot Configuration Tool or Windows PowerShell.</span></span>  
  
-   <span data-ttu-id="8a0ca-111">SharePoint 2010 场中 PowerPivot 系统服务和 Analysis Services 的所有实例必须为相同版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-111">All instances of PowerPivot System Service and Analysis Services in a SharePoint 2010 farm must be the same version.</span></span> <span data-ttu-id="8a0ca-112">有关如何验证版本的信息，请参阅本主题中的[验证 PowerPivot 组件和服务的版本](#bkmk_verify_versions)部分。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-112">For information on how to verify the version, see the section [Verify the Versions of PowerPivot Components and Services](#bkmk_verify_versions) in this topic.</span></span>  
  
-   <span data-ttu-id="8a0ca-113">PowerPivot 配置工具是 SQL Server 共享功能之一，所有共享功能同时升级。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-113">The PowerPivot configuration tools are one of the SQL Server shared features and all shared features upgrade at the same time.</span></span> <span data-ttu-id="8a0ca-114">如果在升级过程中选择需要共享功能升级的其他 SQL Server 实例或功能，则将一同升级 PowerPivot 配置工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-114">If during an upgrade process you select other SQL Server instances or features that require a shared feature upgrade, then the PowerPivot configuration tool will also be upgraded.</span></span> <span data-ttu-id="8a0ca-115">如果该 PowerPivot 配置工具已升级，但您的 PowerPivot 实例未升级，可能会导致问题。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-115">You may have issues if the PowerPivot configuration tool is upgraded but your PowerPivot instance is not.</span></span> <span data-ttu-id="8a0ca-116">有关 SQL Server 共享功能的详细信息，请参阅[使用安装向导 &#40;安装&#41;升级到 SQL Server 2014 ](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-116">For more information about SQL Server shared features, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
-   <span data-ttu-id="8a0ca-117">PowerPivot for SharePoint 外接程序 (**spPowerPivot.msi**) 与以前的版本并行安装。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-117">The PowerPivot for SharePoint Add-in (**spPowerPivot.msi**) installs side by side with previous versions.</span></span> <span data-ttu-id="8a0ca-118">例如， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 外接程序安装到文件夹 `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-118">For example the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] add-in installs to the folder `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span></span>  
  

  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a><span data-ttu-id="8a0ca-119">先决条件</span><span class="sxs-lookup"><span data-stu-id="8a0ca-119">Prerequisites</span></span>  
 <span data-ttu-id="8a0ca-120">**权限**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-120">**Permissions**</span></span>  
  
-   <span data-ttu-id="8a0ca-121">您必须是场管理员才能对 PowerPivot for SharePoint 安装进行升级。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-121">You must be a farm administrator to upgrade a PowerPivot for SharePoint installation.</span></span> <span data-ttu-id="8a0ca-122">您必须是本地管理员才能运行 SQL Server 安装程序。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-122">You must be a local administrator to run SQL Server Setup.</span></span>  
  
-   <span data-ttu-id="8a0ca-123">必须对场配置数据库具有 **db_owner** 权限。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-123">You must have **db_owner** permissions on the farm configuration database.</span></span>  
  
 <span data-ttu-id="8a0ca-124">**SQL Server：**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-124">**SQL Server:**</span></span>  
  
-   <span data-ttu-id="8a0ca-125">如果现有 PowerPivot 安装是 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] ，则 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 需要将 Service Pack 2 (SP2) 升级到 [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-125">If the existing PowerPivot installation is [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="8a0ca-126">如果现有 PowerPivot 安装是 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] ，则 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 升级到需要 Service Pack 1 (SP1) [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-126">If the existing PowerPivot installation is [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="8a0ca-127">**SharePoint 2010：**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-127">**SharePoint 2010:**</span></span>  
  
-   <span data-ttu-id="8a0ca-128">如果现有安装运行的是 SharePoint 2010，则必须安装 SharePoint 2010 Service Pack 2 才能升级到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-128">If the existing installation is running SharePoint 2010, install the SharePoint 2010 Service Pack 2 before upgrading to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="8a0ca-129">有关详细信息，请参阅 [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-129">For more information, see [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span></span> <span data-ttu-id="8a0ca-130">使用 PowerShell 命令 `(Get-SPfarm).BuildVersion.ToString()` 验证版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-130">Use the PowerShell command `(Get-SPfarm).BuildVersion.ToString()` to verify the version.</span></span> <span data-ttu-id="8a0ca-131">若要引用发布日期之前的内部版本，请参阅 [SharePoint 2010 内部版本号](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-131">To reference the build version to release date, see [SharePoint 2010 Build Numbers](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2013-farm"></a><a name="bkmk_uprgade_sharepoint2013"></a> <span data-ttu-id="8a0ca-132">升级现有的 SharePoint 2013 场</span><span class="sxs-lookup"><span data-stu-id="8a0ca-132">Upgrade an Existing SharePoint 2013 Farm</span></span>  
 <span data-ttu-id="8a0ca-133">若要升级在 SharePoint 2013 中部署的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-133">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2013, do the following:</span></span>  
  
 <span data-ttu-id="8a0ca-134">![PowerPivot for SharePoint 2013 升级](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "PowerPivot for SharePoint 2013 升级")</span><span class="sxs-lookup"><span data-stu-id="8a0ca-134">![powerpivot for sharepoint 2013 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "powerpivot for sharepoint 2013 upgrade")</span></span>  
  
1.  <span data-ttu-id="8a0ca-135">在以 SharePoint 模式运行 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的后端服务器上运行 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 安装程序。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-135">Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup on backend server(s) that run [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode.</span></span> <span data-ttu-id="8a0ca-136">如果服务器承载 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]的多个实例，请至少升级 **POWERPIVOT** 实例。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-136">If the server hosts multiple instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], upgrade at least the **POWERPIVOT** instance.</span></span> <span data-ttu-id="8a0ca-137">以下列表概述了与 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 升级相关的安装向导步骤：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-137">The following list is a summary of setup wizard steps related to a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] upgrade:</span></span>  
  
    1.  <span data-ttu-id="8a0ca-138">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装向导中单击 **“安装”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-138">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup Wizard, click **Installation**.</span></span>  
  
    2.  <span data-ttu-id="8a0ca-139">单击“从 SQL Server 升级...”。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-139">Click **Upgrade from SQL Server.....**.</span></span>  
  
    3.  <span data-ttu-id="8a0ca-140">在 **“选择实例”** 页上，选择 **POWERPIVOT** 实例名，然后单击 **“下一步”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-140">On the **Select Instance** page, select the **POWERPIVOT** instance name and then click **Next**.</span></span>  
  
    4.  <span data-ttu-id="8a0ca-141">有关详细信息，请参阅[使用安装向导升级到 SQL Server 2014 &#40;安装程序&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span><span class="sxs-lookup"><span data-stu-id="8a0ca-141">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span></span>  
  
2.  <span data-ttu-id="8a0ca-142">重新启动服务器。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-142">Restart the server.</span></span>  
  
3.  <span data-ttu-id="8a0ca-143">在 SharePoint 2013 场中的每个服务器上运行 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint 外接程序 (**spPowerPivot.msi**) 以安装数据访问接口。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-143">Run the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint add-in (**spPowerPivot.msi**) on each server in the SharePoint 2013 farm to install the data providers.</span></span> <span data-ttu-id="8a0ca-144">您从中运行 SQL Server 安装向导的服务器除外，安装向导也将升级数据访问接口。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-144">The exception is servers where you ran the SQL Server setup wizard, which also upgrades data providers.</span></span> <span data-ttu-id="8a0ca-145">有关详细信息，请参阅[在 SharePoint 2013&#41;中安装或卸载 PowerPivot for SharePoint 外接程序 &#40;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-145">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
4.  <span data-ttu-id="8a0ca-146">在其中一个 SharePoint 应用程序服务器上**运行 PowerPivot for SharePoint 2013 配置**工具，以便用该外接程序安装的更新解决方案文件配置 SharePoint 场。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-146">**Run the PowerPivot for SharePoint 2013 Configuration** tool on one of the SharePoint application servers to configure the SharePoint farm with the updated solution files that the add-in installed.</span></span> <span data-ttu-id="8a0ca-147">不能使用 SharePoint 管理中心执行此步骤。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-147">You cannot use Central SharePoint Administration for this step.</span></span> <span data-ttu-id="8a0ca-148">有关详细信息，请参阅以下主题：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-148">For more information, see the following:</span></span>  
  
    1.  <span data-ttu-id="8a0ca-149">在 Windows 的 "开始" 页中，键入**PowerPivot** ，然后在搜索结果中单击 " **PowerPivot for SharePoint 2013 配置**"。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-149">From the Windows Start page, type **PowerPivot** and in the search results, click **PowerPivot for SharePoint 2013 Configuration**.</span></span> <span data-ttu-id="8a0ca-150">请注意，搜索可能会返回配置工具的两个版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-150">Note the search may return both versions of the configuration tool.</span></span>  
  
         <span data-ttu-id="8a0ca-151">![两个 PowerPivot 配置工具](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "两个 PowerPivot 配置工具")</span><span class="sxs-lookup"><span data-stu-id="8a0ca-151">![two powerpivot configuratoin tools](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "two powerpivot configuratoin tools")</span></span>  
  
         <span data-ttu-id="8a0ca-152">或</span><span class="sxs-lookup"><span data-stu-id="8a0ca-152">Or</span></span>  
  
         <span data-ttu-id="8a0ca-153">在 "**开始**" 菜单上，指向 "**所有程序**"，单击 [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)] ，单击 "**配置工具**"，然后单击 " **PowerPivot for SharePoint 2013 配置**"。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-153">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot for SharePoint 2013 Configuration Too**.</span></span> <span data-ttu-id="8a0ca-154">请注意，只有在本地服务器上安装了 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 后，才会列出此工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-154">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="8a0ca-155">启动时，该配置工具会检查 PowerPivot 场解决方案和 PowerPivot Web 应用程序解决方案的升级状态。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-155">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="8a0ca-156">如果检测到这些解决方案的较旧版本，你将看到消息 "**已检测到 PowerPivot 解决方案文件的较新版本。请选择升级选项以升级你的场**。 "</span><span class="sxs-lookup"><span data-stu-id="8a0ca-156">If older versions of these solutions are detected, you will see the message "**Newer versions of the PowerPivot solution files have been detected. Please select the upgrade option to upgrade your farm**."</span></span> <span data-ttu-id="8a0ca-157">单击“确定”  关闭系统验证消息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-157">Click **OK** to close the system validation message.</span></span>  
  
    3.  <span data-ttu-id="8a0ca-158">单击 **“升级功能、服务、应用程序和解决方案”** ，然后单击 **“确定”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-158">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="8a0ca-159">查看左侧窗格任务列表中的操作，并排除您不希望该工具执行的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-159">Review the actions in the left pane task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="8a0ca-160">默认情况下包括所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-160">All actions are included by default.</span></span> <span data-ttu-id="8a0ca-161">若要删除某个操作，请在左侧任务列表中选择此操作，然后在 **“参数”** 页上清除 **“在任务列表中包括此操作”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-161">To remove an action, select it in the left task list, and then on the **Parameters** page, clear the **Include this action in the task list** checkbox.</span></span>  
  
    5.  <span data-ttu-id="8a0ca-162">或者，查看 **“脚本”** 或 **“输出”** 选项卡中的详细信息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-162">Optionally, review detailed information in the **Script** or **Output** tab.</span></span>  
  
         <span data-ttu-id="8a0ca-163">“输出”选项卡汇总了将由该工具执行的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-163">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="8a0ca-164">此信息保存在位于 `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`的日志文件中。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-164">This information is saved in log files at `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span></span>  
  
         <span data-ttu-id="8a0ca-165">“脚本”选项卡显示 PowerShell cmdlet，或引用该工具将运行的 PowerShell 脚本文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-165">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    6.  <span data-ttu-id="8a0ca-166">单击 **“验证”** 可检查每个操作是否有效。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-166">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="8a0ca-167">如果 **“验证”** 不可用，这意味着所有操作都适用于您的系统。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-167">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="8a0ca-168">如果“验证” 可用，你可能修改了某个输入值（例如 Excel 服务应用程序名称），或是该工具可能已确定无法执行某个操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-168">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="8a0ca-169">如果无法执行某个操作，您必须排除它，或修复导致该操作被标记为无效的基本条件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-169">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="8a0ca-170">第一项操作 **“升级场解决方案”** 必须始终最先处理。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-170">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="8a0ca-171">它注册用于配置服务器的 PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-171">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="8a0ca-172">如果此操作出错，不要继续操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-172">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="8a0ca-173">应该使用错误中提供的信息诊断并解决该问题，然后继续处理任务列表中的其他操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-173">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    7.  <span data-ttu-id="8a0ca-174">单击 **“运行”** 执行对此任务有效的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-174">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="8a0ca-175">只有通过验证检查后， **“运行”** 才可用。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-175">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="8a0ca-176">当你单击“运行”时，出现以下警告，提醒你将在批处理模式下执行操作：“该工具中所有标记为有效的配置设置将应用于 SharePoint 场 **。是否继续?** ”。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-176">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "**All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm. Do you want to continue?**".</span></span>  
  
    8.  <span data-ttu-id="8a0ca-177">单击 **“是”** 继续操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-177">Click **Yes** to continue.</span></span>  
  
    9. <span data-ttu-id="8a0ca-178">升级场中的解决方案和功能可能要花几分钟才能完成。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-178">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="8a0ca-179">在此期间，对 PowerPivot 数据的连接请求**将失败**，并出现类似于 "**无法刷新数据**" 或 "**尝试执行请求的操作时出错。请重试**。 "</span><span class="sxs-lookup"><span data-stu-id="8a0ca-179">During this time, connection requests for PowerPivot data **will fail** with errors similar to "**Unable to refresh data**" or "**An error has occurred trying to perform the requested action. Please try again**."</span></span> <span data-ttu-id="8a0ca-180">升级完成后，服务器将变为可用，这些错误将不会再出现。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-180">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
     <span data-ttu-id="8a0ca-181">有关详细信息，请参阅以下主题：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-181">For more information, see the following:</span></span>  
  
    -   [<span data-ttu-id="8a0ca-182">PowerPivot Configuration Tools</span><span class="sxs-lookup"><span data-stu-id="8a0ca-182">PowerPivot Configuration Tools</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools)  
  
    -   [<span data-ttu-id="8a0ca-183">配置或修复 PowerPivot for SharePoint 2013 &#40;PowerPivot 配置工具&#41;</span><span class="sxs-lookup"><span data-stu-id="8a0ca-183">Configure or Repair PowerPivot for SharePoint 2013 &#40;PowerPivot Configuration Tool&#41;</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013)  
  
    -   [<span data-ttu-id="8a0ca-184">使用 Windows PowerShell 配置 PowerPivot</span><span class="sxs-lookup"><span data-stu-id="8a0ca-184">PowerPivot Configuration using Windows PowerShell</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-using-windows-powershell)  
  
    -   [<span data-ttu-id="8a0ca-185">针对 PowerPivot for SharePoint 的 PowerShell 参考</span><span class="sxs-lookup"><span data-stu-id="8a0ca-185">PowerShell Reference for PowerPivot for SharePoint</span></span>](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint)  
  
5.  <span data-ttu-id="8a0ca-186">请通过执行升级后步骤以及通过检查场中 PowerPivot 服务器的版本，确认升级成功。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-186">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="8a0ca-187">有关详细信息，请参阅本主题中的 [升级后的验证任务](#verify) 以及下面的部分。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-187">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2010-farm"></a><a name="bkmk_uprgade_sharepoint2010"></a> <span data-ttu-id="8a0ca-188">升级现有的 SharePoint 2010 场</span><span class="sxs-lookup"><span data-stu-id="8a0ca-188">Upgrade an Existing SharePoint 2010 Farm</span></span>  
 <span data-ttu-id="8a0ca-189">若要升级在 SharePoint 2010 中部署的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-189">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2010, do the following:</span></span>  
  
 <span data-ttu-id="8a0ca-190">![PowerPivot for SharePoint 2010 升级](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "PowerPivot for SharePoint 2010 升级")</span><span class="sxs-lookup"><span data-stu-id="8a0ca-190">![powerpivot for sharepoint 2010 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "powerpivot for sharepoint 2010 upgrade")</span></span>  
  
1.  <span data-ttu-id="8a0ca-191">下载 [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) 并将其应用于场中的所有服务器。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-191">Download [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) and apply it on all servers in the farm.</span></span> <span data-ttu-id="8a0ca-192">验证 SharePoint SP2 安装是否成功。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-192">Verify that SharePoint SP2 installation succeeded.</span></span> <span data-ttu-id="8a0ca-193">在管理中心中的“升级和迁移”页上，打开“检查产品和修补程序安装状态”页，以查看与 SP2 相关的状态消息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-193">In Central Administration, on the Upgrade and Migration page, open the Check product and patch installation status page to view status messages related to SP2.</span></span>  
  
2.  <span data-ttu-id="8a0ca-194">验证“SharePoint 2010 管理”Windows 服务是否正在运行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-194">Verify that the SharePoint 2010 Administration Windows service is running.</span></span>  
  
    ```powershell
    Get-Service | Where {$_.displayname -like "*SharePoint*"}  
    ```  
  
3.  <span data-ttu-id="8a0ca-195">验证是否已在 SharePoint 管理中心启动**sharepoint** services **SQL Server Analysis Services**和**SQL Server PowerPivot 系统服务**，或者使用以下 PowerShell 命令：。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-195">Verify the **SharePoint** services **SQL Server Analysis Services** and **SQL Server PowerPivot System Service** are started in SharePoint Central Administration or use the following PowerShell command:.</span></span>  
  
    ```powershell
    Get-SPServiceInstance | where {$_.typename -like "*sql*"}  
    ```  
  
4.  <span data-ttu-id="8a0ca-196">验证**Windows**服务\*\*SQL Server Analysis Services (PowerPivot) \*\*是否正在运行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-196">Verify the **Windows** service **SQL Server Analysis Services (PowerPivot)** is running.</span></span>  
  
    ```powershell
    Get-Service | where {$_.displayname -like "*powerpivot*"}  
    ```  
  
5.  <span data-ttu-id="8a0ca-197">**运行 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]** 在运行 SQL Server Analysis Services 的第一个 SharePoint 应用程序服务器上安装\*\* (powerpivot) \*\* Windows 服务来升级 PowerPivot 实例。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-197">**Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup** on the first SharePoint application server that runs the **SQL Server Analysis Services (PowerPivot)** Windows service to upgrade the POWERPIVOT instance.</span></span> <span data-ttu-id="8a0ca-198">在 SQL Server 安装向导的“安装”页上选择升级选项。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-198">On the Installation page of the SQL Server Setup Wizard, choose the upgrade option.</span></span> <span data-ttu-id="8a0ca-199">有关详细信息，请参阅[使用安装向导升级到 SQL Server 2014 &#40;安装&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-199">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
6.  <span data-ttu-id="8a0ca-200">在运行配置工具前**重新启动服务器** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-200">**Restart the server** before running the configuration tool.</span></span> <span data-ttu-id="8a0ca-201">此步骤可确保 SQL Server 安装程序安装的所有更新或必备组件在系统上得到完全配置。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-201">This step ensures that any updates or prerequisites installed by SQL Server Setup are fully configured on the system.</span></span>  
  
7.  <span data-ttu-id="8a0ca-202">在运行 SQL Server Analysis Services (PowerPivot) 服务的第一个 SharePoint 应用程序服务器上**运行 PowerPivot 配置工具**，以在 SharePoint 中升级解决方案和 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-202">**Run the PowerPivot Configuration Tool** on the first SharePoint application server that runs SQL Server Analysis Services (PowerPivot) service to upgrade the solutions and Web services in SharePoint.</span></span> <span data-ttu-id="8a0ca-203">不能使用管理中心执行此步骤。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-203">You cannot use Central Administration for this step.</span></span>  
  
    1.  <span data-ttu-id="8a0ca-204">在 **“开始”** 菜单中，指向 **“所有程序”**，依次单击 [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)]、 **“配置工具”** 和 **“PowerPivot 配置工具”**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-204">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot Configuration Tool**.</span></span> <span data-ttu-id="8a0ca-205">请注意，只有在本地服务器上安装了 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 后，才会列出此工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-205">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="8a0ca-206">启动时，该配置工具会检查 PowerPivot 场解决方案和 PowerPivot Web 应用程序解决方案的升级状态。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-206">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="8a0ca-207">如果检测到这些解决方案的较旧版本，你将看到消息 "已检测到 PowerPivot 解决方案文件的较新版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-207">If older versions of these solutions are detected, you will see the message "Newer versions of the PowerPivot solution files have been detected.</span></span> <span data-ttu-id="8a0ca-208">请选择升级选项以升级场。”</span><span class="sxs-lookup"><span data-stu-id="8a0ca-208">Please select the upgrade option to upgrade your farm."</span></span> <span data-ttu-id="8a0ca-209">单击“确定”  关闭消息框。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-209">Click **OK** to close the message.</span></span>  
  
    3.  <span data-ttu-id="8a0ca-210">单击 **“升级功能、服务、应用程序和解决方案”** ，然后单击 **“确定”** 继续操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-210">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK** to continue.</span></span>  
  
    4.  <span data-ttu-id="8a0ca-211">出现以下警告： "PowerPivot 管理面板中的工作簿将要升级到最新版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-211">The following warning appears: "Workbooks in the PowerPivot Management Dashboard are about to be upgraded to the latest version.</span></span> <span data-ttu-id="8a0ca-212">您对现有工作簿进行的所有定制都将丢失。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-212">Any customizations you made to the existing workbooks will be lost.</span></span> <span data-ttu-id="8a0ca-213">是否继续?”</span><span class="sxs-lookup"><span data-stu-id="8a0ca-213">Do you want to continue?"</span></span>  
  
         <span data-ttu-id="8a0ca-214">此警告指的是报告数据刷新活动的 PowerPivot 管理面板中的工作簿。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-214">This warning refers to workbooks in the PowerPivot Management Dashboard that report on data refresh activity.</span></span> <span data-ttu-id="8a0ca-215">如果您已经自定义了这些工作簿，当使用新版本替换现有文件时，对这些工作簿的所有修改都将丢失。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-215">If you customized these workbooks, any changes you made to those workbooks will be lost when existing files are replaced with newer versions.</span></span>  
  
         <span data-ttu-id="8a0ca-216">单击 **“是”** 可使用较新版本覆盖这些工作簿。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-216">Click **Yes** to overwrite the workbooks with newer versions.</span></span> <span data-ttu-id="8a0ca-217">否则，单击 **“否”** 可返回主页。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-217">Otherwise, click **No** to return to the home page.</span></span> <span data-ttu-id="8a0ca-218">将工作簿保存到不同位置，以便留有副本，然后在准备好继续操作后返回到此步骤。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-218">Save the workbooks to a different location so that you have a copy, and then return to this step when you are ready to continue.</span></span>  
  
         <span data-ttu-id="8a0ca-219">有关自定义面板中使用的工作簿的详细信息，请参阅[自定义 PowerPivot 管理面板](https://go.microsoft.com/fwlink/?linkID=229639)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-219">For more information about customizing workbooks used in the dashboard, see [Customizing the PowerPivot Management Dashboard](https://go.microsoft.com/fwlink/?linkID=229639).</span></span>  
  
    5.  <span data-ttu-id="8a0ca-220">查看任务列表中的操作，并排除您不希望该工具来执行的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-220">Review the actions in the task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="8a0ca-221">默认情况下包括所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-221">All actions are included by default.</span></span> <span data-ttu-id="8a0ca-222">若要删除某个操作，请在任务列表中选择它，然后清除“参数”页上的 **“在任务列表中包括此操作”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-222">To remove an action, select it in the task list, and then clear the **Include this action in the task list** checkbox on the Parameters page.</span></span>  
  
    6.  <span data-ttu-id="8a0ca-223">或者，检查 **“输出”** 选项卡或 **“脚本”** 选项卡中的详细信息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-223">Optionally, review detailed information in the **Output** tab or **Script** tab.</span></span>  
  
         <span data-ttu-id="8a0ca-224">“输出”选项卡汇总了将由该工具执行的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-224">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="8a0ca-225">此信息保存在位于 `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`的日志文件中。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-225">This information is saved in log files at `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span></span>  
  
         <span data-ttu-id="8a0ca-226">“脚本”选项卡显示 PowerShell cmdlet，或引用该工具将运行的 PowerShell 脚本文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-226">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    7.  <span data-ttu-id="8a0ca-227">单击 **“验证”** 可检查每个操作是否有效。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-227">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="8a0ca-228">如果 **“验证”** 不可用，这意味着所有操作都适用于您的系统。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-228">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="8a0ca-229">如果“验证” 可用，你可能修改了某个输入值（例如 Excel 服务应用程序名称），或是该工具可能已确定无法执行某个操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-229">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="8a0ca-230">如果无法执行某个操作，您必须排除它，或修复导致该操作被标记为无效的基本条件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-230">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="8a0ca-231">第一项操作 **“升级场解决方案”** 必须始终最先处理。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-231">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="8a0ca-232">它注册用于配置服务器的 PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-232">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="8a0ca-233">如果此操作出错，不要继续操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-233">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="8a0ca-234">应该使用错误中提供的信息诊断并解决该问题，然后继续处理任务列表中的其他操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-234">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    8.  <span data-ttu-id="8a0ca-235">单击 **“运行”** 执行对此任务有效的所有操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-235">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="8a0ca-236">只有通过验证检查后， **“运行”** 才可用。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-236">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="8a0ca-237">当你单击“运行”时，出现以下警告，提醒你将在批处理模式下执行操作：“该工具中所有标记为有效的配置设置将应用于 SharePoint 场。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-237">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm.</span></span> <span data-ttu-id="8a0ca-238">是否继续?”</span><span class="sxs-lookup"><span data-stu-id="8a0ca-238">Do you want to continue?"</span></span>  
  
    9. <span data-ttu-id="8a0ca-239">单击 **“是”** 继续操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-239">Click **Yes** to continue.</span></span>  
  
    10. <span data-ttu-id="8a0ca-240">升级场中的解决方案和功能可能要花几分钟才能完成。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-240">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="8a0ca-241">在此期间，对 PowerPivot 数据的连接请求将失败，并出现错误，如 "无法刷新数据" 或 "尝试执行请求的操作时出错。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-241">During this time, connection requests for PowerPivot data will fail with errors like "Unable to refresh data" or "An error has occurred trying to perform the requested action.</span></span> <span data-ttu-id="8a0ca-242">请重试。”</span><span class="sxs-lookup"><span data-stu-id="8a0ca-242">Please try again."</span></span> <span data-ttu-id="8a0ca-243">升级完成后，服务器将变为可用，这些错误将不会再出现。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-243">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
8.  <span data-ttu-id="8a0ca-244">对场中的每个 SQL Server Analysis Services (PowerPivot) 服务**重复该过程**： 1) 运行 SQL Server 安装程序 2) 运行 PowerPivot 配置工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-244">**Repeat the process** for each SQL Server Analysis Services (PowerPivot) service in the farm: 1) Run SQL Server setup 2) Run the PowerPivot Configuration tool.</span></span>  
  
9. <span data-ttu-id="8a0ca-245">请通过执行升级后步骤以及通过检查场中 PowerPivot 服务器的版本，确认升级成功。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-245">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="8a0ca-246">有关详细信息，请参阅本主题中的 [升级后的验证任务](#verify) 以及下面的部分。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-246">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
10. <span data-ttu-id="8a0ca-247">**解决错误**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-247">**Troubleshooting errors**</span></span>  
  
     <span data-ttu-id="8a0ca-248">您可以在“参数”窗格中查看每个操作的错误信息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-248">You can view error information in the Parameters pane for each action.</span></span>  
  
     <span data-ttu-id="8a0ca-249">对于与解决方案部署或收回相关的问题，请验证是否已启动 SharePoint 2010 管理服务。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-249">For problems related to solution deployment or retraction, verify the SharePoint 2010 Administrator service is started.</span></span> <span data-ttu-id="8a0ca-250">此服务运行可触发场中配置更改的计时器作业。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-250">This service runs the timer jobs that trigger configuration changes in a farm.</span></span> <span data-ttu-id="8a0ca-251">如果该服务未运行，解决方案部署或收回将失败。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-251">If the service is not running, solution deployment or retraction will fail.</span></span> <span data-ttu-id="8a0ca-252">持续出现的错误表示现有的部署或收回作业已存在于队列中，阻止配置工具执行进一步的操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-252">Persistent errors indicate that an existing deployment or retraction job is already in the queue and blocking further action from the configuration tool.</span></span>  
  
    1.  <span data-ttu-id="8a0ca-253">以管理员身份启动 SharePoint 2010 Management Shell，然后运行以下命令查看队列中的作业：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-253">Start the SharePoint 2010 Management Shell as an administrator and then run the following command to view jobs in the queue:</span></span>  
  
        ```cmd
        stsadm -o enumdeployments  
        ```  
  
    2.  <span data-ttu-id="8a0ca-254">检查现有部署的以下信息：“类型”是收回或部署，“文件”为 powerpivotwebapp.wsp 或 powerpivotfarm.wsp 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-254">Review existing deployments for the following information: **Type** is Retraction or Deployment, **File** is powerpivotwebapp.wsp or powerpivotfarm.wsp.</span></span>  
  
    3.  <span data-ttu-id="8a0ca-255">对于与 PowerPivot 解决方案相关的部署或收回，请复制**JobId**的 GUID 值，然后将其粘贴到以下命令中 (使用 Shell 的 "编辑" 菜单上的 "标记"、"复制" 和 "粘贴" 命令复制 GUID) ：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-255">For deployments or retractions related to PowerPivot solutions, copy the GUID value for **JobId** and then paste it into the following command (use the Mark, Copy, and Paste commands on the Shell's Edit menu to copy the GUID):</span></span>  
  
        ```cmd
        stsadm -o canceldeployment -id "<GUID>"  
        ```  
  
    4.  <span data-ttu-id="8a0ca-256">通过依次单击 **“验证”** 和 **“运行”** ，在该配置工具中重试该任务。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-256">Retry the task in the configuration tool by clicking **Validate** followed by **Run**.</span></span>  
  
     <span data-ttu-id="8a0ca-257">对于其他所有错误，请查看 ULS 日志。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-257">For all other errors, check the ULS logs.</span></span> <span data-ttu-id="8a0ca-258">有关详细信息，请参阅[配置和查看 SharePoint 日志文件和诊断日志记录 &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-258">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span></span>  
  

  
##  <a name="workbooks"></a><a name="bkmk_workbooks"></a> <span data-ttu-id="8a0ca-259">工作簿</span><span class="sxs-lookup"><span data-stu-id="8a0ca-259">Workbooks</span></span>  
 <span data-ttu-id="8a0ca-260">升级服务器不一定升级在其上运行的 PowerPivot 工作簿，但在 PowerPivot for Excel 早期版本中创建的旧工作簿会使用在该版本中提供的功能继续像以前那样工作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-260">Upgrading a server does not necessarily upgrade the PowerPivot workbooks that run on it, but older workbooks created in the previous version of PowerPivot for Excel will continue to work as before, using the features available in that release.</span></span> <span data-ttu-id="8a0ca-261">工作簿仍正常工作，因为已升级的服务器具有是以前安装一部分的 Analysis Services OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-261">Workbooks remain functional because an upgraded server has the version of the Analysis Services OLE DB provider that was part of the previous installation.</span></span>  
  
  
  
##  <a name="data-refresh"></a><a name="bkmk_datarefresh"></a> <span data-ttu-id="8a0ca-262">数据刷新</span><span class="sxs-lookup"><span data-stu-id="8a0ca-262">Data Refresh</span></span>  
 <span data-ttu-id="8a0ca-263">升级将影响数据刷新操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-263">Upgrade will impact data refresh operations.</span></span> <span data-ttu-id="8a0ca-264">服务器上的预定数据刷新仅可用于与服务器版本匹配的工作簿。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-264">Scheduled data refresh on the server is available only for workbooks that match the server version.</span></span> <span data-ttu-id="8a0ca-265">如果承载的是先前版本的工作簿，对于这些工作簿，数据刷新可能不再工作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-265">If you are hosting workbooks from the previous version, data refresh might no longer work for those workbooks.</span></span> <span data-ttu-id="8a0ca-266">要重新启用数据刷新，您必须升级工作簿。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-266">To re-enable data refresh, you must upgrade the workbooks.</span></span> <span data-ttu-id="8a0ca-267">可以在 PowerPivot for Excel 中手动升级每个工作簿，或为 SharePoint 2010 中的数据刷新功能启用自动升级。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-267">You can upgrade each workbook manually in PowerPivot for Excel, or enable the auto-upgrade for data refresh feature in SharePoint 2010.</span></span> <span data-ttu-id="8a0ca-268">自动更新功能会在运行数据刷新前将工作簿升级到当前版本，而使数据刷新操作仍按计划执行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-268">Auto-upgrade will upgrade a workbook to the current version prior to running data refresh, allowing data refresh operations to remain on schedule.</span></span>  
  

  
##  <a name="verify-the-versions-of-powerpivot-components-and-services"></a><a name="bkmk_verify_versions"></a><span data-ttu-id="8a0ca-269">验证 PowerPivot 组件和服务的版本</span><span class="sxs-lookup"><span data-stu-id="8a0ca-269">Verify the Versions of PowerPivot Components and Services</span></span>  
 <span data-ttu-id="8a0ca-270">[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 系统服务和 Analysis Services 的所有实例必须为相同版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-270">All instances of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System Service and Analysis Services must be the same version.</span></span> <span data-ttu-id="8a0ca-271">若要验证所有服务器组件是否都属于同一版本，请检查以下各项的版本信息：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-271">To verify that all server components are at the same version, check version information for the following:</span></span>  
  
### <a name="verify-the-version-of-powerpivot-solutions-and-the-powerpivot-system-service"></a><span data-ttu-id="8a0ca-272">验证 PowerPivot 解决方案和 PowerPivot 系统服务的版本</span><span class="sxs-lookup"><span data-stu-id="8a0ca-272">Verify the version of PowerPivot Solutions and the PowerPivot System Service</span></span>  
 <span data-ttu-id="8a0ca-273">运行以下 PowerShell 命令：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-273">Run the following PowerShell command:</span></span>  
  
```powershell
Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="8a0ca-274">验证 **CurrentSolutionVersion**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-274">Verify the **CurrentSolutionVersion**.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="8a0ca-275">的版本为 12.0 \<major build> 。\<minor build></span><span class="sxs-lookup"><span data-stu-id="8a0ca-275">is version 12.0.\<major build>.\<minor build></span></span>  
  
### <a name="verify-the-version-of-the-analysis-services-windows-service"></a><span data-ttu-id="8a0ca-276">验证 Analysis Services Windows 服务的版本</span><span class="sxs-lookup"><span data-stu-id="8a0ca-276">Verify the version of the Analysis Services Windows Service</span></span>  
 <span data-ttu-id="8a0ca-277">如果您只升级了 SharePoint 2010 场中的某些 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 服务器，则未升级服务器上的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例可能比场中预期的版本旧。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-277">If you upgraded only some of your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] servers in a SharePoint 2010 farm, the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] on un-upgraded servers will be older than the version expected in the farm.</span></span> <span data-ttu-id="8a0ca-278">您需要将所有的服务器升级到相同的版本，以便它们可以使用。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-278">You will need to upgrade all of your servers to the same version in order for them to be usable.</span></span> <span data-ttu-id="8a0ca-279">使用以下方法之一验证每台计算机上的 SQL Server Analysis Services (PowerPivot) Windows 服务的版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-279">Use one of the following methods to verify the version of the SQL Server Analysis Services (PowerPivot) Windows service on each computer.</span></span>  
  
 <span data-ttu-id="8a0ca-280">**Windows 文件资源管理器**：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-280">**Windows File Explorer**:</span></span>  
  
1.  <span data-ttu-id="8a0ca-281">导航到 **实例的** Bin [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 文件夹。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-281">Navigate to the **Bin** folder for the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] instance.</span></span> <span data-ttu-id="8a0ca-282">例如，`C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-282">For example `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span></span>  
  
2.  <span data-ttu-id="8a0ca-283">右键单击 `msmdsrv.exe` 并选择“属性”。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-283">Right-click `msmdsrv.exe`, and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="8a0ca-284">单击“详细信息”。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-284">Click **Details**.</span></span>  
  
4.  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="8a0ca-285">文件版本应为 \<major build> 12.00 ... \<minor build></span><span class="sxs-lookup"><span data-stu-id="8a0ca-285">file version should be 12.00.\<major build>.\<minor build>.</span></span>  
  
5.  <span data-ttu-id="8a0ca-286">验证此版本号是否与 PowerPivot 解决方案和系统服务版本相同。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-286">Verify that this number is identical to the PowerPivot solution and system service version.</span></span>  
  
 <span data-ttu-id="8a0ca-287">**服务启动信息：**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-287">**Service start information:**</span></span>  
  
 <span data-ttu-id="8a0ca-288">当 PowerPivot 服务启动时，它会将版本信息写入到 Windows 事件日志。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-288">When the PowerPivot service starts, it writes version information into the Windows event log.</span></span>  
  
1.  <span data-ttu-id="8a0ca-289">运行 Windows `eventvwr`</span><span class="sxs-lookup"><span data-stu-id="8a0ca-289">Run Windows `eventvwr`</span></span>  
  
2.  <span data-ttu-id="8a0ca-290">对源 `MSOLAP$POWERPIVOT`创建筛选器。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-290">Create a filter for source `MSOLAP$POWERPIVOT`.</span></span>  
  
3.  <span data-ttu-id="8a0ca-291">查找如下信息级别事件</span><span class="sxs-lookup"><span data-stu-id="8a0ca-291">Look for an information level event similar to the following</span></span>  
  
     <span data-ttu-id="8a0ca-292">服务已启动。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-292">Service started.</span></span> <span data-ttu-id="8a0ca-293">Microsoft SQL Server Analysis Services 64 位评估 (x64) RTM **12.0.2000.8**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span></span>  
  
 <span data-ttu-id="8a0ca-294">**使用 PowerShell 验证文件版本。**</span><span class="sxs-lookup"><span data-stu-id="8a0ca-294">**Use PowerShell to verify file version.**</span></span>  
  
 <span data-ttu-id="8a0ca-295">可以使用 PowerShell 验证产品版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-295">You can use PowerShell to verify the product version.</span></span> <span data-ttu-id="8a0ca-296">如果要对版本验证编写脚本或自动化版本验证，PowerShell 是个很好的选择。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-296">PowerShell is a good option if you want to script or automate version verification.</span></span>  
  
```powershell
(Get-ChildItem "C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe").VersionInfo  
```  
  
 <span data-ttu-id="8a0ca-297">以上 PowerShell 命令将返回如下信息：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-297">The above PowerShell command returns information similar to the following:</span></span>  
  
 <span data-ttu-id="8a0ca-298">ProductVersion   FileVersion           FileName</span><span class="sxs-lookup"><span data-stu-id="8a0ca-298">ProductVersion   FileVersion           FileName</span></span>  
  
 <span data-ttu-id="8a0ca-299">**12.0.2000.8** 2014.0120.200 C:\PROGRAM Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span><span class="sxs-lookup"><span data-stu-id="8a0ca-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span></span>  
  
### <a name="verify-the-msolap-data-provider-version-on-sharepoint"></a><span data-ttu-id="8a0ca-300">验证 SharePoint 上的 MSOLAP 数据访问接口版本</span><span class="sxs-lookup"><span data-stu-id="8a0ca-300">Verify the MSOLAP Data Provider Version on SharePoint</span></span>  
 <span data-ttu-id="8a0ca-301">使用以下指令来检查 Excel Services 信任的 Analysis Services OLE DB 访问接口版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-301">Use the following instructions to check which versions of the Analysis Services OLE DB providers are trusted by Excel Services.</span></span> <span data-ttu-id="8a0ca-302">您必须是场或服务应用程序管理员，才能检查 Excel Services 信任的数据访问接口设置。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-302">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="8a0ca-303">在“管理中心”的“应用程序管理”中，单击 **“管理服务应用程序”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-303">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="8a0ca-304">单击 Excel Services 服务应用程序的名称，例如 **ExcelServiceApp1**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-304">Click the name of the Excel Services service application, for example **ExcelServiceApp1**.</span></span>  
  
3.  <span data-ttu-id="8a0ca-305">单击 **“受信任的数据访问接口”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-305">Click **Trusted Data Providers**.</span></span> <span data-ttu-id="8a0ca-306">您应看到 MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-306">You should see MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0).</span></span> <span data-ttu-id="8a0ca-307">如果升级了 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安装，您还将看到先前版本的 MSOLAP.4。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-307">If you upgraded your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, you will also see MSOLAP.4 from the previous version.</span></span>  
  
4.  <span data-ttu-id="8a0ca-308">有关详细信息，请参阅 [将 MSOLAP.5 添加为 Excel Services 中的受信任数据访问接口](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-308">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span></span>  
  
 <span data-ttu-id="8a0ca-309">MSOLAP.4 被描述为“用于 OLAP Services 10.0 的 Microsoft OLE DB 数据访问接口”。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-309">MSOLAP.4 is described as the Microsoft OLE DB Provider for OLAP Services 10.0.</span></span> <span data-ttu-id="8a0ca-310">此版本可能是 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 中与 Excel Services 一起安装的默认版本，也可能是 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-310">This version might be the default version from [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] that is installed with Excel Services, or it might be the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version.</span></span> <span data-ttu-id="8a0ca-311">SharePoint 安装的默认版本不支持 PowerPivot 数据访问。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-311">The default version that SharePoint installs does not support PowerPivot data access.</span></span> <span data-ttu-id="8a0ca-312">您必须具有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本或更高版本才能连接到 SharePoint 上的 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-312">You must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version or later to connect to PowerPivot workbooks on SharePoint.</span></span> <span data-ttu-id="8a0ca-313">若要验证您是否具有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本，请使用前一部分中介绍如何通过查看文件属性来验证版本的说明。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-313">To verify you have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version, use the instructions in the previous section that explain how to verify the version by viewing file properties.</span></span>  
  
### <a name="verify-the-adomdnet-data-provider-version"></a><span data-ttu-id="8a0ca-314">验证 ADOMD.NET 数据访问接口版本</span><span class="sxs-lookup"><span data-stu-id="8a0ca-314">Verify the ADOMD.NET Data Provider Version</span></span>  
 <span data-ttu-id="8a0ca-315">使用以下指令检查安装的 ADOMD.NET 版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-315">Use the following instructions to check which version of ADOMD.NET is installed.</span></span> <span data-ttu-id="8a0ca-316">您必须是场或服务应用程序管理员，才能检查 Excel Services 信任的数据访问接口设置。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-316">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="8a0ca-317">在 SharePoint 应用程序服务器上，请浏览到 `c:\Windows\Assembly`。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-317">On your SharePoint application server, browse to `c:\Windows\Assembly`.</span></span>  
  
2.  <span data-ttu-id="8a0ca-318">按程序集名称排序并查找 **Microsoft.Analysis Services.Adomd.Client**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-318">Sort by assembly name and find the **Microsoft.Analysis Services.Adomd.Client**.</span></span>  
  
3.  <span data-ttu-id="8a0ca-319">验证是否安装了12.0 版 \<build number> 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-319">Verify you have version 12.0.\<build number>.</span></span>  
  

##  <a name="upgrading-multiple-powerpivot-for-sharepoint-servers-in-a-sharepoint-farm"></a><a name="geminifarm"></a><span data-ttu-id="8a0ca-320">升级 SharePoint 场中的多个 PowerPivot for SharePoint 服务器</span><span class="sxs-lookup"><span data-stu-id="8a0ca-320">Upgrading Multiple PowerPivot for SharePoint Servers in a SharePoint Farm</span></span>  
 <span data-ttu-id="8a0ca-321">在包含多个 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 服务器的多服务器拓扑中，所有服务器实例和组件都必须为同一版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-321">In a multi-server topology that includes more than one [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] server, all server instances and components must be the same version.</span></span> <span data-ttu-id="8a0ca-322">运行最高版本软件的服务器为场中的所有服务器设置级别。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-322">The server that runs the highest version of the software sets the level for all servers in the farm.</span></span> <span data-ttu-id="8a0ca-323">如果您只升级某些服务器，则运行旧版软件的服务器将变得不可用，直到它们也升级之后才可用。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-323">If you upgrade just some of the servers, the ones that are running older versions of the software will become unavailable until they are also upgraded.</span></span>  
  
 <span data-ttu-id="8a0ca-324">升级了第一台服务器后，尚未升级的其他服务器将 **变为不可用**。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-324">After you upgrade the first server, additional servers that are not yet upgraded **will become unavailable**.</span></span> <span data-ttu-id="8a0ca-325">当所有服务器都运行在同一级别后将还原可用性。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-325">Availability is restored after all servers run at the same level.</span></span>  
  
 <span data-ttu-id="8a0ca-326">SQL Server 安装程序将对物理计算机上已有的 PowerPivot 解决方案文件进行升级，但若要对场正在使用的解决方案进行升级，则必须使用本主题先前部分中说明的 PowerPivot 配置工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-326">SQL Server Setup upgrades the PowerPivot solution files in place on the physical computer, but to upgrade the solutions in use by the farm, you must use the PowerPivot Configuration Tool described in a previous section of this topic..</span></span>  

##  <a name="applying-a-qfe-to-a-powerpivot-instance-in-the-farm"></a><a name="qfe"></a><span data-ttu-id="8a0ca-327">将 QFE 应用于场中的 PowerPivot 实例</span><span class="sxs-lookup"><span data-stu-id="8a0ca-327">Applying a QFE to a PowerPivot instance in the farm</span></span>  
 <span data-ttu-id="8a0ca-328">为 PowerPivot for SharePoint 服务器应用修补程序时，将使用包含特定问题的修补程序的较新版本来更新现有的程序文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-328">Patching a PowerPivot for SharePoint server updates existing program files with a newer version that includes a fix for a specific problem.</span></span> <span data-ttu-id="8a0ca-329">当将 QFE 应用到多服务器拓扑时，并不存在您必须从其开始的主服务器。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-329">When applying a QFE to a multi-server topology, there is no primary server that you must begin with.</span></span> <span data-ttu-id="8a0ca-330">您可以从任何服务器开始，只要您将同一个 QFE 应用到场中的其他 PowerPivot 服务器。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-330">You can start with any server as long as you apply the same QFE to the other PowerPivot servers in the farm.</span></span>  
  
 <span data-ttu-id="8a0ca-331">当您应用 QFE 时，必须还执行一个配置步骤，该步骤将在场配置数据库中更新服务器版本信息。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-331">When you apply the QFE, you must also perform a configuration step that updates the server version information in the farm configuration database.</span></span> <span data-ttu-id="8a0ca-332">已应用修补程序的服务器版本将成为场的新预期版本。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-332">The version of the patched server becomes the new expected version for the farm.</span></span> <span data-ttu-id="8a0ca-333">在所有计算机上都应用和配置 QFE 前，不具有 QFE 的 PowerPivot for SharePoint 实例将无法用于处理针对 PowerPivot 数据的请求。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-333">Until the QFE is applied and configured across all machines, the PowerPivot for SharePoint instances that do not have the QFE will be unavailable to handle requests for PowerPivot data.</span></span>  
  
 <span data-ttu-id="8a0ca-334">为确保正确应用和配置 QFE，请按照以下说明执行：</span><span class="sxs-lookup"><span data-stu-id="8a0ca-334">To ensure the QFE is applied and configured correctly, follow these instructions:</span></span>  
  
1.  <span data-ttu-id="8a0ca-335">使用随 QFE 提供的说明安装修补程序。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-335">Install the patch using the instructions that are provided with the QFE.</span></span>  
  
2.  <span data-ttu-id="8a0ca-336">启动 PowerPivot 配置工具。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-336">Start the PowerPivot Configuration Tool.</span></span>  
  
3.  <span data-ttu-id="8a0ca-337">单击 **“升级功能、服务、应用程序和解决方案”** ，然后单击 **“确定”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-337">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="8a0ca-338">查看在升级任务中包含的操作，然后单击 **“验证”** 。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-338">Review the actions that are included in the upgrade task, and then click **Validate**.</span></span>  
  
5.  <span data-ttu-id="8a0ca-339">单击 **“运行”** 以便应用操作。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-339">Click **Run** to apply the actions.</span></span>  
  
6.  <span data-ttu-id="8a0ca-340">对场中的其他 PowerPivot for SharePoint 实例重复上述步骤。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-340">Repeat for additional PowerPivot for SharePoint instances in the farm.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="8a0ca-341">在多服务器部署中，请务必在继续下一台计算机之前修补和配置每个实例。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-341">In a multi-server deployment, be sure to both patch and configure each instance before continuing to the next machine.</span></span> <span data-ttu-id="8a0ca-342">PowerPivot 配置工具必须首先为当前实例完成升级任务，然后才能移到下一个实例。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-342">The PowerPivot Configuration Tool must complete the upgrade task for the current instance before you move on to the next instance.</span></span>  
  
 <span data-ttu-id="8a0ca-343">若要检查场中服务的版本信息，请使用管理中心的“升级和修补程序管理”部分中的 **“查看产品和修补程序的安装状态”** 页。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-343">To check version information for services in the farm, use the **Check product and patch installation status** page in the Upgrade and Patch Management section in Central Administration.</span></span>  
  
##  <a name="post-upgrade-verification-tasks"></a><a name="verify"></a> <span data-ttu-id="8a0ca-344">升级后的验证任务</span><span class="sxs-lookup"><span data-stu-id="8a0ca-344">Post-upgrade verification tasks</span></span>  
 <span data-ttu-id="8a0ca-345">升级完成后，请使用以下步骤确认服务器可正常运行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-345">After upgrade is complete, use the following steps to verify the server is operational.</span></span>  
  
|<span data-ttu-id="8a0ca-346">任务</span><span class="sxs-lookup"><span data-stu-id="8a0ca-346">Task</span></span>|<span data-ttu-id="8a0ca-347">链接</span><span class="sxs-lookup"><span data-stu-id="8a0ca-347">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="8a0ca-348">验证服务在运行 PowerPivot for SharePoint 的所有计算机上正常运行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-348">Verify the service is running on all computers that run PowerPivot for SharePoint.</span></span>|[<span data-ttu-id="8a0ca-349">启动或停止 PowerPivot for SharePoint 服务器</span><span class="sxs-lookup"><span data-stu-id="8a0ca-349">Start or Stop a PowerPivot for SharePoint Server</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/start-or-stop-a-power-pivot-for-sharepoint-server)|  
|<span data-ttu-id="8a0ca-350">在网站集级别验证功能激活。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-350">Verify feature activation at the site collection level.</span></span>|[<span data-ttu-id="8a0ca-351">在管理中心中针对网站集激活 PowerPivot 功能集成</span><span class="sxs-lookup"><span data-stu-id="8a0ca-351">Activate PowerPivot Feature Integration for Site Collections in Central Administration</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/activate-power-pivot-integration-for-site-collections-in-ca)|  
|<span data-ttu-id="8a0ca-352">通过打开工作簿并单击筛选器和切片器来启动查询，验证各个 PowerPivot 工作簿是否正常加载。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-352">Verify individual PowerPivot workbooks are loading properly by opening a workbook and clicking on filters and slicers to initiate a query.</span></span>|<span data-ttu-id="8a0ca-353">检查硬盘上是否存在缓存的文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-353">Check for the presence of cached files on the hard drive.</span></span> <span data-ttu-id="8a0ca-354">如果存在缓存文件，则确认已在该物理服务器上加载了数据文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-354">A cached file confirms that the data file was loaded on that physical server.</span></span> <span data-ttu-id="8a0ca-355">在 c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup 文件夹中查找缓存文件。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-355">Look for cached files in the c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup folder.</span></span>|  
|<span data-ttu-id="8a0ca-356">在为数据刷新配置的所选工作簿上测试数据刷新。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-356">Test data refresh on selected workbooks that are configured for data refresh.</span></span>|<span data-ttu-id="8a0ca-357">测试数据刷新的最简单方法是修改数据刷新计划，并且选中 **“也尽快刷新”** 复选框以便数据刷新立即运行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-357">The easiest way to test data refresh is to modify a data refresh schedule, choosing the **Also refresh as soon as possible** checkbox so that data refresh runs immediately.</span></span> <span data-ttu-id="8a0ca-358">此步骤将确定数据刷新对于当前工作簿是否成功。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-358">This step will determine whether data refresh is successful for the current workbook.</span></span> <span data-ttu-id="8a0ca-359">对其他常用工作簿重复上述步骤，以便确保数据刷新正常执行。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-359">Repeat these steps for other frequently used workbooks to ensure that data refresh is functional.</span></span> <span data-ttu-id="8a0ca-360">有关计划数据刷新的详细信息，请参阅[计划数据刷新 &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-360">For more information about scheduling data refresh, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>|  
|<span data-ttu-id="8a0ca-361">在一段时间后，监视 PowerPivot 管理面板中的数据刷新报表，以确认没有发生数据刷新错误。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-361">Over time, monitor the data refresh reports in PowerPivot Management Dashboard to confirm there are no data refresh errors.</span></span>|[<span data-ttu-id="8a0ca-362">PowerPivot 管理面板和使用情况数据</span><span class="sxs-lookup"><span data-stu-id="8a0ca-362">PowerPivot Management Dashboard and Usage Data</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data)|  
  
 <span data-ttu-id="8a0ca-363">有关如何配置 PowerPivot 设置和功能的详细信息，请参阅[在管理中心中管理和配置 Powerpivot 服务器](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-363">For more information about how to configure PowerPivot settings and features, see [PowerPivot Server Administration and Configuration in Central Administration](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span></span>  
  
 <span data-ttu-id="8a0ca-364">有关指导你完成所有安装后配置任务的分步说明，请参阅[初始配置 &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0ca-364">For step-by-step instructions that guide you through all of the post-installation configuration tasks, see [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="8a0ca-365">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8a0ca-365">See Also</span></span>  
 <span data-ttu-id="8a0ca-366">[SQL Server 2014 的各个版本支持的功能](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span><span class="sxs-lookup"><span data-stu-id="8a0ca-366">[Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span></span>  
 [<span data-ttu-id="8a0ca-367">PowerPivot for SharePoint 2010 安装</span><span class="sxs-lookup"><span data-stu-id="8a0ca-367">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
