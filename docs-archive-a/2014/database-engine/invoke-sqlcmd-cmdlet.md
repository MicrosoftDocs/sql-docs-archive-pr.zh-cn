---
title: Invoke-Sqlcmd cmdlet | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- PowerShell [SQL Server], Invoke-Sqlcmd
- Cmdlets [SQL Server], Invoke-Sqlcmd
- Invoke-Sqlcmd cmdlet
- sqlcmd utility, PowerShell
ms.assetid: 0c74d21b-84a5-4fa4-be51-90f0f7230044
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: b1572b03b5772f35ac68a6b85aeedde43d150c07
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689012"
---
# <a name="invoke-sqlcmd-cmdlet"></a><span data-ttu-id="7e348-102">Invoke-Sqlcmd cmdlet</span><span class="sxs-lookup"><span data-stu-id="7e348-102">Invoke-Sqlcmd cmdlet</span></span>
  <span data-ttu-id="7e348-103">**Invoke-Sqlcmd** 是一个运行脚本的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlet，其所运行的脚本中包含 [!INCLUDE[tsql](../includes/tsql-md.md)]sqlcmd **实用工具**所支持的语言（和XQuery）和命令中的语句。</span><span class="sxs-lookup"><span data-stu-id="7e348-103">**Invoke-Sqlcmd** is a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlet that runs scripts that contain statements from the languages ([!INCLUDE[tsql](../includes/tsql-md.md)] and XQuery) and commands that are supported by the **sqlcmd** utility.</span></span>  
  
## <a name="using-invoke-sqlcmd"></a><span data-ttu-id="7e348-104">使用 Invoke-Sqlcmd</span><span class="sxs-lookup"><span data-stu-id="7e348-104">Using Invoke-Sqlcmd</span></span>  
 <span data-ttu-id="7e348-105">**Invoke-Sqlcmd** cmdlet 可使你在 Windows PowerShell 环境中运行 **sqlcmd** 。</span><span class="sxs-lookup"><span data-stu-id="7e348-105">The **Invoke-Sqlcmd** cmdlet lets you run your **sqlcmd** script files in a Windows PowerShell environment.</span></span> <span data-ttu-id="7e348-106">用 **sqlcmd** 执行的大部分操作也可以通过使用 **Invoke-sqlcmd**来完成。</span><span class="sxs-lookup"><span data-stu-id="7e348-106">Much of what you can do with **sqlcmd** can also be done using **Invoke-Sqlcmd**.</span></span>  
  
 <span data-ttu-id="7e348-107">下面的示例说明如何通过调用 Invoke-Sqlcmd 来执行简单查询，这与指定带有 **-Q** 和 **-S** 选项的 **sqlcmd** 相似：</span><span class="sxs-lookup"><span data-stu-id="7e348-107">This is an example of calling Invoke-Sqlcmd to execute a simple query, similar to specifying **sqlcmd** with the **-Q** and **-S** options:</span></span>  
  
```powershell
Invoke-Sqlcmd -Query "SELECT GETDATE() AS TimeOfQuery;" -ServerInstance "MyComputer\MyInstance"  
```  
  
 <span data-ttu-id="7e348-108">下面的示例说明如何调用 **Invoke-Sqlcmd**、指定输入文件并将输出发送到一个文件中，这与指定带有 **-i** 和 **-o** 选项的 **sqlcmd** 相似：</span><span class="sxs-lookup"><span data-stu-id="7e348-108">This is an example of calling **Invoke-Sqlcmd**, specifying an input file and piping the output to a file This is similar to specifying **sqlcmd** with the **-i** and **-o** options:</span></span>  
  
```powershell
Invoke-Sqlcmd -InputFile "C:\MyFolder\TestSQLCmd.sql" | Out-File -FilePath "C:\MyFolder\TestSQLCmd.rpt"  
```  
  
 <span data-ttu-id="7e348-109">下面的示例说明如何使用 Windows PowerShell 数组来将多个 **sqlcmd** 脚本变量传递到 **Invoke-Sqlcmd**。</span><span class="sxs-lookup"><span data-stu-id="7e348-109">This is an example of using a Windows PowerShell array to pass multiple **sqlcmd** scripting variables to **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="7e348-110">用于标识 SELECT 语句中 **sqlcmd** 脚本变量的“$”字符已经通过使用 PowerShell 反引号“\`”转义符进行转义：</span><span class="sxs-lookup"><span data-stu-id="7e348-110">The "$" characters identifying the **sqlcmd** scripting variables in the SELECT statement have been escaped by using the PowerShell back-tick "\`" escape character:</span></span>  
  
```powershell
$MyArray = "MyVar1 = 'String1'", "MyVar2 = 'String2'"  
Invoke-Sqlcmd -Query "SELECT `$(MyVar1) AS Var1, `$(MyVar2) AS Var2;" -Variable $MyArray  
```  
  
 <span data-ttu-id="7e348-111">下面的示例说明如何使用 Windows PowerShell 的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序导航到 [!INCLUDE[ssDE](../includes/ssde-md.md)]实例，然后使用 Windows PowerShell **Get-Item** cmdlet 检索该实例的 SMO Server 对象并将它传递到 **Invoke-Sqlcmd**：</span><span class="sxs-lookup"><span data-stu-id="7e348-111">This is an example of using the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider for Windows PowerShell to navigate to an instance of the [!INCLUDE[ssDE](../includes/ssde-md.md)], and then using the Windows PowerShell **Get-Item** cmdlet to retrieve the SMO Server object for the instance and passing it to **Invoke-Sqlcmd**:</span></span>  
  
```powershell
Set-Location SQLSERVER:\SQL\MyComputer\MyInstance  
Invoke-Sqlcmd -Query "SELECT GETDATE() AS TimeOfQuery;" -ServerInstance (Get-Item .)  
```  
  
 <span data-ttu-id="7e348-112">-Query 参数是位置参数，不需要命名。</span><span class="sxs-lookup"><span data-stu-id="7e348-112">The -Query parameter is positional and does not have to be named.</span></span> <span data-ttu-id="7e348-113">如果传递到 **Invoke-Sqlcmd**的第一个字符串没有命名，则将其视为 -Query 参数处理。</span><span class="sxs-lookup"><span data-stu-id="7e348-113">If the first string that is passed to **Invoke-Sqlcmd**: is unnamed, it is treated as the -Query parameter.</span></span>  
  
```powershell
Invoke-Sqlcmd "SELECT GETDATE() AS TimeOfQuery;" -ServerInstance "MyComputer\MyInstance"  
```  
  
## <a name="path-context-in-invoke-sqlcmd"></a><span data-ttu-id="7e348-114">Invoke-Sqlcmd 中的路径上下文</span><span class="sxs-lookup"><span data-stu-id="7e348-114">Path Context in Invoke-Sqlcmd</span></span>  
 <span data-ttu-id="7e348-115">如果没有使用 -Database 参数，则 Invoke-Sqlcmd 的数据库上下文由调用 cmdlet 时的活动路径设置。</span><span class="sxs-lookup"><span data-stu-id="7e348-115">If you do not use the -Database parameter, the database context for Invoke-Sqlcmd is set by the path that is active when the cmdlet is called.</span></span>  
  
|<span data-ttu-id="7e348-116">路径</span><span class="sxs-lookup"><span data-stu-id="7e348-116">Path</span></span>|<span data-ttu-id="7e348-117">数据库上下文</span><span class="sxs-lookup"><span data-stu-id="7e348-117">Database Context</span></span>|  
|----------|----------------------|  
|<span data-ttu-id="7e348-118">从 SQLSERVER 以外的驱动器开始：</span><span class="sxs-lookup"><span data-stu-id="7e348-118">Starts with a drive other than SQLSERVER:</span></span>|<span data-ttu-id="7e348-119">本地计算机上默认实例中登录 ID 的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-119">The default database for the login ID in the default instance on the local computer.</span></span>|  
|<span data-ttu-id="7e348-120">SQLSERVER:\SQL</span><span class="sxs-lookup"><span data-stu-id="7e348-120">SQLSERVER:\SQL</span></span>|<span data-ttu-id="7e348-121">本地计算机上默认实例中登录 ID 的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-121">The default database for the login ID in the default instance on the local computer.</span></span>|  
|<span data-ttu-id="7e348-122">SQLSERVER:\SQL\ComputerName</span><span class="sxs-lookup"><span data-stu-id="7e348-122">SQLSERVER:\SQL\ComputerName</span></span>|<span data-ttu-id="7e348-123">指定计算机上默认实例中登录 ID 的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-123">The default database for the login ID in the default instance on the specified computer.</span></span>|  
|<span data-ttu-id="7e348-124">SQLSERVER:\SQL\ComputerName\InstanceName</span><span class="sxs-lookup"><span data-stu-id="7e348-124">SQLSERVER:\SQL\ComputerName\InstanceName</span></span>|<span data-ttu-id="7e348-125">指定计算机上指定实例中登录 ID 的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-125">The default database for the login ID in the specified instance on the specified computer.</span></span>|  
|<span data-ttu-id="7e348-126">SQLSERVER:\SQL\ComputerName\InstanceName\Databases</span><span class="sxs-lookup"><span data-stu-id="7e348-126">SQLSERVER:\SQL\ComputerName\InstanceName\Databases</span></span>|<span data-ttu-id="7e348-127">指定计算机上指定实例中登录 ID 的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-127">The default database for the login ID in the specified instance on the specified computer.</span></span>|  
|<span data-ttu-id="7e348-128">SQLSERVER:\SQL\ComputerName\InstanceName\Databases\DatabaseName</span><span class="sxs-lookup"><span data-stu-id="7e348-128">SQLSERVER:\SQL\ComputerName\InstanceName\Databases\DatabaseName</span></span>|<span data-ttu-id="7e348-129">指定计算机上指定实例中的指定数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-129">The specified database in the specified instance on the specified computer.</span></span> <span data-ttu-id="7e348-130">这也适用于较长的路径，例如指定数据库中的表和列节点的路径。</span><span class="sxs-lookup"><span data-stu-id="7e348-130">This also applies to longer paths, such as a path that specifies the Tables and Columns node within a database.</span></span>|  
  
 <span data-ttu-id="7e348-131">例如，假定在本地计算机的默认实例中，您的 Windows 帐户的默认数据库是 master。</span><span class="sxs-lookup"><span data-stu-id="7e348-131">For example, assume that the default database for your Windows account in the default instance of the local computer is master.</span></span> <span data-ttu-id="7e348-132">那么，以下命令将返回 master：</span><span class="sxs-lookup"><span data-stu-id="7e348-132">Then, the following commands would return master:</span></span>  
  
```powershell
Set-Location SQLSERVER:\SQL  
Invoke-Sqlcmd "SELECT DB_NAME() AS DatabaseName;"  
```  
  
 <span data-ttu-id="7e348-133">以下命令将返回 [!INCLUDE[ssSampleDBobject](../includes/sssampledbobject-md.md)]：</span><span class="sxs-lookup"><span data-stu-id="7e348-133">The following commands would return [!INCLUDE[ssSampleDBobject](../includes/sssampledbobject-md.md)]:</span></span>  
  
```powershell
Set-Location SQLSERVER:\SQL\MyComputer\DEFAULT\Databases\AdventureWorks2012\Tables\Person.Person  
Invoke-Sqlcmd "SELECT DB_NAME() AS DatabaseName;"  
```  
  
 <span data-ttu-id="7e348-134">当 Invoke-Sqlcmd 使用路径数据库上下文时，它会提供一条警告。</span><span class="sxs-lookup"><span data-stu-id="7e348-134">Invoke-Sqlcmd provides a warning when it uses the path database context.</span></span> <span data-ttu-id="7e348-135">可以使用 -SuppressProviderContextWarning 参数来关闭该警告消息。</span><span class="sxs-lookup"><span data-stu-id="7e348-135">You can use the -SuppressProviderContextWarning parameter to turn off the warning message.</span></span> <span data-ttu-id="7e348-136">可以使用 -IgnoreProviderContext 参数来通知 Invoke-Sqlcmd 始终使用登录帐户的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="7e348-136">You can use the -IgnoreProviderContext parameter to tell Invoke-Sqlcmd to always use the default database for the login.</span></span>  
  
## <a name="comparing-invoke-sqlcmd-and-the-sqlcmd-utility"></a><span data-ttu-id="7e348-137">Invoke-Sqlcmd 和 sqlcmd 实用工具的比较</span><span class="sxs-lookup"><span data-stu-id="7e348-137">Comparing Invoke-Sqlcmd and the sqlcmd Utility</span></span>  
 <span data-ttu-id="7e348-138">**Invoke-Sqlcmd** 可用来运行许多可借助于 **sqlcmd** 实用工具运行的脚本。</span><span class="sxs-lookup"><span data-stu-id="7e348-138">**Invoke-Sqlcmd** can be used to run many of the scripts that can be run using the **sqlcmd** utility.</span></span> <span data-ttu-id="7e348-139">但是，用来运行 **Invoke-Sqlcmd** 的 Windows PowerShell 环境不同于用来运行 **sqlcmd** 的命令提示环境。</span><span class="sxs-lookup"><span data-stu-id="7e348-139">However, **Invoke-Sqlcmd** runs in a Windows PowerShell environment which is different than the command prompt environment that **sqlcmd** is run in.</span></span> <span data-ttu-id="7e348-140">为了使 **Invoke-Sqlcmd** 在 Windows PowerShell 环境中有效，已对其行为进行了修改。</span><span class="sxs-lookup"><span data-stu-id="7e348-140">The behavior of **Invoke-Sqlcmd** has been modified to work in a Windows PowerShell environment.</span></span>  
  
 <span data-ttu-id="7e348-141">并非所有的 **sqlcmd** 命令都已在 **Invoke-Sqlcmd**中实现。</span><span class="sxs-lookup"><span data-stu-id="7e348-141">Not all of the **sqlcmd** commands are implemented in **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="7e348-142">未实现的命令包括：**:!!**、**:connect**、**:error\*\*\*\*:out**、**:ed**、**:list**、**:listvar**、**:reset**、**:perftrace** 和 **:serverlist**。</span><span class="sxs-lookup"><span data-stu-id="7e348-142">Commands that are not implemented include the following: **:!!**, **:connect**, **:error**, **:out**, **:ed**, **:list**, **:listvar**, **:reset**, **:perftrace**, and **:serverlist**.</span></span>  
  
 <span data-ttu-id="7e348-143">**Invoke-Sqlcmd** 无法初始化 **sqlcmd** 环境变量或脚本变量，如 SQLCMDDBNAME 或 SQLCMDWORKSTATION。</span><span class="sxs-lookup"><span data-stu-id="7e348-143">**Invoke-Sqlcmd** does not initialize the **sqlcmd** environment or scripting variables such as SQLCMDDBNAME or SQLCMDWORKSTATION.</span></span>  
  
 <span data-ttu-id="7e348-144">除非指定了 Windows PowerShell**Invoke-Sqlcmd** 公共参数，否则 **Invoke-Sqlcmd** 不显示消息（如 PRINT 语句的输出）。</span><span class="sxs-lookup"><span data-stu-id="7e348-144">**Invoke-Sqlcmd** does not display messages, such as the output of PRINT statements, unless you specify the Windows PowerShell **-Verbose** common parameter.</span></span> <span data-ttu-id="7e348-145">例如：</span><span class="sxs-lookup"><span data-stu-id="7e348-145">For example:</span></span>  
  
```powershell
Invoke-Sqlcmd -Query "PRINT N'abc';" -Verbose  
```  
  
 <span data-ttu-id="7e348-146">并非所有的 **sqlcmd** 参数都需要在 PowerShell 环境中使用。</span><span class="sxs-lookup"><span data-stu-id="7e348-146">Not all of the **sqlcmd** parameters are needed in a PowerShell environment.</span></span> <span data-ttu-id="7e348-147">例如，Windows PowerShell 设置所有 cmdlet 输出的格式，因此，指定格式选项的 **sqlcmd** 参数将不能在 **Invoke-Sqlcmd**中实现。</span><span class="sxs-lookup"><span data-stu-id="7e348-147">For example, Windows PowerShell formats all output from cmdlets, so the **sqlcmd** parameters specifying formatting options are not implemented in **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="7e348-148">下表显示了**Invoke-Sqlcmd**参数和**Sqlcmd**选项之间的关系：</span><span class="sxs-lookup"><span data-stu-id="7e348-148">The following table shows the relationship between the **Invoke-Sqlcmd** parameters and **sqlcmd** options:</span></span>  
  
|<span data-ttu-id="7e348-149">说明</span><span class="sxs-lookup"><span data-stu-id="7e348-149">Description</span></span>|<span data-ttu-id="7e348-150">sqlcmd 选项</span><span class="sxs-lookup"><span data-stu-id="7e348-150">sqlcmd option</span></span>|<span data-ttu-id="7e348-151">Invoke-Sqlcmd 参数</span><span class="sxs-lookup"><span data-stu-id="7e348-151">Invoke-Sqlcmd parameter</span></span>|  
|-----------------|-------------------|------------------------------|  
|<span data-ttu-id="7e348-152">服务器名称和实例名称</span><span class="sxs-lookup"><span data-stu-id="7e348-152">Server and instance name.</span></span>|<span data-ttu-id="7e348-153">sqlcmd</span><span class="sxs-lookup"><span data-stu-id="7e348-153">-S</span></span>|<span data-ttu-id="7e348-154">-ServerInstance</span><span class="sxs-lookup"><span data-stu-id="7e348-154">-ServerInstance</span></span>|  
|<span data-ttu-id="7e348-155">要使用的初始数据库</span><span class="sxs-lookup"><span data-stu-id="7e348-155">The initial database to use.</span></span>|<span data-ttu-id="7e348-156">-d</span><span class="sxs-lookup"><span data-stu-id="7e348-156">-d</span></span>|<span data-ttu-id="7e348-157">-Database</span><span class="sxs-lookup"><span data-stu-id="7e348-157">-Database</span></span>|  
|<span data-ttu-id="7e348-158">运行指定的查询并退出</span><span class="sxs-lookup"><span data-stu-id="7e348-158">Run the specified query and exit.</span></span>|<span data-ttu-id="7e348-159">-S</span><span class="sxs-lookup"><span data-stu-id="7e348-159">-Q</span></span>|<span data-ttu-id="7e348-160">-Query</span><span class="sxs-lookup"><span data-stu-id="7e348-160">-Query</span></span>|  
|[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="7e348-161">身份验证登录 ID</span><span class="sxs-lookup"><span data-stu-id="7e348-161">Authentication login ID.</span></span>|<span data-ttu-id="7e348-162">-U</span><span class="sxs-lookup"><span data-stu-id="7e348-162">-U</span></span>|<span data-ttu-id="7e348-163">-Username</span><span class="sxs-lookup"><span data-stu-id="7e348-163">-Username</span></span>|  
|[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="7e348-164">身份验证密码</span><span class="sxs-lookup"><span data-stu-id="7e348-164">Authentication password.</span></span>|<span data-ttu-id="7e348-165">-p</span><span class="sxs-lookup"><span data-stu-id="7e348-165">-P</span></span>|<span data-ttu-id="7e348-166">-Password</span><span class="sxs-lookup"><span data-stu-id="7e348-166">-Password</span></span>|  
|<span data-ttu-id="7e348-167">变量定义</span><span class="sxs-lookup"><span data-stu-id="7e348-167">Variable definition.</span></span>|<span data-ttu-id="7e348-168">-v</span><span class="sxs-lookup"><span data-stu-id="7e348-168">-v</span></span>|<span data-ttu-id="7e348-169">-Variable</span><span class="sxs-lookup"><span data-stu-id="7e348-169">-Variable</span></span>|  
|<span data-ttu-id="7e348-170">查询超时间隔</span><span class="sxs-lookup"><span data-stu-id="7e348-170">Query timeout interval.</span></span>|<span data-ttu-id="7e348-171">-t</span><span class="sxs-lookup"><span data-stu-id="7e348-171">-t</span></span>|<span data-ttu-id="7e348-172">-QueryTimeout</span><span class="sxs-lookup"><span data-stu-id="7e348-172">-QueryTimeout</span></span>|  
|<span data-ttu-id="7e348-173">在遇到错误时停止运行</span><span class="sxs-lookup"><span data-stu-id="7e348-173">Stop running on an error</span></span>|<span data-ttu-id="7e348-174">-b</span><span class="sxs-lookup"><span data-stu-id="7e348-174">-b</span></span>|<span data-ttu-id="7e348-175">-AbortOnError</span><span class="sxs-lookup"><span data-stu-id="7e348-175">-AbortOnError</span></span>|  
|<span data-ttu-id="7e348-176">专用管理员连接</span><span class="sxs-lookup"><span data-stu-id="7e348-176">Dedicated Administrator Connection.</span></span>|<span data-ttu-id="7e348-177">-A</span><span class="sxs-lookup"><span data-stu-id="7e348-177">-A</span></span>|<span data-ttu-id="7e348-178">-DedicatedAdministratorConnection</span><span class="sxs-lookup"><span data-stu-id="7e348-178">-DedicatedAdministratorConnection</span></span>|  
|<span data-ttu-id="7e348-179">禁用交互式命令、启动脚本和环境变量</span><span class="sxs-lookup"><span data-stu-id="7e348-179">Disable interactive commands, startup script, and environment variables.</span></span>|<span data-ttu-id="7e348-180">-X</span><span class="sxs-lookup"><span data-stu-id="7e348-180">-X</span></span>|<span data-ttu-id="7e348-181">-DisableCommands</span><span class="sxs-lookup"><span data-stu-id="7e348-181">-DisableCommands</span></span>|  
|<span data-ttu-id="7e348-182">禁用变量替换</span><span class="sxs-lookup"><span data-stu-id="7e348-182">Disable variable substitution.</span></span>|<span data-ttu-id="7e348-183">-X</span><span class="sxs-lookup"><span data-stu-id="7e348-183">-x</span></span>|<span data-ttu-id="7e348-184">-DisableVariables</span><span class="sxs-lookup"><span data-stu-id="7e348-184">-DisableVariables</span></span>|  
|<span data-ttu-id="7e348-185">要报告的最小严重级别</span><span class="sxs-lookup"><span data-stu-id="7e348-185">Minimum severity level to report.</span></span>|<span data-ttu-id="7e348-186">-v</span><span class="sxs-lookup"><span data-stu-id="7e348-186">-V</span></span>|<span data-ttu-id="7e348-187">-SeverityLevel</span><span class="sxs-lookup"><span data-stu-id="7e348-187">-SeverityLevel</span></span>|  
|<span data-ttu-id="7e348-188">要报告的最小错误级别</span><span class="sxs-lookup"><span data-stu-id="7e348-188">Minimum error level to report.</span></span>|<span data-ttu-id="7e348-189">-m</span><span class="sxs-lookup"><span data-stu-id="7e348-189">-m</span></span>|<span data-ttu-id="7e348-190">-ErrorLevel</span><span class="sxs-lookup"><span data-stu-id="7e348-190">-ErrorLevel</span></span>|  
|<span data-ttu-id="7e348-191">登录超时间隔</span><span class="sxs-lookup"><span data-stu-id="7e348-191">Login timeout interval.</span></span>|<span data-ttu-id="7e348-192">-l</span><span class="sxs-lookup"><span data-stu-id="7e348-192">-l</span></span>|<span data-ttu-id="7e348-193">-ConnectionTimeout</span><span class="sxs-lookup"><span data-stu-id="7e348-193">-ConnectionTimeout</span></span>|  
|<span data-ttu-id="7e348-194">主机名</span><span class="sxs-lookup"><span data-stu-id="7e348-194">Hostname.</span></span>|<span data-ttu-id="7e348-195">-H</span><span class="sxs-lookup"><span data-stu-id="7e348-195">-H</span></span>|<span data-ttu-id="7e348-196">-HostName</span><span class="sxs-lookup"><span data-stu-id="7e348-196">-HostName</span></span>|  
|<span data-ttu-id="7e348-197">更改密码并退出</span><span class="sxs-lookup"><span data-stu-id="7e348-197">Change password and exit.</span></span>|<span data-ttu-id="7e348-198">-Z</span><span class="sxs-lookup"><span data-stu-id="7e348-198">-Z</span></span>|<span data-ttu-id="7e348-199">-NewPassword</span><span class="sxs-lookup"><span data-stu-id="7e348-199">-NewPassword</span></span>|  
|<span data-ttu-id="7e348-200">包含查询的输入文件</span><span class="sxs-lookup"><span data-stu-id="7e348-200">Input file containing a query</span></span>|<span data-ttu-id="7e348-201">-i</span><span class="sxs-lookup"><span data-stu-id="7e348-201">-i</span></span>|<span data-ttu-id="7e348-202">-InputFile</span><span class="sxs-lookup"><span data-stu-id="7e348-202">-InputFile</span></span>|  
|<span data-ttu-id="7e348-203">字符输出的最大长度</span><span class="sxs-lookup"><span data-stu-id="7e348-203">Maximum length of character output.</span></span>|<span data-ttu-id="7e348-204">-w</span><span class="sxs-lookup"><span data-stu-id="7e348-204">-w</span></span>|<span data-ttu-id="7e348-205">-MaxCharLength</span><span class="sxs-lookup"><span data-stu-id="7e348-205">-MaxCharLength</span></span>|  
|<span data-ttu-id="7e348-206">二进制输出的最大长度</span><span class="sxs-lookup"><span data-stu-id="7e348-206">Maximum length of binary output.</span></span>|<span data-ttu-id="7e348-207">-w</span><span class="sxs-lookup"><span data-stu-id="7e348-207">-w</span></span>|<span data-ttu-id="7e348-208">-MaxBinaryLength</span><span class="sxs-lookup"><span data-stu-id="7e348-208">-MaxBinaryLength</span></span>|  
|<span data-ttu-id="7e348-209">使用 SSL 加密机制进行连接</span><span class="sxs-lookup"><span data-stu-id="7e348-209">Connect using SSL encryption.</span></span>|<span data-ttu-id="7e348-210">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-210">No parameter</span></span>|<span data-ttu-id="7e348-211">-EncryptConnection</span><span class="sxs-lookup"><span data-stu-id="7e348-211">-EncryptConnection</span></span>|  
|<span data-ttu-id="7e348-212">显示错误</span><span class="sxs-lookup"><span data-stu-id="7e348-212">Display errors</span></span>|<span data-ttu-id="7e348-213">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-213">No parameter</span></span>|<span data-ttu-id="7e348-214">-OutputSqlErrors</span><span class="sxs-lookup"><span data-stu-id="7e348-214">-OutputSqlErrors</span></span>|  
|<span data-ttu-id="7e348-215">将消息输出到 stderr</span><span class="sxs-lookup"><span data-stu-id="7e348-215">Output messages to stderr.</span></span>|<span data-ttu-id="7e348-216">-r</span><span class="sxs-lookup"><span data-stu-id="7e348-216">-r</span></span>|<span data-ttu-id="7e348-217">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-217">No parameter</span></span>|  
|<span data-ttu-id="7e348-218">使用客户端的区域设置</span><span class="sxs-lookup"><span data-stu-id="7e348-218">Use client's regional settings</span></span>|<span data-ttu-id="7e348-219">-R</span><span class="sxs-lookup"><span data-stu-id="7e348-219">-R</span></span>|<span data-ttu-id="7e348-220">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-220">No parameter</span></span>|  
|<span data-ttu-id="7e348-221">运行指定的查询并保持运行状态</span><span class="sxs-lookup"><span data-stu-id="7e348-221">Run the specified query and remain running.</span></span>|<span data-ttu-id="7e348-222">-q</span><span class="sxs-lookup"><span data-stu-id="7e348-222">-q</span></span>|<span data-ttu-id="7e348-223">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-223">No parameter</span></span>|  
|<span data-ttu-id="7e348-224">要用于输出数据的代码页</span><span class="sxs-lookup"><span data-stu-id="7e348-224">Code page to use for output data.</span></span>|<span data-ttu-id="7e348-225">-f</span><span class="sxs-lookup"><span data-stu-id="7e348-225">-f</span></span>|<span data-ttu-id="7e348-226">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-226">No parameter</span></span>|  
|<span data-ttu-id="7e348-227">更改密码并保持运行状态</span><span class="sxs-lookup"><span data-stu-id="7e348-227">Change a password and remain running</span></span>|<span data-ttu-id="7e348-228">-Z</span><span class="sxs-lookup"><span data-stu-id="7e348-228">-z</span></span>|<span data-ttu-id="7e348-229">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-229">No parameter</span></span>|  
|<span data-ttu-id="7e348-230">数据包大小</span><span class="sxs-lookup"><span data-stu-id="7e348-230">Packet size</span></span>|<span data-ttu-id="7e348-231">-a</span><span class="sxs-lookup"><span data-stu-id="7e348-231">-a</span></span>|<span data-ttu-id="7e348-232">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-232">No parameter</span></span>|  
|<span data-ttu-id="7e348-233">列分隔符</span><span class="sxs-lookup"><span data-stu-id="7e348-233">Column separator</span></span>|<span data-ttu-id="7e348-234">-S</span><span class="sxs-lookup"><span data-stu-id="7e348-234">-s</span></span>|<span data-ttu-id="7e348-235">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-235">No parameter</span></span>|  
|<span data-ttu-id="7e348-236">控制输出标头</span><span class="sxs-lookup"><span data-stu-id="7e348-236">Control output headers</span></span>|<span data-ttu-id="7e348-237">-H</span><span class="sxs-lookup"><span data-stu-id="7e348-237">-h</span></span>|<span data-ttu-id="7e348-238">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-238">No parameter</span></span>|  
|<span data-ttu-id="7e348-239">指定控制字符</span><span class="sxs-lookup"><span data-stu-id="7e348-239">Specify control characters</span></span>|<span data-ttu-id="7e348-240">-k</span><span class="sxs-lookup"><span data-stu-id="7e348-240">-k</span></span>|<span data-ttu-id="7e348-241">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-241">No parameter</span></span>|  
|<span data-ttu-id="7e348-242">长度固定的显示宽度</span><span class="sxs-lookup"><span data-stu-id="7e348-242">Fixed length display width</span></span>|<span data-ttu-id="7e348-243">-y</span><span class="sxs-lookup"><span data-stu-id="7e348-243">-Y</span></span>|<span data-ttu-id="7e348-244">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-244">No parameter</span></span>|  
|<span data-ttu-id="7e348-245">长度可变的显示宽度</span><span class="sxs-lookup"><span data-stu-id="7e348-245">Variable length display width</span></span>|<span data-ttu-id="7e348-246">-y</span><span class="sxs-lookup"><span data-stu-id="7e348-246">-y</span></span>|<span data-ttu-id="7e348-247">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-247">No parameter</span></span>|  
|<span data-ttu-id="7e348-248">回显输入</span><span class="sxs-lookup"><span data-stu-id="7e348-248">Echo input</span></span>|<span data-ttu-id="7e348-249">-E</span><span class="sxs-lookup"><span data-stu-id="7e348-249">-e</span></span>|<span data-ttu-id="7e348-250">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-250">No parameter</span></span>|  
|<span data-ttu-id="7e348-251">允许使用带引号的标识符</span><span class="sxs-lookup"><span data-stu-id="7e348-251">Enable quoted identifiers</span></span>|<span data-ttu-id="7e348-252">-I</span><span class="sxs-lookup"><span data-stu-id="7e348-252">-I</span></span>|<span data-ttu-id="7e348-253">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-253">No parameter</span></span>|  
|<span data-ttu-id="7e348-254">删除尾随空格</span><span class="sxs-lookup"><span data-stu-id="7e348-254">Remove trailing spaces</span></span>|<span data-ttu-id="7e348-255">-w</span><span class="sxs-lookup"><span data-stu-id="7e348-255">-W</span></span>|<span data-ttu-id="7e348-256">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-256">No parameter</span></span>|  
|<span data-ttu-id="7e348-257">列出实例</span><span class="sxs-lookup"><span data-stu-id="7e348-257">List instances</span></span>|<span data-ttu-id="7e348-258">-l</span><span class="sxs-lookup"><span data-stu-id="7e348-258">-L</span></span>|<span data-ttu-id="7e348-259">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-259">No parameter</span></span>|  
|<span data-ttu-id="7e348-260">将输出格式化为 Unicode</span><span class="sxs-lookup"><span data-stu-id="7e348-260">Format output as Unicode</span></span>|<span data-ttu-id="7e348-261">-U</span><span class="sxs-lookup"><span data-stu-id="7e348-261">-u</span></span>|<span data-ttu-id="7e348-262">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-262">No parameter</span></span>|  
|<span data-ttu-id="7e348-263">打印统计信息</span><span class="sxs-lookup"><span data-stu-id="7e348-263">Print statistics</span></span>|<span data-ttu-id="7e348-264">-p</span><span class="sxs-lookup"><span data-stu-id="7e348-264">-p</span></span>|<span data-ttu-id="7e348-265">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-265">No parameter</span></span>|  
|<span data-ttu-id="7e348-266">结束命令</span><span class="sxs-lookup"><span data-stu-id="7e348-266">Command end</span></span>|<span data-ttu-id="7e348-267">-c</span><span class="sxs-lookup"><span data-stu-id="7e348-267">-c</span></span>|<span data-ttu-id="7e348-268">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-268">No parameter</span></span>|  
|<span data-ttu-id="7e348-269">使用 Windows 身份验证进行连接</span><span class="sxs-lookup"><span data-stu-id="7e348-269">Connect using Windows Authentication</span></span>|<span data-ttu-id="7e348-270">-E</span><span class="sxs-lookup"><span data-stu-id="7e348-270">-E</span></span>|<span data-ttu-id="7e348-271">无参数</span><span class="sxs-lookup"><span data-stu-id="7e348-271">No parameter</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="7e348-272">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7e348-272">See Also</span></span>  
 <span data-ttu-id="7e348-273">[使用数据库引擎 cmdlet](../../2014/database-engine/use-the-database-engine-cmdlets.md) </span><span class="sxs-lookup"><span data-stu-id="7e348-273">[Use the Database Engine cmdlets](../../2014/database-engine/use-the-database-engine-cmdlets.md) </span></span>  
 <span data-ttu-id="7e348-274">[sqlcmd 实用工具](../tools/sqlcmd-utility.md) </span><span class="sxs-lookup"><span data-stu-id="7e348-274">[sqlcmd Utility](../tools/sqlcmd-utility.md) </span></span>  
 [<span data-ttu-id="7e348-275">使用 sqlcmd 实用工具</span><span class="sxs-lookup"><span data-stu-id="7e348-275">Use the sqlcmd Utility</span></span>](../relational-databases/scripting/sqlcmd-use-the-utility.md)  
