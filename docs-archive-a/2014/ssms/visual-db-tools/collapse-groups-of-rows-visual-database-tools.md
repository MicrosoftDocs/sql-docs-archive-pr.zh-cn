---
title: 折叠行组 (Visual Database Tools) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580487"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="0efb5-102">折叠行组 (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="0efb5-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="0efb5-103">您可以创建这样的一个查询结果，其中每个结果行都与来自原始数据的一整组行相对应。</span><span class="sxs-lookup"><span data-stu-id="0efb5-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="0efb5-104">在拆叠行时应谨记以下几点：</span><span class="sxs-lookup"><span data-stu-id="0efb5-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="0efb5-105">**可以消除重复行** 有些查询可以创建显示多个相同行的结果集。</span><span class="sxs-lookup"><span data-stu-id="0efb5-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="0efb5-106">例如，可以创建这样的结果集：每行都包含作者所在市县的市县名和省市自治区名，但如果一个市县包含多个作者，则将会生成多个相同的行。</span><span class="sxs-lookup"><span data-stu-id="0efb5-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="0efb5-107">生成的 SQL 结果可能类似以下形式：</span><span class="sxs-lookup"><span data-stu-id="0efb5-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="0efb5-108">由上述查询生成的结果集不是很有用。</span><span class="sxs-lookup"><span data-stu-id="0efb5-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="0efb5-109">如果一个市县包含四个作者，则结果集将包括四个相同的行。</span><span class="sxs-lookup"><span data-stu-id="0efb5-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="0efb5-110">由于结果集不包括除 city 和 state 以外的任何其他列，因此无法区别这些相同的行。</span><span class="sxs-lookup"><span data-stu-id="0efb5-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="0efb5-111">避免这类重复行的一种方法是包含能可用于区分行的其他列。</span><span class="sxs-lookup"><span data-stu-id="0efb5-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="0efb5-112">例如，如果包含作者名，则每行将不相同（假设任一市县中不存在两个同名的作者）。</span><span class="sxs-lookup"><span data-stu-id="0efb5-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="0efb5-113">生成的 SQL 结果可能类似以下形式：</span><span class="sxs-lookup"><span data-stu-id="0efb5-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="0efb5-114">当然，上述查询只是消除了表象，但并未真正解决问题。</span><span class="sxs-lookup"><span data-stu-id="0efb5-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="0efb5-115">也就是说，结果集不再含重复行，但该结果集已不再是关于市县的结果集。</span><span class="sxs-lookup"><span data-stu-id="0efb5-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="0efb5-116">若要消除原始结果集中的重复行，使每行仍描述一个市县，则可以创建只返回唯一行的查询。</span><span class="sxs-lookup"><span data-stu-id="0efb5-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="0efb5-117">生成的 SQL 结果可能类似以下形式：</span><span class="sxs-lookup"><span data-stu-id="0efb5-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="0efb5-118">有关消除重复的详细信息，请参阅[排除重复行 (Visual Database Tools)](visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="0efb5-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="0efb5-119">**可计算多组行** 也就是说，可以汇总多组行中的信息。</span><span class="sxs-lookup"><span data-stu-id="0efb5-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="0efb5-120">例如，可以创建这样的结果集：每行包含作者所在市县的市县名和省市自治区名，以及该市县包含的作者数。</span><span class="sxs-lookup"><span data-stu-id="0efb5-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="0efb5-121">生成的 SQL 结果可能类似以下形式：</span><span class="sxs-lookup"><span data-stu-id="0efb5-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="0efb5-122">有关计算多组行的详细信息，请参阅[汇总查询结果 (Visual Database Tools)](summarize-query-results-visual-database-tools.md)和[对查询结果进行排序和分组 (Visual Database Tools)](sort-and-group-query-results-visual-database-tools.md)</span><span class="sxs-lookup"><span data-stu-id="0efb5-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="0efb5-123">**可以使用选择条件包括多组行** 例如，可以创建这样的结果集：每行包含几个作者所在市县的市县名和省市自治区名，以及该市县包含的作者数。</span><span class="sxs-lookup"><span data-stu-id="0efb5-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="0efb5-124">生成的 SQL 结果可能类似以下形式：</span><span class="sxs-lookup"><span data-stu-id="0efb5-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="0efb5-125">有关将选择条件用于多组行的详细信息，请参阅[为组指定条件 (Visual Database Tools)](specify-conditions-for-groups-visual-database-tools.md) 和[在同一查询中使用 HAVING 和 WHERE 子句 (Visual Database Tools)](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="0efb5-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0efb5-126">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0efb5-126">See Also</span></span>  
 <span data-ttu-id="0efb5-127">[指定 Visual Database Tools &#40;搜索条件&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="0efb5-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="0efb5-128">设计查询和视图操作指南主题 (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="0efb5-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  
