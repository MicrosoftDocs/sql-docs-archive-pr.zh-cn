---
title: 创建多服务器环境 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- SQL Server Agent, multiserver environments
- master servers [SQL Server], about master servers
- target servers [SQL Server], about target servers
- multiserver environments [SQL Server]
ms.assetid: edc2b60d-15da-40a1-8ba3-f1d473366ee6
author: stevestein
ms.author: sstein
ms.openlocfilehash: a6920920aa603c615cdc5f84a34a93204842052d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692107"
---
# <a name="create-a-multiserver-environment"></a><span data-ttu-id="968d9-102">创建多服务器环境</span><span class="sxs-lookup"><span data-stu-id="968d9-102">Create a Multiserver Environment</span></span>
  <span data-ttu-id="968d9-103">多服务器管理需要设置一个主服务器 (MSX) 以及一个或多个目标服务器 (TSX)。</span><span class="sxs-lookup"><span data-stu-id="968d9-103">Multiserver administration requires that you set up a master server (MSX) and one or more target servers (TSX).</span></span> <span data-ttu-id="968d9-104">首先在主服务器上定义将在所有目标服务器上处理的作业，然后将这些作业下载到目标服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-104">Jobs that will be processed on all the target servers are first defined on the master server and then downloaded to the target servers.</span></span>  
  
 <span data-ttu-id="968d9-105">默认情况下，将为主服务器和目标服务器之间的连接启用完全安全套接字层 (SSL) 加密和证书验证。</span><span class="sxs-lookup"><span data-stu-id="968d9-105">By default, full Secure Sockets Layer (SSL) encryption and certificate validation are enabled for connections between master servers and target servers.</span></span> <span data-ttu-id="968d9-106">有关详细信息，请参阅 [在目标服务器上设置加密选项](set-encryption-options-on-target-servers.md)</span><span class="sxs-lookup"><span data-stu-id="968d9-106">For more information, see [Set Encryption Options on Target Servers](set-encryption-options-on-target-servers.md).</span></span>  
  
 <span data-ttu-id="968d9-107">如果您具有大量目标服务器，应避免通过其他 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能在具有重大性能要求的生产服务器上定义主服务器，因为目标服务器通信量可能会降低生产服务器的性能。</span><span class="sxs-lookup"><span data-stu-id="968d9-107">If you have a large number of target servers, avoid defining your master server on a production server that has significant performance requirements from other [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] functionality, because target server traffic can slow performance on your production server.</span></span> <span data-ttu-id="968d9-108">如果还将事件转发到专用的主服务器，则可以在一台服务器上集中管理。</span><span class="sxs-lookup"><span data-stu-id="968d9-108">If you also forward events to a dedicated master server, you can centralize administration on one server.</span></span> <span data-ttu-id="968d9-109">有关详细信息，请参阅 [管理事件](manage-events.md)。</span><span class="sxs-lookup"><span data-stu-id="968d9-109">For more information, see [Manage Events](manage-events.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="968d9-110">若要使用多服务器作业处理， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理服务帐户必须是主服务器上 **msdb** 数据库角色 **TargetServersRole** 的成员。</span><span class="sxs-lookup"><span data-stu-id="968d9-110">To use multiserver job processing, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account must be a member of the **msdb** database role **TargetServersRole** on the master server.</span></span> <span data-ttu-id="968d9-111">“主服务器向导”将服务帐户自动添加到此角色，以作为登记过程的一部分。</span><span class="sxs-lookup"><span data-stu-id="968d9-111">The Master Server Wizard automatically adds the service account to this role as part of the enlistment process</span></span>  
  
## <a name="considerations-for-multiserver-environments"></a><span data-ttu-id="968d9-112">多服务器环境的注意事项</span><span class="sxs-lookup"><span data-stu-id="968d9-112">Considerations for Multiserver Environments</span></span>  
 <span data-ttu-id="968d9-113">有关支持的 MSX/TSX 配置，请参阅下表。</span><span class="sxs-lookup"><span data-stu-id="968d9-113">See the table below for supported MSX/TSX configurations.</span></span>  
  
||<span data-ttu-id="968d9-114">**TSX = 7.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-114">**TSX = 7.0**</span></span>|<span data-ttu-id="968d9-115">**TSX = 8.0 < SP3**</span><span class="sxs-lookup"><span data-stu-id="968d9-115">**TSX = 8.0 < SP3**</span></span>|<span data-ttu-id="968d9-116">**TSX = 8.0 SP3 或更高版本**</span><span class="sxs-lookup"><span data-stu-id="968d9-116">**TSX = 8.0 SP3 or higher**</span></span>|<span data-ttu-id="968d9-117">**TSX = 9.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-117">**TSX = 9.0**</span></span>|<span data-ttu-id="968d9-118">**TSX= 10.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-118">**TSX= 10.0**</span></span>|<span data-ttu-id="968d9-119">**TSX = 10.5**</span><span class="sxs-lookup"><span data-stu-id="968d9-119">**TSX = 10.5**</span></span>|<span data-ttu-id="968d9-120">**TSX = 11.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-120">**TSX = 11.0**</span></span>|  
|-|--------------------|---------------------------|----------------------------------|--------------------|--------------------|---------------------|---------------------|  
|<span data-ttu-id="968d9-121">**MSX = 7.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-121">**MSX = 7.0**</span></span>|<span data-ttu-id="968d9-122">是</span><span class="sxs-lookup"><span data-stu-id="968d9-122">Yes</span></span>|<span data-ttu-id="968d9-123">是</span><span class="sxs-lookup"><span data-stu-id="968d9-123">Yes</span></span>|<span data-ttu-id="968d9-124">否</span><span class="sxs-lookup"><span data-stu-id="968d9-124">No</span></span>|<span data-ttu-id="968d9-125">否</span><span class="sxs-lookup"><span data-stu-id="968d9-125">No</span></span>|<span data-ttu-id="968d9-126">否</span><span class="sxs-lookup"><span data-stu-id="968d9-126">No</span></span>|<span data-ttu-id="968d9-127">否</span><span class="sxs-lookup"><span data-stu-id="968d9-127">No</span></span>|<span data-ttu-id="968d9-128">否</span><span class="sxs-lookup"><span data-stu-id="968d9-128">No</span></span>|  
|<span data-ttu-id="968d9-129">**MSX = 8.0 < SP3**</span><span class="sxs-lookup"><span data-stu-id="968d9-129">**MSX = 8.0 < SP3**</span></span>|<span data-ttu-id="968d9-130">是</span><span class="sxs-lookup"><span data-stu-id="968d9-130">Yes</span></span>|<span data-ttu-id="968d9-131">是</span><span class="sxs-lookup"><span data-stu-id="968d9-131">Yes</span></span>|<span data-ttu-id="968d9-132">否</span><span class="sxs-lookup"><span data-stu-id="968d9-132">No</span></span>|<span data-ttu-id="968d9-133">否</span><span class="sxs-lookup"><span data-stu-id="968d9-133">No</span></span>|<span data-ttu-id="968d9-134">否</span><span class="sxs-lookup"><span data-stu-id="968d9-134">No</span></span>|<span data-ttu-id="968d9-135">否</span><span class="sxs-lookup"><span data-stu-id="968d9-135">No</span></span>|<span data-ttu-id="968d9-136">否</span><span class="sxs-lookup"><span data-stu-id="968d9-136">No</span></span>|  
|<span data-ttu-id="968d9-137">**MSX = 8.0 SP3 或更高版本**</span><span class="sxs-lookup"><span data-stu-id="968d9-137">**MSX = 8.0 SP3 or higher**</span></span>|<span data-ttu-id="968d9-138">否</span><span class="sxs-lookup"><span data-stu-id="968d9-138">No</span></span>|<span data-ttu-id="968d9-139">否</span><span class="sxs-lookup"><span data-stu-id="968d9-139">No</span></span>|<span data-ttu-id="968d9-140">是</span><span class="sxs-lookup"><span data-stu-id="968d9-140">Yes</span></span>|<span data-ttu-id="968d9-141">是</span><span class="sxs-lookup"><span data-stu-id="968d9-141">Yes</span></span>|<span data-ttu-id="968d9-142">是</span><span class="sxs-lookup"><span data-stu-id="968d9-142">Yes</span></span>|<span data-ttu-id="968d9-143">是</span><span class="sxs-lookup"><span data-stu-id="968d9-143">Yes</span></span>|<span data-ttu-id="968d9-144">是</span><span class="sxs-lookup"><span data-stu-id="968d9-144">Yes</span></span>|  
|<span data-ttu-id="968d9-145">**MSX = 9.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-145">**MSX = 9.0**</span></span>|<span data-ttu-id="968d9-146">否</span><span class="sxs-lookup"><span data-stu-id="968d9-146">No</span></span>|<span data-ttu-id="968d9-147">否</span><span class="sxs-lookup"><span data-stu-id="968d9-147">No</span></span>|<span data-ttu-id="968d9-148">否</span><span class="sxs-lookup"><span data-stu-id="968d9-148">No</span></span>|<span data-ttu-id="968d9-149">是</span><span class="sxs-lookup"><span data-stu-id="968d9-149">Yes</span></span>|<span data-ttu-id="968d9-150">是</span><span class="sxs-lookup"><span data-stu-id="968d9-150">Yes</span></span>|<span data-ttu-id="968d9-151">是</span><span class="sxs-lookup"><span data-stu-id="968d9-151">Yes</span></span>|<span data-ttu-id="968d9-152">是</span><span class="sxs-lookup"><span data-stu-id="968d9-152">Yes</span></span>|  
|<span data-ttu-id="968d9-153">**MSX = 10.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-153">**MSX = 10.0**</span></span>|<span data-ttu-id="968d9-154">否</span><span class="sxs-lookup"><span data-stu-id="968d9-154">No</span></span>|<span data-ttu-id="968d9-155">否</span><span class="sxs-lookup"><span data-stu-id="968d9-155">No</span></span>|<span data-ttu-id="968d9-156">否</span><span class="sxs-lookup"><span data-stu-id="968d9-156">No</span></span>|<span data-ttu-id="968d9-157">否</span><span class="sxs-lookup"><span data-stu-id="968d9-157">No</span></span>|<span data-ttu-id="968d9-158">是</span><span class="sxs-lookup"><span data-stu-id="968d9-158">Yes</span></span>|<span data-ttu-id="968d9-159">是</span><span class="sxs-lookup"><span data-stu-id="968d9-159">Yes</span></span>|<span data-ttu-id="968d9-160">是</span><span class="sxs-lookup"><span data-stu-id="968d9-160">Yes</span></span>|  
|<span data-ttu-id="968d9-161">**MSX = 10.5**</span><span class="sxs-lookup"><span data-stu-id="968d9-161">**MSX = 10.5**</span></span>|<span data-ttu-id="968d9-162">否</span><span class="sxs-lookup"><span data-stu-id="968d9-162">No</span></span>|<span data-ttu-id="968d9-163">否</span><span class="sxs-lookup"><span data-stu-id="968d9-163">No</span></span>|<span data-ttu-id="968d9-164">否</span><span class="sxs-lookup"><span data-stu-id="968d9-164">No</span></span>|<span data-ttu-id="968d9-165">否</span><span class="sxs-lookup"><span data-stu-id="968d9-165">No</span></span>|<span data-ttu-id="968d9-166">否</span><span class="sxs-lookup"><span data-stu-id="968d9-166">No</span></span>|<span data-ttu-id="968d9-167">是</span><span class="sxs-lookup"><span data-stu-id="968d9-167">Yes</span></span>|<span data-ttu-id="968d9-168">是</span><span class="sxs-lookup"><span data-stu-id="968d9-168">Yes</span></span>|  
|<span data-ttu-id="968d9-169">**MSX = 11.0**</span><span class="sxs-lookup"><span data-stu-id="968d9-169">**MSX = 11.0**</span></span>|<span data-ttu-id="968d9-170">否</span><span class="sxs-lookup"><span data-stu-id="968d9-170">No</span></span>|<span data-ttu-id="968d9-171">否</span><span class="sxs-lookup"><span data-stu-id="968d9-171">No</span></span>|<span data-ttu-id="968d9-172">否</span><span class="sxs-lookup"><span data-stu-id="968d9-172">No</span></span>|<span data-ttu-id="968d9-173">否</span><span class="sxs-lookup"><span data-stu-id="968d9-173">No</span></span>|<span data-ttu-id="968d9-174">否</span><span class="sxs-lookup"><span data-stu-id="968d9-174">No</span></span>|<span data-ttu-id="968d9-175">否</span><span class="sxs-lookup"><span data-stu-id="968d9-175">No</span></span>|<span data-ttu-id="968d9-176">是</span><span class="sxs-lookup"><span data-stu-id="968d9-176">Yes</span></span>|  
  
 <span data-ttu-id="968d9-177">创建多服务器环境时，考虑下列问题：</span><span class="sxs-lookup"><span data-stu-id="968d9-177">Consider the following issues when creating a multiserver environment:</span></span>  
  
-   <span data-ttu-id="968d9-178">每台目标服务器只向一台主服务器报告。</span><span class="sxs-lookup"><span data-stu-id="968d9-178">Each target server reports to only one master server.</span></span> <span data-ttu-id="968d9-179">必须将目标服务器从一台主服务器上脱离，才能将其登记在其他服务器上。</span><span class="sxs-lookup"><span data-stu-id="968d9-179">You must defect a target server from one master server before you can enlist it into a different one.</span></span>  
  
-   <span data-ttu-id="968d9-180">更改目标服务器的名称时，必须在更改名称之前将其脱离并在更改后重新登记。</span><span class="sxs-lookup"><span data-stu-id="968d9-180">When changing the name of a target server, you must defect it before changing the name and re-enlist it after the change.</span></span>  
  
-   <span data-ttu-id="968d9-181">若要取消多服务器配置，必须使所有目标服务器脱离主服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-181">If you want to dismantle a multiserver configuration, you must defect all the target servers from the master server.</span></span>  
  
-   <span data-ttu-id="968d9-182">SQL Server Integration Services 仅支持版本与主服务器版本相同或更高的目标服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-182">SQL Server Integration Services only supports target servers that are the same version or higher than the master server version.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="968d9-183">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="968d9-183">Related Tasks</span></span>  
 <span data-ttu-id="968d9-184">以下主题介绍创建多服务器环境的常见任务：</span><span class="sxs-lookup"><span data-stu-id="968d9-184">The following topics document common tasks for creating a multiserver environment.</span></span>  
  
|<span data-ttu-id="968d9-185">说明</span><span class="sxs-lookup"><span data-stu-id="968d9-185">Description</span></span>|<span data-ttu-id="968d9-186">主题</span><span class="sxs-lookup"><span data-stu-id="968d9-186">Topic</span></span>|  
|-----------------|-----------|  
|<span data-ttu-id="968d9-187">描述如何创建主服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-187">Describes how to create a master server.</span></span>|[<span data-ttu-id="968d9-188">设置主服务器</span><span class="sxs-lookup"><span data-stu-id="968d9-188">Make a Master Server</span></span>](make-a-master-server.md)|  
|<span data-ttu-id="968d9-189">描述如何创建目标服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-189">Describes how to create a target server.</span></span>|[<span data-ttu-id="968d9-190">设置目标服务器</span><span class="sxs-lookup"><span data-stu-id="968d9-190">Make a Target Server</span></span>](make-a-target-server.md)|  
|<span data-ttu-id="968d9-191">描述如何将目标服务器登记到主服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-191">Describes how to enlist a target server into a master server.</span></span>|[<span data-ttu-id="968d9-192">将目标服务器登记到主服务器</span><span class="sxs-lookup"><span data-stu-id="968d9-192">Enlist a Target Server to a Master Server</span></span>](enlist-a-target-server-to-a-master-server.md)|  
|<span data-ttu-id="968d9-193">描述如何使目标服务器从主服务器脱离。</span><span class="sxs-lookup"><span data-stu-id="968d9-193">Describes how to defect a target server from a master server.</span></span>|[<span data-ttu-id="968d9-194">将目标服务器从主服务器脱离</span><span class="sxs-lookup"><span data-stu-id="968d9-194">Defect a Target Server from a Master Server</span></span>](defect-a-target-server-from-a-master-server.md)|  
|<span data-ttu-id="968d9-195">描述如何使多台目标服务器脱离主服务器。</span><span class="sxs-lookup"><span data-stu-id="968d9-195">Describes how to defect multiple target servers from a master server.</span></span>|[<span data-ttu-id="968d9-196">将多台目标服务器从主服务器脱离</span><span class="sxs-lookup"><span data-stu-id="968d9-196">Defect Multiple Target Servers from a Master Server</span></span>](defect-multiple-target-servers-from-a-master-server.md)|  
|<span data-ttu-id="968d9-197">描述如何检查目标服务器的状态。</span><span class="sxs-lookup"><span data-stu-id="968d9-197">Describes how to check the status of a target server.</span></span>|[<span data-ttu-id="968d9-198">sp_help_targetserver &#40;Transact-sql&#41;</span><span class="sxs-lookup"><span data-stu-id="968d9-198">sp_help_targetserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-help-targetserver-transact-sql)<br /><br /> [<span data-ttu-id="968d9-199">sp_help_targetservergroup &#40;Transact-sql&#41;</span><span class="sxs-lookup"><span data-stu-id="968d9-199">sp_help_targetservergroup &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-help-targetservergroup-transact-sql)|  
  
## <a name="see-also"></a><span data-ttu-id="968d9-200">另请参阅</span><span class="sxs-lookup"><span data-stu-id="968d9-200">See Also</span></span>  
 [<span data-ttu-id="968d9-201">排除使用代理的多服务器作业的故障</span><span class="sxs-lookup"><span data-stu-id="968d9-201">Troubleshoot Multiserver Jobs That Use Proxies</span></span>](troubleshoot-multiserver-jobs-that-use-proxies.md)  
  
  
