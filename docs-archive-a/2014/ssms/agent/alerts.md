---
title: 警报 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- SQL Server Agent alerts, event types
- SQL Server Agent alerts, names
- alerts [SQL Server], performance conditions
- alerts [SQL Server], about alerts
- WMI event responses [SQL Server Agent alerts]
- events [WMI]
- performance condition alerts [SQL Server Agent]
- alerts [SQL Server], event types
- SQL Server Agent alerts, performance conditions
- SQL Server Agent alerts, about alerts
- alerts [SQL Server], names
ms.assetid: 3f57d0f0-4781-46ec-82cd-b751dc5affef
author: stevestein
ms.author: sstein
ms.openlocfilehash: 946bfd0c05e7739af4bfebf799980a0dc27de245
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692105"
---
# <a name="alerts"></a><span data-ttu-id="a8b9d-102">警报</span><span class="sxs-lookup"><span data-stu-id="a8b9d-102">Alerts</span></span>
  <span data-ttu-id="a8b9d-103">事件由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 生成并被输入到 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 应用程序日志中。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-103">Events are generated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and entered into the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows application log.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-104">代理读取应用程序日志，并将写入的事件与定义的警报比较。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-104">Agent reads the application log and compares events written there to alerts that you have defined.</span></span> <span data-ttu-id="a8b9d-105">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理找到匹配项时，它将发出自动响应事件的警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-105">When [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent finds a match, it fires an alert, which is an automated response to an event.</span></span> <span data-ttu-id="a8b9d-106">除了监视 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 事件以外， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理还监视性能条件和 Windows Management Instrumentation (WMI) 事件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-106">In addition to monitoring [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] events, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent can also monitor performance conditions and Windows Management Instrumentation (WMI) events.</span></span>  
  
 <span data-ttu-id="a8b9d-107">若要定义警报，需要指定：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-107">To define an alert, you specify:</span></span>  
  
-   <span data-ttu-id="a8b9d-108">警报的名称。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-108">The name of the alert.</span></span>  
  
-   <span data-ttu-id="a8b9d-109">触发警报的事件或性能条件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-109">The event or performance condition that triggers the alert.</span></span>  
  
-   <span data-ttu-id="a8b9d-110">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理响应事件或性能条件所执行的操作。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-110">The action that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent takes in response to the event or performance condition.</span></span>  
  
## <a name="naming-an-alert"></a><span data-ttu-id="a8b9d-111">命名警报</span><span class="sxs-lookup"><span data-stu-id="a8b9d-111">Naming an Alert</span></span>  
 <span data-ttu-id="a8b9d-112">每个警报都必须有一个名称。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-112">Every alert must have a name.</span></span> <span data-ttu-id="a8b9d-113">警报名称在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例内必须唯一，并且不能超过 **128** 个字符。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-113">Alert names must be unique within the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and can be no longer than **128** characters.</span></span>  
  
## <a name="selecting-an-event-type"></a><span data-ttu-id="a8b9d-114">选择事件类型</span><span class="sxs-lookup"><span data-stu-id="a8b9d-114">Selecting an Event Type</span></span>  
 <span data-ttu-id="a8b9d-115">一个警报响应一种特定的事件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-115">An alert responds to an event of a specific type.</span></span> <span data-ttu-id="a8b9d-116">警报响应下列事件类型：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-116">Alerts respond to the following event types:</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-117">事件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-117">events</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-118">性能条件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-118">performance conditions</span></span>  
  
-   <span data-ttu-id="a8b9d-119">WMI 事件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-119">WMI events</span></span>  
  
 <span data-ttu-id="a8b9d-120">事件类型决定了用于指定具体事件的参数。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-120">The type of the event determines the parameters that you use to specify the precise event.</span></span>  
  
## <a name="specifying-a-sql-server-event"></a><span data-ttu-id="a8b9d-121">指定 SQL Server 事件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-121">Specifying a SQL Server Event</span></span>  
 <span data-ttu-id="a8b9d-122">可以指定一个警报响应一个或多个事件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-122">You can specify an alert to occur in response to one or more events.</span></span> <span data-ttu-id="a8b9d-123">使用下列参数来指定触发警报的事件：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-123">Use the following parameters to specify the events that trigger an alert:</span></span>  
  
-   <span data-ttu-id="a8b9d-124">**错误号**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-124">**Error number**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-125">代理在发生特定错误时发出警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-125">Agent fires an alert when a specific error occurs.</span></span> <span data-ttu-id="a8b9d-126">例如，可以指定错误号 2571 来响应未经授权就尝试调用数据库控制台命令 (DBCC) 的操作。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-126">For example, you might specify error number 2571 to respond to unauthorized attempts to invoke Database Console Commands (DBCC).</span></span>  
  
-   <span data-ttu-id="a8b9d-127">**严重级别**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-127">**Severity level**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-128">代理在发生特定级别的严重错误时发出警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-128">Agent fires an alert when any error of the specific severity occurs.</span></span> <span data-ttu-id="a8b9d-129">例如，可以指定严重级别 15 来响应 Transact-SQL 语句中的语法错误。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-129">For example, you might specify a severity level of 15 to respond to syntax errors in Transact-SQL statements.</span></span>  
  
-   <span data-ttu-id="a8b9d-130">**Database**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-130">**Database**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-131">代理仅在特定数据库中发生事件时才发出警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-131">Agent fires an alert only when the event occurs in a particular database.</span></span> <span data-ttu-id="a8b9d-132">此选项是对错误号或严重级别的补充。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-132">This option applies in addition to the error number or severity level.</span></span> <span data-ttu-id="a8b9d-133">例如，如果实例中包含一个用于生产的数据库和一个用于报告的数据库，可以定义仅响应生产数据库中的语法错误的警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-133">For example, if an instance contains one database that is used for production and one database that is used for reporting, you can define an alert that responds to syntax errors in the production database only.</span></span>  
  
-   <span data-ttu-id="a8b9d-134">**事件文本**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-134">**Event text**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-135">代理在指定事件的事件消息中包含特定文本字符串时发出警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-135">Agent fires an alert when the specified event contains a particular text string in the event message.</span></span> <span data-ttu-id="a8b9d-136">例如，可以定义警报来响应包含特定表名或特定约束的消息。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-136">For example, you might define an alert that responds to messages that contain the name of a particular table or a particular constraint.</span></span>  
  
## <a name="selecting-a-performance-condition"></a><span data-ttu-id="a8b9d-137">选择性能条件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-137">Selecting a Performance Condition</span></span>  
 <span data-ttu-id="a8b9d-138">可以指定警报来响应特定的性能条件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-138">You can specify an alert to occur in response to a particular performance condition.</span></span> <span data-ttu-id="a8b9d-139">在这种情况下，需要指定要监视的性能计数器、警报的阈值以及警报发生时计数器必须执行的操作。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-139">In this case, you specify the performance counter to monitor, a threshold for the alert, and the behavior that the counter must show if the alert is to occur.</span></span> <span data-ttu-id="a8b9d-140">若要设置性能条件，必须在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理的“新建警报”或“警报属性”对话框中的“常规”页上定义下列项：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-140">To set a performance condition, you must define the following items on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent **General** page of the **New Alert** or the **Alert Properties** dialog box:</span></span>  
  
-   <span data-ttu-id="a8b9d-141">**Object**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-141">**Object**</span></span>  
  
     <span data-ttu-id="a8b9d-142">对象是要监视的性能区域。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-142">The object is the area of performance to be monitored.</span></span>  
  
-   <span data-ttu-id="a8b9d-143">**计数器**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-143">**Counter**</span></span>  
  
     <span data-ttu-id="a8b9d-144">计数器是要监视的区域的属性。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-144">A counter is an attribute of the area to be monitored.</span></span>  
  
-   <span data-ttu-id="a8b9d-145">**实例**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-145">**Instance**</span></span>  
  
     <span data-ttu-id="a8b9d-146">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例定义了要监视的属性的特定实例（如果存在）。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-146">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance defines the specific instance (if any) of the attribute to be monitored.</span></span>  
  
-   <span data-ttu-id="a8b9d-147">**计数器** 和 **值**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-147">**Alert if counter** and **Value**</span></span>  
  
     <span data-ttu-id="a8b9d-148">警报的阈值和导致警报的行为。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-148">The threshold for the alert and the behavior that produces the alert.</span></span> <span data-ttu-id="a8b9d-149">阈值是数字。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-149">The threshold is a number.</span></span> <span data-ttu-id="a8b9d-150">行为是下列之一：“低于”、“等于”或“大于”指定的值。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-150">The behavior is one **of the following: falls below**, **becomes equal to**, or **rises above a number specified for Value**.</span></span> <span data-ttu-id="a8b9d-151">**值** 是描述性能条件计数器的数字。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-151">The **Value** is a number that describes the performance condition counter.</span></span> <span data-ttu-id="a8b9d-152">例如，若要为性能对象 **SQLServer:Locks** 设置在 **Lock Wait Time** 超过 30 分钟时要发生的警报，则可以选择“大于”并“指定 30 作为值”。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-152">For example, to set an alert to occur for the performance object **SQLServer:Locks** when the **Lock Wait Time** exceeds 30 minutes, you would choose **rises above** and **specify 30 as the value**.</span></span>  
  
     <span data-ttu-id="a8b9d-153">又如，可以为性能对象 **SQLServer:Transactions** 指定在 **tempdb** 中的可用空间低于 1000 KB 时发出警报。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-153">As another example, you might specify that an alert occurs for the performance object **SQLServer:Transactions** when the free space in **tempdb** falls below 1000 KB.</span></span> <span data-ttu-id="a8b9d-154">若要这样设置，应当选择计数器 **Free space in tempdb (KB)** 、“小于”和“值” **1000**。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-154">To set this, you would choose the counter **Free space in tempdb (KB)**, **falls below**,and a **Value** of **1000**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a8b9d-155">性能数据被周期性地采样，这会在达到阈值与发出性能警报之间造成短暂的延迟（几秒钟）。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-155">Performance data is sampled periodically, which can lead to a small delay (a few seconds) between the threshold being reached and the occurrence of the performance alert.</span></span>  
  
## <a name="selecting-a-wmi-event"></a><span data-ttu-id="a8b9d-156">选择 WMI 事件</span><span class="sxs-lookup"><span data-stu-id="a8b9d-156">Selecting a WMI Event</span></span>  
 <span data-ttu-id="a8b9d-157">可以指定发出警报来响应特定的 WMI 事件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-157">You can specify that an alert occur in response to a particular WMI event.</span></span> <span data-ttu-id="a8b9d-158">若要选择 WMI 事件，必须在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理的“新建警报”或“警报属性”对话框中的“常规”页上定义下列内容：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-158">To select a WMI event, you must define the following on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent **General** page of the **New Alert** or the **Alert Properties** dialog box:</span></span>  
  
-   <span data-ttu-id="a8b9d-159">**Namespace**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-159">**Namespace**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-160">代理作为 WMI 客户端在 WMI 命名空间（使用该命名空间查询事件）进行注册。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-160">Agent registers as a WMI client to the WMI namespace that is provided to query for events.</span></span>  
  
-   <span data-ttu-id="a8b9d-161">**查询**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-161">**Query**</span></span>  
  
     [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="a8b9d-162">代理使用所提供的 Windows Management Instrumentation 查询语言 (WQL) 语句来标识特定事件。</span><span class="sxs-lookup"><span data-stu-id="a8b9d-162">Agent uses the Windows Management Instrumentation Query Language (WQL) statement provided to identify the specific event.</span></span>  
  
 <span data-ttu-id="a8b9d-163">下列链接指向常见的任务：</span><span class="sxs-lookup"><span data-stu-id="a8b9d-163">Following are links to common tasks:</span></span>  
  
 <span data-ttu-id="a8b9d-164">**基于消息号创建警报**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-164">**To create an alert based on a message number**</span></span>  
  
-   [<span data-ttu-id="a8b9d-165">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a8b9d-165">SQL Server Management Studio</span></span>](create-an-alert-using-an-error-number.md)  
  
-   [<span data-ttu-id="a8b9d-166">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-166">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-alert-transact-sql)  
  
 <span data-ttu-id="a8b9d-167">**基于严重级别创建警报**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-167">**To create an alert based on severity levels**</span></span>  
  
-   [<span data-ttu-id="a8b9d-168">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a8b9d-168">SQL Server Management Studio</span></span>](create-an-alert-using-severity-level.md)  
  
-   [<span data-ttu-id="a8b9d-169">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-169">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-alert-transact-sql)  
  
 <span data-ttu-id="a8b9d-170">**基于 WMI 事件创建警报**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-170">**To create an alert based on a WMI event**</span></span>  
  
-   [<span data-ttu-id="a8b9d-171">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a8b9d-171">SQL Server Management Studio</span></span>](create-a-wmi-event-alert.md)  
  
-   [<span data-ttu-id="a8b9d-172">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-172">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-alert-transact-sql)  
  
 <span data-ttu-id="a8b9d-173">**定义对警报的响应**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-173">**To define the response to an alert**</span></span>  
  
-   [<span data-ttu-id="a8b9d-174">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a8b9d-174">SQL Server Management Studio</span></span>](../sql-server-management-studio-ssms.md)  
  
-   [<span data-ttu-id="a8b9d-175">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-175">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-notification-transact-sql)  
  
 <span data-ttu-id="a8b9d-176">**创建用户定义事件的错误消息**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-176">**To create a user-defined event error message**</span></span>  
  
-   [<span data-ttu-id="a8b9d-177">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-177">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-addmessage-transact-sql)  
  
 <span data-ttu-id="a8b9d-178">**修改用户定义事件的错误消息**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-178">**To modify a user-defined event error message**</span></span>  
  
-   [<span data-ttu-id="a8b9d-179">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-179">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-altermessage-transact-sql)  
  
 <span data-ttu-id="a8b9d-180">**删除用户定义事件的错误消息**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-180">**To delete a user-defined event error message**</span></span>  
  
-   [<span data-ttu-id="a8b9d-181">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-181">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropmessage-transact-sql)  
  
 <span data-ttu-id="a8b9d-182">**禁用或重新激活警报**</span><span class="sxs-lookup"><span data-stu-id="a8b9d-182">**To disable or reactivate an alert**</span></span>  
  
-   [<span data-ttu-id="a8b9d-183">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="a8b9d-183">SQL Server Management Studio</span></span>](disable-or-reactivate-an-alert.md)  
  
-   [<span data-ttu-id="a8b9d-184">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="a8b9d-184">Transact-SQL</span></span>](/sql/relational-databases/system-stored-procedures/sp-update-alert-transact-sql)  
  
## <a name="see-also"></a><span data-ttu-id="a8b9d-185">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a8b9d-185">See Also</span></span>  
 [<span data-ttu-id="a8b9d-186">使用 SQL Server 对象</span><span class="sxs-lookup"><span data-stu-id="a8b9d-186">Use SQL Server Objects</span></span>](../../relational-databases/performance-monitor/use-sql-server-objects.md)  
  
  
