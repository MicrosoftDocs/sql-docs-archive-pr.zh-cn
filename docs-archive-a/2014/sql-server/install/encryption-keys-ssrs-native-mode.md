---
title: " (SSRS 本机模式) 的加密密钥 |Microsoft Docs"
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- SQL12.rsconfigtool.encryptionkeypanel.F1
ms.assetid: cc7e6f84-80e1-4b5e-9409-d0e074edd147
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 78e9816a9e779459cd1388c1f7f10257c89b1ae5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588888"
---
# <a name="encryption-keys-ssrs-native-mode"></a><span data-ttu-id="283c2-102">加密密钥（SSRS 本机模式）</span><span class="sxs-lookup"><span data-stu-id="283c2-102">Encryption Keys (SSRS Native Mode)</span></span>
  <span data-ttu-id="283c2-103">使用“加密密钥”页可以管理用于对报表服务器中数据进行加密和解密的对称密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-103">Use the Encryption Keys page to manage the symmetric key that is used to encrypt and decrypt data in a report server.</span></span> <span data-ttu-id="283c2-104">管理加密密钥是报表服务器配置的一个重要方面。</span><span class="sxs-lookup"><span data-stu-id="283c2-104">Managing the encryption keys is an important part of report server configuration.</span></span> <span data-ttu-id="283c2-105">在创建报表服务器数据库时，自动创建并应用对称密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-105">The symmetric key is created and applied automatically when you create the report server database.</span></span> <span data-ttu-id="283c2-106">创建对称密钥的备份副本，以便您可以执行例行的维护操作。</span><span class="sxs-lookup"><span data-stu-id="283c2-106">Create a backup copy of the symmetric key so that you can perform routine maintenance operations.</span></span> <span data-ttu-id="283c2-107">您需要具有对称密钥的有效副本，才可执行以下维护任务：</span><span class="sxs-lookup"><span data-stu-id="283c2-107">The following maintenance tasks require that you have a valid copy of the symmetric key:</span></span>  
  
-   <span data-ttu-id="283c2-108">更改报表服务器服务的服务帐户。</span><span class="sxs-lookup"><span data-stu-id="283c2-108">Changing the service account for the Report Server service.</span></span>  
  
-   <span data-ttu-id="283c2-109">将 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安装迁移到其他计算机。</span><span class="sxs-lookup"><span data-stu-id="283c2-109">Migrating a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation to a different computer.</span></span>  
  
-   <span data-ttu-id="283c2-110">配置新的报表服务器实例以共享或使用现有报表服务器数据库。</span><span class="sxs-lookup"><span data-stu-id="283c2-110">Configuring a new report server instance to share or use an existing report server database.</span></span>  
  
 [!INCLUDE[applies](../../includes/applies-md.md)]<span data-ttu-id="283c2-111">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]本机模式。</span><span class="sxs-lookup"><span data-stu-id="283c2-111">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Native mode.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="283c2-112">定期更改 Reporting Services 加密密钥是确保安全的好办法。</span><span class="sxs-lookup"><span data-stu-id="283c2-112">Periodically changing the Reporting Services encryption key is a security best practice.</span></span> <span data-ttu-id="283c2-113">建议在升级 Reporting Services 主版本后立即更改密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-113">A recommended time to change the key is immediately following a major version upgrade of Reporting Services.</span></span> <span data-ttu-id="283c2-114">升级后更改密钥将使在升级周期外更改 Reporting Services 加密密钥所导致的额外服务中断降到最低程度。</span><span class="sxs-lookup"><span data-stu-id="283c2-114">Changing the key after an upgrade minimizes additional service interruption caused by changing the Reporting Services encryption key outside of the upgrade cycle.</span></span>  
  
 <span data-ttu-id="283c2-115">如果更新了报表服务器服务的用户帐户（并且是使用 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置管理器以外的工具更改了此帐户），或者要将报表服务器安装迁移到新服务器，则必须还原对称密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-115">Restoring the symmetric key is necessary if you updated the user account of the Report Server service (and you used a tool other than the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager to change the account), or if you are migrating a report server installation to a new server.</span></span>  
  
 <span data-ttu-id="283c2-116">为了保护对称密钥免受未经授权的访问，对称密钥使用报表服务器服务的私钥进行了加密。</span><span class="sxs-lookup"><span data-stu-id="283c2-116">To protect the symmetric key from unauthorized access, the symmetric key is encrypted using the private key of the Report Server service.</span></span> <span data-ttu-id="283c2-117">只有报表服务器服务可以解锁并使用对称密钥以在报表服务器数据库中存储敏感数据。</span><span class="sxs-lookup"><span data-stu-id="283c2-117">Only the Report Server service is able to unlock and use the symmetric key to store sensitive data in the report server database.</span></span> <span data-ttu-id="283c2-118">如果更改了报表服务器服务的标识，或者将报表服务器迁移到新计算机，则报表服务器服务的私钥将不再能够解开对称密钥的锁定。</span><span class="sxs-lookup"><span data-stu-id="283c2-118">If you change the identity of the Report Server service, or if you migrate the report server to a new computer, the private key of the Report Server service will no longer be able to unlock the symmetric key.</span></span> <span data-ttu-id="283c2-119">若要恢复对对称密钥的访问，请使用新报表服务器服务标识的私钥重新加密对称密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-119">To restore access to the symmetric key, re-encrypt the symmetric key using the private key of the new Report Server service identity.</span></span> <span data-ttu-id="283c2-120">还原对称密钥就是对对称密钥重新加密的过程。</span><span class="sxs-lookup"><span data-stu-id="283c2-120">Restoring the symmetric key is the process by which the re-encryption occurs.</span></span>  
  
 <span data-ttu-id="283c2-121">只还原当前用于加密和解密报表服务器数据库中数据的对称密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-121">Only restore a symmetric key if it is the same key that is currently used to encrypt and decrypt data in the report server database.</span></span> <span data-ttu-id="283c2-122">如果还原无效的对称密钥，您将不再能够访问敏感数据。</span><span class="sxs-lookup"><span data-stu-id="283c2-122">If you restore a symmetric key that is not valid, you can no longer access sensitive data.</span></span> <span data-ttu-id="283c2-123">在这种情况下，必须删除并重新创建密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-123">In this case, delete and re-create the key.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="283c2-124">删除和重新创建对称密钥的操作不能逆转或撤消。</span><span class="sxs-lookup"><span data-stu-id="283c2-124">The action of deleting and recreating the symmetric key cannot be reversed or undone.</span></span> <span data-ttu-id="283c2-125">删除或重新创建该密钥可能对您当前的安装产生重要影响。</span><span class="sxs-lookup"><span data-stu-id="283c2-125">Deleting or recreating the key can have important ramifications on your current installation.</span></span> <span data-ttu-id="283c2-126">如果删除对称密钥，则使用此密钥加密的所有现有数据也将被删除。</span><span class="sxs-lookup"><span data-stu-id="283c2-126">If you delete the key, any existing data encrypted by the symmetric key will also deleted.</span></span> <span data-ttu-id="283c2-127">删除的数据包括指向外部报表数据源的连接字符串、存储的连接字符串和某些订阅信息。</span><span class="sxs-lookup"><span data-stu-id="283c2-127">Deleted data includes connection strings to external report data sources, stored connection strings, and some subscription information.</span></span>  
  
 <span data-ttu-id="283c2-128">若要打开此页，请启动 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置管理器，然后在导航窗格中选择相应链接。</span><span class="sxs-lookup"><span data-stu-id="283c2-128">To open this page, start the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration Manager and select the link in the navigation pane.</span></span> <span data-ttu-id="283c2-129">有关详细信息，请参阅 [Reporting Services Configuration Manager（本机模式）](../../../2014/sql-server/install/reporting-services-configuration-manager-native-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="283c2-129">For more information, see [Reporting Services Configuration Manager &#40;Native Mode&#41;](../../../2014/sql-server/install/reporting-services-configuration-manager-native-mode.md).</span></span>  
  
## <a name="options"></a><span data-ttu-id="283c2-130">选项</span><span class="sxs-lookup"><span data-stu-id="283c2-130">Options</span></span>  
 <span data-ttu-id="283c2-131">**备份**</span><span class="sxs-lookup"><span data-stu-id="283c2-131">**Backup**</span></span>  
 <span data-ttu-id="283c2-132">将对称密钥复制到您指定的文件。</span><span class="sxs-lookup"><span data-stu-id="283c2-132">Copies the symmetric key to a file that you specify.</span></span> <span data-ttu-id="283c2-133">对称密钥决不能以纯文本形式存储。</span><span class="sxs-lookup"><span data-stu-id="283c2-133">The symmetric key is never stored in plain text.</span></span> <span data-ttu-id="283c2-134">您必须键入密码来保护该文件。</span><span class="sxs-lookup"><span data-stu-id="283c2-134">You must type a password to protect the file.</span></span>  
  
 <span data-ttu-id="283c2-135">**还原**</span><span class="sxs-lookup"><span data-stu-id="283c2-135">**Restore**</span></span>  
 <span data-ttu-id="283c2-136">将以前保存的对称密钥的副本应用于报表服务器数据库。</span><span class="sxs-lookup"><span data-stu-id="283c2-136">Applies a previously saved copy of the symmetric key to the report server database.</span></span> <span data-ttu-id="283c2-137">您必须提供密码对文件进行解锁。</span><span class="sxs-lookup"><span data-stu-id="283c2-137">You must provide the password to unlock the file.</span></span>  
  
 <span data-ttu-id="283c2-138">还原后的对称密钥副本将覆盖当前连接的报表服务器实例还原前的对称密钥副本。</span><span class="sxs-lookup"><span data-stu-id="283c2-138">The previous copy of the symmetric key for the report server instance you are currently connected to is overwritten by the restored version.</span></span> <span data-ttu-id="283c2-139">还原对称密钥后，必须初始化使用该报表服务器数据库的所有报表服务器。</span><span class="sxs-lookup"><span data-stu-id="283c2-139">After you restore the symmetric key, you must initialize all the report servers that use the report server database.</span></span> <span data-ttu-id="283c2-140">有关初始化报表服务器的详细信息，请参阅[&#41;&#40;SSRS Configuration Manager 初始化报表服务器](../../reporting-services/install-windows/ssrs-encryption-keys-initialize-a-report-server.md)。</span><span class="sxs-lookup"><span data-stu-id="283c2-140">For more information about initializing report servers, see [Initialize a Report Server &#40;SSRS Configuration Manager&#41;](../../reporting-services/install-windows/ssrs-encryption-keys-initialize-a-report-server.md).</span></span>  
  
 <span data-ttu-id="283c2-141">**更改**</span><span class="sxs-lookup"><span data-stu-id="283c2-141">**Change**</span></span>  
 <span data-ttu-id="283c2-142">重新创建对称密钥并对报表服务器数据库中的所有加密值重新进行加密。</span><span class="sxs-lookup"><span data-stu-id="283c2-142">Recreates the symmetric key and re-encrypts all encrypted values in the report server database.</span></span> <span data-ttu-id="283c2-143">请确保在重新创建对称密钥前停止报表服务器服务。</span><span class="sxs-lookup"><span data-stu-id="283c2-143">Be sure to stop the Report Server service before recreating the symmetric key.</span></span>  
  
 <span data-ttu-id="283c2-144">在扩展部署中，对称密钥的所有副本都将替换为新的版本。</span><span class="sxs-lookup"><span data-stu-id="283c2-144">In a scale-out deployment, all copies of the symmetric key are replaced with newer versions.</span></span> <span data-ttu-id="283c2-145">在更改对称密钥前，请务必检查加入扩展部署的服务器的列表，以确认仅对有效的报表服务器实例授予了对新密钥的访问权限。</span><span class="sxs-lookup"><span data-stu-id="283c2-145">Before changing the symmetric key, be sure to review the list of servers that are joined to the scale-out deployment to verify that only valid report server instances are given access to the new key.</span></span> <span data-ttu-id="283c2-146">“扩展部署”页列出了扩展部署中包含的服务器 \*\*\*\* 。</span><span class="sxs-lookup"><span data-stu-id="283c2-146">The servers that are part of a scale-out deployment are listed in the **Scale-out Deployment** page.</span></span> <span data-ttu-id="283c2-147">在重新创建密钥前，请停止部署中包含的各个报表服务器上的报表服务器服务。</span><span class="sxs-lookup"><span data-stu-id="283c2-147">Stop the service on each report server in the deployment before recreating the key.</span></span>  
  
 <span data-ttu-id="283c2-148">请注意，如果您具有许多数据源和订阅，则重新生成对称密钥的过程可能需要耗费较长的时间。</span><span class="sxs-lookup"><span data-stu-id="283c2-148">Note that regenerating the symmetric key can be a long-running process if you have many data sources and subscriptions.</span></span>  
  
 <span data-ttu-id="283c2-149">**删除**</span><span class="sxs-lookup"><span data-stu-id="283c2-149">**Delete**</span></span>  
 <span data-ttu-id="283c2-150">删除对称密钥和所有加密内容（包括连接字符串和存储的凭据）。</span><span class="sxs-lookup"><span data-stu-id="283c2-150">Deletes the symmetric key and all encrypted content, including connection strings and stored credentials.</span></span> <span data-ttu-id="283c2-151">如果您无法还原对称密钥，则只能删除该密钥。</span><span class="sxs-lookup"><span data-stu-id="283c2-151">You should only delete the symmetric key if you cannot restore it.</span></span>  
  
 <span data-ttu-id="283c2-152">一旦删除了对称密钥，您必须在报表和共享数据源中重新输入缺少的连接字符串和存储的凭据，因为其中已不再具有这些值。</span><span class="sxs-lookup"><span data-stu-id="283c2-152">Once you delete the symmetric key, you must re-enter the missing connection strings and stored credentials in the reports and shared data sources that no longer have these values.</span></span> <span data-ttu-id="283c2-153">另外，对于使用存储加密数据的传递扩展插件的所有订阅，还必须进行更新。</span><span class="sxs-lookup"><span data-stu-id="283c2-153">You must also update all subscriptions that use delivery extensions that store encrypted data.</span></span> <span data-ttu-id="283c2-154">这包括使用加密值的文件共享传递扩展插件和任何第三方传递扩展插件。</span><span class="sxs-lookup"><span data-stu-id="283c2-154">This includes the file share delivery extension and any third-party delivery extension that use encrypted value.</span></span>  
  
 <span data-ttu-id="283c2-155">此信息无法自动更新。</span><span class="sxs-lookup"><span data-stu-id="283c2-155">There is no automated way to update this information.</span></span> <span data-ttu-id="283c2-156">一次只能更新一个使用存储的凭据和连接字符串的报表、订阅和共享数据源。</span><span class="sxs-lookup"><span data-stu-id="283c2-156">Each report, subscription, and shared data source that uses stored credentials and connection strings must be updated one at a time.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="283c2-157">另请参阅</span><span class="sxs-lookup"><span data-stu-id="283c2-157">See Also</span></span>  
 <span data-ttu-id="283c2-158">[Reporting Services 配置管理器的 F1 帮助主题 &#40;SSRS 本机模式&#41;](../../../2014/sql-server/install/reporting-services-configuration-manager-f1-help-topics-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="283c2-158">[Reporting Services Configuration Manager F1 Help Topics &#40;SSRS Native Mode&#41;](../../../2014/sql-server/install/reporting-services-configuration-manager-f1-help-topics-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="283c2-159">[备份和还原 Reporting Services 加密密钥](../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="283c2-159">[Back Up and Restore Reporting Services Encryption Keys](../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span></span>  
 <span data-ttu-id="283c2-160">[删除和重新创建加密密钥（SSRS 配置管理器）](../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="283c2-160">[Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span></span>  
 <span data-ttu-id="283c2-161">[初始化 Report Server（SSRS 配置管理器）](../../reporting-services/install-windows/ssrs-encryption-keys-initialize-a-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="283c2-161">[Initialize a Report Server &#40;SSRS Configuration Manager&#41;](../../reporting-services/install-windows/ssrs-encryption-keys-initialize-a-report-server.md) </span></span>  
 [<span data-ttu-id="283c2-162">存储加密的 Report Server 数据（SSRS 配置管理器）</span><span class="sxs-lookup"><span data-stu-id="283c2-162">Store Encrypted Report Server Data &#40;SSRS Configuration Manager&#41;</span></span>](../../reporting-services/install-windows/ssrs-encryption-keys-store-encrypted-report-server-data.md)  
  
  
