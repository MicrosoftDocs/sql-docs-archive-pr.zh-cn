---
title: 在 SharePoint 服务器上安装 Analysis Services OLE DB Provider |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: 2c62daf9-1f2d-4508-a497-af62360ee859
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 371d344a451e7702a525e0cb6afa3421b6598cac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588862"
---
# <a name="install-the-analysis-services-ole-db-provider-on-sharepoint-servers"></a><span data-ttu-id="c8493-102">在 SharePoint 服务器上安装 Analysis Services OLE DB 访问接口</span><span class="sxs-lookup"><span data-stu-id="c8493-102">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>
  <span data-ttu-id="c8493-103">Microsoft OLE DB Provider for Analysis Services (MSOLAP) 是客户端应用程序用来与 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据进行交互的接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-103">The Microsoft OLE DB Provider for Analysis Services (MSOLAP) is an interface that client applications use to interact with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="c8493-104">在包含 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的 SharePoint 环境中，此访问接口用于处理对 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 数据的连接请求。</span><span class="sxs-lookup"><span data-stu-id="c8493-104">In a SharePoint environment that includes [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], the provider handles connection requests for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data.</span></span>  
  
 <span data-ttu-id="c8493-105">此数据访问接口包含在 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安装包 (spPowerPivot.msi) 中，但可能需要手动安装。</span><span class="sxs-lookup"><span data-stu-id="c8493-105">The data provider is included in the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi), but might require manual installation.</span></span> <span data-ttu-id="c8493-106">有两个原因您可能需要在 SharePoint 服务器上手动安装客户端库或数据访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-106">There are two reasons why you might need to manually install a client library or data provider on a SharePoint server.</span></span>  
  
-   <span data-ttu-id="c8493-107">**允许向后兼容**。</span><span class="sxs-lookup"><span data-stu-id="c8493-107">**Enable backwards compatibility**.</span></span> [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] <span data-ttu-id="c8493-108">工作簿在连接字符串中指定 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的 Analysis Services OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-108">workbooks specify the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the Analysis Services OLE DB provider in their connection string.</span></span> <span data-ttu-id="c8493-109">因此，计算机上必须存在此访问接口版本，请求才能成功。</span><span class="sxs-lookup"><span data-stu-id="c8493-109">As such, this provider version must be present on the computer in order for the request to succeed.</span></span>  
  
-   <span data-ttu-id="c8493-110">**在专用 Excel Services 实例上允许数据访问**。</span><span class="sxs-lookup"><span data-stu-id="c8493-110">**Enable data access on a dedicated Excel Services instance**.</span></span> <span data-ttu-id="c8493-111">如果 SharePoint 场包含的 Excel Services 位于未安装 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的服务器上，则可使用 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 安装包安装访问接口的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 版本和其他客户端连接组件。</span><span class="sxs-lookup"><span data-stu-id="c8493-111">If your SharePoint farm includes Excel Services on a server that does not also have [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] version of the provider and other client connectivity components by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c8493-112">这些方案并不相互冲突。</span><span class="sxs-lookup"><span data-stu-id="c8493-112">These scenarios are not mutually exclusive.</span></span> <span data-ttu-id="c8493-113">如果在包含运行 Excel Services 的应用程序服务器的场上承载多个工作簿版本而没有 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 实例，您需要在每个 Excel Services 计算机上同时安装数据访问接口的较旧版本和较新版本。</span><span class="sxs-lookup"><span data-stu-id="c8493-113">Hosting multiple workbook versions on a farm that includes application servers running Excel Services without a [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instance will require that you install both older and newer versions of the data provider on each Excel Services computer.</span></span>  
  
  
##  <a name="versions-of-the-ole-db-provider-supporting-powerpivot-data-access"></a><a name="bkmk_vers"></a><span data-ttu-id="c8493-114">支持 PowerPivot 数据访问的 OLE DB 提供程序的版本</span><span class="sxs-lookup"><span data-stu-id="c8493-114">Versions of the OLE DB Provider Supporting PowerPivot Data Access</span></span>  
 <span data-ttu-id="c8493-115">SharePoint 场可能会包含 Analysis Services OLE DB 访问接口的多个版本，其中包括不支持 PowerPivot 数据访问的较早版本。</span><span class="sxs-lookup"><span data-stu-id="c8493-115">A SharePoint farm might include multiple versions of the Analysis Services OLE DB provider, including older versions that do not support PowerPivot data access.</span></span>  
  
 <span data-ttu-id="c8493-116">默认情况下，SharePoint 2010 安装 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 版本的访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-116">By default, SharePoint 2010 installs the [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the provider.</span></span> <span data-ttu-id="c8493-117">虽然标识为 MSOLAP.4（与用于 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]的版本号相同），但此版本不能用于 PowerPivot 数据访问。</span><span class="sxs-lookup"><span data-stu-id="c8493-117">Although it is identified as MSOLAP.4 (the same version number used for [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), this version does not work for PowerPivot data access.</span></span> <span data-ttu-id="c8493-118">要确保连接成功，您必须拥有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 或 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版本的访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-118">In order for connections to succeed, you must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of the provider.</span></span>  
  
 <span data-ttu-id="c8493-119">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之后的 OLE DB 访问接口版本包括对 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 数据结构的传输和连接支持。</span><span class="sxs-lookup"><span data-stu-id="c8493-119">A post [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] version of the OLE DB provider includes transports and connection support for [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data structures.</span></span> [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] <span data-ttu-id="c8493-120">工作簿使用此访问接口的较新版本从场中的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 服务器请求查询处理。</span><span class="sxs-lookup"><span data-stu-id="c8493-120">workbooks use newer versions of this provider to request query processing from [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] servers in the farm.</span></span> <span data-ttu-id="c8493-121">若要获取更新后的版本，可以通过“SQL Server 功能包”页下载并安装它。</span><span class="sxs-lookup"><span data-stu-id="c8493-121">To get an updated version, you can download and install it through a SQL Server Feature Pack page.</span></span>  
  
 <span data-ttu-id="c8493-122">下表对有效版本进行了说明：</span><span class="sxs-lookup"><span data-stu-id="c8493-122">The following table describes the valid versions:</span></span>  
  
|<span data-ttu-id="c8493-123">产品版本</span><span class="sxs-lookup"><span data-stu-id="c8493-123">Product version</span></span>|<span data-ttu-id="c8493-124">文件版本</span><span class="sxs-lookup"><span data-stu-id="c8493-124">File version</span></span>|<span data-ttu-id="c8493-125">适用于：</span><span class="sxs-lookup"><span data-stu-id="c8493-125">Valid for:</span></span>|  
|---------------------|------------------|----------------|  
|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]|<span data-ttu-id="c8493-126">在文件系统中为 MSOLAP100.dll</span><span class="sxs-lookup"><span data-stu-id="c8493-126">MSOLAP100.dll in the file system</span></span><br /><br /> <span data-ttu-id="c8493-127">在 Excel 连接字符串中为 MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="c8493-127">MSOLAP.4 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="c8493-128">在文件版本详细信息中为 10.50.1600 或更高版本</span><span class="sxs-lookup"><span data-stu-id="c8493-128">10.50.1600 or later in file version details</span></span>|<span data-ttu-id="c8493-129">用于使用 PowerPivot for Excel 的 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本创建的数据模型。</span><span class="sxs-lookup"><span data-stu-id="c8493-129">Use for data models created using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel.</span></span>|  
|[!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]|<span data-ttu-id="c8493-130">在文件系统中为 MSOLAP110.dll</span><span class="sxs-lookup"><span data-stu-id="c8493-130">MSOLAP110.dll in the file system</span></span><br /><br /> <span data-ttu-id="c8493-131">在 Excel 连接字符串中为 MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="c8493-131">MSOLAP.5 in an Excel connection string</span></span><br /><br /> <span data-ttu-id="c8493-132">在文件版本详细信息中为 11.0.0000 或更高版本</span><span class="sxs-lookup"><span data-stu-id="c8493-132">11.0.0000 or later in file version details</span></span>|<span data-ttu-id="c8493-133">用于使用 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] for Excel 的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 或 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 版本创建的数据模型。</span><span class="sxs-lookup"><span data-stu-id="c8493-133">Use for data models created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] or [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span>|  
|[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]|<span data-ttu-id="c8493-134">在文件系统中为 MSOLAP120.dll</span><span class="sxs-lookup"><span data-stu-id="c8493-134">MSOLAP120.dll in the file system</span></span><br /><br /> <span data-ttu-id="c8493-135">在文件版本详细信息中为 12.0.20000 或更高版本</span><span class="sxs-lookup"><span data-stu-id="c8493-135">12.0.20000 or later in file version details</span></span>|<span data-ttu-id="c8493-136">用于除 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 模型以外的其他数据模型。</span><span class="sxs-lookup"><span data-stu-id="c8493-136">Use for data models other than [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] models.</span></span>|  
  
  
##  <a name="why-you-need-to-install-the-ole-db-provider"></a><a name="bkmk_why"></a><span data-ttu-id="c8493-137">为什么需要安装 OLE DB 提供程序</span><span class="sxs-lookup"><span data-stu-id="c8493-137">Why you need to install the OLE DB Provider</span></span>  
 <span data-ttu-id="c8493-138">有两种情况需要在场中的服务器上手动安装 OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-138">There are two scenarios that call for manually installing the OLE DB provider on servers in the farm.</span></span>  
  
 <span data-ttu-id="c8493-139">**最常见的情形是** ：较新版本和较旧版本的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 工作簿均保存在场的文档库中。</span><span class="sxs-lookup"><span data-stu-id="c8493-139">**The most common scenario** is when you have older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] workbooks that are saved in document libraries in the farm.</span></span> <span data-ttu-id="c8493-140">如果你的组织中的分析人员使用的是 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel，并已将这些工作簿保存到 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安装，则较旧版本的工作簿将无法使用。</span><span class="sxs-lookup"><span data-stu-id="c8493-140">If analysts in your organization are using the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel, and they save those workbooks to a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, the older workbook will not work.</span></span> <span data-ttu-id="c8493-141">它的连接字符串将引用旧版本的访问接口，除非您安装该版本，否则不会在服务器上。</span><span class="sxs-lookup"><span data-stu-id="c8493-141">Its connection string will reference an older version of the provider, which won't be on the server unless you install it.</span></span> <span data-ttu-id="c8493-142">安装两个版本将可以对较旧版本和较新版本的 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel 中创建的 PowerPivot 工作簿启用数据访问。</span><span class="sxs-lookup"><span data-stu-id="c8493-142">Installing both versions will enable data access for PowerPivot workbooks created in older and newer versions of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for Excel.</span></span> [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] <span data-ttu-id="c8493-143">安装程序不会安装 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的访问接口，因此必须手动安装此版本（如果使用先前版本的工作簿）。</span><span class="sxs-lookup"><span data-stu-id="c8493-143">Setup does not install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider, so you must install it manually if you are using workbooks from a previous version.</span></span>  
  
 <span data-ttu-id="c8493-144">**第二种情形是** ：SharePoint 场中的某个服务器运行的是 Excel Services，而不是 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c8493-144">**The second scenario** is when you have a server in a SharePoint farm that runs Excel Services, but not [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="c8493-145">在这种情况下，必须将运行 Excel Services 的应用程序服务器手动更新为使用访问接口的较新版本。</span><span class="sxs-lookup"><span data-stu-id="c8493-145">In this case, the application server that runs Excel Services must be manually updated to use a newer version of the provider.</span></span> <span data-ttu-id="c8493-146">这对于连接到 PowerPivot for SharePoint 实例是必需的。</span><span class="sxs-lookup"><span data-stu-id="c8493-146">This is necessary for connecting to a PowerPivot for SharePoint instance.</span></span> <span data-ttu-id="c8493-147">如果 Excel Services 使用较旧版本的访问接口，连接请求将失败。</span><span class="sxs-lookup"><span data-stu-id="c8493-147">If Excel Services is using an older version of the provider, the connection request will fail.</span></span> <span data-ttu-id="c8493-148">请注意，必须使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装程序或 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 安装包 (spPowerPivot.msi) 安装访问接口，才能确保安装支持 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] 所需的所有组件。</span><span class="sxs-lookup"><span data-stu-id="c8493-148">Note that the provider must be installed by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] setup or the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package (spPowerPivot.msi) in order to ensure that all components required support [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] are installed.</span></span>  
  
  
##  <a name="install-the-sql-server-2012-ole-db-provider-on-an-excel-services-server-by-using-sql-server-setup"></a><a name="bkmk_sql11"></a><span data-ttu-id="c8493-149">使用 SQL Server 安装程序在 Excel Services 服务器上安装 SQL Server 2012 OLE DB 提供程序</span><span class="sxs-lookup"><span data-stu-id="c8493-149">Install the SQL Server 2012 OLE DB Provider on an Excel Services server by using SQL Server Setup</span></span>  
 <span data-ttu-id="c8493-150">使用以下指令将 OLE DB 访问接口和其他客户端连接组件添加到尚未安装它们的 SharePoint 服务器（例如运行 Excel Services 但在同一硬件上没有安装 PowerPivot for SharePoint 的应用程序服务器）。</span><span class="sxs-lookup"><span data-stu-id="c8493-150">Use the following instructions to add the OLE DB provider and other client connectivity components to SharePoint servers that do not already have them installed, such as application servers that run Excel Services without PowerPivot for SharePoint on the same hardware.</span></span>  
  
 <span data-ttu-id="c8493-151">使用这些指令安装当前的 Analysis Services OLE DB 访问接口并将 **Microsoft.AnalysisServices.Xmla.dll** 添加到全局程序集。</span><span class="sxs-lookup"><span data-stu-id="c8493-151">Use these instructions to install the current Analysis Services OLE DB provider and to add the **Microsoft.AnalysisServices.Xmla.dll** to the global assembly.</span></span>  
  
#### <a name="run-sql-server-setup-and-install-the-client-connectivity-tools"></a><span data-ttu-id="c8493-152">运行 SQL Server 安装程序并安装客户端连接工具</span><span class="sxs-lookup"><span data-stu-id="c8493-152">Run SQL Server Setup and Install the Client Connectivity Tools</span></span>  
  
1.  <span data-ttu-id="c8493-153">在承载 Excel Services 的应用程序服务器上，运行 SQL Server 安装程序。</span><span class="sxs-lookup"><span data-stu-id="c8493-153">On the application server that hosts Excel Services, run SQL Server Setup.</span></span>  
  
2.  <span data-ttu-id="c8493-154">在“安装”页上，选择 **“全新 SQL Server 独立安装或向现有安装添加功能”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-154">On the Installation page, choose **New SQL Server stand-alone installation or add features to an existing installation**.</span></span>  
  
3.  <span data-ttu-id="c8493-155">在“安装类型”页上，选择 **“执行 SQL Server 2012 的全新安装”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-155">On the Installation Type page, choose **Perform a new installation of SQL Server 2012**.</span></span>  
  
4.  <span data-ttu-id="c8493-156">在“设置角色”页上，选择 **“SQL Server 功能安装”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-156">On the Setup Role page, choose **SQL Server Feature Installation**.</span></span>  
  
5.  <span data-ttu-id="c8493-157">在 **“功能选择”** 页中，单击 **“客户端工具连接”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-157">On the **Feature Selection** page, click **Client Tools Connectivity**.</span></span> <span data-ttu-id="c8493-158">此选项将安装 **Microsoft.AnalysisServices.Xmla.dll**</span><span class="sxs-lookup"><span data-stu-id="c8493-158">This option installs **Microsoft.AnalysisServices.Xmla.dll**</span></span>  
  
     <span data-ttu-id="c8493-159">不要选择任何其他功能。</span><span class="sxs-lookup"><span data-stu-id="c8493-159">Do not select any other features.</span></span>  
  
6.  <span data-ttu-id="c8493-160">单击 **“下一步”** 完成向导，然后单击 **“安装”** 运行安装程序。</span><span class="sxs-lookup"><span data-stu-id="c8493-160">Click **Next** to finish the wizard, and then click **Install** to run Setup.</span></span>  
  
7.  <span data-ttu-id="c8493-161">如果有运行 Excel Services 的其他服务器且未在其上安装 PowerPivot for SharePoint，请重复上述步骤。</span><span class="sxs-lookup"><span data-stu-id="c8493-161">Repeat the previous steps if you have other servers running Excel Services, without a PowerPivot for SharePoint installation on the same server.</span></span>  
  
#### <a name="verify-msolap5-is-a-trusted-provider"></a><span data-ttu-id="c8493-162">验证 MSOLAP.5 是受信任的访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-162">Verify MSOLAP.5 is a trusted provider</span></span>  
  
1.  <span data-ttu-id="c8493-163">在“管理中心”中，单击 **“管理服务应用程序”**，然后单击 Excel Services 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="c8493-163">In Central Administration, click **Manage service applications**, and then click the Excel Services service application.</span></span>  
  
2.  <span data-ttu-id="c8493-164">单击 **“受信任的数据访问接口”** 。</span><span class="sxs-lookup"><span data-stu-id="c8493-164">Click **Trusted Data Providers**.</span></span>  
  
3.  <span data-ttu-id="c8493-165">验证 MSOLAP.5 显示在列表中。</span><span class="sxs-lookup"><span data-stu-id="c8493-165">Verify that MSOLAP.5 appears in the list.</span></span> <span data-ttu-id="c8493-166">根据您配置 PowerPivot for SharePoint 的不同方式，MSOLAP.5 可能已受信任。</span><span class="sxs-lookup"><span data-stu-id="c8493-166">Depending on how you configured PowerPivot for SharePoint, MSOLAP.5 might already be trusted.</span></span> <span data-ttu-id="c8493-167">如果您使用了 PowerPivot 配置工具但是之后从任务列表中排除了此操作，MSOLAP.5 将不被 Excel Services 信任，现在需要手动添加。</span><span class="sxs-lookup"><span data-stu-id="c8493-167">If you used the PowerPivot Configuration tool, but then excluded this action from the task list, MSOLAP.5 will not be trusted by Excel Services and now needs to be added manually.</span></span>  
  
4.  <span data-ttu-id="c8493-168">如果未列出 MSOLAP，请单击 **“添加受信任的数据访问接口”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-168">If MSOLAP is not listed, click **Add Trusted Data Provider**.</span></span>  
  
5.  <span data-ttu-id="c8493-169">在“访问接口 ID”中，键入 `MSOLAP.5`。</span><span class="sxs-lookup"><span data-stu-id="c8493-169">In Provider ID, type `MSOLAP.5`.</span></span>  
  
6.  <span data-ttu-id="c8493-170">对于“访问接口类型”，请确保选择 OLE DB。</span><span class="sxs-lookup"><span data-stu-id="c8493-170">For Provider Type, ensure that OLE DB is selected.</span></span>  
  
7.  <span data-ttu-id="c8493-171">在“访问接口说明”中，键入 **Microsoft OLE DB Provider for OLAP Services 11.0**。</span><span class="sxs-lookup"><span data-stu-id="c8493-171">In Provider Description, type **Microsoft OLE DB Provider for OLAP Services 11.0**.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="c8493-172">验证安装</span><span class="sxs-lookup"><span data-stu-id="c8493-172">Verify installation</span></span>  
  
1.  <span data-ttu-id="c8493-173">转到 Program files\Microsoft Analysis Services\AS OLEDB\110。</span><span class="sxs-lookup"><span data-stu-id="c8493-173">Go to Program files\Microsoft Analysis Services\AS OLEDB\110.</span></span>  
  
2.  <span data-ttu-id="c8493-174">右键单击 msolap110.dll，然后选择“ **属性**”。</span><span class="sxs-lookup"><span data-stu-id="c8493-174">Right-click msolap110.dll and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="c8493-175">单击“详细信息”。</span><span class="sxs-lookup"><span data-stu-id="c8493-175">Click **Details**.</span></span>  
  
4.  <span data-ttu-id="c8493-176">查看文件版本信息。</span><span class="sxs-lookup"><span data-stu-id="c8493-176">View the file version information.</span></span> <span data-ttu-id="c8493-177">版本应包含 \<buildnumber> 11.00。</span><span class="sxs-lookup"><span data-stu-id="c8493-177">The version should include 11.00.\<buildnumber>.</span></span>  
  
5.  <span data-ttu-id="c8493-178">在 Windows\assembly 文件夹中，验证 Microsoft.AnalysisServices.Xmla.dll 版本 11.0.0.0 已列出。</span><span class="sxs-lookup"><span data-stu-id="c8493-178">In the Windows\assembly folder, verify that Microsoft.AnalysisServices.Xmla.dll, version 11.0.0.0, is listed.</span></span>  
  
  
##  <a name="use-the-powerpivot-for-sharepoint-installation-package-sppowerpivotmsi-to-install-the-sql-server-2012-ole-db-provider"></a><a name="bkmk_install2012_from_sppowerpivot_msi"></a><span data-ttu-id="c8493-179">使用 PowerPivot for SharePoint 安装包 ( # A0) 安装 SQL Server 2012 OLE DB 提供程序</span><span class="sxs-lookup"><span data-stu-id="c8493-179">Use the PowerPivot for SharePoint Installation package (spPowerPivot.msi) to install the SQL Server 2012 OLE DB Provider</span></span>  
 <span data-ttu-id="c8493-180">使用 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 安装包 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] (spPowerPivot.msi) **在 Excel Services 服务器上安装**OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-180">Install the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] OLE DB Provider on and Excel Services Server by using the [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation package **(spPowerPivot.msi)**.</span></span>  
  
#### <a name="download-the-msolap5-provider-from-the-sssql11sp1-feature-pack"></a><span data-ttu-id="c8493-181">从 [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] 功能包下载 MSOLAP.5 访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-181">Download the MSOLAP.5 provider from the [!INCLUDE[ssSQL11SP1](../../includes/sssql11sp1-md.md)] Feature Pack.</span></span>  
  
1.  <span data-ttu-id="c8493-182">浏览至 [Microsoft® SQL Server® 2012 SP1 功能包](https://www.microsoft.com/download/details.aspx?id=35580)</span><span class="sxs-lookup"><span data-stu-id="c8493-182">Browse to [Microsoft® SQL Server® 2012 SP1 Feature Pack](https://www.microsoft.com/download/details.aspx?id=35580)</span></span>  
  
2.  <span data-ttu-id="c8493-183">单击 **“安装说明”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-183">Click **Install Instructions**.</span></span>  
  
3.  <span data-ttu-id="c8493-184">请参阅 "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1" 一节。</span><span class="sxs-lookup"><span data-stu-id="c8493-184">See the section "Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2012 SP1".</span></span> <span data-ttu-id="c8493-185">下载该文件并开始安装。</span><span class="sxs-lookup"><span data-stu-id="c8493-185">Download the file and start the installation.</span></span>  
  
4.  <span data-ttu-id="c8493-186">在 **“功能选择”** 页，选择 **“用于 SQL Server 的 Analysis Services OLE DB 访问接口”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-186">On the **Feature Selection** page, select **Analysis Services OLE DB Provider for SQL Server**.</span></span> <span data-ttu-id="c8493-187">取消选择其他组件并完成安装。</span><span class="sxs-lookup"><span data-stu-id="c8493-187">Unselect the other components and complete the installation.</span></span> <span data-ttu-id="c8493-188">有关 spPowerPivot.msi 的详细信息，请参阅[安装或卸载 PowerPivot for SharePoint 加载项 &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013)。</span><span class="sxs-lookup"><span data-stu-id="c8493-188">For more information on spPowerPivot.msi, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
5.  <span data-ttu-id="c8493-189">将 MSOLAP.5 注册为 SharePoint Excel Services 中的受信任数据访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-189">Register MSOLAP.5 as a trusted provider with SharePoint Excel Services.</span></span> <span data-ttu-id="c8493-190">有关详细信息，请参阅 [将 MSOLAP.5 添加为 Excel Services 中的受信任数据访问接口](https://technet.microsoft.com/library/hh758436.aspx)。</span><span class="sxs-lookup"><span data-stu-id="c8493-190">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://technet.microsoft.com/library/hh758436.aspx).</span></span>  
  
  
##  <a name="install-the-sql-server-2008-r2-ole-db-provider-to-host-earlier-version-workbooks"></a><a name="bkmk_kj"></a><span data-ttu-id="c8493-191">安装 SQL Server 2008 R2 OLE DB 提供程序以承载早期版本的工作簿</span><span class="sxs-lookup"><span data-stu-id="c8493-191">Install the SQL Server 2008 R2 OLE DB Provider to host earlier version workbooks</span></span>  
 <span data-ttu-id="c8493-192">使用以下说明来安装 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的 MSOLAP.4 访问接口并注册 Microsoft.AnalysisServices.ChannelTransport.dll 文件。</span><span class="sxs-lookup"><span data-stu-id="c8493-192">Use the following instructions to install the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the MSOLAP.4 provider, and register the Microsoft.AnalysisServices.ChannelTransport.dll file.</span></span> <span data-ttu-id="c8493-193">ChannelTransport 是 Analysis Services OLE DB 访问接口的子组件。</span><span class="sxs-lookup"><span data-stu-id="c8493-193">The ChannelTransport is a subcomponent of the Analysis Services OLE DB provider.</span></span> <span data-ttu-id="c8493-194">在使用 ChannelTransport 进行连接时， [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 版本的访问接口读取注册表。</span><span class="sxs-lookup"><span data-stu-id="c8493-194">The [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version of the provider reads the registry when using ChannelTransport to make a connection.</span></span> <span data-ttu-id="c8493-195">注册此文件是安装后步骤，仅对于 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 服务器上 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 访问接口处理的连接是必需的。</span><span class="sxs-lookup"><span data-stu-id="c8493-195">Registering this file is a post-installation step required only for connections handled by the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] provider on a [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] server.</span></span>  
  
#### <a name="step-1-download-and-install-the-client-library"></a><span data-ttu-id="c8493-196">步骤 1：下载并安装客户端库</span><span class="sxs-lookup"><span data-stu-id="c8493-196">Step 1: Download and install the client library</span></span>  
  
1.  <span data-ttu-id="c8493-197">在 [SQL Server 2008 R2 功能包页](https://www.microsoft.com/download/details.aspx?id=44272)上，查找 Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2。</span><span class="sxs-lookup"><span data-stu-id="c8493-197">On the [SQL Server 2008 R2 Feature Pack page](https://www.microsoft.com/download/details.aspx?id=44272), find Microsoft Analysis Services OLE DB Provider for Microsoft SQL Server 2008 R2.</span></span>  
  
2.  <span data-ttu-id="c8493-198">下载 `SQLServer2008_ASOLEDB10.msi` 安装程序的 x64 包。</span><span class="sxs-lookup"><span data-stu-id="c8493-198">Download the x64 Package of the `SQLServer2008_ASOLEDB10.msi` installation program.</span></span> <span data-ttu-id="c8493-199">尽管文件名包含 SQLServer2008，但它是用于 SQL Server 2008 R2 版本的访问接口的正确文件。</span><span class="sxs-lookup"><span data-stu-id="c8493-199">Although the file name contains SQLServer2008, it is the correct file for the SQL Server 2008 R2 version of the provider.</span></span>  
  
3.  <span data-ttu-id="c8493-200">在已安装 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)]的计算机上，运行 .msi 以安装该库。</span><span class="sxs-lookup"><span data-stu-id="c8493-200">On the computer that has an installation of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)], run the .msi to install the library.</span></span>  
  
4.  <span data-ttu-id="c8493-201">如果您在场中有仅运行 Excel Services 的其他服务器（而没有在同一服务器上的 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ），请重复以前的步骤以在 Excel Services 计算机上安装 2008 R2 版本的访问接口。</span><span class="sxs-lookup"><span data-stu-id="c8493-201">If you have other servers in the farm that run just Excel Services, without [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] on the same server, repeat the previous steps to install the 2008 R2 version of the provider on the Excel Services computer.</span></span>  
  
#### <a name="step-2-register-the-microsoftanalysisserviceschanneltransportdll-file"></a><span data-ttu-id="c8493-202">步骤 2：注册 Microsoft.AnalysisServices.ChannelTransport.dll 文件</span><span class="sxs-lookup"><span data-stu-id="c8493-202">Step 2: Register the Microsoft.AnalysisServices.ChannelTransport.dll file</span></span>  
  
1.  <span data-ttu-id="c8493-203">使用 regasm.exe 实用工具注册该文件。</span><span class="sxs-lookup"><span data-stu-id="c8493-203">Use the regasm.exe utility to register the file.</span></span> <span data-ttu-id="c8493-204">如果之前未运行 regasm.exe，请将其父文件夹 C:\Windows\Microsoft.NET\Framework64\v4.0.30319 添加 \\ 到系统路径变量。</span><span class="sxs-lookup"><span data-stu-id="c8493-204">If you have not run regasm.exe before, add its parent folder, C:\Windows\Microsoft.NET\Framework64\v4.0.30319\\, to the system path variable.</span></span>  
  
2.  <span data-ttu-id="c8493-205">使用管理员权限打开命令提示符。</span><span class="sxs-lookup"><span data-stu-id="c8493-205">Open a command prompt with administrator permissions.</span></span>  
  
3.  <span data-ttu-id="c8493-206">转至此文件夹 C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span><span class="sxs-lookup"><span data-stu-id="c8493-206">Go to this folder C:\Windows\assembly\GAC_MSIL\Microsoft.AnalysisServices.ChannelTransport\10.0.0.0__89845dcd8080cc91</span></span>  
  
4.  <span data-ttu-id="c8493-207">输入以下命令：`regasm microsoft.analysisservices.channeltransport.dll`</span><span class="sxs-lookup"><span data-stu-id="c8493-207">Enter the following command: `regasm microsoft.analysisservices.channeltransport.dll`</span></span>  
  
5.  <span data-ttu-id="c8493-208">在手动安装 2008 R2 版本的访问接口的所有计算机上重复以前的步骤。</span><span class="sxs-lookup"><span data-stu-id="c8493-208">Repeat the previous steps for any computer on which you manually installed the 2008 R2 version of the provider.</span></span>  
  
#### <a name="verify-installation"></a><span data-ttu-id="c8493-209">验证安装</span><span class="sxs-lookup"><span data-stu-id="c8493-209">Verify installation</span></span>  
  
1.  <span data-ttu-id="c8493-210">您现在应可以切片或筛选 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 工作簿。</span><span class="sxs-lookup"><span data-stu-id="c8493-210">You should now be able to slice or filter [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] workbooks.</span></span> <span data-ttu-id="c8493-211">如果发生错误，请验证您使用了 64 位版本的 regasm.exe 来注册文件。</span><span class="sxs-lookup"><span data-stu-id="c8493-211">If an error occurs, verify that you used the 64-bit version of regasm.exe to register the file.</span></span>  
  
2.  <span data-ttu-id="c8493-212">此外，您可以检查文件版本。</span><span class="sxs-lookup"><span data-stu-id="c8493-212">Additionally, you can check the file version.</span></span>  
  
     <span data-ttu-id="c8493-213">转到  `C:\Program files\Microsoft Analysis Services\AS OLEDB\10` 。</span><span class="sxs-lookup"><span data-stu-id="c8493-213">Go to `C:\Program files\Microsoft Analysis Services\AS OLEDB\10`.</span></span> <span data-ttu-id="c8493-214">右键单击 **msolap100.dll** 并选择 **“属性”**。</span><span class="sxs-lookup"><span data-stu-id="c8493-214">Right-click **msolap100.dll** and select **Properties**.</span></span> <span data-ttu-id="c8493-215">单击“详细信息”。</span><span class="sxs-lookup"><span data-stu-id="c8493-215">Click **Details**.</span></span>  
  
     <span data-ttu-id="c8493-216">查看文件版本信息。</span><span class="sxs-lookup"><span data-stu-id="c8493-216">View the file version information.</span></span> <span data-ttu-id="c8493-217">版本应包含 \<buildnumber> 10.50。</span><span class="sxs-lookup"><span data-stu-id="c8493-217">The version should include 10.50.\<buildnumber>.</span></span>  
  
  
## <a name="see-also"></a><span data-ttu-id="c8493-218">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c8493-218">See Also</span></span>  
 [<span data-ttu-id="c8493-219">PowerPivot for SharePoint 2010 安装</span><span class="sxs-lookup"><span data-stu-id="c8493-219">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
  
  
