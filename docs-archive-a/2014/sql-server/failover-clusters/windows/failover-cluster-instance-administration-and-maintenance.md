---
title: 故障转移群集实例管理和维护 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- user accounts [SQL Server], failover clustering
- clusters [SQL Server], maintaining
- nodes [Faillover Clustering]
- failover clustering [SQL Server], maintaining
- adding nodes
- virtual servers [SQL Server], removing nodes
- clustered instance of SQL Server
- nodes [Faillover Clustering], removing
- nodes [Faillover Clustering], adding
- service accounts [SQL Server]
- removing nodes
- virtual servers [SQL Server], adding nodes
ms.assetid: 2d5c63e9-8061-45c3-94db-8dd3100b8a91
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 059d052402a1ad486c28a211585022bd67bcf3d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586266"
---
# <a name="failover-cluster-instance-administration-and-maintenance"></a><span data-ttu-id="3fc0e-102">故障转移群集实例管理和维护</span><span class="sxs-lookup"><span data-stu-id="3fc0e-102">Failover Cluster Instance Administration and Maintenance</span></span>
  <span data-ttu-id="3fc0e-103">诸如从现有 AlwaysOn 故障转移群集实例 (FCI) 中添加或删除节点等此类维护任务均使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序来完成。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-103">Maintenance tasks like adding or removing nodes from an existing AlwaysOn Failover Cluster Instance (FCI) are accomplished using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup program.</span></span> <span data-ttu-id="3fc0e-104">其他管理任务（如更改 IP 地址资源、从某些 FCI 情形中恢复）则使用故障转移群集管理器管理单元来完成，该管理单元专用于 Windows Server 故障转移群集 (WSFC) 服务。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-104">Other administration tasks like changing the IP address resource, recovering from certain FCI scenarios are accomplished using the Failover Cluster Manager snap-in, which is the management snap-in for the Windows Server Failover Clustering (WSFC) service.</span></span>  
  
## <a name="maintaining-a-failover-cluster-instance"></a><span data-ttu-id="3fc0e-105">维护故障转移群集实例</span><span class="sxs-lookup"><span data-stu-id="3fc0e-105">Maintaining a Failover Cluster Instance</span></span>  
 <span data-ttu-id="3fc0e-106">安装 FCI 后，您可以使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序对其进行更改或修复。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-106">After you have installed an FCI, you can change or repair it using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup program.</span></span> <span data-ttu-id="3fc0e-107">例如，您可以向 FCI 添加其他节点、将 FCI 作为独立实例运行或从 FCI 配置中删除节点。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-107">For example, you can add additional nodes to an FCI, run an FCI as a stand-alone instance, or remove a node from a FCI configuration.</span></span>  
  
### <a name="adding-a-node-to-an-existing-failover-cluster-instance"></a><span data-ttu-id="3fc0e-108">向现有故障转移群集实例添加节点</span><span class="sxs-lookup"><span data-stu-id="3fc0e-108">Adding a Node to an Existing Failover Cluster Instance</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="3fc0e-109">安装程序提供了用于维护现有 FCI 的选项。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-109">Setup gives you the option of maintaining an existing FCI.</span></span> <span data-ttu-id="3fc0e-110">如果选择此选项，则可通过在要添加到 FCI 的计算机上运行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序，向 FCI 中添加其他节点。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-110">If you choose this option, you can add other nodes to your FCI by running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup on the computer that you want to add to the FCI.</span></span> <span data-ttu-id="3fc0e-111">有关详细信息，请参阅[创建新的 SQL Server 故障转移群集（安装程序）](../install/create-a-new-sql-server-failover-cluster-setup.md)和[在 SQL Server 故障转移群集中添加或删除节点（安装程序）](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-111">For more information, see [Create a New SQL Server Failover Cluster &#40;Setup&#41;](../install/create-a-new-sql-server-failover-cluster-setup.md) and [Add or Remove Nodes in a SQL Server Failover Cluster &#40;Setup&#41;](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md).</span></span>  
  
### <a name="removing-a-node-from-an-existing-failover-cluster-instance"></a><span data-ttu-id="3fc0e-112">从现有故障转移群集实例删除节点</span><span class="sxs-lookup"><span data-stu-id="3fc0e-112">Removing a Node from an Existing Failover Cluster Instance</span></span>  
 <span data-ttu-id="3fc0e-113">通过在要从 FCI 删除的计算机上运行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序，可以从 FCI 中删除节点。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-113">You can remove a node from an FCI by running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup on the computer that you want to remove from the FCI.</span></span> <span data-ttu-id="3fc0e-114">FCI 中的每个节点都可以看作是一个对等方，不依赖于 FCI 中的其他节点，因此，您可以删除其中的任何节点。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-114">Each node in an FCI is considered a peer without dependencies on other nodes on the FCI, and you can remove any node.</span></span> <span data-ttu-id="3fc0e-115">已损坏的节点不一定能被删除，并且删除过程将不会从不可用的节点中卸载 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 二进制文件。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-115">A damaged node does not have to be available to be removed, and the removal process does not uninstall the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] binaries from the unavailable node.</span></span> <span data-ttu-id="3fc0e-116">可以随时将已删除的节点重新添加到 FCI。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-116">A removed node can be added back to a FCI at any time.</span></span> <span data-ttu-id="3fc0e-117">有关详细信息，请参阅[在 SQL Server 故障转移群集中添加或删除节点 &#40;安装程序&#41;](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-117">For more information, see [Add or Remove Nodes in a SQL Server Failover Cluster &#40;Setup&#41;](../install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md).</span></span>  
  
### <a name="changing-service-accounts"></a><span data-ttu-id="3fc0e-118">更改服务帐户</span><span class="sxs-lookup"><span data-stu-id="3fc0e-118">Changing Service Accounts</span></span>  
 <span data-ttu-id="3fc0e-119">在 FCI 节点关闭或脱机时，不得更改任何 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务帐户的密码。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-119">You should not change passwords for any of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service accounts when an FCI node is down or offline.</span></span> <span data-ttu-id="3fc0e-120">如果一定要这么做，则必须在所有节点都重新联机后再使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 配置管理器重置密码。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-120">If you must do this, you must reset the password again by using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager when all nodes are back online.</span></span>  
  
 <span data-ttu-id="3fc0e-121">如果 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的服务帐户不是群集中的管理员，则无法在该群集的任何节点上删除管理共享。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-121">If the service account for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is not an administrator in your cluster, the administrative shares cannot be deleted on any nodes of the cluster.</span></span> <span data-ttu-id="3fc0e-122">管理共享必须在群集中可用， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 才能运行。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-122">The administrative shares must be available in a cluster for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to function.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3fc0e-123">请勿对 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务帐户和 WSFC 服务帐户使用同一帐户。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-123">Do not use the same account for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account and the WSFC service account.</span></span> <span data-ttu-id="3fc0e-124">否则，如果更改了 WSFC 服务帐户的密码， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装将失败。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-124">If the password changes for the WSFC service account, your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installation will fail.</span></span>  
  
 <span data-ttu-id="3fc0e-125">在 [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)]中，服务 SID 可用于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务帐户。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-125">On [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)], service SIDs are used for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service accounts.</span></span> <span data-ttu-id="3fc0e-126">有关详细信息，请参阅 [配置 Windows 服务帐户和权限](../../../database-engine/configure-windows/configure-windows-service-accounts-and-permissions.md)预览版本升级问题的解答。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-126">For more information, see [Configure Windows Service Accounts and Permissions](../../../database-engine/configure-windows/configure-windows-service-accounts-and-permissions.md).</span></span>  
  
## <a name="administering-a-failover-cluster-instance"></a><span data-ttu-id="3fc0e-127">管理故障转移群集实例</span><span class="sxs-lookup"><span data-stu-id="3fc0e-127">Administering a Failover Cluster Instance</span></span>  
  
|<span data-ttu-id="3fc0e-128">任务说明</span><span class="sxs-lookup"><span data-stu-id="3fc0e-128">Task Description</span></span>|<span data-ttu-id="3fc0e-129">主题链接</span><span class="sxs-lookup"><span data-stu-id="3fc0e-129">Topic Link</span></span>|  
|----------------------|----------------|  
|<span data-ttu-id="3fc0e-130">说明如何为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 资源添加依赖项。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-130">Describes how to add dependencies to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource.</span></span>|[<span data-ttu-id="3fc0e-131">向 SQL Server 资源添加依赖项</span><span class="sxs-lookup"><span data-stu-id="3fc0e-131">Add Dependencies to a SQL Server Resource</span></span>](add-dependencies-to-a-sql-server-resource.md)|  
|<span data-ttu-id="3fc0e-132">Kerberos 是一种网络身份验证协议，旨在为客户端/服务器应用程序提供严格的身份验证。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-132">Kerberos is a network authentication protocol designed to provide strong authentication for client/server applications.</span></span> <span data-ttu-id="3fc0e-133">Kerberos 为互操作性奠定了基础，同时有助于增强企业范围的网络身份验证的安全性。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-133">Kerberos provides a foundation for interoperability and helps to enhance the security of enterprise-wide network authentication.</span></span> <span data-ttu-id="3fc0e-134">可以将 Kerberos 身份验证用于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 独立实例或 AlwaysOn FCI。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-134">You can use Kerberos authentication with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stand-alone instances or with AlwaysOn FCIs.</span></span>|<span data-ttu-id="3fc0e-135">[为 Kerberos 连接注册服务主体名称](../../../database-engine/configure-windows/register-a-service-principal-name-for-kerberos-connections.md)。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-135">[Register a Service Principal Name for Kerberos Connections](../../../database-engine/configure-windows/register-a-service-principal-name-for-kerberos-connections.md).</span></span>|  
|<span data-ttu-id="3fc0e-136">提供指向描述如何启用 Kerberos 身份验证的内容的链接</span><span class="sxs-lookup"><span data-stu-id="3fc0e-136">Provides links to content that describes how to enable Kerberos authentication</span></span>||  
|<span data-ttu-id="3fc0e-137">介绍用于从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集故障中恢复的过程。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-137">Describes the procedure used to recover from a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster failure.</span></span>|[<span data-ttu-id="3fc0e-138">从故障转移群集实例故障中恢复</span><span class="sxs-lookup"><span data-stu-id="3fc0e-138">Recover from Failover Cluster Instance Failure</span></span>](recover-from-failover-cluster-instance-failure.md)|  
|<span data-ttu-id="3fc0e-139">介绍用于更改 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集实例的 IP 地址资源的过程。</span><span class="sxs-lookup"><span data-stu-id="3fc0e-139">Describe the procedure used to change the IP address resource for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance.</span></span>|[<span data-ttu-id="3fc0e-140">更改故障转移群集实例的 IP 地址</span><span class="sxs-lookup"><span data-stu-id="3fc0e-140">Change the IP Address of a Failover Cluster Instance</span></span>](change-the-ip-address-of-a-failover-cluster-instance.md)|  
  
## <a name="see-also"></a><span data-ttu-id="3fc0e-141">另请参阅</span><span class="sxs-lookup"><span data-stu-id="3fc0e-141">See Also</span></span>  
 <span data-ttu-id="3fc0e-142">[配置 HealthCheckTimeout 属性设置](configure-healthchecktimeout-property-settings.md) </span><span class="sxs-lookup"><span data-stu-id="3fc0e-142">[Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md) </span></span>  
 <span data-ttu-id="3fc0e-143">[配置 FailureConditionLevel 属性设置](configure-failureconditionlevel-property-settings.md) </span><span class="sxs-lookup"><span data-stu-id="3fc0e-143">[Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md) </span></span>  
 [<span data-ttu-id="3fc0e-144">查看和读取故障转移群集实例诊断日志</span><span class="sxs-lookup"><span data-stu-id="3fc0e-144">View and Read Failover Cluster Instance Diagnostics Log</span></span>](view-and-read-failover-cluster-instance-diagnostics-log.md)  
  
  
