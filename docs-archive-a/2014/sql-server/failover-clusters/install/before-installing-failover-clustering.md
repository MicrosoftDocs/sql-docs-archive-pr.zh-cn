---
title: 安装故障转移群集前的准备工作 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- clusters [SQL Server], preinstallation checklist
- installing failover clusters
- failover clustering [SQL Server], preinstallation checklist
ms.assetid: a655225d-8c54-4b30-95fd-31f588167899
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0ec04b567b7970b25aebeffaefc7bafaf1d56691
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586296"
---
# <a name="before-installing-failover-clustering"></a><span data-ttu-id="0f5a7-102">安装故障转移群集前的准备工作</span><span class="sxs-lookup"><span data-stu-id="0f5a7-102">Before Installing Failover Clustering</span></span>
  <span data-ttu-id="0f5a7-103">安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集之前，必须选择运行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的硬件和操作系统。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-103">Before you install a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster, you must select the hardware and the operating system on which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] will run.</span></span> <span data-ttu-id="0f5a7-104">还必须配置 Windows Server 故障转移群集 (WSFC)，检查网络和安全性，并了解将在故障转移群集上运行的其他软件的注意事项。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-104">You must also configure Windows Server Failover Clustering (WSFC), and review network, security, and considerations for other software that will run on your failover cluster.</span></span>  
  
 <span data-ttu-id="0f5a7-105">如果 Windows 群集具有本地磁盘驱动器，且同一盘符还在一个或多个群集节点上作为共享驱动器使用，则不能在该驱动器上安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-105">If a Windows cluster has a local disk drive and the same drive letter is also used on one or more cluster nodes as a shared drive, you cannot install [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on that drive.</span></span>  
  
 <span data-ttu-id="0f5a7-106">您还可能要查看以下主题以便了解与 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集概念、功能和任务有关的更多信息。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-106">You may also want to review the following topics to learn more about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering concepts, features and tasks.</span></span>  
  
|<span data-ttu-id="0f5a7-107">主题说明</span><span class="sxs-lookup"><span data-stu-id="0f5a7-107">Topic Description</span></span>|<span data-ttu-id="0f5a7-108">主题</span><span class="sxs-lookup"><span data-stu-id="0f5a7-108">Topic</span></span>|  
|-----------------------|-----------|  
|<span data-ttu-id="0f5a7-109">描述 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集概念并提供指向关联内容和任务的链接。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-109">Describes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering concepts, and provides links to associated content and tasks.</span></span>|[<span data-ttu-id="0f5a7-110">AlwaysOn 故障转移群集实例 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-110">AlwaysOn Failover Cluster Instances (SQL Server)</span></span>](../windows/always-on-failover-cluster-instances-sql-server.md)|  
|<span data-ttu-id="0f5a7-111">描述 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移策略概念，并提供指向配置故障转移策略以满足您的组织要求的链接。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-111">Describes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover policy concepts, and provides links to configuring the failover policy to suit your organizational requirements.</span></span>|[<span data-ttu-id="0f5a7-112">Failover Policy for Failover Cluster Instances</span><span class="sxs-lookup"><span data-stu-id="0f5a7-112">Failover Policy for Failover Cluster Instances</span></span>](../windows/failover-policy-for-failover-cluster-instances.md)|  
|<span data-ttu-id="0f5a7-113">描述如何维护您的现有 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-113">Describes how to maintain and your existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster.</span></span>|[<span data-ttu-id="0f5a7-114">故障转移群集实例管理和维护</span><span class="sxs-lookup"><span data-stu-id="0f5a7-114">Failover Cluster Instance Administration and Maintenance</span></span>](../windows/failover-cluster-instance-administration-and-maintenance.md)|  
|<span data-ttu-id="0f5a7-115">介绍如何在 Windows Server 故障转移群集 (WSFC) 上安装 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-115">Explains how to install [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] on a Windows Server Failover Cluster (WSFC).</span></span>|[<span data-ttu-id="0f5a7-116">如何安装群集 SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="0f5a7-116">How to Cluster SQL Server Analysis Services</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=396548)|  
  
  
  
##  <a name="best-practices"></a><a name="BestPractices"></a> <span data-ttu-id="0f5a7-117">最佳实践</span><span class="sxs-lookup"><span data-stu-id="0f5a7-117">Best Practices</span></span>  
  
-   <span data-ttu-id="0f5a7-118">查看 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)][发行说明](https://go.microsoft.com/fwlink/?LinkId=296445)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-118">Review [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)][Release Notes](https://go.microsoft.com/fwlink/?LinkId=296445)</span></span>  
  
-   <span data-ttu-id="0f5a7-119">安装必备软件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-119">Install prerequisite software.</span></span> <span data-ttu-id="0f5a7-120">在运行安装程序以安装或升级到 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]之前，请首先安装下列必备软件以缩短安装时间。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-120">Before running Setup to install or upgrade to [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], install the following prerequisites to reduce installation time.</span></span> <span data-ttu-id="0f5a7-121">可以在每个故障转移群集节点上安装必备软件，然后在运行安装程序之前将这些节点重新启动一次。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-121">You can install prerequisite software on each failover cluster node and then restart nodes once before running Setup.</span></span>  
  
    -   <span data-ttu-id="0f5a7-122">Windows PowerShell 不再由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序安装。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-122">Windows PowerShell is no longer installed by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup.</span></span> <span data-ttu-id="0f5a7-123">Windows PowerShell 2.0 是安装 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)][!INCLUDE[ssDE](../../../includes/ssde-md.md)] 组件和 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 的先决条件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-123">Windows PowerShell 2.0 is a prerequisite for installing [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)][!INCLUDE[ssDE](../../../includes/ssde-md.md)] components and [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="0f5a7-124">如果您的计算机上没有 Windows PowerShell 2.0，您可以按照 [Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214) （Windows 管理框架）页上的说明启用它。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-124">If Windows PowerShell 2.0 is not present on your computer, you can enable it by following the instructions on the [Windows Management Framework](https://go.microsoft.com/fwlink/?LinkId=186214) page.</span></span>  
  
    -   <span data-ttu-id="0f5a7-125">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序不再安装 .NET Framework 3.5 SP1，但是在较旧版本的 Windows 操作系统上安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 时可能需要该软件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-125">.NET Framework 3.5 SP1 is no longer installed by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup, but may be required while installing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on older Windows operating systems.</span></span> <span data-ttu-id="0f5a7-126">有关详细信息，请参阅 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] [发行说明](https://go.microsoft.com/fwlink/?LinkId=296445)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-126">For more information, see [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)][Release Notes](https://go.microsoft.com/fwlink/?LinkId=296445).</span></span>  
  
    -   <span data-ttu-id="0f5a7-127">\*\* [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 更新包：\*\* 若要避免在安装过程中安装 .NET Framework 4 的情况下重新启动计算机， [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 安装程序要求在 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 计算机上安装更新。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-127">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Update package:** To avoid computer restart due to .NET Framework 4 installation during setup, [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] setup requires a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] update to be installed on the computer.</span></span>  <span data-ttu-id="0f5a7-128">如果您正在 Windows 7 SP1 或 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] SP2 上安装 [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] ，则包括此更新。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-128">If you are installing [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] on Windows 7 SP1 or [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] SP2 this update is included.</span></span> <span data-ttu-id="0f5a7-129">如果您在早期的 Windows 操作系统上安装，则从 [Windows Vista 和 Windows Server 2008 上的 Microsoft Update for .NET Framework 4.0](https://go.microsoft.com/fwlink/?LinkId=198093)上下载它。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-129">If you are installing on an older Windows operating system, download it from [Microsoft Update for .NET Framework 4.0 on Windows Vista and Windows Server 2008](https://go.microsoft.com/fwlink/?LinkId=198093).</span></span>  
  
    -   <span data-ttu-id="0f5a7-130">.NET Framework 4：安装程序在群集化的操作系统上安装 .NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-130">.NET Framework 4: Setup installs .NET Framework 4 on a clustered operating system.</span></span> <span data-ttu-id="0f5a7-131">为了缩短安装时间，您可以考虑在您运行安装程序之前安装 .NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-131">To reduce installation time, you may consider installing .NET Framework 4 before you run Setup.</span></span>  
  
    -   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-132">安装程序支持文件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-132">Setup support files.</span></span> <span data-ttu-id="0f5a7-133">您可以通过运行位于您的 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 安装介质上的 SqlSupport.msi 来安装这些文件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-133">You can install these files by running SqlSupport.msi located on your [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] installation media.</span></span>  
  
-   <span data-ttu-id="0f5a7-134">确认 WSFC 群集上未安装防病毒软件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-134">Verify that antivirus software is not installed on your WSFC cluster.</span></span> <span data-ttu-id="0f5a7-135">有关详细信息，请参阅 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 知识库文章 [Antivirus software may cause problems with cluster services（防病毒软件可能会导致群集服务出现问题）](https://go.microsoft.com/fwlink/?LinkId=116986)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-135">For more information, see the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Knowledge Base article, [Antivirus software may cause problems with cluster services](https://go.microsoft.com/fwlink/?LinkId=116986).</span></span>  
  
-   <span data-ttu-id="0f5a7-136">对故障转移群集安装的群集组命名时，群集组名称中不能包含以下任何字符：</span><span class="sxs-lookup"><span data-stu-id="0f5a7-136">When naming a cluster group for your failover cluster installation, you must not use any of the following characters in the cluster group name:</span></span>  
  
    -   <span data-ttu-id="0f5a7-137">小于运算符 (\<)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-137">Less than operator (\<)</span></span>  
  
    -   <span data-ttu-id="0f5a7-138">大于运算符 (>)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-138">Greater than operator (>)</span></span>  
  
    -   <span data-ttu-id="0f5a7-139">双引号 (")</span><span class="sxs-lookup"><span data-stu-id="0f5a7-139">Double quote (")</span></span>  
  
    -   <span data-ttu-id="0f5a7-140">单引号 (')</span><span class="sxs-lookup"><span data-stu-id="0f5a7-140">Single quote (')</span></span>  
  
    -   <span data-ttu-id="0f5a7-141">与符号 (&)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-141">Ampersand (&)</span></span>  
  
     <span data-ttu-id="0f5a7-142">此外还要确认现有的群集组名称不包含不受支持的字符。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-142">Also verify that existing cluster group names do not contain unsupported characters.</span></span>  
  
-   <span data-ttu-id="0f5a7-143">确保所有群集节点配置相同，包括 COM+、磁盘驱动器号和 Administrators 组中的用户。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-143">Ensure that all cluster nodes are configured identically, including COM+, disk drive letters, and users in the administrators group.</span></span>  
  
-   <span data-ttu-id="0f5a7-144">确认已清除所有节点中的系统日志，并再次查看了系统日志。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-144">Verify that you have cleared the system logs in all nodes and viewed the system logs again.</span></span> <span data-ttu-id="0f5a7-145">确保在继续操作之前，日志中没有任何错误消息。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-145">Ensure that the logs are free of any error messages before continuing.</span></span>  
  
-   <span data-ttu-id="0f5a7-146">在安装或更新 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集之前，应禁用在安装过程中可能会使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 组件的所有应用程序和服务，但应使磁盘资源保持联机状态。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-146">Before you install or update a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster, disable all applications and services that might use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] components during installation, but leave the disk resources online.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-147">安装程序自动设置 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 群集组与将处于故障转移群集中的磁盘之间的依赖关系。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-147">Setup automatically sets dependencies between the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cluster group and the disks that will be in the failover cluster.</span></span> <span data-ttu-id="0f5a7-148">因此不要在运行安装程序之前设置磁盘的依赖关系。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-148">Do not set dependencies for disks before Setup.</span></span>  
  
    -   <span data-ttu-id="0f5a7-149">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集安装期间，将为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 网络资源名称创建计算机对象（Active Directory 计算机帐户）。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-149">During [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster installation, computer object (Active Directory computer accounts) for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Network Resource Name is created.</span></span> <span data-ttu-id="0f5a7-150">在 [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] 群集中，群集名称帐户（群集自身的计算机帐户）需要有权创建计算机对象。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-150">In a [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] cluster, the cluster name account (computer account of the cluster itself) needs to have permissions to create computer objects.</span></span> <span data-ttu-id="0f5a7-151">有关详细信息，请参阅 [在 Active Directory 中配置帐户](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-151">For more information, see [Configuring Accounts in Active Directory](https://technet.microsoft.com/library/cc731002\(WS.10\).aspx).</span></span>  
  
    -   <span data-ttu-id="0f5a7-152">如果您要使用 SMB 文件共享作为存储选项，则 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装帐户必须拥有对文件服务器的 SeSecurityPrivilege 权限。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-152">If you are using SMB File share as a storage option, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup account must have SeSecurityPrivilege on the file server.</span></span> <span data-ttu-id="0f5a7-153">为此，请使用文件服务器上的“本地安全策略”控制台将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装帐户添加到 **“管理审核和安全日志”** 权限中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-153">To do this, using the Local Security Policy console on the file server, add the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup account to **Manage auditing and security log** rights.</span></span>  
  
 
  
##  <a name="verify-your-hardware-solution"></a><a name="Hardware"></a><span data-ttu-id="0f5a7-154">验证硬件解决方案</span><span class="sxs-lookup"><span data-stu-id="0f5a7-154">Verify Your Hardware Solution</span></span>  
  
-   <span data-ttu-id="0f5a7-155">如果群集解决方案中包含地理位置分散的群集节点，则还必须验证网络延迟和共享磁盘支持之类的附加项。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-155">If the cluster solution includes geographically dispersed cluster nodes, additional items like network latency and shared disk support must be verified.</span></span>  
  
    -   <span data-ttu-id="0f5a7-156">有关 [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] 和 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)]的详细信息，请参阅 [为故障转移群集验证硬件](https://go.microsoft.com/fwlink/?LinkId=196817) 和 [针对 Windows 故障转移群集的支持策略](https://go.microsoft.com/fwlink/?LinkId=196818)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-156">For more information about [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] and [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)], see [Validating Hardware for a failover cluster](https://go.microsoft.com/fwlink/?LinkId=196817) and [Support Policy for Windows Failover Clusters](https://go.microsoft.com/fwlink/?LinkId=196818).</span></span>  
  
-   <span data-ttu-id="0f5a7-157">确认未对要安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的磁盘进行压缩或加密。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-157">Verify that the disk where [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] will be installed is not compressed or encrypted.</span></span> <span data-ttu-id="0f5a7-158">如果尝试将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装到压缩驱动器或加密驱动器上， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序将失败。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-158">If you attempt to install [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to a compressed drive or an encrypted drive, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup fails.</span></span>  
  
-   <span data-ttu-id="0f5a7-159">[!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] 和 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] Advanced Server 和 Datacenter Server 版还支持 SAN 配置。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-159">SAN configurations are also supported on [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] and [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] Advanced Server and Datacenter Server editions.</span></span> <span data-ttu-id="0f5a7-160">Windows 目录和硬件兼容性列表中的“群集/多群集设备”类别中列出了一组支持 SAN 的存储设备，这些设备已经过测试，可作为 SAN 存储单元并且附加多个 WSFC 群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-160">The Windows Catalog and Hardware Compatibility List category "Cluster/Multi-cluster Device" lists the set of SAN-capable storage devices that have been tested and are supported as SAN storage units with multiple WSFC clusters attached.</span></span> <span data-ttu-id="0f5a7-161">在找到经过验证的组件后请运行群集验证。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-161">Run cluster validation after finding the certified components.</span></span>  
  
-   <span data-ttu-id="0f5a7-162">还支持使用 SMB 文件共享来安装数据文件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-162">SMB File Share is also supported for installing data files.</span></span> <span data-ttu-id="0f5a7-163">有关详细信息，请参阅 [Storage Types for Data Files](../../install/hardware-and-software-requirements-for-installing-sql-server.md#StorageTypes)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-163">For more information, see [Storage Types for Data Files](../../install/hardware-and-software-requirements-for-installing-sql-server.md#StorageTypes).</span></span>  
  
    > [!WARNING]  
    >  <span data-ttu-id="0f5a7-164">如果您要将 Windows 文件服务器用作 SMB 文件共享存储，则 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装帐户必须拥有对文件服务器的 SeSecurityPrivilege 权限。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-164">If you are using Windows File Server as a SMB File Share storage, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup account must have SeSecurityPrivilege on the file server.</span></span> <span data-ttu-id="0f5a7-165">为此，请使用文件服务器上的“本地安全策略”控制台将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装帐户添加到 **“管理审核和安全日志”** 权限中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-165">To do this, using the Local Security Policy console on the file server, add the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup account to **Manage auditing and security log** rights.</span></span>  
    >   
    >  <span data-ttu-id="0f5a7-166">如果要使用 Windows 文件服务器之外的 SMB 文件共享存储，请就文件服务器端的等效设置咨询存储供应商。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-166">If you are using SMB file share storage other than Windows File server, please consult the storage vendor for an equivalent setting on the file server side.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-167">支持装入点。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-167">supports mount points.</span></span>  
  
     <span data-ttu-id="0f5a7-168">通过已装入卷或装入点可以使用单个驱动器号来引用多个磁盘或卷。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-168">A mounted volume, or mount point, allows you to use a single drive letter to refer to many disks or volumes.</span></span> <span data-ttu-id="0f5a7-169">如果您有一个驱动器号 D: 引用常规磁盘或卷，则您可以在附加磁盘或卷不需要拥有各自的驱动器号的情况下，在驱动器号 D: 下连接或“装入”附加磁盘或卷作为目录。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-169">If you have a drive letter D: that refers to a regular disk or volume, you can connect or "mount" additional disks or volumes as directories under drive letter D: without the additional disks or volumes requiring drive letters of their own.</span></span>  
  
     <span data-ttu-id="0f5a7-170">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集的其他装入点注意事项：</span><span class="sxs-lookup"><span data-stu-id="0f5a7-170">Additional mount point considerations for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering:</span></span>  
  
    -   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-171">安装程序要求已装入驱动器的基准驱动器具有关联驱动器号。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-171">Setup requires that the base drive of a mounted drive has an associated drive letter.</span></span> <span data-ttu-id="0f5a7-172">对于故障转移群集安装，此基准驱动器必须是群集驱动器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-172">For failover cluster installations, this base drive must be a clustered drive.</span></span> <span data-ttu-id="0f5a7-173">在此版本中，不支持卷 GUID。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-173">Volume GUIDs are not supported in this release.</span></span>  
  
    -   <span data-ttu-id="0f5a7-174">不能在故障转移群集实例之间共享具有驱动器号的基准驱动器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-174">The base drive, the one with the drive letter, cannot be shared among failover cluster instances.</span></span> <span data-ttu-id="0f5a7-175">这是对故障转移群集的正常限制，而不是对独立的多实例服务器的限制。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-175">This is a normal restriction for failover clusters, but is not a restriction on stand-alone, multi-instance servers.</span></span>  
  
    -   <span data-ttu-id="0f5a7-176">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的群集安装数取决于可用驱动器号的数量。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-176">The clustered installations of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are limited to the number of available drive letters.</span></span> <span data-ttu-id="0f5a7-177">如果只对操作系统使用一个驱动器号，而所有其他驱动器号均可用作正常群集驱动器或群集驱动器宿主装入点，则每个故障转移群集最多只能有 25 个 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-177">Assuming that you use only one drive letter for the operating system, and all other drive letters are available as normal cluster drives or cluster drives hosting mount points, you are limited to a maximum of 25 instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] per failover cluster.</span></span>  
  
        > [!TIP]  
        >  <span data-ttu-id="0f5a7-178">通过使用 SMB 文件共享选项可以超过 25 个实例的限制。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-178">The 25 instance limit can be overcome by using SMB file share option.</span></span> <span data-ttu-id="0f5a7-179">如果您使用 SMB 文件共享作为存储选项，则可以安装最多 50 个 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-179">If you use SMB file share as the storage option, you can install up to 50 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instances.</span></span>  
  
    -   <span data-ttu-id="0f5a7-180">不支持在安装其他驱动器后对驱动器进行格式化。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-180">Formatting a drive after mounting additional drives is not supported.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-181">故障转移群集安装只支持使用本地磁盘安装 tempdb 文件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-181">failover cluster installation supports Local Disk only for installing the tempdb files.</span></span> <span data-ttu-id="0f5a7-182">确保为 tempdb 数据和日志文件指定的路径在所有群集节点上均有效。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-182">Ensure that the path specified for the tempdb data and log files is valid on all the cluster nodes.</span></span> <span data-ttu-id="0f5a7-183">在故障转移期间，如果 tempdb 目录对故障转移目标节点不可用，则 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 资源将无法联机。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-183">During failover, if the tempdb directories are not available on the failover target node, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource will fail to come online.</span></span> <span data-ttu-id="0f5a7-184">有关详细信息，请参阅 [数据文件的存储类型](../../install/hardware-and-software-requirements-for-installing-sql-server.md#StorageTypes) 和 [数据库引擎配置 - 数据目录](../../install/database-engine-configuration-data-directories.md)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-184">For more information, see [Storage Types for Data Files](../../install/hardware-and-software-requirements-for-installing-sql-server.md#StorageTypes) and [Database Engine Configuration - Data Directories](../../install/database-engine-configuration-data-directories.md).</span></span>  
  
-   <span data-ttu-id="0f5a7-185">如果您在 iSCSI 技术组件上部署 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集，建议您多加注意。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-185">If you deploy a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster on iSCSI technology components, we recommend that you use appropriate caution.</span></span> <span data-ttu-id="0f5a7-186">有关详细信息，请参阅 [针对 iSCSI 技术组件的 SQL Server 支持](https://go.microsoft.com/fwlink/?LinkId=116960)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-186">For more information, see [Support for SQL Server on iSCSI technology components](https://go.microsoft.com/fwlink/?LinkId=116960).</span></span>  
  
-   <span data-ttu-id="0f5a7-187">有关详细信息，请参阅 [针对 Microsoft 群集的 SQL Server 支持策略](https://go.microsoft.com/fwlink/?LinkId=116958)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-187">For more information, see [SQL Server support policy for Microsoft Clustering](https://go.microsoft.com/fwlink/?LinkId=116958).</span></span>  
  
-   <span data-ttu-id="0f5a7-188">有关正确的仲裁驱动器配置的详细信息，请参阅 [仲裁驱动器配置信息](https://go.microsoft.com/fwlink/?LinkId=196816)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-188">For more information about proper quorum drive configuration, see [Quorum Drive Configuration Information](https://go.microsoft.com/fwlink/?LinkId=196816).</span></span>  
  
-   <span data-ttu-id="0f5a7-189">如果 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 源安装文件和 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集位于不同的域中，若要安装该群集，需要将安装文件复制到可用于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集的当前域中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-189">To install a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] source installation files and the cluster exist on different domains, copy the installation files to the current domain available to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster.</span></span>  
  
  
  
##  <a name="review-security-considerations"></a><a name="Security"></a><span data-ttu-id="0f5a7-190">查看安全注意事项</span><span class="sxs-lookup"><span data-stu-id="0f5a7-190">Review Security Considerations</span></span>  
  
-   <span data-ttu-id="0f5a7-191">若要使用加密，请在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集中的所有节点上安装带有完全限定的 WSFC 群集 DNS 名称的服务器证书。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-191">To use encryption, install the server certificate with the fully qualified DNS name of the WSFC cluster on all nodes in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster.</span></span> <span data-ttu-id="0f5a7-192">例如，如果您有一个包含两个节点（节点的名称分别为“Test1.DomainName.com”和“Test2.DomainName.com”）的群集和一个名为“Virtsql”的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集实例，则必须获取“Virtsql.DomainName.com”的证书，并在 test1 和 test2 节点上安装该证书。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-192">For example, if you have a two-node cluster, with nodes named "Test1.DomainName.com" and "Test2.DomainName.com" and a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance named "Virtsql", you must get a certificate for "Virtsql.DomainName.com" and install the certificate on the test1 and test2 nodes.</span></span> <span data-ttu-id="0f5a7-193">然后，可以选中 **配置管理器中的** “强制协议加密” [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 复选框，以将故障转移群集配置为使用加密。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-193">Then you can select the **Force protocol encryption** check box on the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager to configure your failover cluster for encryption.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="0f5a7-194"> 在将证书安装到故障转移群集实例中的所有参与节点上之前，请勿选中 **“强制协议加密”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-194">Do not select the **Force protocol encryption** check box until you have certificates installed on all participating nodes in your failover cluster instance.</span></span>  
  
-   <span data-ttu-id="0f5a7-195">如果采用与早期版本并行的配置来安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，则 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务必须只使用全局域组内的帐户。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-195">For [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] installations in side-by-side configurations with previous versions, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] services must use accounts found only in the global domains group.</span></span> <span data-ttu-id="0f5a7-196">此外， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务所使用的帐户不得出现在本地 Administrators 组中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-196">Additionally, accounts used by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] services must not appear in the local Administrators group.</span></span> <span data-ttu-id="0f5a7-197">不遵守此原则会导致意外的安全行为。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-197">Failure to comply with this guideline will result in unexpected security behavior.</span></span>  
  
-   <span data-ttu-id="0f5a7-198">若要创建故障转移群集，您必须是本地管理员，有权作为服务登录并有权在故障转移群集实例的所有节点上作为操作系统的一部分工作。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-198">To create a failover cluster, you must be a local administrator with permissions to log on as a service, and to act as part of the operating system on all nodes of the failover cluster instance.</span></span>  
  
-   <span data-ttu-id="0f5a7-199">在 [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)]上，会自动生成用于 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 服务的服务 SID。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-199">On [!INCLUDE[nextref_longhorn](../../../includes/nextref-longhorn-md.md)], service SIDs are generated automatically for use with [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] services.</span></span> <span data-ttu-id="0f5a7-200">对于从以前版本的 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 升级得到的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]故障转移群集实例，将保留现有的域组和 ACL 配置。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-200">For [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] failover cluster instances upgraded from previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], existing domain groups and ACL configurations will be preserved.</span></span>  
  
-   <span data-ttu-id="0f5a7-201">域组必须与计算机帐户位于同一域中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-201">Domain groups must be within the same domain as the machine accounts.</span></span> <span data-ttu-id="0f5a7-202">例如，如果将安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的计算机在 SQLSVR 域（MYDOMAIN 的子域）中，则必须在 SQLSVR 域中指定一个组。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-202">For example, if the machine where [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] will be installed is in the SQLSVR domain which is a child of MYDOMAIN, you must specify a group in the SQLSVR domain.</span></span> <span data-ttu-id="0f5a7-203">SQLSVR 域可能包含来自 MYDOMAIN 的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-203">The SQLSVR domain may contain user accounts from MYDOMAIN.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-204">故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-204">failover clustering cannot be installed where cluster nodes are domain controllers.</span></span>  
  
-   <span data-ttu-id="0f5a7-205">请查阅 [Security Considerations for a SQL Server Installation](../../install/security-considerations-for-a-sql-server-installation.md)中的内容。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-205">Review content in [Security Considerations for a SQL Server Installation](../../install/security-considerations-for-a-sql-server-installation.md).</span></span>  
  
-   <span data-ttu-id="0f5a7-206">若要对 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]启用 Kerberos 身份验证，请参阅 [知识库中的](https://support.microsoft.com/kb/319723) How to use Kerberos authentication in SQL Server [!INCLUDE[msCoName](../../../includes/msconame-md.md)] （如何在 SQL Server 中使用 Kerberos 身份验证）。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-206">To enable Kerberos authentication with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [How to use Kerberos authentication in SQL Server](https://support.microsoft.com/kb/319723) in the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Knowledge Base.</span></span>  
  
  
  
##  <a name="review-network-port-and-firewall-considerations"></a><a name="Network"></a><span data-ttu-id="0f5a7-207">查看网络、端口和防火墙注意事项</span><span class="sxs-lookup"><span data-stu-id="0f5a7-207">Review Network, Port, and Firewall Considerations</span></span>  
  
-   <span data-ttu-id="0f5a7-208">确认在开始安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前，已对所有专用网卡禁用 NetBIOS。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-208">Verify that you have disabled NetBIOS for all private network cards before beginning [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup.</span></span>  
  
-   <span data-ttu-id="0f5a7-209">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的网络名称和 IP 地址不能用于任何其他目的，如共享文件。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-209">The network name and IP address of your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] should not be used for any other purpose, such as file sharing.</span></span> <span data-ttu-id="0f5a7-210">如果要创建文件共享资源，请为该资源指定不同的唯一网络名称和 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-210">If you want to create a file share resource, use a different, unique network name and IP address for the resource.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="0f5a7-211">我们建议您不要在数据驱动器上使用文件共享，因为它们可能影响 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的行为和性能。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-211">We recommend that you do not use file shares on data drives, because they can affect [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] behavior and performance.</span></span>  
  
-   <span data-ttu-id="0f5a7-212">虽然 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 在群集中支持 TCP/IP 上的命名管道和 TCP/IP 套接字，但我们建议您在群集配置中使用 TCP/IP 套接字。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-212">Even though [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] supports both Named Pipes and TCP/IP Sockets over TCP/IP within a cluster, we recommend that you use TCP/IP Sockets in a clustered configuration.</span></span>  
  
-   <span data-ttu-id="0f5a7-213">请注意，ISA Server 在 Windows 群集上不受支持，因此它在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集上也不受支持。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-213">Note that ISA server is not supported on Windows Clustering and consequently is also not supported on [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clusters.</span></span>  
  
-   <span data-ttu-id="0f5a7-214">必须启动并正在运行远程注册表服务。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-214">The Remote Registry service must be up and running.</span></span>  
  
-   <span data-ttu-id="0f5a7-215">必须启用远程管理。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-215">Remote Administration must be enabled.</span></span>  
  
-   <span data-ttu-id="0f5a7-216">对于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 端口，请使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 配置管理器对您要取消阻止的实例检查 TCP/IP 协议的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 网络配置。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-216">For the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] port, use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager to check the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] network configuration for the TCP/IP protocol for the instance you want to unblock.</span></span> <span data-ttu-id="0f5a7-217">如果要在安装后使用 TCP 连接到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，则必须对 IPALL 启用 TCP 端口。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-217">You must enable the TCP port for IPALL if you want to connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using TCP after installation.</span></span> <span data-ttu-id="0f5a7-218">默认情况下，SQL Browser 侦听 UDP 端口 1434。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-218">By default, SQL Browser listens on UDP port 1434.</span></span>  
  
-   <span data-ttu-id="0f5a7-219">故障转移群集安装程序操作包括一个用于检查网络绑定顺序的规则。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-219">Failover cluster Setup operations include a rule that checks network binding order.</span></span> <span data-ttu-id="0f5a7-220">尽管绑定顺序看起来可能是正确的，但您可能已对系统禁用或“幻像”NIC 配置。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-220">Although binding orders might seem correct, you might have disabled or "ghosted" NIC configurations on the system.</span></span> <span data-ttu-id="0f5a7-221">“幻像”NIC 配置可影响绑定顺序并导致绑定顺序规则发出警告。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-221">"Ghosted" NIC configurations can affect the binding order and cause the binding order rule to issue a warning.</span></span> <span data-ttu-id="0f5a7-222">若要避免此问题，请使用下列步骤来标识并删除禁用的网络适配器：</span><span class="sxs-lookup"><span data-stu-id="0f5a7-222">To avoid this situation, use the following steps to identify and remove disabled network adapters:</span></span>  
  
    1.  <span data-ttu-id="0f5a7-223">在命令提示符下，键入：set devmgr_Show_Nonpersistent_Devices=1。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-223">At a command prompt, type: set devmgr_Show_Nonpersistent_Devices=1.</span></span>  
  
    2.  <span data-ttu-id="0f5a7-224">键入并运行：start Devmgmt.msc。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-224">Type and run: start Devmgmt.msc.</span></span>  
  
    3.  <span data-ttu-id="0f5a7-225">展开网络适配器的列表。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-225">Expand the list of network adapters.</span></span> <span data-ttu-id="0f5a7-226">此列表中应仅包含物理适配器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-226">Only the physical adapters should be in the list.</span></span> <span data-ttu-id="0f5a7-227">如果您具有禁用的网络适配器，安装程序将根据网络绑定顺序规则报告故障。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-227">If you have a disabled network adapter, Setup will report a failure for the network binding order rule.</span></span> <span data-ttu-id="0f5a7-228">“控制面板/网络连接”还将显示适配器已禁用。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-228">Control Panel/Network Connections will also show that adapter was disabled.</span></span> <span data-ttu-id="0f5a7-229">确认“控制面板”中“网络设置”显示的已启用物理适配器的列表与 devmgmt.msc 显示的列表相同。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-229">Confirm that Network Settings in Control Panel shows the same list of enabled physical adapters that devmgmt.msc shows.</span></span>  
  
    4.  <span data-ttu-id="0f5a7-230">删除禁用的网络适配器，然后再运行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-230">Remove disabled network adapters before you run [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup.</span></span>  
  
    5.  <span data-ttu-id="0f5a7-231">安装完成后，请返回到“控制面板”中的“网络连接”，禁用当前未使用的任何网络适配器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-231">After Setup finishes, return to Network Connections in Control Panel and disable any network adapters that are not currently in use.</span></span>  
  
  
  
##  <a name="verify-your-operating-system"></a><a name="OS_Support"></a><span data-ttu-id="0f5a7-232">验证你的操作系统</span><span class="sxs-lookup"><span data-stu-id="0f5a7-232">Verify Your Operating System</span></span>  
 <span data-ttu-id="0f5a7-233">确保您的操作系统已正确安装并且支持故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-233">Make sure that your operating system is installed properly and is designed to support failover clustering.</span></span> <span data-ttu-id="0f5a7-234">下表列出了 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 版本和支持这些版本的操作系统。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-234">The following table is a list of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] editions and the operating systems that support them.</span></span>  
  
|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-235">版本</span><span class="sxs-lookup"><span data-stu-id="0f5a7-235">edition</span></span>|[!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] <span data-ttu-id="0f5a7-236">Enterprise</span><span class="sxs-lookup"><span data-stu-id="0f5a7-236">Enterprise</span></span>|[!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] <span data-ttu-id="0f5a7-237">Datacenter Server</span><span class="sxs-lookup"><span data-stu-id="0f5a7-237">Datacenter Server</span></span>|[!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] <span data-ttu-id="0f5a7-238">Enterprise</span><span class="sxs-lookup"><span data-stu-id="0f5a7-238">Enterprise</span></span>|[!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] <span data-ttu-id="0f5a7-239">Datacenter Server</span><span class="sxs-lookup"><span data-stu-id="0f5a7-239">Datacenter Server</span></span>|  
|---------------------------------------|------------------------------------------------|-------------------------------------------------------|----------------------------------------------|-----------------------------------------------------|  
|[!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]<span data-ttu-id="0f5a7-240">Enterprise (64 位) x64<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="0f5a7-240">Enterprise (64-bit) x64<sup>1</sup></span></span>|<span data-ttu-id="0f5a7-241">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-241">Yes</span></span>|<span data-ttu-id="0f5a7-242">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-242">Yes</span></span>|<span data-ttu-id="0f5a7-243">是<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="0f5a7-243">Yes<sup>2</sup></span></span>|<span data-ttu-id="0f5a7-244">Yes<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="0f5a7-244">Yes<sup>2</sup></span></span>|  
|[!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] <span data-ttu-id="0f5a7-245">Enterprise（32 位）</span><span class="sxs-lookup"><span data-stu-id="0f5a7-245">Enterprise (32-bit)</span></span>|<span data-ttu-id="0f5a7-246">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-246">Yes</span></span>|<span data-ttu-id="0f5a7-247">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-247">Yes</span></span>|||  
|[!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="0f5a7-248">Developer（64 位）</span><span class="sxs-lookup"><span data-stu-id="0f5a7-248">-bit) Developer (64</span></span>|<span data-ttu-id="0f5a7-249">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-249">Yes</span></span>|<span data-ttu-id="0f5a7-250">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-250">Yes</span></span>|<span data-ttu-id="0f5a7-251">是 <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="0f5a7-251">Yes <sup>2</sup></span></span>|<span data-ttu-id="0f5a7-252">是 <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="0f5a7-252">Yes <sup>2</sup></span></span>|  
|[!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="0f5a7-253">Developer（32 位）</span><span class="sxs-lookup"><span data-stu-id="0f5a7-253">Developer (32-bit)</span></span>|<span data-ttu-id="0f5a7-254">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-254">Yes</span></span>|<span data-ttu-id="0f5a7-255">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-255">Yes</span></span>|||  
|[!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="0f5a7-256">Standard（64 位）</span><span class="sxs-lookup"><span data-stu-id="0f5a7-256">Standard (64-bit)</span></span>|<span data-ttu-id="0f5a7-257">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-257">Yes</span></span>|<span data-ttu-id="0f5a7-258">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-258">Yes</span></span>|<span data-ttu-id="0f5a7-259">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-259">Yes</span></span>|<span data-ttu-id="0f5a7-260">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-260">Yes</span></span>|  
|[!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="0f5a7-261">Standard（32 位）</span><span class="sxs-lookup"><span data-stu-id="0f5a7-261">Standard (32-bit)</span></span>|<span data-ttu-id="0f5a7-262">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-262">Yes</span></span>|<span data-ttu-id="0f5a7-263">是</span><span class="sxs-lookup"><span data-stu-id="0f5a7-263">Yes</span></span>|||  
  
 <span data-ttu-id="0f5a7-264"><sup>1</sup> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 在 WOW 模式下不支持群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-264"><sup>1</sup> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] clusters are not supported in WOW mode.</span></span> <span data-ttu-id="0f5a7-265">这包括从最初安装在 WOW 中的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集的早期版本进行升级。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-265">That includes upgrades from previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clusters that were originally installed in WOW.</span></span> <span data-ttu-id="0f5a7-266">对于这种情况，只能选择通过并行安装新版本并迁移进行升级。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-266">For those the only upgrade option is to install the new version side by side and migrate.</span></span>  
  
 <span data-ttu-id="0f5a7-267"><sup>2</sup>支持 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多子网故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-267"><sup>2</sup> Supported for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover clustering.</span></span>  
  
  
  
##  <a name="additional-considerations-for-multi-subnet-configurations"></a><a name="MultiSubnet"></a><span data-ttu-id="0f5a7-268">多子网配置的其他注意事项</span><span class="sxs-lookup"><span data-stu-id="0f5a7-268">Additional Considerations for Multi-Subnet Configurations</span></span>  
 <span data-ttu-id="0f5a7-269">下面的部分描述了在安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多子网故障转移群集时要记住的要求。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-269">The sections below describe the requirements to keep in mind when installing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover cluster.</span></span> <span data-ttu-id="0f5a7-270">多子网配置涉及跨多个子网的群集，因此，涉及使用多个 IP 地址以及对 IP 地址资源依赖关系的更改。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-270">A multi-subnet configuration involves clustering across multiple subnets, therefore involves using multiple IP addresses and changes to IP address resource dependencies.</span></span>  
  
### <a name="ssnoversion-edition-and-operating-system-considerations"></a>[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-271">Edition 和操作系统注意事项</span><span class="sxs-lookup"><span data-stu-id="0f5a7-271">Edition and Operating System Considerations</span></span>  
  
-   <span data-ttu-id="0f5a7-272">有关支持 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多子网故障转移群集的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 版本的信息，请参阅 [SQL Server 2014 各个版本支持的功能](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-272">For information about the editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that support a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover cluster, see [Features Supported by the Editions of SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
-   <span data-ttu-id="0f5a7-273">若要创建 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多子网故障转移群集，您必须首先在多个子网上创建 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] 多站点故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-273">To create a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover cluster, you must first create the [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] multi-site failover cluster on multiple subnets.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-274">故障转移群集依赖于 Windows Server 故障转移群集，以便确保在存在失败时 IP 依赖关系条件依然有效。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-274">failover cluster depends on the Windows Server failover cluster to make sure that the IP dependency conditions are valid if there is a failover.</span></span>  
  
-   [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] <span data-ttu-id="0f5a7-275">要求所有群集服务器都必须处于同一 Active Directory 域中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-275">requires that all the cluster servers must be in the same Active Directory domain.</span></span> <span data-ttu-id="0f5a7-276">因此， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 多子网故障转移群集要求所有群集节点都位于同一 Active Directory 域中，即使它们处于不同的子网中。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-276">Therefore, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] multi-subnet failover cluster requires that all the cluster nodes be in the same Active Directory domain even if they are in different subnets.</span></span>  
  
#### <a name="ip-address-and-ip-address-resource-dependencies"></a><span data-ttu-id="0f5a7-277">IP 地址和 IP 地址资源依赖关系</span><span class="sxs-lookup"><span data-stu-id="0f5a7-277">IP Address and IP Address Resource Dependencies</span></span>  
  
1.  <span data-ttu-id="0f5a7-278">在多子网配置中，IP 地址资源依赖关系设置为 OR。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-278">The IP Address resource dependency is set to OR in a multi-subnet configuration.</span></span> <span data-ttu-id="0f5a7-279">有关详细信息，请参阅[创建新的 SQL Server 故障转移群集 &#40;安装程序&#41;](create-a-new-sql-server-failover-cluster-setup.md)</span><span class="sxs-lookup"><span data-stu-id="0f5a7-279">For more information, see [Create a New SQL Server Failover Cluster &#40;Setup&#41;](create-a-new-sql-server-failover-cluster-setup.md)</span></span>  
  
2.  <span data-ttu-id="0f5a7-280">不支持混合的 AND-OR IP 地址依赖关系。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-280">Mixed AND-OR IP address dependencies are not supported.</span></span> <span data-ttu-id="0f5a7-281">例如， \<IP1> 和 \<IP2> 或 \<IP3> 不受支持。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-281">For example, \<IP1> AND \<IP2> OR \<IP3> is not supported.</span></span>  
  
3.  <span data-ttu-id="0f5a7-282">不支持每个子网多个 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-282">More than one IP address per subnet is not supported.</span></span>  
  
     <span data-ttu-id="0f5a7-283">如果您决定使用为同一子网配置的多个 IP 地址，在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 启动过程中可能会遇到客户端连接失败。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-283">If you decide to use more than one IP address configured for the same subnet, you may experience client connection failures during [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] startup.</span></span>  
  
#### <a name="related-content"></a><span data-ttu-id="0f5a7-284">相关内容</span><span class="sxs-lookup"><span data-stu-id="0f5a7-284">Related Content</span></span>  
 <span data-ttu-id="0f5a7-285">有关 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] 多站点故障转移的详细信息，请参阅 [Windows Server 2008 R2 故障转移群集站点](https://technet.microsoft.com/library/ff182338\(v=WS.10\).aspx) 和 [在多站点故障转移群集中设计群集服务或应用程序](https://go.microsoft.com/fwlink/?LinkId=177873)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-285">For more information about [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)] multi-site failover, see [Windows Server 2008 R2 Failover Clustering Site](https://technet.microsoft.com/library/ff182338\(v=WS.10\).aspx) and [Design for a Clustered Service or Application in a Multi-Site Failover Cluster](https://go.microsoft.com/fwlink/?LinkId=177873).</span></span>  
  
##  <a name="configure-windows-server-failover-cluster"></a><a name="WSFC"></a><span data-ttu-id="0f5a7-286">配置 Windows Server 故障转移群集</span><span class="sxs-lookup"><span data-stu-id="0f5a7-286">Configure Windows Server Failover Cluster</span></span>  
  
-   [!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="0f5a7-287">必须至少在服务器群集的一个节点上配置群集服务 (WSFC)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-287">Cluster Service (WSFC) must be configured on at least one node of your server cluster.</span></span> <span data-ttu-id="0f5a7-288">您还必须将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Enterprise、 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Business Intelligence 或 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Standard 与 WSFC 一起运行。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-288">You must also run [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Enterprise, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Business Intelligence, or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Standard in conjunction with WSFC.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-289">Enterprise 支持最多 16 节点的故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-289">Enterprise support failover clusters with up to 16 nodes.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-290">Business Intelligence 和 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Standard 支持两节点的故障转移群集。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-290">Business Intelligence and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Standard supports two-node failover clusters.</span></span>  
  
-   <span data-ttu-id="0f5a7-291">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 服务的资源 DLL 导出两个函数，WSFC 群集管理器使用它们来检查 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 资源的可用性。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-291">The resource DLL for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service exports two functions used by WSFC Cluster Manager to check for availability of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] resource.</span></span> <span data-ttu-id="0f5a7-292">有关详细信息，请参阅 [故障转移群集实例的故障转移策略](../windows/failover-policy-for-failover-cluster-instances.md)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-292">For more information, see [Failover Policy for Failover Cluster Instances](../windows/failover-policy-for-failover-cluster-instances.md).</span></span>  
  
-   <span data-ttu-id="0f5a7-293">WSFC 必须能够使用 IsAlive 检查来验证故障转移群集实例是否正在运行。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-293">WSFC must be able to verify that the failover clustered instance is running by using the IsAlive check.</span></span> <span data-ttu-id="0f5a7-294">这需要使用可信连接来连接到服务器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-294">This requires connecting to the server by using a trusted connection.</span></span> <span data-ttu-id="0f5a7-295">默认情况下，在群集的节点上未将运行群集服务的帐户配置为管理员，并且 BUILTIN\Administrators 组没有登录到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]的权限。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-295">By default, the account that runs the cluster service is not configured as an administrator on nodes in the cluster, and the BUILTIN\Administrators group does not have permission to log into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="0f5a7-296">只有更改对群集节点的权限时，这些设置才会改变。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-296">These settings change only if you change permissions on the cluster nodes.</span></span>  
  
-   <span data-ttu-id="0f5a7-297">配置域名服务 (DNS) 或 Windows Internet 名称服务 (WINS)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-297">Configure Domain Name Service (DNS) or Windows Internet Name Service (WINS).</span></span> <span data-ttu-id="0f5a7-298">必须在要安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 故障转移群集的环境中运行 DNS 服务器或 WINS 服务器。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-298">A DNS server or WINS server must be running in the environment where your [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster will be installed.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-299">安装程序要求 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] IP 接口虚拟引用注册动态域名服务。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-299">Setup requires dynamic domain name service registration of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] IP interface virtual reference.</span></span> <span data-ttu-id="0f5a7-300">DNS 服务器配置应允许群集节点动态注册映射到网络名称的联机 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-300">DNS server configuration should allow cluster nodes to dynamically register an online IP address map to Network Name.</span></span> <span data-ttu-id="0f5a7-301">如果无法完成动态注册，安装程序将失败，安装将回滚。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-301">If the dynamic registration cannot be completed, Setup fails and the installation is rolled back.</span></span> <span data-ttu-id="0f5a7-302">有关详细信息，请参阅 [这篇知识库文章](https://support.microsoft.com/kb/947048)。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-302">For more information, see [this knowledgebase article](https://support.microsoft.com/kb/947048)</span></span>  
  
  
  
##  <a name="install-msconame-distributed-transaction-coordinator"></a><a name="MSDTC"></a><span data-ttu-id="0f5a7-303">安装 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 分布式事务处理协调器</span><span class="sxs-lookup"><span data-stu-id="0f5a7-303">Install [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator</span></span>  
 <span data-ttu-id="0f5a7-304">在故障转移群集上安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前，请确定是否必须创建 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 分布式事务处理协调器 (MSDTC) 群集资源。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-304">Before installing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on a failover cluster, determine whether the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator (MSDTC) cluster resource must be created.</span></span> <span data-ttu-id="0f5a7-305">如果只安装 [!INCLUDE[ssDE](../../../includes/ssde-md.md)]，则 MSDTC 群集资源不是必需的。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-305">If you are installing only the [!INCLUDE[ssDE](../../../includes/ssde-md.md)], the MSDTC cluster resource is not required.</span></span> <span data-ttu-id="0f5a7-306">如果要安装 [!INCLUDE[ssDE](../../../includes/ssde-md.md)] 和 SSIS、工作站组件或者要使用分布式事务处理，则必须安装 MSDTC。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-306">If you are installing the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] and SSIS, Workstation Components, or if you will use distributed transactions, you must install MSDTC.</span></span> <span data-ttu-id="0f5a7-307">请注意，MSDTC 对于仅 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]实例不是必需的。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-307">Note that MSDTC is not required for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]-only instances.</span></span>  
  
 <span data-ttu-id="0f5a7-308">在 [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] 和 [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)]中，您可以在单个故障转移群集上安装 MSDTC 的多个实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-308">On [!INCLUDE[firstref_longhorn](../../../includes/firstref-longhorn-md.md)] and [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)], you can install multiple instances of MSDTC on a single failover cluster.</span></span> <span data-ttu-id="0f5a7-309">安装的第一个 MSDTC 实例将是 MSDTC 的群集默认实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-309">The first instance of MSDTC that is installed will be the cluster default instance of MSDTC.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0f5a7-310">将通过自动使用安装到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 本地群集资源组的 MSDTC 实例，利用该 MSDTC 实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-310">will take advantage of an instance of MSDTC installed to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] local cluster resource group by automatically using the instance of MSDTC.</span></span> <span data-ttu-id="0f5a7-311">但是，单个应用程序可以映射到群集上的任何 MSDTC 实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-311">However, individual applications can be mapped to any instance of MSDTC on the cluster.</span></span>  
  
 <span data-ttu-id="0f5a7-312">下面的规则适用于由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]选择的 MSDTC 的实例：</span><span class="sxs-lookup"><span data-stu-id="0f5a7-312">The following rules are applied for an instance of MSDTC to be chosen by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="0f5a7-313">使用安装到本地组的 MSDTC，否则</span><span class="sxs-lookup"><span data-stu-id="0f5a7-313">Use MSDTC installed to the local group, else</span></span>  
  
-   <span data-ttu-id="0f5a7-314">使用 MSDTC 的映射的实例，否则</span><span class="sxs-lookup"><span data-stu-id="0f5a7-314">Use the mapped instance of MSDTC, else</span></span>  
  
-   <span data-ttu-id="0f5a7-315">使用群集的 MSDTC 的默认实例，否则</span><span class="sxs-lookup"><span data-stu-id="0f5a7-315">Use the cluster's default instance of MSDTC, else</span></span>  
  
-   <span data-ttu-id="0f5a7-316">使用本地计算机上安装的 MSDTC 实例</span><span class="sxs-lookup"><span data-stu-id="0f5a7-316">Use the local machine's installed instance of MSDTC</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="0f5a7-317">如果安装到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的本地群集组的 MSDTC 实例失败， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 将不自动尝试使用 MSDTC 的默认群集实例或本地计算机实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-317">If the MSDTC instance that is installed to the local cluster group of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fails, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] does not automatically attempt to use the default cluster instance or the local machine instance of MSDTC.</span></span> <span data-ttu-id="0f5a7-318">为了使用 MSDTC 的其他实例，您将需要从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 组中完全删除 MSDTC 的失败的实例。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-318">You would need to completely remove the failed instance of MSDTC from the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] group to use another instance of MSDTC.</span></span> <span data-ttu-id="0f5a7-319">同样，如果您为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 创建一个映射并且该映射的 MSDTC 实例失败，则您的分布式事务也将失败。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-319">Likewise, if you create a mapping for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the mapped instance of MSDTC fails, your distributed transactions will also fail.</span></span> <span data-ttu-id="0f5a7-320">如果您希望 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 使用其他 MSDTC 实例，则必须将 MSDTC 的某个实例添加到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的本地群集组，或删除该映射。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-320">If you want [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to use a different instance of MSDTC, you must either add an instance of MSDTC to the local cluster group of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or delete the mapping.</span></span>  
  
### <a name="configure-msconame-distributed-transaction-coordinator"></a><span data-ttu-id="0f5a7-321">配置 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 分布式事务处理协调器</span><span class="sxs-lookup"><span data-stu-id="0f5a7-321">Configure [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Distributed Transaction Coordinator</span></span>  
 <span data-ttu-id="0f5a7-322">安装操作系统并配置群集后，您还必须使用群集管理器配置 MSDTC 以便在群集中使用。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-322">After you install the operating system and configure your cluster, you must configure MSDTC to work in a cluster by using the Cluster Administrator.</span></span> <span data-ttu-id="0f5a7-323">群集 MSDTC 失败不会导致 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 安装程序停止运行，但如果未能正确配置 MSDTC，则 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 应用程序功能可能会受影响。</span><span class="sxs-lookup"><span data-stu-id="0f5a7-323">Failure to cluster MSDTC will not block [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Setup, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] application functionality may be affected if MSDTC is not properly configured.</span></span>  
  
  
  
## <a name="see-also"></a><span data-ttu-id="0f5a7-324">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0f5a7-324">See Also</span></span>  
 <span data-ttu-id="0f5a7-325">[安装 SQL Server 2014 的硬件和软件要求](../../install/hardware-and-software-requirements-for-installing-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="0f5a7-325">[Hardware and Software Requirements for Installing SQL Server 2014](../../install/hardware-and-software-requirements-for-installing-sql-server.md) </span></span>  
 <span data-ttu-id="0f5a7-326">[系统配置检查器的检查参数](../../../database-engine/install-windows/check-parameters-for-the-system-configuration-checker.md) </span><span class="sxs-lookup"><span data-stu-id="0f5a7-326">[Check Parameters for the System Configuration Checker](../../../database-engine/install-windows/check-parameters-for-the-system-configuration-checker.md) </span></span>  
 [<span data-ttu-id="0f5a7-327">故障转移群集实例管理和维护</span><span class="sxs-lookup"><span data-stu-id="0f5a7-327">Failover Cluster Instance Administration and Maintenance</span></span>](../windows/failover-cluster-instance-administration-and-maintenance.md)  
  
  
