---
title: 跟踪数据更改 (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
f1_keywords:
- CHANGE_TRACKING_CLEANUP_VERSION
- change_tracking_databases
- sys.change_tracking_databases
- WITH CHANGE_TRACKING_CONTEXT
- CHANGE_TRACKING_IS_COLUMN_IN_MASK
- sys.fn_change_tracking_dump_change_table
- fn_change_tracking_dump_change_table
- sys.fn_change_tracking_columns
- CHANGE_TRACKING_CURRENT_VERSION
- sys.change_tracking_tables
- fn_change_tracking_columns
- change_tracking_tables
- CHANGETABLE
helpviewer_keywords:
- change data capture [SQL Server], compared to change tracking
- change data capture vs. change tracking
- change data capture [SQL Server], data type behaviors
- Sync Services for ADO.NET
- change tracking [SQL Server], Sync Services for ADO.NET
- change tracking [SQL Server]
- change data capture [SQL Server], security
- change data capture [SQL Server], other SQL Server features and
ms.assetid: 7a34be46-15b4-4b6b-8497-cfd8f9f14234
author: rothja
ms.author: jroth
ms.openlocfilehash: 8e9fb2a89aff63a69d7ad8df111d36f2b7ccafdd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588381"
---
# <a name="track-data-changes-sql-server"></a><span data-ttu-id="92e40-102">跟踪数据更改 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-102">Track Data Changes (SQL Server)</span></span>
  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="92e40-103">提供两个用于在数据库中跟踪数据更改的功能： [变更数据捕获](#Capture) 和 [更改跟踪](#Tracking)。</span><span class="sxs-lookup"><span data-stu-id="92e40-103">provides two features that track changes to data in a database: [change data capture](#Capture) and [change tracking](#Tracking).</span></span> <span data-ttu-id="92e40-104">这两个功能使应用程序能够确定对数据库中的用户表所做的 DML 更改（插入、更新和删除操作）。</span><span class="sxs-lookup"><span data-stu-id="92e40-104">These features enable applications to determine the DML changes (insert, update, and delete operations) that were made to user tables in a database.</span></span> <span data-ttu-id="92e40-105">可对同一个数据库启用变更数据捕获和更改跟踪；没有特殊的注意事项。</span><span class="sxs-lookup"><span data-stu-id="92e40-105">Change data capture and change tracking can be enabled on the same database; no special considerations are required.</span></span> <span data-ttu-id="92e40-106">有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 支持变更数据捕获和更改跟踪的版本，请参阅[SQL Server 2014 的各个版本支持的功能](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。</span><span class="sxs-lookup"><span data-stu-id="92e40-106">For the editions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that support change data capture and change tracking, see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="benefits-of-using-change-data-capture-or-change-tracking"></a><span data-ttu-id="92e40-107">使用变更数据捕获或更改跟踪的好处</span><span class="sxs-lookup"><span data-stu-id="92e40-107">Benefits of Using Change Data Capture or Change Tracking</span></span>  
 <span data-ttu-id="92e40-108">对于某些注重效能的应用程序来说，查询数据库中已更改的数据的能力是一项很重要的要求。</span><span class="sxs-lookup"><span data-stu-id="92e40-108">The ability to query for data that has changed in a database is an important requirement for some applications to be efficient.</span></span> <span data-ttu-id="92e40-109">通常，为了确定数据更改，应用程序开发人员必须在其应用程序中使用触发器、时间戳列和其他表的组合来实现自定义跟踪方法。</span><span class="sxs-lookup"><span data-stu-id="92e40-109">Typically, to determine data changes, application developers must implement a custom tracking method in their applications by using a combination of triggers, timestamp columns, and additional tables.</span></span> <span data-ttu-id="92e40-110">创建这些应用程序通常涉及多项工作，导致架构更新，并且通常带来较高的性能开销。</span><span class="sxs-lookup"><span data-stu-id="92e40-110">Creating these applications usually involves a lot of work to implement, leads to schema updates, and often carries a high performance overhead.</span></span>  
  
 <span data-ttu-id="92e40-111">在应用程序中使用变更数据捕获或更改跟踪而不开发自定义解决方案来跟踪数据库中的更改具有以下好处：</span><span class="sxs-lookup"><span data-stu-id="92e40-111">Using change data capture or change tracking in applications to track changes in a database, instead of developing a custom solution, has the following benefits:</span></span>  
  
-   <span data-ttu-id="92e40-112">减少了开发时间。</span><span class="sxs-lookup"><span data-stu-id="92e40-112">There is reduced development time.</span></span> <span data-ttu-id="92e40-113">由于 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中提供了功能，因此无需开发自定义解决方案。</span><span class="sxs-lookup"><span data-stu-id="92e40-113">Because functionality is available in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you do not have to develop a custom solution.</span></span>  
  
-   <span data-ttu-id="92e40-114">不需要架构更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-114">Schema changes are not required.</span></span> <span data-ttu-id="92e40-115">您无需添加列、添加触发器或创建要在其中跟踪已删除的行或存储更改跟踪信息的端表（如果无法将列添加到用户表）。</span><span class="sxs-lookup"><span data-stu-id="92e40-115">You do not have to add columns, add triggers, or create side table in which to track deleted rows or to store change tracking information if columns cannot be added to the user tables.</span></span>  
  
-   <span data-ttu-id="92e40-116">具有内置清除机制。</span><span class="sxs-lookup"><span data-stu-id="92e40-116">There is a built-in cleanup mechanism.</span></span> <span data-ttu-id="92e40-117">更改跟踪的清除操作在后台自动执行。</span><span class="sxs-lookup"><span data-stu-id="92e40-117">Cleanup for change tracking is performed automatically in the background.</span></span> <span data-ttu-id="92e40-118">不需要端表中存储的数据的自定义清除。</span><span class="sxs-lookup"><span data-stu-id="92e40-118">Custom cleanup for data that is stored in a side table is not required.</span></span>  
  
-   <span data-ttu-id="92e40-119">提供功能的目的是获取更改信息。</span><span class="sxs-lookup"><span data-stu-id="92e40-119">Functions are provided to obtain change information.</span></span>  
  
-   <span data-ttu-id="92e40-120">降低了 DML 操作的开销。</span><span class="sxs-lookup"><span data-stu-id="92e40-120">There is low overhead to DML operations.</span></span> <span data-ttu-id="92e40-121">同步更改跟踪始终会有一些开销。</span><span class="sxs-lookup"><span data-stu-id="92e40-121">Synchronous change tracking will always have some overhead.</span></span> <span data-ttu-id="92e40-122">但是，使用更改跟踪有助于使开销最小化。</span><span class="sxs-lookup"><span data-stu-id="92e40-122">However, using change tracking can help minimize the overhead.</span></span> <span data-ttu-id="92e40-123">开销通常会低于使用其他解决方案，对于需要使用触发器的解决方案，尤其如此。</span><span class="sxs-lookup"><span data-stu-id="92e40-123">The overhead will frequently be less than that of using alternative solutions, especially solutions that require the use triggers.</span></span>  
  
-   <span data-ttu-id="92e40-124">更改跟踪是基于提交的事务进行的。</span><span class="sxs-lookup"><span data-stu-id="92e40-124">Change tracking is based on committed transactions.</span></span> <span data-ttu-id="92e40-125">更改的顺序基于事务提交时间。</span><span class="sxs-lookup"><span data-stu-id="92e40-125">The order of the changes is based on transaction commit time.</span></span> <span data-ttu-id="92e40-126">在存在长时间运行和重叠事务的情况下，这样可获得可靠的结果。</span><span class="sxs-lookup"><span data-stu-id="92e40-126">This allows for reliable results to be obtained when there are long-running and overlapping transactions.</span></span> <span data-ttu-id="92e40-127">必须专门设计使用 `timestamp` 值的自定义解决方案，以处理这些情况。</span><span class="sxs-lookup"><span data-stu-id="92e40-127">Custom solutions that use `timestamp` values must be specifically designed to handle these scenarios.</span></span>  
  
-   <span data-ttu-id="92e40-128">提供可用于配置和管理的标准工具。</span><span class="sxs-lookup"><span data-stu-id="92e40-128">Standard tools are available that you can use to configure and manage.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="92e40-129">提供标准的 DDL 语句、 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]、目录视图和安全权限。</span><span class="sxs-lookup"><span data-stu-id="92e40-129">provides standard DDL statements, [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], catalog views, and security permissions.</span></span>  
  
## <a name="feature-differences-between-change-data-capture-and-change-tracking"></a><span data-ttu-id="92e40-130">变更数据捕获与更改跟踪之间的功能差异</span><span class="sxs-lookup"><span data-stu-id="92e40-130">Feature Differences Between Change Data Capture and Change Tracking</span></span>  
 <span data-ttu-id="92e40-131">下表列出了变更数据捕获与更改跟踪之间的功能差异。</span><span class="sxs-lookup"><span data-stu-id="92e40-131">The following table lists the feature differences between change data capture and change tracking.</span></span> <span data-ttu-id="92e40-132">变更数据捕获中的跟踪机制涉及从事务日志中异步捕获更改，因此，可以在执行 DML 操作后获得更改信息。</span><span class="sxs-lookup"><span data-stu-id="92e40-132">The tracking mechanism in change data capture involves an asynchronous capture of changes from the transaction log so that changes are available after the DML operation.</span></span> <span data-ttu-id="92e40-133">更改跟踪中的跟踪机制涉及在执行 DML 操作的同时同步跟踪更改，因此，可以立即获得更改信息。</span><span class="sxs-lookup"><span data-stu-id="92e40-133">In change tracking, the tracking mechanism involves synchronous tracking of changes in line with DML operations so that change information is available immediately.</span></span>  
  
|<span data-ttu-id="92e40-134">功能</span><span class="sxs-lookup"><span data-stu-id="92e40-134">Feature</span></span>|<span data-ttu-id="92e40-135">更改数据捕获</span><span class="sxs-lookup"><span data-stu-id="92e40-135">Change data capture</span></span>|<span data-ttu-id="92e40-136">Change tracking</span><span class="sxs-lookup"><span data-stu-id="92e40-136">Change tracking</span></span>|  
|-------------|-------------------------|---------------------|  
|<span data-ttu-id="92e40-137">**跟踪的更改**</span><span class="sxs-lookup"><span data-stu-id="92e40-137">**Tracked changes**</span></span>|||  
|<span data-ttu-id="92e40-138">DML 更改</span><span class="sxs-lookup"><span data-stu-id="92e40-138">DML changes</span></span>|<span data-ttu-id="92e40-139">是</span><span class="sxs-lookup"><span data-stu-id="92e40-139">Yes</span></span>|<span data-ttu-id="92e40-140">是</span><span class="sxs-lookup"><span data-stu-id="92e40-140">Yes</span></span>|  
|<span data-ttu-id="92e40-141">**跟踪的信息**</span><span class="sxs-lookup"><span data-stu-id="92e40-141">**Tracked information**</span></span>|||  
|<span data-ttu-id="92e40-142">历史数据</span><span class="sxs-lookup"><span data-stu-id="92e40-142">Historical data</span></span>|<span data-ttu-id="92e40-143">是</span><span class="sxs-lookup"><span data-stu-id="92e40-143">Yes</span></span>|<span data-ttu-id="92e40-144">否</span><span class="sxs-lookup"><span data-stu-id="92e40-144">No</span></span>|  
|<span data-ttu-id="92e40-145">是否更改了列</span><span class="sxs-lookup"><span data-stu-id="92e40-145">Whether column was changed</span></span>|<span data-ttu-id="92e40-146">是</span><span class="sxs-lookup"><span data-stu-id="92e40-146">Yes</span></span>|<span data-ttu-id="92e40-147">是</span><span class="sxs-lookup"><span data-stu-id="92e40-147">Yes</span></span>|  
|<span data-ttu-id="92e40-148">DML 类型</span><span class="sxs-lookup"><span data-stu-id="92e40-148">DML type</span></span>|<span data-ttu-id="92e40-149">是</span><span class="sxs-lookup"><span data-stu-id="92e40-149">Yes</span></span>|<span data-ttu-id="92e40-150">是</span><span class="sxs-lookup"><span data-stu-id="92e40-150">Yes</span></span>|  
  
##  <a name="change-data-capture"></a><a name="Capture"></a> <span data-ttu-id="92e40-151">变更数据捕获</span><span class="sxs-lookup"><span data-stu-id="92e40-151">Change Data Capture</span></span>  
 <span data-ttu-id="92e40-152">变更数据捕获通过获取进行 DML 更改的方面和更改的实际数据，提供用户表的历史更改信息。</span><span class="sxs-lookup"><span data-stu-id="92e40-152">Change data capture provides historical change information for a user table by capturing both the fact that DML changes were made and the actual data that was changed.</span></span> <span data-ttu-id="92e40-153">更改是使用异步进程捕获的，此进程读取事务日志，并且对系统造成的影响很小。</span><span class="sxs-lookup"><span data-stu-id="92e40-153">Changes are captured by using an asynchronous process that reads the transaction log and has a low impact on the system.</span></span>  
  
 <span data-ttu-id="92e40-154">正如下图所示，对用户表所做的更改是在相应更改表中捕获的。</span><span class="sxs-lookup"><span data-stu-id="92e40-154">As shown in the following illustration, the changes that were made to user tables are captured in corresponding change tables.</span></span> <span data-ttu-id="92e40-155">这些更改表提供了更改随时间变化的历史视图。</span><span class="sxs-lookup"><span data-stu-id="92e40-155">These change tables provide an historical view of the changes over time.</span></span> <span data-ttu-id="92e40-156">借助于 [提供的](/sql/relational-databases/system-functions/change-data-capture-functions-transact-sql)变更数据捕获 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 功能，可以方便且系统地使用更改数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-156">The [change data capture](/sql/relational-databases/system-functions/change-data-capture-functions-transact-sql)functions that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provides enable the change data to be consumed easily and systematically.</span></span>  
  
 <span data-ttu-id="92e40-157">![变更数据捕获的概念图示](../../database-engine/media/cdcart1.gif "变更数据捕获的概念图示")</span><span class="sxs-lookup"><span data-stu-id="92e40-157">![Conceptual illustration of change data capture](../../database-engine/media/cdcart1.gif "Conceptual illustration of change data capture")</span></span>  
  
### <a name="security-model"></a><span data-ttu-id="92e40-158">安全模式</span><span class="sxs-lookup"><span data-stu-id="92e40-158">Security Model</span></span>  
 <span data-ttu-id="92e40-159">本部分说明了变更数据捕获安全模式。</span><span class="sxs-lookup"><span data-stu-id="92e40-159">This section describes the change data capture security model.</span></span>  
  
 <span data-ttu-id="92e40-160">**配置和管理**</span><span class="sxs-lookup"><span data-stu-id="92e40-160">**Configuration and Administration**</span></span>  
 <span data-ttu-id="92e40-161">若要为数据库启用或禁用变更数据捕获，则[sp_cdc_enable_db &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-db-transact-sql)或[sys. &#40;sp_cdc_disable_db](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-db-transact-sql)的调用方必须是固定服务器角色的成员 `sysadmin` 。</span><span class="sxs-lookup"><span data-stu-id="92e40-161">To either enable or disable change data capture for a database, the caller of [sys.sp_cdc_enable_db &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-db-transact-sql) or [sys.sp_cdc_disable_db &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-db-transact-sql) must be a member of the fixed server `sysadmin` role.</span></span> <span data-ttu-id="92e40-162">若要在表级别启用和禁用变更数据捕获，则需要[&#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-table-transact-sql)和[sys sp_cdc_disable_table.](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-table-transact-sql) sp_cdc_enable_table 的调用方 &#40;transact-sql&#41;是 sysadmin 角色的成员或数据库角色的成员 `database db_owner` 。</span><span class="sxs-lookup"><span data-stu-id="92e40-162">Enabling and disabling change data capture at the table level requires the caller of [sys.sp_cdc_enable_table &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-enable-table-transact-sql) and [sys.sp_cdc_disable_table &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-table-transact-sql) to either be a member of the sysadmin role or a member of the database `database db_owner` role.</span></span>  
  
 <span data-ttu-id="92e40-163">仅限服务器 `sysadmin` 角色成员和 `database db_owner` 角色成员能够使用存储过程来支持变更数据捕获作业管理。</span><span class="sxs-lookup"><span data-stu-id="92e40-163">Use of the stored procedures to support the administration of change data capture jobs is restricted to members of the server `sysadmin` role and members of the `database db_owner` role.</span></span>  
  
 <span data-ttu-id="92e40-164">**更改枚举和元数据查询**</span><span class="sxs-lookup"><span data-stu-id="92e40-164">**Change Enumeration and Metadata Queries**</span></span>  
 <span data-ttu-id="92e40-165">若要获取对与捕获实例关联的更改数据的访问，必须为用户授予关联源表中的所有捕获列的选择访问权限。</span><span class="sxs-lookup"><span data-stu-id="92e40-165">To gain access to the change data that is associated with a capture instance, the user must be granted select access to all the captured columns of the associated source table.</span></span> <span data-ttu-id="92e40-166">此外，如果在创建捕获实例时指定了访问控制角色，调用者还必须是指定访问控制角色的成员。</span><span class="sxs-lookup"><span data-stu-id="92e40-166">In addition, if a gating role is specified when the capture instance is created, the caller must also be a member of the specified gating role.</span></span> <span data-ttu-id="92e40-167">所有数据库用户可通过 public 角色访问用于访问元数据的其他常规变更数据捕获功能，但返回的元数据访问通常也是使用基础源表的选择访问权限以及任何定义的访问控制角色成员控制的。</span><span class="sxs-lookup"><span data-stu-id="92e40-167">Other general change data capture functions for accessing metadata will be accessible to all database users through the public role, although access to the returned metadata will also typically be gated by using select access to the underlying source tables, and by membership in any defined gating roles.</span></span>  
  
 <span data-ttu-id="92e40-168">**对启用了变更数据捕获的源表执行的 DDL 操作**</span><span class="sxs-lookup"><span data-stu-id="92e40-168">**DDL Operations to Change Data Capture Enabled Source Tables**</span></span>  
 <span data-ttu-id="92e40-169">为表启用变更数据捕获后，只能由固定服务器角色 `sysadmin` 成员、`database role db_owner` 成员或 `database role db_ddladmin` 成员将 DDL 操作应用于该表。</span><span class="sxs-lookup"><span data-stu-id="92e40-169">When a table is enabled for change data capture, DDL operations can only be applied to the table by a member of the fixed server role `sysadmin`, a member of the `database role db_owner`, or a member of the `database role db_ddladmin`.</span></span> <span data-ttu-id="92e40-170">如果为用户显式授予了对表执行 DDL 操作的权限，这些用户在尝试执行这些操作时将收到错误 22914。</span><span class="sxs-lookup"><span data-stu-id="92e40-170">Users who have explicit grants to perform DDL operations on the table will receive error 22914 if they try these operation.</span></span>  
  
### <a name="data-type-considerations-for-change-data-capture"></a><span data-ttu-id="92e40-171">变更数据捕获的数据类型注意事项</span><span class="sxs-lookup"><span data-stu-id="92e40-171">Data Type Considerations for Change Data Capture</span></span>  
 <span data-ttu-id="92e40-172">变更数据捕获支持所有基列类型。</span><span class="sxs-lookup"><span data-stu-id="92e40-172">All base column types are supported by change data capture.</span></span> <span data-ttu-id="92e40-173">下表列出了几个列类型的行为和限制。</span><span class="sxs-lookup"><span data-stu-id="92e40-173">The following table lists the behavior and limitations for several column types.</span></span>  
  
|<span data-ttu-id="92e40-174">列类型</span><span class="sxs-lookup"><span data-stu-id="92e40-174">Type of Column</span></span>|<span data-ttu-id="92e40-175">在更改表中捕获更改</span><span class="sxs-lookup"><span data-stu-id="92e40-175">Changes Captured in Change Tables</span></span>|<span data-ttu-id="92e40-176">限制</span><span class="sxs-lookup"><span data-stu-id="92e40-176">Limitations</span></span>|  
|--------------------|---------------------------------------|-----------------|  
|<span data-ttu-id="92e40-177">稀疏列</span><span class="sxs-lookup"><span data-stu-id="92e40-177">Sparse Columns</span></span>|<span data-ttu-id="92e40-178">是</span><span class="sxs-lookup"><span data-stu-id="92e40-178">Yes</span></span>|<span data-ttu-id="92e40-179">不支持在使用列集时捕获更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-179">Does not support capturing changes when using a columnset.</span></span>|  
|<span data-ttu-id="92e40-180">计算列</span><span class="sxs-lookup"><span data-stu-id="92e40-180">Computed Columns</span></span>|<span data-ttu-id="92e40-181">否</span><span class="sxs-lookup"><span data-stu-id="92e40-181">No</span></span>|<span data-ttu-id="92e40-182">不跟踪对计算列的更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-182">Changes to computed columns are not tracked.</span></span> <span data-ttu-id="92e40-183">在更改表中该列将显示为相应类型，不过其值为 NULL。</span><span class="sxs-lookup"><span data-stu-id="92e40-183">The column will appear in the change table with the appropriate type, but will have a value of NULL.</span></span>|  
|<span data-ttu-id="92e40-184">XML</span><span class="sxs-lookup"><span data-stu-id="92e40-184">XML</span></span>|<span data-ttu-id="92e40-185">是</span><span class="sxs-lookup"><span data-stu-id="92e40-185">Yes</span></span>|<span data-ttu-id="92e40-186">不跟踪对单个 XML 元素的更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-186">Changes to individual XML elements are not tracked.</span></span>|  
|<span data-ttu-id="92e40-187">时间戳</span><span class="sxs-lookup"><span data-stu-id="92e40-187">Timestamp</span></span>|<span data-ttu-id="92e40-188">是</span><span class="sxs-lookup"><span data-stu-id="92e40-188">Yes</span></span>|<span data-ttu-id="92e40-189">更改表中的数据类型将转换为 binary。</span><span class="sxs-lookup"><span data-stu-id="92e40-189">The data type in the change table is converted to binary.</span></span>|  
|<span data-ttu-id="92e40-190">BLOB 数据类型</span><span class="sxs-lookup"><span data-stu-id="92e40-190">BLOB data types</span></span>|<span data-ttu-id="92e40-191">是</span><span class="sxs-lookup"><span data-stu-id="92e40-191">Yes</span></span>|<span data-ttu-id="92e40-192">仅当 BLOB 列本身更改时才存储该列的上一映像。</span><span class="sxs-lookup"><span data-stu-id="92e40-192">The previous image of the BLOB column is stored only if the column itself is changed.</span></span>|  
  
### <a name="change-data-capture-and-other-sql-server-features"></a><span data-ttu-id="92e40-193">变更数据捕获和其他 SQL Server 功能</span><span class="sxs-lookup"><span data-stu-id="92e40-193">Change Data Capture and Other SQL Server Features</span></span>  
 <span data-ttu-id="92e40-194">本节说明下列功能如何与变更数据捕获交互：</span><span class="sxs-lookup"><span data-stu-id="92e40-194">This section describes how the following features interact with change data capture:</span></span>  
  
-   <span data-ttu-id="92e40-195">数据库镜像</span><span class="sxs-lookup"><span data-stu-id="92e40-195">Database mirroring</span></span>  
  
-   <span data-ttu-id="92e40-196">事务复制</span><span class="sxs-lookup"><span data-stu-id="92e40-196">Transactional replication</span></span>  
  
-   <span data-ttu-id="92e40-197">数据库还原或附加</span><span class="sxs-lookup"><span data-stu-id="92e40-197">Database restore or attach</span></span>  
  
#### <a name="database-mirroring"></a><span data-ttu-id="92e40-198">数据库镜像</span><span class="sxs-lookup"><span data-stu-id="92e40-198">Database Mirroring</span></span>  
 <span data-ttu-id="92e40-199">可以对启用变更数据捕获的数据库进行镜像。</span><span class="sxs-lookup"><span data-stu-id="92e40-199">A database that is enabled for change data capture can be mirrored.</span></span> <span data-ttu-id="92e40-200">为确保捕获和清除操作可在镜像服务器上自动发生，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="92e40-200">To ensure that capture and cleanup happen automatically on the mirror, follow these steps:</span></span>  
  
1.  <span data-ttu-id="92e40-201">确保 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理正在镜像上运行。</span><span class="sxs-lookup"><span data-stu-id="92e40-201">Ensure that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is running on the mirror.</span></span>  
  
2.  <span data-ttu-id="92e40-202">在主体服务器因故障而转由镜像服务器接替其工作后，在镜像服务器上创建捕获作业和清除作业。</span><span class="sxs-lookup"><span data-stu-id="92e40-202">Create the capture job and cleanup job on the mirror after the principal has failed over to the mirror.</span></span> <span data-ttu-id="92e40-203">若要创建作业，请使用 [sys.sp_cdc_add_job (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-add-job-transact-sql) 存储过程。</span><span class="sxs-lookup"><span data-stu-id="92e40-203">To create the jobs, use the stored procedure [sys.sp_cdc_add_job &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-add-job-transact-sql).</span></span>  
  
 <span data-ttu-id="92e40-204">有关数据库镜像的详细信息，请参阅[数据库镜像 (SQL Server) ](../../database-engine/database-mirroring/database-mirroring-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="92e40-204">For more information about database mirroring, see [Database Mirroring &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>  
  
#### <a name="transactional-replication"></a><span data-ttu-id="92e40-205">事务复制</span><span class="sxs-lookup"><span data-stu-id="92e40-205">Transactional Replication</span></span>  
 <span data-ttu-id="92e40-206">变更数据捕获和事务复制可以共存于同一数据库中，但在启用这两项功能后，更改表的填充处理方式将发生变化。</span><span class="sxs-lookup"><span data-stu-id="92e40-206">Change data capture and transactional replication can coexist in the same database, but population of the change tables is handled differently when both features are enabled.</span></span> <span data-ttu-id="92e40-207">变更数据捕获和事务复制始终使用相同的过程 [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql)从事务日志读取更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-207">Change data capture and transactional replication always use the same procedure, [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql), to read changes from the transaction log.</span></span> <span data-ttu-id="92e40-208">当单独启用变更数据捕获时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 代理作业会调用 `sp_replcmds` 。</span><span class="sxs-lookup"><span data-stu-id="92e40-208">When change data capture is enabled on its own, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job calls `sp_replcmds`.</span></span> <span data-ttu-id="92e40-209">在同一数据库上同时启用这两个功能时，日志读取器代理调用 `sp_replcmds` 。</span><span class="sxs-lookup"><span data-stu-id="92e40-209">When both features are enabled on the same database, the Log Reader Agent calls `sp_replcmds`.</span></span> <span data-ttu-id="92e40-210">此代理将填充更改表和分发数据库表。</span><span class="sxs-lookup"><span data-stu-id="92e40-210">This agent populates both the change tables and the distribution database tables.</span></span> <span data-ttu-id="92e40-211">有关详细信息，请参阅 [Replication Log Reader Agent](../replication/agents/replication-log-reader-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="92e40-211">For more information, see [Replication Log Reader Agent](../replication/agents/replication-log-reader-agent.md).</span></span>  
  
 <span data-ttu-id="92e40-212">假设为 [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] 数据库启用了变更数据捕获，并为捕获启用了两个表。</span><span class="sxs-lookup"><span data-stu-id="92e40-212">Consider a scenario in which change data capture is enabled on the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database, and two tables are enabled for capture.</span></span> <span data-ttu-id="92e40-213">为了填充更改表，捕获作业将调用 `sp_replcmds` 。</span><span class="sxs-lookup"><span data-stu-id="92e40-213">To populate the change tables, the capture job calls `sp_replcmds`.</span></span> <span data-ttu-id="92e40-214">此外，还为该数据库启用了事务复制，并会创建发布。</span><span class="sxs-lookup"><span data-stu-id="92e40-214">The database is enabled for transactional replication, and a publication is created.</span></span> <span data-ttu-id="92e40-215">此时，将为该数据库创建日志读取器代理，并删除捕获作业。</span><span class="sxs-lookup"><span data-stu-id="92e40-215">Now, the Log Reader Agent is created for the database and the capture job is deleted.</span></span> <span data-ttu-id="92e40-216">日志读取器代理继续从提交到更改表的最后一个日志序列号开始扫描日志。</span><span class="sxs-lookup"><span data-stu-id="92e40-216">The Log Reader Agent continues to scan the log from the last log sequence number that was committed to the change table.</span></span> <span data-ttu-id="92e40-217">这样将确保更改表中的数据一致性。</span><span class="sxs-lookup"><span data-stu-id="92e40-217">This ensures data consistency in the change tables.</span></span> <span data-ttu-id="92e40-218">如果在此数据库中禁用事务复制，则会删除日志读取器代理，并重新创建捕获作业。</span><span class="sxs-lookup"><span data-stu-id="92e40-218">If transactional replication is disabled in this database, the Log Reader Agent is removed and the capture job is re-created.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="92e40-219">当日志读取器代理同时用于变更数据捕获和事务复制时，复制的更改将首先写入分发数据库。</span><span class="sxs-lookup"><span data-stu-id="92e40-219">When the Log Reader Agent is used for both change data capture and transactional replication, replicated changes are first written to the distribution database.</span></span> <span data-ttu-id="92e40-220">然后，捕获的更改会写入更改表。</span><span class="sxs-lookup"><span data-stu-id="92e40-220">Then, captured changes are written to the change tables.</span></span> <span data-ttu-id="92e40-221">两项操作会一起提交。</span><span class="sxs-lookup"><span data-stu-id="92e40-221">Both operations are committed together.</span></span> <span data-ttu-id="92e40-222">如果在写入分发数据库时有任何滞后时间，则在更改显示在更改表中之前，将有对应的滞后时间。</span><span class="sxs-lookup"><span data-stu-id="92e40-222">If there is any latency in writing to the distribution database, there will be a corresponding latency before changes appear in the change tables.</span></span>  
  
#### <a name="restoring-or-attaching-a-database-enabled-for-change-data-capture"></a><span data-ttu-id="92e40-223">还原或附加启用了变更数据捕获的数据库</span><span class="sxs-lookup"><span data-stu-id="92e40-223">Restoring or Attaching a Database Enabled for Change Data Capture</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="92e40-224">使用以下逻辑确定还原或附加数据库后变更数据捕获是否继续保持启用状态：</span><span class="sxs-lookup"><span data-stu-id="92e40-224">uses the following logic to determine if change data capture remains enabled after a database is restored or attached:</span></span>  
  
-   <span data-ttu-id="92e40-225">如果数据库以同一数据库名称还原到同一服务器，变更数据捕获将保持启用状态。</span><span class="sxs-lookup"><span data-stu-id="92e40-225">If a database is restored to the same server with the same database name, change data capture remains enabled.</span></span>  
  
-   <span data-ttu-id="92e40-226">如果数据库还原到其他服务器，默认情况下将禁用变更数据捕获，并删除所有相关的元数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-226">If a database is restored to another server, by default change data capture is disabled and all related metadata is deleted.</span></span>  
  
     <span data-ttu-id="92e40-227">若要保留变更数据捕获，还原数据库时请使用 `KEEP_CDC` 选项。</span><span class="sxs-lookup"><span data-stu-id="92e40-227">To retain change data capture, use the `KEEP_CDC` option when restoring the database.</span></span> <span data-ttu-id="92e40-228">有关此选项的详细信息，请参阅 [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="92e40-228">For more information about this option, see [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
-   <span data-ttu-id="92e40-229">如果数据库在分离后附加到同一服务器或其他服务器，变更数据捕获将保持启用状态。</span><span class="sxs-lookup"><span data-stu-id="92e40-229">If a database is detached and attached to the same server or another server, change data capture remains enabled.</span></span>  
  
-   <span data-ttu-id="92e40-230">如果使用选项将数据库附加或还原 `KEEP_CDC` 到 enterprise 以外的任何版本，操作将被阻止，因为变更数据捕获需要 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] enterprise。</span><span class="sxs-lookup"><span data-stu-id="92e40-230">If a database is attached or restored with the `KEEP_CDC` option to any edition other than Enterprise, the operation is blocked because change data capture requires [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Enterprise.</span></span> <span data-ttu-id="92e40-231">将显示错误消息 932：</span><span class="sxs-lookup"><span data-stu-id="92e40-231">Error message 932 is displayed:</span></span>  
  
     `SQL Server cannot load database '%.*ls' because change data capture is enabled. The currently installed edition of SQL Server does not support change data capture. Either disable change data capture in the database by using a supported edition of SQL Server, or upgrade the instance to one that supports change data capture.`  
  
 <span data-ttu-id="92e40-232">可以使用 [sys.sp_cdc_disable_db](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-db-transact-sql) 从还原或附加的数据库中删除变更数据捕获。</span><span class="sxs-lookup"><span data-stu-id="92e40-232">You can use [sys.sp_cdc_disable_db](/sql/relational-databases/system-stored-procedures/sys-sp-cdc-disable-db-transact-sql) to remove change data capture from a restored or attached database.</span></span>  
 

  ##  <a name="change-tracking"></a><a name="Tracking"></a> <span data-ttu-id="92e40-233">更改跟踪</span><span class="sxs-lookup"><span data-stu-id="92e40-233">Change Tracking</span></span>  
 <span data-ttu-id="92e40-234">更改跟踪捕获更改了表行这一事实，但不会捕获更改的数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-234">Change tracking captures the fact that rows in a table were changed, but does not capture the data that was changed.</span></span> <span data-ttu-id="92e40-235">这样，应用程序就可以确定使用从用户表中直接获取的最新行数据更改的行。</span><span class="sxs-lookup"><span data-stu-id="92e40-235">This enables applications to determine the rows that have changed with the latest row data being obtained directly from the user tables.</span></span> <span data-ttu-id="92e40-236">因此，与变更数据捕获相比，更改跟踪可以解答的历史问题比较有限。</span><span class="sxs-lookup"><span data-stu-id="92e40-236">Therefore, change tracking is more limited in the historical questions it can answer compared to change data capture.</span></span> <span data-ttu-id="92e40-237">但是，对于不需要历史信息的那些应用程序，更改跟踪产生的存储开销要小得多，因为它不需要捕获更改的数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-237">However, for those applications that do not require the historical information, there is far less storage overhead because of the changed data not being captured.</span></span> <span data-ttu-id="92e40-238">它使用同步跟踪机制来跟踪更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-238">A synchronous tracking mechanism is used to track the changes.</span></span> <span data-ttu-id="92e40-239">此功能旨在最大限度地减少 DML 操作开销。</span><span class="sxs-lookup"><span data-stu-id="92e40-239">This has been designed to have minimal overhead to the DML operations.</span></span>  
  
 <span data-ttu-id="92e40-240">下图显示了从使用更改跟踪中受益的同步方案。</span><span class="sxs-lookup"><span data-stu-id="92e40-240">The following illustration shows a synchronization scenario that would benefit by using change tracking.</span></span> <span data-ttu-id="92e40-241">在此方案中，应用程序需要以下信息：在上次表同步后更改的所有表行以及仅当前行数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-241">In the scenario, an application requires the following information: all the rows in the table that were changed since in the last time that the table was synchronized, and only the current row data.</span></span> <span data-ttu-id="92e40-242">由于使用同步机制来跟踪更改，因此，应用程序可以执行双向同步，并且可靠地检测到可能发生的任何冲突。</span><span class="sxs-lookup"><span data-stu-id="92e40-242">Because a synchronous mechanism is used to track the changes, an application can perform two-way synchronization and reliably detect any conflicts that might have occurred.</span></span>  
  
 <span data-ttu-id="92e40-243">![更改跟踪的概念图示](../../database-engine/media/cdcart2.gif "变更跟踪的概念图示")</span><span class="sxs-lookup"><span data-stu-id="92e40-243">![Conceptual illustration of change tracking](../../database-engine/media/cdcart2.gif "Conceptual illustration of change tracking")</span></span>  
  
### <a name="change-tracking-and-sync-services-for-adonet"></a><span data-ttu-id="92e40-244">ADO.NET 的更改跟踪和同步服务</span><span class="sxs-lookup"><span data-stu-id="92e40-244">Change Tracking and Sync Services for ADO.NET</span></span>  
 [!INCLUDE[sql_sync_long](../../includes/sql-sync-long-md.md)] <span data-ttu-id="92e40-245">支持数据库之间的同步，并且提供了一个直观且灵活的 API，使您能够生成面向脱机和协作应用场景的应用程序。</span><span class="sxs-lookup"><span data-stu-id="92e40-245">enables synchronization between databases, providing an intuitive and flexible API that enables you to build applications that target offline and collaboration scenarios.</span></span> [!INCLUDE[sql_sync_long](../../includes/sql-sync-long-md.md)] <span data-ttu-id="92e40-246">提供了一个 API 用于同步更改，但并不实际跟踪服务器或对等数据库中的更改。</span><span class="sxs-lookup"><span data-stu-id="92e40-246">provides an API to synchronize changes, but it does not actually track changes in the server or peer database.</span></span> <span data-ttu-id="92e40-247">您可以创建自定义的更改跟踪系统，但这通常会大大增加复杂性和性能开销。</span><span class="sxs-lookup"><span data-stu-id="92e40-247">You can create a custom change tracking system, but this typically introduces significant complexity and performance overhead.</span></span> <span data-ttu-id="92e40-248">若要跟踪服务器或对等数据库中的更改，建议您使用 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 中的更改跟踪功能，因为它易于配置并提供高性能的跟踪操作。</span><span class="sxs-lookup"><span data-stu-id="92e40-248">To track changes in a server or peer database, we recommend that you use change tracking in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] because it is easy to configure and provides high performance tracking.</span></span>  
  
 <span data-ttu-id="92e40-249">有关更改跟踪和 [!INCLUDE[sql_sync_long](../../includes/sql-sync-long-md.md)]的详细信息，请使用以下链接：</span><span class="sxs-lookup"><span data-stu-id="92e40-249">For more information about change tracking and [!INCLUDE[sql_sync_long](../../includes/sql-sync-long-md.md)], use the following links:</span></span>  
  
-   [<span data-ttu-id="92e40-250">关于更改跟踪 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-250">About Change Tracking &#40;SQL Server&#41;</span></span>](../track-changes/about-change-tracking-sql-server.md)  
  
     <span data-ttu-id="92e40-251">介绍更改跟踪，提供更改跟踪工作方式的概要说明，并描述更改跟踪如何与其他 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 功能进行交互。</span><span class="sxs-lookup"><span data-stu-id="92e40-251">Describes change tracking, provides a high-level overview of how change tracking works, and describes how change tracking interacts with other [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] features.</span></span>  
  
-   [<span data-ttu-id="92e40-252">Microsoft Sync Framework 开发人员中心</span><span class="sxs-lookup"><span data-stu-id="92e40-252">Microsoft Sync Framework Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=108054)  
  
     <span data-ttu-id="92e40-253">提供 [!INCLUDE[ssSyncFrameLong](../../includes/sssyncframelong-md.md)] 和 [!INCLUDE[sql_sync_short](../../includes/sql-sync-short-md.md)]的完整文档。</span><span class="sxs-lookup"><span data-stu-id="92e40-253">Provides complete documentation for [!INCLUDE[ssSyncFrameLong](../../includes/sssyncframelong-md.md)] and [!INCLUDE[sql_sync_short](../../includes/sql-sync-short-md.md)].</span></span> <span data-ttu-id="92e40-254">在 [!INCLUDE[sql_sync_short](../../includes/sql-sync-short-md.md)]的文档中，“如何使用 SQL Server 更改跟踪”主题包含了详细信息和代码示例。</span><span class="sxs-lookup"><span data-stu-id="92e40-254">In the documentation for [!INCLUDE[sql_sync_short](../../includes/sql-sync-short-md.md)], the topic "How to: Use SQL Server Change Tracking" contains detailed information and code examples.</span></span>  
  
  
## <a name="related-tasks-required"></a><span data-ttu-id="92e40-255">相关任务（必需）</span><span class="sxs-lookup"><span data-stu-id="92e40-255">Related Tasks (required)</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="92e40-256">**任务**</span><span class="sxs-lookup"><span data-stu-id="92e40-256">**Task**</span></span>|<span data-ttu-id="92e40-257">**主题**</span><span class="sxs-lookup"><span data-stu-id="92e40-257">**Topic**</span></span>|  
|<span data-ttu-id="92e40-258">提供变更数据捕获的概述。</span><span class="sxs-lookup"><span data-stu-id="92e40-258">Provides an overview of change data capture.</span></span>|[<span data-ttu-id="92e40-259">关于变更数据捕获 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-259">About Change Data Capture &#40;SQL Server&#41;</span></span>](../track-changes/about-change-data-capture-sql-server.md)|  
|<span data-ttu-id="92e40-260">介绍如何启用和禁用针对数据库或表的变更数据捕获。</span><span class="sxs-lookup"><span data-stu-id="92e40-260">Describes how to enable and disable change data capture on a database or table.</span></span>|[<span data-ttu-id="92e40-261">启用和禁用变更数据捕获 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-261">Enable and Disable Change Data Capture &#40;SQL Server&#41;</span></span>](../track-changes/enable-and-disable-change-data-capture-sql-server.md)|  
|<span data-ttu-id="92e40-262">介绍如何管理和监视变更数据捕获。</span><span class="sxs-lookup"><span data-stu-id="92e40-262">Describes how to administer and monitor change data capture.</span></span>|[<span data-ttu-id="92e40-263">管理和监视变更数据捕获 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-263">Administer and Monitor Change Data Capture &#40;SQL Server&#41;</span></span>](../track-changes/administer-and-monitor-change-data-capture-sql-server.md)|  
|<span data-ttu-id="92e40-264">介绍如何使用可用于变更数据捕获使用者的变更数据。</span><span class="sxs-lookup"><span data-stu-id="92e40-264">Describes how to work with the change data that is available to change data capture consumers.</span></span> <span data-ttu-id="92e40-265">此主题介绍如何验证 LSN 边界、查询函数和查询函数应用场景。</span><span class="sxs-lookup"><span data-stu-id="92e40-265">This topic covers validating LSN boundaries, the query functions, and query function scenarios.</span></span>|[<span data-ttu-id="92e40-266">处理变更数据 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-266">Work with Change Data &#40;SQL Server&#41;</span></span>](../track-changes/work-with-change-data-sql-server.md)|  
|<span data-ttu-id="92e40-267">提供更改跟踪的概述。</span><span class="sxs-lookup"><span data-stu-id="92e40-267">Provides an overview of change tracking.</span></span>|[<span data-ttu-id="92e40-268">关于更改跟踪 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-268">About Change Tracking &#40;SQL Server&#41;</span></span>](../track-changes/about-change-tracking-sql-server.md)|  
|<span data-ttu-id="92e40-269">介绍如何启用和禁用针对数据库或表的更改跟踪。</span><span class="sxs-lookup"><span data-stu-id="92e40-269">Describes how to enable and disable change tracking on a database or table.</span></span>|[<span data-ttu-id="92e40-270">启用和禁用更改跟踪 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-270">Enable and Disable Change Tracking &#40;SQL Server&#41;</span></span>](../track-changes/enable-and-disable-change-tracking-sql-server.md)|  
|<span data-ttu-id="92e40-271">介绍如何管理更改跟踪、配置安全性和确定使用更改跟踪时对存储和性能的影响。</span><span class="sxs-lookup"><span data-stu-id="92e40-271">Describes how to manage change tracking, configure security, and determine the effects on storage and performance when change tracking is used.</span></span>|[<span data-ttu-id="92e40-272">管理更改跟踪 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-272">Manage Change Tracking &#40;SQL Server&#41;</span></span>](../track-changes/manage-change-tracking-sql-server.md)|  
|<span data-ttu-id="92e40-273">介绍使用更改跟踪的应用程序如何获取跟踪的更改、将这些更改应用到其他数据存储区和更新源数据库。</span><span class="sxs-lookup"><span data-stu-id="92e40-273">Describes how applications that use change tracking can obtain tracked changes, apply these changes to another data store, and update the source database.</span></span> <span data-ttu-id="92e40-274">此主题还介绍了在发生故障转移且必须从备份还原数据库时，角色更改跟踪如何进行。</span><span class="sxs-lookup"><span data-stu-id="92e40-274">This topic also describes the role change tracking plays when a failover occurs and a database must be restored from a backup.</span></span>|[<span data-ttu-id="92e40-275">处理更改跟踪 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="92e40-275">Work with Change Tracking &#40;SQL Server&#41;</span></span>](../track-changes/work-with-change-tracking-sql-server.md)|  
  
## <a name="see-also"></a><span data-ttu-id="92e40-276">另请参阅</span><span class="sxs-lookup"><span data-stu-id="92e40-276">See Also</span></span>  
 <span data-ttu-id="92e40-277">[更改数据捕获函数 &#40;Transact-sql&#41;](/sql/relational-databases/system-functions/change-data-capture-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="92e40-277">[Change Data Capture Functions &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/change-data-capture-functions-transact-sql) </span></span>  
 <span data-ttu-id="92e40-278">[更改跟踪函数 &#40;Transact-sql&#41;](/sql/relational-databases/system-functions/change-tracking-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="92e40-278">[Change Tracking Functions &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/change-tracking-functions-transact-sql) </span></span>  
 <span data-ttu-id="92e40-279">[&#40;Transact-sql&#41;的变更数据捕获存储过程](/sql/relational-databases/system-stored-procedures/change-data-capture-stored-procedures-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="92e40-279">[Change Data Capture Stored Procedures &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/change-data-capture-stored-procedures-transact-sql) </span></span>  
 <span data-ttu-id="92e40-280">[&#40;Transact-sql&#41;更改数据捕获表](/sql/relational-databases/system-tables/change-data-capture-tables-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="92e40-280">[Change Data Capture Tables &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/change-data-capture-tables-transact-sql) </span></span>  
 [<span data-ttu-id="92e40-281">与变更数据捕获相关的动态管理视图 (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="92e40-281">Change Data Capture Related Dynamic Management Views &#40;Transact-SQL&#41;</span></span>](../views/views.md)  
  
  
