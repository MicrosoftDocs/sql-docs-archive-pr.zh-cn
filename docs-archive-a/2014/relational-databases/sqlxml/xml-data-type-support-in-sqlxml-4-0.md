---
title: SQLXML 4.0 中的 xml 数据类型支持 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- SQLXML, xml data type support
- xml data type [SQL Server], SQLXML
ms.assetid: 9a6f5ad8-4a8f-4de7-ac17-81d5ccf78459
author: rothja
ms.author: jroth
ms.openlocfilehash: 6a3b022bdbca23c2cfcdc89f01199a2135eb4bff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87590119"
---
# <a name="xml-data-type-support-in-sqlxml-40"></a><span data-ttu-id="8ef24-102">SQLXML 4.0 中的 xml 数据类型支持</span><span class="sxs-lookup"><span data-stu-id="8ef24-102">xml Data Type Support in SQLXML 4.0</span></span>
  <span data-ttu-id="8ef24-103">从开始 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 支持使用数据类型的 XML 类型化数据 `xml` 。</span><span class="sxs-lookup"><span data-stu-id="8ef24-103">Beginning with [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] supports XML typed data using the `xml` data type.</span></span> <span data-ttu-id="8ef24-104">本主题提供的信息介绍 SQLXML 4.0 如何识别 `xml` 数据类型的实例和如何为它们实现支持。</span><span class="sxs-lookup"><span data-stu-id="8ef24-104">This topic provides information about how SQLXML 4.0 recognizes instances of the `xml` data type and implements support for them.</span></span>  
  
## <a name="working-with-xml-data-types"></a><span data-ttu-id="8ef24-105">使用 xml 数据类型</span><span class="sxs-lookup"><span data-stu-id="8ef24-105">Working with xml Data Types</span></span>  
 <span data-ttu-id="8ef24-106">为了解有关如何使用实现 `xml` 数据类型列的 SQL 表的更多信息，提供了以下示例：</span><span class="sxs-lookup"><span data-stu-id="8ef24-106">To understand more about how to work with SQL tables that implement `xml` data type columns, the following examples are provided:</span></span>  
  
|<span data-ttu-id="8ef24-107">任务</span><span class="sxs-lookup"><span data-stu-id="8ef24-107">Task</span></span>|<span data-ttu-id="8ef24-108">示例</span><span class="sxs-lookup"><span data-stu-id="8ef24-108">Example</span></span>|<span data-ttu-id="8ef24-109">主题</span><span class="sxs-lookup"><span data-stu-id="8ef24-109">Topic</span></span>|  
|----------|-------------|-----------|  
|<span data-ttu-id="8ef24-110">如何在 XML 视图中映射和包含 `xml` 列</span><span class="sxs-lookup"><span data-stu-id="8ef24-110">How to map and include an `xml` column in an XML view</span></span>|<span data-ttu-id="8ef24-111">“将 XML 元素映射到 XML 数据类型列”</span><span class="sxs-lookup"><span data-stu-id="8ef24-111">"Mapping an XML element to an XML data type column"</span></span>|[<span data-ttu-id="8ef24-112">XSD 元素和属性到表和列的默认映射 &#40;SQLXML 4.0&#41;</span><span class="sxs-lookup"><span data-stu-id="8ef24-112">Default Mapping of XSD Elements and Attributes to Tables and Columns &#40;SQLXML 4.0&#41;</span></span>](../sqlxml-annotated-xsd-schemas-using/default-mapping-of-xsd-elements-and-attributes-to-tables-and-columns-sqlxml-4-0.md)|  
|<span data-ttu-id="8ef24-113">如何使用 updategram 将数据插入到 `xml` 列中</span><span class="sxs-lookup"><span data-stu-id="8ef24-113">How to insert data into an `xml` column with updategrams</span></span>|<span data-ttu-id="8ef24-114">“将数据插入到 XML 数据类型列”</span><span class="sxs-lookup"><span data-stu-id="8ef24-114">"Inserting data into an XML data type column"</span></span>|[<span data-ttu-id="8ef24-115">使用 XML Updategram 插入数据 &#40;SQLXML 4.0&#41;</span><span class="sxs-lookup"><span data-stu-id="8ef24-115">Inserting Data Using XML Updategrams &#40;SQLXML 4.0&#41;</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/updategrams/inserting-data-using-xml-updategrams-sqlxml-4-0.md)|  
|<span data-ttu-id="8ef24-116">将 XML 数据大容量加载到 `xml` 列中</span><span class="sxs-lookup"><span data-stu-id="8ef24-116">Bulk loading XML data into an `xml` column</span></span>|<span data-ttu-id="8ef24-117">“在 xml 数据类型列中执行大容量加载”</span><span class="sxs-lookup"><span data-stu-id="8ef24-117">"Bulk loading in xml Data Type columns"</span></span>|[<span data-ttu-id="8ef24-118">XML 大容量加载示例 &#40;SQLXML 4.0&#41;</span><span class="sxs-lookup"><span data-stu-id="8ef24-118">XML Bulk Load Examples &#40;SQLXML 4.0&#41;</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/xml-bulk-load-examples-sqlxml-4-0.md)|  
  
## <a name="guidelines-and-limitations"></a><span data-ttu-id="8ef24-119">准则和限制</span><span class="sxs-lookup"><span data-stu-id="8ef24-119">Guidelines and Limitations</span></span>  
  
-   <span data-ttu-id="8ef24-120">**\<xsd:any>** 无法映射到包含数据类型的列 `xml` 。</span><span class="sxs-lookup"><span data-stu-id="8ef24-120">**\<xsd:any>** cannot be mapped to a column including an `xml` data type.</span></span> <span data-ttu-id="8ef24-121">SQLXML 中对于此应用场景的支持是通过 `sql:overflow-field` 批注提供的。</span><span class="sxs-lookup"><span data-stu-id="8ef24-121">Support in SQLXML for this scenario is provided through the `sql:overflow-field` annotation.</span></span> <span data-ttu-id="8ef24-122">另一种解决办法是将 `xml` 数据类型字段映射为类型为 `xsd:anyType` 的元素。</span><span class="sxs-lookup"><span data-stu-id="8ef24-122">Another workaround is to map an `xml` data type field as an element of `xsd:anyType`.</span></span> <span data-ttu-id="8ef24-123">上表中引用的“将 XML 元素映射到 XML 数据类型列”示例介绍了这种解决办法。</span><span class="sxs-lookup"><span data-stu-id="8ef24-123">This workaround is demonstrated in the "Mapping an XML element to an XML data type column" example referenced in the table above.</span></span>  
  
-   <span data-ttu-id="8ef24-124">不支持对于 `xml` 数据类型列的内容执行 XPath 查询。</span><span class="sxs-lookup"><span data-stu-id="8ef24-124">XPath query into the contents of `xml` data type columns is not supported.</span></span>  
  
-   <span data-ttu-id="8ef24-125">在不支持或不允许 `xml` 数据类型列的批注（例如，`sql:relationship` 和 `sql:key-fields`）中使用此数据类型列将导致出现 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 错误，实现 SQLXML 4.0 的中间层组件将不会捕获这些错误。</span><span class="sxs-lookup"><span data-stu-id="8ef24-125">Using an `xml` data type column in annotations where it is not supported (such as `sql:relationship` and `sql:key-fields`) or allowed will result in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] errors that will not be trapped by middle-tier components implementing SQLXML 4.0.</span></span> <span data-ttu-id="8ef24-126">其原因在于 SQLXML 不要求 SQL 类型信息。</span><span class="sxs-lookup"><span data-stu-id="8ef24-126">This occurs because SQLXML does not require SQL type information.</span></span> <span data-ttu-id="8ef24-127">这类似于其他数据类型（如 BLOB 和二进制类型）的 SQLXML 的行为。</span><span class="sxs-lookup"><span data-stu-id="8ef24-127">This is similar to the behavior of SQLXML for other data types, such as BLOB and binary types.</span></span>  
  
-   <span data-ttu-id="8ef24-128">仅对 XSD 架构支持映射 `xml` 列。</span><span class="sxs-lookup"><span data-stu-id="8ef24-128">Mapping `xml` columns is supported only for XSD schemas.</span></span> <span data-ttu-id="8ef24-129">XDR 架构不支持映射 `xml` 列。</span><span class="sxs-lookup"><span data-stu-id="8ef24-129">XDR schemas do not support mapping `xml` columns.</span></span>  
  
-   <span data-ttu-id="8ef24-130">SQLXML 4.0 依赖于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中提供的 XML 分析支持。</span><span class="sxs-lookup"><span data-stu-id="8ef24-130">SQLXML 4.0 relies upon the XML parsing support provided in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8ef24-131">`xml` 列可以映射为类型化的 XML 或非类型化的 XML。</span><span class="sxs-lookup"><span data-stu-id="8ef24-131">An `xml` column can be either mapped as typed XML or untyped XML.</span></span> <span data-ttu-id="8ef24-132">在任一种情况下，SQLXML 4.0 都不验证输入 XML。</span><span class="sxs-lookup"><span data-stu-id="8ef24-132">In either case, SQLXML 4.0 does not validate the input XML.</span></span>  <span data-ttu-id="8ef24-133">如果输入 XML 无效或格式不正确，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 将向 SQLXML 报告此情况，并将服务器返回的任何相关的错误信息传播给用户。</span><span class="sxs-lookup"><span data-stu-id="8ef24-133">If input XML is not valid or well-formed, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] reports it to SQLXML, and propagates any relevant error information returned by the server to the user.</span></span>  
  
-   <span data-ttu-id="8ef24-134">SQLXML 4.0 依赖于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中提供的对于 DTD 的有限支持。</span><span class="sxs-lookup"><span data-stu-id="8ef24-134">SQLXML 4.0 relies upon the limited support for DTDs provided in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="8ef24-135">允许在 `xml` 数据类型的数据中使用内部 DTD，而内部 DTD 可用来提供默认值和将实体引用替换为其扩展的内容。</span><span class="sxs-lookup"><span data-stu-id="8ef24-135">allows for an internal DTD in `xml` data type data, which can be used to supply default values and to replace entity references with their expanded contents.</span></span> <span data-ttu-id="8ef24-136">SQLXML 将 XML 数据“按原样”（包括内部 DTD）传递到服务器。</span><span class="sxs-lookup"><span data-stu-id="8ef24-136">SQLXML passes the XML data "as is" (including the internal DTD) to the server.</span></span> <span data-ttu-id="8ef24-137">可以通过使用第三方工具将 DTD 转换为 XML 架构 (XSD)，然后使用内联 XSD 架构将数据加载到数据库中。</span><span class="sxs-lookup"><span data-stu-id="8ef24-137">You can convert DTDs to XML Schema (XSD) documents using third-party tools, and load the data with inline XSD schemas into the database.</span></span>  
  
-   <span data-ttu-id="8ef24-138">SQLXML 4.0 不保留 XML 声明处理指令 (例如，基于的行为 ) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="8ef24-138">SQLXML 4.0 does not preserve XML declaration processing instructions (for example, ) based on the behavior of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="8ef24-139">而是将 XML 声明视为针对 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] XML 分析器的指令，并且，在将数据转换到 `xml` 数据类型之后，此声明的属性（version、encoding 和 standalone）将丢失。</span><span class="sxs-lookup"><span data-stu-id="8ef24-139">Instead, the XML declaration is treated as a directive to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] XML parser, and its attributes (version, encoding, and standalone) are lost after data is converted to the `xml` data type.</span></span> <span data-ttu-id="8ef24-140">XML 数据在内部存储为 UCS-2。</span><span class="sxs-lookup"><span data-stu-id="8ef24-140">The XML data is stored internally as UCS-2.</span></span> <span data-ttu-id="8ef24-141">将保留 XML 实例中的所有其他处理指令；在 `xml` 列中允许使用这些指令，并且 SQLXML 支持它们。</span><span class="sxs-lookup"><span data-stu-id="8ef24-141">All other processing instructions in the XML instance are preserved; they are allowed in the `xml` column and can be supported by SQLXML.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8ef24-142">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8ef24-142">See Also</span></span>  
 [<span data-ttu-id="8ef24-143">XML 数据 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8ef24-143">XML Data &#40;SQL Server&#41;</span></span>](../xml/xml-data-sql-server.md)  
  
  
