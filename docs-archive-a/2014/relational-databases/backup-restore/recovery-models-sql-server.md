---
title: 恢复模式 (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- database backups [SQL Server], recovery models
- bulk-logged recovery model [SQL Server]
- recovery [SQL Server], recovery model
- restoring transaction logs [SQL Server], recovery models
- backing up databases [SQL Server], recovery models
- recovery models [SQL Server], about
- transaction log backups [SQL Server]
- simple recovery model [SQL Server]
- backups [SQL Server], recovery models
- recovery models [SQL Server]
- recovery models [SQL Server], transaction log management
- database restores [SQL Server], recovery models
- transaction log restores [SQL Server]
- logs [SQL Server], recovery models
- restoring databases [SQL Server], recovery models
- full recovery model [SQL Server]
- backing up transaction logs [SQL Server], recovery models
ms.assetid: 8cfea566-8f89-4581-b30d-c53f1f2c79eb
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 9815d88409b4e76df36adf94af44a11ae11f653b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689447"
---
# <a name="recovery-models-sql-server"></a><span data-ttu-id="b1bc7-102">恢复模式 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b1bc7-102">Recovery Models (SQL Server)</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b1bc7-103">备份和还原操作发生在数据库的恢复模式的上下文中。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-103">backup and restore operations occur within the context of the recovery model of the database.</span></span> <span data-ttu-id="b1bc7-104">恢复模式旨在控制事务日志维护。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-104">Recovery models are designed to control transaction log maintenance.</span></span> <span data-ttu-id="b1bc7-105">“恢复模式”  是一种数据库属性，它控制如何记录事务，事务日志是否需要（以及允许）进行备份，以及可以使用哪些类型的还原操作。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-105">A *recovery model* is a database property that controls how transactions are logged, whether the transaction log requires (and allows) backing up, and what kinds of restore operations are available.</span></span> <span data-ttu-id="b1bc7-106">有三种恢复模式：简单恢复模式、完整恢复模式和大容量日志恢复模式。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-106">Three recovery models exist: simple, full, and bulk-logged.</span></span> <span data-ttu-id="b1bc7-107">通常，数据库使用完整恢复模式或简单恢复模式。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-107">Typically, a database uses the full recovery model or simple recovery model.</span></span> <span data-ttu-id="b1bc7-108">数据库可以随时切换为其他恢复模式。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-108">A database can be switched to another recovery model at any time.</span></span>  
  
 <span data-ttu-id="b1bc7-109">**本主题内容：**</span><span class="sxs-lookup"><span data-stu-id="b1bc7-109">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="b1bc7-110">恢复模式概述</span><span class="sxs-lookup"><span data-stu-id="b1bc7-110">Recovery Model Overview</span></span>](#RMov)  
  
-   [<span data-ttu-id="b1bc7-111">相关任务</span><span class="sxs-lookup"><span data-stu-id="b1bc7-111">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="recovery-model-overview"></a><a name="RMov"></a> <span data-ttu-id="b1bc7-112">恢复模式概述</span><span class="sxs-lookup"><span data-stu-id="b1bc7-112">Recovery Model Overview</span></span>  
 <span data-ttu-id="b1bc7-113">下表概述了这三种恢复模式。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-113">The following table summarizes the three recovery models.</span></span>  
  
|<span data-ttu-id="b1bc7-114">恢复模式</span><span class="sxs-lookup"><span data-stu-id="b1bc7-114">Recovery model</span></span>|<span data-ttu-id="b1bc7-115">说明</span><span class="sxs-lookup"><span data-stu-id="b1bc7-115">Description</span></span>|<span data-ttu-id="b1bc7-116">工作丢失的风险</span><span class="sxs-lookup"><span data-stu-id="b1bc7-116">Work loss exposure</span></span>|<span data-ttu-id="b1bc7-117">能否恢复到时点？</span><span class="sxs-lookup"><span data-stu-id="b1bc7-117">Recover to point in time?</span></span>|  
|--------------------|-----------------|------------------------|-------------------------------|  
|<span data-ttu-id="b1bc7-118">**简单**</span><span class="sxs-lookup"><span data-stu-id="b1bc7-118">**Simple**</span></span>|<span data-ttu-id="b1bc7-119">无日志备份。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-119">No log backups.</span></span><br /><br /> <span data-ttu-id="b1bc7-120">自动回收日志空间以减少空间需求，实际上不再需要管理事务日志空间。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-120">Automatically reclaims log space to keep space requirements small, essentially eliminating the need to manage the transaction log space.</span></span> <span data-ttu-id="b1bc7-121">有关简单恢复模式下数据库备份的详细信息，请参阅[完整数据库备份 (SQL Server)](full-database-backups-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-121">For information about database backups under the simple recovery model, see [Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md).</span></span><br /><br /> <span data-ttu-id="b1bc7-122">简单恢复模式不支持要求事务日志备份的操作。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-122">Operations that require transaction log backups are not supported by the simple recovery model.</span></span> <span data-ttu-id="b1bc7-123">在简单恢复模式中不能使用以下功能：</span><span class="sxs-lookup"><span data-stu-id="b1bc7-123">The following features cannot be used in simple recovery mode:</span></span><br /><br /> <span data-ttu-id="b1bc7-124">日志传送</span><span class="sxs-lookup"><span data-stu-id="b1bc7-124">Log shipping</span></span><br /><br /> <span data-ttu-id="b1bc7-125">AlwaysOn 或数据库镜像</span><span class="sxs-lookup"><span data-stu-id="b1bc7-125">AlwaysOn or Database mirroring</span></span><br /><br /> <span data-ttu-id="b1bc7-126">没有数据丢失的介质恢复</span><span class="sxs-lookup"><span data-stu-id="b1bc7-126">Media recovery without data loss</span></span><br /><br /> <span data-ttu-id="b1bc7-127">时点还原</span><span class="sxs-lookup"><span data-stu-id="b1bc7-127">Point-in-time restores</span></span>|<span data-ttu-id="b1bc7-128">最新备份之后的更改不受保护。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-128">Changes since the most recent backup are unprotected.</span></span> <span data-ttu-id="b1bc7-129">在发生灾难时，这些更改必须重做。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-129">In the event of a disaster, those changes must be redone.</span></span>|<span data-ttu-id="b1bc7-130">只能恢复到备份的结尾。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-130">Can recover only to the end of a backup.</span></span> <span data-ttu-id="b1bc7-131">有关详细信息，请参阅[完整数据库还原（简单恢复模式）](complete-database-restores-simple-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-131">For more information, see [Complete Database Restores &#40;Simple Recovery Model&#41;](complete-database-restores-simple-recovery-model.md).</span></span>|  
|<span data-ttu-id="b1bc7-132">**完整**</span><span class="sxs-lookup"><span data-stu-id="b1bc7-132">**Full**</span></span>|<span data-ttu-id="b1bc7-133">需要日志备份。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-133">Requires log backups.</span></span><br /><br /> <span data-ttu-id="b1bc7-134">数据文件丢失或损坏不会导致丢失工作。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-134">No work is lost due to a lost or damaged data file.</span></span><br /><br /> <span data-ttu-id="b1bc7-135">可以恢复到任意时点（例如应用程序或用户错误之前）。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-135">Can recover to an arbitrary point in time (for example, prior to application or user error).</span></span> <span data-ttu-id="b1bc7-136">有关完整恢复模式下的数据库备份的信息，请参阅 [完整数据库备份 (SQL Server)](full-database-backups-sql-server.md) 和[完整数据库还原（完整恢复模式）](complete-database-restores-full-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-136">For information about database backups under the full recovery model, see [Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md) and [Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md).</span></span>|<span data-ttu-id="b1bc7-137">正常情况下没有。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-137">Normally none.</span></span><br /><br /> <span data-ttu-id="b1bc7-138">如果日志尾部损坏，则必须重做自最新日志备份之后所做的更改。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-138">If the tail of the log is damaged, changes since the most recent log backup must be redone.</span></span>|<span data-ttu-id="b1bc7-139">如果备份在接近特定的时点完成，则可以恢复到该时点。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-139">Can recover to a specific point in time, assuming that your backups are complete up to that point in time.</span></span> <span data-ttu-id="b1bc7-140">有关使用日志备份还原到故障点的信息，请参阅[将 SQL Server 数据库还原到某个时间点（完整恢复模式）](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-140">For information about using log backups to restore to the point of failure, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span></span><br /><br /> <span data-ttu-id="b1bc7-141">注意：如果有两个或更多必须在逻辑上保持一致的完整恢复模式数据库，则最好执行特殊步骤，以确保这些数据库的可恢复性。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-141">Note: If you have two or more full-recovery-model databases that must be logically consistent, you may have to implement special procedures to make sure the recoverability of these databases.</span></span> <span data-ttu-id="b1bc7-142">有关详细信息，请参阅 [包含标记的事务的相关数据库的恢复](recovery-of-related-databases-that-contain-marked-transaction.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-142">For more information, see [Recovery of Related  Databases That Contain Marked Transaction](recovery-of-related-databases-that-contain-marked-transaction.md).</span></span>|  
|<span data-ttu-id="b1bc7-143">**大容量日志**</span><span class="sxs-lookup"><span data-stu-id="b1bc7-143">**Bulk logged**</span></span>|<span data-ttu-id="b1bc7-144">需要日志备份。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-144">Requires log backups.</span></span><br /><br /> <span data-ttu-id="b1bc7-145">是完整恢复模式的附加模式，允许执行高性能的大容量复制操作。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-145">An adjunct of the full recovery model that permits high-performance bulk copy operations.</span></span><br /><br /> <span data-ttu-id="b1bc7-146">通过使用最小方式记录大多数大容量操作，减少日志空间使用量。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-146">Reduces log space usage by using minimal logging for most bulk operations.</span></span> <span data-ttu-id="b1bc7-147">有关尽量减少日志量的操作的信息，请参阅 [事务日志 (SQL Server)](../logs/the-transaction-log-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-147">For information about operations that can be minimally logged, see [The Transaction Log &#40;SQL Server&#41;](../logs/the-transaction-log-sql-server.md).</span></span><br /><br /> <span data-ttu-id="b1bc7-148">有关大容量日志恢复模式下的数据库备份的信息，请参阅[完整数据库备份 (SQL Server)](full-database-backups-sql-server.md) 和[完整数据库还原（完整恢复模式）](complete-database-restores-full-recovery-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-148">For information about database backups under the bulk-logged recovery model, see [Full Database Backups &#40;SQL Server&#41;](full-database-backups-sql-server.md) and [Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md).</span></span>|<span data-ttu-id="b1bc7-149">如果在最新日志备份后发生日志损坏或执行大容量日志记录操作，则必须重做自该上次备份之后所做的更改。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-149">If the log is damaged or bulk-logged operations occurred since the most recent log backup, changes since that last backup must be redone.</span></span><br /><br /> <span data-ttu-id="b1bc7-150">否则不丢失任何工作。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-150">Otherwise, no work is lost.</span></span>|<span data-ttu-id="b1bc7-151">可以恢复到任何备份的结尾。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-151">Can recover to the end of any backup.</span></span> <span data-ttu-id="b1bc7-152">不支持时点恢复。</span><span class="sxs-lookup"><span data-stu-id="b1bc7-152">Point-in-time recovery is not supported.</span></span>|  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="b1bc7-153">相关任务</span><span class="sxs-lookup"><span data-stu-id="b1bc7-153">Related Tasks</span></span>  
  
-   [<span data-ttu-id="b1bc7-154">查看或更改数据库的恢复模式 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b1bc7-154">View or Change the Recovery Model of a Database &#40;SQL Server&#41;</span></span>](view-or-change-the-recovery-model-of-a-database-sql-server.md)  
  
-   [<span data-ttu-id="b1bc7-155">解决事务日志已满的问题（SQL Server 错误 9002）</span><span class="sxs-lookup"><span data-stu-id="b1bc7-155">Troubleshoot a Full Transaction Log &#40;SQL Server Error 9002&#41;</span></span>](../logs/troubleshoot-a-full-transaction-log-sql-server-error-9002.md)  
  
## <a name="see-also"></a><span data-ttu-id="b1bc7-156">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b1bc7-156">See Also</span></span>  
 <span data-ttu-id="b1bc7-157">[backupset (Transact-SQL)](/sql/relational-databases/system-tables/backupset-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-157">[backupset &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/backupset-transact-sql) </span></span>  
 <span data-ttu-id="b1bc7-158">[sys.databases (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-158">[sys.databases &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) </span></span>  
 <span data-ttu-id="b1bc7-159">[ALTER DATABASE SET 选项 (Transact-SQL)](/sql/t-sql/statements/alter-database-transact-sql-set-options) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-159">[ALTER DATABASE SET Options &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-set-options) </span></span>  
 <span data-ttu-id="b1bc7-160">[SQL Server 数据库的备份和还原](back-up-and-restore-of-sql-server-databases.md) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-160">[Back Up and Restore of SQL Server Databases](back-up-and-restore-of-sql-server-databases.md) </span></span>  
 <span data-ttu-id="b1bc7-161">[事务日志 (SQL Server)](../logs/the-transaction-log-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-161">[The Transaction Log &#40;SQL Server&#41;](../logs/the-transaction-log-sql-server.md) </span></span>  
 <span data-ttu-id="b1bc7-162">[自动执行管理任务（SQL Server 代理）](../../ssms/agent/sql-server-agent.md) </span><span class="sxs-lookup"><span data-stu-id="b1bc7-162">[Automated Administration Tasks &#40;SQL Server Agent&#41;](../../ssms/agent/sql-server-agent.md) </span></span>  
 [<span data-ttu-id="b1bc7-163">还原和恢复概述 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="b1bc7-163">Restore and Recovery Overview &#40;SQL Server&#41;</span></span>](restore-and-recovery-overview-sql-server.md)  
  
  
