---
title: 还原数据库备份 (SQL Server Management Studio) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
f1_keywords:
- sql12.swb.locatebackupfileazure.f1
- sql12.swb.specifybackup.f1
helpviewer_keywords:
- full backups [SQL Server]
- database restores [SQL Server], full backups
- backing up databases [SQL Server], full backups
- database backups [SQL Server], full backups
- restoring databases [SQL Server], full backups
ms.assetid: 24b3311d-5ce0-4581-9a05-5c7c726c7b21
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 82c3c7191ab686550885ebdc050f5fb1ac818cb9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589169"
---
# <a name="restore-a-database-backup-sql-server-management-studio"></a><span data-ttu-id="2ee4e-102">还原数据库备份 (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="2ee4e-102">Restore a Database Backup (SQL Server Management Studio)</span></span>
  <span data-ttu-id="2ee4e-103">本主题说明如何还原完整数据库备份。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-103">This topic explains how to restore a full database backup.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2ee4e-104">在完整恢复模式或大容量日志恢复模式下，必须先备份活动事务日志（称为日志尾部），然后才能在 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 中还原数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-104">Under the full or bulk-logged recovery model, before you can restore a database in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], you must back up the active transaction log (known as the tail of the log).</span></span> <span data-ttu-id="2ee4e-105">有关详细信息，请参阅 [备份事务日志 (SQL Server)](back-up-a-transaction-log-sql-server.md)数据库还原到一个新位置并且可以选择重命名该数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-105">For more information, see [Back Up a Transaction Log &#40;SQL Server&#41;](back-up-a-transaction-log-sql-server.md).</span></span> <span data-ttu-id="2ee4e-106">若要还原已加密的数据库，您必须有权访问用于对数据库进行加密的证书或非对称密钥。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-106">To restore a database that is encrypted, you must have access to the certificate or asymmetric key that was used to encrypt the database.</span></span> <span data-ttu-id="2ee4e-107">如果没有证书或非对称密钥，数据库将无法还原。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-107">Without the certificate or asymmetric key, the database cannot be restored.</span></span> <span data-ttu-id="2ee4e-108">因此，只要需要该备份，就必须保留用于对数据库加密密钥进行加密的证书。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-108">As a result, the certificate that is used to encrypt the database encryption key must be retained as long as the backup is needed.</span></span> <span data-ttu-id="2ee4e-109">有关详细信息，请参阅 [SQL Server Certificates and Asymmetric Keys](../security/sql-server-certificates-and-asymmetric-keys.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-109">For more information, see [SQL Server Certificates and Asymmetric Keys](../security/sql-server-certificates-and-asymmetric-keys.md).</span></span>  
  
 <span data-ttu-id="2ee4e-110">请注意，如果您将 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或更高版本的数据库还原为 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]，将自动升级该数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-110">Note that if you restore a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or higher database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the database is automatically upgraded.</span></span> <span data-ttu-id="2ee4e-111">通常，该数据库将立即可用。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-111">Typically, the database becomes available immediately.</span></span> <span data-ttu-id="2ee4e-112">但是，如果 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库具有全文检索，则升级过程将导入、重置或重新生成它们，具体取决于“全文升级选项”服务器属性的设置。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-112">However, if a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database has full-text indexes, the upgrade process either imports, resets, or rebuilds them, depending on the setting of the **Full-Text Upgrade Option** server property.</span></span> <span data-ttu-id="2ee4e-113">如果将升级选项设置为“导入”或“重新生成”，在升级过程中将无法使用全文检索。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-113">If the upgrade option is set to **Import** or **Rebuild**, the full-text indexes will be unavailable during the upgrade.</span></span> <span data-ttu-id="2ee4e-114">导入可能需要数小时，而重新生成所需的时间最多时可能十倍于此，具体取决于要编制索引的数据量。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-114">Depending upon the amount of data being indexed, importing can take several hours, and rebuilding can take up to ten times longer.</span></span> <span data-ttu-id="2ee4e-115">另请注意，当升级选项设置为“导入”时，如果全文目录不可用，将重新生成关联的全文检索。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-115">Note also that when the upgrade option is set to **Import**, if a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span> <span data-ttu-id="2ee4e-116">有关查看或更改“全文升级选项”属性设置的信息，请参阅[管理和监视服务器实例的全文搜索](../search/manage-and-monitor-full-text-search-for-a-server-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-116">For information about viewing or changing the setting of the **Full-Text Upgrade Option** property, see [Manage and Monitor Full-Text Search for a Server Instance](../search/manage-and-monitor-full-text-search-for-a-server-instance.md).</span></span>  
  
### <a name="to-restore-a-full-database-backup"></a><span data-ttu-id="2ee4e-117">还原完整数据库备份</span><span class="sxs-lookup"><span data-stu-id="2ee4e-117">To restore a full database backup</span></span>  
  
1.  <span data-ttu-id="2ee4e-118">连接到相应的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 实例之后，在“对象资源管理器”中，单击服务器名称以展开服务器树。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-118">After you connect to the appropriate instance of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)], in Object Explorer, click the server name to expand the server tree.</span></span>  
  
2.  <span data-ttu-id="2ee4e-119">展开 **“数据库”** 。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-119">Expand **Databases**.</span></span> <span data-ttu-id="2ee4e-120">根据具体的数据库，选择一个用户数据库，或展开“系统数据库”并选择一个系统数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-120">Depending on the database, either select a user database or expand **System Databases**, and then select a system database.</span></span>  
  
3.  <span data-ttu-id="2ee4e-121">右键单击该数据库，指向 "**任务**"，再指向 "**还原**"，然后单击 "**数据库**"，这将打开 "**还原数据库**" 对话框。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-121">Right-click the database, point to **Tasks**, point to **Restore**, and then click **Database**, which opens the **Restore Database** dialog box.</span></span>  
  
4.  <span data-ttu-id="2ee4e-122">在 **“常规”** 页上，使用 **“源”** 部分指定要还原的备份集的源和位置。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-122">On the **General** page, use the **Source** section to specify the source and location of the backup sets to restore.</span></span> <span data-ttu-id="2ee4e-123">选择以下选项之一：</span><span class="sxs-lookup"><span data-stu-id="2ee4e-123">Select one of the following options:</span></span>  
  
    -   <span data-ttu-id="2ee4e-124">**Database**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-124">**Database**</span></span>  
  
         <span data-ttu-id="2ee4e-125">从下拉列表中选择要还原的数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-125">Select the database to restore from the drop-down list.</span></span> <span data-ttu-id="2ee4e-126">此列表仅包含已根据 **msdb** 备份历史记录进行备份的数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-126">The list contains only databases that have been backed up according to the **msdb** backup history.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2ee4e-127">如果备份是从另一台服务器执行的，则目标服务器不具有指定数据库的备份历史记录信息。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-127">If the backup is taken from a different server, the destination server will not have the backup history information for the specified database.</span></span> <span data-ttu-id="2ee4e-128">这种情况下，请选择 **“设备”** 以手动指定要还原的文件或设备。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-128">In this case, select **Device** to manually specify the file or device to restore.</span></span>  
  
    -   <span data-ttu-id="2ee4e-129">**设备**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-129">**Device**</span></span>  
  
         <span data-ttu-id="2ee4e-130">单击“浏览”按钮 ( **...** ) 以打开“选择备份设备”  对话框。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-130">Click the browse (**...**) button to open the **Select backup devices** dialog box.</span></span> <span data-ttu-id="2ee4e-131">在 **“备份介质类型”** 框中，从列出的设备类型中选择一种。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-131">In the **Backup media type** box, select one of the listed device types.</span></span> <span data-ttu-id="2ee4e-132">若要为 **“备份介质”** 框选择一个或多个设备，请单击 **“添加”** 。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-132">To select one or more devices for the **Backup media** box, click **Add**.</span></span>  
  
         <span data-ttu-id="2ee4e-133">将所需设备添加到 **“备份介质”** 列表框后，单击 **“确定”** 返回到 **“常规”** 页。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-133">After you add the devices you want to the **Backup media** list box, click **OK** to return to the **General** page.</span></span>  
  
         <span data-ttu-id="2ee4e-134">在“源:设备:数据库”列表框中，选择应还原的数据库名称 **。**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-134">In the **Source: Device: Database** list box, select the name of the database which should be restored.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="2ee4e-135">此列表仅在选择了 **“设备”** 时才可用。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-135">This list is only available when **Device** is selected.</span></span> <span data-ttu-id="2ee4e-136">只有在所选设备上具有备份的数据库才可用。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-136">Only databases that have backups on the selected device will be available.</span></span>  
  
         <span data-ttu-id="2ee4e-137">**备份介质**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-137">**Backup media**</span></span>  
         <span data-ttu-id="2ee4e-138">选择还原操作的介质： "**文件**"、"**磁带**"、" **URL**" 或 "**备份设备**"。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-138">Select the medium for the restore operation: **File**, **Tape**, **URL**or **Backup Device**.</span></span> <span data-ttu-id="2ee4e-139">只有在计算机上装有磁带机时，才会显示 **“磁带”** 选项，只有至少存在一个备份设备时，才会显示 **“备份设备”** 选项。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-139">The **Tape** option appears only if a tape drive is mounted on the computer, and the **Backup Device** option appears, only if at least one backup device exists.</span></span>  
  
         <span data-ttu-id="2ee4e-140">**备份位置**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-140">**Backup location**</span></span>  
         <span data-ttu-id="2ee4e-141">查看、添加或删除还原操作使用的介质。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-141">View, add, or remove media for the restore operation.</span></span> <span data-ttu-id="2ee4e-142">列表最多可以包含 64 个文件、磁带或备份设备。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-142">The list can contain up to 64 files, tapes, or backup devices.</span></span>  
  
         <span data-ttu-id="2ee4e-143">**添加**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-143">**Add**</span></span>  
         <span data-ttu-id="2ee4e-144">将备份设备的位置添加到 "**备份位置**" 列表中。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-144">Adds the location of a backup device to the **Backup location** list.</span></span> <span data-ttu-id="2ee4e-145">根据您在 **“备份介质”** 字段中选择的介质类型，单击 **“添加”** 将打开下列对话框之一。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-145">Depending on the type of media you select in the **Backup media** field, clicking **Add** opens one of the following dialog boxes.</span></span>  
  
        |<span data-ttu-id="2ee4e-146">介质类型</span><span class="sxs-lookup"><span data-stu-id="2ee4e-146">Media type</span></span>|<span data-ttu-id="2ee4e-147">对话框</span><span class="sxs-lookup"><span data-stu-id="2ee4e-147">Dialog box</span></span>|<span data-ttu-id="2ee4e-148">说明</span><span class="sxs-lookup"><span data-stu-id="2ee4e-148">Description</span></span>|  
        |----------------|----------------|-----------------|  
        |<span data-ttu-id="2ee4e-149">**File**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-149">**File**</span></span>|<span data-ttu-id="2ee4e-150">**定位备份文件**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-150">**Locate Backup File**</span></span>|<span data-ttu-id="2ee4e-151">在此对话框中，您可以从树中选择一个本地文件，或使用完全限定的通用命名约定 (UNC) 名称指定一个远程文件。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-151">In this dialog box, you can select a local file from the tree or specify a remote file using its fully qualified universal naming convention (UNC) name.</span></span> <span data-ttu-id="2ee4e-152">有关详细信息，请参阅 [备份设备 (SQL Server)](backup-devices-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-152">For more information, see [Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md).</span></span>|  
        |<span data-ttu-id="2ee4e-153">**设备**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-153">**Device**</span></span>|<span data-ttu-id="2ee4e-154">**选择备份设备**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-154">**Select Backup Device**</span></span>|<span data-ttu-id="2ee4e-155">在此对话框中，您可以从服务器实例中定义的逻辑备份设备列表中进行选择。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-155">In this dialog box, you can select from a list of the logical backup devices defined on the server instance.</span></span>|  
        |<span data-ttu-id="2ee4e-156">**磁带**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-156">**Tape**</span></span>|<span data-ttu-id="2ee4e-157">**选择备份磁带**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-157">**Select Backup Tape**</span></span>|<span data-ttu-id="2ee4e-158">在此对话框中，您可以从与运行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的计算机物理连接的磁带机列表中进行选择。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-158">In this dialog box, you can select from a list of the tape drives that are physically connected to the computer running the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
        |<span data-ttu-id="2ee4e-159">**URL**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-159">**URL**</span></span>|<span data-ttu-id="2ee4e-160">这会按以下顺序启动两个对话框：</span><span class="sxs-lookup"><span data-stu-id="2ee4e-160">This launches two dialog boxes in the following order:</span></span><br /><br /> <span data-ttu-id="2ee4e-161">1) **连接到 Azure 存储**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-161">1) **Connect to Azure Storage**</span></span><br /><br /> <span data-ttu-id="2ee4e-162">2) **在 Azure 中定位备份文件**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-162">2) **Locate Backup File in Azure**</span></span>|<span data-ttu-id="2ee4e-163">在 "**连接到 Azure 存储**" 对话框中，选择存储 Azure 存储帐户名称和访问密钥信息的现有 sql 凭据，或通过指定存储帐户名称和存储访问密钥信息创建新的 sql 凭据。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-163">In the **Connect to Azure Storage**  dialog box, Select an existing SQL Credential that stores the Azure storage account name and access key information, or create new SQL Credential by specifying the storage account name and storage access key information.</span></span> <span data-ttu-id="2ee4e-164">有关详细信息，请参阅[连接到 Azure 存储 &#40;Restore&#41;](connect-to-microsoft-azure-storage-restore.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-164">For more information, see [Connect to Azure Storage &#40;Restore&#41;](connect-to-microsoft-azure-storage-restore.md).</span></span><br /><br /> <span data-ttu-id="2ee4e-165">在 **“查找备份文件”** 对话框中，您可以从左边框架显示的容器列表中选择一个文件。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-165">In the **Locate Backup File** dialog box, you can select a file from the list of containers displayed on the left frame.</span></span>|  
  
         <span data-ttu-id="2ee4e-166">如果列表已满，此 **“添加”** 按钮将不可用。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-166">If the list is full, the **Add** button is unavailable.</span></span>  
  
         <span data-ttu-id="2ee4e-167">**移除**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-167">**Remove**</span></span>  
         <span data-ttu-id="2ee4e-168">删除一个或多个选定的文件、磁带或逻辑备份设备。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-168">Removes one or more selected files, tapes, or logical backup devices.</span></span>  
  
         <span data-ttu-id="2ee4e-169">**Contents**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-169">**Contents**</span></span>  
         <span data-ttu-id="2ee4e-170">显示选定文件、磁带或逻辑备份设备的介质内容。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-170">Displays the media contents of a selected file, tape, or logical backup device.</span></span>  
  
5.  <span data-ttu-id="2ee4e-171">在 **“目标”** 部分中， **“数据库”** 框自动填充要还原的数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-171">In the **Destination** section, the **Database** box is automatically populated with the name of the database to be restored.</span></span> <span data-ttu-id="2ee4e-172">若要更改数据库名称，请在 **“数据库”** 框中输入新名称。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-172">To change the name of the database, enter the new name in the **Database** box.</span></span>  
  
6.  <span data-ttu-id="2ee4e-173">在 **“还原到”** 框中，保留默认选项 **“至最近一次进行的备份”** ，或者单击 **“时间线”** 访问 **“备份时间线”** 对话框以手动选择要停止恢复操作的时间点。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-173">In the **Restore to** box, leave the default as **To the last backup taken** or click on **Timeline** to access the **Backup Timeline** dialog box to manually select a point in time to stop the recovery action.</span></span> <span data-ttu-id="2ee4e-174">有关指定特定时间点的详细信息，请参阅 [Backup Timeline](backup-timeline.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-174">For more information on designating a specific point in time, see [Backup Timeline](backup-timeline.md).</span></span>  
  
7.  <span data-ttu-id="2ee4e-175">在 **“要还原的备份集”** 网格中，选择要还原的备份。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-175">In the **Backup sets to restore** grid, select the backups to restore.</span></span> <span data-ttu-id="2ee4e-176">此网格将显示对于指定位置可用的备份。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-176">This grid displays the backups available for the specified location.</span></span> <span data-ttu-id="2ee4e-177">默认情况下，系统会推荐一个恢复计划。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-177">By default, a recovery plan is suggested.</span></span> <span data-ttu-id="2ee4e-178">若要覆盖建议的恢复计划，可以更改网格中的选择。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-178">To override the suggested recovery plan, you can change the selections in the grid.</span></span> <span data-ttu-id="2ee4e-179">当取消选择某个早期备份时，将自动取消选择那些需要还原该早期备份才能进行的备份。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-179">Backups that depend on the restoration of an earlier backup are automatically deselected when the earlier backup is deselected.</span></span> <span data-ttu-id="2ee4e-180">有关“用于还原的备份集”  网格中的列的信息，请参阅[还原数据库（“常规”页）](../../integration-services/general-page-of-integration-services-designers-options.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-180">For information about the columns in the **Backup sets to restore** grid, see [Restore Database &#40;General Page&#41;](../../integration-services/general-page-of-integration-services-designers-options.md).</span></span>  
  
8.  <span data-ttu-id="2ee4e-181">或者单击 **“选择页”** 窗格中的 **“文件”** ，以便访问 **“文件”** 对话框。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-181">Optionally, click **Files** in the **Select a page** pane to access the **Files** dialog box.</span></span> <span data-ttu-id="2ee4e-182">在该对话框中，您可以通过在 **“将数据库文件还原为”** 网格中指定每个文件的新还原目标，将数据库还原到新的位置。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-182">From here, you can restore the database to a new location by specifying a new restore destination for each file in the **Restore the database files as** grid.</span></span> <span data-ttu-id="2ee4e-183">有关该网格的详细信息，请参阅[还原数据库（“文件”页）](restore-database-files-page.md)。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-183">For more information about this grid, see [Restore Database &#40;Files Page&#41;](restore-database-files-page.md).</span></span>  
  
9. <span data-ttu-id="2ee4e-184">若要查看或选择高级选项，在 **“选项”** 页的 **“还原选项”** 面板中，可以根据您的实际情况选择下列任意选项：</span><span class="sxs-lookup"><span data-stu-id="2ee4e-184">To view or select the advanced options, on the **Options** page, in the **Restore options** panel, you can select any of the following options, if appropriate for your situation:</span></span>  
  
    1.  <span data-ttu-id="2ee4e-185">`WITH` 选项（不是必需的）：</span><span class="sxs-lookup"><span data-stu-id="2ee4e-185">`WITH` options (not required):</span></span>  
  
        -   <span data-ttu-id="2ee4e-186">**覆盖现有数据库(WITH REPLACE)**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-186">**Overwrite the existing database (WITH REPLACE)**</span></span>  
  
        -   <span data-ttu-id="2ee4e-187">**保留复制设置(WITH KEEP_REPLICATION)**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-187">**Preserve the replication settings (WITH KEEP_REPLICATION)**</span></span>  
  
        -   <span data-ttu-id="2ee4e-188">**限制对还原数据库的访问(WITH RESTRICTED_USER)**</span><span class="sxs-lookup"><span data-stu-id="2ee4e-188">**Restrict access to the restored database (WITH RESTRICTED_USER)**</span></span>  
  
    2.  <span data-ttu-id="2ee4e-189">为 **“恢复状态”** 框选择一个选项。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-189">Select an option for the **Recovery state** box.</span></span> <span data-ttu-id="2ee4e-190">此框确定还原操作之后的数据库状态。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-190">This box determines the state of the database after the restore operation.</span></span>  
  
        -   <span data-ttu-id="2ee4e-191">**RESTORE WITH RECOVERY** 是默认行为，它通过回滚未提交的事务，使数据库处于可以使用的状态。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-191">**RESTORE WITH RECOVERY** is the default behavior which leaves the database ready for use by rolling back the uncommitted transactions.</span></span> <span data-ttu-id="2ee4e-192">无法还原其他事务日志。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-192">Additional transaction logs cannot be restored.</span></span> <span data-ttu-id="2ee4e-193">如果您要立即还原所有必要的备份，则选择此选项。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-193">Select this option if you are restoring all of the necessary backups now.</span></span>  
  
        -   <span data-ttu-id="2ee4e-194">**RESTORE WITH NORECOVERY** 不对数据库执行任何操作，不回滚未提交的事务。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-194">**RESTORE WITH NORECOVERY** which leaves the database non-operational, and does not roll back the uncommitted transactions.</span></span> <span data-ttu-id="2ee4e-195">可以还原其他事务日志。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-195">Additional transaction logs can be restored.</span></span> <span data-ttu-id="2ee4e-196">除非恢复数据库，否则无法使用数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-196">The database cannot be used until it is recovered.</span></span>  
  
        -   <span data-ttu-id="2ee4e-197">**RESTORE WITH STANDBY** 使数据库处于只读模式。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-197">**RESTORE WITH STANDBY** which leaves the database in read-only mode.</span></span> <span data-ttu-id="2ee4e-198">它撤消未提交的事务，但将撤消操作保存在备用文件中，以便能够还原恢复结果。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-198">It undoes uncommitted transactions, but saves the undo actions in a standby file so that recovery effects can be reverted.</span></span>  
  
    3.  <span data-ttu-id="2ee4e-199">如果对于选择的时间点是必需的，则选择“还原前进行结尾日志备份”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-199">**Take tail-log backup before restore** will be selected if it is necessary for the point in time that you have selected.</span></span> <span data-ttu-id="2ee4e-200">无需修改此设置，但可以选择备份日志尾部（即使不需要）。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-200">You do not need to modify this setting, but you can choose to backup the tail of the log even if it is not required.</span></span> <span data-ttu-id="2ee4e-201">此处为文件名？</span><span class="sxs-lookup"><span data-stu-id="2ee4e-201">filename here?</span></span> <span data-ttu-id="2ee4e-202">如果 "**常规**" 页中的第一个备份集位于 Azure 中，则还会将结尾日志备份到同一存储容器。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-202">If the first backup set in the **General** page is in Azure, the tail log will also be backed up to the same storage container.</span></span>  
  
    4.  <span data-ttu-id="2ee4e-203">如果存在与数据库的活动连接，则还原操作可能会失败。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-203">Restore operations may fail if there are active connections to the database.</span></span> <span data-ttu-id="2ee4e-204">选中 **“关闭现有连接”** 以确保关闭 [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] 和数据库之间的所有活动连接。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-204">Check the **Close existing connections option** to ensure that all active connections between [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] and the database are closed.</span></span> <span data-ttu-id="2ee4e-205">此复选框可在执行还原操作之前将数据库设置为单用户模式，并在该操作完成后将数据库设置为多用户模式。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-205">This check box sets the database to single user mode before performing the restore operations, and sets the database to multi-user mode when complete.</span></span>  
  
    5.  <span data-ttu-id="2ee4e-206">如果要在每个还原操作之间进行提示，请选择 **“还原每个备份之前进行提示”** 。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-206">Select **Prompt before restoring each backup** if you wish to be prompted between each restore operation.</span></span> <span data-ttu-id="2ee4e-207">除非数据库过大并且您要监视还原操作的状态，否则通常没有必要选中该选项。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-207">This is not usually necessary unless the database is large and you wish to monitor the status of the restore operation.</span></span>  
  
     <span data-ttu-id="2ee4e-208">有关这些还原选项的详细信息，请参阅 [还原数据库（“选项”页）](restore-database-options-page.md)），然后才能还原数据库。</span><span class="sxs-lookup"><span data-stu-id="2ee4e-208">For more information about these restore options, see [Restore Database &#40;Options Page&#41;](restore-database-options-page.md).</span></span>  
  
10. [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
## <a name="see-also"></a><span data-ttu-id="2ee4e-209">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2ee4e-209">See Also</span></span>  
 <span data-ttu-id="2ee4e-210">[备份事务日志 (SQL Server)](back-up-a-transaction-log-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-210">[Back Up a Transaction Log &#40;SQL Server&#41;](back-up-a-transaction-log-sql-server.md) </span></span>  
 <span data-ttu-id="2ee4e-211">[创建完整数据库备份 (SQL Server)](create-a-full-database-backup-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-211">[Create a Full Database Backup &#40;SQL Server&#41;](create-a-full-database-backup-sql-server.md) </span></span>  
 <span data-ttu-id="2ee4e-212">[将数据库还原到新位置 (SQL Server)](restore-a-database-to-a-new-location-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-212">[Restore a Database to a New Location &#40;SQL Server&#41;](restore-a-database-to-a-new-location-sql-server.md) </span></span>  
 <span data-ttu-id="2ee4e-213">[还原事务日志备份 (SQL Server)](restore-a-transaction-log-backup-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-213">[Restore a Transaction Log Backup &#40;SQL Server&#41;](restore-a-transaction-log-backup-sql-server.md) </span></span>  
 <span data-ttu-id="2ee4e-214">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-214">[RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql) </span></span>  
 <span data-ttu-id="2ee4e-215">[还原数据库（“选项”页）](restore-database-options-page.md) </span><span class="sxs-lookup"><span data-stu-id="2ee4e-215">[Restore Database &#40;Options Page&#41;](restore-database-options-page.md) </span></span>  
 [<span data-ttu-id="2ee4e-216">还原数据库（“常规”页）</span><span class="sxs-lookup"><span data-stu-id="2ee4e-216">Restore Database &#40;General Page&#41;</span></span>](../../integration-services/general-page-of-integration-services-designers-options.md)  
  
  
