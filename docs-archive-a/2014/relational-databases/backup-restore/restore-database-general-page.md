---
title: 还原数据库（“常规”页）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
f1_keywords:
- sql12.swb.restoredb.general.f1
ms.assetid: 160cf58c-b06a-475f-9a69-2b051e5767ab
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 2a497e6a6e4584aa064783eba2076b7e50b36e8f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589157"
---
# <a name="restore-database-general-page"></a><span data-ttu-id="244ec-102">还原数据库（“常规”页）</span><span class="sxs-lookup"><span data-stu-id="244ec-102">Restore Database (General Page)</span></span>
  <span data-ttu-id="244ec-103">使用“常规”页，可以指定数据库还原操作的目标数据库和源数据库的有关信息。</span><span class="sxs-lookup"><span data-stu-id="244ec-103">Use the **General** page to specify information about the target and source databases for a database-restore operation.</span></span>  
  
 <span data-ttu-id="244ec-104">**使用 SQL Server Management Studio 还原数据库备份**</span><span class="sxs-lookup"><span data-stu-id="244ec-104">**To use SQL Server Management Studio to restore a database backup**</span></span>  
  
-   [<span data-ttu-id="244ec-105">还原数据库备份 &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="244ec-105">Restore a Database Backup &#40;SQL Server Management Studio&#41;</span></span>](restore-a-database-backup-using-ssms.md)  
  
-   [<span data-ttu-id="244ec-106">为磁带驱动器定义逻辑备份设备 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="244ec-106">Define a Logical Backup Device for a Tape Drive &#40;SQL Server&#41;</span></span>](define-a-logical-backup-device-for-a-tape-drive-sql-server.md)  
  
> [!NOTE]  
>  <span data-ttu-id="244ec-107">使用指定还原任务时 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] ，可以 [!INCLUDE[tsql](../../includes/tsql-md.md)] 通过单击 "**脚本**"，然后为脚本选择一个目标，生成相应的[还原](/sql/t-sql/statements/restore-statements-transact-sql)脚本。</span><span class="sxs-lookup"><span data-stu-id="244ec-107">When you specify a restore task by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], you can generate the corresponding [!INCLUDE[tsql](../../includes/tsql-md.md)][RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) script by clicking **Script** and then selecting a destination for the script.</span></span>  
  
## <a name="permissions"></a><span data-ttu-id="244ec-108">权限</span><span class="sxs-lookup"><span data-stu-id="244ec-108">Permissions</span></span>  
 <span data-ttu-id="244ec-109">如果不存在要还原的数据库，则用户必须有 CREATE DATABASE 权限才能执行 RESTORE。</span><span class="sxs-lookup"><span data-stu-id="244ec-109">If the database being restored does not exist, the user must have CREATE DATABASE permissions to be able to execute RESTORE.</span></span> <span data-ttu-id="244ec-110">如果该数据库存在，则 RESTORE 权限默认授予 **sysadmin** 和 **dbcreator** 固定服务器角色成员以及该数据库的所有者 (**dbo**)。</span><span class="sxs-lookup"><span data-stu-id="244ec-110">If the database exists, RESTORE permissions default to members of the **sysadmin** and **dbcreator** fixed server roles and the owner (**dbo**) of the database.</span></span>  
  
 <span data-ttu-id="244ec-111">RESTORE 权限被授予那些成员身份信息始终可由服务器使用的角色。</span><span class="sxs-lookup"><span data-stu-id="244ec-111">RESTORE permissions are given to roles in which membership information is always readily available to the server.</span></span> <span data-ttu-id="244ec-112">因为只有在固定数据库可以访问且没有损坏时（在执行 RESTORE 时并不会总是这样）才能检查固定数据库角色成员身份，所以 **db_owner** 固定数据库角色成员没有 RESTORE 权限。</span><span class="sxs-lookup"><span data-stu-id="244ec-112">Because fixed database role membership can be checked only when the database is accessible and undamaged, which is not always the case when RESTORE is executed, members of the **db_owner** fixed database role do not have RESTORE permissions.</span></span>  
  
 <span data-ttu-id="244ec-113">从加密的备份进行还原需要对在备份期间用于加密的证书或非对称密钥具有 `VIEW DEFINITION` 权限。</span><span class="sxs-lookup"><span data-stu-id="244ec-113">Restoring from an encrypted backup requires `VIEW DEFINITION` permissions to the certificate or asymmetric key used to encrypt during backup.</span></span>  
  
## <a name="options"></a><span data-ttu-id="244ec-114">选项</span><span class="sxs-lookup"><span data-stu-id="244ec-114">Options</span></span>  
  
### <a name="source"></a><span data-ttu-id="244ec-115">源</span><span class="sxs-lookup"><span data-stu-id="244ec-115">Source</span></span>  
 <span data-ttu-id="244ec-116">“还原自” 面板中的选项可标识数据库的备份集的位置以及要还原的备份集。</span><span class="sxs-lookup"><span data-stu-id="244ec-116">The options of the **Restore from**panel identify the location of the backup sets for the database and which backup sets you want to restore.</span></span>  
  
|<span data-ttu-id="244ec-117">术语</span><span class="sxs-lookup"><span data-stu-id="244ec-117">Term</span></span>|<span data-ttu-id="244ec-118">定义</span><span class="sxs-lookup"><span data-stu-id="244ec-118">Definition</span></span>|  
|----------|----------------|  
|<span data-ttu-id="244ec-119">**Database**</span><span class="sxs-lookup"><span data-stu-id="244ec-119">**Database**</span></span>|<span data-ttu-id="244ec-120">从下拉列表中选择要还原的数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-120">Select the database to restore from the drop-down list.</span></span> <span data-ttu-id="244ec-121">此列表仅包含已根据 **msdb** 备份历史记录进行备份的数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-121">The list contains only databases that have been backed up according to the **msdb** backup history.</span></span>|  
|<span data-ttu-id="244ec-122">**设备**</span><span class="sxs-lookup"><span data-stu-id="244ec-122">**Device**</span></span>|<span data-ttu-id="244ec-123">选择包含要还原的一个或多个备份的逻辑或物理备份设备（磁带、URL 或文件）。</span><span class="sxs-lookup"><span data-stu-id="244ec-123">Select the logical or physical backup devices (tapes, URL or files) that contain the backup or backups you want to restore.</span></span> <span data-ttu-id="244ec-124">如果在另一个 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例上执行数据库备份，则此选项是必需的。</span><span class="sxs-lookup"><span data-stu-id="244ec-124">This is required if the database backup was taken on a different instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="244ec-125">若要选择一个或多个逻辑或物理备份设备，请单击浏览按钮，这将打开 **“选择备份设备”** 对话框。</span><span class="sxs-lookup"><span data-stu-id="244ec-125">To select one or more logical or physical backup devices, click the browse button which opens the **Select backup devices** dialog box.</span></span> <span data-ttu-id="244ec-126">在此，最多可以选择属于一个介质集的 64 个设备。</span><span class="sxs-lookup"><span data-stu-id="244ec-126">There, you can select up to 64 devices that belong to a single media set.</span></span> <span data-ttu-id="244ec-127">磁带机必须与运行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的计算机进行物理连接。</span><span class="sxs-lookup"><span data-stu-id="244ec-127">Tape devices must be physically connected to the computer that is running the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="244ec-128">备份文件可以位于本地或远程磁带设备上。</span><span class="sxs-lookup"><span data-stu-id="244ec-128">A backup file can be on a local or remove disk device.</span></span> <span data-ttu-id="244ec-129">有关详细信息，请参阅 [备份设备 (SQL Server)](backup-devices-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="244ec-129">For more information, see [Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md).</span></span> <span data-ttu-id="244ec-130">还可以选择“URL”作为 Azure 存储中所存储备份文件的设备类型。</span><span class="sxs-lookup"><span data-stu-id="244ec-130">You can also select **URL** as the  device type for backup files stored in Azure storage.</span></span><br /><br /> <span data-ttu-id="244ec-131">退出“选择备份设备”对话框时，选择的设备将在“设备”列表中显示为只读值。</span><span class="sxs-lookup"><span data-stu-id="244ec-131">When you exit the **Select backup devices** dialog box, the selected device will appear as read-only values in the **Device** list.</span></span>|  
|<span data-ttu-id="244ec-132">**Database**</span><span class="sxs-lookup"><span data-stu-id="244ec-132">**Database**</span></span>|<span data-ttu-id="244ec-133">从下拉列表中选择要从其还原备份的数据库名称。</span><span class="sxs-lookup"><span data-stu-id="244ec-133">Select the database name from which the backups should be restored from the dropdown list.</span></span><br /><br /> <span data-ttu-id="244ec-134">注意：此列表仅在选择了 **“设备”** 时才可用。</span><span class="sxs-lookup"><span data-stu-id="244ec-134">Note: This list is only available when **Device** is selected.</span></span> <span data-ttu-id="244ec-135">只有已在所选设备上备份的数据库才可用。</span><span class="sxs-lookup"><span data-stu-id="244ec-135">Only databases that have backups on the selected devices will be available.</span></span>|  
  
### <a name="destination"></a><span data-ttu-id="244ec-136">目标</span><span class="sxs-lookup"><span data-stu-id="244ec-136">Destination</span></span>  
 <span data-ttu-id="244ec-137">**“还原到”** 面板中的选项可标识数据库和还原点。</span><span class="sxs-lookup"><span data-stu-id="244ec-137">The options of the **Restore to** panel identify the database and restore point.</span></span>  
  
|<span data-ttu-id="244ec-138">术语</span><span class="sxs-lookup"><span data-stu-id="244ec-138">Term</span></span>|<span data-ttu-id="244ec-139">定义</span><span class="sxs-lookup"><span data-stu-id="244ec-139">Definition</span></span>|  
|----------|----------------|  
|<span data-ttu-id="244ec-140">**Database**</span><span class="sxs-lookup"><span data-stu-id="244ec-140">**Database**</span></span>|<span data-ttu-id="244ec-141">在该列表中输入要还原的数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-141">Enter the database to restore in the list.</span></span> <span data-ttu-id="244ec-142">您可以输入新的数据库，也可以从下拉列表中选择现有的数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-142">You can enter a new database or choose an existing database from the drop-down list.</span></span> <span data-ttu-id="244ec-143">该列表包含了服务器上除系统数据库 **master** 和 **tempdb**之外的所有数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-143">The list includes all databases on the server, excluding the system databases **master** and **tempdb**.</span></span><br /><br /> <span data-ttu-id="244ec-144">注意：若要还原带有密码保护的备份，必须使用 [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) 语句。</span><span class="sxs-lookup"><span data-stu-id="244ec-144">Note: To restore a password-protected backup, you must use the [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) statement.</span></span>|  
|<span data-ttu-id="244ec-145">**“还原到”**</span><span class="sxs-lookup"><span data-stu-id="244ec-145">**Restore to**</span></span>|<span data-ttu-id="244ec-146">默认情况下， **“还原到”** 框将设置为“至最近一次进行的备份”。</span><span class="sxs-lookup"><span data-stu-id="244ec-146">The **Restore to** box will be set "To the last backup taken" by default.</span></span> <span data-ttu-id="244ec-147">您还可以单击 **“时间线”** 以便显示 **“备份时间线”** 对话框，该对话框将以时间线的形式显示数据库备份历史记录。</span><span class="sxs-lookup"><span data-stu-id="244ec-147">You can also click **Timeline** to show the **Backup Timeline** dialog box, which displays the database backup history in the form of a timeline.</span></span> <span data-ttu-id="244ec-148">单击 "**时间线**" 可以指定 `datetime` 要将数据库还原到的特定。</span><span class="sxs-lookup"><span data-stu-id="244ec-148">Click **Timeline** to designate a specific `datetime` to which you want to restore the database.</span></span> <span data-ttu-id="244ec-149">然后，数据库将还原到它在此指定时间点时所处的状态。</span><span class="sxs-lookup"><span data-stu-id="244ec-149">The database will then be restored to the state it was in at this specified point in time.</span></span> <span data-ttu-id="244ec-150">请参阅 [Backup Timeline](backup-timeline.md)。</span><span class="sxs-lookup"><span data-stu-id="244ec-150">See [Backup Timeline](backup-timeline.md).</span></span>|  
  
### <a name="restore-plan"></a><span data-ttu-id="244ec-151">还原计划</span><span class="sxs-lookup"><span data-stu-id="244ec-151">Restore Plan</span></span>  
  
|<span data-ttu-id="244ec-152">术语</span><span class="sxs-lookup"><span data-stu-id="244ec-152">Term</span></span>|<span data-ttu-id="244ec-153">定义</span><span class="sxs-lookup"><span data-stu-id="244ec-153">Definition</span></span>|  
|----------|----------------|  
|<span data-ttu-id="244ec-154">**用于还原的备份集**</span><span class="sxs-lookup"><span data-stu-id="244ec-154">**Backup sets to restore**</span></span>|<span data-ttu-id="244ec-155">显示可用于指定位置的备份集。</span><span class="sxs-lookup"><span data-stu-id="244ec-155">Displays the backup sets available for the specified location.</span></span> <span data-ttu-id="244ec-156">每个备份集（单个备份操作的结果）分布在介质集的所有设备上。</span><span class="sxs-lookup"><span data-stu-id="244ec-156">Each backup set, the result of a single backup operation, is distributed across all of the devices in the media set.</span></span> <span data-ttu-id="244ec-157">默认情况下，会建议制定一个恢复计划，以实现基于所选必需备份集执行的还原操作目标。</span><span class="sxs-lookup"><span data-stu-id="244ec-157">By default, a recovery plan is suggested to achieve the goal of the restore operation that is based on the selection of the required backup sets.</span></span> [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="244ec-158">使用 **msdb** 中的备份历史记录来标识还原数据库所需的备份并创建还原计划。</span><span class="sxs-lookup"><span data-stu-id="244ec-158">uses the backup history in **msdb** to identify which backups are required to restore a database, and creates a restore plan.</span></span> <span data-ttu-id="244ec-159">例如，为了进行数据库还原，还原计划将选择最近的完整数据库备份，然后选择最近的后续差异数据库备份（如果有）。</span><span class="sxs-lookup"><span data-stu-id="244ec-159">For example, for a database restore, the restore plan selects the most recent full database backup followed by the most recent subsequent differential database backup, if any.</span></span> <span data-ttu-id="244ec-160">在完整恢复模式下，还原计划随后将选择所有后续日志备份。</span><span class="sxs-lookup"><span data-stu-id="244ec-160">Under the full recovery model, the restore plan then selects all subsequent log backups.</span></span><br /><br /> <span data-ttu-id="244ec-161">若要覆盖建议的恢复计划，可以在网格中更改以下选项。</span><span class="sxs-lookup"><span data-stu-id="244ec-161">To override the suggested recovery plan, you can change the following selections in the grid.</span></span> <span data-ttu-id="244ec-162">任何依赖于已取消选择备份的备份，也将被自动取消选择。</span><span class="sxs-lookup"><span data-stu-id="244ec-162">Any backups that depend on a deselected backup are deselected automatically.</span></span><br /><br /> <span data-ttu-id="244ec-163">**还原**：</span><span class="sxs-lookup"><span data-stu-id="244ec-163">**Restore**:</span></span><br />                          <span data-ttu-id="244ec-164">选中的复选框指示要还原的备份集。</span><span class="sxs-lookup"><span data-stu-id="244ec-164">The selected check boxes indicate the backup sets to be restored.</span></span><br /><span data-ttu-id="244ec-165">**名称**：备份集的名称。</span><span class="sxs-lookup"><span data-stu-id="244ec-165">**Name**: The name of the backup set.</span></span><br /><span data-ttu-id="244ec-166">**组件**：备份组件：**数据库**、**文件**或 **\<blank>** 事务日志) 的 (。</span><span class="sxs-lookup"><span data-stu-id="244ec-166">**Component**: The backed-up component: **Database**, **File**, or **\<blank>** (for transaction logs).</span></span><br /><span data-ttu-id="244ec-167">**类型**：执行的备份类型：“完整”、“差异”或“事务日志”  。</span><span class="sxs-lookup"><span data-stu-id="244ec-167">**Type**: The type of backup performed: **Full**, **Differential**, or **Transaction Log**.</span></span><br /><span data-ttu-id="244ec-168">**服务器**：[!INCLUDE[ssDE](../../includes/ssde-md.md)] 执行备份操作的实例的名称。</span><span class="sxs-lookup"><span data-stu-id="244ec-168">**Server**: The name of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] instance that performed the backup operation.</span></span><br /><span data-ttu-id="244ec-169">**数据库**：备份操作中涉及的数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="244ec-169">**Database**: The name of the database involved in the backup operation.</span></span><br /><span data-ttu-id="244ec-170">**位置**：备份集在卷中的位置。</span><span class="sxs-lookup"><span data-stu-id="244ec-170">**Position**: The position of the backup set in the volume.</span></span><br /><span data-ttu-id="244ec-171">**第一个 LSN**：备份集中第一个事务的日志序列号。</span><span class="sxs-lookup"><span data-stu-id="244ec-171">**First LSN**: The log sequence number of the first transaction in the backup set.</span></span> <span data-ttu-id="244ec-172">对于文件备份为空。</span><span class="sxs-lookup"><span data-stu-id="244ec-172">Blank for file backups.</span></span><br /><span data-ttu-id="244ec-173">**最后一个 LSN**：备份集中最后一个事务的日志序列号。</span><span class="sxs-lookup"><span data-stu-id="244ec-173">**Last LSN**: The log sequence number of the last transaction in the backup set.</span></span> <span data-ttu-id="244ec-174">对于文件备份为空。</span><span class="sxs-lookup"><span data-stu-id="244ec-174">Blank for file backups.</span></span><br /><span data-ttu-id="244ec-175">**检查点 lsn**：创建备份时最新检查点的日志序列号 (LSN) 。</span><span class="sxs-lookup"><span data-stu-id="244ec-175">**Checkpoint LSN**: The log sequence number (LSN) of the most recent checkpoint at the time the backup was created.</span></span><br /><span data-ttu-id="244ec-176">**完整 LSN**：最新的完整数据库备份的日志序列号。</span><span class="sxs-lookup"><span data-stu-id="244ec-176">**Full LSN**: The log sequence number of the most recent full database backup.</span></span><br /><span data-ttu-id="244ec-177">**开始日期**：备份操作开始的日期和时间，以客户端的区域设置显示。</span><span class="sxs-lookup"><span data-stu-id="244ec-177">**Start Date**: The date and time when the backup operation began, presented in the regional setting of the client.</span></span><br /><span data-ttu-id="244ec-178">**完成日期**：备份操作完成的日期和时间，以客户端的区域设置显示。</span><span class="sxs-lookup"><span data-stu-id="244ec-178">**Finish Date**: The date and time when the backup operation finished, presented in the regional setting of the client.</span></span><br /><span data-ttu-id="244ec-179">**大小**：备份集的大小（以字节为单位）。</span><span class="sxs-lookup"><span data-stu-id="244ec-179">**Size**: The size of the backup set in bytes.</span></span><br /><span data-ttu-id="244ec-180">**用户名**：执行备份操作的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="244ec-180">**User Name**: The name of the user who performed the backup operation.</span></span><br /><br /> <span data-ttu-id="244ec-181">**过期**时间：备份集的过期日期和时间。</span><span class="sxs-lookup"><span data-stu-id="244ec-181">**Expiration**: The date and time the backup set expires.</span></span><br /><br /> <span data-ttu-id="244ec-182">只有在选中了 **“手动选择”** 框后，这些复选框才启用。</span><span class="sxs-lookup"><span data-stu-id="244ec-182">The checkboxes are only enabled when the **Manual Selection** box is checked.</span></span> <span data-ttu-id="244ec-183">这样，您可以选择要还原的备份集。</span><span class="sxs-lookup"><span data-stu-id="244ec-183">This allows you to select which backup-sets are to be restored.</span></span><br /><br /> <span data-ttu-id="244ec-184">在选中 **“手动选择”** 框后，每次修改还原计划时都会检查还原计划的精确性。</span><span class="sxs-lookup"><span data-stu-id="244ec-184">When the **Manual Selection** box is checked, the accuracy of the Restore Plan is checked each time it is modified.</span></span> <span data-ttu-id="244ec-185">如果备份的顺序不正确，将显示一条错误消息。</span><span class="sxs-lookup"><span data-stu-id="244ec-185">If the sequence of backups is incorrect, an error message will appear.</span></span>|  
|<span data-ttu-id="244ec-186">**验证备份介质**</span><span class="sxs-lookup"><span data-stu-id="244ec-186">**Verify Backup Media**</span></span>|<span data-ttu-id="244ec-187">对所选的备份集调用 RESTORE VERIFY_ONLY 语句。</span><span class="sxs-lookup"><span data-stu-id="244ec-187">Calls a RESTORE VERIFY_ONLY statement on the selected backup-sets.</span></span><br /><br /> <span data-ttu-id="244ec-188">注意：这是一个长时间运行的操作，并且可以通过在对话框框架上使用进度监视器来跟踪和取消其进度。</span><span class="sxs-lookup"><span data-stu-id="244ec-188">Note: This is a long-running operation, and its progress can be tracked and cancelled by using the Progress Monitor on the Dialog Framework.</span></span><br /><br /> <span data-ttu-id="244ec-189">此按钮可用于在还原所选备份文件之前检查其完整性。</span><span class="sxs-lookup"><span data-stu-id="244ec-189">This button allows you to check the integrity of the selected backup files prior to restoring them.</span></span><br /><br /> <span data-ttu-id="244ec-190">当检查备份集的完整性时，在该对话框左下角的进度状态将显示“正在验证”，而非“正在执行”。</span><span class="sxs-lookup"><span data-stu-id="244ec-190">When checking the integrity of backup sets, the progress status at the bottom left of the dialog box will read "Verifying" rather than "Executing."</span></span>|  
  
## <a name="compatibility-support"></a><span data-ttu-id="244ec-191">兼容性支持</span><span class="sxs-lookup"><span data-stu-id="244ec-191">Compatibility Support</span></span>  
 <span data-ttu-id="244ec-192">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中，可以从使用 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或更高版本创建的数据库备份来还原用户数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-192">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you can restore a user database from a database backup that was created by using [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or a later version.</span></span> <span data-ttu-id="244ec-193">但是， **无法还原使用**到 **创建的** master **、** model [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] msdb [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]备份。</span><span class="sxs-lookup"><span data-stu-id="244ec-193">However, backups of **master**, **model** and **msdb** that were created by using [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] through [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] cannot be restored by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="244ec-194">此外，任何早期版本的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 都无法还原在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中创建的备份。</span><span class="sxs-lookup"><span data-stu-id="244ec-194">Also, backups created in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] cannot be restored by any earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="244ec-195">使用与早期版本不同的默认路径。</span><span class="sxs-lookup"><span data-stu-id="244ec-195">uses a different default path than earlier versions.</span></span> <span data-ttu-id="244ec-196">因此，若要还原在早期 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]版本的默认位置创建的数据库，必须使用 MOVE 选项。</span><span class="sxs-lookup"><span data-stu-id="244ec-196">Therefore, to restore a database that was created in the default location of an earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], you must use the MOVE option.</span></span>  
  
 <span data-ttu-id="244ec-197">在您将早期版本数据库还原到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]后，将自动升级该数据库。</span><span class="sxs-lookup"><span data-stu-id="244ec-197">After you restore an earlier version database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the database is automatically upgraded.</span></span> <span data-ttu-id="244ec-198">通常，该数据库将立即可用。</span><span class="sxs-lookup"><span data-stu-id="244ec-198">Typically, the database becomes available immediately.</span></span> <span data-ttu-id="244ec-199">但是，如果 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库具有全文检索，则升级过程将导入、重置或重新生成它们，具体取决于“全文升级选项”服务器属性的设置。</span><span class="sxs-lookup"><span data-stu-id="244ec-199">However, if a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database has full-text indexes, the upgrade process either imports, resets, or rebuilds them, depending on the setting of the **Full-Text Upgrade Option** server property.</span></span> <span data-ttu-id="244ec-200">如果将升级选项设置为“导入”或“重新生成”，在升级过程中将无法使用全文检索。</span><span class="sxs-lookup"><span data-stu-id="244ec-200">If the upgrade option is set to **Import** or **Rebuild**, the full-text indexes will be unavailable during the upgrade.</span></span> <span data-ttu-id="244ec-201">导入可能需要数小时，而重新生成所需的时间最多时可能十倍于此，具体取决于要编制索引的数据量。</span><span class="sxs-lookup"><span data-stu-id="244ec-201">Depending upon the amount of data being indexed, importing can take several hours, and rebuilding can take up to ten times longer.</span></span> <span data-ttu-id="244ec-202">另请注意，当升级选项设置为“导入”时，如果全文目录不可用，将重新生成关联的全文检索。</span><span class="sxs-lookup"><span data-stu-id="244ec-202">Note also that when the upgrade option is set to **Import**, if a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span>  
  
## <a name="restoring-from-an-encrypted-backup"></a><span data-ttu-id="244ec-203">从加密备份还原</span><span class="sxs-lookup"><span data-stu-id="244ec-203">Restoring from an Encrypted Backup</span></span>  
 <span data-ttu-id="244ec-204">还原要求在要还原到的实例上具有最初用于创建备份的证书或非对称密钥。</span><span class="sxs-lookup"><span data-stu-id="244ec-204">Restore requires that the certificate or asymmetric key that was originally used to create the backup is available on the instance you are restoring to.</span></span> <span data-ttu-id="244ec-205">执行还原的帐户应对证书或非对称密钥具有 `VIEW DEFINITIONS` 权限。</span><span class="sxs-lookup"><span data-stu-id="244ec-205">The account performing the restore should have `VIEW DEFINITIONS` on the certificate or asymmetric key.</span></span> <span data-ttu-id="244ec-206">不应续订或更新用于加密备份的证书。</span><span class="sxs-lookup"><span data-stu-id="244ec-206">Certificates used to encrypt backup should not be renewed or updated.</span></span>  
  
## <a name="restoring-from-azure-storage"></a><span data-ttu-id="244ec-207">从 Azure 存储还原</span><span class="sxs-lookup"><span data-stu-id="244ec-207">Restoring from Azure Storage</span></span>  
 <span data-ttu-id="244ec-208">还原存储在 Azure 存储中的备份时，还原 UI 中有一个新的备份设备选项。</span><span class="sxs-lookup"><span data-stu-id="244ec-208">When restoring a backup stored in Azure storage, the Restore UI has a new backup device option.</span></span> <span data-ttu-id="244ec-209">**“选择备份设备”** 对话框上的 **“URL”** 。</span><span class="sxs-lookup"><span data-stu-id="244ec-209">**URL** on the **Select backup devices** dialog.</span></span> <span data-ttu-id="244ec-210">单击 "**添加**" 时，将转到 "**连接到 Azure** " 对话框，该对话框允许你指定要向存储帐户进行身份验证的 SQL 凭据信息。</span><span class="sxs-lookup"><span data-stu-id="244ec-210">When you click **Add**, this takes you to the **Connect to Azure** dialog that allows you to specify the SQL Credential information to authenticate to the storage account.</span></span>  <span data-ttu-id="244ec-211">连接到存储帐户后，备份文件将显示在 "**在 Azure 中查找备份文件**" 对话框中，你可以在其中选择要用于还原的文件。</span><span class="sxs-lookup"><span data-stu-id="244ec-211">Once connected to the storage account, the backup files are displayed in the **Locate a Backup file in Azure** dialog where you can select the file to use for the restore.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="244ec-212">另请参阅</span><span class="sxs-lookup"><span data-stu-id="244ec-212">See Also</span></span>  
 <span data-ttu-id="244ec-213">[备份设备 (SQL Server)](backup-devices-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-213">[Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-214">[从设备还原备份 (SQL Server)](restore-a-backup-from-a-device-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-214">[Restore a Backup from a Device &#40;SQL Server&#41;](restore-a-backup-from-a-device-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-215">[将数据库还原到标记的事务 (SQL Server Management Studio)](restore-a-database-to-a-marked-transaction-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-215">[Restore a Database to a Marked Transaction &#40;SQL Server Management Studio&#41;](restore-a-database-to-a-marked-transaction-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="244ec-216">[还原事务日志备份 (SQL Server)](restore-a-transaction-log-backup-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-216">[Restore a Transaction Log Backup &#40;SQL Server&#41;](restore-a-transaction-log-backup-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-217">[查看备份磁带或文件的内容 (SQL Server)](view-the-contents-of-a-backup-tape-or-file-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-217">[View the Contents of a Backup Tape or File &#40;SQL Server&#41;](view-the-contents-of-a-backup-tape-or-file-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-218">[查看逻辑备份设备的属性和内容 (SQL Server)](view-the-properties-and-contents-of-a-logical-backup-device-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-218">[View the Properties and Contents of a Logical Backup Device &#40;SQL Server&#41;](view-the-properties-and-contents-of-a-logical-backup-device-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-219">[媒体集、媒体簇和备份集 (SQL Server)](media-sets-media-families-and-backup-sets-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="244ec-219">[Media Sets, Media Families, and Backup Sets &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md) </span></span>  
 <span data-ttu-id="244ec-220">[RESTORE 参数 (Transact-SQL)](/sql/t-sql/statements/restore-statements-arguments-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="244ec-220">[RESTORE Arguments &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-arguments-transact-sql) </span></span>  
 [<span data-ttu-id="244ec-221">应用事务日志备份 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="244ec-221">Apply Transaction Log Backups &#40;SQL Server&#41;</span></span>](transaction-log-backups-sql-server.md)  
  
  
