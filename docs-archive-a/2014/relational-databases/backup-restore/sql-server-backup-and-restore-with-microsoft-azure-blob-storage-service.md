---
title: SQL Server Azure Blob 存储服务进行备份和还原 |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: 6a0c9b6a-cf71-4311-82f2-12c445f63935
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 943da9018e50e1f287858654d4639035f3aa4532
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87590217"
---
# <a name="sql-server-backup-and-restore-with-azure-blob-storage-service"></a><span data-ttu-id="5c8ba-102">使用 Azure Blob 存储服务进行 SQL Server 备份和还原</span><span class="sxs-lookup"><span data-stu-id="5c8ba-102">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>
  <span data-ttu-id="5c8ba-103">本主题介绍 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 如何从[Azure Blob 存储服务](https://www.windowsazure.com/develop/net/how-to-guides/blob-storage/)进行备份和还原。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-103">This topic introduces [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups to and restoring from the [Azure Blob storage service](https://www.windowsazure.com/develop/net/how-to-guides/blob-storage/).</span></span> <span data-ttu-id="5c8ba-104">它还汇总了使用 Azure Blob 服务存储备份的好处 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-104">It also provides a summary of the benefits of using the Azure Blob service to store [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups.</span></span>  
  
 <span data-ttu-id="5c8ba-105">SQL Server 支持通过以下方式将备份存储到 Azure Blob 存储服务：</span><span class="sxs-lookup"><span data-stu-id="5c8ba-105">SQL Server supports storing backups to the Azure Blob storage service in the following ways:</span></span>  
  
-   <span data-ttu-id="5c8ba-106">**管理你的备份到 Azure：** 使用用于备份到磁盘和磁带的相同方法，现在可以通过指定 URL 作为备份目标来备份到 Azure 存储。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-106">**Manage your backups  to Azure:** Using the same methods used to backup to DISK and TAPE, you can now back up to Azure storage by Specifying URL as the backup destination.</span></span>  <span data-ttu-id="5c8ba-107">可使用此功能手动备份或配置自己的备份策略，如同对于本地存储或其他站点外选项所做的一样。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-107">You can use this feature to manually backup or configure your own backup strategy like you would for a local storage or other off-site options.</span></span> <span data-ttu-id="5c8ba-108">此功能也称为 **SQL Server 备份到 URL**。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-108">This feature is also referred to as **SQL Server Backup to URL**.</span></span> <span data-ttu-id="5c8ba-109">有关详细信息，请参阅 [SQL Server Backup to URL](sql-server-backup-to-url.md)。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-109">For more information, see [SQL Server Backup to URL](sql-server-backup-to-url.md).</span></span> <span data-ttu-id="5c8ba-110">SQL Server 2012 SP1 CU2 或更高版本中提供此功能。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-110">This feature is available in SQL Server 2012 SP1 CU2 or later.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="5c8ba-111">对于之前 SQL Server 2014 的 SQL Server 版本，可以使用 "备份到 Azure" 工具 SQL Server 外接程序快速轻松地创建 Azure 存储备份。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-111">For SQL Server versions previous to SQL Server 2014, you can use the add-in SQL Server Backup to Azure Tool to quickly and easily create backups to Azure storage.</span></span> <span data-ttu-id="5c8ba-112">有关详细信息，请参阅 [下载中心](https://go.microsoft.com/fwlink/?LinkID=324399)。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-112">For more information, see [download center](https://go.microsoft.com/fwlink/?LinkID=324399).</span></span>  
  
-   <span data-ttu-id="5c8ba-113">**让 SQL Server 管理 Azure 的备份：** 配置 SQL Server 管理备份策略，并为单个数据库或多个数据库安排备份，或在实例级别设置默认值。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-113">**Let SQL Server Manage backups to Azure:** Configure SQL Server to manage the backup strategy and schedule backups for a single database, or several databases, or set defaults at the instance level.</span></span> <span data-ttu-id="5c8ba-114">此功能称为 **[!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)]** 。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-114">This feature is referred to as  **[!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)]**.</span></span> <span data-ttu-id="5c8ba-115">有关详细信息，请参阅[SQL Server 托管备份到 Azure](sql-server-managed-backup-to-microsoft-azure.md)。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-115">For more information see [SQL Server Managed  Backup to Azure](sql-server-managed-backup-to-microsoft-azure.md).</span></span> <span data-ttu-id="5c8ba-116">SQL Server 2014 或更高版本中提供此功能。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-116">This feature is available in SQL Server 2014 or later.</span></span>  
  
## <a name="benefits-of-using-the-azure-blob-service-for-ssnoversion-backups"></a><span data-ttu-id="5c8ba-117">使用 Azure Blob 服务进行备份的好处 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="5c8ba-117">Benefits of Using the Azure Blob Service for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Backups</span></span>  
  
-   <span data-ttu-id="5c8ba-118">灵活、可靠和无限制的站点外存储：在 Azure Blob 服务上存储备份是一种方便、灵活、易于访问的站点外选项。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-118">Flexible, reliable, and limitless off-site storage: Storing your backups on Azure Blob service can be a convenient, flexible, and easy to access off-site option.</span></span> <span data-ttu-id="5c8ba-119">为您的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 备份创建站点外存储就像修改您的现有脚本/作业一样简单。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-119">Creating off-site storage for your [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] backups can be as easy as modifying your existing scripts/jobs.</span></span> <span data-ttu-id="5c8ba-120">场外存储通常应当远离生产数据库位置，以防止某个灾难可能同时影响场外和生产数据库位置。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-120">Off-site storage should typically be far enough from the production database location to prevent a single disaster that might impact both the off-site and production database locations.</span></span> <span data-ttu-id="5c8ba-121">通过选择地理复制 Blob 存储区，您在发生可能影响整个区域的灾难时多了一层额外的保护。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-121">By choosing to geo replicate the Blob storage you have an extra layer of protection in the event of a disaster that could affect the whole region.</span></span> <span data-ttu-id="5c8ba-122">此外，备份副本随时随地可用，并可以轻松访问它们来执行还原。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-122">In addition, backups are available from anywhere and at any time and can easily be accessed for restores.</span></span>  
  
-   <span data-ttu-id="5c8ba-123">备份存档：使用 Azure Blob 存储服务可以更好地替代常用磁带选项来存档备份。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-123">Backup Archive: The Azure Blob Storage service offers a better alternative to the often used tape option to archive backups.</span></span> <span data-ttu-id="5c8ba-124">选择磁带存储时可能需要将数据实际运输到场外设施，并且需要采取一些介质保护措施。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-124">Tape storage might require physical transportation to an off-site facility and measures to protect the media.</span></span> <span data-ttu-id="5c8ba-125">在 Azure Blob 存储中存储备份可提供即时、具有高可用性且持久的存档方式。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-125">Storing your backups in Azure Blob Storage provides an instant, highly available, and a durable archiving option.</span></span>  
  
-   <span data-ttu-id="5c8ba-126">无硬件管理开销： Azure 服务没有硬件管理开销。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-126">No overhead of hardware management:There is no overhead of hardware management with Azure services.</span></span> <span data-ttu-id="5c8ba-127">Azure 服务可管理硬件并提供地域异地复制和硬件故障防护。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-127">Azure services manage the hardware and provide geo-replication for redundancy and protection against hardware failures.</span></span>  
  
-   <span data-ttu-id="5c8ba-128">当前 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，对于在 Azure 虚拟机中运行的实例，可以通过创建附加的磁盘来备份到 Azure Blob 存储服务。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-128">Currently for instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] running in an Azure Virtual Machine, backing up to Azure Blob storage services can be done by creating attached disks.</span></span> <span data-ttu-id="5c8ba-129">不过，你只能将有限数量的磁盘附加到 Azure 虚拟机。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-129">However, there is a limit to the number of disks you can attach to an Azure Virtual Machine.</span></span> <span data-ttu-id="5c8ba-130">对特大实例的限制为 16 个磁盘；对较小实例的磁盘限制数更少。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-130">This limit is 16 disks for an extra large instance and fewer for smaller instances.</span></span> <span data-ttu-id="5c8ba-131">通过直接备份到 Azure Blob 存储，你可以绕过 16 个磁盘这一限制。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-131">By enabling a direct backup to Azure Blob Storage, you can bypass the 16 disk limit.</span></span>  
  
     <span data-ttu-id="5c8ba-132">此外，存储在 Azure Blob 存储服务中的备份文件直接可用于本地 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 或 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Azure 虚拟机中运行的其他，而无需进行数据库附加/分离或者下载和附加 VHD。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-132">In addition, the backup file which now is stored in the Azure Blob storage service is directly available to either an on-premises [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] or another [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] running in an Azure Virtual Machine, without the need for database attach/detach or downloading and attaching the VHD.</span></span>  
  
-   <span data-ttu-id="5c8ba-133">成本优势：仅对使用的服务付费。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-133">Cost Benefits: Pay only for the service that is used.</span></span> <span data-ttu-id="5c8ba-134">作为场外和备份存档方式可能更加划算。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-134">Can be cost-effective as an off-site and backup archive option.</span></span> <span data-ttu-id="5c8ba-135">有关详细信息和链接，请参阅[Azure 计费注意事项](#Billing)部分。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-135">See the [Azure Billing Considerations](#Billing) section for more information and links.</span></span>  
  
##  <a name="azure-billing-considerations"></a><a name="Billing"></a><span data-ttu-id="5c8ba-136">Azure 计费注意事项：</span><span class="sxs-lookup"><span data-stu-id="5c8ba-136">Azure Billing Considerations:</span></span>  
 <span data-ttu-id="5c8ba-137">了解 Azure 存储成本使你能够预测在 Azure 中创建和存储备份的成本。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-137">Understanding Azure storage costs enables you to forecast the cost of creating and storing backups in Azure.</span></span>  
  
 <span data-ttu-id="5c8ba-138">[Azure 价格计算器](https://go.microsoft.com/fwlink/?LinkId=277060)可以帮助估算你的成本。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-138">The [Azure pricing calculator](https://go.microsoft.com/fwlink/?LinkId=277060) can help estimate your costs.</span></span>  
  
 <span data-ttu-id="5c8ba-139">**存储：** 费用基于使用的空间并根据渐变的标准和冗余级别来计算它。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-139">**Storage:** Charges are based on the space used and are calculated on a graduated scale and the level of redundancy.</span></span> <span data-ttu-id="5c8ba-140">有关详细信息和最新信息，请参阅 **定价详细信息** 文章中的[“数据管理”](https://go.microsoft.com/fwlink/?LinkId=277059) 一节。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-140">For more details, and up-to-date information, see the **Data Management** section of the [Pricing Details](https://go.microsoft.com/fwlink/?LinkId=277059) article.</span></span>  
  
 <span data-ttu-id="5c8ba-141">**数据传输：** 向 Azure 的入站数据传输是免费的。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-141">**Data Transfers:** Inbound data transfers to Azure are free.</span></span> <span data-ttu-id="5c8ba-142">出站传输要支付带宽使用费用，并根据渐变的区域特定标准来计算费用。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-142">Outbound transfers are charged for the bandwidth use and calculated based on a graduated region-specific scale.</span></span> <span data-ttu-id="5c8ba-143">有关详细信息，请参阅“定价详细信息”文章中的 [数据传输](https://go.microsoft.com/fwlink/?LinkId=277061) 一节。</span><span class="sxs-lookup"><span data-stu-id="5c8ba-143">For more details, see the [Data Transfers](https://go.microsoft.com/fwlink/?LinkId=277061) section of the Pricing Details article.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5c8ba-144">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5c8ba-144">See Also</span></span>  
 <span data-ttu-id="5c8ba-145">[SQL Server 备份到 URL 最佳实践和故障排除](sql-server-backup-to-url-best-practices-and-troubleshooting.md) </span><span class="sxs-lookup"><span data-stu-id="5c8ba-145">[SQL Server Backup to URL Best Practices and Troubleshooting](sql-server-backup-to-url-best-practices-and-troubleshooting.md) </span></span>  
 <span data-ttu-id="5c8ba-146">[备份和还原系统数据库 (SQL Server)](back-up-and-restore-of-system-databases-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="5c8ba-146">[Back Up and Restore of System Databases &#40;SQL Server&#41;](back-up-and-restore-of-system-databases-sql-server.md) </span></span>  
 <span data-ttu-id="5c8ba-147">[教程： SQL Server 备份和还原到 Azure Blob 存储服务](../tutorial-sql-server-backup-and-restore-to-azure-blob-storage-service.md) </span><span class="sxs-lookup"><span data-stu-id="5c8ba-147">[Tutorial: SQL Server Backup and Restore to Azure Blob Storage Service](../tutorial-sql-server-backup-and-restore-to-azure-blob-storage-service.md) </span></span>  
 [<span data-ttu-id="5c8ba-148">SQL Server 备份到 URL</span><span class="sxs-lookup"><span data-stu-id="5c8ba-148">SQL Server Backup to URL</span></span>](sql-server-backup-to-url.md)  
  
