---
title: 升级全文搜索 | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
helpviewer_keywords:
- full-text search [SQL Server], installing
- migrating full-text indexes [SQL Server]
- upgrading Full-Text Search
- installing Full-Text Search
- full-text search [SQL Server], upgrading
ms.assetid: 2fee4691-f2b5-472f-8ccc-fa625b654520
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: d2bdf0bdee452101bbafb8108426faf6604e7626
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588957"
---
# <a name="upgrade-full-text-search"></a><span data-ttu-id="a90c6-102">升级全文搜索</span><span class="sxs-lookup"><span data-stu-id="a90c6-102">Upgrade Full-Text Search</span></span>
  <span data-ttu-id="a90c6-103">将全文搜索升级到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 是在安装期间以及在附加、还原或使用复制数据库向导复制 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 早期版本的数据库文件和全文目录期间执行的。</span><span class="sxs-lookup"><span data-stu-id="a90c6-103">Upgrading full-text search to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is done during setup and when database files and full-text catalogs from the earlier version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are attached, restored, or copied using the Copy Database Wizard.</span></span>  
  
 <span data-ttu-id="a90c6-104">本主题讨论升级全文搜索的以下方面：</span><span class="sxs-lookup"><span data-stu-id="a90c6-104">This topic discusses the following aspects of upgrading full-text search:</span></span>  
  
-   [<span data-ttu-id="a90c6-105">升级服务器实例</span><span class="sxs-lookup"><span data-stu-id="a90c6-105">Upgrading a Server Instance</span></span>](#Upgrade_Server)  
  
-   [<span data-ttu-id="a90c6-106">全文升级选项</span><span class="sxs-lookup"><span data-stu-id="a90c6-106">Full-Text Upgrade Options</span></span>](#FT_Upgrade_Options)  
  
-   [<span data-ttu-id="a90c6-107">选择全文升级选项的注意事项</span><span class="sxs-lookup"><span data-stu-id="a90c6-107">Considerations for Choosing a Full-Text Upgrade Option</span></span>](#Choosing_Upgade_Option)  
  
-   [<span data-ttu-id="a90c6-108">将数据库升级到 SQL Server 2014 时迁移全文检索</span><span class="sxs-lookup"><span data-stu-id="a90c6-108">Migrating Full-Text Indexes When Upgrading a Database to SQL Server 2014</span></span>](#Upgrade_Db)  
  
-   [<span data-ttu-id="a90c6-109">有关将 SQL Server 2005 全文目录还原到 SQL Server 2014 的注意事项</span><span class="sxs-lookup"><span data-stu-id="a90c6-109">Considerations for Restoring a SQL Server 2005 Full-Text Catalog to SQL Server 2014</span></span>](#Considerations_for_Restore)  
  
-   [<span data-ttu-id="a90c6-110">将 SQL Server 2005 数据库附加到 SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="a90c6-110">Attaching a SQL Server 2005 database to SQL Server 2014</span></span>](#Attaching_2005_ft_catalogs)  
  
##  <a name="upgrading-a-server-instance"></a><a name="Upgrade_Server"></a><span data-ttu-id="a90c6-111">升级服务器实例</span><span class="sxs-lookup"><span data-stu-id="a90c6-111">Upgrading a Server Instance</span></span>  
 <span data-ttu-id="a90c6-112">对于就地升级， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 实例将与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的旧版本并行安装，且数据将被迁移。</span><span class="sxs-lookup"><span data-stu-id="a90c6-112">For an in-place upgrade, an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is set up side-by-side with the old version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and data is migrated.</span></span> <span data-ttu-id="a90c6-113">如果 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的旧版本安装了全文搜索，则将自动安装新版本的全文搜索。</span><span class="sxs-lookup"><span data-stu-id="a90c6-113">If the old version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] had full-text search installed, a new version of full-text search is automatically installed.</span></span> <span data-ttu-id="a90c6-114">并行安装表示 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的实例级存在下列每个组件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-114">Side-by-side install means that each of the following components exists at the instance-level of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="a90c6-115">断字符、词干分析器和筛选器</span><span class="sxs-lookup"><span data-stu-id="a90c6-115">Word breakers, stemmers, and filters</span></span>  
 <span data-ttu-id="a90c6-116">每个实例目前均使用自己的一组断字符、词干分析器和筛选器，而不受这些组件的操作系统版本的限制。</span><span class="sxs-lookup"><span data-stu-id="a90c6-116">Each instance now uses its own set of word breakers, stemmers, and filters, rather than relying on the operating system version of these components.</span></span> <span data-ttu-id="a90c6-117">而且，这些组件在各个实例级也很容易注册和配置。</span><span class="sxs-lookup"><span data-stu-id="a90c6-117">These components are also easier to register and configure at a per-instance level.</span></span> <span data-ttu-id="a90c6-118">有关详细信息，请参阅 [配置和管理断字符和词干分析器以便搜索](configure-and-manage-word-breakers-and-stemmers-for-search.md) 和 [配置和管理搜索筛选器](configure-and-manage-filters-for-search.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-118">For more information, see [Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md) and [Configure and Manage Filters for Search](configure-and-manage-filters-for-search.md).</span></span>  
  
 <span data-ttu-id="a90c6-119">筛选器后台程序宿主</span><span class="sxs-lookup"><span data-stu-id="a90c6-119">Filter daemon host</span></span>  
 <span data-ttu-id="a90c6-120">全文筛选器后台程序宿主进程可以安全地加载和驱动用于索引和查询的可扩展外部组件（例如断字符、词干分析器和筛选器），而不会损害全文引擎的完整性。</span><span class="sxs-lookup"><span data-stu-id="a90c6-120">The full-text filter daemon hosts are processes that safely load and drive extensible external components used for index and query, such as word breakers, stemmers, and filters, without compromising the integrity of the Full-Text Engine.</span></span> <span data-ttu-id="a90c6-121">服务器实例对所有多线程筛选器使用多线程进程，并对所有单线程筛选器使用单线程进程。</span><span class="sxs-lookup"><span data-stu-id="a90c6-121">A server instance uses a multithreaded process for all multithreaded filters and a single-threaded process for all single-threaded filters.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] <span data-ttu-id="a90c6-122">引入了 FDHOST Launcher 服务 (MSSQLFDLauncher) 的服务帐户。</span><span class="sxs-lookup"><span data-stu-id="a90c6-122">introduced a service account for the FDHOST Launcher service (MSSQLFDLauncher).</span></span> <span data-ttu-id="a90c6-123">该服务将服务帐户信息传播到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]特定实例的筛选器后台程序宿主进程。</span><span class="sxs-lookup"><span data-stu-id="a90c6-123">This service propagates the service account information to the filter daemon host processes of a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a90c6-124">有关设置服务帐户的信息，请参阅 [设置用于全文筛选器后台程序启动器的服务帐户](set-the-service-account-for-the-full-text-filter-daemon-launcher.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-124">For information about setting the service account, see [Set the Service Account for the Full-text Filter Daemon Launcher](set-the-service-account-for-the-full-text-filter-daemon-launcher.md).</span></span>  
  
 <span data-ttu-id="a90c6-125">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中，每个全文检索都驻留在属于文件组的全文目录中，它们均具有物理路径，并被视为数据库文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-125">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], each full-text index resides in a full-text catalog that belongs to a filegroup, has a physical path, and is treated as a database file.</span></span> <span data-ttu-id="a90c6-126">在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 及更高版本中，全文目录是一个包含一组全文检索的逻辑对象或虚拟对象。</span><span class="sxs-lookup"><span data-stu-id="a90c6-126">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions, a full-text catalog is a logical or virtual object that contains a group of full-text indexes.</span></span> <span data-ttu-id="a90c6-127">因此，新的全文目录不会视为带有物理路径的数据库文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-127">Therefore, a new full-text catalog is not treated as a database file with a physical path.</span></span> <span data-ttu-id="a90c6-128">但是，在升级包含数据文件的所有全文目录期间，将在相同磁盘上创建新的文件组。</span><span class="sxs-lookup"><span data-stu-id="a90c6-128">However, during upgrade of any full-text catalog that contains data files, a new filegroup is created on same disk.</span></span> <span data-ttu-id="a90c6-129">这可以在升级后维护旧磁盘的 I/O 行为。</span><span class="sxs-lookup"><span data-stu-id="a90c6-129">This maintains the old disk I/O behavior after upgrade.</span></span> <span data-ttu-id="a90c6-130">该目录的所有全文检索均被放置到新的文件组中（如果存在根路径）。</span><span class="sxs-lookup"><span data-stu-id="a90c6-130">Any full-text index from that catalog is placed in the new filegroup if the root path exists.</span></span> <span data-ttu-id="a90c6-131">如果旧的全文目录路径无效，升级过程将全文检索保留在与基表相同的文件组中，或者对于分区表，则保留在主文件组中。</span><span class="sxs-lookup"><span data-stu-id="a90c6-131">If the old full-text catalog path is invalid, the upgrade keeps the full-text index in the same filegroup as the base table or, for a partitioned table, in the primary filegroup.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="a90c6-132">[!INCLUDE[tsql](../../includes/tsql-md.md)]指定全文目录的 DDL 语句可继续正常工作。</span><span class="sxs-lookup"><span data-stu-id="a90c6-132">[!INCLUDE[tsql](../../includes/tsql-md.md)] DDL statements that specify full-text catalogs continue to work correctly.</span></span>  
  
##  <a name="full-text-upgrade-options"></a><a name="FT_Upgrade_Options"></a><span data-ttu-id="a90c6-133">全文升级选项</span><span class="sxs-lookup"><span data-stu-id="a90c6-133">Full-Text Upgrade Options</span></span>  
 <span data-ttu-id="a90c6-134">将服务器实例升级到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]时，您可以通过用户界面选择以下全文升级选项之一。</span><span class="sxs-lookup"><span data-stu-id="a90c6-134">When upgrading a server instance to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the user interface allows you to choose one of the following full-text upgrade options.</span></span>  
  
 <span data-ttu-id="a90c6-135">导入</span><span class="sxs-lookup"><span data-stu-id="a90c6-135">Import</span></span>  
 <span data-ttu-id="a90c6-136">导入全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-136">Full-text catalogs are imported.</span></span> <span data-ttu-id="a90c6-137">一般情况下，导入速度比重新生成速度要快很多。</span><span class="sxs-lookup"><span data-stu-id="a90c6-137">Typically, import is significantly faster than rebuild.</span></span> <span data-ttu-id="a90c6-138">例如，当仅使用一个 CPU 时，导入的运行速度比重新生成要快 10 倍左右。</span><span class="sxs-lookup"><span data-stu-id="a90c6-138">For example, when using only one CPU, import runs about 10 times faster than rebuild.</span></span> <span data-ttu-id="a90c6-139">不过，导入的全文目录不能使用随 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的最新版本安装的新断字符。</span><span class="sxs-lookup"><span data-stu-id="a90c6-139">However, an imported full-text catalog does not use the new word breakers installed with the latest version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="a90c6-140">若要确保查询结果的一致性，必须重新生成全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-140">To ensure consistency in query results, full-text catalogs have to be rebuilt.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a90c6-141">重新生成可以以多线程模式运行，如果可用的 CPU 在 10 个以上，且您允许重新生成操作使用所有这些 CPU，则重新生成操作的运行速度可能比导入更快。</span><span class="sxs-lookup"><span data-stu-id="a90c6-141">Rebuild can run in multi-threaded mode, and if more than 10 CPUs are available, rebuild might run faster than import if you allow rebuild to use all of the CPUs.</span></span>  
  
 <span data-ttu-id="a90c6-142">如果全文目录不可用，则会重新生成关联的全文检索。</span><span class="sxs-lookup"><span data-stu-id="a90c6-142">If a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span> <span data-ttu-id="a90c6-143">此选项仅对 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库可用。</span><span class="sxs-lookup"><span data-stu-id="a90c6-143">This option is available for only [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] databases.</span></span>  
  
 <span data-ttu-id="a90c6-144">有关导入全文检索的影响的信息，请参阅本主题后面的“有关选择全文升级选项的注意事项”。</span><span class="sxs-lookup"><span data-stu-id="a90c6-144">For information about the impact of importing full-text index, see "Considerations for Choosing a Full-Text Upgrade Option," later in this topic.</span></span>  
  
 <span data-ttu-id="a90c6-145">重新生成</span><span class="sxs-lookup"><span data-stu-id="a90c6-145">Rebuild</span></span>  
 <span data-ttu-id="a90c6-146">使用新的和增强的断字符重新生成全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-146">Full-text catalogs are rebuilt using the new and enhanced word breakers.</span></span> <span data-ttu-id="a90c6-147">重新生成索引可能需要一些时间，且升级后可能需要占用大量的 CPU 和内存。</span><span class="sxs-lookup"><span data-stu-id="a90c6-147">Rebuilding indexes can take a while, and a significant amount of CPU and memory might be required after the upgrade.</span></span>  
  
 <span data-ttu-id="a90c6-148">重置</span><span class="sxs-lookup"><span data-stu-id="a90c6-148">Reset</span></span>  
 <span data-ttu-id="a90c6-149">重置全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-149">Full-text catalogs are reset.</span></span> <span data-ttu-id="a90c6-150">从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]升级时，将删除全文目录文件，但会保留全文目录和全文检索的元数据。</span><span class="sxs-lookup"><span data-stu-id="a90c6-150">When upgrading from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], full-text catalog files are removed, but the metadata for full-text catalogs and full-text indexes is retained.</span></span> <span data-ttu-id="a90c6-151">在进行升级后，所有全文检索将禁用更改跟踪，并且不会自动启动爬网。</span><span class="sxs-lookup"><span data-stu-id="a90c6-151">After being upgraded, all full-text indexes are disabled for change tracking and crawls are not started automatically.</span></span> <span data-ttu-id="a90c6-152">在升级完成后，目录将保留为空，直至手动执行完全填充。</span><span class="sxs-lookup"><span data-stu-id="a90c6-152">The catalog will remain empty until you manually issue a full population, after the upgrade completes.</span></span>  
  
##  <a name="considerations-for-choosing-a-full-text-upgrade-option"></a><a name="Choosing_Upgade_Option"></a><span data-ttu-id="a90c6-153">选择全文升级选项的注意事项</span><span class="sxs-lookup"><span data-stu-id="a90c6-153">Considerations for Choosing a Full-Text Upgrade Option</span></span>  
 <span data-ttu-id="a90c6-154">为升级选择升级选项时，请考虑以下几点：</span><span class="sxs-lookup"><span data-stu-id="a90c6-154">When choosing the upgrade option for your upgrade, consider the following:</span></span>  
  
-   <span data-ttu-id="a90c6-155">需要查询结果的一致性吗？</span><span class="sxs-lookup"><span data-stu-id="a90c6-155">Do you require consistency in query results?</span></span>  
  
     [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="a90c6-156">将安装新的断字符以供全文和语义搜索使用。</span><span class="sxs-lookup"><span data-stu-id="a90c6-156">installs new word breakers for use by Full-Text and Semantic Search.</span></span> <span data-ttu-id="a90c6-157">在建立索引时和查询时均使用断字符。</span><span class="sxs-lookup"><span data-stu-id="a90c6-157">The word breakers are used both at indexing time and at query time.</span></span> <span data-ttu-id="a90c6-158">如果您没有重新生成全文目录，搜索结果可能不一致。</span><span class="sxs-lookup"><span data-stu-id="a90c6-158">If you do not rebuild the full-text catalogs, your search results may be inconsistent.</span></span> <span data-ttu-id="a90c6-159">如果您发出查找某一短语的全文查询和当前断字符，该短语是由以前的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 版本中的断字符以不同方式进行断字的，则可能不会检索包含该短语的文档或行。</span><span class="sxs-lookup"><span data-stu-id="a90c6-159">If you issue a full-text query that looks for a phrase that is broken differently by the word breaker in a previous version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current word breaker, a document or row containing the phrase might not be retrieved.</span></span> <span data-ttu-id="a90c6-160">其原因在于，建立了索引的短语是使用与正使用的查询不同的逻辑进行断字的。</span><span class="sxs-lookup"><span data-stu-id="a90c6-160">This is because the indexed phrases were broken using different logic than the query is using.</span></span> <span data-ttu-id="a90c6-161">解决方法是使用新的断字符来重新填充（重新生成）全文目录，以便索引时行为和查询时行为完全相同。</span><span class="sxs-lookup"><span data-stu-id="a90c6-161">The solution is to repopulate (rebuild) the full-text catalogs with the new word breakers so that index time and query time behavior are identical.</span></span> <span data-ttu-id="a90c6-162">可以选择“重新生成”选项来完成此操作，也可以在选择“导入”选项后手动重新生成。</span><span class="sxs-lookup"><span data-stu-id="a90c6-162">You can choose the Rebuild option to accomplish this, or you can rebuild manually after choosing the Import option.</span></span>  
  
-   <span data-ttu-id="a90c6-163">是否基于整数全文键列生成了任何全文检索？</span><span class="sxs-lookup"><span data-stu-id="a90c6-163">Were any full-text indexes built on integer full-text key columns?</span></span>  
  
     <span data-ttu-id="a90c6-164">重新生成执行内部优化，在某些情况下该优化可提高升级的全文检索的查询性能。</span><span class="sxs-lookup"><span data-stu-id="a90c6-164">Rebuilding performs internal optimizations that improve the query performance of the upgraded full-text index in some cases.</span></span> <span data-ttu-id="a90c6-165">具体来说，如果您具有的全文目录包含基表的全文键列为整数数据类型的全文检索，则重新生成将在升级后实现全文查询的理想性能。</span><span class="sxs-lookup"><span data-stu-id="a90c6-165">Specifically, if you have full-text catalogs that contain full-text indexes for which the full-text key column of the base table is an integer data type, rebuilding achieves ideal performance of full-text queries after upgrade.</span></span> <span data-ttu-id="a90c6-166">在这种情况下，我们强烈建议使用 **“重新生成”** 选项。</span><span class="sxs-lookup"><span data-stu-id="a90c6-166">In this case, we highly recommend you to use the **Rebuild** option.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a90c6-167">对于 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中的全文索引，建议采用整数数据类型作为全文键列。</span><span class="sxs-lookup"><span data-stu-id="a90c6-167">For full-text indexes in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], we recommend that the column serving as the full-text key be an integer data type.</span></span> <span data-ttu-id="a90c6-168">有关详细信息，请参阅 [改进全文索引的性能](improve-the-performance-of-full-text-indexes.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-168">For more information, see [Improve the Performance of Full-Text Indexes](improve-the-performance-of-full-text-indexes.md).</span></span>  
  
-   <span data-ttu-id="a90c6-169">使服务器实例处于联机状态的优先级是什么？</span><span class="sxs-lookup"><span data-stu-id="a90c6-169">What is the priority for getting your server instance online?</span></span>  
  
     <span data-ttu-id="a90c6-170">升级期间的导入或重新生成操作会占用很多 CPU 资源，这会延迟其余服务器实例的升级和联机。</span><span class="sxs-lookup"><span data-stu-id="a90c6-170">Importing or rebuilding during upgrade takes a lot of CPU resources, which delays getting the rest of the server instance upgraded and online.</span></span> <span data-ttu-id="a90c6-171">如果使服务器实例尽快处于联机状态非常重要，并且希望在升级后运行手动填充，则适合 **“重置”** 。</span><span class="sxs-lookup"><span data-stu-id="a90c6-171">If getting the server instance online as soon as possible is important and if you are willing to run a manual population after the upgrade, **Reset** is suitable.</span></span>  
  
## <a name="ensuring-consistent-query-results-after-importing-a-sql-server-2005-full-text-index"></a><span data-ttu-id="a90c6-172">导入 SQL Server 2005 全文检索后确保一致的查询结果</span><span class="sxs-lookup"><span data-stu-id="a90c6-172">Ensuring Consistent Query Results after Importing a SQL Server 2005 Full-Text Index</span></span>  
 <span data-ttu-id="a90c6-173">如果在将 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库升级到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]时导入了全文目录，则由于旧断字符和新断字符的行为略有差异，可能会出现查询和全文检索内容不匹配。</span><span class="sxs-lookup"><span data-stu-id="a90c6-173">If a full-text catalog was imported when upgrading a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], mismatches between the query and the full-text index content might occur because of differences in the behavior of the old and new word breakers.</span></span> <span data-ttu-id="a90c6-174">在这种情况下，若要保证查询和全文检索内容之间的完全匹配，请选择以下选项之一：</span><span class="sxs-lookup"><span data-stu-id="a90c6-174">In this case, to guarantee a total match between queries and the full-text index content, choose one of the following options:</span></span>  
  
-   <span data-ttu-id="a90c6-175">重新生成包含全文检索的全文目录 ([ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)*catalog_name* REBUILD)</span><span class="sxs-lookup"><span data-stu-id="a90c6-175">Rebuild the full-text catalog that contains the full-text index ([ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)*catalog_name* REBUILD)</span></span>  
  
-   <span data-ttu-id="a90c6-176">对全文检索执行 FULL POPULATION ([ALTER FULLTEXT INDEX](/sql/t-sql/statements/alter-fulltext-index-transact-sql) ON *table_name* START FULL POPULATION)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-176">Issue a FULL POPULATION on the full-text index ([ALTER FULLTEXT INDEX](/sql/t-sql/statements/alter-fulltext-index-transact-sql) ON *table_name* START FULL POPULATION).</span></span>  
  
 <span data-ttu-id="a90c6-177">有关断字符的详细信息，请参阅 [配置和管理断字符和词干分析器以便搜索](configure-and-manage-word-breakers-and-stemmers-for-search.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-177">For more information about word breakers, see [Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md).</span></span>  
  
## <a name="upgrading-noise-word-files-to-stoplists"></a><span data-ttu-id="a90c6-178">将干扰词文件升级到非索引字表</span><span class="sxs-lookup"><span data-stu-id="a90c6-178">Upgrading Noise-Word Files to Stoplists</span></span>  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] <span data-ttu-id="a90c6-179">干扰词已替换为 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 及更高版本中的非索引字。</span><span class="sxs-lookup"><span data-stu-id="a90c6-179">noise words have been replaced by stopwords in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions.</span></span> <span data-ttu-id="a90c6-180">将数据库从 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 升级到 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]后，将不再使用干扰词文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-180">When a database is upgraded to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the noise-word files are no longer used.</span></span> <span data-ttu-id="a90c6-181">然而，旧的干扰词文件存储在 FTDATA\ FTNoiseThesaurusBak 文件夹中，您可以稍后在更新或生成相应的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 非索引字表时使用它们。</span><span class="sxs-lookup"><span data-stu-id="a90c6-181">However, the old noise-word files are stored in the FTDATA\ FTNoiseThesaurusBak folder, and you can use them later when updating or building the corresponding [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] stoplists.</span></span>  
  
 <span data-ttu-id="a90c6-182">从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]升级后：</span><span class="sxs-lookup"><span data-stu-id="a90c6-182">After upgrading from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]:</span></span>  
  
-   <span data-ttu-id="a90c6-183">如果您在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]安装中从未添加、修改或删除过任何干扰词文件，则该系统非索引字表应该可以满足您的需要。</span><span class="sxs-lookup"><span data-stu-id="a90c6-183">If you never added, modified, or deleted any noise-word files in your installation of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the system stoplist should meet your needs.</span></span>  
  
-   <span data-ttu-id="a90c6-184">如果在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中修改过干扰词文件，则这些修改在升级期间将会丢失。</span><span class="sxs-lookup"><span data-stu-id="a90c6-184">If your noise-word files were modified in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], those modifications are lost during upgrade.</span></span> <span data-ttu-id="a90c6-185">若要重新创建这些更新，必须在对应的 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 非索引字表中手动重新创建这些修改。</span><span class="sxs-lookup"><span data-stu-id="a90c6-185">To re-create those updates, you must manually recreate those modifications in the corresponding [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] stoplist.</span></span> <span data-ttu-id="a90c6-186">有关详细信息，请参阅 [ALTER FULLTEXT STOPLIST (Transact-SQL)](/sql/t-sql/statements/alter-fulltext-stoplist-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-186">For more information, see [ALTER FULLTEXT STOPLIST &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-fulltext-stoplist-transact-sql).</span></span>  
  
-   <span data-ttu-id="a90c6-187">如果不希望将任何非索引字应用于全文检索（例如，如果您在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 安装中删除或清除过干扰词文件），则必须关闭每个已升级的全文检索的非索引字表。</span><span class="sxs-lookup"><span data-stu-id="a90c6-187">If you do not want to apply any stopwords to your full-text indexes (for example, if you deleted or erased your noise-word files in your [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] installation), you must turn off the stoplist for each upgraded full-text index.</span></span> <span data-ttu-id="a90c6-188">请运行以下 [!INCLUDE[tsql](../../includes/tsql-md.md)] 语句（将 *database* 替换为已升级的数据库的名称，并将 *table* 替换为 *table*的名称）：</span><span class="sxs-lookup"><span data-stu-id="a90c6-188">Run the following [!INCLUDE[tsql](../../includes/tsql-md.md)] statement (replacing *database* with the name of the upgraded database and *table* with the name of the *table*):</span></span>  
  
    ```  
    Use database;   
    ALTER FULLTEXT INDEX ON table  
       SET STOPLIST OFF;  
    GO  
    ```  
  
     <span data-ttu-id="a90c6-189">STOPLIST OFF 子句删除非索引字筛选，并触发对表的填充，而不会筛选任何视为干扰词的词语。</span><span class="sxs-lookup"><span data-stu-id="a90c6-189">The STOPLIST OFF clause removes stop-word filtering, and it will trigger a population of the table, without filtering any words considered to be noise.</span></span>  
  
## <a name="backup-and-imported-full-text-catalogs"></a><span data-ttu-id="a90c6-190">备份和导入全文目录</span><span class="sxs-lookup"><span data-stu-id="a90c6-190">Backup and Imported Full-Text Catalogs</span></span>  
 <span data-ttu-id="a90c6-191">对于在升级期间重新生成或重置的全文目录（以及对于新的全文目录），全文目录只是一个逻辑概念，并不驻留在文件组中。</span><span class="sxs-lookup"><span data-stu-id="a90c6-191">For full-text catalogs that are rebuilt or reset during upgrade (and for new full-text catalogs), the fulltext catalog is a logical concept and does not reside in a filegroup.</span></span> <span data-ttu-id="a90c6-192">因此，若要备份 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中的全文目录，必须逐个识别包含目录全文检索的每个文件组并将它们一一备份。</span><span class="sxs-lookup"><span data-stu-id="a90c6-192">Therefore, to back up a full-text catalog in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you must identify every filegroup that contains a full-text index of the catalog and back each of them up, one by one.</span></span> <span data-ttu-id="a90c6-193">有关详细信息，请参阅 [备份和还原全文目录和索引](back-up-and-restore-full-text-catalogs-and-indexes.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-193">For more information, see [Back Up and Restore Full-Text Catalogs and Indexes](back-up-and-restore-full-text-catalogs-and-indexes.md).</span></span>  
  
 <span data-ttu-id="a90c6-194">对于从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]导入的全文目录，该全文目录在其自己的文件组中仍然是数据库文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-194">For full-text catalogs that have been imported from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the full-text catalog is still a database file in its own filegroup.</span></span> <span data-ttu-id="a90c6-195">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 中除不存在 MSFTESQL 服务以外，全文目录的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]备份进程仍然适用。</span><span class="sxs-lookup"><span data-stu-id="a90c6-195">The [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] backup process for full-text catalogs still applies except that the MSFTESQL service does not exist in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="a90c6-196">有关 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 进程的信息，请参阅 SQL Server 2005 联机丛书中的 [备份和还原全文目录](https://go.microsoft.com/fwlink/?LinkId=209154) 。</span><span class="sxs-lookup"><span data-stu-id="a90c6-196">For information about the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] process, see [Backing Up and Restoring Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=209154) in SQL Server 2005 Books Online.</span></span>  
  
##  <a name="migrating-full-text-indexes-when-upgrading-a-database-to-sscurrent"></a><a name="Upgrade_Db"></a><span data-ttu-id="a90c6-197">将数据库升级到时迁移全文索引[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a90c6-197">Migrating Full-Text Indexes When Upgrading a Database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="a90c6-198">使用附加、还原或复制数据库向导可以将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 早期版本中的数据库文件和全文目录升级到现有 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 服务器实例。</span><span class="sxs-lookup"><span data-stu-id="a90c6-198">Database files and full-text catalogs from a previous version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be upgraded to an existing [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance by using attach, restore, or the Copy Database Wizard.</span></span> [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] <span data-ttu-id="a90c6-199">导入、重置或重新生成全文检索（如果有）。</span><span class="sxs-lookup"><span data-stu-id="a90c6-199">full-text indexes, if any, are either imported, reset, or rebuilt.</span></span> <span data-ttu-id="a90c6-200">**upgrade_option** 服务器属性控制在升级这些数据库期间服务器实例使用哪个全文升级选项。</span><span class="sxs-lookup"><span data-stu-id="a90c6-200">The **upgrade_option** server property controls which full-text upgrade option the server instance uses during these database upgrades.</span></span>  
  
 <span data-ttu-id="a90c6-201">将任何 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库附加、还原或复制到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]后，该数据库将立即变为可用，然后自动进行升级。</span><span class="sxs-lookup"><span data-stu-id="a90c6-201">After you attach, restore, or copy any [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the database becomes available immediately and is then automatically upgraded.</span></span> <span data-ttu-id="a90c6-202">导入可能需要数小时，而重新生成所需的时间最多时可能十倍于此，具体取决于要编制索引的数据量。</span><span class="sxs-lookup"><span data-stu-id="a90c6-202">Depending the amount of data being indexed, importing can take several hours, and rebuilding can take up to ten times longer.</span></span> <span data-ttu-id="a90c6-203">另请注意，将升级选项设置为“导入”时，如果全文目录不可用，则会重新生成关联的全文检索。</span><span class="sxs-lookup"><span data-stu-id="a90c6-203">Note also that when the upgrade option is set to import, if a full-text catalog is not available, the associated full-text indexes are rebuilt.</span></span>  
  
 <span data-ttu-id="a90c6-204">**更改服务器实例的全文升级行为**</span><span class="sxs-lookup"><span data-stu-id="a90c6-204">**To change full-text upgrade behavior on a server instance**</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)]<span data-ttu-id="a90c6-205">使用 [sp\_fulltext\_service](/sql/relational-databases/system-stored-procedures/sp-fulltext-service-transact-sql) 的 **upgrade\_option** 操作</span><span class="sxs-lookup"><span data-stu-id="a90c6-205">: Use the **upgrade\_option** action of [sp\_fulltext\_service](/sql/relational-databases/system-stored-procedures/sp-fulltext-service-transact-sql)</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="a90c6-206">**：** 使用“服务器属性”\*\*\*\* 对话框的“全文升级选项”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="a90c6-206">**:** Use the **Full-Text Upgrade Option** of the **Server Properties** dialog box.</span></span> <span data-ttu-id="a90c6-207">有关详细信息，请参阅 [管理和监视服务器实例的全文搜索](manage-and-monitor-full-text-search-for-a-server-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-207">For more information, see [Manage and Monitor Full-Text Search for a Server Instance](manage-and-monitor-full-text-search-for-a-server-instance.md).</span></span>  
  
##  <a name="considerations-for-restoring-a-ssversion2005-full-text-catalog-to-sscurrent"></a><a name="Considerations_for_Restore"></a> <span data-ttu-id="a90c6-208">有关将 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文目录还原到 的注意事项 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a90c6-208">Considerations for Restoring a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] Full-Text Catalog to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="a90c6-209">将全文数据从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库升级到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 的其中一种方法是将完整数据库备份还原到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a90c6-209">One method of upgrading fulltext data from a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is to restore a full database backup to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="a90c6-210">导入 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文目录时，您可以备份和还原数据库和目录文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-210">While importing a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] full-text catalog, you can back up and restore the database and the catalog file.</span></span> <span data-ttu-id="a90c6-211">其行为与 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中相同：</span><span class="sxs-lookup"><span data-stu-id="a90c6-211">The behavior is the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]:</span></span>  
  
-   <span data-ttu-id="a90c6-212">完整数据库备份将包括全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-212">The full database backup will include the full-text catalog.</span></span> <span data-ttu-id="a90c6-213">若要引用全文目录，请使用其 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 文件名，即 sysft_+*catalog-name*。</span><span class="sxs-lookup"><span data-stu-id="a90c6-213">To refer to the full-text catalog, use its [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] file name, sysft_+*catalog-name*.</span></span>  
  
-   <span data-ttu-id="a90c6-214">如果全文目录处于脱机状态，备份将失败。</span><span class="sxs-lookup"><span data-stu-id="a90c6-214">If the full-text catalog is offline, the backup will fail.</span></span>  
  
 <span data-ttu-id="a90c6-215">有关备份和还原 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 全文目录的详细信息，请参阅 联机丛书中的 [备份和还原全文目录](https://go.microsoft.com/fwlink/?LinkId=121052) 和 [文件备份和还原和全文目录](https://go.microsoft.com/fwlink/?LinkId=121053)[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="a90c6-215">For more information about backing up and restoring [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] full-text catalogs, see [Backing Up and Restoring Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=121052) and [File Backup and Restore and Full-Text Catalogs](https://go.microsoft.com/fwlink/?LinkId=121053)in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] Books Online.</span></span>  
  
 <span data-ttu-id="a90c6-216">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]上还原数据库时，将为全文目录创建新的数据库文件。</span><span class="sxs-lookup"><span data-stu-id="a90c6-216">When the database is restored on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], a new database file will be created for the full-text catalog.</span></span> <span data-ttu-id="a90c6-217">该文件的默认名称是 ftrow_*catalog-name*.ndf。</span><span class="sxs-lookup"><span data-stu-id="a90c6-217">The default name of this file is ftrow_*catalog-name*.ndf.</span></span> <span data-ttu-id="a90c6-218">例如，如果 *catalog-name* 是 `cat1`， [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 数据库文件的默认名称则为 `ftrow_cat1.ndf`。</span><span class="sxs-lookup"><span data-stu-id="a90c6-218">For example, if you *catalog-name* is `cat1`, the default name of the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] database file would be `ftrow_cat1.ndf`.</span></span> <span data-ttu-id="a90c6-219">但是，如果目标目录中已使用了默认名称，则新的数据库文件将命名为 `ftrow_` *目录名称* `{` *guid* `}.ndf` ，其中*GUID*是新文件的全局唯一标识符。</span><span class="sxs-lookup"><span data-stu-id="a90c6-219">But if the default name is already being used in the target directory, the new database file would be named `ftrow_`*catalog-name*`{`*GUID*`}.ndf`, where *GUID* is the Globally Unique Identifier of the new file.</span></span>  
  
 <span data-ttu-id="a90c6-220">导入目录后， **sys.database_files** 和 **sys.master_files**经过更新以删除目录项且 **sys.fulltext_catalogs** 中的 **path** 列设置为 NULL。</span><span class="sxs-lookup"><span data-stu-id="a90c6-220">After the catalogs have been imported, the **sys.database_files** and **sys.master_file**s are updated to remove the catalog entries and the **path** column in **sys.fulltext_catalogs** is set to NULL.</span></span>  
  
 <span data-ttu-id="a90c6-221">**备份数据库**</span><span class="sxs-lookup"><span data-stu-id="a90c6-221">**To back up a database**</span></span>  
  
-   [<span data-ttu-id="a90c6-222">完整数据库备份 (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="a90c6-222">Full Database Backups &#40;SQL Server&#41;</span></span>](../backup-restore/full-database-backups-sql-server.md)  
  
-   <span data-ttu-id="a90c6-223">[事务日志备份 (SQL Server)](../backup-restore/transaction-log-backups-sql-server.md)。（仅限于完整恢复模式）</span><span class="sxs-lookup"><span data-stu-id="a90c6-223">[Transaction Log Backups &#40;SQL Server&#41;](../backup-restore/transaction-log-backups-sql-server.md) (full recovery model only)</span></span>  
  
 <span data-ttu-id="a90c6-224">**还原数据库备份**</span><span class="sxs-lookup"><span data-stu-id="a90c6-224">**To restore a database backup**</span></span>  
  
-   [<span data-ttu-id="a90c6-225">完整数据库还原（简单恢复模式）</span><span class="sxs-lookup"><span data-stu-id="a90c6-225">Complete Database Restores &#40;Simple Recovery Model&#41;</span></span>](../backup-restore/complete-database-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="a90c6-226">完整数据库还原（完整恢复模式）</span><span class="sxs-lookup"><span data-stu-id="a90c6-226">Complete Database Restores &#40;Full Recovery Model&#41;</span></span>](../backup-restore/complete-database-restores-full-recovery-model.md)  
  
### <a name="example"></a><span data-ttu-id="a90c6-227">示例</span><span class="sxs-lookup"><span data-stu-id="a90c6-227">Example</span></span>  
 <span data-ttu-id="a90c6-228">以下示例在 [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) 语句中使用 MOVE 子句，还原名为 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 的 `ftdb1`数据库。</span><span class="sxs-lookup"><span data-stu-id="a90c6-228">The following example uses the MOVE clause in the [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) statement, to restore a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database named `ftdb1`.</span></span> <span data-ttu-id="a90c6-229">[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库、日志和目录文件将被移动到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 服务器实例上的新位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="a90c6-229">The [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database, log, and catalog files are moved to new locations on the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, as follows:</span></span>  
  
-   <span data-ttu-id="a90c6-230">数据库文件 `ftdb1.mdf`移动到 `C:\Program Files\Microsoft SQL Server\MSSQL.1MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf`。</span><span class="sxs-lookup"><span data-stu-id="a90c6-230">The database file, `ftdb1.mdf`, is moved to `C:\Program Files\Microsoft SQL Server\MSSQL.1MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf`.</span></span>  
  
-   <span data-ttu-id="a90c6-231">日志文件 `ftdb1_log.ldf` 移动到日志磁盘驱动器上的日志目录中， *log_drive* `:\` *log_directory* `\ftdb1_log.ldf` 。</span><span class="sxs-lookup"><span data-stu-id="a90c6-231">The log file, `ftdb1_log.ldf`, is moved to a log directory on your log disk drive, *log_drive*`:\`*log_directory*`\ftdb1_log.ldf`.</span></span>  
  
-   <span data-ttu-id="a90c6-232">与 `sysft_cat90` 目录对应的目录文件移动到 `C:\temp`。</span><span class="sxs-lookup"><span data-stu-id="a90c6-232">The catalog files that correspond to the `sysft_cat90` catalog are moved to `C:\temp`.</span></span> <span data-ttu-id="a90c6-233">导入全文索引后，它们将自动放置在数据库文件 C:\ftrow_sysft_cat90.ndf 中，并删除 C:\temp。</span><span class="sxs-lookup"><span data-stu-id="a90c6-233">After the full-text indexes are imported, they will automatically be placed in a database file, C:\ftrow_sysft_cat90.ndf, and the C:\temp will be deleted.</span></span>  
  
```  
RESTORE DATABASE [ftdb1] FROM  DISK = N'C:\temp\ftdb1.bak' WITH  FILE = 1,  
   MOVE N'ftdb1' TO N'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\ftdb1.mdf',  
    MOVE N'ftdb1_log' TO N'log_drive:\log_directory\ftdb1_log.ldf',  
    MOVE N'sysft_cat90' TO N'C:\temp';  
```  
  
##  <a name="attaching-a-sql-server-2005-database-to-sscurrent"></a><a name="Attaching_2005_ft_catalogs"></a><span data-ttu-id="a90c6-234">将 SQL Server 2005 数据库附加到[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a90c6-234">Attaching a SQL Server 2005 Database to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]</span></span>  
 <span data-ttu-id="a90c6-235">在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 及更高版本中，全文目录是表示一组全文检索的逻辑概念。</span><span class="sxs-lookup"><span data-stu-id="a90c6-235">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later versions, a full-text catalog is a logical concept that refers to a group of full-text indexes.</span></span> <span data-ttu-id="a90c6-236">全文目录是虚拟对象，不属于任何文件组。</span><span class="sxs-lookup"><span data-stu-id="a90c6-236">The full-text catalog is a virtual object that does not belong to any filegroup.</span></span> <span data-ttu-id="a90c6-237">但是，将包含全文目录文件的 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 数据库附加到 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 服务器实例时，会将目录文件从其先前位置与其他数据库文件一起附加，这与 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]中相同。</span><span class="sxs-lookup"><span data-stu-id="a90c6-237">However, when you attach a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] database that contains full-text catalog files onto a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, the catalog files are attached from their previous location along with the other database files, the same as in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="a90c6-238">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 中附加的每个全文目录的状态与从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]分离数据库时相同。</span><span class="sxs-lookup"><span data-stu-id="a90c6-238">The state of each attached full-text catalog on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] is the same as when the database was detached from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="a90c6-239">如果分离操作挂起任意全文检索填充，该填充将在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]上恢复，全文检索随后即可用于全文搜索。</span><span class="sxs-lookup"><span data-stu-id="a90c6-239">If any full-text index population was suspended by the detach operation, the population is resumed on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], and the full-text index becomes available for full-text search.</span></span>  
  
 <span data-ttu-id="a90c6-240">如果 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 找不到全文目录文件，或者在未指定新位置的情况下在附加操作期间移动全文文件，行为则取决于选择的全文升级选项。</span><span class="sxs-lookup"><span data-stu-id="a90c6-240">If [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] cannot find a full-text catalog file or if the full-text file was moved during the attach operation without specifying a new location, the behavior depends on the selected full-text upgrade option.</span></span> <span data-ttu-id="a90c6-241">如果全文升级选项为“导入”\*\*\*\* 或“重新生成”\*\*\*\*，则重新生成附加的全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-241">If the full-text upgrade option is **Import** or **Rebuild**, the attached full-text catalog is rebuilt.</span></span> <span data-ttu-id="a90c6-242">如果全文升级选项为“重置”\*\*\*\*，则重置附加的全文目录。</span><span class="sxs-lookup"><span data-stu-id="a90c6-242">If the full-text upgrade option is **Reset**, the attached full-text catalog is reset.</span></span>  
  
 <span data-ttu-id="a90c6-243">有关分离和附加数据库的详细信息，请参阅[数据库分离和附加 (SQL Server)](../databases/database-detach-and-attach-sql-server.md)、[CREATE DATABASE (SQL Server Transact-SQL)](/sql/t-sql/statements/create-database-sql-server-transact-sql)、[sp_attach_db](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql) 和 [sp_detach_db (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="a90c6-243">For more information about detaching and attaching a database, see [Database Detach and Attach &#40;SQL Server&#41;](../databases/database-detach-and-attach-sql-server.md), [CREATE DATABASE &#40;SQL Server Transact-SQL&#41;](/sql/t-sql/statements/create-database-sql-server-transact-sql), [sp_attach_db](/sql/relational-databases/system-stored-procedures/sp-attach-db-transact-sql), and [sp_detach_db &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-detach-db-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a90c6-244">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a90c6-244">See Also</span></span>  
 <span data-ttu-id="a90c6-245">[全文搜索入门](get-started-with-full-text-search.md) </span><span class="sxs-lookup"><span data-stu-id="a90c6-245">[Get Started with Full-Text Search](get-started-with-full-text-search.md) </span></span>  
 <span data-ttu-id="a90c6-246">[配置和管理断字符和词干分析器以便搜索](configure-and-manage-word-breakers-and-stemmers-for-search.md) </span><span class="sxs-lookup"><span data-stu-id="a90c6-246">[Configure and Manage Word Breakers and Stemmers for Search](configure-and-manage-word-breakers-and-stemmers-for-search.md) </span></span>  
 [<span data-ttu-id="a90c6-247">配置和管理搜索筛选器</span><span class="sxs-lookup"><span data-stu-id="a90c6-247">Configure and Manage Filters for Search</span></span>](configure-and-manage-filters-for-search.md)  
  
  
