---
title: 升级复制脚本（复制 Transact-SQL 编程）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580159"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="95ee2-102">升级复制脚本（复制 Transact-SQL 编程）</span><span class="sxs-lookup"><span data-stu-id="95ee2-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="95ee2-103">脚本文件可用于以编程方式配置复制拓扑。</span><span class="sxs-lookup"><span data-stu-id="95ee2-103">script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="95ee2-104">有关详细信息，请参阅[复制系统存储过程概念](../concepts/replication-system-stored-procedures-concepts.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="95ee2-105">虽然不需要升级由 `sysadmin` 角色的成员执行的脚本，我们仍建议您按照本主题中的说明修改现有脚本。</span><span class="sxs-lookup"><span data-stu-id="95ee2-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="95ee2-106">按照 [Replication Agent Security Model](../security/replication-agent-security-model.md)主题的“代理所需权限”部分的说明为每个复制代理指定一个具有最低权限的帐户。</span><span class="sxs-lookup"><span data-stu-id="95ee2-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="95ee2-107">这些安全改进允许您显式指定用于执行复制代理作业的 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows 帐户，从而可对权限进行更多控制，这些安全改进会影响现有脚本中的以下存储过程：</span><span class="sxs-lookup"><span data-stu-id="95ee2-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="95ee2-108">**sp_addpublication_snapshot**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="95ee2-109">你现在应提供 Windows 凭据， **@job_login** 并 **@job_password** 在执行[sp_addpublication_snapshot &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)以创建在分发服务器上运行快照代理时所用的作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="95ee2-110">**sp_addpushsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-111">现在应执行 [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) 来显式添加作业，并提供用于在分发服务器上运行分发代理作业的 Windows 凭据（**@job_login** 和 **@job_password**）。</span><span class="sxs-lookup"><span data-stu-id="95ee2-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="95ee2-112">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，当创建推送订阅时会自动执行此操作。</span><span class="sxs-lookup"><span data-stu-id="95ee2-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="95ee2-113">**sp_addmergepushsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-114">现在应执行 [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) 来显式添加作业，并提供用于在分发服务器上运行合并代理作业的 Windows 凭据（**@job_login** 和 **@job_password**）。</span><span class="sxs-lookup"><span data-stu-id="95ee2-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="95ee2-115">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，当创建推送订阅时会自动执行此操作。</span><span class="sxs-lookup"><span data-stu-id="95ee2-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="95ee2-116">**sp_addpullsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-117">你现在应提供 Windows 凭据， **@job_login** 并 **@job_password** 在执行[sp_addpullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql)以创建在订阅服务器上运行分发代理时所用的作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="95ee2-118">**sp_addmergepullsubscription_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-119">你现在应提供 Windows 凭据， **@job_login** 并 **@job_password** 在执行[sp_addmergepullsubscription_agent &#40;transact-sql&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)以创建在订阅服务器上运行合并代理时所用的作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="95ee2-120">**sp_addlogreader_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-121">现在应执行 [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) 来手动添加作业，并提供用于在分发服务器上运行日志读取器代理的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="95ee2-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="95ee2-122">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，当创建事务发布时会自动执行此操作。</span><span class="sxs-lookup"><span data-stu-id="95ee2-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="95ee2-123">**sp_addqreader_agent**：</span><span class="sxs-lookup"><span data-stu-id="95ee2-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="95ee2-124">现在应执行 [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) 来手动添加作业，并提供用于在分发服务器上运行队列读取器代理的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="95ee2-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="95ee2-125">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之前的 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]版本中，当创建支持排队更新的事务发布时会自动执行此操作。</span><span class="sxs-lookup"><span data-stu-id="95ee2-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="95ee2-126">在中引入的安全模式中 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ，复制代理始终 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 使用和中提供的凭据与 Windows 身份验证连接到本地实例 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="95ee2-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-127">有关运行复制代理作业时所使用的 Windows 帐户的要求，请参阅 [Replication Agent Security Model](../security/replication-agent-security-model.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="95ee2-128">如果可能，请在运行时提示用户输入安全凭据。</span><span class="sxs-lookup"><span data-stu-id="95ee2-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="95ee2-129">如果将凭据保存在脚本文件中，请确保该文件本身受到安全保护。</span><span class="sxs-lookup"><span data-stu-id="95ee2-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="95ee2-130">升级用于配置快照发布或事务发布的脚本</span><span class="sxs-lookup"><span data-stu-id="95ee2-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="95ee2-131">在现有脚本中的 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 前面，针对发布服务器上的发布数据库执行 [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="95ee2-132">指定日志读取器代理为和运行的 Windows 凭据 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="95ee2-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-133">如果代理在连接到发布服务器时将使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 身份验证，则还必须将 **@publisher_security_mode** 值指定为 **@publisher_security_mode** 指定为在步骤 1 中使用的发布名称，并将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和 **@publisher_login** 指定为用于运行 **@publisher_password**。</span><span class="sxs-lookup"><span data-stu-id="95ee2-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="95ee2-134">这样，便为发布数据库创建了一个日志读取器代理作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="95ee2-135">此步骤仅针对事务发布，无需对快照发布执行该步骤。</span><span class="sxs-lookup"><span data-stu-id="95ee2-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="95ee2-136">（可选）在 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 前面，针对分发服务器上的分发数据库执行 [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="95ee2-137">指定队列读取器代理为和运行的 Windows 凭据 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="95ee2-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-138">这样，便为分发服务器创建了一个队列读取器代理作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="95ee2-139">仅需要对支持排队更新订阅服务器的事务发布执行此步骤。</span><span class="sxs-lookup"><span data-stu-id="95ee2-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="95ee2-140">（可选）更新 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 的执行，以便对用于实现新复制功能的参数设置任何非默认的值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="95ee2-141">在 [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) 后面，针对发布服务器上的发布数据库执行 [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="95ee2-142">指定 **@publication** 和用于为和运行快照代理的 Windows 凭据 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="95ee2-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-143">如果代理在连接到发布服务器时将使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 身份验证，则还必须将 **@publisher_security_mode** 值指定为 **@publisher_security_mode** 指定为在步骤 1 中使用的发布名称，并将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和 **@publisher_login** 指定为用于运行 **@publisher_password**。</span><span class="sxs-lookup"><span data-stu-id="95ee2-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="95ee2-144">此操作将为发布创建一个快照代理作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="95ee2-145">（可选）更新 [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) 的执行，以便对用于实现新复制功能的参数设置任何非默认的值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="95ee2-146">升级向快照发布或事务发布添加订阅的脚本</span><span class="sxs-lookup"><span data-stu-id="95ee2-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="95ee2-147">在执行用于创建订阅的存储过程之后，请确保执行用于创建分发代理作业的存储过程以同步订阅。</span><span class="sxs-lookup"><span data-stu-id="95ee2-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="95ee2-148">所用的存储过程将取决于订阅类型。</span><span class="sxs-lookup"><span data-stu-id="95ee2-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="95ee2-149">对于请求订阅，请更新 [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) 的执行，为 **@job_name** 和 **@job_password** 提供用于在订阅服务器上运行分发代理的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="95ee2-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-150">此操作将在执行 [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql)后完成。</span><span class="sxs-lookup"><span data-stu-id="95ee2-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="95ee2-151">有关详细信息，请参阅 [创建请求订阅](../create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="95ee2-152">对于推送订阅，请在发布服务器上执行 [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="95ee2-153">指定 **@subscriber** 、 **@subscriber_db** 、 **@publication** 、用于在分发服务器上运行分发代理的 Windows 凭据，并指定 **@job_name** **@job_password** 此代理作业的计划。</span><span class="sxs-lookup"><span data-stu-id="95ee2-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="95ee2-154">有关详细信息，请参阅 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="95ee2-155">此操作将在执行 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)后完成。</span><span class="sxs-lookup"><span data-stu-id="95ee2-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="95ee2-156">有关详细信息，请参阅 [创建推送订阅](../create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="95ee2-157">升级用于配置合并发布的脚本</span><span class="sxs-lookup"><span data-stu-id="95ee2-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="95ee2-158">（可选）在现有脚本中，更新 [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) 的执行，以便对用于实现新复制功能的参数设置任何非默认的值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="95ee2-159">在 [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) 后面，针对发布服务器上的发布数据库执行 [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="95ee2-160">指定 **@publication** 和用于为和运行快照代理的 Windows 凭据 **@job_name** **@job_password** 。</span><span class="sxs-lookup"><span data-stu-id="95ee2-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-161">如果代理在连接到发布服务器时将使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 身份验证，则还必须将 **@publisher_security_mode** 值指定为 **@publisher_security_mode** 指定为在步骤 1 中使用的发布名称，并将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和 **@publisher_login** 指定为用于运行 **@publisher_password**。</span><span class="sxs-lookup"><span data-stu-id="95ee2-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="95ee2-162">此操作将为发布创建一个快照代理作业。</span><span class="sxs-lookup"><span data-stu-id="95ee2-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="95ee2-163">（可选）更新 [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) 的执行，以便对用于实现新复制功能的参数设置任何非默认的值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="95ee2-164">升级向合并发布添加订阅的脚本</span><span class="sxs-lookup"><span data-stu-id="95ee2-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="95ee2-165">执行完用于创建订阅的存储过程后，请确保执行用于创建合并代理作业的存储过程以同步订阅。</span><span class="sxs-lookup"><span data-stu-id="95ee2-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="95ee2-166">所用的存储过程将取决于订阅类型。</span><span class="sxs-lookup"><span data-stu-id="95ee2-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="95ee2-167">对于请求订阅，请更新 [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) 的执行，为 **@job_name** 和 **@job_password** 提供用于在订阅服务器上运行合并代理的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="95ee2-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="95ee2-168">此操作将在执行 [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql)后完成。</span><span class="sxs-lookup"><span data-stu-id="95ee2-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="95ee2-169">有关详细信息，请参阅 [创建请求订阅](../create-a-pull-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="95ee2-170">对于推送订阅，请在发布服务器上执行 [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="95ee2-171">指定 **@subscriber** 、 **@subscriber_db** 、 **@publication** 、分发服务器上的合并代理针对和运行的 Windows 凭据 **@job_name** **@job_password** ，以及此代理作业的计划。</span><span class="sxs-lookup"><span data-stu-id="95ee2-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="95ee2-172">有关详细信息，请参阅 [Specify Synchronization Schedules](../specify-synchronization-schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="95ee2-173">此操作将在执行 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)后完成。</span><span class="sxs-lookup"><span data-stu-id="95ee2-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="95ee2-174">有关详细信息，请参阅 [创建推送订阅](../create-a-push-subscription.md)。</span><span class="sxs-lookup"><span data-stu-id="95ee2-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="95ee2-175">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-175">Example</span></span>  
 <span data-ttu-id="95ee2-176">下面是一个用于创建 Product 表的事务发布的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="95ee2-177">此发布支持以排队更新作为故障转移的立即更新。</span><span class="sxs-lookup"><span data-stu-id="95ee2-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="95ee2-178">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-179">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-179">Example</span></span>  
 <span data-ttu-id="95ee2-180">下面的示例将对上一个用于创建事务发布的脚本进行更新，从而可以在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-181">此发布支持以排队更新作为故障转移的立即更新。</span><span class="sxs-lookup"><span data-stu-id="95ee2-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="95ee2-182">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-183">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-184">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-184">Example</span></span>  
 <span data-ttu-id="95ee2-185">下面是一个可创建 Customers 表的合并发布的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="95ee2-186">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-187">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-187">Example</span></span>  
 <span data-ttu-id="95ee2-188">下面的示例将对上一个用于创建合并发布的脚本进行升级，从而可以在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-189">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-190">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-191">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-191">Example</span></span>  
 <span data-ttu-id="95ee2-192">下面是一个可创建对事务发布的推送订阅的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="95ee2-193">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-194">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-194">Example</span></span>  
 <span data-ttu-id="95ee2-195">下面的示例将对上一个用于创建对事务发布的推送订阅的脚本进行升级，从而可在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-196">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-197">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-198">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-198">Example</span></span>  
 <span data-ttu-id="95ee2-199">下面是一个可创建对合并发布的推送订阅的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="95ee2-200">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-201">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-201">Example</span></span>  
 <span data-ttu-id="95ee2-202">下面的示例将对上一个用于创建对合并发布的推送订阅的脚本进行升级，从而可在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-203">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-204">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-205">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-205">Example</span></span>  
 <span data-ttu-id="95ee2-206">下面是一个可创建事务发布的请求订阅的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="95ee2-207">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-208">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-208">Example</span></span>  
 <span data-ttu-id="95ee2-209">下面的示例将对上一个用于创建对事务发布的请求订阅的脚本进行升级，从而可在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-210">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-211">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-212">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-212">Example</span></span>  
 <span data-ttu-id="95ee2-213">下面是一个可创建对合并发布的请求订阅的 [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] 脚本示例。</span><span class="sxs-lookup"><span data-stu-id="95ee2-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="95ee2-214">为了方便阅读，删除了默认参数。</span><span class="sxs-lookup"><span data-stu-id="95ee2-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="95ee2-215">示例</span><span class="sxs-lookup"><span data-stu-id="95ee2-215">Example</span></span>  
 <span data-ttu-id="95ee2-216">下面的示例将对上一个用于创建对合并发布的请求订阅的脚本进行升级，从而可在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 和更高版本中成功运行。</span><span class="sxs-lookup"><span data-stu-id="95ee2-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="95ee2-217">在此示例中显式声明了新参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="95ee2-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="95ee2-218">Windows 凭据是在运行时使用 **sqlcmd** 脚本变量来提供的。</span><span class="sxs-lookup"><span data-stu-id="95ee2-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="95ee2-219">另请参阅</span><span class="sxs-lookup"><span data-stu-id="95ee2-219">See Also</span></span>  
 <span data-ttu-id="95ee2-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="95ee2-221">[ssSDSFull](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="95ee2-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="95ee2-223">[查看和修改复制安全设置](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="95ee2-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="95ee2-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="95ee2-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="95ee2-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="95ee2-227">升级复制的数据库</span><span class="sxs-lookup"><span data-stu-id="95ee2-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
