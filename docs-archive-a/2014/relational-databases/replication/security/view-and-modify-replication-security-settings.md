---
title: 查看和修改复制安全设置 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- modifying replication security settings
- replication [SQL Server], security
- security [SQL Server replication], viewing settings
- viewing replication security settings
- security [SQL Server replication], modifying settings
ms.assetid: 67d79532-1482-4de1-ac9f-4a23d162c85e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8da4a6e8093c6f04e06b68448660e4096e9e5c22
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591248"
---
# <a name="view-and-modify-replication-security-settings"></a><span data-ttu-id="6b96a-102">查看和修改复制安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-102">View and Modify Replication Security Settings</span></span>
  <span data-ttu-id="6b96a-103">本主题说明如何使用 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 、 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]或复制管理对象 (RMO) 在 [!INCLUDE[tsql](../../../includes/tsql-md.md)]中查看和修改复制安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-103">This topic describes how to view and modify replication security settings in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="6b96a-104">例如，您可能需要将日志读取器代理到发布服务器的连接从 SQL Server 身份验证更改为 Windows 集成身份验证，或者您可能需要在 Window 帐户密码更改后更改用于运行代理作业的凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-104">For example, you might want to change the connection of the Log Reader Agent to the Publisher from SQL Server Authentication to Windows Integrated Authentication, or you might need to change the credentials used to run an agent job when the Windows account password has changed.</span></span> <span data-ttu-id="6b96a-105">有关每个代理所需权限的信息，请参阅 [R复制代理安全模式](replication-agent-security-model.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-105">For information about the permissions required by each agent, see [Replication Agent Security Model](replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="6b96a-106">**本主题内容**</span><span class="sxs-lookup"><span data-stu-id="6b96a-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="6b96a-107">**开始之前：**</span><span class="sxs-lookup"><span data-stu-id="6b96a-107">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="6b96a-108">限制和局限</span><span class="sxs-lookup"><span data-stu-id="6b96a-108">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="6b96a-109">安全性</span><span class="sxs-lookup"><span data-stu-id="6b96a-109">Security</span></span>](#Security)  
  
-   <span data-ttu-id="6b96a-110">**查看和修改复制安全设置，使用：**</span><span class="sxs-lookup"><span data-stu-id="6b96a-110">**To view and modify replication security settings, using:**</span></span>  
  
     [<span data-ttu-id="6b96a-111">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6b96a-111">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="6b96a-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6b96a-112">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="6b96a-113">复制管理对象 (RMO)</span><span class="sxs-lookup"><span data-stu-id="6b96a-113">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
-   <span data-ttu-id="6b96a-114">**跟进：** [修改复制安全设置后](#FollowUp)</span><span class="sxs-lookup"><span data-stu-id="6b96a-114">**Follow Up:**  [After you modify replication security settings](#FollowUp)</span></span>  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="6b96a-115">开始之前</span><span class="sxs-lookup"><span data-stu-id="6b96a-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="6b96a-116">限制和局限</span><span class="sxs-lookup"><span data-stu-id="6b96a-116">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="6b96a-117">所使用的存储过程将取决于代理的类型和服务器连接的类型。</span><span class="sxs-lookup"><span data-stu-id="6b96a-117">The stored procedures that you use will depend on the type of agent and the type of server connection.</span></span>  
  
-   <span data-ttu-id="6b96a-118">使用的 RMO 类和属性取决于代理的类型和服务器连接的类型。</span><span class="sxs-lookup"><span data-stu-id="6b96a-118">The RMO classes and properties you use depend on the type of agent and the type of server connection.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="6b96a-119">Security</span><span class="sxs-lookup"><span data-stu-id="6b96a-119">Security</span></span>  
 <span data-ttu-id="6b96a-120">出于安全考虑，在复制存储过程返回的结果集中掩盖密码的实际值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-120">For security reasons, the actual values of passwords are masked in result sets returned by replication stored procedures.</span></span>  
  
####  <a name="permissions"></a><a name="Permissions"></a> <span data-ttu-id="6b96a-121">权限</span><span class="sxs-lookup"><span data-stu-id="6b96a-121">Permissions</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="6b96a-122">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6b96a-122">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="6b96a-123">在下列对话框中查看和修改安全设置：</span><span class="sxs-lookup"><span data-stu-id="6b96a-123">View and modify security settings in the following dialog boxes:</span></span>  
  
1.  <span data-ttu-id="6b96a-124">**“更新复制密码”** 对话框，可以通过 **的** “复制” [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]文件夹访问。</span><span class="sxs-lookup"><span data-stu-id="6b96a-124">The **Update Replication Passwords** dialog box, which is available from the **Replication** folder of [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="6b96a-125">如果更改复制拓扑中某服务器上 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 帐户或 Windows 帐户的密码，请使用此对话框，而不用更新使用此帐户的每个代理的密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-125">If you change the password for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] account or Windows account on a server in a replication topology, use this dialog box rather than updating the password for each agent that uses the account.</span></span> <span data-ttu-id="6b96a-126">如果多台服务器上的代理使用相同的帐户，则必须连接到每台服务器并更改密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-126">If agents on more than one server use the same account, you must connect to each server and change the password.</span></span> <span data-ttu-id="6b96a-127">在复制使用该密码的所有地方的密码将被更新，</span><span class="sxs-lookup"><span data-stu-id="6b96a-127">The password is updated in all of the places that replication uses the password.</span></span> <span data-ttu-id="6b96a-128">而其他地方（如链接服务器）的密码将不更新。</span><span class="sxs-lookup"><span data-stu-id="6b96a-128">The password is not updated in other places, such as linked servers.</span></span>  
  
2.  <span data-ttu-id="6b96a-129">“发布属性 - \<Publication>”对话框的“代理安全性”页面 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-129">The **Agent Security** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="6b96a-130">有关访问此对话框的详细信息，请参阅 [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-130">For more information about accessing this dialog box, see [View and Modify Publication Properties](../publish/view-and-modify-publication-properties.md).</span></span>  
  
3.  <span data-ttu-id="6b96a-131">“订阅属性 - \<Subscription>”对话框。</span><span class="sxs-lookup"><span data-stu-id="6b96a-131">The **Subscription Properties - \<Subscription>** dialog box.</span></span> <span data-ttu-id="6b96a-132">有关访问此对话框的详细信息，请参阅 [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) 和 [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-132">For more information about accessing this dialog box, see [View and Modify Push Subscription Properties](../view-and-modify-push-subscription-properties.md) and [View and Modify Pull Subscription Properties](../view-and-modify-pull-subscription-properties.md).</span></span>  
  
4.  <span data-ttu-id="6b96a-133">“分发服务器属性 - \<Distributor>”和“分发数据库属性 - \<Database>”对话框 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-133">The **Distributor Properties - \<Distributor>** and **Distribution Database Properties - \<Database>** dialog boxes.</span></span> <span data-ttu-id="6b96a-134">有关访问这些对话框的详细信息，请参阅 [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-134">For more information about accessing these dialog boxes, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
5.  <span data-ttu-id="6b96a-135">“发布服务器属性 - \<Publisher>”对话框。</span><span class="sxs-lookup"><span data-stu-id="6b96a-135">The **Publisher Properties - \<Publisher>** dialog box.</span></span> <span data-ttu-id="6b96a-136">有关访问此对话框的详细信息，请参阅 [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-136">For more information about accessing this dialog box, [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
#### <a name="to-change-the-password-for-an-account-used-by-one-or-more-agents"></a><span data-ttu-id="6b96a-137">更改一个或多个代理所用帐户的密码</span><span class="sxs-lookup"><span data-stu-id="6b96a-137">To change the password for an account used by one or more agents</span></span>  
  
1.  <span data-ttu-id="6b96a-138">如果该帐户是 SQL Server 帐户，此对话框还将更改 SQL Server 帐户的密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-138">If the account is a SQL Server account, this dialog box will also change the password for the SQL Server account.</span></span> <span data-ttu-id="6b96a-139">如果该帐户是 Windows 帐户，请首先在 Windows 中更改密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-139">If the account is a Windows account, change the password in Windows first.</span></span> <span data-ttu-id="6b96a-140">有关详细信息，请参阅 Windows 文档。</span><span class="sxs-lookup"><span data-stu-id="6b96a-140">For more information, see the Windows documentation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-141">更改复制密码后，必须停止并重新启动使用该密码的每个代理，这样代理的更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-141">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
2.  <span data-ttu-id="6b96a-142">连接到 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]中的服务器，然后展开该服务器节点。</span><span class="sxs-lookup"><span data-stu-id="6b96a-142">Connect to the server in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
3.  <span data-ttu-id="6b96a-143">右键单击 **“复制”** 文件夹，再单击 **“更新复制密码”** 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-143">Right-click the **Replication** folder, and then click **Update Replication Passwords**.</span></span>  
  
4.  <span data-ttu-id="6b96a-144">在 **“更新复制密码”** 对话框中指定帐户和新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-144">In the **Update Replication Passwords** dialog box, specify the account and the new password.</span></span>  
  
5.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="6b96a-145">更改快照代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-145">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="6b96a-146">在“发布属性 - \<Publication>”对话框的“代理安全性”页面上，单击“快照代理”文本框旁边的“安全设置”按钮   。</span><span class="sxs-lookup"><span data-stu-id="6b96a-146">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Snapshot Agent** text box.</span></span>  
  
2.  <span data-ttu-id="6b96a-147">在 **“快照代理安全性”** 对话框中指定运行该代理的帐户：</span><span class="sxs-lookup"><span data-stu-id="6b96a-147">In the **Snapshot Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="6b96a-148">在 **“代理帐户”** 文本框中，输入一个新的 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-148">Enter a new Windows account in the **Agent account** text box.</span></span>  
  
    -   <span data-ttu-id="6b96a-149">在 **“密码”** 和 **“确认密码”** 文本框中，输入一个新的强密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-149">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="6b96a-150">指定将该代理从分发服务器连接到发布服务器的上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-150">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="6b96a-151">如果选中 **“使用以下 SQL Server 登录名”** ，还必须指定登录名：</span><span class="sxs-lookup"><span data-stu-id="6b96a-151">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="6b96a-152">在 **“登录名”** 文本框中，输入登录名</span><span class="sxs-lookup"><span data-stu-id="6b96a-152">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="6b96a-153">在 **“密码”** 和 **“确认密码”** 文本框中，输入一个新的强密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-153">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-154">如果发布服务器为 Oracle 发布服务器，则在“分发服务器属性 - \<Distributor>”对话框中指定连接上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-154">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="6b96a-155">有关更改上下文的过程，请参阅下面的内容。</span><span class="sxs-lookup"><span data-stu-id="6b96a-155">See below for the procedure to change the context.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="6b96a-156">更改日志读取器代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-156">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="6b96a-157">在“发布属性 - \<Publication>”对话框的“代理安全性”页面上，单击“日志读取器代理”文本框旁边的“安全设置”按钮   。</span><span class="sxs-lookup"><span data-stu-id="6b96a-157">On the **Agent Security** page of the **Publication Properties - \<Publication>** dialog box, click the **Security Settings** button next to the **Log Reader Agent** text box.</span></span>  
  
2.  <span data-ttu-id="6b96a-158">在 **“日志读取器代理安全性”** 对话框中指定运行该代理的帐户：</span><span class="sxs-lookup"><span data-stu-id="6b96a-158">In the **Log Reader Agent Security** dialog box, specify the account under which the agent should run:</span></span>  
  
    -   <span data-ttu-id="6b96a-159">在 **“代理帐户”** 文本框中，输入新的 Windows 帐户</span><span class="sxs-lookup"><span data-stu-id="6b96a-159">Enter a new Windows account in the **Agent account** text box</span></span>  
  
    -   <span data-ttu-id="6b96a-160">在 **“密码”** 和 **“确认密码”** 文本框中，输入一个新的强密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-160">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
3.  <span data-ttu-id="6b96a-161">指定将该代理从分发服务器连接到发布服务器的上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-161">Specify the context under which the agent should connect from the Distributor to the Publisher.</span></span> <span data-ttu-id="6b96a-162">如果选中 **“使用以下 SQL Server 登录名”** ，还必须指定登录名：</span><span class="sxs-lookup"><span data-stu-id="6b96a-162">If you select **Using the following SQL Server login**, you must also specify the login:</span></span>  
  
    -   <span data-ttu-id="6b96a-163">在 **“登录名”** 文本框中，输入登录名</span><span class="sxs-lookup"><span data-stu-id="6b96a-163">Enter a login in the **Login** text box</span></span>  
  
    -   <span data-ttu-id="6b96a-164">在 **“密码”** 和 **“确认密码”** 文本框中，输入一个新的强密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-164">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-165">如果发布服务器为 Oracle 发布服务器，则在“分发服务器属性 - \<Distributor>”对话框中指定连接上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-165">If the Publisher is an Oracle Publisher, the connection context is specified in the **Distributor Properties - \<Distributor>** dialog box.</span></span> <span data-ttu-id="6b96a-166">通过下面的过程更改上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-166">Change the context using the next procedure.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-167">每个已发布数据库都有一个日志读取器代理。</span><span class="sxs-lookup"><span data-stu-id="6b96a-167">There is one Log Reader Agent for each published database.</span></span> <span data-ttu-id="6b96a-168">在一个发布上更改代理的安全设置会影响发布数据库中所有发布的设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-168">Changing the security settings for the agent on one publication affects the settings for all publications in the publication database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-snapshot-agent-and-log-reader-agent-for-an-oracle-publication-make-connections-to-the-publisher"></a><span data-ttu-id="6b96a-169">更改将 Oracle 发布的快照代理和日志读取器代理连接到发布服务器的上下文</span><span class="sxs-lookup"><span data-stu-id="6b96a-169">To change the context under which the Snapshot Agent and Log Reader Agent for an Oracle publication make connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="6b96a-170">在“分发服务器属性 - \<Distributor>”对话框的“发布服务器”页面上，单击“发布服务器”旁边的属性按钮 (...)  。</span><span class="sxs-lookup"><span data-stu-id="6b96a-170">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to a Publisher.</span></span>  
  
2.  <span data-ttu-id="6b96a-171">在 **“到发布服务器的代理连接”** 部分指定已配置的复制管理用户架构所使用的登录名和密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-171">In the **Agent Connection to the Publisher** section, specify the login and password used by the replication administrative user schema you configured.</span></span> <span data-ttu-id="6b96a-172">有关详细信息，请参阅[配置 Oracle 发布服务器](../non-sql/configure-an-oracle-publisher.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-172">For more information, see [Configure an Oracle Publisher](../non-sql/configure-an-oracle-publisher.md).</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="6b96a-173">更改推送订阅的分发代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-173">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-174">在发布服务器的“订阅属性 - \<Subscription>”对话框中，可进行以下更改：</span><span class="sxs-lookup"><span data-stu-id="6b96a-174">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="6b96a-175">若要更改运行分发代理并将其连接到分发服务器的帐户，请单击“代理进程帐户”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-175">To change the account under which the Distribution Agent runs and makes connections to the Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-176">在 **“分发代理安全性”** 对话框中指定帐户和密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-176">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="6b96a-177">若要更改将分发代理连接到订阅服务器的上下文，请单击“订阅服务器连接”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-177">To change the context under which the Distribution Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-178">在 **“输入连接信息”** 对话框中指定上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-178">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
         <span data-ttu-id="6b96a-179">如果使用排队更新订阅，队列读取器代理还将使用为订阅服务器的连接指定的上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-179">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="6b96a-180">更改请求订阅的分发代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-180">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-181">在订阅服务器的“订阅属性 - \<Subscription>”对话框中，可进行以下更改：</span><span class="sxs-lookup"><span data-stu-id="6b96a-181">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="6b96a-182">若要更改运行分发代理并将其连接到订阅服务器的帐户，请单击“代理进程帐户”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-182">To change the account under which the Distribution Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-183">在 **“分发代理安全性”** 对话框中指定帐户和密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-183">Specify an account and password in the **Distribution Agent Security** dialog box.</span></span>  
  
         <span data-ttu-id="6b96a-184">如果使用排队更新订阅，队列读取器代理还将使用为订阅服务器的连接指定的上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-184">If you use queued updating subscriptions, the Queue Reader Agent also uses the context specified here for connections to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="6b96a-185">若要更改将分发代理连接到分发服务器的上下文，请单击“分发服务器连接”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-185">To change the context under which the Distribution Agent connects to the Distributor, click the **Distributor Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-186">在 **“输入连接信息”** 对话框中指定上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-186">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="6b96a-187">更改推送订阅的合并代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-187">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-188">在发布服务器的“订阅属性 - \<Subscription>”对话框中，可进行以下更改：</span><span class="sxs-lookup"><span data-stu-id="6b96a-188">In the **Subscription Properties - \<Subscription>** dialog box at the Publisher, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="6b96a-189">若要更改运行合并代理并将其连接到发布服务器的帐户，请单击“代理进程帐户”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-189">To change the account under which the Merge Agent runs and makes connections to the Publisher and Distributor, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-190">在 **“合并代理安全性”** 对话框中指定帐户和密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-190">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="6b96a-191">若要更改将合并代理连接到订阅服务器的上下文，请单击“订阅服务器连接”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-191">To change the context under which the Merge Agent connects to the Subscriber, click the **Subscriber Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-192">在 **“输入连接信息”** 对话框中指定上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-192">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="6b96a-193">更改请求订阅的合并代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-193">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-194">在订阅服务器的“订阅属性 - \<Subscription>”对话框中，可进行以下更改：</span><span class="sxs-lookup"><span data-stu-id="6b96a-194">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, you can make the following changes:</span></span>  
  
    -   <span data-ttu-id="6b96a-195">若要更改运行合并代理并将其连接到订阅服务器的帐户，请单击“代理进程帐户”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-195">To change the account under which the Merge Agent runs and makes connections to the Subscriber, click the **Agent process account** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-196">在 **“合并代理安全性”** 对话框中指定帐户和密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-196">Specify an account and password in the **Merge Agent Security** dialog box.</span></span>  
  
    -   <span data-ttu-id="6b96a-197">若要更改将合并代理连接到发布服务器和分发服务器的上下文，请单击“发布服务器连接”行，再单击该行中的属性按钮 (...)。 </span><span class="sxs-lookup"><span data-stu-id="6b96a-197">To change the context under which the Merge Agent connects to the Publisher and Distributor, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span> <span data-ttu-id="6b96a-198">在 **“输入连接信息”** 对话框中指定上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-198">Specify the context in the **Enter Connection Information** dialog box.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-change-the-account-under-which-the-queue-reader-agent-runs"></a><span data-ttu-id="6b96a-199">更改运行队列读取器代理的帐户</span><span class="sxs-lookup"><span data-stu-id="6b96a-199">To change the account under which the Queue Reader Agent runs</span></span>  
  
1.  <span data-ttu-id="6b96a-200">在“分发服务器属性 - \<Distributor>”对话框的“常规”页面上，单击分发数据库旁边的属性按钮 (...)  。</span><span class="sxs-lookup"><span data-stu-id="6b96a-200">On the **General** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties (**...**) button next to the distribution database.</span></span>  
  
2.  <span data-ttu-id="6b96a-201">在“分发数据库属性 - \<Database>”对话框中，单击“代理进程帐户”文本框旁边的“安全设置”按钮  。</span><span class="sxs-lookup"><span data-stu-id="6b96a-201">In the **Distribution Database Properties - \<Database>** dialog box, click the **Security Settings** button next to the **Agent process account** text box.</span></span>  
  
3.  <span data-ttu-id="6b96a-202">在 **“队列读取器代理安全性”** 对话框中，指定运行代理并将其连接到分发服务器的帐户：</span><span class="sxs-lookup"><span data-stu-id="6b96a-202">In the **Queue Reader Agent Security** dialog box, specify the account under which the agent runs and makes connections to the Distributor:</span></span>  
  
    -   <span data-ttu-id="6b96a-203">在 **“进程帐户”** 文本框中，输入一个新的 Windows 帐户</span><span class="sxs-lookup"><span data-stu-id="6b96a-203">Enter a new Windows account in the **Process account** text box</span></span>  
  
    -   <span data-ttu-id="6b96a-204">在 **“密码”** 和 **“确认密码”** 文本框中，输入一个新的强密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-204">Enter a new strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-205">每个分发数据库都有一个队列读取器代理。</span><span class="sxs-lookup"><span data-stu-id="6b96a-205">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="6b96a-206">更改代理的安全设置会影响使用此分发数据库的所有发布服务器上所有发布的设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-206">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-publisher"></a><span data-ttu-id="6b96a-207">更改将队列读取器代理连接到发布服务器的上下文</span><span class="sxs-lookup"><span data-stu-id="6b96a-207">To change the context under which the Queue Reader Agent makes connections to the Publisher</span></span>  
  
1.  <span data-ttu-id="6b96a-208">在“分发服务器属性 - \<Distributor>”对话框的“发布服务器”页面上，单击“发布服务器”旁边的属性按钮 (...)  。</span><span class="sxs-lookup"><span data-stu-id="6b96a-208">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, click the properties button (**...**) next to the Publisher.</span></span>  
  
2.  <span data-ttu-id="6b96a-209">在 **“到发布服务器的代理连接”** 部分，将 **“代理连接模式”** 选项指定为 **“模拟代理进程帐户”** 或 **“SQL Server 身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-209">In the **Agent Connection to the Publisher** section, specify a value of **Impersonate the agent process account** or **SQL Server Authentication** for the **Agent Connection Mode** option.</span></span> <span data-ttu-id="6b96a-210">如果指定 **“SQL Server 身份验证”** ，还需输入 **“登录名”** 和 **“密码”** 的值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-210">If you specify **SQL Server Authentication**, also enter values for **Login** and **Password**.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-211">每个分发数据库都有一个队列读取器代理。</span><span class="sxs-lookup"><span data-stu-id="6b96a-211">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="6b96a-212">更改代理的安全设置会影响使用此分发数据库的所有发布服务器上所有发布的设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-212">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
#### <a name="to-change-the-context-under-which-the-queue-reader-agent-makes-connections-to-the-subscriber"></a><span data-ttu-id="6b96a-213">更改将队列读取器代理连接到订阅服务器的上下文</span><span class="sxs-lookup"><span data-stu-id="6b96a-213">To change the context under which the Queue Reader Agent makes connections to the Subscriber</span></span>  
  
-   <span data-ttu-id="6b96a-214">对于订阅，队列读取器代理与分发代理使用相同的连接上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-214">The Queue Reader Agent uses the same connection context as the Distribution Agent for the subscription.</span></span> <span data-ttu-id="6b96a-215">有关详细信息，请参阅上述分发代理的过程。</span><span class="sxs-lookup"><span data-stu-id="6b96a-215">For more information, see the procedures above for the Distribution Agent.</span></span>  
  
#### <a name="to-change-security-settings-for-an-immediate-updating-pull-subscription"></a><span data-ttu-id="6b96a-216">更改立即更新请求订阅的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-216">To change security settings for an immediate updating pull subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-217">在订阅服务器的 "**订阅属性- \<Subscription> \*\* " 对话框中，单击 "**发布服务器连接\*\*" 行，然后单击行中的 "属性" (") " 按钮。 **...**</span><span class="sxs-lookup"><span data-stu-id="6b96a-217">In the **Subscription Properties - \<Subscription>** dialog box at the Subscriber, click the **Publisher Connection** row, and then click the properties (**...**) button in the row.</span></span>  
  
2.  <span data-ttu-id="6b96a-218">在 **“输入连接信息”** 对话框中，请选择下列选项之一：</span><span class="sxs-lookup"><span data-stu-id="6b96a-218">In the **Enter Connection Information** dialog box, select one of the following options:</span></span>  
  
    -   <span data-ttu-id="6b96a-219">**“使用来自链接服务器或远程服务器的登录名”** 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-219">**Use a login from a linked or remote server**.</span></span> <span data-ttu-id="6b96a-220">如果已使用 [sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql)、[sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)、[!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 或其他方法在订阅服务器和发布服务器之间定义了远程服务器或链接服务器，则选择此选项。</span><span class="sxs-lookup"><span data-stu-id="6b96a-220">Select this option if you have defined a remote server or linked server between the Subscriber and the Publisher using [sp_addserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addserver-transact-sql), [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql), [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], or another method.</span></span>  
  
    -   <span data-ttu-id="6b96a-221">**“使用以下登录名和密码进行 SQL Server 身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-221">**Use SQL Server Authentication with the following login and password**.</span></span> <span data-ttu-id="6b96a-222">如果尚未在订阅服务器和发布服务器之间定义远程服务器或链接服务器，则选择此选项。</span><span class="sxs-lookup"><span data-stu-id="6b96a-222">Select this option if you have not defined a remote server or linked server between the Subscriber and the Publisher.</span></span> <span data-ttu-id="6b96a-223">复制将为您创建链接服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-223">Replication will create a linked server for you.</span></span> <span data-ttu-id="6b96a-224">所指定的帐户在发布服务器上必须已经存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-224">The account you specify must already exist at the Publisher.</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
> [!NOTE]  
>  <span data-ttu-id="6b96a-225">此过程更改复制触发器用于在订阅服务器上发生更改时从订阅服务器连接到发布服务器的方法。</span><span class="sxs-lookup"><span data-stu-id="6b96a-225">This procedure changes the method that replication triggers use to connect from the Subscriber to the Publisher when changes are made at the Subscriber.</span></span> <span data-ttu-id="6b96a-226">还可以为立即更新订阅更改与分发代理关联的设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-226">You can also change settings associated with the Distribution Agent for an immediate updating subscription.</span></span> <span data-ttu-id="6b96a-227">有关详细信息，请参阅本主题前面介绍的过程。</span><span class="sxs-lookup"><span data-stu-id="6b96a-227">For more information, see the procedures earlier in this topic.</span></span>  
>   
>  <span data-ttu-id="6b96a-228">此过程只适用于请求订阅。</span><span class="sxs-lookup"><span data-stu-id="6b96a-228">This procedure applies only to pull subscriptions.</span></span> <span data-ttu-id="6b96a-229">对于推送订阅，请使用存储过程 [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-229">For push subscriptions, use the stored procedure [sp_link_publication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-the-administrative-connection-from-the-publisher-to-the-distributor"></a><span data-ttu-id="6b96a-230">更改从发布服务器到分发服务器的管理连接的密码</span><span class="sxs-lookup"><span data-stu-id="6b96a-230">To change the password for the administrative connection from the Publisher to the Distributor</span></span>  
  
1.  <span data-ttu-id="6b96a-231">在“分发服务器属性 - \<Distributor>”对话框的“发布服务器”页面上，在“密码”和“确认密码”文本框中输入强密码   。</span><span class="sxs-lookup"><span data-stu-id="6b96a-231">On the **Publishers** page of the **Distributor Properties - \<Distributor>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
3.  <span data-ttu-id="6b96a-232">在“发布服务器属性 - \<Publisher>”对话框的“常规”页面上，在“密码”和“确认密码”文本框中输入强密码   。</span><span class="sxs-lookup"><span data-stu-id="6b96a-232">On the **General** page of the **Publisher Properties - \<Publisher>** dialog box, enter a strong password in the **Password** and **Confirm Password** text boxes.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="6b96a-233">使用 Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="6b96a-233">Using Transact-SQL</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6b96a-234">在以下所有过程中，如果可能，请在运行时提示用户输入安全凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-234">In all of the following procedures, when possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="6b96a-235">如果将凭据存储在脚本文件中，则必须确保文件的安全以防受到未经授权的访问。</span><span class="sxs-lookup"><span data-stu-id="6b96a-235">If you store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-change-all-instances-of-a-stored-password-at-a-replication-server"></a><span data-ttu-id="6b96a-236">在复制服务器上更改存储密码的所有实例</span><span class="sxs-lookup"><span data-stu-id="6b96a-236">To change all instances of a stored password at a replication server</span></span>  
  
1.  <span data-ttu-id="6b96a-237">在复制拓扑中的服务器上，对 master 数据库执行 [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-237">At a server in a replication topology on the master database, execute [sp_changereplicationserverpasswords](/sql/relational-databases/system-stored-procedures/sp-changereplicationserverpasswords-transact-sql).</span></span> <span data-ttu-id="6b96a-238">指定 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 要更改其密码的 Windows 帐户或登录名， \*\* \@ **并为帐户指定新密码或登录** \@ 密码\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-238">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login whose password is being changed for **\@login** and new password for the account or login for **\@password**.</span></span> <span data-ttu-id="6b96a-239">连接到该拓扑中的其他服务器时，此操作会更改该服务器上所有代理使用的密码的每个实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-239">This changes every instance of the password used by all agents on the server when connecting to other servers in the topology.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-240">若要只更改与拓扑中特定服务器的连接的登录名和密码 (如分发服务器或订阅服务器) ，请为\*\* \@ 服务器\*\*指定此服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="6b96a-240">To only change the login and password for a connection to a particular server in the topology (such as the Distributor or Subscriber), specify this server's name for **\@server**.</span></span>  
  
2.  <span data-ttu-id="6b96a-241">在复制拓扑中必须更新密码的每台服务器上重复执行步骤 1。</span><span class="sxs-lookup"><span data-stu-id="6b96a-241">Repeat step 1 at every server in the replication topology where the password must be updated.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-242">更改复制密码后，必须停止并重新启动使用该密码的每个代理，这样代理的更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-242">After changing a replication password, you must stop and restart each agent that uses the password before the change takes effect for that agent.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent"></a><span data-ttu-id="6b96a-243">更改快照代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-243">To change security settings for the Snapshot Agent</span></span>  
  
1.  <span data-ttu-id="6b96a-244">在发布服务器上，执行[sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql)，并指定\*\* \@ 发布\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-244">At the Publisher, execute [sp_helppublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-helppublication-snapshot-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="6b96a-245">此操作将返回快照代理的当前安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-245">This returns the current security settings for the Snapshot Agent.</span></span>  
  
2.  <span data-ttu-id="6b96a-246">在发布服务器上，执行[sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql)，指定要更改的\*\* \@ 发布\*\*以及以下一个或多个安全设置：</span><span class="sxs-lookup"><span data-stu-id="6b96a-246">At the Publisher, execute [sp_changepublication_snapshot](/sql/relational-databases/system-stored-procedures/sp-changepublication-snapshot-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="6b96a-247">若要更改代理运行时所用的 Windows 帐户或只更改此帐户的密码，请指定\*\* \@ job_login**和** \@ job_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-247">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="6b96a-248">若要更改连接到发布服务器时使用的安全模式，请将\*\* \@ publisher_security_mode**的值指定为**1**或**0\*\* 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-248">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="6b96a-249">在将连接到发布服务器时使用的安全模式从**1**改为**0**时，或者更改 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 用于此连接的登录名时，请指定\*\* \@ publisher_login**和** \@ publisher_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-249">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-250">使用远程分发服务器配置发布服务器时，为所有参数提供的值（包括 *job_login* 和 *job_password*）都会以纯文本方式发送到该分发服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-250">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="6b96a-251">在执行此存储过程之前，应该对发布服务器及其远程分发服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="6b96a-251">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="6b96a-252">有关详细信息，请参阅[启用数据库引擎的加密连接（SQL Server 配置管理器）](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-252">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-log-reader-agent"></a><span data-ttu-id="6b96a-253">更改日志读取器代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-253">To change security settings for the Log Reader Agent</span></span>  
  
1.  <span data-ttu-id="6b96a-254">在发布服务器上，执行[sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql)，并指定\*\* \@ 发布服务器\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-254">At the Publisher, execute [sp_helplogreader_agent](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql), specifying **\@publisher**.</span></span> <span data-ttu-id="6b96a-255">此操作将返回日志读取器代理的当前安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-255">This returns the current security settings for the Log Reader Agent.</span></span>  
  
2.  <span data-ttu-id="6b96a-256">在发布服务器上，执行[sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql)，指定要更改的\*\* \@ 发布\*\*以及以下一个或多个安全设置：</span><span class="sxs-lookup"><span data-stu-id="6b96a-256">At the Publisher, execute [sp_changelogreader_agent](/sql/relational-databases/system-stored-procedures/sp-changelogreader-agent-transact-sql), specifying **\@publication** and one or more of the following security settings to change:</span></span>  
  
    -   <span data-ttu-id="6b96a-257">若要更改代理运行时所用的 Windows 帐户或只更改此帐户的密码，请指定\*\* \@ job_login**和** \@ job_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-257">To change the Windows account under which the agent runs or just password for this account, specify **\@job_login** and **\@job_password**.</span></span>  
  
    -   <span data-ttu-id="6b96a-258">若要更改连接到发布服务器时使用的安全模式，请将\*\* \@ publisher_security_mode**的值指定为**1**或**0\*\* 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-258">To change the security mode used when connecting to the Publisher, specify a value of **1** or **0** for **\@publisher_security_mode**.</span></span>  
  
    -   <span data-ttu-id="6b96a-259">在将连接到发布服务器时使用的安全模式从**1**改为**0**时，或者更改 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 用于此连接的登录名时，请指定\*\* \@ publisher_login**和** \@ publisher_password\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-259">When changing the security mode used when connecting to the Publisher from **1** to **0** or when changing a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login used for this connection, specify **\@publisher_login** and **\@publisher_password**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-260">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-260">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-261">使用远程分发服务器配置发布服务器时，为所有参数提供的值（包括 *job_login* 和 *job_password*）都会以纯文本方式发送到该分发服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-261">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="6b96a-262">在执行此存储过程之前，应该对发布服务器及其远程分发服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="6b96a-262">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="6b96a-263">有关详细信息，请参阅[启用数据库引擎的加密连接（SQL Server 配置管理器）](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-263">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription"></a><span data-ttu-id="6b96a-264">更改推送订阅的分发代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-264">To change security settings for the Distribution Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-265">在发布服务器上，对发布数据库执行[sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql)，并指定\*\* \@ 发布**和** \@ 订阅服务器\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-265">At the Publisher on the publication database, execute [sp_helpsubscription](/sql/relational-databases/system-stored-procedures/sp-helpsubscription-transact-sql), specifying **\@publication** and **\@subscriber**.</span></span> <span data-ttu-id="6b96a-266">此操作将返回订阅属性，包括运行在分发服务器上的分发代理的安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-266">This returns subscription properties, including security settings for the Distribution Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="6b96a-267">在发布服务器上，对发布数据库执行[sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql)，并指定\*\* \@ 发布**、 \*\* \@ 订阅服务器**、 \*\* \@ subscriber_db**、 \*\* \@ 项目**的**所有**值、 \*\* \@ 属性**的安全属性的名称，以及** \@ 值\*\*的属性的新值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-267">At the Publisher on the publication database, execute [sp_changesubscription](/sql/relational-databases/system-stored-procedures/sp-changesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, a value of **all** for **\@article**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="6b96a-268">对下列每个要更改的安全属性重复步骤 2：</span><span class="sxs-lookup"><span data-stu-id="6b96a-268">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="6b96a-269">若要更改运行代理所用的 Windows 帐户或只更改此帐户的密码，请将 " \*\* \@ 属性**" 的值指定为 " **distrib_job_password** "，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-269">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="6b96a-270">更改帐户本身时，请重复步骤2，为 " \*\* \@ 属性**" 指定**distrib_job_login**值，并为 " \*\* \@ 值**" 指定新的 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-270">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-271">若要更改连接到订阅服务器时所用的安全模式，请为\*\* \@ 属性**指定**subscriber_security_mode**的值，并将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-271">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-272">在将订阅服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定值**subscriber_password\*\* ，并为 " \*\* \@ 值\*\*" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-272">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-273">重复步骤2，为 " \*\* \@ 属性**" 指定**subscriber_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-273">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-274">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-274">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-275">使用远程分发服务器配置发布服务器时，为所有属性（包括 **distrib_job_login** 和 **distrib_job_password**）提供的值都将以纯文本格式发送到分发服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-275">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **distrib_job_login** and **distrib_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="6b96a-276">在执行此存储过程之前，应该对发布服务器及其远程分发服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="6b96a-276">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="6b96a-277">有关详细信息，请参阅[启用数据库引擎的加密连接（SQL Server 配置管理器）](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-277">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription"></a><span data-ttu-id="6b96a-278">更改请求订阅的分发代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-278">To change security settings for the Distribution Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-279">在订阅服务器上，执行[sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql)，指定\*\* \@ 发布\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-279">At the Subscriber, execute [sp_helppullsubscription](/sql/relational-databases/system-stored-procedures/sp-helppullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="6b96a-280">此操作将返回订阅属性，包括运行在订阅服务器上的分发代理的安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-280">This returns subscription properties, including security settings for the Distribution Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="6b96a-281">在订阅服务器上，对订阅数据库执行[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)，指定\*\* \@ 发布服务器**、 \*\* \@ publisher_db**、 \*\* \@ 发布**、 \*\* \@ 属性**的安全属性的名称，以及\*\* \@ 值\*\*的属性的新值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-281">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="6b96a-282">对下列每个要更改的安全属性重复步骤 2：</span><span class="sxs-lookup"><span data-stu-id="6b96a-282">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="6b96a-283">若要更改运行代理所用的 Windows 帐户或只更改此帐户的密码，请将 " \*\* \@ 属性**" 的值指定为 " **distrib_job_password** "，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-283">To change the Windows account under which the agent runs or just the password for this account, specify a value of **distrib_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="6b96a-284">更改帐户本身时，请重复步骤2，为 " \*\* \@ 属性**" 指定**distrib_job_login**值，并为 " \*\* \@ 值**" 指定新的 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-284">When changing the account itself, repeat step 2 specifying a value of **distrib_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-285">若要更改连接到分发服务器时使用的安全模式，请将\*\* \@ 属性**的值**distributor_security_mode**指定为属性，将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-285">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-286">将分发服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定 " **distributor_password** " 的值，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-286">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-287">重复步骤2，为 " \*\* \@ 属性**" 指定**distributor_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-287">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-288">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-288">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription"></a><span data-ttu-id="6b96a-289">更改推送订阅的合并代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-289">To change security settings for the Merge Agent for a push subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-290">在发布服务器上，对发布数据库执行[sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql)，并指定\*\* \@ 发布**、 \*\* \@ 订阅服务器**和\*\* \@ subscriber_db\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-290">At the Publisher on the publication database, execute [sp_helpmergesubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, and **\@subscriber_db**.</span></span> <span data-ttu-id="6b96a-291">此操作将返回订阅属性，包括运行在分发服务器上的合并代理的安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-291">This returns subscription properties, including security settings for the Merge Agent running at the Distributor.</span></span>  
  
2.  <span data-ttu-id="6b96a-292">在发布服务器上，对发布数据库执行[sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql)，并指定\*\* \@ 发布**、 \*\* \@ 订阅服务器**、 \*\* \@ subscriber_db**、 \*\* \@ 属性**的安全属性的名称，以及\*\* \@ 值\*\*的属性的新值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-292">At the Publisher on the publication database, execute [sp_changemergesubscription](/sql/relational-databases/system-stored-procedures/sp-changemergesubscription-transact-sql), specifying **\@publication**, **\@subscriber**, **\@subscriber_db**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="6b96a-293">对下列每个要更改的安全属性重复步骤 2：</span><span class="sxs-lookup"><span data-stu-id="6b96a-293">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="6b96a-294">若要更改运行代理所用的 Windows 帐户或只更改此帐户的密码，请将 " \*\* \@ 属性**" 的值指定为 " **merge_job_password** "，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-294">To change the Windows account under which the agent runs, or just the password for this account, specify a value of **merge_job_password** for **\@property** and a new password for **\@value**.</span></span> <span data-ttu-id="6b96a-295">更改帐户本身时，请重复步骤2，为 " \*\* \@ 属性**" 指定**merge_job_login**值，并为 " \*\* \@ 值**" 指定新的 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-295">When changing the account itself, repeat step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-296">若要更改连接到订阅服务器时所用的安全模式，请为\*\* \@ 属性**指定**subscriber_security_mode**的值，并将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-296">To change the security mode used when connecting to the Subscriber, specify a value of **subscriber_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-297">在将订阅服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定值**subscriber_password\*\* ，并为 " \*\* \@ 值\*\*" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-297">When changing the Subscriber security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **subscriber_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-298">重复步骤2，为 " \*\* \@ 属性**" 指定**subscriber_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-298">Repeat step 2, specifying a value of **subscriber_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-299">若要更改连接到发布服务器时所用的安全模式，请为\*\* \@ 属性**指定**publisher_security_mode**的值，并将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-299">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-300">将发布服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定 " **publisher_password** " 的值，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-300">When changing the Publisher security mode to SQL Server Authentication, or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-301">重复步骤2，为 " \*\* \@ 属性**" 指定**publisher_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-301">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-302">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-302">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-303">使用远程分发服务器配置发布服务器时，为所有属性（包括 **merge_job_login** 和 **merge_job_password**）提供的值都将以纯文本格式发送到分发服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-303">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including **merge_job_login** and **merge_job_password**, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="6b96a-304">在执行此存储过程之前，应该对发布服务器及其远程分发服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="6b96a-304">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="6b96a-305">有关详细信息，请参阅[启用数据库引擎的加密连接（SQL Server 配置管理器）](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-305">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription"></a><span data-ttu-id="6b96a-306">更改请求订阅的合并代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-306">To change security settings for the Merge Agent for a pull subscription</span></span>  
  
1.  <span data-ttu-id="6b96a-307">在订阅服务器上，执行[sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql)，指定\*\* \@ 发布\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-307">At the Subscriber, execute [sp_helpmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-helpmergepullsubscription-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="6b96a-308">此操作将返回订阅属性，包括运行在订阅服务器上的合并代理的安全设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-308">This returns subscription properties, including security settings for the Merge Agent running at the Subscriber.</span></span>  
  
2.  <span data-ttu-id="6b96a-309">在订阅服务器上，对订阅数据库执行[sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql)，指定\*\* \@ 发布服务器**、 \*\* \@ publisher_db**、 \*\* \@ 发布**、 \*\* \@ 属性**的安全属性的名称，以及\*\* \@ 值\*\*的属性的新值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-309">At the Subscriber on the subscription database, execute [sp_change_subscription_properties](/sql/relational-databases/system-stored-procedures/sp-change-subscription-properties-transact-sql), specifying **\@publisher**, **\@publisher_db**, **\@publication**, the name of the security property for **\@property**, and the new value of the property for **\@value**.</span></span>  
  
3.  <span data-ttu-id="6b96a-310">对下列每个要更改的安全属性重复步骤 2：</span><span class="sxs-lookup"><span data-stu-id="6b96a-310">Repeat step 2 for each of the following security properties being changed:</span></span>  
  
    -   <span data-ttu-id="6b96a-311">若要更改运行代理所用的 Windows 帐户或只更改此帐户的密码，请为 " \*\* \@ 属性**" 指定 "值"，为 " \*\* \@ 值**" **merge_job_password**指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-311">To change the Windows account under which the agent runs or just the password for this account, specify a value of **merge_job_password** for **\@property** and new password for **\@value**.</span></span> <span data-ttu-id="6b96a-312">更改帐户本身时，请重复步骤2，为 " \*\* \@ 属性**" 指定**merge_job_login**值，并为 " \*\* \@ 值**" 指定新的 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-312">When changing the account itself, repeat Step 2 specifying a value of **merge_job_login** for **\@property** and the new Windows account for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-313">若要更改连接到分发服务器时使用的安全模式，请将\*\* \@ 属性**的值**distributor_security_mode**指定为属性，将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-313">To change the security mode used when connecting to the Distributor, specify a value of **distributor_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-314">将分发服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定 " **distributor_password** " 的值，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-314">When changing the Distributor security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **distributor_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-315">重复步骤2，为 " \*\* \@ 属性**" 指定**distributor_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-315">Repeat step 2, specifying a value of **distributor_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-316">若要更改连接到发布服务器时所用的安全模式，请为\*\* \@ 属性**指定**publisher_security_mode**的值，并将值1指定为**1\*\* (Windows 集成身份验证) 或**0** (SQL Server Authentication) 作为\*\* \@ 值\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-316">To change the security mode used when connecting to the Publisher, specify a value of **publisher_security_mode** for **\@property** and a value of **1** (Windows Integrated Authentication) or **0** (SQL Server Authentication) for **\@value**.</span></span>  
  
    -   <span data-ttu-id="6b96a-317">将发布服务器安全模式更改为 SQL Server 身份验证时，或者如果更改 SQL Server 身份验证的登录信息，请为 " \*\* \@ 属性**" 指定 " **publisher_password** " 的值，并为 " \*\* \@ 值**" 指定新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-317">When changing the Publisher security mode to SQL Server Authentication or if changing login information for SQL Server Authentication, specify a value of **publisher_password** for **\@property** and the new password for **\@value**.</span></span> <span data-ttu-id="6b96a-318">重复步骤2，为 " \*\* \@ 属性**" 指定**publisher_login**的值，并为 " \*\* \@ 值**" 指定新的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-318">Repeat step 2, specifying a value of **publisher_login** for **\@property** and the new login for **\@value**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-319">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-319">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
#### <a name="to-change-security-settings-for-the-snapshot-agent-to-generate-a-filtered-snapshot-for-a-subscriber"></a><span data-ttu-id="6b96a-320">更改快照代理的安全设置以为订阅服务器生成筛选快照</span><span class="sxs-lookup"><span data-stu-id="6b96a-320">To change security settings for the Snapshot Agent to generate a filtered snapshot for a Subscriber</span></span>  
  
1.  <span data-ttu-id="6b96a-321">在发布服务器上，执行[sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql)，并指定\*\* \@ 发布\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-321">At the Publisher, execute [sp_helpdynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-helpdynamicsnapshot-job-transact-sql), specifying **\@publication**.</span></span> <span data-ttu-id="6b96a-322">在结果集中，记下要更改的订阅服务器分区的 **job_name** 值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-322">In the result set, note the value of **job_name** for the Subscriber's partition to change.</span></span>  
  
2.  <span data-ttu-id="6b96a-323">在发布服务器上，执行[sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql)，指定\*\* \@ 发布**，为** \@ dynamic_snapshot_jobname**从步骤1获取的值，并为** \@ job_login**和** \@ job_password**运行代理所用的 Windows 帐户指定** \@ job_password\*\*或登录名和密码的新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-323">At the Publisher, execute [sp_changedynamicsnapshot_job](/sql/relational-databases/system-stored-procedures/sp-changedynamicsnapshot-job-transact-sql), specifying **\@publication**, the value obtained from step 1 for **\@dynamic_snapshot_jobname**, and a new password for **\@job_password** or login and password for the Windows account under which the agent runs for **\@job_login** and **\@job_password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-324">使用远程分发服务器配置发布服务器时，为所有参数提供的值（包括 *job_login* 和 *job_password*）都会以纯文本方式发送到该分发服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-324">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="6b96a-325">在执行此存储过程之前，应该对发布服务器及其远程分发服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="6b96a-325">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="6b96a-326">有关详细信息，请参阅[启用数据库引擎的加密连接（SQL Server 配置管理器）](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-326">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-change-security-settings-for-the-queue-reader-agent"></a><span data-ttu-id="6b96a-327">更改队列读取器代理的安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-327">To change security settings for the Queue Reader Agent</span></span>  
  
1.  <span data-ttu-id="6b96a-328">在分发服务器上，执行 [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-328">At the Distributor, execute [sp_helpqreader_agent](/sql/relational-databases/system-stored-procedures/sp-helpqreader-agent-transact-sql).</span></span> <span data-ttu-id="6b96a-329">此操作将返回队列读取器代理运行时所用的当前 Windows 帐户。</span><span class="sxs-lookup"><span data-stu-id="6b96a-329">This returns the current Windows account under which the Queue Reader Agent runs.</span></span>  
  
    -   <span data-ttu-id="6b96a-330">在分发服务器上，执行[sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql)，并为\*\* \@ Job_login**和** \@ job_passwsord\*\*指定 Windows 帐户设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-330">At the Distributor, execute [sp_changeqreader_agent](/sql/relational-databases/system-stored-procedures/sp-changeqreader-agent-transact-sql), specifying the Windows account settings for **\@job_login** and **\@job_passwsord**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6b96a-331">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-331">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span> <span data-ttu-id="6b96a-332">每个分发数据库都有一个队列读取器代理。</span><span class="sxs-lookup"><span data-stu-id="6b96a-332">There is one Queue Reader Agent for each distribution database.</span></span> <span data-ttu-id="6b96a-333">更改代理的安全设置会影响使用此分发数据库的所有发布服务器上所有发布的设置。</span><span class="sxs-lookup"><span data-stu-id="6b96a-333">Changing the security settings for the agent affects the settings for all publications at all Publishers that use this distribution database.</span></span>  
  
2.  <span data-ttu-id="6b96a-334">对于订阅，队列读取器代理使用与分发代理相同的连接上下文与订阅服务器建立连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-334">The Queue Reader Agent makes connections to the Subscriber using the same connection context as the Distribution Agent for the subscription.</span></span>  
  
#### <a name="to-change-security-mode-used-by-an-immediate-updating-subscriber-when-connecting-to-the-publisher"></a><span data-ttu-id="6b96a-335">更改立即更新订阅服务器连接到发布服务器时所用的安全模式</span><span class="sxs-lookup"><span data-stu-id="6b96a-335">To change security mode used by an immediate updating Subscriber when connecting to the Publisher</span></span>  
  
1.  <span data-ttu-id="6b96a-336">在订阅服务器上的订阅数据库中，执行 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="6b96a-336">At the Subscriber on the subscription database, execute [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql).</span></span> <span data-ttu-id="6b96a-337">指定 " \*\* \@ 发布服务器**"、" \*\* \@ 发布**"、"用于\*\* \@ publisher_db**的发布数据库的名称" 和 " \*\* \@ security_mode**的以下值之一：</span><span class="sxs-lookup"><span data-stu-id="6b96a-337">Specify **\@publisher**, **\@publication**, the name of the publication database for **\@publisher_db**, and one of the following values for **\@security_mode**:</span></span>  
  
    -   <span data-ttu-id="6b96a-338">**0** ，表示在发布服务器上执行更新时使用 SQL Server 身份验证。</span><span class="sxs-lookup"><span data-stu-id="6b96a-338">**0** to use SQL Server Authentication when making updates at the Publisher.</span></span> <span data-ttu-id="6b96a-339">此选项要求在发布服务器上指定有效\*\* \@ 的登录名和\*\* \*\* \@ 密码\*\*。</span><span class="sxs-lookup"><span data-stu-id="6b96a-339">This option requires you to specify a valid login at the Publisher for **\@login** and **\@password**.</span></span>  
  
    -   <span data-ttu-id="6b96a-340">**1** ，表示连接到发布服务器时使用在订阅服务器上执行更改的用户的安全上下文。</span><span class="sxs-lookup"><span data-stu-id="6b96a-340">**1** to use the security context of the user making changes at the Subscriber when connecting to the Publisher.</span></span> <span data-ttu-id="6b96a-341">请参阅 [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) ，了解与此安全模式相关的限制。</span><span class="sxs-lookup"><span data-stu-id="6b96a-341">See [sp_link_publication](/sql/relational-databases/system-stored-procedures/sp-link-publication-transact-sql) for restrictions related to this security mode.</span></span>  
  
    -   <span data-ttu-id="6b96a-342">**2**，表示使用现有的、用户定义的链接服务器登录名，该登录名是使用 [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) 创建的。</span><span class="sxs-lookup"><span data-stu-id="6b96a-342">**2** to use an existing, user-defined linked server login created using [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql).</span></span>  
  
#### <a name="to-change-the-password-for-a-remote-distributor"></a><span data-ttu-id="6b96a-343">更改远程分发服务器的密码</span><span class="sxs-lookup"><span data-stu-id="6b96a-343">To change the password for a remote Distributor</span></span>  
  
1.  <span data-ttu-id="6b96a-344">在分发服务器上，对分发数据库执行[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)，并为\*\* \@ 密码\*\*指定此登录名的新密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-344">At the Distributor on the distribution database, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the new password for this login for **\@password**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="6b96a-345">不要直接更改 **distributor_admin** 的密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-345">Do not change the password for **distributor_admin** directly.</span></span>  
  
2.  <span data-ttu-id="6b96a-346">在每个使用此远程分发服务器的发布服务器上，执行[sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql)，同时为\*\* \@ 密码\*\*指定步骤1中的密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-346">At every Publisher that uses this remote Distributor, execute [sp_changedistributor_password](/sql/relational-databases/system-stored-procedures/sp-changedistributor-password-transact-sql), specifying the password from step 1 for **\@password**.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="6b96a-347">使用复制管理对象 (RMO)</span><span class="sxs-lookup"><span data-stu-id="6b96a-347">Using Replication Management Objects (RMO)</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6b96a-348">如果可能，请在运行时提示用户输入安全凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-348">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="6b96a-349">如果必须存储凭据，请使用 [Windows .NET Framework 提供的](https://go.microsoft.com/fwlink/?LinkId=34733) Cryptographic Services [!INCLUDE[msCoName](../../../includes/msconame-md.md)] （加密服务）。</span><span class="sxs-lookup"><span data-stu-id="6b96a-349">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-change-all-instances-of-a-password-stored-on-a-replication-server"></a><span data-ttu-id="6b96a-350">更改存储在复制服务器上的某个密码的所有实例</span><span class="sxs-lookup"><span data-stu-id="6b96a-350">To change all instances of a password stored on a replication server</span></span>  
  
1.  <span data-ttu-id="6b96a-351">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与复制服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-351">Create a connection to the replication server by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-352">使用步骤 1 中的连接创建 <xref:Microsoft.SqlServer.Replication.ReplicationServer> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-352">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class by using the connection from step 1.</span></span>  
  
3.  <span data-ttu-id="6b96a-353">调用 <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="6b96a-353">Call the <xref:Microsoft.SqlServer.Replication.ReplicationServer.ChangeReplicationServerPasswords%2A> method.</span></span> <span data-ttu-id="6b96a-354">指定下列参数：</span><span class="sxs-lookup"><span data-stu-id="6b96a-354">Specify the following parameters:</span></span>  
  
    -   <span data-ttu-id="6b96a-355">*security_mode* - 一个用于指定身份验证类型的 <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> 值，该类型的密码的所有实例都将进行更改。</span><span class="sxs-lookup"><span data-stu-id="6b96a-355">*security_mode* - a <xref:Microsoft.SqlServer.Replication.ReplicationSecurityMode> value that specifies the type of authentication for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="6b96a-356">*login* - 其密码的所有实例都将进行更改的登录名。</span><span class="sxs-lookup"><span data-stu-id="6b96a-356">*login* - the login for which all instances of the password are being changed.</span></span>  
  
    -   <span data-ttu-id="6b96a-357">*password* - 新的密码值。</span><span class="sxs-lookup"><span data-stu-id="6b96a-357">*password* - the new password value.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="6b96a-358">如果可能，请在运行时提示用户输入安全凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-358">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="6b96a-359">如果必须存储凭据，请使用 Windows .NET Framework 提供的 [Cryptographic Services](https://go.microsoft.com/fwlink/?LinkId=34733) （加密服务）。</span><span class="sxs-lookup"><span data-stu-id="6b96a-359">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the Windows .NET Framework.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6b96a-360">只有 `sysadmin` 固定服务器角色的成员才能调用此方法。</span><span class="sxs-lookup"><span data-stu-id="6b96a-360">Only a member of the `sysadmin` fixed server role can call this method.</span></span>  
  
4.  <span data-ttu-id="6b96a-361">对复制拓扑中需要更新密码的每个服务器重复步骤 1-3。</span><span class="sxs-lookup"><span data-stu-id="6b96a-361">Repeat steps 1-3 at every server in the replication topology where the password must be updated.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="6b96a-362">为事务发布的推送订阅的分发代理更改安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-362">To change security settings for the Distribution Agent for a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="6b96a-363">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与发布服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-363">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-364">创建的 <xref:Microsoft.SqlServer.Replication.TransSubscription> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-364">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
3.  <span data-ttu-id="6b96a-365">设置订阅的 <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>和 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> 属性，并为 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置步骤 1 中的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-365">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="6b96a-366">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="6b96a-366">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6b96a-367">如果此方法返回 `false`，则说明步骤 3 中的订阅属性没有正确定义或该订阅不存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-367">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="6b96a-368">对 <xref:Microsoft.SqlServer.Replication.TransSubscription>实例设置下列一个或多个安全属性：</span><span class="sxs-lookup"><span data-stu-id="6b96a-368">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransSubscription>:</span></span>  
  
    -   <span data-ttu-id="6b96a-369">若要更改用于运行代理的 Windows 帐户的凭据，请设置 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>字段。</span><span class="sxs-lookup"><span data-stu-id="6b96a-369">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="6b96a-370">若要指定 Windows 集成身份验证作为代理连接到订阅服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-370">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-371">若要指定 SQL Server 身份验证作为代理连接到订阅服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 为 `false` ，并为和字段指定订阅服务器登录凭据 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-371">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6b96a-372">在建立代理与分发服务器之间的连接时将始终使用由 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-372">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="6b96a-373">此帐户还用于建立使用 Windows 身份验证的远程连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-373">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="6b96a-374">（可选）如果已将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `true`，则调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法以在服务器上提交更改。</span><span class="sxs-lookup"><span data-stu-id="6b96a-374">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="6b96a-375">如果将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `false`（默认值），则会将更改立即发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-375">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-distribution-agent-for-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="6b96a-376">为事务发布的请求订阅的分发代理更改安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-376">To change security settings for the Distribution Agent for a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="6b96a-377">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与订阅服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-377">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-378">创建的 <xref:Microsoft.SqlServer.Replication.TransPullSubscription> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-378">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="6b96a-379">设置订阅的 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>和 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> 属性，并为 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置步骤 1 中的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-379">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="6b96a-380">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="6b96a-380">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6b96a-381">如果此方法返回 `false`，则说明步骤 3 中的订阅属性没有正确定义或该订阅不存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-381">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="6b96a-382">对 <xref:Microsoft.SqlServer.Replication.TransPullSubscription>实例设置下列一个或多个安全属性：</span><span class="sxs-lookup"><span data-stu-id="6b96a-382">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.TransPullSubscription>:</span></span>  
  
    -   <span data-ttu-id="6b96a-383">若要更改用于运行代理的 Windows 帐户的凭据，请设置 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>字段。</span><span class="sxs-lookup"><span data-stu-id="6b96a-383">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="6b96a-384">若要指定 Windows 集成身份验证作为代理连接到分发服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-384">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-385">若要指定 SQL Server 身份验证作为代理连接到分发服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 为 `false` ，并为和字段指定分发服务器登录凭据 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-385">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6b96a-386">在建立代理与订阅服务器之间的连接时将始终使用由 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-386">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="6b96a-387">此帐户还用于建立使用 Windows 身份验证的远程连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-387">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="6b96a-388">（可选）如果已将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `true`，则调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法以在服务器上提交更改。</span><span class="sxs-lookup"><span data-stu-id="6b96a-388">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="6b96a-389">如果将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `false`（默认值），则会将更改立即发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-389">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="6b96a-390">为合并发布的请求订阅的合并代理更改安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-390">To change security settings for the Merge Agent for a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="6b96a-391">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与订阅服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-391">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-392">创建的 <xref:Microsoft.SqlServer.Replication.MergePullSubscription> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-392">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class.</span></span>  
  
3.  <span data-ttu-id="6b96a-393">设置订阅的 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>和 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> 属性，并为 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置步骤 1 中的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-393">Set the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, and <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="6b96a-394">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="6b96a-394">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6b96a-395">如果此方法返回 `false`，则说明步骤 3 中的订阅属性没有正确定义或该订阅不存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-395">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="6b96a-396">对 <xref:Microsoft.SqlServer.Replication.MergePullSubscription>实例设置下列一个或多个安全属性：</span><span class="sxs-lookup"><span data-stu-id="6b96a-396">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergePullSubscription>:</span></span>  
  
    -   <span data-ttu-id="6b96a-397">若要更改用于运行代理的 Windows 帐户的凭据，请设置 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>字段。</span><span class="sxs-lookup"><span data-stu-id="6b96a-397">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="6b96a-398">若要指定 Windows 集成身份验证作为代理连接到分发服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-398">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-399">若要指定 SQL Server 身份验证作为代理连接到分发服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> 为 `false` ，并为和字段指定分发服务器登录凭据 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-399">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Distributor, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.DistributorSecurity%2A> property to `false`, and specify the Distributor login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="6b96a-400">若要指定 Windows 集成身份验证作为代理连接到发布服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-400">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-401">若要指定 SQL Server 身份验证作为代理连接到发布服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> 为 `false` ，并为和字段指定发布服务器登录凭据 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-401">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6b96a-402">在建立代理与订阅服务器之间的连接时将始终使用由 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-402">The agent connection to the Subscriber is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="6b96a-403">此帐户还用于建立使用 Windows 身份验证的远程连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-403">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="6b96a-404">（可选）如果已将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `true`，则调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法以在服务器上提交更改。</span><span class="sxs-lookup"><span data-stu-id="6b96a-404">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="6b96a-405">如果将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `false`（默认值），则会将更改立即发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-405">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-security-settings-for-the-merge-agent-for-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="6b96a-406">为合并发布的推送订阅的合并代理更改安全设置</span><span class="sxs-lookup"><span data-stu-id="6b96a-406">To change security settings for the Merge Agent for a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="6b96a-407">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与发布服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-407">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-408">创建的 <xref:Microsoft.SqlServer.Replication.MergeSubscription> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-408">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
3.  <span data-ttu-id="6b96a-409">设置订阅的 <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>、 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>和 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> 属性，并为 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置步骤 1 中的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-409">Set the <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, and <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A> properties for the subscription, and set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
4.  <span data-ttu-id="6b96a-410">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="6b96a-410">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6b96a-411">如果此方法返回 `false`，则说明步骤 3 中的订阅属性没有正确定义或该订阅不存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-411">If this method returns `false`, either the subscription properties in step 3 were defined incorrectly or the subscription does not exist.</span></span>  
  
5.  <span data-ttu-id="6b96a-412">对 <xref:Microsoft.SqlServer.Replication.MergeSubscription>实例设置下列一个或多个安全属性：</span><span class="sxs-lookup"><span data-stu-id="6b96a-412">Set one or more of the following security properties on the instance of <xref:Microsoft.SqlServer.Replication.MergeSubscription>:</span></span>  
  
    -   <span data-ttu-id="6b96a-413">若要更改用于运行代理的 Windows 帐户的凭据，请设置 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> 的 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 和 <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>字段。</span><span class="sxs-lookup"><span data-stu-id="6b96a-413">To change the credentials for the Windows account under which the agent runs, set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.SynchronizationAgentProcessSecurity%2A>.</span></span>  
  
    -   <span data-ttu-id="6b96a-414">若要指定 Windows 集成身份验证作为代理连接到订阅服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-414">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-415">若要指定 SQL Server 身份验证作为代理连接到订阅服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 为 `false` ，并为和字段指定订阅服务器登录凭据 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-415">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Subscriber, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> property to `false`, and specify the Subscriber login credentials for the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
    -   <span data-ttu-id="6b96a-416">若要指定 Windows 集成身份验证作为代理连接到发布服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的 <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> 字段设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="6b96a-416">To specify Windows Integrated Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `true`.</span></span>  
  
    -   <span data-ttu-id="6b96a-417">若要指定 SQL Server 身份验证作为代理连接到发布服务器时使用的身份验证类型，请将 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> 属性的字段设置 <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> 为 `false` ，并为和字段指定发布服务器登录凭据 <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> 。</span><span class="sxs-lookup"><span data-stu-id="6b96a-417">To specify SQL Server Authentication as the type of authentication that the agent uses when it connects to the Publisher, set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.WindowsAuthentication%2A> field of the <xref:Microsoft.SqlServer.Replication.MergeSubscription.PublisherSecurity%2A> property to `false`, and specify the Publisher login credentials for the <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext.SqlStandardPassword%2A> fields.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="6b96a-418">在建立代理与分发服务器之间的连接时将始终使用由 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>指定的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-418">The agent connection to the Distributor is always made using the Windows credentials specified by <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>.</span></span> <span data-ttu-id="6b96a-419">此帐户还用于建立使用 Windows 身份验证的远程连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-419">This account is also used to make remote connections using Windows Authentication.</span></span>  
  
6.  <span data-ttu-id="6b96a-420">（可选）如果已将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `true`，则调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 方法以在服务器上提交更改。</span><span class="sxs-lookup"><span data-stu-id="6b96a-420">(Optional) If you specified a value of `true` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A>, call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method to commit changes on the server.</span></span> <span data-ttu-id="6b96a-421">如果将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> 的值指定为 `false`（默认值），则会将更改立即发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="6b96a-421">If you specified a value of `false` for <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> (the default), changes are sent to the server immediately.</span></span>  
  
#### <a name="to-change-the-login-information-used-by-an-immediate-updating-subscriber-when-it-connects-to-the-transactional-publisher"></a><span data-ttu-id="6b96a-422">更改即时更新订阅服务器连接到事务发布服务器时使用的登录信息</span><span class="sxs-lookup"><span data-stu-id="6b96a-422">To change the login information used by an immediate updating Subscriber when it connects to the transactional publisher</span></span>  
  
1.  <span data-ttu-id="6b96a-423">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与订阅服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6b96a-423">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="6b96a-424">为订阅数据库创建 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="6b96a-424">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the subscription database.</span></span> <span data-ttu-id="6b96a-425">为 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> 指定步骤 1 中的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 和 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>。</span><span class="sxs-lookup"><span data-stu-id="6b96a-425">Specify <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.Name%2A> and the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="6b96a-426">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="6b96a-426">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="6b96a-427">如果此方法返回 `false`，则说明步骤 2 中的数据库属性定义不正确或此订阅数据库不存在。</span><span class="sxs-lookup"><span data-stu-id="6b96a-427">If this method returns `false`, either the database properties in step 2 were defined incorrectly or the subscription database does not exist.</span></span>  
  
4.  <span data-ttu-id="6b96a-428">调用 <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> 方法，传递以下参数：</span><span class="sxs-lookup"><span data-stu-id="6b96a-428">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LinkPublicationForUpdateableSubscription%2A> method, passing the following parameters:</span></span>  
  
    -   <span data-ttu-id="6b96a-429">*Publisher* - 发布服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="6b96a-429">*Publisher* - the name of the Publisher.</span></span>  
  
    -   <span data-ttu-id="6b96a-430">*PublisherDB* - 发布数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="6b96a-430">*PublisherDB* - the name of the publication database.</span></span>  
  
    -   <span data-ttu-id="6b96a-431">*Publication* - 即时更新订阅服务器所订阅的发布的名称。</span><span class="sxs-lookup"><span data-stu-id="6b96a-431">*Publication* - the name of the publication to which the immediate updating Subscriber is subscribed.</span></span>  
  
    -   <span data-ttu-id="6b96a-432">*Distributor* - 分发服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="6b96a-432">*Distributor* - the name of the Distributor.</span></span>  
  
    -   <span data-ttu-id="6b96a-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> 对象，用于指定即时更新订阅服务器在连接到发布服务器时使用的安全模式类型和连接的登录凭据。</span><span class="sxs-lookup"><span data-stu-id="6b96a-433">*PublisherSecurity* - A <xref:Microsoft.SqlServer.Replication.PublisherConnectionSecurityContext> object that specifies the type of security mode used by the immediate updating Subscriber when connecting to the Publisher and login credentials for the connection.</span></span>  
  
###  <a name="example-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="6b96a-434">示例 (RMO)</span><span class="sxs-lookup"><span data-stu-id="6b96a-434">Example (RMO)</span></span>  
 <span data-ttu-id="6b96a-435">本示例将检查提供的登录值并为所提供的 Windows 登录名或 SQL Server 登录名（由服务器上的复制存储）更改所有密码。</span><span class="sxs-lookup"><span data-stu-id="6b96a-435">This example checks the supplied login value and changes all passwords for the supplied Windows login or SQL Server login stored by replication on the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeServerPasswords](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changeserverpasswords)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeServerPasswords](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changeserverpasswords)]  
  
##  <a name="follow-up-after-you-modify-replication-security-settings"></a><a name="FollowUp"></a> <span data-ttu-id="6b96a-436">跟进：修改复制安全设置后</span><span class="sxs-lookup"><span data-stu-id="6b96a-436">Follow Up: After you modify replication security settings</span></span>  
 <span data-ttu-id="6b96a-437">更改代理登录名或密码之后，必须先停止并重新启动代理，然后更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="6b96a-437">After changing an agent login or password, you must stop and restart the agent before the change takes effect.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6b96a-438">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6b96a-438">See Also</span></span>  
 <span data-ttu-id="6b96a-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="6b96a-439">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="6b96a-440">[升级复制脚本（复制 Transact-SQL 编程）](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span><span class="sxs-lookup"><span data-stu-id="6b96a-440">[Upgrade Replication Scripts &#40;Replication Transact-SQL Programming&#41;](../administration/upgrade-replication-scripts-replication-transact-sql-programming.md) </span></span>  
 <span data-ttu-id="6b96a-441">[管理复制中的登录名和密码](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span><span class="sxs-lookup"><span data-stu-id="6b96a-441">[Manage Logins and Passwords in Replication](identity-and-access-control-replication.md#manage-logins-and-passwords-in-replication) </span></span>  
 <span data-ttu-id="6b96a-442">[复制代理安全模式](replication-agent-security-model.md) </span><span class="sxs-lookup"><span data-stu-id="6b96a-442">[Replication Agent Security Model](replication-agent-security-model.md) </span></span>  
 <span data-ttu-id="6b96a-443">[Replication Security Best Practices](replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="6b96a-443">[Replication Security Best Practices](replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="6b96a-444">[SQL Server 复制安全性](view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="6b96a-444">[SQL Server Replication Security](view-and-modify-replication-security-settings.md) </span></span>  
 [<span data-ttu-id="6b96a-445">Replication System Stored Procedures Concepts</span><span class="sxs-lookup"><span data-stu-id="6b96a-445">Replication System Stored Procedures Concepts</span></span>](../concepts/replication-system-stored-procedures-concepts.md)  
  
  
