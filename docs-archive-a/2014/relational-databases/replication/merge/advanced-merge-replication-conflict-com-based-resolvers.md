---
title: Microsoft 基于 COM 的冲突解决程序 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b446c3300b2c8a440a092084f01c55105c9be95e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87690567"
---
# <a name="microsoft-com-based-resolvers"></a><span data-ttu-id="88c52-102">Microsoft COM-Based Resolvers</span><span class="sxs-lookup"><span data-stu-id="88c52-102">Microsoft COM-Based Resolvers</span></span>
  <span data-ttu-id="88c52-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 附带的所有基于 COM 的解决程序都处理更新冲突，并且在得到指示时，它们还会处理插入和删除冲突。</span><span class="sxs-lookup"><span data-stu-id="88c52-103">All of the COM-based resolvers supplied with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] handle update conflicts, and where indicated, they also handle insert and delete conflicts.</span></span> <span data-ttu-id="88c52-104">所有冲突解决程序都能处理列跟踪，大多数还能处理行跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-104">They all handle column tracking; most also handle row tracking.</span></span> <span data-ttu-id="88c52-105">这些冲突解决程序及所有其他基于 COM 的冲突解决程序都声明它们能处理的冲突类型，而合并复制代理使用默认的冲突解决程序处理所有其他冲突类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-105">These and all other COM-based resolvers declare the types of conflict they can handle, and the Merge Agent uses the default resolver for all other conflict types.</span></span>  
  
 <span data-ttu-id="88c52-106">冲突解决程序在安装 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]时安装。</span><span class="sxs-lookup"><span data-stu-id="88c52-106">The resolvers are installed during the installation process for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="88c52-107">可执行存储过程 **sp_enumcustomresolvers** 查看计算机上注册的所有冲突解决程序。</span><span class="sxs-lookup"><span data-stu-id="88c52-107">Execute the **sp_enumcustomresolvers** stored procedure to view all the conflict resolvers registered on a computer.</span></span> <span data-ttu-id="88c52-108">执行此过程将在一个单独的结果集中显示每个冲突解决程序的说明和全局唯一标识符 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="88c52-108">Executing the procedure displays the description and globally unique identifier (GUID) for each resolver in a separate result set.</span></span>  
  
 <span data-ttu-id="88c52-109">若要指定冲突解决程序，请参阅 [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md)。</span><span class="sxs-lookup"><span data-stu-id="88c52-109">To specify a resolver, see [Specify a Merge Article Resolver](../publish/specify-a-merge-article-resolver.md).</span></span>  
  
 <span data-ttu-id="88c52-110">下表说明了特定冲突解决程序的属性。</span><span class="sxs-lookup"><span data-stu-id="88c52-110">The following table describes the attributes of the specific resolvers.</span></span>  
  
|<span data-ttu-id="88c52-111">名称</span><span class="sxs-lookup"><span data-stu-id="88c52-111">Name</span></span>|<span data-ttu-id="88c52-112">要求的输入</span><span class="sxs-lookup"><span data-stu-id="88c52-112">Required input</span></span>|<span data-ttu-id="88c52-113">说明</span><span class="sxs-lookup"><span data-stu-id="88c52-113">Description</span></span>|<span data-ttu-id="88c52-114">注释</span><span class="sxs-lookup"><span data-stu-id="88c52-114">Comments</span></span>|  
|----------|--------------------|-----------------|--------------|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 累加性冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-115">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver</span></span>|<span data-ttu-id="88c52-116">要求和的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-116">Name of the column to be summed.</span></span> <span data-ttu-id="88c52-117">它必须为算术数据类型（例如 **int**、 **smallint**、 **numeric**等）。</span><span class="sxs-lookup"><span data-stu-id="88c52-117">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="88c52-118">冲突解决入选方由优先级值确定。</span><span class="sxs-lookup"><span data-stu-id="88c52-118">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="88c52-119">指定列的值设置为源列值与目标列值之和。</span><span class="sxs-lookup"><span data-stu-id="88c52-119">Specified column values are set to the sum of the source and the destination column values.</span></span> <span data-ttu-id="88c52-120">如果其中一列设置为 NULL，则结果按另一列的值设置。</span><span class="sxs-lookup"><span data-stu-id="88c52-120">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="88c52-121">只支持更新冲突和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-121">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 平均化冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-122">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Averaging Conflict Resolver</span></span>|<span data-ttu-id="88c52-123">要平均化的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-123">Name of the column to be averaged.</span></span> <span data-ttu-id="88c52-124">它必须为算术数据类型（例如 **int**、 **smallint**、 **numeric**等）。</span><span class="sxs-lookup"><span data-stu-id="88c52-124">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="88c52-125">冲突解决入选方由优先级值确定。</span><span class="sxs-lookup"><span data-stu-id="88c52-125">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="88c52-126">所得列的值设置为源列值与目标列值的平均值。</span><span class="sxs-lookup"><span data-stu-id="88c52-126">The resulting column values are set to the average of the source and the destination column values.</span></span> <span data-ttu-id="88c52-127">如果其中一列设置为 NULL，则结果按另一列的值设置。</span><span class="sxs-lookup"><span data-stu-id="88c52-127">If one is set to NULL, they are set to the value of the other column.</span></span>|<span data-ttu-id="88c52-128">只支持更新冲突和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-128">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME（靠前首选）冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-129">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Earlier Wins) Conflict Resolver</span></span>|<span data-ttu-id="88c52-130">用于确定冲突解决入选方的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-130">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="88c52-131">它必须为 **datetime** 数据类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-131">It must have a **datetime** data type.</span></span>|<span data-ttu-id="88c52-132">具有较早的 **datetime** 值的列确定冲突解决入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-132">Column with the earlier **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="88c52-133">如果其中一列设置为 NULL，则包含另一列的行为入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-133">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="88c52-134">支持更新冲突、行和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-134">Supports update conflicts, row, and column tracking.</span></span> <span data-ttu-id="88c52-135">列值直接进行比较，并且不对不同的时区进行比较。</span><span class="sxs-lookup"><span data-stu-id="88c52-135">The column values are compared directly and an adjustment is not made for different time zones.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME（靠后首选）冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-136">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DATETIME (Later Wins) Conflict Resolver</span></span>|<span data-ttu-id="88c52-137">用于确定冲突解决入选方的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-137">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="88c52-138">它必须为 **datetime** 数据类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-138">It must have **datetime** data type.</span></span>|<span data-ttu-id="88c52-139">具有较晚的 **datetime** 值的列确定冲突解决入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-139">Column with the later **datetime** value determines the conflict winner.</span></span> <span data-ttu-id="88c52-140">如果其中一列设置为 NULL，则包含另一列的行为入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-140">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="88c52-141">支持更新冲突、行和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-141">Supports update conflicts, row, and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最大冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-142">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Maximum Conflict Resolver</span></span>|<span data-ttu-id="88c52-143">用于确定冲突解决入选方的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-143">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="88c52-144">它必须为算术数据类型（例如 **int**、 **smallint**、 **numeric**等）。</span><span class="sxs-lookup"><span data-stu-id="88c52-144">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="88c52-145">具有较大数值的列确定冲突解决入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-145">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="88c52-146">如果其中一列设置为 NULL，则包含另一列的行为入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-146">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="88c52-147">支持行和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-147">Supports row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 最小冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Minimum Conflict Resolver</span></span>|<span data-ttu-id="88c52-149">用于确定冲突解决入选方的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-149">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="88c52-150">它必须为算术数据类型（例如 **int**、 **smallint**、 **numeric**等）。</span><span class="sxs-lookup"><span data-stu-id="88c52-150">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="88c52-151">具有较小数值的列确定冲突解决入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-151">Column with the smaller numeric value determines the conflict winner.</span></span> <span data-ttu-id="88c52-152">如果其中一列设置为 NULL，则包含另一列的行为入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-152">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="88c52-153">支持更新冲突、行和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-153">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 合并文本冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-154">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Merge Text Conflict Resolver</span></span>|<span data-ttu-id="88c52-155">文本列的名称和分隔符，例如 `@resolver_info = '[col1][===]'`。</span><span class="sxs-lookup"><span data-stu-id="88c52-155">Name of the text column and delimiter, for example, `@resolver_info = '[col1][===]'`.</span></span>|<span data-ttu-id="88c52-156">冲突解决入选方由优先级值确定。</span><span class="sxs-lookup"><span data-stu-id="88c52-156">Conflict winner is determined from the priority value.</span></span> <span data-ttu-id="88c52-157">冲突的文本列设置为合并值，该值的构成是：通用前缀，后面依次跟着发布服务器的特有部分、分隔符及订阅服务器的特有部分。</span><span class="sxs-lookup"><span data-stu-id="88c52-157">The text columns in conflict are set to the merged value, consisting of the common prefix followed by the unique part from the Publisher, then by the delimiter, and finally by the unique part from the Subscriber.</span></span>|<span data-ttu-id="88c52-158">只支持更新冲突和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-158">Supports update conflicts, column tracking only.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 首选订阅服务器冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-159">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscriber Always Wins Conflict Resolver</span></span>|<span data-ttu-id="88c52-160">无输入。</span><span class="sxs-lookup"><span data-stu-id="88c52-160">No inputs.</span></span>|<span data-ttu-id="88c52-161">订阅服务器无论是作为源服务器还是目的服务器，始终是入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-161">Subscriber, regardless of whether it is the source or destination, is the winner.</span></span>|<span data-ttu-id="88c52-162">支持所有冲突类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-162">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 列优先冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-163">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Priority Column Resolver</span></span>|<span data-ttu-id="88c52-164">用于确定冲突解决入选方的列的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-164">Name of the column to be used to determine the conflict winner.</span></span> <span data-ttu-id="88c52-165">它必须为算术数据类型（例如 **int**、 **smallint**、 **numeric**等）。</span><span class="sxs-lookup"><span data-stu-id="88c52-165">It must have an arithmetic data type (such as **int**, **smallint**, **numeric**, and so on).</span></span>|<span data-ttu-id="88c52-166">具有较大数值的列确定冲突解决入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-166">Column with the larger numeric value determines the conflict winner.</span></span> <span data-ttu-id="88c52-167">如果其中一列设置为 NULL，则包含另一列的行为入选方。</span><span class="sxs-lookup"><span data-stu-id="88c52-167">If one is set to NULL, the row containing the other is the winner.</span></span>|<span data-ttu-id="88c52-168">支持更新冲突、行和列跟踪。</span><span class="sxs-lookup"><span data-stu-id="88c52-168">Supports update conflicts, row and column tracking.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 仅限上传冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-169">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Upload Only Conflict Resolver</span></span>|<span data-ttu-id="88c52-170">无输入。</span><span class="sxs-lookup"><span data-stu-id="88c52-170">No inputs.</span></span>|<span data-ttu-id="88c52-171">接受上载到发布服务器的更改；但更改不下载到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="88c52-171">Changes uploaded to the Publisher are accepted; changes are not downloaded to the Subscriber.</span></span>|<span data-ttu-id="88c52-172">支持所有冲突类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-172">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 仅限下载冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-173">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Download Only Conflict Resolver</span></span>|<span data-ttu-id="88c52-174">无输入。</span><span class="sxs-lookup"><span data-stu-id="88c52-174">No inputs.</span></span>|<span data-ttu-id="88c52-175">拒绝上载到发布服务器的更改；但更改下载到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="88c52-175">Changes uploaded to the Publisher are rejected; changes are downloaded to the Subscriber.</span></span>|<span data-ttu-id="88c52-176">支持所有冲突类型。</span><span class="sxs-lookup"><span data-stu-id="88c52-176">Supports all conflict types.</span></span>|  
|[!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="88c52-177">SQL Server 存储过程冲突解决程序</span><span class="sxs-lookup"><span data-stu-id="88c52-177">SQLServer Stored Procedure Resolver</span></span>|<span data-ttu-id="88c52-178">冲突解决程序为处理冲突应调用的存储过程的名称。</span><span class="sxs-lookup"><span data-stu-id="88c52-178">Name of the stored procedure the resolver should call to handle the conflict.</span></span>|<span data-ttu-id="88c52-179">冲突解决取决于在存储过程中指定的逻辑。</span><span class="sxs-lookup"><span data-stu-id="88c52-179">Conflict resolution depends on the logic in the stored procedure you specify.</span></span>|<span data-ttu-id="88c52-180">支持更新冲突。</span><span class="sxs-lookup"><span data-stu-id="88c52-180">Supports update conflicts.</span></span> <span data-ttu-id="88c52-181">有关详细信息，请参阅[为合并项目实现自定义冲突解决程序](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span><span class="sxs-lookup"><span data-stu-id="88c52-181">For more information, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md)</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="88c52-182">另请参阅</span><span class="sxs-lookup"><span data-stu-id="88c52-182">See Also</span></span>  
 <span data-ttu-id="88c52-183">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="88c52-183">[Advanced Merge Replication Conflict Detection and Resolution](advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="88c52-184">sp_enumcustomresolvers (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="88c52-184">sp_enumcustomresolvers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql)  
  
  
