---
title: 为事务项目的数据更改设置传播方法 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, propagation methods
- propagating data changes [SQL Server replication]
ms.assetid: 0a291582-f034-42da-a1a3-29535b607b74
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: a3f8be8b6df1034b06d0aaff6ee61c0c494833c5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87690511"
---
# <a name="set-the-propagation-method-for-data-changes-to-transactional-articles"></a><span data-ttu-id="55573-102">为事务项目的数据更改设置传播方法</span><span class="sxs-lookup"><span data-stu-id="55573-102">Set the Propagation Method for Data Changes to Transactional Articles</span></span>
  <span data-ttu-id="55573-103">本主题说明如何使用 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 或 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] 在 [!INCLUDE[tsql](../../../includes/tsql-md.md)]中为事务项目的数据更改设置传播方法。</span><span class="sxs-lookup"><span data-stu-id="55573-103">This topic describes how to set the propagation method for data changes to transactional articles in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
 <span data-ttu-id="55573-104">默认情况下，事务复制使用一组存储过程将每个项目的更改传播到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="55573-104">By default, transactional replication propagates changes to Subscribers using a set of stored procedures for each article.</span></span> <span data-ttu-id="55573-105">可以使用自定义过程替换这些存储过程。</span><span class="sxs-lookup"><span data-stu-id="55573-105">You can replace these procedures with custom procedures.</span></span> <span data-ttu-id="55573-106">有关详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-106">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
 <span data-ttu-id="55573-107">**本主题内容**</span><span class="sxs-lookup"><span data-stu-id="55573-107">**In This Topic**</span></span>  
  
-   <span data-ttu-id="55573-108">**开始之前：**</span><span class="sxs-lookup"><span data-stu-id="55573-108">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="55573-109">限制和局限</span><span class="sxs-lookup"><span data-stu-id="55573-109">Limitations and Restrictions</span></span>](#Restrictions)  
  
-   <span data-ttu-id="55573-110">**为事务项目的数据更改设置传播方法，使用：**</span><span class="sxs-lookup"><span data-stu-id="55573-110">**To set the propagation method for data changes to transactional articles, using:**</span></span>  
  
     [<span data-ttu-id="55573-111">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="55573-111">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="55573-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="55573-112">Transact-SQL</span></span>](#TsqlProcedure)  
  
## <a name="before-you-begin"></a><span data-ttu-id="55573-113">开始之前</span><span class="sxs-lookup"><span data-stu-id="55573-113">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="55573-114">限制和局限</span><span class="sxs-lookup"><span data-stu-id="55573-114">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="55573-115">在编辑复制生成的任何快照文件时，都必须谨慎。</span><span class="sxs-lookup"><span data-stu-id="55573-115">Care must be taken when editing any of the snapshot files generated by replication.</span></span> <span data-ttu-id="55573-116">必须测试和支持自定义存储过程中的自定义逻辑。</span><span class="sxs-lookup"><span data-stu-id="55573-116">You must test and support custom logic in the custom stored procedures.</span></span> [!INCLUDE[msCoName](../../../includes/msconame-md.md)] <span data-ttu-id="55573-117">不支持自定义逻辑。</span><span class="sxs-lookup"><span data-stu-id="55573-117">does not provide support for custom logic.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="55573-118">使用 SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="55573-118">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="55573-119">在“项目属性 - \<Article>”对话框的“属性”选项卡上指定传播方法，该对话框可在“新建发布”向导和“发布属性 - \<Publication>”对话框中找到  。</span><span class="sxs-lookup"><span data-stu-id="55573-119">Specify the propagation method on the **Properties** tab of the **Article Properties - \<Article>** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="55573-120">有关如何使用该向导和如何访问该对话框的详细信息，请参阅[创建发布](create-a-publication.md)和[查看和修改发布属性](view-and-modify-publication-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-120">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-the-propagation-method"></a><span data-ttu-id="55573-121">指定传播方法</span><span class="sxs-lookup"><span data-stu-id="55573-121">To specify the propagation method</span></span>  
  
1.  <span data-ttu-id="55573-122">在新建发布向导或“发布属性 - \<Publication>”对话框的“项目”页上，选择一个表，然后单击“项目属性”。  </span><span class="sxs-lookup"><span data-stu-id="55573-122">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>  
  
2.  <span data-ttu-id="55573-123">单击 **“设置突出显示的表项目的属性”** 。</span><span class="sxs-lookup"><span data-stu-id="55573-123">Click **Set Properties of Highlighted Table Article**.</span></span>  
  
3.  <span data-ttu-id="55573-124">在“项目属性 - \<Article>”对话框的“属性”选项卡上，在“语句传递”部分中，使用“INSERT 传递格式”、“UPDATE 传递格式”和“DELETE 传递格式”菜单为每个操作指定传播方法     。</span><span class="sxs-lookup"><span data-stu-id="55573-124">On the **Properties** tab of the **Article Properties - \<Article>** dialog box, in the **Statement Delivery** section, specify the propagation method for each operation using the **INSERT delivery format**, **UPDATE delivery format**, and **DELETE delivery format** menus.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
5.  <span data-ttu-id="55573-125">如果处于“发布属性 - \<Publication>”对话框中，请单击“确定”以保存并关闭该对话框 。</span><span class="sxs-lookup"><span data-stu-id="55573-125">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
#### <a name="to-generate-and-use-custom-stored-procedures"></a><span data-ttu-id="55573-126">生成和使用自定义存储过程</span><span class="sxs-lookup"><span data-stu-id="55573-126">To generate and use custom stored procedures</span></span>  
  
1.  <span data-ttu-id="55573-127">在新建发布向导或“发布属性 - \<Publication>”对话框的“项目”页上，选择一个表，然后单击“项目属性”。  </span><span class="sxs-lookup"><span data-stu-id="55573-127">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table, and then click **Article Properties**.</span></span>  
  
2.  <span data-ttu-id="55573-128">单击 **“设置突出显示的表项目的属性”** 。</span><span class="sxs-lookup"><span data-stu-id="55573-128">Click **Set Properties of Highlighted Table Article**.</span></span>  
  
     <span data-ttu-id="55573-129">在“项目属性 - \<Article>”对话框的“属性”选项卡上，在“语句传递”部分中，从适当的传递格式菜单（“INSERT 传递格式”、“UPDATE 传递格式”或“DELETE 传递格式”）中选择 CALL 语法，然后键入要在“INSERT 存储过程”、“DELETE 存储过程”或“UPDATE 存储过程”中使用的过程名称        。</span><span class="sxs-lookup"><span data-stu-id="55573-129">On the **Properties** tab of the **Article Properties - \<Article>** dialog box, in the **Statement Delivery** section, select the CALL syntax from the appropriate delivery format menu (**INSERT delivery format**, **UPDATE delivery format**, or **DELETE delivery format**), and then type the name of the procedure to use in **INSERT stored procedure**, **DELETE stored procedure**, or **UPDATE stored procedure**.</span></span> <span data-ttu-id="55573-130">若要详细了解如何使用存储过程，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)中的“存储过程的调用语法”。</span><span class="sxs-lookup"><span data-stu-id="55573-130">For more information about CALL syntax, see the section "Call syntax for stored procedures" in [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
3.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
4.  <span data-ttu-id="55573-131">如果处于“发布属性 - \<Publication>”对话框中，请单击“确定”以保存并关闭该对话框 。</span><span class="sxs-lookup"><span data-stu-id="55573-131">If you are in the **Publication Properties - \<Publication>** dialog box, click **OK** to save and close the dialog box.</span></span>  
  
5.  <span data-ttu-id="55573-132">发布的快照生成后，将包含上一步骤中指定的过程。</span><span class="sxs-lookup"><span data-stu-id="55573-132">When the snapshot for the publication is generated, it will include the procedure you specified in the previous step.</span></span> <span data-ttu-id="55573-133">这些过程将使用指定的 CALL 语法，但将包含复制使用的默认逻辑。</span><span class="sxs-lookup"><span data-stu-id="55573-133">The procedures will use the CALL syntax you specified, but will include the default logic that replication uses.</span></span>  
  
     <span data-ttu-id="55573-134">快照生成后，定位到此项目所属的发布的快照文件夹，并找到与此项目同名的 **.sch** 文件。</span><span class="sxs-lookup"><span data-stu-id="55573-134">After the snapshot has been generated, navigate to the snapshot folder for the publication to which this article belongs and locate the **.sch** file with the same name as the article.</span></span> <span data-ttu-id="55573-135">使用记事本或其他文本编辑器打开此文件，找到用于插入、更新或删除存储过程的 CREATE PROCEDURE 命令，并编辑过程定义，以为传播数据更改提供自定义逻辑。</span><span class="sxs-lookup"><span data-stu-id="55573-135">Open this file using Notepad or another text editor, locate the CREATE PROCEDURE command for the insert, update, or delete stored procedures, and edit the procedure definition to supply any custom logic for propagating data changes.</span></span> <span data-ttu-id="55573-136">重新生成快照后，必须重新创建自定义过程。</span><span class="sxs-lookup"><span data-stu-id="55573-136">If the snapshot is regenerated, you must re-create the custom procedure.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="55573-137">使用 Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="55573-137">Using Transact-SQL</span></span>  
 <span data-ttu-id="55573-138">通过事务复制，您可以控制如何将更改从发布服务器传播到订阅服务器，而这种传播方法可以在创建和之后更改项目时使用复制存储过程以编程的方式进行设置。</span><span class="sxs-lookup"><span data-stu-id="55573-138">Transactional replication enables you to control how changes are propagated from the Publisher to Subscribers, and this propagation method can be set programmatically when an article is created and changed later using replication stored procedures.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="55573-139">可以为作用于发布数据行的每一种 DML（数据操作语言）操作（插入、更新或删除）指定一种不同的传播方法。</span><span class="sxs-lookup"><span data-stu-id="55573-139">You can specify a different propagation method for each type of DML (data manipulation language) operation (insert, update, or delete) that occurs on a row of a published data.</span></span>  
  
 <span data-ttu-id="55573-140">有关详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-140">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-create-an-article-that-uses-transact-sql-commands-to-propagate-data-changes"></a><span data-ttu-id="55573-141">创建使用 Transact-SQL 命令传播数据更改的项目</span><span class="sxs-lookup"><span data-stu-id="55573-141">To create an article that uses Transact-SQL commands to propagate data changes</span></span>  
  
1.  <span data-ttu-id="55573-142">在发布服务器上，对发布数据库执行 [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55573-142">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="55573-143">为 \@publication 指定项目所属的发布的名称，为 \@article 指定项目的名称，为 \@source_object 指定要发布的数据库对象，并为下列至少一个参数指定 SQL 值：</span><span class="sxs-lookup"><span data-stu-id="55573-143">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **SQL** for at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="55573-144">\@ins_cmd - 控制 [INSERT](/sql/t-sql/statements/insert-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-144">**\@ins_cmd** - controls the replication of [INSERT](/sql/t-sql/statements/insert-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="55573-145">\@upd_cmd - 控制 [UPDATE](/sql/t-sql/queries/update-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-145">**\@upd_cmd** - controls the replication of [UPDATE](/sql/t-sql/queries/update-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="55573-146">\@del_cmd - 控制 [DELETE](/sql/t-sql/statements/delete-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-146">**\@del_cmd** - controls the replication of [DELETE](/sql/t-sql/statements/delete-transact-sql) commands.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-147">为以上任意参数指定 **SQL** 值后，该类型的命令将作为相应的 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 命令复制到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="55573-147">When specifying a value of **SQL** for any of the above parameters, commands of that type will be replicated to the Subscriber as the appropriate [!INCLUDE[tsql](../../../includes/tsql-md.md)] command.</span></span>  
  
     <span data-ttu-id="55573-148">有关详细信息，请参阅 [定义项目](define-an-article.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-148">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
#### <a name="to-create-an-article-that-does-not-propagate-data-changes"></a><span data-ttu-id="55573-149">创建不传播数据更改的项目</span><span class="sxs-lookup"><span data-stu-id="55573-149">To create an article that does not propagate data changes</span></span>  
  
1.  <span data-ttu-id="55573-150">在发布服务器上，对发布数据库执行 [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55573-150">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="55573-151">为 \@publication 指定项目所属的发布的名称，为 \@article 指定项目的名称，为 \@source_object 指定要发布的数据库对象，并为下列至少一个参数指定 NONE 值：</span><span class="sxs-lookup"><span data-stu-id="55573-151">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, and a value of **NONE** for at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="55573-152">\@ins_cmd - 控制 [INSERT](/sql/t-sql/statements/insert-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-152">**\@ins_cmd** - controls the replication of [INSERT](/sql/t-sql/statements/insert-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="55573-153">\@upd_cmd - 控制 [UPDATE](/sql/t-sql/queries/update-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-153">**\@upd_cmd** - controls the replication of [UPDATE](/sql/t-sql/queries/update-transact-sql) commands.</span></span>  
  
    -   <span data-ttu-id="55573-154">\@del_cmd - 控制 [DELETE](/sql/t-sql/statements/delete-transact-sql) 命令的复制。</span><span class="sxs-lookup"><span data-stu-id="55573-154">**\@del_cmd** - controls the replication of [DELETE](/sql/t-sql/statements/delete-transact-sql) commands.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-155">将以上任意参数指定为 **NONE** 值后，该类型的命令将不会复制到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="55573-155">When specifying a value of **NONE** for any of the above parameters, commands of that type will not be replicated to the Subscriber.</span></span>  
  
     <span data-ttu-id="55573-156">有关详细信息，请参阅 [定义项目](define-an-article.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-156">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
#### <a name="to-create-an-article-with-user-modified-custom-stored-procedures"></a><span data-ttu-id="55573-157">通过用户修改的自定义存储过程创建项目</span><span class="sxs-lookup"><span data-stu-id="55573-157">To create an article with user-modified custom stored procedures</span></span>  
  
1.  <span data-ttu-id="55573-158">在发布服务器上，对发布数据库执行 [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55573-158">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="55573-159">为 \@publication 指定项目所属的发布的名称，为 \@article 指定项目的名称，为 \@source_object 指定要发布的数据库对象，并为包含值 0x02 （可自动生成自定义存储过程）的 \@schema_option 位掩码以及下列至少一个参数指定值：</span><span class="sxs-lookup"><span data-stu-id="55573-159">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, a value for the **\@schema_option** bitmask that contains the value **0x02** (enables automatic generation of custom stored procedures), and at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="55573-160">\*\* \@ ins_cmd\*\* -指定<strong>CALL sp_MSins_*article_name*</strong>的值，其中**_article_name_** 是为\*\* \@ 项目\*\*指定的值。</span><span class="sxs-lookup"><span data-stu-id="55573-160">**\@ins_cmd** - specify a value of <strong>CALL sp_MSins_*article_name*</strong>, where **_article_name_** is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="55573-161">\*\* \@ del_cmd\*\* - <strong>sp_MSdel_*article_name* </strong>或<strong>XCALL sp_MSdel_*article_name*</strong>指定值，其中**_article_name_** 是为 _ \* 项目 \* \* 指定的值 \@ 。</span><span class="sxs-lookup"><span data-stu-id="55573-161">**\@del_cmd** - specify a value of <strong>CALL sp_MSdel_*article_name*</strong> or <strong>XCALL sp_MSdel_*article_name*</strong>, where **_article_name_** is the value specified for _\*\@article\*\*.</span></span>  
  
    -   <span data-ttu-id="55573-162">\*\* \@ upd_cmd\*\* - <strong>sp_MSupd_*article_name*指定 SCALL</strong>值，并<strong>调用 sp_MSupd_*article_name*</strong>、 <strong>XCALL sp_MSupd__article_name *</strong> 或<strong>MCALL sp_MSupd_* article_name *</strong>，其中_**article_name**_ 是为*\* \@ 项目\*\*指定的值。</span><span class="sxs-lookup"><span data-stu-id="55573-162">**\@upd_cmd** - specify a value of <strong>SCALL sp_MSupd_*article_name*</strong>, <strong>CALL sp_MSupd_*article_name*</strong>, <strong>XCALL sp_MSupd__article_name*</strong>, or <strong>MCALL sp_MSupd_* article_name\*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-163">对于以上每个命令参数，您都可以为复制生成的存储过程指定您自己的名称。</span><span class="sxs-lookup"><span data-stu-id="55573-163">For each of the above command parameters, you can specify your own name for the stored procedures that replication generates.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-164">若要了解有关 CALL、SCALL、XCALL 和 MCALL 语法的详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-164">For more information on CALL, SCALL, XCALL, and MCALL syntax, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
     <span data-ttu-id="55573-165">有关详细信息，请参阅 [定义项目](define-an-article.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-165">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
2.  <span data-ttu-id="55573-166">快照生成后，定位到此项目所属的发布的快照文件夹，并找到与此项目同名的 **.sch** 文件。</span><span class="sxs-lookup"><span data-stu-id="55573-166">After the snapshot has been generated, navigate to the snapshot folder for the publication to which this article belongs and locate the **.sch** file with the same name as the article.</span></span> <span data-ttu-id="55573-167">使用 Notepad.exe 打开此文件，找到用于插入、更新或删除存储过程的 CREATE PROCEDURE 命令，并编辑过程定义以提供用于传播数据更改的任何自定义逻辑。</span><span class="sxs-lookup"><span data-stu-id="55573-167">Open this file using Notepad.exe, locate the CREATE PROCEDURE command for the insert, update, or delete stored procedures, and edit the procedure definition to supply any custom logic for propagating data changes.</span></span> <span data-ttu-id="55573-168">有关详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-168">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-create-an-article-with-custom-scripting-in-the-custom-stored-procedures-to-propagate-data-changes"></a><span data-ttu-id="55573-169">用自定义存储过程中的自定义脚本创建项目以传播数据更改</span><span class="sxs-lookup"><span data-stu-id="55573-169">To create an article with custom scripting in the custom stored procedures to propagate data changes</span></span>  
  
1.  <span data-ttu-id="55573-170">在发布服务器上，对发布数据库执行 [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55573-170">At the Publisher on the publication database, execute [sp_addarticle](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql).</span></span> <span data-ttu-id="55573-171">为 \@publication 指定项目所属的发布的名称，为 \@article 指定项目的名称，为 \@source_object 指定要发布的数据库对象，并为包含值 0x02 （可自动生成自定义存储过程）的 \@schema_option 位掩码以及下列至少一个参数指定值：</span><span class="sxs-lookup"><span data-stu-id="55573-171">Specify the name of the publication to which the article belongs for **\@publication**, a name for the article for **\@article**, the database object being published for **\@source_object**, a value for the **\@schema_option** bitmask that contains the value **0x02** (enables automatic generation of custom stored procedures), and at least one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="55573-172">\*\* \@ ins_cmd\*\* -指定<strong>CALL sp_MSins_*article_name*</strong>的值，其中_**article_name**_ 是为\*\* \@ 项目\*\*指定的值。</span><span class="sxs-lookup"><span data-stu-id="55573-172">**\@ins_cmd** - specify a value of <strong>CALL sp_MSins_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="55573-173">\*\* \@ del_cmd\*\* - <strong>sp_MSdel_*article_name* </strong>或<strong>XCALL sp_MSdel_*article_name*</strong>指定值，其中_**article_name**_ 是为\*\* \@ 项目\*\*指定的值。</span><span class="sxs-lookup"><span data-stu-id="55573-173">**\@del_cmd** - specify a value of <strong>CALL sp_MSdel_*article_name*</strong> or <strong>XCALL sp_MSdel_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    -   <span data-ttu-id="55573-174">\*\* \@ upd_cmd\*\* -指定<strong>SCALL sp_MSupd_*article_name*</strong>的值，<strong>调用 sp_MSupd_*article_name*</strong>， <strong>XCALL sp_MSupd_*article_name*</strong>， <strong>MCALL sp_MSupd_*article_name*</strong>，其中_**article_name**_ 是为\*\* \@ 项目\*\*指定的值。</span><span class="sxs-lookup"><span data-stu-id="55573-174">**\@upd_cmd** - specify a value of <strong>SCALL sp_MSupd_*article_name*</strong>, <strong>CALL sp_MSupd_*article_name*</strong>, <strong>XCALL sp_MSupd_*article_name*</strong>, <strong>MCALL sp_MSupd_*article_name*</strong>, where _**article_name**_ is the value specified for **\@article**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-175">对于以上每个命令参数，您都可以为复制生成的存储过程指定您自己的名称。</span><span class="sxs-lookup"><span data-stu-id="55573-175">For each of the above command parameters, you can specify your own name for the stored procedures that replication generates.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="55573-176">若要了解有关 CALL、SCALL、XCALL 和 MCALL 语法的详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-176">For more information on CALL, SCALL, XCALL, and MCALL syntax, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
     <span data-ttu-id="55573-177">有关详细信息，请参阅 [定义项目](define-an-article.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-177">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
2.  <span data-ttu-id="55573-178">在发布服务器上，对发布数据库使用 [ALTER PROCEDURE](/sql/t-sql/statements/alter-procedure-transact-sql) 语句来编辑 [sp_scriptpublicationcustomprocs](/sql/relational-databases/system-stored-procedures/sp-scriptpublicationcustomprocs-transact-sql) ，以使该语句可以返回用于插入、更新和删除自定义存储过程的 [CREATE PROCEDURE](/sql/t-sql/statements/create-procedure-transact-sql) 脚本。</span><span class="sxs-lookup"><span data-stu-id="55573-178">At the Publisher on the publication database, use the [ALTER PROCEDURE](/sql/t-sql/statements/alter-procedure-transact-sql) statement to edit [sp_scriptpublicationcustomprocs](/sql/relational-databases/system-stored-procedures/sp-scriptpublicationcustomprocs-transact-sql) so that it returns a [CREATE PROCEDURE](/sql/t-sql/statements/create-procedure-transact-sql) script for the insert, update, and delete custom stored procedures.</span></span> <span data-ttu-id="55573-179">有关详细信息，请参阅[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md)。</span><span class="sxs-lookup"><span data-stu-id="55573-179">For more information, see [Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md).</span></span>  
  
#### <a name="to-change-the-method-of-propagating-changes-for-an-existing-article"></a><span data-ttu-id="55573-180">更改为现有项目传播更改的方法</span><span class="sxs-lookup"><span data-stu-id="55573-180">To change the method of propagating changes for an existing article</span></span>  
  
1.  <span data-ttu-id="55573-181">在发布服务器上，对发布数据库执行 [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="55573-181">At the Publisher on the publication database, execute [sp_changearticle](/sql/relational-databases/system-stored-procedures/sp-changearticle-transact-sql).</span></span> <span data-ttu-id="55573-182">指定 **\@publication**、 **\@article**，为 **\@property** 指定值 **ins_cm**，**upd_cmd** 或 **del_cmd**，并为 **\@value** 指定合适的传播方法。</span><span class="sxs-lookup"><span data-stu-id="55573-182">Specify **\@publication**, **\@article**, a value of **ins_cmd**, **upd_cmd**, or **del_cmd** for **\@property**, and the appropriate propagation method for **\@value**.</span></span>  
  
2.  <span data-ttu-id="55573-183">为每个要更改的传播方法重复步骤 1。</span><span class="sxs-lookup"><span data-stu-id="55573-183">Repeat step 1 for each propagation method to be changed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="55573-184">另请参阅</span><span class="sxs-lookup"><span data-stu-id="55573-184">See Also</span></span>  
 <span data-ttu-id="55573-185">[指定如何传播事务项目的更改](../transactional/transactional-articles-specify-how-changes-are-propagated.md) </span><span class="sxs-lookup"><span data-stu-id="55573-185">[Specify How Changes Are Propagated for Transactional Articles](../transactional/transactional-articles-specify-how-changes-are-propagated.md) </span></span>  
 [<span data-ttu-id="55573-186">创建发布</span><span class="sxs-lookup"><span data-stu-id="55573-186">Create a publication</span></span>](create-a-publication.md)  
  
  
