---
title: 以编程方式监视复制 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693757"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="e7543-102">以编程方式监视复制</span><span class="sxs-lookup"><span data-stu-id="e7543-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="e7543-103">复制监视器是一种可用于监视复制拓扑的图形化工具。</span><span class="sxs-lookup"><span data-stu-id="e7543-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="e7543-104">可以使用 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 复制存储过程或复制管理对象 (RMO) 以编程方式访问相同的监视数据。</span><span class="sxs-lookup"><span data-stu-id="e7543-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="e7543-105">您可以利用这些对象对以下任务进行编程：</span><span class="sxs-lookup"><span data-stu-id="e7543-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="e7543-106">监视发布服务器、发布和订阅的状态。</span><span class="sxs-lookup"><span data-stu-id="e7543-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="e7543-107">监视一个或多个订阅服务器上的合并代理会话。</span><span class="sxs-lookup"><span data-stu-id="e7543-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="e7543-108">监视等待在一个或多个订阅服务器上应用的事务处理命令。</span><span class="sxs-lookup"><span data-stu-id="e7543-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="e7543-109">定义用于确定发布何时需要干预的阈值标准。</span><span class="sxs-lookup"><span data-stu-id="e7543-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="e7543-110">监视跟踪令牌的状态。</span><span class="sxs-lookup"><span data-stu-id="e7543-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="e7543-111">**本主题内容：**</span><span class="sxs-lookup"><span data-stu-id="e7543-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="e7543-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e7543-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="e7543-113">复制管理对象 (RMO)</span><span class="sxs-lookup"><span data-stu-id="e7543-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="e7543-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="e7543-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="e7543-115">从分发服务器监视发布服务器、发布和订阅</span><span class="sxs-lookup"><span data-stu-id="e7543-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="e7543-116">在分发服务器上，对分发数据库执行 [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="e7543-117">这将返回使用此分发服务器的所有发布服务器的监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="e7543-118">若要将结果集限制为单个发布服务器，请指定 **@publisher** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="e7543-119">在分发服务器上，对分发数据库执行 [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e7543-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="e7543-120">这将返回使用此分发服务器的所有发布的监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="e7543-121">若要将结果集限制在单个发布服务器、发布或已发布数据库中，请 **@publisher** 分别指定、 **@publication** 或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="e7543-122">在分发服务器上，对分发数据库执行 [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="e7543-123">这将返回使用此分发服务器的所有订阅的监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="e7543-124">若要将结果集限制为属于单个发布服务器、发布或已发布数据库的订阅， **@publisher** 请 **@publication** 分别指定、或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="e7543-125">监视等待在订阅服务器上应用的事务处理命令</span><span class="sxs-lookup"><span data-stu-id="e7543-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="e7543-126">在分发服务器上，对分发数据库执行 [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="e7543-127">这将返回为使用此分发服务器的所有订阅挂起的所有命令的监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="e7543-128">若要将结果集限制为属于单个发布服务器、订阅服务器、发布或已发布数据库的订阅挂起的命令，请 **@publisher** 分别指定、 **@subscriber** 、 **@publication** 或 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="e7543-129">监视等待上载或下载的合并更改</span><span class="sxs-lookup"><span data-stu-id="e7543-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="e7543-130">在发布服务器上，对发布数据库执行 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="e7543-131">这将返回一个结果集，其中显示了有关等待复制到订阅服务器的更改的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="e7543-132">若要将结果集限制为属于单个发布或项目的更改，请 **@publication** 分别指定或 **@article** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="e7543-133">在订阅服务器上，对订阅数据库执行 [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="e7543-134">这将返回一个结果集，其中显示了有关等待复制到发布服务器的更改的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="e7543-135">若要将结果集限制为属于单个发布或项目的更改，请 **@publication** 分别指定或 **@article** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="e7543-136">监视合并代理会话</span><span class="sxs-lookup"><span data-stu-id="e7543-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="e7543-137">在分发服务器上，对分发数据库执行 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="e7543-138">这将为所有使用此分发服务器的订阅返回有关所有合并代理会话的监视信息（包括 **Session_id**）。</span><span class="sxs-lookup"><span data-stu-id="e7543-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="e7543-139">还可以提供查询 **MSmerge_sessions** 系统表来获得 [Session_id](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) 。</span><span class="sxs-lookup"><span data-stu-id="e7543-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="e7543-140">在分发服务器上，对分发数据库执行 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="e7543-141">为 **Session_id** 指定步骤 1 中的 **@session_id**。</span><span class="sxs-lookup"><span data-stu-id="e7543-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="e7543-142">这将显示有关该会话的详细监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="e7543-143">为每个相关会话重复步骤 2。</span><span class="sxs-lookup"><span data-stu-id="e7543-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="e7543-144">从订阅服务器监视请求订阅的合并代理会话</span><span class="sxs-lookup"><span data-stu-id="e7543-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="e7543-145">在订阅服务器上，对订阅数据库执行 [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="e7543-146">对于给定的订阅，请指定 **@publisher** 、 **@publication** 和发布数据库的名称 **@publisher_db** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="e7543-147">这将为此订阅的最后五个合并代理会话返回监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="e7543-148">请记下结果集中相关会话的 **Session_id** 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="e7543-149">在订阅服务器上，对订阅数据库执行 [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="e7543-150">为 **Session_id** 指定步骤 1 中的 **@session_id**。</span><span class="sxs-lookup"><span data-stu-id="e7543-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="e7543-151">这将显示有关该会话的详细监视信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="e7543-152">为每个相关会话重复步骤 2。</span><span class="sxs-lookup"><span data-stu-id="e7543-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="e7543-153">查看和修改发布的监视阈值标准</span><span class="sxs-lookup"><span data-stu-id="e7543-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="e7543-154">在分发服务器上，对分发数据库执行 [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="e7543-155">这将返回为使用此分发服务器的所有发布设置的监视阈值。</span><span class="sxs-lookup"><span data-stu-id="e7543-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="e7543-156">若要将结果集限制为属于单个发布服务器或已发布数据库或单个发布的发布的监视器阈值，请 **@publisher** 分别指定、 **@publisher_db** 或 **@publication** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="e7543-157">请记下任何必须更改的阈值的 **Metric_id** 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="e7543-158">有关详细信息，请参阅 [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md)。</span><span class="sxs-lookup"><span data-stu-id="e7543-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="e7543-159">在分发服务器上，对分发数据库执行 [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e7543-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="e7543-160">根据需要指定下列参数：</span><span class="sxs-lookup"><span data-stu-id="e7543-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="e7543-161">为 **Metric_id** 指定在步骤 1 中获得 **@metric_id**。</span><span class="sxs-lookup"><span data-stu-id="e7543-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="e7543-162">的监视器阈值指标的新值 **@value** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="e7543-163">将 **@shouldalert** 的值指定为 **@shouldalert** 以在达到此阈值时记录警报；如果不需要警报，则指定为 **0** 。</span><span class="sxs-lookup"><span data-stu-id="e7543-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="e7543-164">将 **@shouldalert** 的值指定为 **@mode** 以启用监视阈值指标，或指定为 **2** 以禁用它。</span><span class="sxs-lookup"><span data-stu-id="e7543-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="e7543-165">复制管理对象 (RMO)</span><span class="sxs-lookup"><span data-stu-id="e7543-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="e7543-166">监视对订阅服务器上的合并发布的订阅</span><span class="sxs-lookup"><span data-stu-id="e7543-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="e7543-167">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与订阅服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-168">创建 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> 类的实例，为订阅设置 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>、 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>和 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> 属性并将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="e7543-169">调用以下方法之一返回有关该订阅的合并代理会话的信息：</span><span class="sxs-lookup"><span data-stu-id="e7543-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="e7543-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 返回一组 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 对象，其中包含最后五个合并代理会话的相关信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="e7543-171">请注意任何相关会话的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="e7543-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - 返回一组 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 对象，其中包含过去几个小时（作为 *hours* 参数传入）中发生的合并代理会话（最多是最后五个会话）的相关信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="e7543-173">请注意任何相关会话的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="e7543-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - 返回 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 对象，该对象具有最后一个合并代理会话的相关信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="e7543-175">请注意此会话的 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="e7543-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - 返回 <xref:System.Data.DataSet> 对象，其中包含最多最后五个合并代理会话的相关信息，每个合并代理会话占一行。</span><span class="sxs-lookup"><span data-stu-id="e7543-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="e7543-177">请注意任何相关会话的 **Session_id** 列的值。</span><span class="sxs-lookup"><span data-stu-id="e7543-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="e7543-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - 返回 <xref:System.Data.DataRow> 对象，该对象具有最后一个合并代理会话的相关信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="e7543-179">请注意此会话的 **Session_id** 列的值。</span><span class="sxs-lookup"><span data-stu-id="e7543-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="e7543-180">（可选）调用 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> 刷新作为 <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> 传递的 *T:Microsoft.SqlServer.Replication.MergeSessionSummary* 对象的数据，或调用 <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> 刷新作为 <xref:System.Data.DataRow> 传递的 *T:System.Data.DataRow*。</span><span class="sxs-lookup"><span data-stu-id="e7543-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="e7543-181">使用步骤 3 中获取的会话 ID 调用以下方法之一，以返回有关特定会话的详细信息：</span><span class="sxs-lookup"><span data-stu-id="e7543-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="e7543-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>- <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> 为提供的*sessionID*返回对象的数组。</span><span class="sxs-lookup"><span data-stu-id="e7543-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="e7543-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>-返回 <xref:System.Data.DataSet> 对象，其中包含指定*sessionID*的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="e7543-184">监视分发服务器上所有发布的复制属性</span><span class="sxs-lookup"><span data-stu-id="e7543-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="e7543-185">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与分发服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-186">创建的 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="e7543-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="e7543-187">将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="e7543-188">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="e7543-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="e7543-189">执行以下一种或多种方法返回使用该分发服务器的所有发布服务器的复制信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此分发服务器上所有分发代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关存储在分发服务器上的错误的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关分发服务器上的所有日志读取器代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含分发服务器上的所有合并代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关分发服务器上的所有其他复制代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此分发服务器上的所有发布服务器的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象返回使用此分发服务器的发布服务器。</span><span class="sxs-lookup"><span data-stu-id="e7543-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关分发服务器上的所有队列读取器代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的队列读取器代理和会话的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的队列读取器代理的会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关分发服务器上的所有快照代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="e7543-201">监视分发服务器上特定发布服务器的发布属性</span><span class="sxs-lookup"><span data-stu-id="e7543-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="e7543-202">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与分发服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-203">通过下列方法之一获取 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 对象。</span><span class="sxs-lookup"><span data-stu-id="e7543-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="e7543-204">创建的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="e7543-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="e7543-205">为发布服务器设置 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> 属性，并将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="e7543-206">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="e7543-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="e7543-207">如果该方法返回 `false`，则表示发布服务器名称定义不正确或表示该发布不存在。</span><span class="sxs-lookup"><span data-stu-id="e7543-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="e7543-208">从通过现有 <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> 对象的 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> 属性访问的 <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> 中获取。</span><span class="sxs-lookup"><span data-stu-id="e7543-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="e7543-209">执行以下一种或多种方法返回有关属于该发布服务器的所有发布的复制信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="e7543-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的分发代理和会话的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的分发代理的会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象有关指定的错误的错误记录信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="e7543-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的日志读取器代理和会话的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的日志读取器代理的会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的合并代理和会话的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的合并代理和会话的其他详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的合并代理的会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的合并代理的其他会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此分发服务器上的所有发布的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此分发服务器上的所有发布的其他信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="e7543-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的快照代理和会话的详细信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="e7543-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含指定的快照代理的会话信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="e7543-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关对此分发服务器上的发布的所有订阅的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="e7543-224">监视分发服务器上的特定发布的属性</span><span class="sxs-lookup"><span data-stu-id="e7543-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="e7543-225">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与分发服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-226">通过下列方法之一获取 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 对象。</span><span class="sxs-lookup"><span data-stu-id="e7543-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="e7543-227">创建的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="e7543-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="e7543-228">为发布设置 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 属性，并将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="e7543-229">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="e7543-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="e7543-230">如果该方法返回 `false`，则表示发布属性定义不正确，或表示该发布不存在。</span><span class="sxs-lookup"><span data-stu-id="e7543-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="e7543-231">从通过现有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 对象的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 属性访问的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 中获取。</span><span class="sxs-lookup"><span data-stu-id="e7543-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="e7543-232">执行以下一种或多种方法返回有关此发布的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定的错误的错误记录。</span><span class="sxs-lookup"><span data-stu-id="e7543-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="e7543-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此发布的日志读取器代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关为此发布设置的监视器警告阈值的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此发布使用的队列读取器代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关此发布的快照代理的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关对此发布的订阅的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="e7543-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - 基于提供的 <xref:System.Data.DataSet> 返回 <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>对象，该对象包含有关对此发布的订阅的其他信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="e7543-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关指定跟踪令牌的滞后时间的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="e7543-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - 返回 <xref:System.Data.DataSet> 对象，该对象包含有关插入到此发布的所有跟踪令牌的信息。</span><span class="sxs-lookup"><span data-stu-id="e7543-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="e7543-242">监视正等待在订阅服务器上应用的事务处理命令</span><span class="sxs-lookup"><span data-stu-id="e7543-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="e7543-243">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与分发服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-244">通过下列方法之一获取 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 对象。</span><span class="sxs-lookup"><span data-stu-id="e7543-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="e7543-245">创建的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="e7543-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="e7543-246">为发布设置 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 属性，并将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="e7543-247">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="e7543-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="e7543-248">如果该方法返回 `false`，则表示发布属性定义不正确，或表示该发布不存在。</span><span class="sxs-lookup"><span data-stu-id="e7543-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="e7543-249">从通过现有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 对象的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 属性访问的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 中获取。</span><span class="sxs-lookup"><span data-stu-id="e7543-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="e7543-250">执行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> 方法，这种方法可返回 <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> 对象。</span><span class="sxs-lookup"><span data-stu-id="e7543-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="e7543-251">使用该 <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> 对象的属性可估算挂起命令的数目以及完成这些命令的传递所需的时间。</span><span class="sxs-lookup"><span data-stu-id="e7543-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="e7543-252">为发布设置监视器警告阈值</span><span class="sxs-lookup"><span data-stu-id="e7543-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="e7543-253">使用 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 类创建与分发服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="e7543-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="e7543-254">通过下列方法之一获取 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 对象。</span><span class="sxs-lookup"><span data-stu-id="e7543-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="e7543-255">创建的 <xref:Microsoft.SqlServer.Replication.PublicationMonitor> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="e7543-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="e7543-256">为发布设置 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>、 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>和 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> 属性，并将 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 属性设置为步骤 1 中创建的 <xref:Microsoft.SqlServer.Management.Common.ServerConnection> 。</span><span class="sxs-lookup"><span data-stu-id="e7543-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="e7543-257">调用 <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 方法获取该对象的属性。</span><span class="sxs-lookup"><span data-stu-id="e7543-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="e7543-258">如果该方法返回 `false`，则表示发布属性定义不正确，或表示该发布不存在。</span><span class="sxs-lookup"><span data-stu-id="e7543-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="e7543-259">从通过现有 <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> 对象的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> 属性访问的 <xref:Microsoft.SqlServer.Replication.PublisherMonitor> 中获取。</span><span class="sxs-lookup"><span data-stu-id="e7543-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="e7543-260">执行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="e7543-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="e7543-261">请注意 <xref:System.Collections.ArrayList> 对象已返回的 <xref:Microsoft.SqlServer.Replication.MonitorThreshold> 中的当前阈值设置。</span><span class="sxs-lookup"><span data-stu-id="e7543-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="e7543-262">执行 <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="e7543-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="e7543-263">传递以下参数：</span><span class="sxs-lookup"><span data-stu-id="e7543-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="e7543-264">*metricID* - <xref:System.Int32> 值，它表示下表中的监视阈值指标：</span><span class="sxs-lookup"><span data-stu-id="e7543-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="e7543-265">值</span><span class="sxs-lookup"><span data-stu-id="e7543-265">Value</span></span>|<span data-ttu-id="e7543-266">说明</span><span class="sxs-lookup"><span data-stu-id="e7543-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="e7543-267">1</span><span class="sxs-lookup"><span data-stu-id="e7543-267">1</span></span>|<span data-ttu-id="e7543-268">`expiration` - 监视对事务发布的订阅是否即将过期。</span><span class="sxs-lookup"><span data-stu-id="e7543-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="e7543-269">2</span><span class="sxs-lookup"><span data-stu-id="e7543-269">2</span></span>|<span data-ttu-id="e7543-270">`latency` - 监视对事务发布的订阅的性能。</span><span class="sxs-lookup"><span data-stu-id="e7543-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="e7543-271">4</span><span class="sxs-lookup"><span data-stu-id="e7543-271">4</span></span>|<span data-ttu-id="e7543-272">`mergeexpiration` - 监视对合并发布的订阅是否即将过期。</span><span class="sxs-lookup"><span data-stu-id="e7543-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="e7543-273">5</span><span class="sxs-lookup"><span data-stu-id="e7543-273">5</span></span>|<span data-ttu-id="e7543-274">`mergeslowrunduration`-监视通过低带宽 (拨号) 连接进行的合并同步的持续时间。</span><span class="sxs-lookup"><span data-stu-id="e7543-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="e7543-275">6</span><span class="sxs-lookup"><span data-stu-id="e7543-275">6</span></span>|<span data-ttu-id="e7543-276">`mergefastrunduration` - 监视通过高带宽 (LAN) 连接进行的合并同步的持续时间。</span><span class="sxs-lookup"><span data-stu-id="e7543-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="e7543-277">7</span><span class="sxs-lookup"><span data-stu-id="e7543-277">7</span></span>|<span data-ttu-id="e7543-278">`mergefastrunspeed` - 监视通过高带宽 (LAN) 连接进行的合并同步的同步速率。</span><span class="sxs-lookup"><span data-stu-id="e7543-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="e7543-279">8</span><span class="sxs-lookup"><span data-stu-id="e7543-279">8</span></span>|<span data-ttu-id="e7543-280">`mergeslowrunspeed` - 监视通过低带宽（拨号）连接进行的合并同步的同步速率。</span><span class="sxs-lookup"><span data-stu-id="e7543-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="e7543-281">*enable* - <xref:System.Boolean> 值。</span><span class="sxs-lookup"><span data-stu-id="e7543-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="e7543-282">*thresholdValue* - 用于设置阈值的整数值。</span><span class="sxs-lookup"><span data-stu-id="e7543-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="e7543-283">*shouldAlert* - 用于指示在此阈值是否应生成警报的整数。</span><span class="sxs-lookup"><span data-stu-id="e7543-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
