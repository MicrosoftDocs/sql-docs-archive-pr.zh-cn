---
title: 添加或编辑筛选器 | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.newpubwizard.addeditfilter.f1
ms.assetid: bdd7c71d-1c59-4044-bfe8-c85f908345bb
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 54dcb1ea0b7bf10f51659a14b9d0cc5eb7991769
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87578157"
---
# <a name="add-or-edit-filter"></a><span data-ttu-id="fe3e5-102">添加或编辑筛选器</span><span class="sxs-lookup"><span data-stu-id="fe3e5-102">Add or Edit Filter</span></span>
  <span data-ttu-id="fe3e5-103">使用 **“添加筛选器”** 和 **“编辑筛选器”** 对话框，可以添加和编辑静态行筛选器和参数化行筛选器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-103">The **Add Filter** and **Edit Filter** dialog boxes allow you to add and edit static row filters and parameterized row filters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fe3e5-104">编辑现有发布中的筛选器需要为该发布创建新的快照。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-104">Editing a filter in an existing publication requires a new snapshot for the publication.</span></span> <span data-ttu-id="fe3e5-105">如果发布有订阅，则必须重新初始化这些订阅。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-105">If a publication has subscriptions, the subscriptions must be reinitialized.</span></span> <span data-ttu-id="fe3e5-106">有关属性更改的详细信息，请参阅[更改发布和项目属性](publish/change-publication-and-article-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-106">For more information about property changes, see [Change Publication and Article Properties](publish/change-publication-and-article-properties.md).</span></span>  
  
 <span data-ttu-id="fe3e5-107">所有发布类型都可以包含静态筛选器；合并发布也可以包含参数化筛选器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-107">All publication types can include static filters; merge publications can also include parameterized filters.</span></span> <span data-ttu-id="fe3e5-108">在创建发布时将对静态筛选器求值：该发布的所有订阅服务器将接收相同的数据。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-108">A static filter is evaluated when the publication is created: all Subscribers to the publication receive the same data.</span></span> <span data-ttu-id="fe3e5-109">在复制同步期间将对参数化筛选器求值：不同的订阅服务器接收不同的数据分区，这取决于各个订阅服务器的登录名或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-109">A parameterized filter is evaluated during replication synchronization: different Subscribers can receive different partitions of data based on the login or computer name of each Subscriber.</span></span> <span data-ttu-id="fe3e5-110">在该对话框中单击 **“示例语句”** 链接，可以查看每种筛选器的示例。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-110">Click the **Example statements** link in the dialog box to see examples of each type of filter.</span></span> <span data-ttu-id="fe3e5-111">有关筛选选项的详细信息，请参阅[筛选已发布数据](publish/filter-published-data.md)。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-111">For more information about filtering options, see [Filter Published Data](publish/filter-published-data.md).</span></span>  
  
 <span data-ttu-id="fe3e5-112">通过使用行筛选器，可以指定要从表中发布的行的子集。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-112">Using row filters, you can specify a subset of rows to be published from a table.</span></span> <span data-ttu-id="fe3e5-113">可以将行筛选器用于隐藏用户不需要查看的行（例如，包含敏感信息或机密信息的行），或用于创建发送到不同订阅服务器的不同数据分区。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-113">Row filters can be used to eliminate rows that users do not need to see (such as rows that contain sensitive or confidential information), or to create different partitions of data that are sent to different Subscribers.</span></span> <span data-ttu-id="fe3e5-114">将不同的数据分区发布到不同的订阅服务器，还有助于避免由于多个订阅服务器更新相同的数据而导致的冲突。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-114">Publishing different partitions of data to different Subscribers can also help avoid conflicts that would otherwise be caused by multiple Subscribers updating the same data.</span></span>  
  
## <a name="options"></a><span data-ttu-id="fe3e5-115">选项</span><span class="sxs-lookup"><span data-stu-id="fe3e5-115">Options</span></span>  
 <span data-ttu-id="fe3e5-116">对于事务发布和快照发布，此对话框涉及的过程分为两个步骤；对于合并分布，此对话框涉及的过程分为三个步骤。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-116">This dialog box involves a two-step process for transactional and snapshot publications and a three-step process for merge publications.</span></span> <span data-ttu-id="fe3e5-117">所有发布类型都要求您选择要筛选的表以及要包含在筛选器中的一列或多列，并将筛选器定义为标准的 WHERE 子句。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-117">All publication types require you to select a table to be filtered and one or more columns to be included in the filter; the filter is defined as a standard WHERE clause.</span></span>  
  
1.  <span data-ttu-id="fe3e5-118">**选择要筛选的表**</span><span class="sxs-lookup"><span data-stu-id="fe3e5-118">**Select the table to filter**</span></span>  
  
     <span data-ttu-id="fe3e5-119">如果正在编辑现有筛选器，则不能更改选择的表。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-119">If you are editing an existing filter, the table selection cannot be changed.</span></span> <span data-ttu-id="fe3e5-120">如果正在添加新的筛选器，请从下拉列表框中选择表。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-120">If you are adding a new filter, select a table from the drop-down list box.</span></span> <span data-ttu-id="fe3e5-121">只有当在 **“项目”** 页上选择了表并且这些表尚未具有行筛选器时，这些表才会显示在列表框中。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-121">Tables appear in the list box only if they were selected on the **Articles** page and do not already have a row filter.</span></span> <span data-ttu-id="fe3e5-122">如果表具有行筛选器，若要定义新的筛选器，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="fe3e5-122">If a table has a row filter and you want to define a new one:</span></span>  
  
    1.  <span data-ttu-id="fe3e5-123">在 **“添加筛选器”** 对话框上单击 **“取消”** 。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-123">Click **Cancel** on the **Add Filter** dialog box.</span></span>  
  
    2.  <span data-ttu-id="fe3e5-124">在 **“筛选表行”** 页上选择筛选器窗格中的表，再单击 **“编辑”** 。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-124">Select the table in the filter pane on the **Filter Table Rows** page and click **Edit**.</span></span>  
  
    3.  <span data-ttu-id="fe3e5-125">在 **“编辑筛选器”** 对话框中编辑现有筛选器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-125">Edit an existing filter in the **Edit Filter** dialog box.</span></span>  
  
2.  <span data-ttu-id="fe3e5-126">**完成筛选语句以标识订阅服务器所要接收的表行**</span><span class="sxs-lookup"><span data-stu-id="fe3e5-126">**Complete the filter statement to identify which table rows Subscribers will receive**</span></span>  
  
     <span data-ttu-id="fe3e5-127">定义新的筛选语句或编辑现有的筛选语句。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-127">Define a new filter statement or edit an existing one.</span></span> <span data-ttu-id="fe3e5-128">**“列”** 列表框列出了要从 **“选择要筛选的表”** 中选择的表中发布的所有列。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-128">The **Columns** list box lists all the columns that you are publishing from the table you selected in **Select the table to filter**.</span></span> <span data-ttu-id="fe3e5-129">**“筛选语句”** 文本区域包括默认的文本，其格式为：</span><span class="sxs-lookup"><span data-stu-id="fe3e5-129">The **Filter statement** text area includes the default text, which is in the form of:</span></span>  
  
     `SELECT <published_columns> FROM [schema].[tablename] WHERE`  
  
     <span data-ttu-id="fe3e5-130">此文本无法更改；请使用标准的 [!INCLUDE[tsql](../../includes/tsql-md.md)] 语法在 WHERE 关键字后键入筛选子句。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-130">This text cannot be changed; type the filter clause after the WHERE keyword using standard [!INCLUDE[tsql](../../includes/tsql-md.md)] syntax.</span></span> <span data-ttu-id="fe3e5-131">如果发布服务器为 Oracle 发布服务器，则 WHERE 子句必须符合 Oracle 查询语法。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-131">If the Publisher is an Oracle Publisher, the WHERE clause must be compliant with Oracle query syntax.</span></span> <span data-ttu-id="fe3e5-132">请尽可能避免使用复杂筛选器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-132">Avoid using complex filters when possible.</span></span> <span data-ttu-id="fe3e5-133">静态筛选器和参数化筛选器都会增加发布的处理时间，因此应使筛选语句尽可能简单。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-133">Both static and parameterized filters increase processing time for publications; therefore you should keep filter statements as simple as possible.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="fe3e5-134">为提高性能，建议您不要在合并发布的参数化行筛选子句中对列名应用函数,如 `LEFT([MyColumn]) = SUSER_SNAME()`。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-134">For performance reasons, we recommended that you not apply functions to column names in parameterized row filter clauses for merge publications, such as `LEFT([MyColumn]) = SUSER_SNAME()`.</span></span> <span data-ttu-id="fe3e5-135">如果在筛选子句中使用 HOST_NAME 并覆盖 HOST_NAME 值，则可能需要使用 CONVERT 转换数据类型。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-135">If you use HOST_NAME in a filter clause and override the HOST_NAME value, it might be necessary to convert data types using CONVERT.</span></span> <span data-ttu-id="fe3e5-136">有关此情况的最佳实践的详细信息，请参阅主题 [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md)中的“覆盖 HOST_NAME() 值”一节。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-136">For more information about best practices for this case, see the section "Overriding the HOST_NAME() Value" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
3.  <span data-ttu-id="fe3e5-137">**指定将从此表接收数据的订阅数**</span><span class="sxs-lookup"><span data-stu-id="fe3e5-137">**Specify how many subscriptions will receive data from this table**</span></span>  
  
     <span data-ttu-id="fe3e5-138">仅 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和更高版本适用；仅限合并复制。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-138">[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and later versions only; merge replication only.</span></span> <span data-ttu-id="fe3e5-139">通过合并复制，可以指定最适合您的数据和应用程序的分区类型。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-139">Merge replication allows you to specify the type of partitions that are best suited to your data and application.</span></span> <span data-ttu-id="fe3e5-140">如果选择 **“此表中的行将仅转到一个订阅”** ，则合并复制将设置不重叠分区选项。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-140">If you select **A row from this table will go to only one subscription**, merge replication sets the nonoverlapping partitions option.</span></span> <span data-ttu-id="fe3e5-141">不重叠分区与预计算分区协同工作以提高性能，使用不重叠分区可以将与预计算分区相关联的上载开销降至最低。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-141">Nonoverlapping partitions work in conjunction with precomputed partitions to improve performance, with nonoverlapping partitions minimizing the upload cost associated with precomputed partitions.</span></span> <span data-ttu-id="fe3e5-142">使用的参数化筛选器和联接筛选器越复杂，不重叠分区的性能优势就越明显。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-142">The performance benefit of nonoverlapping partitions is more noticeable when the parameterized filters and join filters used are more complex.</span></span> <span data-ttu-id="fe3e5-143">如果选择此选项，则必须确保对数据分区时不能将行复制到多个订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-143">If you select this option, you must ensure that the data is partitioned in such a way that a row cannot be replicated to more than one Subscriber.</span></span> <span data-ttu-id="fe3e5-144">有关详细信息，请参阅主题 [参数化行筛选器](merge/parameterized-filters-parameterized-row-filters.md)中的“设置‘分区选项’”部分。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-144">For more information, see the section "Setting 'partition options'" in the topic [Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="fe3e5-145">在添加或编辑完筛选器后，请单击 **“确定”** 以保存更改并关闭该对话框。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-145">After you have added or edited a filter, click **OK** to save changes and close the dialog box.</span></span> <span data-ttu-id="fe3e5-146">将对照 SELECT 子句中的表分析并运行指定的筛选器。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-146">The filter you specified is parsed and run against the table in the SELECT clause.</span></span> <span data-ttu-id="fe3e5-147">如果筛选语句有语法错误或其他问题，将会通知您编辑该筛选语句。</span><span class="sxs-lookup"><span data-stu-id="fe3e5-147">If the filter statement contains syntax errors or other problems, you are notified and are able to edit the filter statement.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fe3e5-148">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fe3e5-148">See Also</span></span>  
 <span data-ttu-id="fe3e5-149">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="fe3e5-149">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="fe3e5-150">[查看和修改发布属性](publish/view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="fe3e5-150">[View and Modify Publication Properties](publish/view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="fe3e5-151">[筛选已发布数据](publish/filter-published-data.md) </span><span class="sxs-lookup"><span data-stu-id="fe3e5-151">[Filter Published Data](publish/filter-published-data.md) </span></span>  
 <span data-ttu-id="fe3e5-152">[Join Filters](merge/join-filters.md) </span><span class="sxs-lookup"><span data-stu-id="fe3e5-152">[Join Filters](merge/join-filters.md) </span></span>  
 <span data-ttu-id="fe3e5-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="fe3e5-153">[Parameterized Row Filters](merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="fe3e5-154">发布数据和数据库对象</span><span class="sxs-lookup"><span data-stu-id="fe3e5-154">Publish Data and Database Objects</span></span>](publish/publish-data-and-database-objects.md)  
  
  
