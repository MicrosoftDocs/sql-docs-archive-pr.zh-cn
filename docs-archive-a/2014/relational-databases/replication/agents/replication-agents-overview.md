---
title: 复制代理概述 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- Distribution Agent
- agents [SQL Server replication]
- Queue Reader Agent, about Queue Reader Agent
- Queue Reader Agent
- Merge Agent, about Merge Agent
- Log Reader Agent, about Log Reader Agent
- replication [SQL Server], agents and profiles
- Log Reader Agent
- Distribution Agent, about Distribution Agent
- agents [SQL Server replication], about agents
- Merge Agent
- Snapshot Agent, about Snapshot Agent
- Snapshot Agent
ms.assetid: a35ecd7d-f130-483c-87e3-ddc8927bb91b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 9eea7f24fe9350aeb815a5af9dd4e2e1c0dce607
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580148"
---
# <a name="replication-agents-overview"></a><span data-ttu-id="713da-102">复制代理概述</span><span class="sxs-lookup"><span data-stu-id="713da-102">Replication Agents Overview</span></span>
  <span data-ttu-id="713da-103">复制使用许多称为“代理”的独立程序执行与跟踪更改和分发数据关联的任务。</span><span class="sxs-lookup"><span data-stu-id="713da-103">Replication uses a number of standalone programs, called agents, to carry out the tasks associated with tracking changes and distributing data.</span></span> <span data-ttu-id="713da-104">默认情况下，复制代理作为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 代理安排的作业运行，必须运行 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 代理，这些作业才能运行。</span><span class="sxs-lookup"><span data-stu-id="713da-104">By default, replication agents run as jobs scheduled under [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent must be running for the jobs to run.</span></span> <span data-ttu-id="713da-105">复制代理还可以从命令行以及由使用复制管理对象 (RMO) 的应用程序运行。</span><span class="sxs-lookup"><span data-stu-id="713da-105">Replication agents can also be run from the command line and by applications that use Replication Management Objects (RMO).</span></span> <span data-ttu-id="713da-106">可以从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 复制监视器和 [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)]对复制代理进行管理。</span><span class="sxs-lookup"><span data-stu-id="713da-106">Replication agents can be administered from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Replication Monitor and [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>  
  
## <a name="sql-server-agent"></a><span data-ttu-id="713da-107">SQL Server 代理</span><span class="sxs-lookup"><span data-stu-id="713da-107">SQL Server Agent</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="713da-108">代理保存并安排复制中使用的代理，并提供运行复制代理的简便方法。</span><span class="sxs-lookup"><span data-stu-id="713da-108">Agent hosts and schedules the agents used in replication and provides an easy way to run replication agents.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="713da-109">代理还控制和监视复制之外的操作。</span><span class="sxs-lookup"><span data-stu-id="713da-109">Agent also controls and monitors operations outside of replication.</span></span> <span data-ttu-id="713da-110">有关详细信息，请参阅 [Configure SQL Server Agent](../../../ssms/agent/sql-server-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-110">For more information, see [Configure SQL Server Agent](../../../ssms/agent/sql-server-agent.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="713da-111">默认情况下，安装完 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 之后， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 代理服务处于禁用状态，除非在安装过程中明确选择自动启动该服务。</span><span class="sxs-lookup"><span data-stu-id="713da-111">By default, the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent service is disabled when [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is installed unless you explicitly choose to autostart the service during installation.</span></span> <span data-ttu-id="713da-112">有关启动 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 代理服务的详细信息，请参阅 [Start, Stop, or Pause the SQL Server Agent Service](../../../ssms/agent/start-stop-or-pause-the-sql-server-agent-service.md)对复制代理进行管理。</span><span class="sxs-lookup"><span data-stu-id="713da-112">For more information about starting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Agent service, see [Start, Stop, or Pause the SQL Server Agent Service](../../../ssms/agent/start-stop-or-pause-the-sql-server-agent-service.md).</span></span>  
  
## <a name="snapshot-agent"></a><span data-ttu-id="713da-113">快照代理</span><span class="sxs-lookup"><span data-stu-id="713da-113">Snapshot Agent</span></span>  
 <span data-ttu-id="713da-114">快照代理通常与各种类型的复制一起使用。</span><span class="sxs-lookup"><span data-stu-id="713da-114">The Snapshot Agent is typically used with all types of replication.</span></span> <span data-ttu-id="713da-115">快照代理准备已发布表的架构和初始数据文件以及其他对象、存储快照文件并记录分发数据库中的同步信息。</span><span class="sxs-lookup"><span data-stu-id="713da-115">It prepares schema and initial data files of published tables and other objects, stores the snapshot files, and records information about synchronization in the distribution database.</span></span> <span data-ttu-id="713da-116">快照代理在分发服务器上运行。</span><span class="sxs-lookup"><span data-stu-id="713da-116">The Snapshot Agent runs at the Distributor.</span></span> <span data-ttu-id="713da-117">有关详细信息，请参阅 [Replication Snapshot Agent](replication-snapshot-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-117">For more information, see [Replication Snapshot Agent](replication-snapshot-agent.md).</span></span>  
  
## <a name="log-reader-agent"></a><span data-ttu-id="713da-118">日志读取器代理</span><span class="sxs-lookup"><span data-stu-id="713da-118">Log Reader Agent</span></span>  
 <span data-ttu-id="713da-119">日志读取器代理与事务复制一起使用。</span><span class="sxs-lookup"><span data-stu-id="713da-119">The Log Reader Agent is used with transactional replication.</span></span> <span data-ttu-id="713da-120">它将发布服务器上的事务日志中标记为复制的事务移至分发数据库中。</span><span class="sxs-lookup"><span data-stu-id="713da-120">It moves transactions marked for replication from the transaction log on the Publisher to the distribution database.</span></span> <span data-ttu-id="713da-121">使用事务复制发布的每个数据库都有自己的日志读取器代理，该代理运行于分发服务器上并与发布服务器连接（分发服务器与发布服务器可以是同一台计算机）。</span><span class="sxs-lookup"><span data-stu-id="713da-121">Each database published using transactional replication has its own Log Reader Agent that runs on the Distributor and connects to the Publisher (the Distributor can be on the same computer as the Publisher).</span></span> <span data-ttu-id="713da-122">有关详细信息，请参阅 [Replication Log Reader Agent](replication-log-reader-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-122">For more information, see [Replication Log Reader Agent](replication-log-reader-agent.md).</span></span>  
  
## <a name="distribution-agent"></a><span data-ttu-id="713da-123">分发代理</span><span class="sxs-lookup"><span data-stu-id="713da-123">Distribution Agent</span></span>  
 <span data-ttu-id="713da-124">分发代理与快照复制和事务复制一起使用。</span><span class="sxs-lookup"><span data-stu-id="713da-124">The Distribution Agent is used with snapshot replication and transactional replication.</span></span> <span data-ttu-id="713da-125">它将初始快照应用于订阅服务器，并将分发数据库中保存的事务移至订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="713da-125">It applies the initial snapshot to the Subscriber and moves transactions held in the distribution database to Subscribers.</span></span> <span data-ttu-id="713da-126">分发代理既可以运行于分发服务器（对于推送订阅），也可运行于订阅服务器（对于请求订阅）。</span><span class="sxs-lookup"><span data-stu-id="713da-126">The Distribution Agent runs at either the Distributor for push subscriptions or at the Subscriber for pull subscriptions.</span></span> <span data-ttu-id="713da-127">有关详细信息，请参阅 [Replication Distribution Agent](replication-distribution-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-127">For more information, see [Replication Distribution Agent](replication-distribution-agent.md).</span></span>  
  
## <a name="merge-agent"></a><span data-ttu-id="713da-128">合并代理</span><span class="sxs-lookup"><span data-stu-id="713da-128">Merge Agent</span></span>  
 <span data-ttu-id="713da-129">合并代理与合并复制一起使用。</span><span class="sxs-lookup"><span data-stu-id="713da-129">The Merge Agent is used with merge replication.</span></span> <span data-ttu-id="713da-130">它将初始快照应用于订阅服务器，并移动和协调所发生的增量数据更改。</span><span class="sxs-lookup"><span data-stu-id="713da-130">It applies the initial snapshot to the Subscriber and moves and reconciles incremental data changes that occur.</span></span> <span data-ttu-id="713da-131">每个合并订阅都有自己的合并代理，该代理同时连接到发布服务器和订阅服务器并对它们进行更新。</span><span class="sxs-lookup"><span data-stu-id="713da-131">Each merge subscription has its own Merge Agent that connects to both the Publisher and the Subscriber and updates both.</span></span> <span data-ttu-id="713da-132">合并代理既可以运行于分发服务器（对于推送订阅），也可以运行于订阅服务器（对于请求订阅）。</span><span class="sxs-lookup"><span data-stu-id="713da-132">The Merge Agent runs at either the Distributor for push subscriptions or the Subscriber for pull subscriptions.</span></span> <span data-ttu-id="713da-133">默认情况下，合并代理将订阅服务器上的更改上载到发布服务器，然后将发布服务器上的更改下载到订阅服务器。</span><span class="sxs-lookup"><span data-stu-id="713da-133">By default, the Merge Agent uploads changes from the Subscriber to the Publisher and then downloads changes from the Publisher to the Subscriber.</span></span> <span data-ttu-id="713da-134">有关详细信息，请参阅 [Replication Merge Agent](replication-merge-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-134">For more information, see [Replication Merge Agent](replication-merge-agent.md).</span></span>  
  
## <a name="queue-reader-agent"></a><span data-ttu-id="713da-135">队列读取器代理</span><span class="sxs-lookup"><span data-stu-id="713da-135">Queue Reader Agent</span></span>  
 <span data-ttu-id="713da-136">队列读取器代理与包含排队更新选项的事务复制一起使用。</span><span class="sxs-lookup"><span data-stu-id="713da-136">The Queue Reader Agent is used with transactional replication with the queued updating option.</span></span> <span data-ttu-id="713da-137">该代理运行于分发服务器，并将订阅服务器上所做更改移回至发布服务器。</span><span class="sxs-lookup"><span data-stu-id="713da-137">The agent runs at the Distributor and moves changes made at the Subscriber back to the Publisher.</span></span> <span data-ttu-id="713da-138">与分发代理和合并代理不同，只有一个队列读取器代理的实例为给定分发数据库的所有发布服务器和发布提供服务。</span><span class="sxs-lookup"><span data-stu-id="713da-138">Unlike the Distribution Agent and the Merge Agent, only one instance of the Queue Reader Agent exists to service all Publishers and publications for a given distribution database.</span></span> <span data-ttu-id="713da-139">有关队列读取器代理的详细信息，请参阅 [Replication Queue Reader Agent](replication-queue-reader-agent.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-139">For more information about the Queue Reader Agent, see [Replication Queue Reader Agent](replication-queue-reader-agent.md).</span></span> <span data-ttu-id="713da-140">有关可更新订阅的详细信息，请参阅 [Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-140">For more information about updatable subscriptions, see [Updatable Subscriptions for Transactional Replication](../transactional/updatable-subscriptions-for-transactional-replication.md).</span></span>  
  
## <a name="replication-maintenance-jobs"></a><span data-ttu-id="713da-141">复制维护作业</span><span class="sxs-lookup"><span data-stu-id="713da-141">Replication Maintenance Jobs</span></span>  
 <span data-ttu-id="713da-142">复制包含许多执行计划维护和按需维护的维护作业。</span><span class="sxs-lookup"><span data-stu-id="713da-142">Replication has a number of maintenance jobs that perform scheduled and on-demand maintenance.</span></span> <span data-ttu-id="713da-143">有关详细信息，请参阅[复制代理管理](replication-agent-administration.md)。</span><span class="sxs-lookup"><span data-stu-id="713da-143">For more information, see [Replication Agent Administration](replication-agent-administration.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="713da-144">另请参阅</span><span class="sxs-lookup"><span data-stu-id="713da-144">See Also</span></span>  
 <span data-ttu-id="713da-145">[启动和停止复制代理 (SQL Server Management Studio)](start-and-stop-a-replication-agent-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="713da-145">[Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](start-and-stop-a-replication-agent-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="713da-146">[运行复制维护作业 (SQL Server Management Studio)](../administration/run-replication-maintenance-jobs-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="713da-146">[Run Replication Maintenance Jobs &#40;SQL Server Management Studio&#41;](../administration/run-replication-maintenance-jobs-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="713da-147">[复制代理可执行文件概念](../concepts/replication-agent-executables-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="713da-147">[Replication Agent Executables Concepts](../concepts/replication-agent-executables-concepts.md) </span></span>  
 [<span data-ttu-id="713da-148">复制代理管理</span><span class="sxs-lookup"><span data-stu-id="713da-148">Replication Agent Administration</span></span>](replication-agent-administration.md)  
  
  
