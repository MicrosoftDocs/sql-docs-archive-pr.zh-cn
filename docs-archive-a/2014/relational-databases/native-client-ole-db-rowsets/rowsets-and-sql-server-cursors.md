---
title: 行集和 SQL Server 游标 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- OLE DB rowsets, cursors
- SQL Server Native Client OLE DB provider, rowsets
- rowsets [OLE DB], cursors
- properties [OLE DB]
- cursors [OLE DB]
ms.assetid: 26a11e26-2a3a-451e-8f78-fba51e330ecb
author: rothja
ms.author: jroth
ms.openlocfilehash: ec59f392c7bb648af1b9b69c7513f037d895f096
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579568"
---
# <a name="rowsets-and-sql-server-cursors"></a><span data-ttu-id="8757b-102">行集和 SQL Server 游标</span><span class="sxs-lookup"><span data-stu-id="8757b-102">Rowsets and SQL Server Cursors</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="8757b-103">使用两种方法将结果集返回到使用者：</span><span class="sxs-lookup"><span data-stu-id="8757b-103">returns result sets to consumers using two methods:</span></span>  
  
-   <span data-ttu-id="8757b-104">默认结果集，它可以：</span><span class="sxs-lookup"><span data-stu-id="8757b-104">Default result sets that:</span></span>  
  
    -   <span data-ttu-id="8757b-105">使开销最小化。</span><span class="sxs-lookup"><span data-stu-id="8757b-105">Minimize overhead.</span></span>  
  
    -   <span data-ttu-id="8757b-106">在提取数据过程中提供最大性能。</span><span class="sxs-lookup"><span data-stu-id="8757b-106">Provide maximal performance in fetching data.</span></span>  
  
    -   <span data-ttu-id="8757b-107">仅支持默认的只进、只读游标功能。</span><span class="sxs-lookup"><span data-stu-id="8757b-107">Support only the default forward-only, read-only cursor functionality.</span></span>  
  
    -   <span data-ttu-id="8757b-108">每次一行将行返回到使用者。</span><span class="sxs-lookup"><span data-stu-id="8757b-108">Return rows to the consumer one row at a time.</span></span>  
  
    -   <span data-ttu-id="8757b-109">在一个连接上每次仅支持一个活动语句。</span><span class="sxs-lookup"><span data-stu-id="8757b-109">Support only one active statement at a time on a connection.</span></span>  
  
         <span data-ttu-id="8757b-110">执行完某语句之后，直到使用者已检索所有结果或已取消此语句，才能在连接上执行其他语句。</span><span class="sxs-lookup"><span data-stu-id="8757b-110">After a statement has been executed, no other statements can be executed on the connection until all the results have been retrieved by the consumer or the statement has been canceled.</span></span>  
  
    -   <span data-ttu-id="8757b-111">支持所有 [!INCLUDE[tsql](../../includes/tsql-md.md)] 语句。</span><span class="sxs-lookup"><span data-stu-id="8757b-111">Support all [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   <span data-ttu-id="8757b-112">服务器游标，它可以：</span><span class="sxs-lookup"><span data-stu-id="8757b-112">Server cursors that:</span></span>  
  
    -   <span data-ttu-id="8757b-113">支持所有游标功能。</span><span class="sxs-lookup"><span data-stu-id="8757b-113">Support all cursor functionality.</span></span>  
  
    -   <span data-ttu-id="8757b-114">将行块返回到使用者。</span><span class="sxs-lookup"><span data-stu-id="8757b-114">Can return blocks of rows to the consumer.</span></span>  
  
    -   <span data-ttu-id="8757b-115">在单个连接上支持多个活动语句。</span><span class="sxs-lookup"><span data-stu-id="8757b-115">Support multiple active statements on a single connection.</span></span>  
  
    -   <span data-ttu-id="8757b-116">根据性能平衡游标功能。</span><span class="sxs-lookup"><span data-stu-id="8757b-116">Balance cursor functionality against performance.</span></span>  
  
         <span data-ttu-id="8757b-117">相对于默认结果集，对游标功能的支持会使性能降低。</span><span class="sxs-lookup"><span data-stu-id="8757b-117">The support for cursor functionality can decrease performance relative to a default result set.</span></span> <span data-ttu-id="8757b-118">如果使用者可以使用游标功能检索更小的行集，则可以将其抵销。</span><span class="sxs-lookup"><span data-stu-id="8757b-118">This can be offset if the consumer can use cursor functionality to retrieve a smaller set of rows.</span></span>  
  
    -   <span data-ttu-id="8757b-119">不支持任何返回多个结果集的 [!INCLUDE[tsql](../../includes/tsql-md.md)] 语句。</span><span class="sxs-lookup"><span data-stu-id="8757b-119">Do not support any [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns more than a single result set.</span></span>  
  
 <span data-ttu-id="8757b-120">通过设置某些行集属性，使用者可以请求行集中的其他游标行为。</span><span class="sxs-lookup"><span data-stu-id="8757b-120">Consumers can request different cursor behaviors in a rowset by setting certain rowset properties.</span></span> <span data-ttu-id="8757b-121">如果使用者未设置这些行集属性中的任何一个，或将它们全部设置为其默认值，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序使用默认结果集实现行集。</span><span class="sxs-lookup"><span data-stu-id="8757b-121">If the consumer does not set any one of these rowset properties or sets them all to their default values, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the rowset using a default result set.</span></span> <span data-ttu-id="8757b-122">如果将这些属性中的任何一个设置为默认值以外的值，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将使用服务器游标实现行集。</span><span class="sxs-lookup"><span data-stu-id="8757b-122">If any one of these properties is set to a value other than the default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the rowset using a server cursor.</span></span>  
  
 <span data-ttu-id="8757b-123">以下行集属性指引 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 游标。</span><span class="sxs-lookup"><span data-stu-id="8757b-123">The following rowset properties direct the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors.</span></span> <span data-ttu-id="8757b-124">某些属性可以安全地与其他属性组合。</span><span class="sxs-lookup"><span data-stu-id="8757b-124">Some properties can be safely combined with others.</span></span> <span data-ttu-id="8757b-125">例如，展示 DBPROP_IRowsetScroll 和 DBPROP_IRowsetChange 属性的行集将是展示立即更新行为的书签行集。</span><span class="sxs-lookup"><span data-stu-id="8757b-125">For example, a rowset that exhibits the DBPROP_IRowsetScroll and DBPROP_IRowsetChange properties will be a bookmark rowset exhibiting immediate update behavior.</span></span> <span data-ttu-id="8757b-126">其他属性相互排斥。</span><span class="sxs-lookup"><span data-stu-id="8757b-126">Other properties are mutually exclusive.</span></span> <span data-ttu-id="8757b-127">例如，展示 DBPROP_OTHERINSERT 的行集不能包含书签。</span><span class="sxs-lookup"><span data-stu-id="8757b-127">For example, a rowset exhibiting DBPROP_OTHERINSERT cannot contain bookmarks.</span></span>  
  
|<span data-ttu-id="8757b-128">属性 ID</span><span class="sxs-lookup"><span data-stu-id="8757b-128">Property ID</span></span>|<span data-ttu-id="8757b-129">值</span><span class="sxs-lookup"><span data-stu-id="8757b-129">Value</span></span>|<span data-ttu-id="8757b-130">行集行为</span><span class="sxs-lookup"><span data-stu-id="8757b-130">Rowset behavior</span></span>|  
|-----------------|-----------|---------------------|  
|<span data-ttu-id="8757b-131">DBPROP_SERVERCURSOR</span><span class="sxs-lookup"><span data-stu-id="8757b-131">DBPROP_SERVERCURSOR</span></span>|<span data-ttu-id="8757b-132">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-132">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-133">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-133">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-134">行集是有顺序的，只支持向前滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-134">The rowset is sequential, supporting forward scrolling and fetching only.</span></span> <span data-ttu-id="8757b-135">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-135">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-136">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-136">Command text can contain an ORDER BY clause.</span></span>|  
|<span data-ttu-id="8757b-137">DBPROP_CANSCROLLBACKWARDS 或 DBPROP_CANFETCHBACKWARDS</span><span class="sxs-lookup"><span data-stu-id="8757b-137">DBPROP_CANSCROLLBACKWARDS or DBPROP_CANFETCHBACKWARDS</span></span>|<span data-ttu-id="8757b-138">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-138">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-139">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-139">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-140">行集支持双向滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-140">The rowset supports scrolling and fetching in either direction.</span></span> <span data-ttu-id="8757b-141">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-141">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-142">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-142">Command text can contain an ORDER BY clause.</span></span>|  
|<span data-ttu-id="8757b-143">DBPROP_BOOKMARKS 或 DBPROP_LITERALBOOKMARKS</span><span class="sxs-lookup"><span data-stu-id="8757b-143">DBPROP_BOOKMARKS or DBPROP_LITERALBOOKMARKS</span></span>|<span data-ttu-id="8757b-144">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-144">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-145">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-145">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-146">行集是有顺序的，只支持向前滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-146">The rowset is sequential, supporting forward scrolling and fetching only.</span></span> <span data-ttu-id="8757b-147">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-147">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-148">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-148">Command text can contain an ORDER BY clause.</span></span>|  
|<span data-ttu-id="8757b-149">DBPROP_OWNUPDATEDELETE 或 DBPROP_OWNINSERT 或 DBPROP_OTHERUPDATEDELETE</span><span class="sxs-lookup"><span data-stu-id="8757b-149">DBPROP_OWNUPDATEDELETE or DBPROP_OWNINSERT or DBPROP_OTHERUPDATEDELETE</span></span>|<span data-ttu-id="8757b-150">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-150">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-151">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-151">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-152">行集支持双向滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-152">The rowset supports scrolling and fetching in either direction.</span></span> <span data-ttu-id="8757b-153">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-153">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-154">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-154">Command text can contain an ORDER BY clause.</span></span>|  
|<span data-ttu-id="8757b-155">DBPROP_OTHERINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-155">DBPROP_OTHERINSERT</span></span>|<span data-ttu-id="8757b-156">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-156">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-157">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-157">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-158">行集支持双向滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-158">The rowset supports scrolling and fetching in either direction.</span></span> <span data-ttu-id="8757b-159">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-159">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-160">如果针对被引用的列存在索引，则命令文本可以包括 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-160">Command text can include an ORDER BY clause if an index exists on the referenced columns.</span></span><br /><br /> <span data-ttu-id="8757b-161">如果行集包含书签，则 DBPROP_OTHERINSERT 不能是 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="8757b-161">DBPROP_OTHERINSERT cannot be VARIANT_TRUE if the rowset contains bookmarks.</span></span> <span data-ttu-id="8757b-162">如果试图创建具有该可视性属性和书签的行集，将导致错误。</span><span class="sxs-lookup"><span data-stu-id="8757b-162">Trying to create a rowset with this visibility property and bookmarks causes an error.</span></span>|  
|<span data-ttu-id="8757b-163">DBPROP_IRowsetLocate 或 DBPROP_IRowsetScroll</span><span class="sxs-lookup"><span data-stu-id="8757b-163">DBPROP_IRowsetLocate or DBPROP_IRowsetScroll</span></span>|<span data-ttu-id="8757b-164">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-164">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-165">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-165">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-166">行集支持双向滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-166">The rowset supports scrolling and fetching in either direction.</span></span> <span data-ttu-id="8757b-167">支持在行集中通过 IRowsetLocate 接口执行书签操作和绝对定位\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8757b-167">Bookmarks and absolute positioning through the **IRowsetLocate** interface are supported in the rowset.</span></span> <span data-ttu-id="8757b-168">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-168">Command text can contain an ORDER BY clause.</span></span><br /><br /> <span data-ttu-id="8757b-169">DBPROP_IRowsetLocate 和 DBPROP_IRowsetScroll 需要行集中有书签。</span><span class="sxs-lookup"><span data-stu-id="8757b-169">DBPROP_IRowsetLocate and DBPROP_IRowsetScroll require bookmarks in the rowset.</span></span> <span data-ttu-id="8757b-170">如果试图创建具有书签并将 DBPROP_OTHERINSERT 设置为 VARIANT_TRUE 的行集，将导致错误。</span><span class="sxs-lookup"><span data-stu-id="8757b-170">Trying to create a rowset with bookmarks and DBPROP_OTHERINSERT set to VARIANT_TRUE causes an error.</span></span>|  
|<span data-ttu-id="8757b-171">DBPROP_IRowsetChange 或 DBPROP_IRowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="8757b-171">DBPROP_IRowsetChange or DBPROP_IRowsetUpdate</span></span>|<span data-ttu-id="8757b-172">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-172">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-173">可以通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-173">Can update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-174">行集是有顺序的，只支持向前滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-174">The rowset is sequential, supporting forward scrolling and fetching only.</span></span> <span data-ttu-id="8757b-175">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-175">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-176">支持可更新游标的所有命令都可以支持这些接口。</span><span class="sxs-lookup"><span data-stu-id="8757b-176">All the commands that support updatable cursors can support these interfaces.</span></span>|  
|<span data-ttu-id="8757b-177">DBPROP_IRowsetLocate 或 DBPROP_IRowsetScroll 和 DBPROP_IRowsetChange 或 DBPROP_IRowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="8757b-177">DBPROP_IRowsetLocate or DBPROP_IRowsetScroll and  DBPROP_IRowsetChange or DBPROP_IRowsetUpdate</span></span>|<span data-ttu-id="8757b-178">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-178">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-179">可以通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-179">Can update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-180">行集支持双向滚动和提取。</span><span class="sxs-lookup"><span data-stu-id="8757b-180">The rowset supports scrolling and fetching in either direction.</span></span> <span data-ttu-id="8757b-181">支持在行集中通过 IRowsetLocate 执行书签操作和绝对定位\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8757b-181">Bookmarks and absolute positioning through **IRowsetLocate** are supported in the rowset.</span></span> <span data-ttu-id="8757b-182">命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-182">Command text can contain an ORDER BY clause.</span></span>|  
|<span data-ttu-id="8757b-183">DBPROP_IMMOBILEROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-183">DBPROP_IMMOBILEROWS</span></span>|<span data-ttu-id="8757b-184">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="8757b-184">VARIANT_FALSE</span></span>|<span data-ttu-id="8757b-185">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-185">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-186">行集只支持向前滚动。</span><span class="sxs-lookup"><span data-stu-id="8757b-186">The rowset supports forward scrolling only.</span></span> <span data-ttu-id="8757b-187">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-187">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-188">如果针对被引用的列存在索引，则命令文本可以包括 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-188">Command text can include an ORDER BY clause if an index exists on the referenced columns.</span></span><br /><br /> <span data-ttu-id="8757b-189">DBPROP_IMMOBILEROWS 仅在可以显示由其他会话的命令或由其他用户插入的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 行的行集中可用。</span><span class="sxs-lookup"><span data-stu-id="8757b-189">DBPROP_IMMOBILEROWS is only available in rowsets that can show [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] rows inserted by commands on other sessions or by other users.</span></span> <span data-ttu-id="8757b-190">如果试图在其 DBPROP_OTHERINSERT 不能是 VARIANT_TRUE 的任何行集上打开一个该属性设置为 VARIANT_FALSE 的行集，将导致错误。</span><span class="sxs-lookup"><span data-stu-id="8757b-190">Trying to open a rowset with the property set to VARIANT_FALSE on any rowset for which DBPROP_OTHERINSERT cannot be VARIANT_TRUE causes an error.</span></span>|  
|<span data-ttu-id="8757b-191">DBPROP_REMOVEDELETED</span><span class="sxs-lookup"><span data-stu-id="8757b-191">DBPROP_REMOVEDELETED</span></span>|<span data-ttu-id="8757b-192">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-192">VARIANT_TRUE</span></span>|<span data-ttu-id="8757b-193">无法通过行集更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据。</span><span class="sxs-lookup"><span data-stu-id="8757b-193">Cannot update [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data through the rowset.</span></span> <span data-ttu-id="8757b-194">行集只支持向前滚动。</span><span class="sxs-lookup"><span data-stu-id="8757b-194">The rowset supports forward scrolling only.</span></span> <span data-ttu-id="8757b-195">支持相对行定位。</span><span class="sxs-lookup"><span data-stu-id="8757b-195">Relative row positioning is supported.</span></span> <span data-ttu-id="8757b-196">除非受另一个属性约束，否则命令文本可以包含 ORDER BY 子句。</span><span class="sxs-lookup"><span data-stu-id="8757b-196">Command text can contain an ORDER BY clause unless constrained by another property.</span></span>|  
  
 <span data-ttu-id="8757b-197">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]可以通过 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 使用**IOpenRowset：： OpenRowset**方法，在基础表或视图上轻松创建服务器游标支持的 Native Client OLE DB 提供程序行集。</span><span class="sxs-lookup"><span data-stu-id="8757b-197">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset supported by a server cursor can be easily created on a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] base table or view by using the **IOpenRowset::OpenRowset** method.</span></span> <span data-ttu-id="8757b-198">按名称指定表或视图，同时在 rgPropertySets 参数中传递所需的行集属性集\*\*。</span><span class="sxs-lookup"><span data-stu-id="8757b-198">Specify the table or view by name, passing the required rowset property sets in the *rgPropertySets* parameter.</span></span>  
  
 <span data-ttu-id="8757b-199">当使用者需要服务器游标支持行集时，创建行集的命令文本将受到限制。</span><span class="sxs-lookup"><span data-stu-id="8757b-199">Command text that creates a rowset is restricted when the consumer requires that the rowset be supported by a server cursor.</span></span> <span data-ttu-id="8757b-200">具体来说，命令文本只能是返回单个行集结果的单个 SELECT 语句，或实现返回单个行集结果的单个 SELECT 语句的存储过程。</span><span class="sxs-lookup"><span data-stu-id="8757b-200">Specifically, the command text is restricted to either a single SELECT statement that returns a single rowset result or a stored procedure that implements a single SELECT statement returning a single rowset result.</span></span>  
  
 <span data-ttu-id="8757b-201">以下两个表显示各种 OLE DB 属性与各游标模型之间的一一对应关系。</span><span class="sxs-lookup"><span data-stu-id="8757b-201">These two tables show the mappings of various OLE DB properties and the cursor models.</span></span> <span data-ttu-id="8757b-202">它们还显示使用某一类型游标模型时应当设置哪些行集属性。</span><span class="sxs-lookup"><span data-stu-id="8757b-202">They also show which rowset properties should be set to use a certain type of cursor model.</span></span>  
  
 <span data-ttu-id="8757b-203">表中的每个单元格都包含相应行集属性对于特定游标模型的值。</span><span class="sxs-lookup"><span data-stu-id="8757b-203">Each cell in the table contains a value of the rowset property for the specific cursor model.</span></span> <span data-ttu-id="8757b-204">本主题前面列出的所有行集属性的数据类型都是 VT_BOOL，并且默认值都是 VARIANT_FALSE。</span><span class="sxs-lookup"><span data-stu-id="8757b-204">The data type of all the rowset properties listed earlier in this topic is VT_BOOL and the default value is VARIANT_FALSE.</span></span> <span data-ttu-id="8757b-205">下面的表使用了以下符号。</span><span class="sxs-lookup"><span data-stu-id="8757b-205">The following symbols are used in the table.</span></span>  
  
 <span data-ttu-id="8757b-206">F = 默认值 (VARIANT_FALSE)</span><span class="sxs-lookup"><span data-stu-id="8757b-206">F = default value (VARIANT_FALSE)</span></span>  
  
 <span data-ttu-id="8757b-207">T = VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="8757b-207">T = VARIANT_TRUE</span></span>  
  
 <span data-ttu-id="8757b-208">\- = VARIANT_TRUE 或 VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="8757b-208">\- = VARIANT_TRUE or VARIANT_FALSE</span></span>  
  
 <span data-ttu-id="8757b-209">若要使用某一类型的游标模型，请找到对应于该游标模型的列，并查找在此列中值为“T”的所有行集属性。</span><span class="sxs-lookup"><span data-stu-id="8757b-209">To use a certain type of cursor model, locate the column corresponding to the cursor model and find all the rowset properties with value 'T' in the column.</span></span> <span data-ttu-id="8757b-210">将这些行集属性设置为 VARIANT_TRUE 即可使用特定游标模型。</span><span class="sxs-lookup"><span data-stu-id="8757b-210">Set these rowset properties to VARIANT_TRUE to use the specific cursor model.</span></span> <span data-ttu-id="8757b-211">可以将值为“-”的行集属性设置为 VARIANT_TRUE 或 VARIANT_FALSE。</span><span class="sxs-lookup"><span data-stu-id="8757b-211">The rowset properties with '-' as a value can be set to either VARIANT_TRUE or VARIANT_FALSE.</span></span>  
  
|<span data-ttu-id="8757b-212">行集属性/游标模型</span><span class="sxs-lookup"><span data-stu-id="8757b-212">Rowset properties/cursor models</span></span>|<span data-ttu-id="8757b-213">默认</span><span class="sxs-lookup"><span data-stu-id="8757b-213">Default</span></span><br /><br /> <span data-ttu-id="8757b-214">result</span><span class="sxs-lookup"><span data-stu-id="8757b-214">result</span></span><br /><br /> <span data-ttu-id="8757b-215">set</span><span class="sxs-lookup"><span data-stu-id="8757b-215">set</span></span><br /><br /> <span data-ttu-id="8757b-216">(RO)</span><span class="sxs-lookup"><span data-stu-id="8757b-216">(RO)</span></span>|<span data-ttu-id="8757b-217">快</span><span class="sxs-lookup"><span data-stu-id="8757b-217">Fast</span></span><br /><br /> <span data-ttu-id="8757b-218">只</span><span class="sxs-lookup"><span data-stu-id="8757b-218">forward-</span></span><br /><br /> <span data-ttu-id="8757b-219">（仅限）</span><span class="sxs-lookup"><span data-stu-id="8757b-219">only</span></span><br /><br /> <span data-ttu-id="8757b-220">(RO)</span><span class="sxs-lookup"><span data-stu-id="8757b-220">(RO)</span></span>|<span data-ttu-id="8757b-221">静态</span><span class="sxs-lookup"><span data-stu-id="8757b-221">Static</span></span><br /><br /> <span data-ttu-id="8757b-222">(RO)</span><span class="sxs-lookup"><span data-stu-id="8757b-222">(RO)</span></span>|<span data-ttu-id="8757b-223">Keyset</span><span class="sxs-lookup"><span data-stu-id="8757b-223">Keyset</span></span><br /><br /> <span data-ttu-id="8757b-224">驱动 </span><span class="sxs-lookup"><span data-stu-id="8757b-224">driven</span></span><br /><br /> <span data-ttu-id="8757b-225">(RO)</span><span class="sxs-lookup"><span data-stu-id="8757b-225">(RO)</span></span>|  
|--------------------------------------|-------------------------------------------|--------------------------------------------|-----------------------|----------------------------------|  
|<span data-ttu-id="8757b-226">DBPROP_SERVERCURSOR</span><span class="sxs-lookup"><span data-stu-id="8757b-226">DBPROP_SERVERCURSOR</span></span>|<span data-ttu-id="8757b-227">F</span><span class="sxs-lookup"><span data-stu-id="8757b-227">F</span></span>|<span data-ttu-id="8757b-228">T</span><span class="sxs-lookup"><span data-stu-id="8757b-228">T</span></span>|<span data-ttu-id="8757b-229">T</span><span class="sxs-lookup"><span data-stu-id="8757b-229">T</span></span>|<span data-ttu-id="8757b-230">T</span><span class="sxs-lookup"><span data-stu-id="8757b-230">T</span></span>|  
|<span data-ttu-id="8757b-231">DBPROP_DEFERRED</span><span class="sxs-lookup"><span data-stu-id="8757b-231">DBPROP_DEFERRED</span></span>|<span data-ttu-id="8757b-232">F</span><span class="sxs-lookup"><span data-stu-id="8757b-232">F</span></span>|<span data-ttu-id="8757b-233">F</span><span class="sxs-lookup"><span data-stu-id="8757b-233">F</span></span>|-|-|  
|<span data-ttu-id="8757b-234">DBPROP_IrowsetChange</span><span class="sxs-lookup"><span data-stu-id="8757b-234">DBPROP_IrowsetChange</span></span>|<span data-ttu-id="8757b-235">F</span><span class="sxs-lookup"><span data-stu-id="8757b-235">F</span></span>|<span data-ttu-id="8757b-236">F</span><span class="sxs-lookup"><span data-stu-id="8757b-236">F</span></span>|<span data-ttu-id="8757b-237">F</span><span class="sxs-lookup"><span data-stu-id="8757b-237">F</span></span>|<span data-ttu-id="8757b-238">F</span><span class="sxs-lookup"><span data-stu-id="8757b-238">F</span></span>|  
|<span data-ttu-id="8757b-239">DBPROP_IrowsetLocate</span><span class="sxs-lookup"><span data-stu-id="8757b-239">DBPROP_IrowsetLocate</span></span>|<span data-ttu-id="8757b-240">F</span><span class="sxs-lookup"><span data-stu-id="8757b-240">F</span></span>|<span data-ttu-id="8757b-241">F</span><span class="sxs-lookup"><span data-stu-id="8757b-241">F</span></span>|-|-|  
|<span data-ttu-id="8757b-242">DBPROP_IrowsetScroll</span><span class="sxs-lookup"><span data-stu-id="8757b-242">DBPROP_IrowsetScroll</span></span>|<span data-ttu-id="8757b-243">F</span><span class="sxs-lookup"><span data-stu-id="8757b-243">F</span></span>|<span data-ttu-id="8757b-244">F</span><span class="sxs-lookup"><span data-stu-id="8757b-244">F</span></span>|-|-|  
|<span data-ttu-id="8757b-245">DBPROP_IrowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="8757b-245">DBPROP_IrowsetUpdate</span></span>|<span data-ttu-id="8757b-246">F</span><span class="sxs-lookup"><span data-stu-id="8757b-246">F</span></span>|<span data-ttu-id="8757b-247">F</span><span class="sxs-lookup"><span data-stu-id="8757b-247">F</span></span>|<span data-ttu-id="8757b-248">F</span><span class="sxs-lookup"><span data-stu-id="8757b-248">F</span></span>|<span data-ttu-id="8757b-249">F</span><span class="sxs-lookup"><span data-stu-id="8757b-249">F</span></span>|  
|<span data-ttu-id="8757b-250">DBPROP_BOOKMARKS</span><span class="sxs-lookup"><span data-stu-id="8757b-250">DBPROP_BOOKMARKS</span></span>|<span data-ttu-id="8757b-251">F</span><span class="sxs-lookup"><span data-stu-id="8757b-251">F</span></span>|<span data-ttu-id="8757b-252">F</span><span class="sxs-lookup"><span data-stu-id="8757b-252">F</span></span>|-|-|  
|<span data-ttu-id="8757b-253">DBPROP_CANFETCHBACKWARDS</span><span class="sxs-lookup"><span data-stu-id="8757b-253">DBPROP_CANFETCHBACKWARDS</span></span>|<span data-ttu-id="8757b-254">F</span><span class="sxs-lookup"><span data-stu-id="8757b-254">F</span></span>|<span data-ttu-id="8757b-255">F</span><span class="sxs-lookup"><span data-stu-id="8757b-255">F</span></span>|-|-|  
|<span data-ttu-id="8757b-256">DBPROP_CANSRCOLLBACKWARDS</span><span class="sxs-lookup"><span data-stu-id="8757b-256">DBPROP_CANSRCOLLBACKWARDS</span></span>|<span data-ttu-id="8757b-257">F</span><span class="sxs-lookup"><span data-stu-id="8757b-257">F</span></span>|<span data-ttu-id="8757b-258">F</span><span class="sxs-lookup"><span data-stu-id="8757b-258">F</span></span>|-|-|  
|<span data-ttu-id="8757b-259">DBPROP_CANHOLDROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-259">DBPROP_CANHOLDROWS</span></span>|<span data-ttu-id="8757b-260">F</span><span class="sxs-lookup"><span data-stu-id="8757b-260">F</span></span>|<span data-ttu-id="8757b-261">F</span><span class="sxs-lookup"><span data-stu-id="8757b-261">F</span></span>|-|-|  
|<span data-ttu-id="8757b-262">DBPROP_LITERALBOOKMARKS</span><span class="sxs-lookup"><span data-stu-id="8757b-262">DBPROP_LITERALBOOKMARKS</span></span>|<span data-ttu-id="8757b-263">F</span><span class="sxs-lookup"><span data-stu-id="8757b-263">F</span></span>|<span data-ttu-id="8757b-264">F</span><span class="sxs-lookup"><span data-stu-id="8757b-264">F</span></span>|-|-|  
|<span data-ttu-id="8757b-265">DBPROP_OTHERINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-265">DBPROP_OTHERINSERT</span></span>|<span data-ttu-id="8757b-266">F</span><span class="sxs-lookup"><span data-stu-id="8757b-266">F</span></span>|<span data-ttu-id="8757b-267">T</span><span class="sxs-lookup"><span data-stu-id="8757b-267">T</span></span>|<span data-ttu-id="8757b-268">F</span><span class="sxs-lookup"><span data-stu-id="8757b-268">F</span></span>|<span data-ttu-id="8757b-269">F</span><span class="sxs-lookup"><span data-stu-id="8757b-269">F</span></span>|  
|<span data-ttu-id="8757b-270">DBPROP_OTHERUPDATEDELETE</span><span class="sxs-lookup"><span data-stu-id="8757b-270">DBPROP_OTHERUPDATEDELETE</span></span>|<span data-ttu-id="8757b-271">F</span><span class="sxs-lookup"><span data-stu-id="8757b-271">F</span></span>|<span data-ttu-id="8757b-272">T</span><span class="sxs-lookup"><span data-stu-id="8757b-272">T</span></span>|<span data-ttu-id="8757b-273">F</span><span class="sxs-lookup"><span data-stu-id="8757b-273">F</span></span>|<span data-ttu-id="8757b-274">T</span><span class="sxs-lookup"><span data-stu-id="8757b-274">T</span></span>|  
|<span data-ttu-id="8757b-275">DBPROP_OWNINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-275">DBPROP_OWNINSERT</span></span>|<span data-ttu-id="8757b-276">F</span><span class="sxs-lookup"><span data-stu-id="8757b-276">F</span></span>|<span data-ttu-id="8757b-277">T</span><span class="sxs-lookup"><span data-stu-id="8757b-277">T</span></span>|<span data-ttu-id="8757b-278">F</span><span class="sxs-lookup"><span data-stu-id="8757b-278">F</span></span>|<span data-ttu-id="8757b-279">T</span><span class="sxs-lookup"><span data-stu-id="8757b-279">T</span></span>|  
|<span data-ttu-id="8757b-280">DBPROP_OWNUPDATEDELETE</span><span class="sxs-lookup"><span data-stu-id="8757b-280">DBPROP_OWNUPDATEDELETE</span></span>|<span data-ttu-id="8757b-281">F</span><span class="sxs-lookup"><span data-stu-id="8757b-281">F</span></span>|<span data-ttu-id="8757b-282">T</span><span class="sxs-lookup"><span data-stu-id="8757b-282">T</span></span>|<span data-ttu-id="8757b-283">F</span><span class="sxs-lookup"><span data-stu-id="8757b-283">F</span></span>|<span data-ttu-id="8757b-284">T</span><span class="sxs-lookup"><span data-stu-id="8757b-284">T</span></span>|  
|<span data-ttu-id="8757b-285">DBPROP_QUICKSTART</span><span class="sxs-lookup"><span data-stu-id="8757b-285">DBPROP_QUICKSTART</span></span>|<span data-ttu-id="8757b-286">F</span><span class="sxs-lookup"><span data-stu-id="8757b-286">F</span></span>|<span data-ttu-id="8757b-287">F</span><span class="sxs-lookup"><span data-stu-id="8757b-287">F</span></span>|-|-|  
|<span data-ttu-id="8757b-288">DBPROP_REMOVEDELETED</span><span class="sxs-lookup"><span data-stu-id="8757b-288">DBPROP_REMOVEDELETED</span></span>|<span data-ttu-id="8757b-289">F</span><span class="sxs-lookup"><span data-stu-id="8757b-289">F</span></span>|<span data-ttu-id="8757b-290">F</span><span class="sxs-lookup"><span data-stu-id="8757b-290">F</span></span>|<span data-ttu-id="8757b-291">F</span><span class="sxs-lookup"><span data-stu-id="8757b-291">F</span></span>|-|  
|<span data-ttu-id="8757b-292">DBPROP_IrowsetResynch</span><span class="sxs-lookup"><span data-stu-id="8757b-292">DBPROP_IrowsetResynch</span></span>|<span data-ttu-id="8757b-293">F</span><span class="sxs-lookup"><span data-stu-id="8757b-293">F</span></span>|<span data-ttu-id="8757b-294">F</span><span class="sxs-lookup"><span data-stu-id="8757b-294">F</span></span>|<span data-ttu-id="8757b-295">F</span><span class="sxs-lookup"><span data-stu-id="8757b-295">F</span></span>|-|  
|<span data-ttu-id="8757b-296">DBPROP_CHANGEINSERTEDROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-296">DBPROP_CHANGEINSERTEDROWS</span></span>|<span data-ttu-id="8757b-297">F</span><span class="sxs-lookup"><span data-stu-id="8757b-297">F</span></span>|<span data-ttu-id="8757b-298">F</span><span class="sxs-lookup"><span data-stu-id="8757b-298">F</span></span>|<span data-ttu-id="8757b-299">F</span><span class="sxs-lookup"><span data-stu-id="8757b-299">F</span></span>|<span data-ttu-id="8757b-300">F</span><span class="sxs-lookup"><span data-stu-id="8757b-300">F</span></span>|  
|<span data-ttu-id="8757b-301">DBPROP_SERVERDATAONINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-301">DBPROP_SERVERDATAONINSERT</span></span>|<span data-ttu-id="8757b-302">F</span><span class="sxs-lookup"><span data-stu-id="8757b-302">F</span></span>|<span data-ttu-id="8757b-303">F</span><span class="sxs-lookup"><span data-stu-id="8757b-303">F</span></span>|<span data-ttu-id="8757b-304">F</span><span class="sxs-lookup"><span data-stu-id="8757b-304">F</span></span>|-|  
|<span data-ttu-id="8757b-305">DBPROP_UNIQUEROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-305">DBPROP_UNIQUEROWS</span></span>|-|<span data-ttu-id="8757b-306">F</span><span class="sxs-lookup"><span data-stu-id="8757b-306">F</span></span>|<span data-ttu-id="8757b-307">F</span><span class="sxs-lookup"><span data-stu-id="8757b-307">F</span></span>|<span data-ttu-id="8757b-308">F</span><span class="sxs-lookup"><span data-stu-id="8757b-308">F</span></span>|  
|<span data-ttu-id="8757b-309">DBPROP_IMMOBILEROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-309">DBPROP_IMMOBILEROWS</span></span>|-|-|-|<span data-ttu-id="8757b-310">T</span><span class="sxs-lookup"><span data-stu-id="8757b-310">T</span></span>|  
  
|<span data-ttu-id="8757b-311">行集属性/游标模型</span><span class="sxs-lookup"><span data-stu-id="8757b-311">Rowset properties/Cursor models</span></span>|<span data-ttu-id="8757b-312">动态 (RO)</span><span class="sxs-lookup"><span data-stu-id="8757b-312">Dynamic (RO)</span></span>|<span data-ttu-id="8757b-313">键集 (R/W)</span><span class="sxs-lookup"><span data-stu-id="8757b-313">Keyset (R/W)</span></span>|<span data-ttu-id="8757b-314">动态 (R/W)</span><span class="sxs-lookup"><span data-stu-id="8757b-314">Dynamic (R/W)</span></span>|  
|--------------------------------------|--------------------|---------------------|----------------------|  
|<span data-ttu-id="8757b-315">DBPROP_SERVERCURSOR</span><span class="sxs-lookup"><span data-stu-id="8757b-315">DBPROP_SERVERCURSOR</span></span>|<span data-ttu-id="8757b-316">T</span><span class="sxs-lookup"><span data-stu-id="8757b-316">T</span></span>|<span data-ttu-id="8757b-317">T</span><span class="sxs-lookup"><span data-stu-id="8757b-317">T</span></span>|<span data-ttu-id="8757b-318">T</span><span class="sxs-lookup"><span data-stu-id="8757b-318">T</span></span>|  
|<span data-ttu-id="8757b-319">DBPROP_DEFERRED</span><span class="sxs-lookup"><span data-stu-id="8757b-319">DBPROP_DEFERRED</span></span>|-|-|-|  
|<span data-ttu-id="8757b-320">DBPROP_IrowsetChange</span><span class="sxs-lookup"><span data-stu-id="8757b-320">DBPROP_IrowsetChange</span></span>|<span data-ttu-id="8757b-321">F</span><span class="sxs-lookup"><span data-stu-id="8757b-321">F</span></span>|-|-|  
|<span data-ttu-id="8757b-322">DBPROP_IrowsetLocate</span><span class="sxs-lookup"><span data-stu-id="8757b-322">DBPROP_IrowsetLocate</span></span>|<span data-ttu-id="8757b-323">F</span><span class="sxs-lookup"><span data-stu-id="8757b-323">F</span></span>|-|<span data-ttu-id="8757b-324">F</span><span class="sxs-lookup"><span data-stu-id="8757b-324">F</span></span>|  
|<span data-ttu-id="8757b-325">DBPROP_IrowsetScroll</span><span class="sxs-lookup"><span data-stu-id="8757b-325">DBPROP_IrowsetScroll</span></span>|<span data-ttu-id="8757b-326">F</span><span class="sxs-lookup"><span data-stu-id="8757b-326">F</span></span>|-|<span data-ttu-id="8757b-327">F</span><span class="sxs-lookup"><span data-stu-id="8757b-327">F</span></span>|  
|<span data-ttu-id="8757b-328">DBPROP_IrowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="8757b-328">DBPROP_IrowsetUpdate</span></span>|<span data-ttu-id="8757b-329">F</span><span class="sxs-lookup"><span data-stu-id="8757b-329">F</span></span>|-|-|  
|<span data-ttu-id="8757b-330">DBPROP_BOOKMARKS</span><span class="sxs-lookup"><span data-stu-id="8757b-330">DBPROP_BOOKMARKS</span></span>|<span data-ttu-id="8757b-331">F</span><span class="sxs-lookup"><span data-stu-id="8757b-331">F</span></span>|-|<span data-ttu-id="8757b-332">F</span><span class="sxs-lookup"><span data-stu-id="8757b-332">F</span></span>|  
|<span data-ttu-id="8757b-333">DBPROP_CANFETCHBACKWARDS</span><span class="sxs-lookup"><span data-stu-id="8757b-333">DBPROP_CANFETCHBACKWARDS</span></span>|-|-|-|  
|<span data-ttu-id="8757b-334">DBPROP_CANSRCOLLBACKWARDS</span><span class="sxs-lookup"><span data-stu-id="8757b-334">DBPROP_CANSRCOLLBACKWARDS</span></span>|-|-|-|  
|<span data-ttu-id="8757b-335">DBPROP_CANHOLDROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-335">DBPROP_CANHOLDROWS</span></span>|<span data-ttu-id="8757b-336">F</span><span class="sxs-lookup"><span data-stu-id="8757b-336">F</span></span>|-|<span data-ttu-id="8757b-337">F</span><span class="sxs-lookup"><span data-stu-id="8757b-337">F</span></span>|  
|<span data-ttu-id="8757b-338">DBPROP_LITERALBOOKMARKS</span><span class="sxs-lookup"><span data-stu-id="8757b-338">DBPROP_LITERALBOOKMARKS</span></span>|<span data-ttu-id="8757b-339">F</span><span class="sxs-lookup"><span data-stu-id="8757b-339">F</span></span>|-|<span data-ttu-id="8757b-340">F</span><span class="sxs-lookup"><span data-stu-id="8757b-340">F</span></span>|  
|<span data-ttu-id="8757b-341">DBPROP_OTHERINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-341">DBPROP_OTHERINSERT</span></span>|<span data-ttu-id="8757b-342">T</span><span class="sxs-lookup"><span data-stu-id="8757b-342">T</span></span>|<span data-ttu-id="8757b-343">F</span><span class="sxs-lookup"><span data-stu-id="8757b-343">F</span></span>|<span data-ttu-id="8757b-344">T</span><span class="sxs-lookup"><span data-stu-id="8757b-344">T</span></span>|  
|<span data-ttu-id="8757b-345">DBPROP_OTHERUPDATEDELETE</span><span class="sxs-lookup"><span data-stu-id="8757b-345">DBPROP_OTHERUPDATEDELETE</span></span>|<span data-ttu-id="8757b-346">T</span><span class="sxs-lookup"><span data-stu-id="8757b-346">T</span></span>|<span data-ttu-id="8757b-347">T</span><span class="sxs-lookup"><span data-stu-id="8757b-347">T</span></span>|<span data-ttu-id="8757b-348">T</span><span class="sxs-lookup"><span data-stu-id="8757b-348">T</span></span>|  
|<span data-ttu-id="8757b-349">DBPROP_OWNINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-349">DBPROP_OWNINSERT</span></span>|<span data-ttu-id="8757b-350">T</span><span class="sxs-lookup"><span data-stu-id="8757b-350">T</span></span>|<span data-ttu-id="8757b-351">T</span><span class="sxs-lookup"><span data-stu-id="8757b-351">T</span></span>|<span data-ttu-id="8757b-352">T</span><span class="sxs-lookup"><span data-stu-id="8757b-352">T</span></span>|  
|<span data-ttu-id="8757b-353">DBPROP_OWNUPDATEDELETE</span><span class="sxs-lookup"><span data-stu-id="8757b-353">DBPROP_OWNUPDATEDELETE</span></span>|<span data-ttu-id="8757b-354">T</span><span class="sxs-lookup"><span data-stu-id="8757b-354">T</span></span>|<span data-ttu-id="8757b-355">T</span><span class="sxs-lookup"><span data-stu-id="8757b-355">T</span></span>|<span data-ttu-id="8757b-356">T</span><span class="sxs-lookup"><span data-stu-id="8757b-356">T</span></span>|  
|<span data-ttu-id="8757b-357">DBPROP_QUICKSTART</span><span class="sxs-lookup"><span data-stu-id="8757b-357">DBPROP_QUICKSTART</span></span>|-|-|-|  
|<span data-ttu-id="8757b-358">DBPROP_REMOVEDELETED</span><span class="sxs-lookup"><span data-stu-id="8757b-358">DBPROP_REMOVEDELETED</span></span>|<span data-ttu-id="8757b-359">T</span><span class="sxs-lookup"><span data-stu-id="8757b-359">T</span></span>|-|<span data-ttu-id="8757b-360">T</span><span class="sxs-lookup"><span data-stu-id="8757b-360">T</span></span>|  
|<span data-ttu-id="8757b-361">DBPROP_IrowsetResynch</span><span class="sxs-lookup"><span data-stu-id="8757b-361">DBPROP_IrowsetResynch</span></span>|-|-|-|  
|<span data-ttu-id="8757b-362">DBPROP_CHANGEINSERTEDROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-362">DBPROP_CHANGEINSERTEDROWS</span></span>|<span data-ttu-id="8757b-363">F</span><span class="sxs-lookup"><span data-stu-id="8757b-363">F</span></span>|-|<span data-ttu-id="8757b-364">F</span><span class="sxs-lookup"><span data-stu-id="8757b-364">F</span></span>|  
|<span data-ttu-id="8757b-365">DBPROP_SERVERDATAONINSERT</span><span class="sxs-lookup"><span data-stu-id="8757b-365">DBPROP_SERVERDATAONINSERT</span></span>|<span data-ttu-id="8757b-366">F</span><span class="sxs-lookup"><span data-stu-id="8757b-366">F</span></span>|-|<span data-ttu-id="8757b-367">F</span><span class="sxs-lookup"><span data-stu-id="8757b-367">F</span></span>|  
|<span data-ttu-id="8757b-368">DBPROP_UNIQUEROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-368">DBPROP_UNIQUEROWS</span></span>|<span data-ttu-id="8757b-369">F</span><span class="sxs-lookup"><span data-stu-id="8757b-369">F</span></span>|<span data-ttu-id="8757b-370">F</span><span class="sxs-lookup"><span data-stu-id="8757b-370">F</span></span>|<span data-ttu-id="8757b-371">F</span><span class="sxs-lookup"><span data-stu-id="8757b-371">F</span></span>|  
|<span data-ttu-id="8757b-372">DBPROP_IMMOBILEROWS</span><span class="sxs-lookup"><span data-stu-id="8757b-372">DBPROP_IMMOBILEROWS</span></span>|<span data-ttu-id="8757b-373">F</span><span class="sxs-lookup"><span data-stu-id="8757b-373">F</span></span>|<span data-ttu-id="8757b-374">T</span><span class="sxs-lookup"><span data-stu-id="8757b-374">T</span></span>|<span data-ttu-id="8757b-375">F</span><span class="sxs-lookup"><span data-stu-id="8757b-375">F</span></span>|  
  
 <span data-ttu-id="8757b-376">对于一组特定的行集属性，将按如下方式确定选择的游标模型。</span><span class="sxs-lookup"><span data-stu-id="8757b-376">For a particular set of rowset properties, the cursor model that is selected is determined as follows.</span></span>  
  
 <span data-ttu-id="8757b-377">从这组指定的行集属性，获得在以前的表中列出的属性的子集。</span><span class="sxs-lookup"><span data-stu-id="8757b-377">From the specified collection of rowset properties, obtain a subset of properties listed in the previous tables.</span></span> <span data-ttu-id="8757b-378">根据每个行集属性的必需（T、F）或可选 (-) 标志值，将这些属性划分到两个子组中。</span><span class="sxs-lookup"><span data-stu-id="8757b-378">Divide these properties into two subgroups depending on the flag value-required (T, F) or optional (-)-of each rowset property.</span></span> <span data-ttu-id="8757b-379">对于每个游标模型，从第一个表开始，并从左向右移动，将两个子组中属性的值与相应列中相应属性的值进行比较。</span><span class="sxs-lookup"><span data-stu-id="8757b-379">For each cursor model, start in the first table and move from left to right., Compare the values of the properties in the two subgroups with the values of the corresponding properties in that column.</span></span> <span data-ttu-id="8757b-380">将选择与必需的属性完全匹配以及与可选的属性有最少不匹配数的游标模型。</span><span class="sxs-lookup"><span data-stu-id="8757b-380">The cursor model that has no mismatch with the required properties and the least number of mismatches with the optional properties is selected.</span></span> <span data-ttu-id="8757b-381">如果有多个游标模型，则选择最左侧的游标模型。</span><span class="sxs-lookup"><span data-stu-id="8757b-381">If there is more than one cursor model, the leftmost is chosen.</span></span>  
  
## <a name="sql-server-cursor-block-size"></a><span data-ttu-id="8757b-382">SQL Server 游标块大小</span><span class="sxs-lookup"><span data-stu-id="8757b-382">SQL Server Cursor Block Size</span></span>  
 <span data-ttu-id="8757b-383">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 游标支持 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 本机客户端 OLE DB 提供程序行集时， **IRowset：： GetNextRows**或**IRowsetLocate：： GetRowsAt**方法的行句柄数组参数中的元素数目将定义游标块大小。</span><span class="sxs-lookup"><span data-stu-id="8757b-383">When a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursor supports a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset, the number of elements in the row handle array parameter of the **IRowset::GetNextRows** or the **IRowsetLocate::GetRowsAt** methods defines the cursor block size.</span></span> <span data-ttu-id="8757b-384">该数组中的控点指示的行是游标块的成员。</span><span class="sxs-lookup"><span data-stu-id="8757b-384">The rows indicated by the handles in the array are the members of the cursor block.</span></span>  
  
 <span data-ttu-id="8757b-385">对于支持书签的行集，游标块的成员由通过 IRowsetLocate::GetRowsByBookmark 方法检索到的行控点进行定义\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="8757b-385">For rowsets supporting bookmarks, the row handles retrieved by using the **IRowsetLocate::GetRowsByBookmark** method define the members of the cursor block.</span></span>  
  
 <span data-ttu-id="8757b-386">不管使用什么方法填充行集和形成 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 游标块，游标块都会处于活动状态，直至对行集执行下一个行提取方法。</span><span class="sxs-lookup"><span data-stu-id="8757b-386">Regardless of the method used to populate the rowset and form the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursor block, the cursor block is active until the next row-fetching method is executed on the rowset.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8757b-387">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8757b-387">See Also</span></span>  
 [<span data-ttu-id="8757b-388">行集</span><span class="sxs-lookup"><span data-stu-id="8757b-388">Rowsets</span></span>](rowsets.md)  
  
  
