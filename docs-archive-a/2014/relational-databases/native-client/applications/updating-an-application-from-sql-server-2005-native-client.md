---
title: 从 SQL Server 2005 Native Client 更新应用程序 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, updating applications
ms.assetid: 1e1e570c-7f14-4e16-beab-c328e3fbdaa8
author: rothja
ms.author: jroth
ms.openlocfilehash: 6db02837b854d237607eba7583d204a4860906b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692358"
---
# <a name="updating-an-application-from-sql-server-2005-native-client"></a><span data-ttu-id="dae28-102">从 SQL Server 2005 Native Client 更新应用程序</span><span class="sxs-lookup"><span data-stu-id="dae28-102">Updating an Application from SQL Server 2005 Native Client</span></span>
  <span data-ttu-id="dae28-103">本主题介绍自 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 以来在 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Native Client 中的重大更改。</span><span class="sxs-lookup"><span data-stu-id="dae28-103">This topic discusses the breaking changes in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client since [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="dae28-104">从 Microsoft 数据访问组件 (MDAC) 升级到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 时，也会看到一些行为差异。</span><span class="sxs-lookup"><span data-stu-id="dae28-104">When you upgrade from Microsoft Data Access Components (MDAC) to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, you might also see some behavior differences.</span></span> <span data-ttu-id="dae28-105">有关详细信息，请参阅[将应用程序更新为从 MDAC SQL Server Native Client](updating-an-application-to-sql-server-native-client-from-mdac.md)。</span><span class="sxs-lookup"><span data-stu-id="dae28-105">For more information, see [Updating an Application to SQL Server Native Client from MDAC](updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-106">Native Client 9.0 随 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 附带。</span><span class="sxs-lookup"><span data-stu-id="dae28-106">Native Client 9.0 shipped with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-107">Native Client 10.0 随 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 附带。</span><span class="sxs-lookup"><span data-stu-id="dae28-107">Native Client 10.0 shipped with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-108">Native Client 10.5 随 [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] 附带。</span><span class="sxs-lookup"><span data-stu-id="dae28-108">Native Client 10.5 shipped with [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-109">Native Client 11.0 随 [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] 和 [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)] 附带。</span><span class="sxs-lookup"><span data-stu-id="dae28-109">Native Client 11.0 shipped with [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] and [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)].</span></span>  
  
|<span data-ttu-id="dae28-110">自 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 以来 SQL Server Native Client 中已更改的行为</span><span class="sxs-lookup"><span data-stu-id="dae28-110">Changed behavior in SQL Server Native Client Since [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]</span></span>|<span data-ttu-id="dae28-111">说明</span><span class="sxs-lookup"><span data-stu-id="dae28-111">Description</span></span>|  
|------------------------------------------------------------------------------------|-----------------|  
|<span data-ttu-id="dae28-112">OLE DB 仅填充到定义的小数位数。</span><span class="sxs-lookup"><span data-stu-id="dae28-112">OLE DB pads only to the defined scale.</span></span>|<span data-ttu-id="dae28-113">对于要将转换的数据发送到服务器的转换操作，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client（从 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 开始）在填充数据中的尾随零时，最多仅填充到 `datetime` 值的最大长度。</span><span class="sxs-lookup"><span data-stu-id="dae28-113">For conversions where converted data is sent to the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) pads trailing zeros in data only up to the maximum length of `datetime` values.</span></span> <span data-ttu-id="dae28-114">SQL Server Native Client 9.0 则填充到 9 位数。</span><span class="sxs-lookup"><span data-stu-id="dae28-114">SQL Server Native Client 9.0 padded to 9 digits.</span></span>|  
|<span data-ttu-id="dae28-115">验证 ICommandWithParameter::SetParameterInfo 的 DBTYPE_DBTIMESTAMP。</span><span class="sxs-lookup"><span data-stu-id="dae28-115">Validate DBTYPE_DBTIMESTAMP for ICommandWithParameter::SetParameterInfo.</span></span>|[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="dae28-116">本机客户端 (从 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) 中开始实现对 ICommandWithParameter：： SetParameterInfo 中的*bScale*的 OLE DB 要求，将设置为 DBTYPE_DBTIMESTAMP 的秒小数部分。</span><span class="sxs-lookup"><span data-stu-id="dae28-116">Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) implements the OLE DB requirement for *bScale* in ICommandWithParameter::SetParameterInfo to be set to the fractional seconds' precision for DBTYPE_DBTIMESTAMP.</span></span>|  
|<span data-ttu-id="dae28-117">`sp_columns`对于 IS_NULLABLE 列，该存储过程将返回 **"no"** 而不是 **"no** "。</span><span class="sxs-lookup"><span data-stu-id="dae28-117">The `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for the IS_NULLABLE column.</span></span>|<span data-ttu-id="dae28-118">从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 开始 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) ， `sp_columns` 存储过程现在为 IS_NULLABLE 列返回 **"no"** ，而不是 **"no"** 。</span><span class="sxs-lookup"><span data-stu-id="dae28-118">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]), `sp_columns` stored procedure now returns **"NO"** instead of **"NO "** for an IS_NULLABLE column.</span></span>|  
|<span data-ttu-id="dae28-119">SQLSetDescRec、SQLBindParameter 和 SQLBindCol 现在会执行一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-119">SQLSetDescRec, SQLBindParameter, and SQLBindCol now perform consistency checking.</span></span>|<span data-ttu-id="dae28-120">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]在 Native Client 10.0 之前，设置 SQL_DESC_DATA_PTR 不会对 SQLSetDescRec、SQLBindParameter 或 SQLBindCol 中的任何描述符类型进行一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-120">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, setting SQL_DESC_DATA_PTR did not cause a consistency check for any descriptor type in SQLSetDescRec, SQLBindParameter, or SQLBindCol.</span></span>|  
|<span data-ttu-id="dae28-121">SQLCopyDesc 现在执行描述符一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-121">SQLCopyDesc now does descriptor consistency checking.</span></span>|<span data-ttu-id="dae28-122">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 之前，当对特定记录设置 SQL_DESC_DATA_PTR 字段时，SQLCopyDesc 不执行一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-122">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLCopyDesc did not do a consistency check when the SQL_DESC_DATA_PTR field was set on a particular record.</span></span>|  
|<span data-ttu-id="dae28-123">SQLGetDescRec 不再执行描述符一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-123">SQLGetDescRec no longer does a descriptor consistency check.</span></span>|<span data-ttu-id="dae28-124">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 之前，在设置 SQL_DESC_DATA_PTR 字段时，SQLGetDescRec 执行了描述符一致性检查。</span><span class="sxs-lookup"><span data-stu-id="dae28-124">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, SQLGetDescRec performed a descriptor consistency check when the SQL_DESC_DATA_PTR field was set.</span></span> <span data-ttu-id="dae28-125">这不是 ODBC 规范和 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) 以及更高版本所要求的，该一致性检查不再执行。</span><span class="sxs-lookup"><span data-stu-id="dae28-125">This was not required by the ODBC specification and in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) and later versions, this consistency check is no longer performed.</span></span>|  
|<span data-ttu-id="dae28-126">日期超出范围时返回其他错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-126">Different error returned when date is out of range.</span></span>|<span data-ttu-id="dae28-127">对于 `datetime` 类型，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client（从 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 开始）将对超出范围的日期返回与更早版本返回错误号不同的错误号。</span><span class="sxs-lookup"><span data-stu-id="dae28-127">For the `datetime` type, a different error number will be returned by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (beginning in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) for an out-of-range date than was returned in earlier versions.</span></span><br /><br /> <span data-ttu-id="dae28-128">具体来说，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 对字符串转换到 `datetime` 时所有超出范围的年份值均返回 22007；而从版本 10.0 ([!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) 开始的 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client 则在日期处于 `datetime2` 支持的范围但不处于 `datetime` 或 `smalldatetime` 支持的范围时返回 22008。</span><span class="sxs-lookup"><span data-stu-id="dae28-128">Specifically, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 returned 22007 for all out of range year values in string conversions to `datetime`, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client beginning with version 10.0 ([!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)]) returns 22008 when the date is within the range supported by `datetime2` but outside the range supported by `datetime` or `smalldatetime`.</span></span>|  
|<span data-ttu-id="dae28-129">如果舍入将更改日期，则 `datetime` 值将截断秒的小数部分，并且不舍入。</span><span class="sxs-lookup"><span data-stu-id="dae28-129">`datetime` value truncates fractional seconds and not round if rounding will change the day.</span></span>|<span data-ttu-id="dae28-130">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 之前，对于发送到服务器的 `datetime` 值的客户端行为是将它们舍入到最接近 1/300 秒的值。</span><span class="sxs-lookup"><span data-stu-id="dae28-130">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the client behavior for `datetime` values sent to the server is to round them to nearest 1/300th of a second.</span></span> <span data-ttu-id="dae28-131">从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 开始，如果舍入会更改日期，则该方案会导致截断秒的小数部分。</span><span class="sxs-lookup"><span data-stu-id="dae28-131">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, this scenario causes a truncation of fractional seconds if rounding changes the day.</span></span>|  
|<span data-ttu-id="dae28-132">值的可能的且 `datetime` 。</span><span class="sxs-lookup"><span data-stu-id="dae28-132">Possible trunction of seconds for `datetime` value.</span></span>|<span data-ttu-id="dae28-133">如果您绑定到某一 datetime 列并且其类型标识符为 DBTYPE_DBTIMESTAMP (OLE DB) 或 SQL_TIMESTAMP (ODBC)、小数位数为 0，则使用连接到 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 2005 服务器的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client（或更高版本）生成的应用程序将截断要发送到服务器的时间部分中的秒和秒的小数部分。</span><span class="sxs-lookup"><span data-stu-id="dae28-133">An application built with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client (or later) that connects to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 2005 server will truncate seconds and fractional seconds for time portion of data sent to the server if you bind to a datetime column with a type identifier of DBTYPE_DBTIMESTAMP (OLE DB) or SQL_TIMESTAMP (ODBC) and a scale of 0.</span></span><br /><br /> <span data-ttu-id="dae28-134">例如：</span><span class="sxs-lookup"><span data-stu-id="dae28-134">For example:</span></span><br /><br /> <span data-ttu-id="dae28-135">输入数据：1994-08-21 21:21:36.000</span><span class="sxs-lookup"><span data-stu-id="dae28-135">Input data: 1994-08-21 21:21:36.000</span></span><br /><br /> <span data-ttu-id="dae28-136">插入的数据：1994-08-21 21:21:00.000</span><span class="sxs-lookup"><span data-stu-id="dae28-136">Inserted data: 1994-08-21 21:21:00.000</span></span>|  
|<span data-ttu-id="dae28-137">从 DBTYPE_DBTIME 到 DBTYPE_DATE 的 OLE DB 数据转换不会再导致日期发生更改。</span><span class="sxs-lookup"><span data-stu-id="dae28-137">OLE DB data conversion from DBTYPE_DBTIME to DBTYPE_DATE no longer can cause the day to change.</span></span>|<span data-ttu-id="dae28-138">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 之前，如果 DBTYPE_DATE 的时间部分是在距离午夜的半秒内，则 OLE DB 转换代码将导致日期发生更改。</span><span class="sxs-lookup"><span data-stu-id="dae28-138">Prior to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, if the time part of a DBTYPE_DATE was within a half second of midnight, OLE DB conversion code caused the day to change.</span></span> <span data-ttu-id="dae28-139">从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 开始，日期不会更改（秒的小数部分将截断但不舍入）。</span><span class="sxs-lookup"><span data-stu-id="dae28-139">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, the day will not change (fractional seconds are truncated and not rounded).</span></span>|  
|<span data-ttu-id="dae28-140">IBCPSession::BCColFmt 转换更改。</span><span class="sxs-lookup"><span data-stu-id="dae28-140">IBCPSession::BCColFmt conversion changes.</span></span>|<span data-ttu-id="dae28-141">从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0 开始，当你使用 IBCPSession：： BCOColFmt 将 SQLDATETIME 或 SQLDATETIME 转换为字符串类型时，将导出小数值。</span><span class="sxs-lookup"><span data-stu-id="dae28-141">Beginning in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 10.0, when you use IBCPSession::BCOColFmt to convert SQLDATETIME or SQLDATETIME to a string type, a fractional value is exported.</span></span> <span data-ttu-id="dae28-142">例如，将类型 SQLDATETIME 转换为类型 SQLNVARCHARMAX 时，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 的更早版本返回</span><span class="sxs-lookup"><span data-stu-id="dae28-142">For example, when converting type SQLDATETIME to type SQLNVARCHARMAX, earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client returned</span></span><br /><br /> <span data-ttu-id="dae28-143">1989-02-01 00:00:00。</span><span class="sxs-lookup"><span data-stu-id="dae28-143">1989-02-01 00:00:00.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-144">Native Client 10.0 及更高版本返回 1989-02-01 00:00:00.0000000。</span><span class="sxs-lookup"><span data-stu-id="dae28-144">Native Client 10.0 and later versions return 1989-02-01 00:00:00.0000000.</span></span>|  
|<span data-ttu-id="dae28-145">发送的数据的大小必须与 SQL_LEN_DATA_AT_EXEC 中指定的长度匹配。</span><span class="sxs-lookup"><span data-stu-id="dae28-145">Size of data sent must match length specified in SQL_LEN_DATA_AT_EXEC.</span></span>|<span data-ttu-id="dae28-146">使用 SQL_LEN_DATA_AT_EXEC 时，数据的大小必须与用 SQL_LEN_DATA_AT_EXEC 指定的长度匹配。</span><span class="sxs-lookup"><span data-stu-id="dae28-146">When using SQL_LEN_DATA_AT_EXEC, the size of the data must match the length that you specified with SQL_LEN_DATA_AT_EXEC.</span></span> <span data-ttu-id="dae28-147">可以使用 SQL_DATA_AT_EXEC，但使用 SQL_LEN_DATA_AT_EXEC 有潜在的性能好处。</span><span class="sxs-lookup"><span data-stu-id="dae28-147">You can use SQL_DATA_AT_EXEC but there are potential performance benefits to using SQL_LEN_DATA_AT_EXEC.</span></span>|  
|<span data-ttu-id="dae28-148">使用 BCP API 的自定义应用程序现在可以看到警告。</span><span class="sxs-lookup"><span data-stu-id="dae28-148">Custom applications that use the BCP API can now see a warning.</span></span>|<span data-ttu-id="dae28-149">对于所有类型，如果数据长度超过某字段的指定长度，则 BCP API 将生成警告消息。</span><span class="sxs-lookup"><span data-stu-id="dae28-149">The BCP API will generate a warning message if data length is greater than the specified length for a field for all types.</span></span> <span data-ttu-id="dae28-150">以前，该警告仅针对字符类型，而不会针对所有类型发出。</span><span class="sxs-lookup"><span data-stu-id="dae28-150">Previously, this warning was only given for character types, but will not be issued for all types.</span></span>|  
|<span data-ttu-id="dae28-151">将空字符串插入到绑定为日期/时间类型的 `sql_variant` 中会生成错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-151">Inserting an empty string into a `sql_variant` bound as a date/time type generates an error.</span></span>|<span data-ttu-id="dae28-152">在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0 中，将空字符串插入到绑定为日期/时间类型的 `sql_variant` 中不会生成错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-152">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 9.0, inserting an empty string into a `sql_variant` bound as a date/time type did not generate an error.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="dae28-153">Native Client 10.0（和更高版本）在这种情况下则会正确地生成错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-153">Native Client 10.0 (and later) correctly generates an error in this situation.</span></span>|  
|<span data-ttu-id="dae28-154">更严格的 SQL_C_TYPE _TIMESTAMP 和 DBTYPE_DBTIMESTAMP 参数验证。</span><span class="sxs-lookup"><span data-stu-id="dae28-154">Stricter SQL_C_TYPE _TIMESTAMP and DBTYPE_DBTIMESTAMP parameter validation.</span></span>|<span data-ttu-id="dae28-155">在 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client 之前，将 `datetime` 对值进行舍入，以适合和列的小数位数 `datetime` `smalldatetime` [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="dae28-155">Prior to [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] Native Client, `datetime` values were rounded to fit the scale of `datetime` and `smalldatetime` columns by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] <span data-ttu-id="dae28-156">Native Client（和更高版本）现在应用在 ODBC 核心规范中为秒的小数部分定义的更严格的验证规则。</span><span class="sxs-lookup"><span data-stu-id="dae28-156">Native Client (and later) applies the stricter validation rules that are defined in the ODBC core specification for fractional seconds.</span></span> <span data-ttu-id="dae28-157">如果无法通过使用由客户端绑定所指定或暗含的小数位数在不截断尾随数字的情况下将参数值转换到 SQL 类型，则返回错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-157">If a parameter value cannot be converted to the SQL type by using the scale specified or implied by the client binding without truncation of trailing digits, an error is returned.</span></span>|  
|<span data-ttu-id="dae28-158">当有触发器运行时，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 可能会返回不同的结果。</span><span class="sxs-lookup"><span data-stu-id="dae28-158">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] might return different results when a trigger runs.</span></span>|<span data-ttu-id="dae28-159">[!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 中引入的变化可能会导致应用程序得到从 `NOCOUNT OFF` 有效时导致触发器运行的语句返回的不同的结果。</span><span class="sxs-lookup"><span data-stu-id="dae28-159">Changes introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] might cause an application to have different results returned from a statement that caused a trigger to run when `NOCOUNT OFF` was in effect.</span></span> <span data-ttu-id="dae28-160">在这种情况下，您的应用程序可能会生成错误。</span><span class="sxs-lookup"><span data-stu-id="dae28-160">In this situation, your application might generate an error.</span></span> <span data-ttu-id="dae28-161">若要解决此错误，请 `NOCOUNT ON` 在触发器中设置，或调用 SQLMoreResults 来前进到下一个结果。</span><span class="sxs-lookup"><span data-stu-id="dae28-161">To resolve this error, set `NOCOUNT ON` in the trigger or call SQLMoreResults to advance to the next result.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="dae28-162">另请参阅</span><span class="sxs-lookup"><span data-stu-id="dae28-162">See Also</span></span>  
 [<span data-ttu-id="dae28-163">SQL Server Native Client 编程</span><span class="sxs-lookup"><span data-stu-id="dae28-163">SQL Server Native Client Programming</span></span>](../sql-server-native-client-programming.md)  
  
  
