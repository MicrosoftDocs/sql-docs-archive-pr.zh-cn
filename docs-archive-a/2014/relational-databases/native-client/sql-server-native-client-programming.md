---
title: SQL Server Native Client 编程 |Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQLNCLI, about SQL Server Native Client
- SQL Server Native Client, about SQL Server Native Client
- data access [SQL Server Native Client], about SQL Server Native Client
- data access [SQL Server Native Client]
- SQL Server Native Client
- SQLNCLI
- native data access [SQL Server Native Client]
ms.assetid: 14ba2cb1-a424-4e4d-b224-0bf1015ab801
author: rothja
ms.author: jroth
ms.openlocfilehash: 6157553c05c49382af72bb4d7209fb98d1f29e20
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591319"
---
# <a name="sql-server-native-client-programming"></a><span data-ttu-id="e7d64-102">SQL Server Native Client 编程</span><span class="sxs-lookup"><span data-stu-id="e7d64-102">SQL Server Native Client Programming</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e7d64-103">Native Client 是在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 中引入的用于 OLE DB 和 ODBC 的独立数据访问应用程序编程接口 (API)。</span><span class="sxs-lookup"><span data-stu-id="e7d64-103">Native Client is a stand-alone data access application programming interface (API), used for both OLE DB and ODBC, that was introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e7d64-104">Native Client 将 SQL OLE DB 访问接口和 SQL ODBC 驱动程序组合成一个本机动态链接库 (DLL)。</span><span class="sxs-lookup"><span data-stu-id="e7d64-104">Native Client combines the SQL OLE DB provider and the SQL ODBC driver into one native dynamic-link library (DLL).</span></span> <span data-ttu-id="e7d64-105">除 Windows 数据访问组件（Windows DAC，以前为 Microsoft 数据访问组件或 MDAC）提供的功能之外，它还提供新的功能。</span><span class="sxs-lookup"><span data-stu-id="e7d64-105">It also provides new functionality above and beyond that supplied by the Windows Data Access Components (Windows DAC, formerly Microsoft Data Access Components, or MDAC).</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e7d64-106">Native Client 可用于创建新应用程序或增强现有应用程序，使这些应用程序能够利用在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 中引入的功能，例如多个活动结果集 (MARS)、用户定义数据类型 (UDT)、查询通知、快照隔离和 XML 数据类型支持。</span><span class="sxs-lookup"><span data-stu-id="e7d64-106">Native Client can be used to create new applications or enhance existing applications that need to take advantage of features introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], such as multiple active result sets (MARS), user-defined data types (UDT), query notifications, snapshot isolation, and XML data type support.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e7d64-107">有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native client 和 WINDOWS dac 之间的差异列表，以及有关将 WINDOWS DAC 应用程序更新到 Native Client 之前要考虑的问题的信息 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，请参阅将[应用程序更新为从 MDAC SQL Server Native Client](applications/updating-an-application-to-sql-server-native-client-from-mdac.md)。</span><span class="sxs-lookup"><span data-stu-id="e7d64-107">For a list of the differences between [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client and Windows DAC, plus information about issues to consider before updating a Windows DAC application to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, see [Updating an Application to SQL Server Native Client from MDAC](applications/updating-an-application-to-sql-server-native-client-from-mdac.md).</span></span>  
  
 <span data-ttu-id="e7d64-108">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序始终与 Windows DAC 提供的 ODBC 驱动程序管理器一起使用。</span><span class="sxs-lookup"><span data-stu-id="e7d64-108">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver is always used in conjunction with the ODBC Driver Manager supplied with Windows DAC.</span></span> <span data-ttu-id="e7d64-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口可与 Windows DAC 提供的 OLE DB 核心服务一起使用，但这不是必要条件；是否选择使用核心服务取决于单个应用程序的要求（例如，是否必需连接池）。</span><span class="sxs-lookup"><span data-stu-id="e7d64-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider can be used in conjunction with OLE DB Core Services supplied with Windows DAC, but this is not a requirement; the choice to use Core Services or not depends on the requirements of the individual application (for example, if connection pooling is required).</span></span>  
  
 <span data-ttu-id="e7d64-110">ActiveX 数据对象 (ADO) 应用程序可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口，但建议不要将 ADO 与 `DataTypeCompatibility` 连接字符串关键字（或其对应的 `DataSource` 属性）一起使用。</span><span class="sxs-lookup"><span data-stu-id="e7d64-110">ActiveX Data Object (ADO) applications may use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider, but it is recommended to use ADO in conjunction with the `DataTypeCompatibility` connection string keyword (or its corresponding `DataSource` property).</span></span> <span data-ttu-id="e7d64-111">使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口时，ADO 应用程序可以通过连接字符串关键字、OLE DB 属性或 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 利用在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中引入的通过 [!INCLUDE[tsql](../../includes/tsql-md.md)] Native Client 提供的那些新功能。</span><span class="sxs-lookup"><span data-stu-id="e7d64-111">When using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider, ADO applications may exploit those new features introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that are available via the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client via connection string keywords or OLE DB properties or [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span> <span data-ttu-id="e7d64-112">有关使用这些功能和 ADO 的详细信息，请参阅[使用 ado 和 SQL Server Native Client](applications/using-ado-with-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="e7d64-112">For more information about the use of these features with ADO, see [Using ADO with SQL Server Native Client](applications/using-ado-with-sql-server-native-client.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e7d64-113">Native Client 旨在提供一种使用 OLE DB 或 ODBC 获取对 SQL Server 的本机数据访问的简化方法。</span><span class="sxs-lookup"><span data-stu-id="e7d64-113">Native Client was designed to provide a simplified method of gaining native data access to SQL Server using either OLE DB or ODBC.</span></span> <span data-ttu-id="e7d64-114">简化之处在于它将 OLE DB 和 ODBC 技术组合到一个库中，并且它提供一种创新和开发新的数据访问功能而不更改当前 Windows DAC 组件（现在是 Microsoft Windows 平台的一部分）的方法。</span><span class="sxs-lookup"><span data-stu-id="e7d64-114">It is simplified in that it combines OLE DB and ODBC technologies into one library, and it provides a way to innovate and evolve new data access features without changing the current Windows DAC components, which are now part of the Microsoft Windows platform.</span></span>  
  
 <span data-ttu-id="e7d64-115">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 使用 WINDOWS dac 中的组件时，它不会显式依赖于特定版本的 WINDOWS dac。</span><span class="sxs-lookup"><span data-stu-id="e7d64-115">While [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client uses components in Windows DAC, it is not explicitly dependent on a particular version of Windows DAC.</span></span> <span data-ttu-id="e7d64-116">可以将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 与随 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 支持的任一操作系统安装的 Windows DAC 版本一起使用。</span><span class="sxs-lookup"><span data-stu-id="e7d64-116">You can use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client with the version of Windows DAC that is installed with any operating system supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="e7d64-117">本节内容</span><span class="sxs-lookup"><span data-stu-id="e7d64-117">In This Section</span></span>  
 [<span data-ttu-id="e7d64-118">SQL Server Native Client 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="e7d64-118">What's New in SQL Server Native Client</span></span>](sql-server-native-client.md)  
 <span data-ttu-id="e7d64-119">列出重大的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 新功能。</span><span class="sxs-lookup"><span data-stu-id="e7d64-119">Lists the significant new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client features.</span></span>  
  
 [<span data-ttu-id="e7d64-120">何时使用 SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="e7d64-120">When to Use SQL Server Native Client</span></span>](when-to-use-sql-server-native-client.md)  
 <span data-ttu-id="e7d64-121">讨论 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 如何适应 Microsoft 数据访问技术，它如何与 WINDOWS DAC 和 ADO.NET 进行比较，并提供用于决定要使用的数据访问技术的指针。</span><span class="sxs-lookup"><span data-stu-id="e7d64-121">Discusses how [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client fits in with Microsoft data access technologies, how it compares to Windows DAC and ADO.NET, and provides pointers for deciding which data access technology to use.</span></span>  
  
 [<span data-ttu-id="e7d64-122">SQL Server Native Client 功能</span><span class="sxs-lookup"><span data-stu-id="e7d64-122">SQL Server Native Client Features</span></span>](features/sql-server-native-client-features.md)  
 <span data-ttu-id="e7d64-123">介绍 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 支持的功能。</span><span class="sxs-lookup"><span data-stu-id="e7d64-123">Describes the features supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
 [<span data-ttu-id="e7d64-124">使用 SQL Server Native Client 生成应用程序</span><span class="sxs-lookup"><span data-stu-id="e7d64-124">Building Applications with SQL Server Native Client</span></span>](applications/building-applications-with-sql-server-native-client.md)  
 <span data-ttu-id="e7d64-125">提供 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 开发概述，包括它与 Windows DAC 的不同之处、它使用的组件，以及如何将 ADO 与它一起使用。</span><span class="sxs-lookup"><span data-stu-id="e7d64-125">Provides an overview of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client development, including how it differs from Windows DAC, the components that it uses, and how ADO can be used with it.</span></span>  
  
 <span data-ttu-id="e7d64-126">本节还讨论 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的安装和部署，包括如何再分发 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 库。</span><span class="sxs-lookup"><span data-stu-id="e7d64-126">This section also discusses [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client installation and deployment, including how to redistribute the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client library.</span></span>  
  
 [<span data-ttu-id="e7d64-127">SQL Server Native Client 的系统要求</span><span class="sxs-lookup"><span data-stu-id="e7d64-127">System Requirements for SQL Server Native Client</span></span>](system-requirements-for-sql-server-native-client.md)  
 <span data-ttu-id="e7d64-128">讨论使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 所需的系统资源。</span><span class="sxs-lookup"><span data-stu-id="e7d64-128">Discusses the system resources needed to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
 [<span data-ttu-id="e7d64-129">SQL Server Native Client (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="e7d64-129">SQL Server Native Client &#40;OLE DB&#41;</span></span>](ole-db/sql-server-native-client-ole-db.md)  
 <span data-ttu-id="e7d64-130">提供有关使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口的信息。</span><span class="sxs-lookup"><span data-stu-id="e7d64-130">Provides information about using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
 [<span data-ttu-id="e7d64-131">SQL Server Native Client (ODBC)</span><span class="sxs-lookup"><span data-stu-id="e7d64-131">SQL Server Native Client &#40;ODBC&#41;</span></span>](odbc/sql-server-native-client-odbc.md)  
 <span data-ttu-id="e7d64-132">提供有关使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序的信息。</span><span class="sxs-lookup"><span data-stu-id="e7d64-132">Provides information about using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span>  
  
 [<span data-ttu-id="e7d64-133">查找更多 SQL Server Native Client 信息</span><span class="sxs-lookup"><span data-stu-id="e7d64-133">Finding More SQL Server Native Client Information</span></span>](finding-more-sql-server-native-client-information.md)  
 <span data-ttu-id="e7d64-134">提供有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的其他资源，包括指向外部资源和获取进一步帮助的链接。</span><span class="sxs-lookup"><span data-stu-id="e7d64-134">Provides additional resources about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, including links to external resources and getting further assistance.</span></span>  
  
 [<span data-ttu-id="e7d64-135">SQL Server Native Client 错误</span><span class="sxs-lookup"><span data-stu-id="e7d64-135">SQL Server Native Client Errors</span></span>](../native-client-ole-db-errors/errors.md)  
 <span data-ttu-id="e7d64-136">包含有关与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 关联的运行时错误的主题。</span><span class="sxs-lookup"><span data-stu-id="e7d64-136">Contains topics about runtime errors associated with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e7d64-137">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e7d64-137">See Also</span></span>  
 <span data-ttu-id="e7d64-138">[从 SQL Server 2005 Native Client 更新应用程序](applications/updating-an-application-from-sql-server-2005-native-client.md) </span><span class="sxs-lookup"><span data-stu-id="e7d64-138">[Updating an Application from SQL Server 2005 Native Client](applications/updating-an-application-from-sql-server-2005-native-client.md) </span></span>  
 <span data-ttu-id="e7d64-139">[ODBC 操作指南主题](../native-client-odbc-how-to/odbc-how-to-topics.md) </span><span class="sxs-lookup"><span data-stu-id="e7d64-139">[ODBC How-to Topics](../native-client-odbc-how-to/odbc-how-to-topics.md) </span></span>  
 [<span data-ttu-id="e7d64-140">OLE DB 操作指南主题</span><span class="sxs-lookup"><span data-stu-id="e7d64-140">OLE DB How-to Topics</span></span>](../native-client-ole-db-how-to/ole-db-how-to-topics.md)  
  
  
