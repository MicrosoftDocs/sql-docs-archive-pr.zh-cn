---
title: 大型 CLR 用户定义类型 (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688868"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="123c0-102">大型 CLR 用户定义类型 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="123c0-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="123c0-103">本主题讨论 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 中为支持大型公共语言运行时 (CLR) 用户定义类型 (UDT) 而对 OLE DB 进行的更改。</span><span class="sxs-lookup"><span data-stu-id="123c0-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="123c0-104">有关 Native Client 中对大型 CLR Udt 的支持的详细信息 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，请参阅[大型 Clr 用户定义类型](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="123c0-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="123c0-105">有关示例，请参阅[使用大型 CLR UDT (OLE DB)](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md)。</span><span class="sxs-lookup"><span data-stu-id="123c0-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="123c0-106">数据格式</span><span class="sxs-lookup"><span data-stu-id="123c0-106">Data Format</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="123c0-107">Native Client 使用 ~0 表示其大小对于大型对象 (LOB) 类型不受限制的值的长度。</span><span class="sxs-lookup"><span data-stu-id="123c0-107">Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="123c0-108">~0 还表示大于 8,000 个字节的 CLR UDT 的大小。</span><span class="sxs-lookup"><span data-stu-id="123c0-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="123c0-109">下表显示了参数和行集中的数据类型映射：</span><span class="sxs-lookup"><span data-stu-id="123c0-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="123c0-110">SQL Server 数据类型</span><span class="sxs-lookup"><span data-stu-id="123c0-110">SQL Server data type</span></span>|<span data-ttu-id="123c0-111">OLE DB 数据类型</span><span class="sxs-lookup"><span data-stu-id="123c0-111">OLE DB data type</span></span>|<span data-ttu-id="123c0-112">内存布局</span><span class="sxs-lookup"><span data-stu-id="123c0-112">Memory layout</span></span>|<span data-ttu-id="123c0-113">值</span><span class="sxs-lookup"><span data-stu-id="123c0-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="123c0-114">CLR UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-114">CLR UDT</span></span>|<span data-ttu-id="123c0-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-115">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-116">BYTE[]（字节数组\)</span><span class="sxs-lookup"><span data-stu-id="123c0-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="123c0-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="123c0-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="123c0-118">UDT 值表示为字节数组。</span><span class="sxs-lookup"><span data-stu-id="123c0-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="123c0-119">支持与十六进制字符串之间的转换。</span><span class="sxs-lookup"><span data-stu-id="123c0-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="123c0-120">文字值表示为带有“0x”前缀的十六进制字符串。</span><span class="sxs-lookup"><span data-stu-id="123c0-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="123c0-121">十六进制字符串是以 16 为基数的二进制数据的文本表示形式。</span><span class="sxs-lookup"><span data-stu-id="123c0-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="123c0-122">一个例子便是从服务器类型 `varbinary(10)` 到 DBTYPE_STR 的转换，这会产生一个 20 个字符的十六进制表示形式，其中每对字符都表示一个字节。</span><span class="sxs-lookup"><span data-stu-id="123c0-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="123c0-123">参数属性</span><span class="sxs-lookup"><span data-stu-id="123c0-123">Parameter Properties</span></span>  
 <span data-ttu-id="123c0-124">DBPROPSET_SQLSERVERPARAMETER 属性集通过 OLE DB 支持 UDT。</span><span class="sxs-lookup"><span data-stu-id="123c0-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="123c0-125">有关详细信息，请参阅[使用用户定义类型](../features/using-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="123c0-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="123c0-126">列属性</span><span class="sxs-lookup"><span data-stu-id="123c0-126">Column Properties</span></span>  
 <span data-ttu-id="123c0-127">DBPROPSET_SQLSERVERCOLUMN 属性集通过 OLE DB 支持表的创建。</span><span class="sxs-lookup"><span data-stu-id="123c0-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="123c0-128">有关详细信息，请参阅[使用用户定义类型](../features/using-user-defined-types.md)。</span><span class="sxs-lookup"><span data-stu-id="123c0-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="123c0-129">ITableDefinition::CreateTable 中的数据类型映射</span><span class="sxs-lookup"><span data-stu-id="123c0-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="123c0-130">`DBCOLUMNDESC`当需要 UDT 列时，将在 ITableDefinition：： CreateTable 使用的结构中使用以下信息：</span><span class="sxs-lookup"><span data-stu-id="123c0-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="123c0-131">OLE DB 数据类型 (wType\*\*)</span><span class="sxs-lookup"><span data-stu-id="123c0-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="123c0-132">pwszTypeName\*\*</span><span class="sxs-lookup"><span data-stu-id="123c0-132">*pwszTypeName*</span></span>|<span data-ttu-id="123c0-133">SQL Server 数据类型</span><span class="sxs-lookup"><span data-stu-id="123c0-133">SQL Server data type</span></span>|<span data-ttu-id="123c0-134">rgPropertySets\*\*</span><span class="sxs-lookup"><span data-stu-id="123c0-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="123c0-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-135">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-136">忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-136">Ignored</span></span>|<span data-ttu-id="123c0-137">UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-137">UDT</span></span>|<span data-ttu-id="123c0-138">必须包括 DBPROPSET_SQLSERVERCOLUMN 属性集。</span><span class="sxs-lookup"><span data-stu-id="123c0-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="123c0-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="123c0-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="123c0-140">通过 prgParamInfo 在 DBPARAMINFO 结构中返回的信息如下所示\*\*\*\*：</span><span class="sxs-lookup"><span data-stu-id="123c0-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="123c0-141">参数类型</span><span class="sxs-lookup"><span data-stu-id="123c0-141">Parameter type</span></span>|<span data-ttu-id="123c0-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="123c0-142">*wType*</span></span>|<span data-ttu-id="123c0-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="123c0-143">*ulParamSize*</span></span>|<span data-ttu-id="123c0-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="123c0-144">*bPrecision*</span></span>|<span data-ttu-id="123c0-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="123c0-145">*bScale*</span></span>|<span data-ttu-id="123c0-146">dwFlags\*\* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="123c0-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="123c0-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-148">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="123c0-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="123c0-150">*n*</span><span class="sxs-lookup"><span data-stu-id="123c0-150">*n*</span></span>|<span data-ttu-id="123c0-151">undefined</span><span class="sxs-lookup"><span data-stu-id="123c0-151">undefined</span></span>|<span data-ttu-id="123c0-152">未定义</span><span class="sxs-lookup"><span data-stu-id="123c0-152">undefined</span></span>|<span data-ttu-id="123c0-153">clear</span><span class="sxs-lookup"><span data-stu-id="123c0-153">clear</span></span>|  
|<span data-ttu-id="123c0-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-155">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="123c0-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="123c0-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="123c0-157">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-157">~0</span></span>|<span data-ttu-id="123c0-158">undefined</span><span class="sxs-lookup"><span data-stu-id="123c0-158">undefined</span></span>|<span data-ttu-id="123c0-159">未定义</span><span class="sxs-lookup"><span data-stu-id="123c0-159">undefined</span></span>|<span data-ttu-id="123c0-160">set</span><span class="sxs-lookup"><span data-stu-id="123c0-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="123c0-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="123c0-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="123c0-162">在 DBPARAMBINDINFO 结构中提供的信息必须符合以下规定：</span><span class="sxs-lookup"><span data-stu-id="123c0-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="123c0-163">参数类型</span><span class="sxs-lookup"><span data-stu-id="123c0-163">Parameter type</span></span>|<span data-ttu-id="123c0-164">pwszDataSourceType\*\*</span><span class="sxs-lookup"><span data-stu-id="123c0-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="123c0-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="123c0-165">*ulParamSize*</span></span>|<span data-ttu-id="123c0-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="123c0-166">*bPrecision*</span></span>|<span data-ttu-id="123c0-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="123c0-167">*bScale*</span></span>|<span data-ttu-id="123c0-168">dwFlags\*\* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="123c0-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="123c0-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-170">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-171">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-172">*n*</span><span class="sxs-lookup"><span data-stu-id="123c0-172">*n*</span></span>|<span data-ttu-id="123c0-173">已忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-173">ignored</span></span>|<span data-ttu-id="123c0-174">已忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-174">ignored</span></span>|<span data-ttu-id="123c0-175">如果将使用 DBTYPE_IUNKNOWN 传递参数，则必须进行设置。</span><span class="sxs-lookup"><span data-stu-id="123c0-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="123c0-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-177">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="123c0-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-178">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-179">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-179">~0</span></span>|<span data-ttu-id="123c0-180">已忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-180">ignored</span></span>|<span data-ttu-id="123c0-181">已忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-181">ignored</span></span>|<span data-ttu-id="123c0-182">已忽略</span><span class="sxs-lookup"><span data-stu-id="123c0-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="123c0-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="123c0-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="123c0-184">应用程序使用 ISSCommandWithParameters 获取和设置在“参数属性”部分中定义的参数属性\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="123c0-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="123c0-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="123c0-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="123c0-186">返回的列如下所示：</span><span class="sxs-lookup"><span data-stu-id="123c0-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="123c0-187">列类型</span><span class="sxs-lookup"><span data-stu-id="123c0-187">Column type</span></span>|<span data-ttu-id="123c0-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="123c0-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="123c0-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="123c0-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="123c0-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="123c0-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="123c0-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="123c0-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="123c0-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="123c0-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="123c0-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="123c0-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="123c0-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="123c0-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="123c0-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-196">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-197">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-198">*n*</span><span class="sxs-lookup"><span data-stu-id="123c0-198">*n*</span></span>|<span data-ttu-id="123c0-199">Null</span><span class="sxs-lookup"><span data-stu-id="123c0-199">NULL</span></span>|<span data-ttu-id="123c0-200">Null</span><span class="sxs-lookup"><span data-stu-id="123c0-200">NULL</span></span>|<span data-ttu-id="123c0-201">清除</span><span class="sxs-lookup"><span data-stu-id="123c0-201">Clear</span></span>|<span data-ttu-id="123c0-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="123c0-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="123c0-203">n</span><span class="sxs-lookup"><span data-stu-id="123c0-203">n</span></span>|  
|<span data-ttu-id="123c0-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-205">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="123c0-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-206">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-207">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-207">~0</span></span>|<span data-ttu-id="123c0-208">Null</span><span class="sxs-lookup"><span data-stu-id="123c0-208">NULL</span></span>|<span data-ttu-id="123c0-209">Null</span><span class="sxs-lookup"><span data-stu-id="123c0-209">NULL</span></span>|<span data-ttu-id="123c0-210">设置</span><span class="sxs-lookup"><span data-stu-id="123c0-210">Set</span></span>|<span data-ttu-id="123c0-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="123c0-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="123c0-212">0</span><span class="sxs-lookup"><span data-stu-id="123c0-212">0</span></span>|  
  
 <span data-ttu-id="123c0-213">对于 UDT，还会定义以下列：</span><span class="sxs-lookup"><span data-stu-id="123c0-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="123c0-214">列标识符</span><span class="sxs-lookup"><span data-stu-id="123c0-214">Column Identifier</span></span>|<span data-ttu-id="123c0-215">类型</span><span class="sxs-lookup"><span data-stu-id="123c0-215">Type</span></span>|<span data-ttu-id="123c0-216">说明</span><span class="sxs-lookup"><span data-stu-id="123c0-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="123c0-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="123c0-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="123c0-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-219">对于 UDT 列，为在其中定义了 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="123c0-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="123c0-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="123c0-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-222">对于 UDT 列，为在其中定义了 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="123c0-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="123c0-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="123c0-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-225">对于 UDT 列，为仅由一个部分组成的 UDT 名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="123c0-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="123c0-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="123c0-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-228">对于 UDT 列，是 UDT 的完整类型名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="123c0-229">通过程序集类型的完全限定名称，可以使用 Type.GetType 方法实例化该类型的对象。</span><span class="sxs-lookup"><span data-stu-id="123c0-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="123c0-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="123c0-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="123c0-231">在 DBCOLUMNINFO 结构中返回的信息如下所示：</span><span class="sxs-lookup"><span data-stu-id="123c0-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="123c0-232">参数类型</span><span class="sxs-lookup"><span data-stu-id="123c0-232">Parameter type</span></span>|<span data-ttu-id="123c0-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="123c0-233">*wType*</span></span>|<span data-ttu-id="123c0-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="123c0-234">*ulColumnSize*</span></span>|<span data-ttu-id="123c0-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="123c0-235">*bPrecision*</span></span>|<span data-ttu-id="123c0-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="123c0-236">*bScale*</span></span>|<span data-ttu-id="123c0-237">dwFlags\*\*</span><span class="sxs-lookup"><span data-stu-id="123c0-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="123c0-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="123c0-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="123c0-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-240">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-241">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-242">*n*</span><span class="sxs-lookup"><span data-stu-id="123c0-242">*n*</span></span>|<span data-ttu-id="123c0-243">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-243">~0</span></span>|<span data-ttu-id="123c0-244">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-244">~0</span></span>|<span data-ttu-id="123c0-245">清除</span><span class="sxs-lookup"><span data-stu-id="123c0-245">Clear</span></span>|  
|<span data-ttu-id="123c0-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-247">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="123c0-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-248">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-249">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-249">~0</span></span>|<span data-ttu-id="123c0-250">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-250">~0</span></span>|<span data-ttu-id="123c0-251">~0</span><span class="sxs-lookup"><span data-stu-id="123c0-251">~0</span></span>|<span data-ttu-id="123c0-252">设置</span><span class="sxs-lookup"><span data-stu-id="123c0-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="123c0-253">COLUMNS 行集（架构行集）</span><span class="sxs-lookup"><span data-stu-id="123c0-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="123c0-254">对于 UDT 类型，返回以下列值：</span><span class="sxs-lookup"><span data-stu-id="123c0-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="123c0-255">列类型</span><span class="sxs-lookup"><span data-stu-id="123c0-255">Column type</span></span>|<span data-ttu-id="123c0-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="123c0-256">DATA_TYPE</span></span>|<span data-ttu-id="123c0-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="123c0-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="123c0-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="123c0-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="123c0-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-260">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-261">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-262">清除</span><span class="sxs-lookup"><span data-stu-id="123c0-262">Clear</span></span>|<span data-ttu-id="123c0-263">*n*</span><span class="sxs-lookup"><span data-stu-id="123c0-263">*n*</span></span>|  
|<span data-ttu-id="123c0-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-265">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="123c0-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-266">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-267">设置</span><span class="sxs-lookup"><span data-stu-id="123c0-267">Set</span></span>|<span data-ttu-id="123c0-268">0</span><span class="sxs-lookup"><span data-stu-id="123c0-268">0</span></span>|  
  
 <span data-ttu-id="123c0-269">对于 UDT，还会定义以下列：</span><span class="sxs-lookup"><span data-stu-id="123c0-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="123c0-270">列标识符</span><span class="sxs-lookup"><span data-stu-id="123c0-270">Column identifier</span></span>|<span data-ttu-id="123c0-271">类型</span><span class="sxs-lookup"><span data-stu-id="123c0-271">Type</span></span>|<span data-ttu-id="123c0-272">说明</span><span class="sxs-lookup"><span data-stu-id="123c0-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="123c0-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="123c0-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="123c0-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-275">对于 UDT 列，为在其中定义了 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="123c0-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="123c0-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="123c0-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-278">对于 UDT 列，为在其中定义了 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="123c0-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="123c0-279">SS_UDT_NAME</span></span>|<span data-ttu-id="123c0-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-281">对于 UDT 列，为仅由一个部分组成的 UDT 名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="123c0-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="123c0-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="123c0-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-284">对于 UDT 列，为 UDT 的完整类型名称。</span><span class="sxs-lookup"><span data-stu-id="123c0-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="123c0-285">通过程序集类型的完全限定名称，可以使用 Type.GetType 方法实例化该类型的对象。</span><span class="sxs-lookup"><span data-stu-id="123c0-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="123c0-286">对于 PROCEDURE_PARAMETERS 行集，DATA_TYPE 包含与 COLUMNS 架构行集相同的值，并且 TYPE_NAME 包含 UDT。</span><span class="sxs-lookup"><span data-stu-id="123c0-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="123c0-287">对于该行集，也会定义相同的附加列。</span><span class="sxs-lookup"><span data-stu-id="123c0-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="123c0-288">用户定义类型不会出现在 PROVIDER_TYPES 架构行集中。</span><span class="sxs-lookup"><span data-stu-id="123c0-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="123c0-289">绑定和转换</span><span class="sxs-lookup"><span data-stu-id="123c0-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="123c0-290">绑定数据类型</span><span class="sxs-lookup"><span data-stu-id="123c0-290">Binding data tpe</span></span>|<span data-ttu-id="123c0-291">UDT 到服务器</span><span class="sxs-lookup"><span data-stu-id="123c0-291">UDT to server</span></span>|<span data-ttu-id="123c0-292">非 UDT 到服务器</span><span class="sxs-lookup"><span data-stu-id="123c0-292">Non-UDT to server</span></span>|<span data-ttu-id="123c0-293">UDT 来自服务器</span><span class="sxs-lookup"><span data-stu-id="123c0-293">UDT from server</span></span>|<span data-ttu-id="123c0-294">非 UDT 来自服务器</span><span class="sxs-lookup"><span data-stu-id="123c0-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="123c0-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-295">DBTYPE_UDT</span></span>|<span data-ttu-id="123c0-296">支持 (5)</span><span class="sxs-lookup"><span data-stu-id="123c0-296">Supported (5)</span></span>|<span data-ttu-id="123c0-297">错误 (1)</span><span class="sxs-lookup"><span data-stu-id="123c0-297">Error (1)</span></span>|<span data-ttu-id="123c0-298">支持 (5)</span><span class="sxs-lookup"><span data-stu-id="123c0-298">Supported (5)</span></span>|<span data-ttu-id="123c0-299">错误 (4)</span><span class="sxs-lookup"><span data-stu-id="123c0-299">Error (4)</span></span>|  
|<span data-ttu-id="123c0-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="123c0-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="123c0-301">支持 (5)</span><span class="sxs-lookup"><span data-stu-id="123c0-301">Supported (5)</span></span>|<span data-ttu-id="123c0-302">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-302">N/A</span></span>|<span data-ttu-id="123c0-303">支持 (5)</span><span class="sxs-lookup"><span data-stu-id="123c0-303">Supported (5)</span></span>|<span data-ttu-id="123c0-304">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-304">N/A</span></span>|  
|<span data-ttu-id="123c0-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="123c0-306">支持 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-306">Supported (2), (5)</span></span>|<span data-ttu-id="123c0-307">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-307">N/A</span></span>|<span data-ttu-id="123c0-308">支持 (3)、(5)、(6)</span><span class="sxs-lookup"><span data-stu-id="123c0-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="123c0-309">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-309">N/A</span></span>|  
|<span data-ttu-id="123c0-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="123c0-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="123c0-311">支持 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-311">Supported (2), (5)</span></span>|<span data-ttu-id="123c0-312">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-312">N/A</span></span>|<span data-ttu-id="123c0-313">支持 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-313">Supported (3), (5)</span></span>|<span data-ttu-id="123c0-314">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-314">N/A</span></span>|  
|<span data-ttu-id="123c0-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="123c0-315">DBTYPE_STR</span></span>|<span data-ttu-id="123c0-316">支持 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-316">Supported (2), (5)</span></span>|<span data-ttu-id="123c0-317">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-317">N/A</span></span>|<span data-ttu-id="123c0-318">支持 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-318">Supported (3), (5)</span></span>|<span data-ttu-id="123c0-319">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-319">N/A</span></span>|  
|<span data-ttu-id="123c0-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="123c0-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="123c0-321">支持 (6)</span><span class="sxs-lookup"><span data-stu-id="123c0-321">Supported (6)</span></span>|<span data-ttu-id="123c0-322">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-322">N/A</span></span>|<span data-ttu-id="123c0-323">支持 (6)</span><span class="sxs-lookup"><span data-stu-id="123c0-323">Supported (6)</span></span>|<span data-ttu-id="123c0-324">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-324">N/A</span></span>|  
|<span data-ttu-id="123c0-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="123c0-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="123c0-326">支持 (5)</span><span class="sxs-lookup"><span data-stu-id="123c0-326">Supported  (5)</span></span>|<span data-ttu-id="123c0-327">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-327">N/A</span></span>|<span data-ttu-id="123c0-328">支持 (3)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-328">Supported (3), (5)</span></span>|<span data-ttu-id="123c0-329">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-329">N/A</span></span>|  
|<span data-ttu-id="123c0-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="123c0-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="123c0-331">支持 (2)、(5)</span><span class="sxs-lookup"><span data-stu-id="123c0-331">Supported (2), (5)</span></span>|<span data-ttu-id="123c0-332">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-332">N/A</span></span>|<span data-ttu-id="123c0-333">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-333">N/A</span></span>|<span data-ttu-id="123c0-334">空值</span><span class="sxs-lookup"><span data-stu-id="123c0-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="123c0-335">符号含义</span><span class="sxs-lookup"><span data-stu-id="123c0-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="123c0-336">符号</span><span class="sxs-lookup"><span data-stu-id="123c0-336">Symbol</span></span>|<span data-ttu-id="123c0-337">含义</span><span class="sxs-lookup"><span data-stu-id="123c0-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="123c0-338">1</span><span class="sxs-lookup"><span data-stu-id="123c0-338">1</span></span>|<span data-ttu-id="123c0-339">如果使用 ICommandWithParameters::SetParameterInfo 指定了非 DBTYPE_UDT 的服务器类型，而取值函数类型为 DBTYPE_UDT，则执行该语句时将出错\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="123c0-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="123c0-340">将出现 DB_E_ERRORSOCCURRED 错误，参数状态将为 DBSTATUS_E_BADACCESSOR。</span><span class="sxs-lookup"><span data-stu-id="123c0-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="123c0-341">如为类型不是 UDT 的服务器参数指定 UDT 类型的参数，则会出现错误。</span><span class="sxs-lookup"><span data-stu-id="123c0-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="123c0-342">2</span><span class="sxs-lookup"><span data-stu-id="123c0-342">2</span></span>|<span data-ttu-id="123c0-343">数据从十六进制字符串转换为二进制数据。</span><span class="sxs-lookup"><span data-stu-id="123c0-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="123c0-344">3</span><span class="sxs-lookup"><span data-stu-id="123c0-344">3</span></span>|<span data-ttu-id="123c0-345">数据从二进制数据转换为十六进制字符串。</span><span class="sxs-lookup"><span data-stu-id="123c0-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="123c0-346">4</span><span class="sxs-lookup"><span data-stu-id="123c0-346">4</span></span>|<span data-ttu-id="123c0-347">在使用 CreateAccessor 或 GetNextRows 时进行验证\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="123c0-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="123c0-348">错误为 DB_E_ERRORSOCCURRED 错误。</span><span class="sxs-lookup"><span data-stu-id="123c0-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="123c0-349">绑定状态设置为 DBBINDSTATUS_UNSUPPORTEDCONVERSION。</span><span class="sxs-lookup"><span data-stu-id="123c0-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="123c0-350">5</span><span class="sxs-lookup"><span data-stu-id="123c0-350">5</span></span>|<span data-ttu-id="123c0-351">可能会使用 BY_REF。</span><span class="sxs-lookup"><span data-stu-id="123c0-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="123c0-352">6</span><span class="sxs-lookup"><span data-stu-id="123c0-352">6</span></span>|<span data-ttu-id="123c0-353">UDT 参数可以绑定为 DBBINDING 中的 DBTYPE_IUNKNOWN。</span><span class="sxs-lookup"><span data-stu-id="123c0-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="123c0-354">如果绑定到 DBTYPE_IUNKNOWN，则表示应用程序要使用 ISequentialStream 接口将数据作为流进行处理。</span><span class="sxs-lookup"><span data-stu-id="123c0-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="123c0-355">当使用者在绑定中将*wType*指定为类型 DBTYPE_IUNKNOWN，并且该存储过程的相应列或输出参数为 UDT 时，SQL Server Native Client 将返回 ISequentialStream。</span><span class="sxs-lookup"><span data-stu-id="123c0-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="123c0-356">对于输入参数，SQL Server Native Client 将查询 ISequentialStream 接口的。</span><span class="sxs-lookup"><span data-stu-id="123c0-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="123c0-357">如果是大型 UDT，可以选择不绑定 UDT 数据的长度，而是使用 DBTYPE_IUNKNOWN 绑定。</span><span class="sxs-lookup"><span data-stu-id="123c0-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="123c0-358">但是，对于小型 UDT，必须绑定长度。</span><span class="sxs-lookup"><span data-stu-id="123c0-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="123c0-359">如果满足以下一个或多个条件，可以将 DBTYPE_UDT 参数指定为大型 UDT：</span><span class="sxs-lookup"><span data-stu-id="123c0-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="123c0-360">-   *ulParamParamSize*为 ~ 0。</span><span class="sxs-lookup"><span data-stu-id="123c0-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="123c0-361">-DBPARAMFLAGS_ISLONG 在 DBPARAMBINDINFO 结构中设置。</span><span class="sxs-lookup"><span data-stu-id="123c0-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="123c0-362">对于行数据，仅允许对大型 UDT 进行 DBTYPE_IUNKNOWN 绑定。</span><span class="sxs-lookup"><span data-stu-id="123c0-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="123c0-363">可以通过对 Rowset 或 Command 对象的 IColumnsInfo 接口使用 IColumnsInfo::GetColumnInfo 方法来了解列是否为大型 UDT 类型。</span><span class="sxs-lookup"><span data-stu-id="123c0-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="123c0-364">如果满足以下一个或多个条件，DBTYPE_UDT 列即为大型 UDT 列：</span><span class="sxs-lookup"><span data-stu-id="123c0-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="123c0-365">-在 DBCOLUMNINFO 结构的*dwFlags*成员上设置了 DBCOLUMNFLAGS_ISLONG 标志</span><span class="sxs-lookup"><span data-stu-id="123c0-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="123c0-366">-   DBCOLUMNINFO 的*ulColumnSize*成员为 ~ 0。</span><span class="sxs-lookup"><span data-stu-id="123c0-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="123c0-367">可以绑定 DBTYPE_NULL 和 DBTYPE_EMPTY 用于输入参数，但不能用于输出参数或结果。</span><span class="sxs-lookup"><span data-stu-id="123c0-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="123c0-368">当绑定用于输入参数时，对于 DBTYPE_NULL，状态必须设置为 DBSTATUS_S_ISNULL，对于 DBTYPE_EMPTY 则必须设置为 DBSTATUS_S_DEFAULT。</span><span class="sxs-lookup"><span data-stu-id="123c0-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="123c0-369">DBTYPE_BYREF 不能与 DBTYPE_NULL 或 DBTYPE_EMPTY 一起使用。</span><span class="sxs-lookup"><span data-stu-id="123c0-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="123c0-370">DBTYPE_UDT 还可以转换为 DBTYPE_EMPTY 和 DBTYPE_NULL。</span><span class="sxs-lookup"><span data-stu-id="123c0-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="123c0-371">但是，DBTYPE_NULL 和 DBTYPE_EMPTY 无法转换为 DBTYPE_UDT。</span><span class="sxs-lookup"><span data-stu-id="123c0-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="123c0-372">这与 DBTYPE_BYTES 的情况是一致的。</span><span class="sxs-lookup"><span data-stu-id="123c0-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="123c0-373">ISSCommandWithParameters 用于将 UDT 处理为参数\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="123c0-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="123c0-374">OLE DB 核心服务 (IDataConvert) 提供的数据转换不适用于 DBTYPE_UDT\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="123c0-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="123c0-375">不支持其他绑定。</span><span class="sxs-lookup"><span data-stu-id="123c0-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="123c0-376">IRowsetFind 的可比性</span><span class="sxs-lookup"><span data-stu-id="123c0-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="123c0-377">对于 UDT 类型，仅支持进行以下比较：</span><span class="sxs-lookup"><span data-stu-id="123c0-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="123c0-378">EQ</span><span class="sxs-lookup"><span data-stu-id="123c0-378">EQ</span></span>  
  
-   <span data-ttu-id="123c0-379">NE</span><span class="sxs-lookup"><span data-stu-id="123c0-379">NE</span></span>  
  
-   <span data-ttu-id="123c0-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="123c0-380">IGNORE</span></span>  
  
 <span data-ttu-id="123c0-381">如果试图进行其他任何比较，将返回 DB_E_BADCOMPAREOP 错误。</span><span class="sxs-lookup"><span data-stu-id="123c0-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="123c0-382">对 UDT 的 BCP 支持</span><span class="sxs-lookup"><span data-stu-id="123c0-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="123c0-383">UDT 值只能够作为字符值或二进制值导入和导出。</span><span class="sxs-lookup"><span data-stu-id="123c0-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="123c0-384">UDT 的下级客户端行为</span><span class="sxs-lookup"><span data-stu-id="123c0-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="123c0-385">对于下级客户端，UDT 会进行类型映射，如下所示：</span><span class="sxs-lookup"><span data-stu-id="123c0-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="123c0-386">客户端版本</span><span class="sxs-lookup"><span data-stu-id="123c0-386">Client version</span></span>|<span data-ttu-id="123c0-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-388">（长度小于或等于 8,000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="123c0-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="123c0-390">（长度大于 8000 个字节）</span><span class="sxs-lookup"><span data-stu-id="123c0-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="123c0-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="123c0-391">SQL Server 2005</span></span>|<span data-ttu-id="123c0-392">UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-392">UDT</span></span>|<span data-ttu-id="123c0-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="123c0-393">varbinary(max)</span></span>|  
|<span data-ttu-id="123c0-394">SQL Server 2008 和更高版本</span><span class="sxs-lookup"><span data-stu-id="123c0-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="123c0-395">UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-395">UDT</span></span>|<span data-ttu-id="123c0-396">UDT</span><span class="sxs-lookup"><span data-stu-id="123c0-396">UDT</span></span>|  
  
 <span data-ttu-id="123c0-397">如果 `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) 设置为“80”，大型 UDT 类型对客户端所显示的类型将与它们对下级客户端所显示的相同。</span><span class="sxs-lookup"><span data-stu-id="123c0-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="123c0-398">另请参阅</span><span class="sxs-lookup"><span data-stu-id="123c0-398">See Also</span></span>  
 [<span data-ttu-id="123c0-399">大型 CLR 用户定义类型</span><span class="sxs-lookup"><span data-stu-id="123c0-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
