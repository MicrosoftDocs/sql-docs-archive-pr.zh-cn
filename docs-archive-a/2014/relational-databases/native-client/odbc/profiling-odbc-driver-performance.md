---
title: 分析 ODBC 驱动程序性能 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- profiling ODBC driver performance data [SQL Server Native Client]
- performance [ODBC]
- application statistics [ODBC]
- time statistics [ODBC]
- ODBC, performance data
- SQL Server Native Client ODBC driver, profiling performance data
- SQLPERF data structure
- statistical information [ODBC]
ms.assetid: 8f44e194-d556-4119-a759-4c9dec7ecead
author: rothja
ms.author: jroth
ms.openlocfilehash: 91373d22b845dd0abb1263b7fa367b4bf3bff42e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579547"
---
# <a name="profiling-odbc-driver-performance"></a><span data-ttu-id="83b8e-102">ODBC 驱动程序性能事件探查</span><span class="sxs-lookup"><span data-stu-id="83b8e-102">Profiling ODBC Driver Performance</span></span>
  <span data-ttu-id="83b8e-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序可以对两种类型的性能数据进行事件探查：</span><span class="sxs-lookup"><span data-stu-id="83b8e-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can profile two types of performance data:</span></span>  
  
-   <span data-ttu-id="83b8e-104">长时间运行的查询。</span><span class="sxs-lookup"><span data-stu-id="83b8e-104">Long-running queries.</span></span>  
  
     <span data-ttu-id="83b8e-105">驱动程序可以将在指定时间内没有从服务器获得响应的任何查询写入日志文件。</span><span class="sxs-lookup"><span data-stu-id="83b8e-105">The driver can write to a log file any query that does not get a response from the server within a specified amount of time.</span></span> <span data-ttu-id="83b8e-106">然后，应用程序编程人员或者数据库管理员可以研究每个记录在日志中的 SQL 语句，确定如何提高它的性能。</span><span class="sxs-lookup"><span data-stu-id="83b8e-106">Application programmers or database administrators can then research each logged SQL statement to determine how they can improve its performance.</span></span>  
  
-   <span data-ttu-id="83b8e-107">驱动程序性能数据。</span><span class="sxs-lookup"><span data-stu-id="83b8e-107">Driver-performance data.</span></span>  
  
     <span data-ttu-id="83b8e-108">驱动程序可以记录性能统计信息，并将它们写入文件或者通过名为 SQLPERF 且特定于驱动程序的数据结构让应用程序能够使用这些信息。</span><span class="sxs-lookup"><span data-stu-id="83b8e-108">The driver can record performance statistics and either write them to a file or make them available to an application through a driver-specific data structure named SQLPERF.</span></span> <span data-ttu-id="83b8e-109">包含性能统计信息的文件是以制表符分隔的文件，可以使用支持以制表符分隔的文件的任何电子表格软件（比如 Microsoft Excel）对该文件进行分析。</span><span class="sxs-lookup"><span data-stu-id="83b8e-109">The file containing the performance statistics is a tab-delimited file that can be easily analyzed with any spreadsheet that supports tab-delimited files, such as Microsoft Excel.</span></span>  
  
 <span data-ttu-id="83b8e-110">可以通过以下方式打开任一类型的事件探查：</span><span class="sxs-lookup"><span data-stu-id="83b8e-110">Either type of profiling can be turned on by:</span></span>  
  
-   <span data-ttu-id="83b8e-111">连接到指定了日志记录的数据源。</span><span class="sxs-lookup"><span data-stu-id="83b8e-111">Connecting to a data source that specifies logging.</span></span>  
  
-   <span data-ttu-id="83b8e-112">调用[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)以设置控制分析的特定于驱动程序的属性。</span><span class="sxs-lookup"><span data-stu-id="83b8e-112">Calling [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set driver-specific attributes that control profiling.</span></span>  
  
 <span data-ttu-id="83b8e-113">每个应用程序进程都获取它自己的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序副本，而且事件探查工作是将驱动程序副本和应用程序进程综合在一起进行考虑的全局性工作。</span><span class="sxs-lookup"><span data-stu-id="83b8e-113">Each application process gets its own copy of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and profiling is global to the combination of a driver copy and an application process.</span></span> <span data-ttu-id="83b8e-114">当应用程序中的任意操作打开了事件探查时，事件探查将记录从该应用程序建立的、在驱动程序中仍处于活动状态的所有连接的信息。</span><span class="sxs-lookup"><span data-stu-id="83b8e-114">When anything in the application turns on profiling, profiling records information for all connections active in the driver from that application.</span></span> <span data-ttu-id="83b8e-115">其中甚至包括了那些不是专为进行事件探查而建立的连接。</span><span class="sxs-lookup"><span data-stu-id="83b8e-115">Even connections that did not specifically call for profiling are included.</span></span>  
  
 <span data-ttu-id="83b8e-116">在驱动程序打开事件探查日志（性能数据日志或长时间运行查询日志）之后，它会始终打开日志，直到驱动程序被 ODBC 驱动程序管理器卸载（当应用程序释放它在驱动程序中打开的所有环境句柄的时候）。</span><span class="sxs-lookup"><span data-stu-id="83b8e-116">After the driver has opened a profiling log (either the performance data or long-running query log), it does not close the log until the driver is unloaded by the ODBC Driver Manager, when an application frees all the environment handles it opened in the driver.</span></span> <span data-ttu-id="83b8e-117">如果应用程序打开了新的环境句柄，则会加载驱动程序的新副本。</span><span class="sxs-lookup"><span data-stu-id="83b8e-117">If the application opens a new environment handle, a new copy of the driver is loaded.</span></span> <span data-ttu-id="83b8e-118">然后，如果应用程序所连接的数据源指定了相同日志文件或者设置了特定于驱动程序的属性以在相同文件中记录日志，驱动程序将覆盖旧的日志文件。</span><span class="sxs-lookup"><span data-stu-id="83b8e-118">If the application then either connects to a data source that specifies the same log file or sets the driver-specific attributes to log to the same file, the driver overwrites the old log.</span></span>  
  
 <span data-ttu-id="83b8e-119">如果一个应用程序启动了事件探查并将信息写入某个日志文件，然后第二个应用程序试图启动事件探查并将信息写入同一个日志文件，第二个应用程序将无法在日志中记录任何事件探查数据。</span><span class="sxs-lookup"><span data-stu-id="83b8e-119">If an application starts profiling to a log file and a second application attempts to start profiling to the same log file, the second application is not able to log any profiling data.</span></span> <span data-ttu-id="83b8e-120">如果第二个应用程序在第一个应用程序已卸载了其驱动程序之后启动事件探查，则第二个应用程序将覆盖第一个应用程序写入的日志文件。</span><span class="sxs-lookup"><span data-stu-id="83b8e-120">If the second application starts profiling after the first application has unloaded its driver, the second application overwrites the log file from the first application.</span></span>  
  
 <span data-ttu-id="83b8e-121">如果应用程序连接到已启用分析的数据源，则驱动程序将返回 SQL_ERROR （如果应用程序调用**SQLSetConnectOption**启动日志记录）。</span><span class="sxs-lookup"><span data-stu-id="83b8e-121">If an application connects to a data source that has profiling enabled, the driver returns SQL_ERROR if the application calls **SQLSetConnectOption** to start logging.</span></span> <span data-ttu-id="83b8e-122">然后调用**SQLGetDiagRec**返回以下内容：</span><span class="sxs-lookup"><span data-stu-id="83b8e-122">A call to **SQLGetDiagRec** then returns the following:</span></span>  
  
```  
SQLState: 01000, pfNative = 0  
ErrorMsg: [Microsoft][SQL Server Native Client]  
   An error has occurred during the attempt to access  
   the log file, logging disabled.  
```  
  
 <span data-ttu-id="83b8e-123">当环境句柄关闭时，驱动程序将停止收集性能数据。</span><span class="sxs-lookup"><span data-stu-id="83b8e-123">The driver stops gathering performance data when an environment handle is closed.</span></span> <span data-ttu-id="83b8e-124">如果 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 应用程序具有多条连接，每个都有自己的环境句柄，那么，当任何关联的环境句柄关闭之后，驱动程序都将停止收集性能数据。</span><span class="sxs-lookup"><span data-stu-id="83b8e-124">If an [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application has multiple connections, each with its own environment handle, then the driver will stop gathering performance data when any of the associated environment handles are closed.</span></span>  
  
 <span data-ttu-id="83b8e-125">驱动程序的性能数据既可以存储在 SQLPERF 数据结构中，也可以记录在以制表符分隔的文件中。</span><span class="sxs-lookup"><span data-stu-id="83b8e-125">The driver's performance data can either be stored in the SQLPERF data structure or logged in a tab-delimited file.</span></span> <span data-ttu-id="83b8e-126">包括以下几个类别的统计信息数据：</span><span class="sxs-lookup"><span data-stu-id="83b8e-126">The data includes the following categories of statistics:</span></span>  
  
-   <span data-ttu-id="83b8e-127">应用程序概况</span><span class="sxs-lookup"><span data-stu-id="83b8e-127">Application profile</span></span>  
  
-   <span data-ttu-id="83b8e-128">连接</span><span class="sxs-lookup"><span data-stu-id="83b8e-128">Connection</span></span>  
  
-   <span data-ttu-id="83b8e-129">网络</span><span class="sxs-lookup"><span data-stu-id="83b8e-129">Network</span></span>  
  
-   <span data-ttu-id="83b8e-130">时间</span><span class="sxs-lookup"><span data-stu-id="83b8e-130">Time</span></span>  
  
 <span data-ttu-id="83b8e-131">下表对 SQLPERF 数据结构中的字段的说明也适用于性能日志文件中记录的统计信息。</span><span class="sxs-lookup"><span data-stu-id="83b8e-131">In the following table, the descriptions of the fields in the SQLPERF data structure also apply to the statistics recorded in the performance log file.</span></span>  
  
### <a name="application-profile-statistics"></a><span data-ttu-id="83b8e-132">应用程序配置文件统计信息</span><span class="sxs-lookup"><span data-stu-id="83b8e-132">Application Profile Statistics</span></span>  
  
|<span data-ttu-id="83b8e-133">SQLPERF 字段</span><span class="sxs-lookup"><span data-stu-id="83b8e-133">SQLPERF field</span></span>|<span data-ttu-id="83b8e-134">说明</span><span class="sxs-lookup"><span data-stu-id="83b8e-134">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="83b8e-135">TimerResolution</span><span class="sxs-lookup"><span data-stu-id="83b8e-135">TimerResolution</span></span>|<span data-ttu-id="83b8e-136">服务器时钟时间的最小解析度（以毫秒为单位）。</span><span class="sxs-lookup"><span data-stu-id="83b8e-136">Minimum resolution of the server's clock time in milliseconds.</span></span> <span data-ttu-id="83b8e-137">通常，此值报告为 0（零）并且只有在报告的数值很大时才应予以考虑。</span><span class="sxs-lookup"><span data-stu-id="83b8e-137">This is usually reported as 0 (zero) and should only be considered if the number reported is large.</span></span> <span data-ttu-id="83b8e-138">如果服务器时钟的最小解析度大于某些基于计时器的统计信息可能使用的间隔时间，这些统计信息可能会急剧增加。</span><span class="sxs-lookup"><span data-stu-id="83b8e-138">If the minimum resolution of the server clock is larger than the likely interval for some of the timer-based statistics, those statistics could be inflated.</span></span>|  
|<span data-ttu-id="83b8e-139">SQLidu</span><span class="sxs-lookup"><span data-stu-id="83b8e-139">SQLidu</span></span>|<span data-ttu-id="83b8e-140">SQL_PERF_START 之后 INSERT、DELETE 或 UPDATE 语句的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-140">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-141">SQLiduRows</span><span class="sxs-lookup"><span data-stu-id="83b8e-141">SQLiduRows</span></span>|<span data-ttu-id="83b8e-142">SQL_PERF_START 之后 INSERT、DELETE 或 UPDATE 语句的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-142">Number of INSERT, DELETE, or UPDATE statements after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-143">SQLSelects</span><span class="sxs-lookup"><span data-stu-id="83b8e-143">SQLSelects</span></span>|<span data-ttu-id="83b8e-144">在 SQL_PERF_START 之后处理的 SELECT 语句的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-144">Number of SELECT statements processed after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-145">SQLSelectRows</span><span class="sxs-lookup"><span data-stu-id="83b8e-145">SQLSelectRows</span></span>|<span data-ttu-id="83b8e-146">在 SQL_PERF_START 之后选择的行数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-146">Number of rows selected after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-147">事务</span><span class="sxs-lookup"><span data-stu-id="83b8e-147">Transactions</span></span>|<span data-ttu-id="83b8e-148">SQL_PERF_START 之后用户事务的数量（包括回滚的数量）。</span><span class="sxs-lookup"><span data-stu-id="83b8e-148">Number of user transactions after SQL_PERF_START, including rollbacks.</span></span> <span data-ttu-id="83b8e-149">如果使用 SQL_AUTOCOMMIT_ON 运行 ODBC 应用程序，则每个命令都视为一个事务。</span><span class="sxs-lookup"><span data-stu-id="83b8e-149">When an ODBC application is running with SQL_AUTOCOMMIT_ON, each command is considered a transaction.</span></span>|  
|<span data-ttu-id="83b8e-150">SQLPrepares</span><span class="sxs-lookup"><span data-stu-id="83b8e-150">SQLPrepares</span></span>|<span data-ttu-id="83b8e-151">SQL_PERF_START 后的[SQLPrepare 函数](https://go.microsoft.com/fwlink/?LinkId=59360)调用数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-151">Number of [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360) calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-152">ExecDirects</span><span class="sxs-lookup"><span data-stu-id="83b8e-152">ExecDirects</span></span>|<span data-ttu-id="83b8e-153">SQL_PERF_START 后的**SQLExecDirect**调用数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-153">Number of **SQLExecDirect** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-154">SQLExecutes</span><span class="sxs-lookup"><span data-stu-id="83b8e-154">SQLExecutes</span></span>|<span data-ttu-id="83b8e-155">SQL_PERF_START 后的**SQLExecute**调用数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-155">Number of **SQLExecute** calls after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-156">CursorOpens</span><span class="sxs-lookup"><span data-stu-id="83b8e-156">CursorOpens</span></span>|<span data-ttu-id="83b8e-157">SQL_PERF_START 之后驱动程序打开服务器游标的次数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-157">Number of times the driver has opened a server cursor after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-158">CursorSize</span><span class="sxs-lookup"><span data-stu-id="83b8e-158">CursorSize</span></span>|<span data-ttu-id="83b8e-159">SQL_PERF_START 之后游标打开的结果集中行的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-159">Number of rows in the result sets opened by cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-160">CursorUsed</span><span class="sxs-lookup"><span data-stu-id="83b8e-160">CursorUsed</span></span>|<span data-ttu-id="83b8e-161">SQL_PERF_START 之后通过驱动程序从游标实际检索的行的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-161">Number of rows actually retrieved through the driver from cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-162">PercentCursorUsed</span><span class="sxs-lookup"><span data-stu-id="83b8e-162">PercentCursorUsed</span></span>|<span data-ttu-id="83b8e-163">等于 CursorUsed/CursorSize。</span><span class="sxs-lookup"><span data-stu-id="83b8e-163">Equals CursorUsed/CursorSize.</span></span> <span data-ttu-id="83b8e-164">例如，如果应用程序导致驱动程序打开一个服务器游标来执行“SELECT COUNT(\*) FROM Authors”，SELECT 语句的结果集中将包含 23 行。</span><span class="sxs-lookup"><span data-stu-id="83b8e-164">For example, if an application causes the driver to open a server cursor to do "SELECT COUNT(\*) FROM Authors," 23 rows will be in the result set for the SELECT statement.</span></span> <span data-ttu-id="83b8e-165">如果应用程序随后仅提取了这些行中的三行，CursorUsed/CursorSize 将等于 3/23，因此 PercentCursorUsed 等于 13.043478。</span><span class="sxs-lookup"><span data-stu-id="83b8e-165">If the application then fetches only three of these rows, CursorUsed/CursorSize is 3/23, so PercentCursorUsed is 13.043478.</span></span>|  
|<span data-ttu-id="83b8e-166">AvgFetchTime</span><span class="sxs-lookup"><span data-stu-id="83b8e-166">AvgFetchTime</span></span>|<span data-ttu-id="83b8e-167">等于 SQLFetchTime/SQLFetchCount。</span><span class="sxs-lookup"><span data-stu-id="83b8e-167">Equals SQLFetchTime/SQLFetchCount.</span></span>|  
|<span data-ttu-id="83b8e-168">AvgCursorSize</span><span class="sxs-lookup"><span data-stu-id="83b8e-168">AvgCursorSize</span></span>|<span data-ttu-id="83b8e-169">等于 CursorSize/CursorOpens。</span><span class="sxs-lookup"><span data-stu-id="83b8e-169">Equals CursorSize/CursorOpens.</span></span>|  
|<span data-ttu-id="83b8e-170">AvgCursorUsed</span><span class="sxs-lookup"><span data-stu-id="83b8e-170">AvgCursorUsed</span></span>|<span data-ttu-id="83b8e-171">等于 CursorUsed/CursorOpens。</span><span class="sxs-lookup"><span data-stu-id="83b8e-171">Equals CursorUsed/CursorOpens.</span></span>|  
|<span data-ttu-id="83b8e-172">SQLFetchTime</span><span class="sxs-lookup"><span data-stu-id="83b8e-172">SQLFetchTime</span></span>|<span data-ttu-id="83b8e-173">针对服务器游标执行提取所需的累积时间量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-173">Cumulative amount of time it took fetches against server cursors to complete.</span></span>|  
|<span data-ttu-id="83b8e-174">SQLFetchCount</span><span class="sxs-lookup"><span data-stu-id="83b8e-174">SQLFetchCount</span></span>|<span data-ttu-id="83b8e-175">SQL_PERF_START 之后针对服务器游标完成的提取操作的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-175">Number of fetches done against server cursors after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-176">CurrentStmtCount</span><span class="sxs-lookup"><span data-stu-id="83b8e-176">CurrentStmtCount</span></span>|<span data-ttu-id="83b8e-177">当前在驱动程序中处于打开状态的所有连接上打开的语句句柄的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-177">Number of statement handles currently open on all connections open in the driver.</span></span>|  
|<span data-ttu-id="83b8e-178">MaxOpenStmt</span><span class="sxs-lookup"><span data-stu-id="83b8e-178">MaxOpenStmt</span></span>|<span data-ttu-id="83b8e-179">SQL_PERF_START 之后并发打开的语句句柄的最大数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-179">Maximum number of concurrently opened statement handles after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-180">SumOpenStmt</span><span class="sxs-lookup"><span data-stu-id="83b8e-180">SumOpenStmt</span></span>|<span data-ttu-id="83b8e-181">SQL_PERF_START 之后打开的语句句柄的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-181">Number of statement handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-182">**连接统计信息：**</span><span class="sxs-lookup"><span data-stu-id="83b8e-182">**Connection Statistics:**</span></span>||  
|<span data-ttu-id="83b8e-183">CurrentConnectionCount</span><span class="sxs-lookup"><span data-stu-id="83b8e-183">CurrentConnectionCount</span></span>|<span data-ttu-id="83b8e-184">应用程序对服务器打开的活动连接句柄的当前数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-184">Current number of active connection handles the application has open to the server.</span></span>|  
|<span data-ttu-id="83b8e-185">MaxConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="83b8e-185">MaxConnectionsOpened</span></span>|<span data-ttu-id="83b8e-186">SQL_PERF_START 之后打开的并发连接句柄的最大数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-186">Maximum number of concurrent connection handles opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-187">SumConnectionsOpened</span><span class="sxs-lookup"><span data-stu-id="83b8e-187">SumConnectionsOpened</span></span>|<span data-ttu-id="83b8e-188">SQL_PERF_START 之后打开的连接句柄的总数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-188">Sum of the number of connection handles that have been opened after SQL_PERF_START.</span></span>|  
|<span data-ttu-id="83b8e-189">SumConnectionTime</span><span class="sxs-lookup"><span data-stu-id="83b8e-189">SumConnectionTime</span></span>|<span data-ttu-id="83b8e-190">SQL_PERF_START 之后打开的所有连接的时间总和。</span><span class="sxs-lookup"><span data-stu-id="83b8e-190">Sum of the amount of time that all of the connections have been opened after SQL_PERF_START.</span></span> <span data-ttu-id="83b8e-191">例如，如果应用程序打开了 10 个连接并且每个连接持续 5 秒钟，则 SumConnectionTime 将为 50 秒。</span><span class="sxs-lookup"><span data-stu-id="83b8e-191">For example, if an application opened 10 connections and maintained each connection for 5 seconds, then SumConnectionTime would be 50 seconds.</span></span>|  
|<span data-ttu-id="83b8e-192">AvgTimeOpened</span><span class="sxs-lookup"><span data-stu-id="83b8e-192">AvgTimeOpened</span></span>|<span data-ttu-id="83b8e-193">等于 SumConnectionsOpened/ SumConnectionTime。</span><span class="sxs-lookup"><span data-stu-id="83b8e-193">Equals SumConnectionsOpened/ SumConnectionTime.</span></span>|  
|<span data-ttu-id="83b8e-194">**网络统计信息：**</span><span class="sxs-lookup"><span data-stu-id="83b8e-194">**Network Statistics:**</span></span>||  
|<span data-ttu-id="83b8e-195">ServerRndTrips</span><span class="sxs-lookup"><span data-stu-id="83b8e-195">ServerRndTrips</span></span>|<span data-ttu-id="83b8e-196">驱动程序将命令发送到服务器并且获得了回复的次数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-196">The number of times the driver sent commands to the server and got a reply back.</span></span>|  
|<span data-ttu-id="83b8e-197">BuffersSent</span><span class="sxs-lookup"><span data-stu-id="83b8e-197">BuffersSent</span></span>|<span data-ttu-id="83b8e-198">SQL_PERF_START 之后由驱动程序发送到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的表格格式数据流 (TDS) 数据包的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-198">Number of Tabular Data Stream (TDS) packets sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by the driver after SQL_PERF_START.</span></span> <span data-ttu-id="83b8e-199">大型命令可能会占用多个缓冲区，因此如果向服务器发送了一个大型命令并且它填充了 6 个数据包，则 ServerRndTrips 将增加 1，而 BuffersSent 会增加 6。</span><span class="sxs-lookup"><span data-stu-id="83b8e-199">Large commands can take multiple buffers, so if a large command is sent to the server and it fills six packets, ServerRndTrips is incremented by one and BuffersSent is incremented by six.</span></span>|  
|<span data-ttu-id="83b8e-200">BuffersRec</span><span class="sxs-lookup"><span data-stu-id="83b8e-200">BuffersRec</span></span>|<span data-ttu-id="83b8e-201">使用驱动程序启动应用程序之后，驱动程序从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 接收的 TDS 数据包的数量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-201">Number of TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
|<span data-ttu-id="83b8e-202">BytesSent</span><span class="sxs-lookup"><span data-stu-id="83b8e-202">BytesSent</span></span>|<span data-ttu-id="83b8e-203">使用驱动程序启动应用程序之后，放在 TDS 数据包中发送到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 的数据的字节数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-203">Number of bytes of data sent to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] in TDS packets after the application started using the driver.</span></span>|  
|<span data-ttu-id="83b8e-204">BytesRec</span><span class="sxs-lookup"><span data-stu-id="83b8e-204">BytesRec</span></span>|<span data-ttu-id="83b8e-205">使用驱动程序启动应用程序之后，驱动程序从 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 接收的 TDS 数据包中数据的字节数。</span><span class="sxs-lookup"><span data-stu-id="83b8e-205">Number of bytes of data in TDS packets received by the driver from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] after the application started using the driver.</span></span>|  
  
### <a name="time-statistics"></a><span data-ttu-id="83b8e-206">时间统计信息</span><span class="sxs-lookup"><span data-stu-id="83b8e-206">Time Statistics</span></span>  
  
|<span data-ttu-id="83b8e-207">SQLPERF 字段</span><span class="sxs-lookup"><span data-stu-id="83b8e-207">SQLPERF Field</span></span>|<span data-ttu-id="83b8e-208">说明</span><span class="sxs-lookup"><span data-stu-id="83b8e-208">Description</span></span>|  
|-------------------|-----------------|  
|<span data-ttu-id="83b8e-209">msExecutionTime</span><span class="sxs-lookup"><span data-stu-id="83b8e-209">msExecutionTime</span></span>|<span data-ttu-id="83b8e-210">SQL_PERF_START 之后驱动程序花费在处理工作上的累积时间量，其中包括等待服务器的回复所花费的时间。</span><span class="sxs-lookup"><span data-stu-id="83b8e-210">Cumulative amount of time the driver spent processing after SQL_PERF_START, including the time spent waiting for replies from the server.</span></span>|  
|<span data-ttu-id="83b8e-211">msNetworkServerTime</span><span class="sxs-lookup"><span data-stu-id="83b8e-211">msNetworkServerTime</span></span>|<span data-ttu-id="83b8e-212">驱动程序等待服务器回复所花费的累积时间量。</span><span class="sxs-lookup"><span data-stu-id="83b8e-212">Cumulative amount of time the driver spent waiting for replies from the server.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="83b8e-213">另请参阅</span><span class="sxs-lookup"><span data-stu-id="83b8e-213">See Also</span></span>  
 <span data-ttu-id="83b8e-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="83b8e-214">[SQL Server Native Client &#40;ODBC&#41;](sql-server-native-client-odbc.md) </span></span>  
 [<span data-ttu-id="83b8e-215">分析 ODBC 驱动程序性能操作指南主题 &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="83b8e-215">Profiling ODBC Driver Performance How-to Topics &#40;ODBC&#41;</span></span>](../../native-client-odbc-how-to/profiling-odbc-driver-performance-odbc.md)  
  
  
