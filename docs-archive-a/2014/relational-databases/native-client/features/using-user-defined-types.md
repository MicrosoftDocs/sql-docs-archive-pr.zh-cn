---
title: 使用用户定义类型 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- DBPROPSET_DATASOURCEINFO property set
- UDTs [SQL Server Native Client]
- user-defined types [SQL Server], SQL Server Native Client
- SQL Server Native Client OLE DB provider, user-defined types
- DBPROPSET_SQLSERVERPARAMETER property set
- IColumnsRowset interface
- SQLNCLI, user-defined types
- SQL Server Native Client, user-defined types
- data access [SQL Server Native Client], user-defined types
- ISSCommandWithParameters interface
ms.assetid: e15d8169-3517-4323-9c9e-0f5c34aff7df
author: rothja
ms.author: jroth
ms.openlocfilehash: 40608f52f5d14e80aaf3c1d534241cc0ede78348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589013"
---
# <a name="using-user-defined-types"></a><span data-ttu-id="305d6-102">使用用户定义类型</span><span class="sxs-lookup"><span data-stu-id="305d6-102">Using User-Defined Types</span></span>
  [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] <span data-ttu-id="305d6-103">介绍了用户定义类型 (UDT)。</span><span class="sxs-lookup"><span data-stu-id="305d6-103">introduced user-defined types (UDTs).</span></span> <span data-ttu-id="305d6-104">UDT 可将对象和自定义数据结构存储在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 数据库中，从而扩展了 SQL 类型系统。</span><span class="sxs-lookup"><span data-stu-id="305d6-104">UDTs extend the SQL type system by allowing you to store objects and custom data structures in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="305d6-105">UDT 可以包含多种数据类型并且可具有行为，这使它们不同于由单一 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 系统数据类型构成的传统别名数据类型。</span><span class="sxs-lookup"><span data-stu-id="305d6-105">UDTs can contain multiple data types and can have behaviors, differentiating them from the traditional alias data types that consist of a single [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] system data type.</span></span> <span data-ttu-id="305d6-106">使用生成可验证代码的 .NET 公共语言运行时 (CLR) 所支持的任何语言都可以定义 UDT，</span><span class="sxs-lookup"><span data-stu-id="305d6-106">UDTs are defined using any of the languages supported by the .NET common language runtime (CLR) that produce verifiable code.</span></span> <span data-ttu-id="305d6-107">这包括 Microsoft Visual c #<sup>？</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-107">This includes Microsoft Visual C#<sup>??</sup></span></span> <span data-ttu-id="305d6-108">并 Visual Basic<sup>？</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-108">and Visual Basic<sup>??</sup></span></span> <span data-ttu-id="305d6-109">NET.</span><span class="sxs-lookup"><span data-stu-id="305d6-109">.NET.</span></span> <span data-ttu-id="305d6-110">数据公开为 .NET 类或结构的字段和属性，行为则由类或结构的方法来定义。</span><span class="sxs-lookup"><span data-stu-id="305d6-110">The data is exposed as fields and properties of a .NET class or structure, and behaviors are defined by methods of the class or structure.</span></span>  
  
 <span data-ttu-id="305d6-111">UDT 可用作表的列定义、[!INCLUDE[tsql](../../../includes/tsql-md.md)] 批处理中的变量，还可用作 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 函数或存储过程的参数。</span><span class="sxs-lookup"><span data-stu-id="305d6-111">A UDT can be used as the column definition of a table, as a variable in a [!INCLUDE[tsql](../../../includes/tsql-md.md)] batch, or as an argument of a [!INCLUDE[tsql](../../../includes/tsql-md.md)] function or stored procedure.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="305d6-112">SQL Server Native Client OLE DB 访问接口</span><span class="sxs-lookup"><span data-stu-id="305d6-112">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="305d6-113">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序支持将 udt 作为二进制类型和元数据信息，这使你可以将 udt 作为对象进行管理。</span><span class="sxs-lookup"><span data-stu-id="305d6-113">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports UDTs as binary types with metadata information, which allows you to manage UDTs as objects.</span></span> <span data-ttu-id="305d6-114">UDT 列公开为 DBTYPE_UDT，且其元数据通过核心 OLE DB 接口 IColumnRowset 和新增的 [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) 接口公开\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-114">UDT columns are exposed as DBTYPE_UDT, and their metadata are exposed through the core OLE DB interface **IColumnRowset**, and the new [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="305d6-115">IRowsetFind::FindNextRow 方法不适用于 UDT 数据类型\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-115">The **IRowsetFind::FindNextRow** method does not work with the UDT data type.</span></span> <span data-ttu-id="305d6-116">如果将 UDT 用作搜索列类型，则返回 DB_E_BADCOMPAREOP。</span><span class="sxs-lookup"><span data-stu-id="305d6-116">DB_E_BADCOMPAREOP is returned if the UDT is used as a search column type.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="305d6-117">数据绑定和强制</span><span class="sxs-lookup"><span data-stu-id="305d6-117">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="305d6-118">下表说明将所列数据类型与某一 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT 一同使用时出现的绑定和强制。</span><span class="sxs-lookup"><span data-stu-id="305d6-118">The following table describes the binding and coercion that occurs when using the listed data types with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT.</span></span> <span data-ttu-id="305d6-119">使用 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] DBTYPE_UDT 的 Native Client OLE DB 提供程序公开 UDT 列。</span><span class="sxs-lookup"><span data-stu-id="305d6-119">UDT columns are exposed through the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider as DBTYPE_UDT.</span></span> <span data-ttu-id="305d6-120">可以通过适当的架构行集获取元数据，这样即可将您自行定义的类型作为对象来管理。</span><span class="sxs-lookup"><span data-stu-id="305d6-120">You can get metadata through the appropriate schema rowsets so you can manage your own defined types as objects.</span></span>  
  
|<span data-ttu-id="305d6-121">数据类型</span><span class="sxs-lookup"><span data-stu-id="305d6-121">Data type</span></span>|<span data-ttu-id="305d6-122">到服务器</span><span class="sxs-lookup"><span data-stu-id="305d6-122">To Server</span></span><br /><br /> <span data-ttu-id="305d6-123">**UDT**</span><span class="sxs-lookup"><span data-stu-id="305d6-123">**UDT**</span></span>|<span data-ttu-id="305d6-124">到服务器</span><span class="sxs-lookup"><span data-stu-id="305d6-124">To Server</span></span><br /><br /> <span data-ttu-id="305d6-125">**non-UDT**</span><span class="sxs-lookup"><span data-stu-id="305d6-125">**non-UDT**</span></span>|<span data-ttu-id="305d6-126">从服务器</span><span class="sxs-lookup"><span data-stu-id="305d6-126">From Server</span></span><br /><br /> <span data-ttu-id="305d6-127">**UDT**</span><span class="sxs-lookup"><span data-stu-id="305d6-127">**UDT**</span></span>|<span data-ttu-id="305d6-128">从服务器</span><span class="sxs-lookup"><span data-stu-id="305d6-128">From Server</span></span><br /><br /> <span data-ttu-id="305d6-129">**non-UDT**</span><span class="sxs-lookup"><span data-stu-id="305d6-129">**non-UDT**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="305d6-130">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="305d6-130">DBTYPE_UDT</span></span>|<span data-ttu-id="305d6-131">支持<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-131">Supported<sup>6</sup></span></span>|<span data-ttu-id="305d6-132">错误<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-132">Error<sup>1</sup></span></span>|<span data-ttu-id="305d6-133">支持<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-133">Supported<sup>6</sup></span></span>|<span data-ttu-id="305d6-134">错误<sup>5</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-134">Error<sup>5</sup></span></span>|  
|<span data-ttu-id="305d6-135">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="305d6-135">DBTYPE_BYTES</span></span>|<span data-ttu-id="305d6-136">支持<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-136">Supported<sup>6</sup></span></span>|<span data-ttu-id="305d6-137">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-137">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-138">支持<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-138">Supported<sup>6</sup></span></span>|<span data-ttu-id="305d6-139">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-139">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-140">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-140">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-141">支持<sup>3,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-141">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="305d6-142">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-142">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-143">支持<sup>4,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-143">Supported<sup>4,6</sup></span></span>|<span data-ttu-id="305d6-144">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-144">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-145">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-145">DBTYPE_BSTR</span></span>|<span data-ttu-id="305d6-146">支持<sup>3,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-146">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="305d6-147">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-147">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-148">支持<sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-148">Supported<sup>4</sup></span></span>|<span data-ttu-id="305d6-149">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-149">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-150">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="305d6-150">DBTYPE_STR</span></span>|<span data-ttu-id="305d6-151">支持<sup>3,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-151">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="305d6-152">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-152">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-153">支持<sup>4,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-153">Supported<sup>4,6</sup></span></span>|<span data-ttu-id="305d6-154">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-154">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-155">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="305d6-155">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="305d6-156">不支持</span><span class="sxs-lookup"><span data-stu-id="305d6-156">Not supported</span></span>|<span data-ttu-id="305d6-157">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-157">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-158">不支持</span><span class="sxs-lookup"><span data-stu-id="305d6-158">Not supported</span></span>|<span data-ttu-id="305d6-159">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-159">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-160">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="305d6-160">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="305d6-161">支持<sup>6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-161">Supported<sup>6</sup></span></span>|<span data-ttu-id="305d6-162">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-162">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-163">支持<sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-163">Supported<sup>4</sup></span></span>|<span data-ttu-id="305d6-164">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-164">N/A<sup>2</sup></span></span>|  
|<span data-ttu-id="305d6-165">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="305d6-165">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="305d6-166">支持<sup>3,6</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-166">Supported<sup>3,6</sup></span></span>|<span data-ttu-id="305d6-167">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-167">N/A<sup>2</sup></span></span>|<span data-ttu-id="305d6-168">空值</span><span class="sxs-lookup"><span data-stu-id="305d6-168">N/A</span></span>|<span data-ttu-id="305d6-169">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="305d6-169">N/A<sup>2</sup></span></span>|  
  
 <span data-ttu-id="305d6-170"><sup>1</sup>如果使用 ICommandWithParameters::SetParameterInfo 指定 DBTYPE_UDT 之外的服务器类型，而取值函数类型为 DBTYPE_UDT，则执行该语句时将出错（DB_E_ERRORSOCCURRED；参数状态为 DBSTATUS_E_BADACCESSOR）\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-170"><sup>1</sup>If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED; the parameter status is DBSTATUS_E_BADACCESSOR).</span></span> <span data-ttu-id="305d6-171">否则，数据发送到服务器，但服务器会返回错误，指明不存在将 UDT 转换为参数的数据类型的隐式转换。</span><span class="sxs-lookup"><span data-stu-id="305d6-171">Otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from UDT to the parameter's data type.</span></span>  
  
 <span data-ttu-id="305d6-172"><sup>2</sup>超出了本主题的范围。</span><span class="sxs-lookup"><span data-stu-id="305d6-172"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="305d6-173"><sup>3</sup>从十六进制字符串转换为二进制数据。</span><span class="sxs-lookup"><span data-stu-id="305d6-173"><sup>3</sup> Data conversion from hex string to binary data occurs.</span></span>  
  
 <span data-ttu-id="305d6-174"><sup>4</sup>从二进制数据转换为十六进制字符串。</span><span class="sxs-lookup"><span data-stu-id="305d6-174"><sup>4</sup> Data conversion from binary data to hex string occurs.</span></span>  
  
 <span data-ttu-id="305d6-175"><sup>5</sup>可能在创建取值函数时或在提取时执行验证，错误为 DB_E_ERRORSOCCURRED，且绑定状态设置为 DBBINDSTATUS_UNSUPPORTEDCONVERSION。</span><span class="sxs-lookup"><span data-stu-id="305d6-175"><sup>5</sup>Validation can occur at create accessor time, or at fetch time, the error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="305d6-176"><sup>6</sup>可使用 BY_REF。</span><span class="sxs-lookup"><span data-stu-id="305d6-176"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="305d6-177">可绑定 DBTYPE_NULL 和 DBTYPE_EMPTY 用于输入参数，但不能用于输出参数或结果。</span><span class="sxs-lookup"><span data-stu-id="305d6-177">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="305d6-178">为输入参数进行绑定时，状态必须设置为 DBSTATUS_S_ISNULL 或 DBSTATUS_S_DEFAULT。</span><span class="sxs-lookup"><span data-stu-id="305d6-178">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="305d6-179">还可以将 DBTYPE_UDT 转换为 DBTYPE_EMPTY 和 DBTYPE_NULL，但无法将 DBTYPE_NULL 和 DBTYPE_EMPTY 转换为 DBTYPE_UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-179">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL, but DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="305d6-180">这与 DBTYPE_BYTES 的情况是一致的。</span><span class="sxs-lookup"><span data-stu-id="305d6-180">This is consistent with DBTYPE_BYTES.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="305d6-181">借助继承自 ICommandWithParameters 的新接口 ISSCommandWithParameters，可将 UDT 当作参数处理\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-181">A new interface is used for dealing with UDTs as parameters, **ISSCommandWithParameters**, which inherits from **ICommandWithParameters**.</span></span> <span data-ttu-id="305d6-182">应用程序必须使用此接口为 UDT 参数至少设置 DBPROPSET_SQLSERVERPARAMETER 属性集的 SSPROP_PARAM_UDT_NAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-182">Applications must use this interface to set at least the SSPROP_PARAM_UDT_NAME of the DBPROPSET_SQLSERVERPARAMETER property set for UDT parameters.</span></span> <span data-ttu-id="305d6-183">否则，ICommand::Execute 将返回 DB_E_ERRORSOCCURRED\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-183">If this is not done, **ICommand::Execute** will return DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="305d6-184">此接口和属性集将在本主题的下文中介绍。</span><span class="sxs-lookup"><span data-stu-id="305d6-184">This interface and property set is described later in this topic.</span></span>  
  
 <span data-ttu-id="305d6-185">如果在某列中插入用户定义类型，而该列的大小不足以包含该类型的所有数据，则 ICommand::Execute 将返回 S_OK，且状态为 DB_E_ERRORSOCCURRED\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-185">If a user-defined type is inserted into a column that is not large enough to hold all its data, **ICommand::Execute** will return S_OK with a status of DB_E_ERRORSOCCURRED.</span></span>  
  
 <span data-ttu-id="305d6-186">OLE DB 核心服务 (IDataConvert) 提供的数据转换不适用于 DBTYPE_UDT\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-186">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span> <span data-ttu-id="305d6-187">不支持其他绑定。</span><span class="sxs-lookup"><span data-stu-id="305d6-187">No other bindings are supported.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="305d6-188">OLE DB 行集的添加和更改内容</span><span class="sxs-lookup"><span data-stu-id="305d6-188">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="305d6-189">Native Client 将新值或更改添加到许多核心 OLE DB 架构行集。</span><span class="sxs-lookup"><span data-stu-id="305d6-189">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-procedure_parameters-schema-rowset"></a><span data-ttu-id="305d6-190">PROCEDURE_PARAMETERS 架构行集</span><span class="sxs-lookup"><span data-stu-id="305d6-190">The PROCEDURE_PARAMETERS Schema Rowset</span></span>  
 <span data-ttu-id="305d6-191">在 PROCEDURE_PARAMETERS 架构行集中添加了以下内容。</span><span class="sxs-lookup"><span data-stu-id="305d6-191">The following additions have been made to the PROCEDURE_PARAMETERS schema rowset.</span></span>  
  
|<span data-ttu-id="305d6-192">列名称</span><span class="sxs-lookup"><span data-stu-id="305d6-192">Column name</span></span>|<span data-ttu-id="305d6-193">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-193">Type</span></span>|<span data-ttu-id="305d6-194">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-194">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-195">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-195">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-196">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-196">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-197">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-197">The three-part name identifier.</span></span>|  
|<span data-ttu-id="305d6-198">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-198">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-199">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-199">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-200">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-200">The three-part name identifier.</span></span>|  
|<span data-ttu-id="305d6-201">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-201">SS_UDT_NAME</span></span>|<span data-ttu-id="305d6-202">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-202">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-203">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-203">The three-part name identifier.</span></span>|  
|<span data-ttu-id="305d6-204">SS_UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="305d6-204">SS_UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="305d6-205">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-205">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-206">程序集限定名，其中包括 CLR 引用所需的类型名称和所有程序集标识。</span><span class="sxs-lookup"><span data-stu-id="305d6-206">The Assembly Qualified Name, which includes the type name and all the assembly identification necessary to be referenced by the CLR.</span></span>|  
  
#### <a name="the-sql_assemblies-schema-rowset"></a><span data-ttu-id="305d6-207">SQL_ASSEMBLIES 架构行集</span><span class="sxs-lookup"><span data-stu-id="305d6-207">The SQL_ASSEMBLIES Schema Rowset</span></span>  
 <span data-ttu-id="305d6-208">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序公开了一种特定于访问接口的新架构行集，用于描述已注册的 udt。</span><span class="sxs-lookup"><span data-stu-id="305d6-208">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes a new provider specific schema rowset that describes the registered UDTs.</span></span> <span data-ttu-id="305d6-209">可以将 ASSEMBLY 服务器指定为 DBTYPE_WSTR，但它在行集中不存在。</span><span class="sxs-lookup"><span data-stu-id="305d6-209">The ASSEMBLY server may be specified as a DBTYPE_WSTR, but is not present in the rowset.</span></span> <span data-ttu-id="305d6-210">如果未指定，行集将默认使用当前服务器。</span><span class="sxs-lookup"><span data-stu-id="305d6-210">If not specified, the rowset will default to the current server.</span></span> <span data-ttu-id="305d6-211">下表中定义了 SQL_ASSEMBLIES 架构行集。</span><span class="sxs-lookup"><span data-stu-id="305d6-211">The SQL_ASSEMBLIES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="305d6-212">列名称</span><span class="sxs-lookup"><span data-stu-id="305d6-212">Column name</span></span>|<span data-ttu-id="305d6-213">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-213">Type</span></span>|<span data-ttu-id="305d6-214">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-214">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-215">ASSEMBLY_CATALOG</span><span class="sxs-lookup"><span data-stu-id="305d6-215">ASSEMBLY_CATALOG</span></span>|<span data-ttu-id="305d6-216">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-216">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-217">包含该类型的程序集的目录名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-217">The catalog name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="305d6-218">ASSEMBLY_SCHEMA</span><span class="sxs-lookup"><span data-stu-id="305d6-218">ASSEMBLY_SCHEMA</span></span>|<span data-ttu-id="305d6-219">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-219">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-220">包含该类型的程序集的架构名称或所有者名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-220">The schema name, or owner name, of the assembly that contains the type.</span></span> <span data-ttu-id="305d6-221">尽管程序集的作用域为数据库而不是架构，但它们仍具有在此所反映的所有者。</span><span class="sxs-lookup"><span data-stu-id="305d6-221">Although assemblies are scoped by database and not by schema, they still have an owner which is reflected here.</span></span>|  
|<span data-ttu-id="305d6-222">ASSEMBLY_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-222">ASSEMBLY_NAME</span></span>|<span data-ttu-id="305d6-223">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-223">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-224">包含该类型的程序集的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-224">The name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="305d6-225">ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="305d6-225">ASSEMBLY_ID</span></span>|<span data-ttu-id="305d6-226">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="305d6-226">DBTYPE_UI4</span></span>|<span data-ttu-id="305d6-227">包含该类型的程序集的对象 ID。</span><span class="sxs-lookup"><span data-stu-id="305d6-227">The object id of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="305d6-228">PERMISSION_SET</span><span class="sxs-lookup"><span data-stu-id="305d6-228">PERMISSION_SET</span></span>|<span data-ttu-id="305d6-229">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-229">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-230">指示程序集的访问范围的值。</span><span class="sxs-lookup"><span data-stu-id="305d6-230">A value that indicates the scope of access for the assembly.</span></span> <span data-ttu-id="305d6-231">这些值包括“SAFE”、“EXTERNAL_ACCESS”和“UNSAFE”。</span><span class="sxs-lookup"><span data-stu-id="305d6-231">Values include "SAFE", "EXTERNAL_ACCESS", and "UNSAFE".</span></span>|  
|<span data-ttu-id="305d6-232">ASSEMBLY_BINARY</span><span class="sxs-lookup"><span data-stu-id="305d6-232">ASSEMBLY_BINARY</span></span>|<span data-ttu-id="305d6-233">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="305d6-233">DBTYPE_BYTES</span></span>|<span data-ttu-id="305d6-234">程序集的二进制表示形式。</span><span class="sxs-lookup"><span data-stu-id="305d6-234">The binary representation of the assembly.</span></span>|  
  
#### <a name="the-sql_assemblies_-dependencies-schema-rowset"></a><span data-ttu-id="305d6-235">SQL_ASSEMBLIES_ DEPENDENCIES 架构行集</span><span class="sxs-lookup"><span data-stu-id="305d6-235">The SQL_ASSEMBLIES_ DEPENDENCIES Schema Rowset</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="305d6-236">Native Client OLE DB 提供程序公开了特定于提供程序的架构行集，用于描述指定服务器的程序集依赖项。</span><span class="sxs-lookup"><span data-stu-id="305d6-236">Native Client OLE DB provider exposes a new provider-specific schema rowset that describes the assembly dependencies for a specified server.</span></span> <span data-ttu-id="305d6-237">ASSEMBLY_SERVER 可由调用方指定为 DBTYPE_WSTR，但在该行集中不存在。</span><span class="sxs-lookup"><span data-stu-id="305d6-237">ASSEMBLY_SERVER may be specified by the caller as a DBTYPE_WSTR, but is not present in the rowset.</span></span> <span data-ttu-id="305d6-238">如果未指定，行集将默认使用当前服务器。</span><span class="sxs-lookup"><span data-stu-id="305d6-238">If not specified, the rowset will default to the current server.</span></span> <span data-ttu-id="305d6-239">SQL_ASSEMBLY_DEPENDENCIES 架构行集在下表中定义。</span><span class="sxs-lookup"><span data-stu-id="305d6-239">The SQL_ASSEMBLY_DEPENDENCIES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="305d6-240">列名称</span><span class="sxs-lookup"><span data-stu-id="305d6-240">Column name</span></span>|<span data-ttu-id="305d6-241">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-241">Type</span></span>|<span data-ttu-id="305d6-242">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-242">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-243">ASSEMBLY_CATALOG</span><span class="sxs-lookup"><span data-stu-id="305d6-243">ASSEMBLY_CATALOG</span></span>|<span data-ttu-id="305d6-244">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-244">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-245">包含该类型的程序集的目录名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-245">The catalog name of the assembly that contains the type.</span></span>|  
|<span data-ttu-id="305d6-246">ASSEMBLY_SCHEMA</span><span class="sxs-lookup"><span data-stu-id="305d6-246">ASSEMBLY_SCHEMA</span></span>|<span data-ttu-id="305d6-247">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-247">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-248">包含该类型的程序集的架构名称或所有者名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-248">The schema name, or owner name, of the assembly that contains the type.</span></span> <span data-ttu-id="305d6-249">尽管程序集的作用域为数据库而不是架构，但它们仍具有在此所反映的所有者。</span><span class="sxs-lookup"><span data-stu-id="305d6-249">Although assemblies are scoped by database and not by schema, they still have an owner, which is reflected here.</span></span>|  
|<span data-ttu-id="305d6-250">ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="305d6-250">ASSEMBLY_ID</span></span>|<span data-ttu-id="305d6-251">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="305d6-251">DBTYPE_UI4</span></span>|<span data-ttu-id="305d6-252">程序集的对象 ID。</span><span class="sxs-lookup"><span data-stu-id="305d6-252">The object id of the assembly.</span></span>|  
|<span data-ttu-id="305d6-253">REFERENCED_ASSEMBLY_ID</span><span class="sxs-lookup"><span data-stu-id="305d6-253">REFERENCED_ASSEMBLY_ID</span></span>|<span data-ttu-id="305d6-254">DBTYPE_UI4</span><span class="sxs-lookup"><span data-stu-id="305d6-254">DBTYPE_UI4</span></span>|<span data-ttu-id="305d6-255">所引用的程序集的对象 ID。</span><span class="sxs-lookup"><span data-stu-id="305d6-255">The object id of the referenced assembly.</span></span>|  
  
#### <a name="the-sql_user_types-schema-rowset"></a><span data-ttu-id="305d6-256">SQL_USER_TYPES 架构行集</span><span class="sxs-lookup"><span data-stu-id="305d6-256">The SQL_USER_TYPES Schema Rowset</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="305d6-257">Native Client OLE DB 提供程序公开新的架构行集，SQL_USER_TYPES，用于描述何时添加指定服务器的注册 Udt。</span><span class="sxs-lookup"><span data-stu-id="305d6-257">Native Client OLE DB provider exposes new schema rowset, SQL_USER_TYPES, that describes when the registered UDTs for a specified server is added.</span></span> <span data-ttu-id="305d6-258">UDT_SERVER 必须由调用方指定为 DBTYPE_WSTR，但它在该行集中不存在。</span><span class="sxs-lookup"><span data-stu-id="305d6-258">UDT_SERVER must be specified as a DBTYPE_WSTR by the caller but is not present in the rowset.</span></span> <span data-ttu-id="305d6-259">在下表中定义 SQL_USER_TYPES 架构行集。</span><span class="sxs-lookup"><span data-stu-id="305d6-259">The SQL_USER_TYPES schema rowset is defined in the following table.</span></span>  
  
|<span data-ttu-id="305d6-260">列名称</span><span class="sxs-lookup"><span data-stu-id="305d6-260">Column name</span></span>|<span data-ttu-id="305d6-261">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-261">Type</span></span>|<span data-ttu-id="305d6-262">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-262">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-263">UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-263">UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-265">对于 UDT 列，此属性是一个字符串，它指定定义 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-265">For UDT columns this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-266">UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-266">UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-267">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-267">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-268">对于 UDT 列，此属性是一个字符串，它指定定义 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-268">For UDT columns this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-269">UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-269">UDT_NAME</span></span>|<span data-ttu-id="305d6-270">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-270">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-271">包含 UDT 类的程序集的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-271">The name of the assembly containing the UDT class.</span></span>|  
|<span data-ttu-id="305d6-272">UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="305d6-272">UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="305d6-273">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-273">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-274">完整类型名称 (AQN) 包括带有命名空间前缀（如果适用）的类型名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-274">Full type name (AQN) includes type name prefixed by namespace if applicable.</span></span>|  
  
#### <a name="the-columns-schema-rowset"></a><span data-ttu-id="305d6-275">COLUMNS 架构行集</span><span class="sxs-lookup"><span data-stu-id="305d6-275">The COLUMNS Schema Rowset</span></span>  
 <span data-ttu-id="305d6-276">COLUMNS 架构行集添加了以下列。</span><span class="sxs-lookup"><span data-stu-id="305d6-276">Additions to the COLUMNS schema rowset include the following columns.</span></span>  
  
|<span data-ttu-id="305d6-277">列名称</span><span class="sxs-lookup"><span data-stu-id="305d6-277">Column name</span></span>|<span data-ttu-id="305d6-278">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-278">Type</span></span>|<span data-ttu-id="305d6-279">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-279">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-280">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-280">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-281">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-281">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-282">对于 UDT 列，此属性是一个字符串，它指定定义 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-282">For UDT columns this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-283">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-283">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-284">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-284">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-285">对于 UDT 列，此属性是一个字符串，它指定定义 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-285">For UDT columns this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-286">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-286">SS_UDT_NAME</span></span>|<span data-ttu-id="305d6-287">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-287">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-288">UDT 的名称</span><span class="sxs-lookup"><span data-stu-id="305d6-288">The name of the UDT</span></span>|  
|<span data-ttu-id="305d6-289">SS_UDT_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="305d6-289">SS_UDT_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="305d6-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-291">完整类型名称 (AQN) 包括带有命名空间前缀（如果适用）的类型名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-291">Full type name (AQN) includes type name prefixed by namespace if applicable.</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="305d6-292">OLE DB 属性集的添加和更改内容</span><span class="sxs-lookup"><span data-stu-id="305d6-292">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="305d6-293">Native Client 向许多 core OLE DB 属性集添加新值或更改。</span><span class="sxs-lookup"><span data-stu-id="305d6-293">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="305d6-294">DBPROPSET_SQLSERVERPARAMETER 属性集</span><span class="sxs-lookup"><span data-stu-id="305d6-294">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="305d6-295">为了通过 OLE DB 支持 Udt， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 实现了新的 DBPROPSET_SQLSERVERPARAMETER 属性集，该属性集包含以下值。</span><span class="sxs-lookup"><span data-stu-id="305d6-295">In order to support UDTs through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set which contains the following values.</span></span>  
  
|<span data-ttu-id="305d6-296">名称</span><span class="sxs-lookup"><span data-stu-id="305d6-296">Name</span></span>|<span data-ttu-id="305d6-297">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-297">Type</span></span>|<span data-ttu-id="305d6-298">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-298">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="305d6-299">SSPROP_PARAM_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-299">SSPROP_PARAM_UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-300">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-300">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-301">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-301">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="305d6-302">对于 UDT 参数，此属性是一个字符串，它指定定义用户定义类型的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-302">For UDT parameters, this property is a string that specifies the name of the catalog where the user-defined type is defined.</span></span>|  
|<span data-ttu-id="305d6-303">SSPROP_PARAM_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-303">SSPROP_PARAM_UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-304">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-304">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-305">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-305">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="305d6-306">对于 UDT 参数，此属性是一个字符串，它指定定义用户定义类型的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-306">For UDT parameters, this property is a string that specifies the name of the schema where the user-defined type is defined.</span></span>|  
|<span data-ttu-id="305d6-307">SSPROP_PARAM_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-307">SSPROP_PARAM_UDT_NAME</span></span>|<span data-ttu-id="305d6-308">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-308">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-309">由三部分组成的名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-309">The three-part name identifier.</span></span><br /><br /> <span data-ttu-id="305d6-310">对于 UDT 列，此属性是一个字符串，它指定仅由一个部分组成的用户定义类型名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-310">For UDT columns, this property is a string that specifies the single part name of the user-defined type.</span></span>|  
  
 <span data-ttu-id="305d6-311">SSPROP_PARAM_UDT_NAME 是必需的。</span><span class="sxs-lookup"><span data-stu-id="305d6-311">SSPROP_PARAM_UDT_NAME is mandatory.</span></span> <span data-ttu-id="305d6-312">SSPROP_PARAM_UDT_CATALOGNAME 和 SSPROP_PARAM_UDT_SCHEMANAME 是可选的。</span><span class="sxs-lookup"><span data-stu-id="305d6-312">SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME are optional.</span></span> <span data-ttu-id="305d6-313">如果任何属性指定有误，将返回 DB_E_ERRORSINCOMMAND。</span><span class="sxs-lookup"><span data-stu-id="305d6-313">If any of the properties are specified incorrectly DB_E_ERRORSINCOMMAND will be returned.</span></span> <span data-ttu-id="305d6-314">如果未指定 SSPROP_PARAM_UDT_CATALOGNAME 和 SSPROP_PARAM_UDT_SCHEMANAME，则必须在定义表的同一数据库和架构中定义 UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-314">If both SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME are not specified, then the UDT must be defined in the same database and schema as the table.</span></span> <span data-ttu-id="305d6-315">如果 UDT 定义没有位于表所在的架构中（但位于相同的数据库中），则必须指定 SSPROP_PARAM_UDT_SCHEMANAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-315">If the UDT definition is not in the same schema as the table (but is in the same database), then SSPROP_PARAM_UDT_SCHEMANAME must be specified.</span></span> <span data-ttu-id="305d6-316">如果 UDT 定义位于不同的数据库中，则必须指定 SSPROP_PARAM_UDT_CATALOGNAME 和 SSPROP_PARAM_UDT_SCHEMANAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-316">If the UDT definition is in a different database then both SSPROP_PARAM_UDT_CATALOGNAME and SSPROP_PARAM_UDT_SCHEMANAME must be specified.</span></span>  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="305d6-317">DBPROPSET_SQLSERVERCOLUMN 属性集</span><span class="sxs-lookup"><span data-stu-id="305d6-317">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="305d6-318">为了支持在**ITableDefinition**接口中创建表， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 将以下三个新列添加到 DBPROPSET_SQLSERVERCOLUMN 属性集。</span><span class="sxs-lookup"><span data-stu-id="305d6-318">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds the following three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="305d6-319">名称</span><span class="sxs-lookup"><span data-stu-id="305d6-319">Name</span></span>|<span data-ttu-id="305d6-320">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-320">Description</span></span>|<span data-ttu-id="305d6-321">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-321">Type</span></span>|<span data-ttu-id="305d6-322">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-322">Description</span></span>|  
|----------|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-323">SSPROP_COL_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-323">SSPROP_COL_UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-324">UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-324">UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-325">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-325">VT_BSTR</span></span>|<span data-ttu-id="305d6-326">对于 DBTYPE_UDT 类型的列，此属性是一个字符串，它指定定义 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-326">For columns of type DBTYPE_UDT, this property is a string specifying the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-327">SSPROP_COL_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-327">SSPROP_COL_UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-328">UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-328">UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-329">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-329">VT_BSTR</span></span>|<span data-ttu-id="305d6-330">对于 DBTYPE_UDT 类型的列，此属性是一个字符串，它指定定义 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-330">For columns of type DBTYPE_UDT, this property is a string specifying the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="305d6-331">SSPROP_COL_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-331">SSPROP_COL_UDT_NAME</span></span>|<span data-ttu-id="305d6-332">UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-332">UDT_NAME</span></span>|<span data-ttu-id="305d6-333">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-333">VT_BSTR</span></span>|<span data-ttu-id="305d6-334">对于 DBTYPE_UDT 类型的列，此属性是一个字符串，它指定仅由一个部分组成的 UDT 名称。</span><span class="sxs-lookup"><span data-stu-id="305d6-334">For columns of type DBTYPE_UDT, this property is a string specifying the single part name of the UDT.</span></span> <span data-ttu-id="305d6-335">对于其他列类型，此属性返回空字符串。</span><span class="sxs-lookup"><span data-stu-id="305d6-335">For other column types, this property returns an empty string.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="305d6-336">UDT 不出现在 PROVIDER_TYPES 架构行集中。</span><span class="sxs-lookup"><span data-stu-id="305d6-336">UDTs do not appear in the PROVIDER_TYPES schema rowset.</span></span> <span data-ttu-id="305d6-337">所有列都具有读写访问权限。</span><span class="sxs-lookup"><span data-stu-id="305d6-337">All columns have read and write access.</span></span>  
  
 <span data-ttu-id="305d6-338">ADO 将通过使用“说明”列中的相应条目引用这些属性。</span><span class="sxs-lookup"><span data-stu-id="305d6-338">ADO will refer to these properties by using the corresponding entry in the Description column.</span></span>  
  
 <span data-ttu-id="305d6-339">SSPROP_COL_UDTNAME 是必需的。</span><span class="sxs-lookup"><span data-stu-id="305d6-339">SSPROP_COL_UDTNAME is mandatory.</span></span> <span data-ttu-id="305d6-340">SSPROP_COL_UDT_CATALOGNAME 和 SSPROP_COL_UDT_SCHEMANAME 是可选的。</span><span class="sxs-lookup"><span data-stu-id="305d6-340">SSPROP_COL_UDT_CATALOGNAME and SSPROP_COL_UDT_SCHEMANAME are optional.</span></span> <span data-ttu-id="305d6-341">如果任何属性指定有误，将返回 `DB_E_ERRORSINCOMMAND`。</span><span class="sxs-lookup"><span data-stu-id="305d6-341">If any of the properties are specified incorrectly, `DB_E_ERRORSINCOMMAND` will be returned.</span></span>  
  
 <span data-ttu-id="305d6-342">如果既未指定 SSPROP_COL_UDT_CATALOGNAME 也未指定 SSPROP_COL_UDT_SCHEMANAME，则必须在定义表的同一数据库和架构中定义 UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-342">If neither SSPROP_COL_UDT_CATALOGNAME nor SSPROP_COL_UDT_SCHEMANAME is specified, the UDT must be defined in the same database and schema as the table.</span></span>  
  
 <span data-ttu-id="305d6-343">如果 UDT 定义没有与表位于同一架构中（但位于同一数据库中），则必须指定 SSPROP_COL_UDT_SCHEMANAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-343">If the UDT definition is not in the same schema as the table (but is in the same database), SSPROP_COL_UDT_SCHEMANAME must be specified.</span></span>  
  
 <span data-ttu-id="305d6-344">如果 UDT 定义位于不同的数据库中，则必须指定 SSPROP_COL_UDT_CATALOGNAME 和 SSPROP_COL_UDT_SCHEMANAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-344">If the UDT definition is in a different database, both SSPROP_COL_UDT_CATALOGNAME and SSPROP_COL_UDT_SCHEMANAME must be specified.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="305d6-345">OLE DB 接口的添加和更改内容</span><span class="sxs-lookup"><span data-stu-id="305d6-345">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="305d6-346">Native Client 将新值或更改添加到许多核心 OLE DB 接口。</span><span class="sxs-lookup"><span data-stu-id="305d6-346">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="305d6-347">ISSCommandWithParameters 接口</span><span class="sxs-lookup"><span data-stu-id="305d6-347">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="305d6-348">为了通过 OLE DB 支持 Udt， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 实现了许多更改，包括添加**ISSCommandWithParameters**接口。</span><span class="sxs-lookup"><span data-stu-id="305d6-348">To support UDTs through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes, including the addition of the **ISSCommandWithParameters** interface.</span></span> <span data-ttu-id="305d6-349">这一新接口继承自核心 OLE DB 接口 ICommandWithParameters\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-349">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="305d6-350">除了从**ICommandWithParameters**继承的三个方法;**GetParameterInfo**、 **MapParameterNames**和**SetParameterInfo**;**ISSCommandWithParameters**提供了用于处理服务器特定数据类型的**GetParameterProperties**和**SetParameterProperties**方法。</span><span class="sxs-lookup"><span data-stu-id="305d6-350">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the **GetParameterProperties** and **SetParameterProperties** methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="305d6-351">ISSCommandWithParameters 接口也利用新的 SSPARAMPROPS 结构\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="305d6-351">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="305d6-352">IColumnsRowset 接口</span><span class="sxs-lookup"><span data-stu-id="305d6-352">The IColumnsRowset Interface</span></span>  
 <span data-ttu-id="305d6-353">除了**ISSCommandWithParameters**接口以外， [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 还会向从调用**IColumnsRowset：： GetColumnRowset**方法返回的行集添加新值，包括以下内容。</span><span class="sxs-lookup"><span data-stu-id="305d6-353">In addition to the **ISSCommandWithParameters** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client also adds new values to the rowset returned from calling the **IColumnsRowset::GetColumnRowset** method including the following.</span></span>  
  
|<span data-ttu-id="305d6-354">列名</span><span class="sxs-lookup"><span data-stu-id="305d6-354">Column Name</span></span>|<span data-ttu-id="305d6-355">类型</span><span class="sxs-lookup"><span data-stu-id="305d6-355">Type</span></span>|<span data-ttu-id="305d6-356">说明</span><span class="sxs-lookup"><span data-stu-id="305d6-356">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="305d6-357">DBCOLUMN_SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="305d6-357">DBCOLUMN_SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="305d6-358">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-358">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-359">UDT 目录名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-359">A UDT catalog name identifier.</span></span>|  
|<span data-ttu-id="305d6-360">DBCOLUMN_SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="305d6-360">DBCOLUMN_SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="305d6-361">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-361">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-362">UDT 架构名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-362">A UDT schema name identifier.</span></span>|  
|<span data-ttu-id="305d6-363">DBCOLUMN_SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="305d6-363">DBCOLUMN_SS_UDT_NAME</span></span>|<span data-ttu-id="305d6-364">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-364">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-365">UDT 名称标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-365">A UDT name identifier.</span></span>|  
|<span data-ttu-id="305d6-366">DBCOLUMN_SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="305d6-366">DBCOLUMN_SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="305d6-367">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="305d6-367">DBTYPE_WSTR</span></span>|<span data-ttu-id="305d6-368">程序集限定名，其中包括 CLR 引用所需的类型名称和所有程序集标识。</span><span class="sxs-lookup"><span data-stu-id="305d6-368">The assembly qualified name, which includes the type name and all the assembly identification necessary to be referenced by the CLR.</span></span>|  
  
 <span data-ttu-id="305d6-369">通过查看上面指定的添加的 UDT 元数据，可以在 DBCOLUMN_TYPE 设置为 DBTYPE_UDT 时将服务器 UDT 列与其他二进制类型区分开。</span><span class="sxs-lookup"><span data-stu-id="305d6-369">You can differentiate a server UDT column from other binary types when the DBCOLUMN_TYPE is set to DBTYPE_UDT by looking at the added UDT metadata specified above.</span></span> <span data-ttu-id="305d6-370">如果该数据不完整，服务器类型为 UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-370">If that data is partially complete, the server type is a UDT.</span></span> <span data-ttu-id="305d6-371">对于非 UDT 服务器类型，这些列的返回结果始终为 NULL。</span><span class="sxs-lookup"><span data-stu-id="305d6-371">For non-UDT server types, these columns are always returned as NULL.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="305d6-372">SQL Server Native Client ODBC 驱动程序</span><span class="sxs-lookup"><span data-stu-id="305d6-372">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="305d6-373">在 Native Client ODBC 驱动程序中进行了多项更改 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，以支持 udt。</span><span class="sxs-lookup"><span data-stu-id="305d6-373">A number of changes have been made in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver to support UDTs.</span></span> <span data-ttu-id="305d6-374">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序将 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT 映射到 SQL_SS_UDT 驱动程序特定的 SQL 数据类型标识符。</span><span class="sxs-lookup"><span data-stu-id="305d6-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maps the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] UDT to SQL_SS_UDT driver-specific SQL data type identifier.</span></span> <span data-ttu-id="305d6-375">UDT 列呈现为 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-375">UDT columns are surfaced as SQL_SS_UDT.</span></span> <span data-ttu-id="305d6-376">如果通过使用 UDT 的**ToString**或**ToXMLString**方法或通过**CAST/CONVERT**函数，在 SQL 语句中将 udt 列显式映射到另一种类型，则结果集中列的类型将反映该列转换为的实际类型。</span><span class="sxs-lookup"><span data-stu-id="305d6-376">If you map a UDT column explicitly to another type in a SQL statement by using the **ToString** or **ToXMLString** methods of the UDT or via the **CAST/CONVERT** function, the type of the column in the result set reflects the actual type the column was converted to</span></span>  
  
### <a name="sqlcolattribute-sqldescribeparam-sqlgetdescfield"></a><span data-ttu-id="305d6-377">SQLColAttribute、SQLDescribeParam、SQLGetDescField</span><span class="sxs-lookup"><span data-stu-id="305d6-377">SQLColAttribute, SQLDescribeParam, SQLGetDescField</span></span>  
 <span data-ttu-id="305d6-378">添加了四个新的驱动程序特定的描述符字段，以提供要通过[SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md)、 [SQLDescribeParam](../../native-client-odbc-api/sqldescribeparam.md)和[SQLGetDescField](../../native-client-odbc-api/sqlgetdescfield.md)函数检索的结果集或存储过程/参数化查询的 udt 参数的附加信息。</span><span class="sxs-lookup"><span data-stu-id="305d6-378">Four new driver-specific descriptor fields have been added to provide additional information for either a UDT column of a result set, or a UDT parameter of stored procedure/parameterized query, to be retrieved via the [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md), [SQLDescribeParam](../../native-client-odbc-api/sqldescribeparam.md), and [SQLGetDescField](../../native-client-odbc-api/sqlgetdescfield.md) functions.</span></span>  
  
 <span data-ttu-id="305d6-379">这四个新添加的描述符字段分别为 SQL_CA_SS_UDT_CATALOG_NAME、SQL_CA_SS_UDT_SCHEMA_NAME、SQL_CA_SS_UDT_TYPE_NAME 和 SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-379">The four new descriptor fields that have been added are SQL_CA_SS_UDT_CATALOG_NAME, SQL_CA_SS_UDT_SCHEMA_NAME, SQL_CA_SS_UDT_TYPE_NAME, and SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME.</span></span>  
  
### <a name="sqlcolumns-sqlprocedurecolumns"></a><span data-ttu-id="305d6-380">SQLColumns、SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="305d6-380">SQLColumns, SQLProcedureColumns</span></span>  
 <span data-ttu-id="305d6-381">此外，将向[SQLColumns](../../native-client-odbc-api/sqlcolumns.md)和[SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md)函数返回的结果集中添加三个新的驱动程序特定列，以提供有关 udt 结果集列或 udt 参数的其他信息。</span><span class="sxs-lookup"><span data-stu-id="305d6-381">In addition, three new driver specific columns are added to the result set returned from the [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) and [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) functions to provide additional information about either a UDT result set column or a UDT parameter.</span></span> <span data-ttu-id="305d6-382">这三个新列分别为 SS_UDT_CATALOG_NAME、SS_UDT_SCHEMA_NAME 和 SS_UDT_ASSEMBLY_TYPE_NAME。</span><span class="sxs-lookup"><span data-stu-id="305d6-382">These three new columns are SS_UDT_CATALOG_NAME, SS_UDT_SCHEMA_NAME, and SS_UDT_ASSEMBLY_TYPE_NAME.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="305d6-383">支持的转换</span><span class="sxs-lookup"><span data-stu-id="305d6-383">Supported Conversions</span></span>  
 <span data-ttu-id="305d6-384">从 SQL 转换为 C 数据类型时，SQL_C_WCHAR、SQL_C_BINARY 和 SQL_C_CHAR 可全部转换为 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-384">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_UDT.</span></span> <span data-ttu-id="305d6-385">不过请注意，从 SQL_C_WCHAR 和 SQL_C_CHAR SQL 数据类型转换时，二进制数据将转换为十六进制字符串。</span><span class="sxs-lookup"><span data-stu-id="305d6-385">Note, however, that binary data is converted to a hex string when converting from the SQL_C_WCHAR and SQL_C_CHAR SQL data types.</span></span>  
  
 <span data-ttu-id="305d6-386">从 C 转换为 SQL 数据类型时，SQL_C_WCHAR、SQL_C_BINARY 和 SQL_C_CHAR 可全部转换为 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="305d6-386">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_UDT.</span></span> <span data-ttu-id="305d6-387">但请注意，从 SQL_C_WCHAR 和 SQL_C_CHAR SQL 数据类型转换时，二进制数据会转换为十六进制字符串。</span><span class="sxs-lookup"><span data-stu-id="305d6-387">Note however that binary data is converted to a hex string when converting from the SQL_C_WCHAR and SQL_C_CHAR SQL data types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="305d6-388">另请参阅</span><span class="sxs-lookup"><span data-stu-id="305d6-388">See Also</span></span>  
 <span data-ttu-id="305d6-389">[SQL Server Native Client 功能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="305d6-389">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="305d6-390">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="305d6-390">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
