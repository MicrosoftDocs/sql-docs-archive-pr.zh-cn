---
title: 日期和时间改进 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 9b1d0d9d-1f6e-4399-8f61-e23f9a486a7a
author: rothja
ms.author: jroth
ms.openlocfilehash: 94f3fb5c00c15912840c494d3a6f6b0b05ea7257
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688875"
---
# <a name="date-and-time-improvements"></a><span data-ttu-id="9e7cc-102">日期和时间改进</span><span class="sxs-lookup"><span data-stu-id="9e7cc-102">Date and Time Improvements</span></span>
  <span data-ttu-id="9e7cc-103">本主题介绍 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client 对于 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 中已添加的日期和时间数据类型的支持。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-103">This topic describes the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support for the date and time data types that were added in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
 <span data-ttu-id="9e7cc-104">有关日期/时间改进的详细信息，请参阅[日期和时间改进 &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)以及[&#40;ODBC&#41;的日期和时间改进](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-104">For more information about date/time improvements, see [Date and Time Improvements &#40;OLE DB&#41;](../../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md) and [Date and Time Improvements &#40;ODBC&#41;](../../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
 <span data-ttu-id="9e7cc-105">有关演示此功能的示例应用程序的信息，请参阅 [SQL Server 数据编程示例](https://msftdpprodsamples.codeplex.com/)。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-105">For information about sample applications that demonstrate this feature, see [SQL Server Data Programming Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="usage"></a><span data-ttu-id="9e7cc-106">使用情况</span><span class="sxs-lookup"><span data-stu-id="9e7cc-106">Usage</span></span>  
 <span data-ttu-id="9e7cc-107">以下各节介绍使用新的日期和时间类型的各种方法。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-107">The following sections describe various ways of using the new date and time types.</span></span>  
  
### <a name="use-date-as-a-distinct-data-type"></a><span data-ttu-id="9e7cc-108">将日期用作非重复数据类型</span><span class="sxs-lookup"><span data-stu-id="9e7cc-108">Use Date as a Distinct Data Type</span></span>  
 <span data-ttu-id="9e7cc-109">从 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 开始，借助于对日期/时间类型的增强支持，可以更高效地使用 SQL_TYPE_DATE ODBC 类型（对于 ODBC 2.0 应用程序为 SQL_DATE）和 DBTYPE_DBDATE OLE DB 类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-109">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], enhanced support for date/time types makes it more efficient to use the SQL_TYPE_DATE ODBC type (SQL_DATE for ODBC 2.0 applications) and the DBTYPE_DBDATE OLE DB type.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type"></a><span data-ttu-id="9e7cc-110">将时间用作非重复数据类型</span><span class="sxs-lookup"><span data-stu-id="9e7cc-110">Use Time as a Distinct Data Type</span></span>  
 <span data-ttu-id="9e7cc-111">OLE DB 已具有一种只包含时间的数据类型 DBTYPE_DBTIME，它的精度为 1 秒。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-111">OLE DB already has a data type that just contains the time, DBTYPE_DBTIME, which has a precision of 1 second.</span></span> <span data-ttu-id="9e7cc-112">在 ODBC 中，等效类型为 SQL_TYPE_TIME（对于 ODBC 2.0 应用程序为 SQL_TIME）。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-112">In ODBC, the equivalent type is SQL_TYPE_TIME (SQL_TIME for ODBC 2.0 applications).</span></span>  
  
 <span data-ttu-id="9e7cc-113">新的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 时间数据类型具有秒的小数形式，其准确度可达 100 纳秒。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-113">The new [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] time data type has fractional seconds accurate to 100 nanoseconds.</span></span> <span data-ttu-id="9e7cc-114">这需要 Native Client 中的新类型 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ： DBTYPE_DBTIME2 (OLE DB) 和 SQL_SS_TIME2 (ODBC) 。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-114">This requires new types in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client: DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span> <span data-ttu-id="9e7cc-115">已编写的所用时间不带秒的小数部分的现有应用程序可以使用 time(0) 列。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-115">Existing applications written to use times with no fractional seconds can use time(0) columns.</span></span> <span data-ttu-id="9e7cc-116">现有的 OLE DB DBTYPE_TIME 和 ODBC SQL_TYPE_TIME 类型及其对应的结构应正常工作，除非应用程序依赖于元数据中返回的类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-116">The existing OLE DB DBTYPE_TIME and ODBC SQL_TYPE_TIME types and their corresponding structs should work correctly, unless the applications rely on the type returned in metadata.</span></span>  
  
### <a name="use-time-as-a-distinct-data-type-with-extended-fractional-seconds-precision"></a><span data-ttu-id="9e7cc-117">将具有扩展的秒的小数部分精度的时间用作非重复数据类型</span><span class="sxs-lookup"><span data-stu-id="9e7cc-117">Use Time as a Distinct Data Type with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="9e7cc-118">某些应用程序（如过程控制和生产应用程序）要求能够处理精度高达 100 纳秒的时间数据。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-118">Some applications, such as process control and manufacturing applications, require the ability to handle time data with a precision of up to 100 nanoseconds.</span></span> <span data-ttu-id="9e7cc-119">可满足这一用途的新类型为 DBTYPE_DBTIME2 (OLE DB) 和 SQL_SS_TIME2 (ODBC)。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-119">New types for this purpose are DBTYPE_DBTIME2 (OLE DB) and SQL_SS_TIME2 (ODBC).</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision"></a><span data-ttu-id="9e7cc-120">使用具有扩展的秒的小数部分精度的日期时间</span><span class="sxs-lookup"><span data-stu-id="9e7cc-120">Use Datetime with Extended Fractional Seconds Precision</span></span>  
 <span data-ttu-id="9e7cc-121">OLE DB 已定义了一个精度高达 1 纳秒的类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-121">OLE DB already defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="9e7cc-122">但是，此类型已由现有的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 应用程序使用，并且此类应用程序预计只需 1/300 秒精度。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-122">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications have an expectation of only 1/300 of a second precision.</span></span> <span data-ttu-id="9e7cc-123">新的 `datetime2(3)` 类型与现有的日期时间类型不直接兼容。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-123">The new `datetime2(3)` type is not directly compatible with the existing datetime type.</span></span> <span data-ttu-id="9e7cc-124">如果这一点将影响应用程序行为而导致风险，则应用程序必须使用新的 DBCOLUMN 标志以确定实际的服务器类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-124">If there is a risk that this will affect application behavior, applications must use a new DBCOLUMN flag to determine the actual server type.</span></span>  
  
 <span data-ttu-id="9e7cc-125">ODBC 还定义了一个精度高达 1 纳秒的类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-125">ODBC also defines a type with a precision of up to 1 nanosecond.</span></span> <span data-ttu-id="9e7cc-126">但是，此类型已由现有的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 应用程序使用，并且此类应用程序预计只需 3 毫秒的精度。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-126">However, this type is already used by existing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] applications and such applications expect only 3 millisecond precision.</span></span> <span data-ttu-id="9e7cc-127">新的 `datetime2(3)` 类型与现有的 `datetime` 类型不直接兼容。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-127">The new `datetime2(3)` type is not  directly compatible with the existing `datetime` type.</span></span> <span data-ttu-id="9e7cc-128">`datetime2(3)` 的精度为一毫秒，而 `datetime` 的精度为 1/300 秒。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-128">`datetime2(3)` has a precision of one millisecond, and `datetime` has a precision of 1/300 of a second.</span></span> <span data-ttu-id="9e7cc-129">在 ODBC 中，应用程序可以确定哪一个服务器类型用于描述符字段 SQL_DESC_TYPE_NAME。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-129">In ODBC, applications can determine which server type is in use with the descriptor field SQL_DESC_TYPE_NAME.</span></span> <span data-ttu-id="9e7cc-130">因此，现有类型 SQL_TYPE_TIMESTAMP（对于 ODBC 2.0 应用程序为 SQL_TIMESTAMP）可用于这两个类型。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-130">Therefore, the existing type SQL_TYPE_TIMESTAMP (SQL_TIMESTAMP for ODBC 2.0 applications) can be used for both types.</span></span>  
  
### <a name="use-datetime-with-extended-fractional-seconds-precision-and-timezone"></a><span data-ttu-id="9e7cc-131">使用具有扩展的秒的小数部分精度和时区的日期时间</span><span class="sxs-lookup"><span data-stu-id="9e7cc-131">Use Datetime with Extended Fractional Seconds Precision and Timezone</span></span>  
 <span data-ttu-id="9e7cc-132">一些应用程序要求带有时区信息的日期时间值。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-132">Some applications require datetime values with timezone information.</span></span> <span data-ttu-id="9e7cc-133">新的 DBTYPE_DBTIMESTAMPOFFSET (OLE DB) 和 SQL_SS_TIMESTAMPOFFSET (ODBC) 类型支持这一要求。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-133">This is supported by the new DBTYPE_DBTIMESTAMPOFFSET (OLE DB) and SQL_SS_TIMESTAMPOFFSET (ODBC) types.</span></span>  
  
### <a name="use-datetimedatetimedatetimeoffset-data-with-client-side-conversions-consistent-with-existing-conversions"></a><span data-ttu-id="9e7cc-134">将 Date/Time/Datetime/Datetimeoffset 数据用于与现有转换一致的客户端转换</span><span class="sxs-lookup"><span data-stu-id="9e7cc-134">Use Date/Time/Datetime/Datetimeoffset Data with Client-Side Conversions Consistent with Existing Conversions</span></span>  
 <span data-ttu-id="9e7cc-135">ODBC 标准描述了如何在现有的日期、时间和时间戳类型之间进行转换。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-135">The ODBC standard describes how conversions between existing date, time, and timestamp types work.</span></span> <span data-ttu-id="9e7cc-136">这些将以一致的方式进行扩展，以包括在 [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)] 中引入的所有日期和时间类型之间的转换。</span><span class="sxs-lookup"><span data-stu-id="9e7cc-136">These are extended in a consistent manner to include conversions between all date and time types introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9e7cc-137">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9e7cc-137">See Also</span></span>  
 [<span data-ttu-id="9e7cc-138">SQL Server Native Client 功能</span><span class="sxs-lookup"><span data-stu-id="9e7cc-138">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
