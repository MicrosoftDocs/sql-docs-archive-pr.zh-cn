---
title: 执行大容量复制操作 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87578862"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="07d56-102">执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="07d56-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="07d56-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 大容量复制功能支持将大量数据传输到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 表或视图中，或从其中传出。</span><span class="sxs-lookup"><span data-stu-id="07d56-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="07d56-104">也可以通过指定 SELECT 语句将数据传出。</span><span class="sxs-lookup"><span data-stu-id="07d56-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="07d56-105">可以在 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 和操作系统的数据文件（比如 ASCII 文件）之间移动数据。</span><span class="sxs-lookup"><span data-stu-id="07d56-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="07d56-106">数据文件可以有不同格式；定义格式是为了对格式文件中的数据进行大容量复制。</span><span class="sxs-lookup"><span data-stu-id="07d56-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="07d56-107">也可以选择将数据加载到程序变量中，然后使用大容量复制函数和方法将数据传输到 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="07d56-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="07d56-108">有关演示此功能的示例应用程序，请参阅[使用 IRowsetFastLoad 大容量复制数据 (OLE DB)](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md)。</span><span class="sxs-lookup"><span data-stu-id="07d56-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="07d56-109">应用程序通常按以下方式之一使用大容量复制：</span><span class="sxs-lookup"><span data-stu-id="07d56-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="07d56-110">从表、视图或 Transact-SQL 语句的结果集，将数据大容量复制到以与该表或视图相同的格式存储数据的数据文件中。</span><span class="sxs-lookup"><span data-stu-id="07d56-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="07d56-111">这称为本机模式数据文件。</span><span class="sxs-lookup"><span data-stu-id="07d56-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="07d56-112">从表、视图或 Transact-SQL 语句的结果集，将数据大容量复制到以不同于该表或视图的格式存储数据的数据文件中。</span><span class="sxs-lookup"><span data-stu-id="07d56-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="07d56-113">这种情况下，将创建一个单独的格式文件，用于定义每个列存储在数据文件中时的特征（数据类型、位置、长度、终止符等等）。</span><span class="sxs-lookup"><span data-stu-id="07d56-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="07d56-114">如果所有列均转换为字符格式，则所产生的文件称为字符模式的数据文件。</span><span class="sxs-lookup"><span data-stu-id="07d56-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="07d56-115">从数据文件大容量复制到表或视图中。</span><span class="sxs-lookup"><span data-stu-id="07d56-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="07d56-116">如果需要，则使用格式文件确定数据文件的布局。</span><span class="sxs-lookup"><span data-stu-id="07d56-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="07d56-117">将数据加载到程序变量中，然后使用大容量复制函数将数据导入表或视图中，以便一次一行执行大容量复制。</span><span class="sxs-lookup"><span data-stu-id="07d56-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="07d56-118">大容量复制函数使用的数据文件不必由另一个大容量复制程序创建。</span><span class="sxs-lookup"><span data-stu-id="07d56-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="07d56-119">任何其他系统都可以按照大容量复制的定义生成数据文件和格式文件；然后，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 大容量复制程序可以使用这些文件将数据导入 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中。</span><span class="sxs-lookup"><span data-stu-id="07d56-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="07d56-120">例如，可以将数据从电子表格导出到以制表符分隔的文件中，然后生成描述该制表符分隔文件的格式文件，之后使用大容量复制程序将此数据快速导入 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中。</span><span class="sxs-lookup"><span data-stu-id="07d56-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="07d56-121">还可以将大容量复制所生成的数据文件导入其他应用程序中。</span><span class="sxs-lookup"><span data-stu-id="07d56-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="07d56-122">例如，可以使用大容量复制函数将数据从表或视图导出到以制表符分隔的文件中，然后可以将该文件加载到电子表格中。</span><span class="sxs-lookup"><span data-stu-id="07d56-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="07d56-123">编写应用程序以使用大容量复制函数的程序员应当遵从常规规则，以获得良好的大容量复制性能。</span><span class="sxs-lookup"><span data-stu-id="07d56-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="07d56-124">有关 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中对大容量复制操作的支持的详细信息，请参阅[批量导入和导出数据 (SQL Server)](../../import-export/bulk-import-and-export-of-data-sql-server.md)。</span><span class="sxs-lookup"><span data-stu-id="07d56-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="07d56-125">限制和局限</span><span class="sxs-lookup"><span data-stu-id="07d56-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="07d56-126">CLR 用户定义类型 (UDT) 必须绑定为二进制数据。</span><span class="sxs-lookup"><span data-stu-id="07d56-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="07d56-127">即使格式文件指定将 SQLCHAR 作为目标 UDT 列的数据类型，BCP 实用工具仍会将数据视为二进制。</span><span class="sxs-lookup"><span data-stu-id="07d56-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="07d56-128">不要对大容量复制操作使用 SET FMTONLY OFF。</span><span class="sxs-lookup"><span data-stu-id="07d56-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="07d56-129">SET FMTONLY OFF 可能导致大容量复制操作失败，或导致意外的结果。</span><span class="sxs-lookup"><span data-stu-id="07d56-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="07d56-130">SQL Server Native Client OLE DB 访问接口</span><span class="sxs-lookup"><span data-stu-id="07d56-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="07d56-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序实现了两种方法来对数据库执行大容量复制操作 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="07d56-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="07d56-132">第一个方法涉及使用 [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) 接口进行基于内存的大容量复制操作；第二个方法涉及使用 [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) 接口进行基于文件的大容量复制操作。</span><span class="sxs-lookup"><span data-stu-id="07d56-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="07d56-133">使用基于内存的大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="07d56-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="07d56-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序实现了**IRowsetFastLoad**接口，以公开对 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 基于内存的大容量复制操作的支持。</span><span class="sxs-lookup"><span data-stu-id="07d56-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="07d56-135">IRowsetFastLoad 接口实现了 [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) 和 [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) 方法  。</span><span class="sxs-lookup"><span data-stu-id="07d56-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="07d56-136">为 IRowsetFastLoad 启用会话</span><span class="sxs-lookup"><span data-stu-id="07d56-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="07d56-137">通过将特定于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口的数据源属性 SSPROP_ENABLEFASTLOAD 设置为 VARIANT_TRUE，使用者将其对大容量复制的需要通知 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="07d56-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="07d56-138">通过对数据源设置该属性，使用者创建 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口会话。</span><span class="sxs-lookup"><span data-stu-id="07d56-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="07d56-139">新会话允许使用者访问 IRowsetFastLoad 接口  。</span><span class="sxs-lookup"><span data-stu-id="07d56-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="07d56-140">如果 IDataInitialize 接口用于初始化数据源，则需要在 IOpenRowset::OpenRowset 方法的 rgPropertySets 参数中设置 SSPROP_IRowsetFastLoad 属性；否则，对 OpenRowset 方法的调用将返回 E_NOINTERFACE     。</span><span class="sxs-lookup"><span data-stu-id="07d56-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="07d56-141">启用大容量复制会话将会约束 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在会话中对接口的支持。</span><span class="sxs-lookup"><span data-stu-id="07d56-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="07d56-142">启用大容量复制的会话仅公开以下接口：</span><span class="sxs-lookup"><span data-stu-id="07d56-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="07d56-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="07d56-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="07d56-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="07d56-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="07d56-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="07d56-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="07d56-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="07d56-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="07d56-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="07d56-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="07d56-148">若要禁止创建启用大容量复制的行集，并使 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口会话恢复到标准处理，请将 SSPROP_ENABLEFASTLOAD 重置为 VARIANT_FALSE。</span><span class="sxs-lookup"><span data-stu-id="07d56-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="07d56-149">IRowsetFastLoad 行集</span><span class="sxs-lookup"><span data-stu-id="07d56-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="07d56-150"> Native Client OLE DB 访问接口大容量复制行集是只写的，但它们公开的接口允许使用者确定  表的结构。</span><span class="sxs-lookup"><span data-stu-id="07d56-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="07d56-151">启用大容量复制的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口行集公开了以下接口：</span><span class="sxs-lookup"><span data-stu-id="07d56-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="07d56-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="07d56-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="07d56-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="07d56-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="07d56-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="07d56-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="07d56-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="07d56-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="07d56-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="07d56-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="07d56-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="07d56-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="07d56-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="07d56-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="07d56-159">特定于访问接口的属性 SSPROP_FASTLOADOPTIONS、SSPROP_FASTLOADKEEPNULLS 和 SSPROP_FASTLOADKEEPIDENTITY 控制 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口大容量复制行集的行为。</span><span class="sxs-lookup"><span data-stu-id="07d56-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="07d56-160">在_rgPropertySets_**IOpenRowset**参数成员的*rgProperties*成员中指定这些属性。</span><span class="sxs-lookup"><span data-stu-id="07d56-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="07d56-161">属性 ID</span><span class="sxs-lookup"><span data-stu-id="07d56-161">Property ID</span></span>|<span data-ttu-id="07d56-162">说明</span><span class="sxs-lookup"><span data-stu-id="07d56-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="07d56-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="07d56-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="07d56-164">列：否</span><span class="sxs-lookup"><span data-stu-id="07d56-164">Column: No</span></span><br /><br /> <span data-ttu-id="07d56-165">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="07d56-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="07d56-166">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="07d56-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="07d56-167">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="07d56-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="07d56-168">说明:保留使用者提供的标识值。</span><span class="sxs-lookup"><span data-stu-id="07d56-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="07d56-169">VARIANT_FALSE：[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 表中的标识列的值由 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 生成。</span><span class="sxs-lookup"><span data-stu-id="07d56-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="07d56-170">Native Client OLE DB 提供程序将忽略该列绑定的任何值 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="07d56-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="07d56-171">VARIANT_TRUE：使用者绑定可提供 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 标识列的值的取值函数。</span><span class="sxs-lookup"><span data-stu-id="07d56-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="07d56-172">在接受 NULL 的列上，标识属性不可用，因此使用者为每个 IRowsetFastLoad::Insert 调用提供一个唯一的值  。</span><span class="sxs-lookup"><span data-stu-id="07d56-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="07d56-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="07d56-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="07d56-174">列：否</span><span class="sxs-lookup"><span data-stu-id="07d56-174">Column: No</span></span><br /><br /> <span data-ttu-id="07d56-175">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="07d56-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="07d56-176">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="07d56-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="07d56-177">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="07d56-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="07d56-178">说明:对于具有 DEFAULT 约束的列，将保持 NULL。</span><span class="sxs-lookup"><span data-stu-id="07d56-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="07d56-179">仅影响接受 NULL 并应用了 DEFAULT 约束的 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 列。</span><span class="sxs-lookup"><span data-stu-id="07d56-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="07d56-180">VARIANT_FALSE：当 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用者插入一个该列包含 NULL 的行时，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 将插入该列的默认值。</span><span class="sxs-lookup"><span data-stu-id="07d56-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="07d56-181">VARIANT_TRUE：当 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用者插入一个该列包含 NULL 的行时，[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 将插入 NULL 作为列值。</span><span class="sxs-lookup"><span data-stu-id="07d56-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="07d56-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="07d56-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="07d56-183">列：否</span><span class="sxs-lookup"><span data-stu-id="07d56-183">Column: No</span></span><br /><br /> <span data-ttu-id="07d56-184">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="07d56-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="07d56-185">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="07d56-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="07d56-186">默认值：无</span><span class="sxs-lookup"><span data-stu-id="07d56-186">Default: none</span></span><br /><br /> <span data-ttu-id="07d56-187">说明:此属性与 bcp  实用工具的 -h  “hint  [,...n  ]”选项相同。</span><span class="sxs-lookup"><span data-stu-id="07d56-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="07d56-188">以下字符串可以在将数据大容量复制到表中时作为选项使用。</span><span class="sxs-lookup"><span data-stu-id="07d56-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="07d56-189">**ORDER**(*column*[**ASC** | **DESC**][,...*n*])：数据文件中数据的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="07d56-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="07d56-190">如果按照表的聚集索引对加载的数据文件进行排序，将会提高大容量复制性能。</span><span class="sxs-lookup"><span data-stu-id="07d56-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="07d56-191">**ROWS_PER_BATCH** = *bb*：每批数据的行数（即 *bb*）。</span><span class="sxs-lookup"><span data-stu-id="07d56-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="07d56-192">服务器根据 *bb*值优化大容量加载。</span><span class="sxs-lookup"><span data-stu-id="07d56-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="07d56-193">默认情况下，ROWS_PER_BATCH 是未知的  。</span><span class="sxs-lookup"><span data-stu-id="07d56-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="07d56-194">**KILOBYTES_PER_BATCH** = *cc*：每批数据的千字节 (KB) 数（即 cc）。</span><span class="sxs-lookup"><span data-stu-id="07d56-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="07d56-195">默认情况下，KILOBYTES_PER_BATCH 是未知的  。</span><span class="sxs-lookup"><span data-stu-id="07d56-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="07d56-196">**TABLOCK**：在大容量复制操作期间，将获得表级锁定。</span><span class="sxs-lookup"><span data-stu-id="07d56-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="07d56-197">由于仅在大容量复制操作期间持有锁定会减少对表的锁定争用，因此该选项极大地提高了性能。</span><span class="sxs-lookup"><span data-stu-id="07d56-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="07d56-198">如果表没有索引并且指定了 TABLOCK，则该表可以同时由多个客户端加载  。</span><span class="sxs-lookup"><span data-stu-id="07d56-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="07d56-199">默认情况下，锁定行为由表选项 table lock on bulk load 确定  。</span><span class="sxs-lookup"><span data-stu-id="07d56-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="07d56-200">**CHECK_CONSTRAINTS**：在大容量复制操作期间，将检查对 table_name  的任何约束。</span><span class="sxs-lookup"><span data-stu-id="07d56-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="07d56-201">默认情况下，忽略约束。</span><span class="sxs-lookup"><span data-stu-id="07d56-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="07d56-202">FIRE_TRIGGER：[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 对触发器使用行版本控制，并将行版本存储在 tempdb 的版本存储中   。</span><span class="sxs-lookup"><span data-stu-id="07d56-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="07d56-203">因此，即使是在启用触发器时，也可以进行大容量记录优化。</span><span class="sxs-lookup"><span data-stu-id="07d56-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="07d56-204">在启用触发器的情况下对有很多行的批数据执行大容量导入之前，可能需要增加 tempdb 的大小  。</span><span class="sxs-lookup"><span data-stu-id="07d56-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="07d56-205">使用基于文件的大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="07d56-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="07d56-206">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序实现了**IBCPSession**接口，以公开对 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 基于文件的大容量复制操作的支持。</span><span class="sxs-lookup"><span data-stu-id="07d56-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="07d56-207">IBCPSession 接口实现了 [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md)、[IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md)、[IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md)、[IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md)、[IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md)、[IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md)、[IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) 和 [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md) 方法  。</span><span class="sxs-lookup"><span data-stu-id="07d56-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="07d56-208">SQL Server Native Client ODBC 驱动程序</span><span class="sxs-lookup"><span data-stu-id="07d56-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="07d56-209"> Native Client ODBC 驱动程序继续支持以前版本的  ODBC 驱动程序所包含的大容量复制操作。</span><span class="sxs-lookup"><span data-stu-id="07d56-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="07d56-210">有关使用 Native Client ODBC 驱动程序进行大容量复制操作的详细信息 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ，请参阅[&#40;ODBC&#41;执行大容量复制操作](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="07d56-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="07d56-211">另请参阅</span><span class="sxs-lookup"><span data-stu-id="07d56-211">See Also</span></span>  
 <span data-ttu-id="07d56-212">[SQL Server Native Client 功能](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="07d56-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="07d56-213">[数据源属性 (OLE DB)](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="07d56-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="07d56-214">[批量导入和导出数据 (SQL Server)](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="07d56-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="07d56-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="07d56-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="07d56-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="07d56-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="07d56-217">[优化大容量导入性能](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="07d56-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
