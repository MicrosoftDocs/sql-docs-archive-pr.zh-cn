---
title: SQL Server Native Client 的系统要求 |Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- system requirements [SQL Server Native Client]
- data access [SQL Server Native Client], system requirements
- SQL Server Native Client, system requirements
- SQLNCLI, system requirements
ms.assetid: 1c8e2f8a-a440-44da-8e3a-af632d34c52c
author: rothja
ms.author: jroth
ms.openlocfilehash: 4005d0aab77de5dcbd7c8da75c8f5df48e07ead6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591317"
---
# <a name="system-requirements-for-sql-server-native-client"></a><span data-ttu-id="b06d1-102">SQL Server Native Client 的系统要求</span><span class="sxs-lookup"><span data-stu-id="b06d1-102">System Requirements for SQL Server Native Client</span></span>
  <span data-ttu-id="b06d1-103">若要使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的数据访问功能（如 MARS），必须安装以下软件：</span><span class="sxs-lookup"><span data-stu-id="b06d1-103">To use data access features of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] such as MARS, you must have the following software installed:</span></span>  
  
-   <span data-ttu-id="b06d1-104">客户端上的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client。</span><span class="sxs-lookup"><span data-stu-id="b06d1-104">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client on your client.</span></span>  
  
-   <span data-ttu-id="b06d1-105">服务器上的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="b06d1-105">An instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on your server.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b06d1-106">Native Client 要求使用 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="b06d1-106">Native Client requires Windows Installer 3.0.</span></span> <span data-ttu-id="b06d1-107">[!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 操作系统上已经安装了 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="b06d1-107">Windows Installer 3.0 is already installed on [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows operating systems.</span></span> <span data-ttu-id="b06d1-108">您需要将其显式安装到所有其他平台上。</span><span class="sxs-lookup"><span data-stu-id="b06d1-108">For all other platforms you need to explicitly install it.</span></span> <span data-ttu-id="b06d1-109">有关详细信息，请参阅[Windows Installer 3.0 可再发行组件](https://www.microsoft.com/download/details.aspx?id=16821)。</span><span class="sxs-lookup"><span data-stu-id="b06d1-109">For more information, see [Windows Installer 3.0 Redistributable](https://www.microsoft.com/download/details.aspx?id=16821).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b06d1-110">确保以管理员权限进行登录，然后再安装此软件。</span><span class="sxs-lookup"><span data-stu-id="b06d1-110">Make sure you log on with administrator privileges before installing this software.</span></span>  
  
## <a name="operating-system-requirements"></a><span data-ttu-id="b06d1-111">操作系统要求</span><span class="sxs-lookup"><span data-stu-id="b06d1-111">Operating System Requirements</span></span>  
 <span data-ttu-id="b06d1-112">有关支持 Native Client 的操作系统的列表 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，请参阅[SQL Server Native Client 的支持策略](applications/support-policies-for-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="b06d1-112">For a list of operating systems that support [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, see [Support Policies for SQL Server Native Client](applications/support-policies-for-sql-server-native-client.md).</span></span>  
  
## <a name="sql-server-requirements"></a><span data-ttu-id="b06d1-113">SQL Server 要求</span><span class="sxs-lookup"><span data-stu-id="b06d1-113">SQL Server Requirements</span></span>  
 <span data-ttu-id="b06d1-114">若要使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 访问 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库中的数据，必须安装 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="b06d1-114">To use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client to access data in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases, you must have an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installed.</span></span>  
  
 [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] <span data-ttu-id="b06d1-115">支持与 MDAC 的所有版本、Windows 数据访问组件以及 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的所有版本的连接。</span><span class="sxs-lookup"><span data-stu-id="b06d1-115">supports connections from all versions of MDAC, Windows Data Access Components, and all versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b06d1-116">如果客户端的较旧版本连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]，则该客户端未知的服务器数据类型将映射到与客户端版本相兼容的类型。</span><span class="sxs-lookup"><span data-stu-id="b06d1-116">When an older client version connects to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], server data types not known to the client are mapped to types that are compatible with the client version.</span></span> <span data-ttu-id="b06d1-117">有关详细信息，请参阅本主题后面的“客户端版本的数据类型兼容性”。</span><span class="sxs-lookup"><span data-stu-id="b06d1-117">For more information, see Data Type Compatibility for Client Versions, later in this topic.</span></span>  
  
## <a name="cross-language-requirements"></a><span data-ttu-id="b06d1-118">跨语言要求</span><span class="sxs-lookup"><span data-stu-id="b06d1-118">Cross-Language Requirements</span></span>  
 <span data-ttu-id="b06d1-119">支持的操作系统的所有本地化版本均支持英文版 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client。</span><span class="sxs-lookup"><span data-stu-id="b06d1-119">The English-language version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is supported on all localized versions of supported operating systems.</span></span> <span data-ttu-id="b06d1-120">与本地化版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 使用同一语言的本地化操作系统支持 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的本地化版本。</span><span class="sxs-lookup"><span data-stu-id="b06d1-120">Localized versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client are supported on localized operating systems that are the same language as the localized [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client version.</span></span> <span data-ttu-id="b06d1-121">只要安装了匹配的语言设置，则支持的操作系统的英文版还支持 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的本地化版本。</span><span class="sxs-lookup"><span data-stu-id="b06d1-121">Localized versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client are also supported on English-language versions of supported operating systems as long as the matching language settings are installed.</span></span>  
  
 <span data-ttu-id="b06d1-122">对于升级：</span><span class="sxs-lookup"><span data-stu-id="b06d1-122">For upgrades:</span></span>  
  
-   <span data-ttu-id="b06d1-123">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的英文版可以升级到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的任一本地化版本。</span><span class="sxs-lookup"><span data-stu-id="b06d1-123">English-language versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client can be upgraded to any localized version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="b06d1-124">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的本地化版本可以升级到同一语言的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 本地化版本。</span><span class="sxs-lookup"><span data-stu-id="b06d1-124">Localized versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client can be upgraded to localized versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client of the same language.</span></span>  
  
-   <span data-ttu-id="b06d1-125">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的本地化版本可以升级到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的英文版。</span><span class="sxs-lookup"><span data-stu-id="b06d1-125">Localized version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client can be upgraded to the English-language version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="b06d1-126">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 的本地化版本无法升级到不同本地化语言的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 本地化版本。</span><span class="sxs-lookup"><span data-stu-id="b06d1-126">Localized versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client cannot be upgraded to localized [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client versions of a different localized language.</span></span>  
  
## <a name="data-type-compatibility-for-client-versions"></a><span data-ttu-id="b06d1-127">客户端版本的数据类型兼容性</span><span class="sxs-lookup"><span data-stu-id="b06d1-127">Data Type Compatibility for Client Versions</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="b06d1-128">和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 将新数据类型映射到与下级客户端相兼容的较旧的数据类型，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="b06d1-128">and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client map new data types to older datatypes that are compatible with down-level clients, as shown in the table below.</span></span>  
  
 <span data-ttu-id="b06d1-129">OLE DB 和 ADO 应用程序可将 `DataTypeCompatibility` 连接字符串关键字用于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client，以对较早的数据类型进行操作。</span><span class="sxs-lookup"><span data-stu-id="b06d1-129">OLE DB and ADO applications can use the `DataTypeCompatibility` connection string keyword with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client to operate with older data types.</span></span> <span data-ttu-id="b06d1-130">如果 `DataTypeCompatibility=80`，OLE DB 客户端将使用 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 表格格式数据流 (TDS) 版本而不是 TDS 版本进行连接。</span><span class="sxs-lookup"><span data-stu-id="b06d1-130">When `DataTypeCompatibility=80`, OLE DB clients will connect using the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] tabular data stream (TDS) version, rather than the  TDS version.</span></span> <span data-ttu-id="b06d1-131">也就是说，对于 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和较新的数据类型，将由服务器而不是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 执行下级转换。</span><span class="sxs-lookup"><span data-stu-id="b06d1-131">This means that for [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and later data types, down-level conversion will be performed by the server, rather than by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b06d1-132">此外，这还意味着，连接中的可用功能将被限制为 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 功能集。</span><span class="sxs-lookup"><span data-stu-id="b06d1-132">It also means that the features available on the connection will be limited to the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] feature set.</span></span> <span data-ttu-id="b06d1-133">尽可能早地对 API 调用中使用新数据类型或功能的尝试进行检测，将错误返回给调用应用程序，而不是尝试将无效的请求传递给服务器。</span><span class="sxs-lookup"><span data-stu-id="b06d1-133">Attempts to use new datatypes or features are detected as early as possible on API calls and errors are returned to the calling application, rather than attempting to pass invalid requests to the server.</span></span>  
  
 <span data-ttu-id="b06d1-134">没有对 ODBC 进行 `DataTypeCompatibility` 控制。</span><span class="sxs-lookup"><span data-stu-id="b06d1-134">There is no `DataTypeCompatibility` control for ODBC.</span></span>  
  
 <span data-ttu-id="b06d1-135">IDBInfo：： GetKeywords 将始终返回与连接上的服务器版本相对应的关键字列表，并不受影响 `DataTypeCompatibility` 。</span><span class="sxs-lookup"><span data-stu-id="b06d1-135">IDBInfo::GetKeywords will always return a keyword list that corresponds to the server version on the connection and is not affected by `DataTypeCompatibility`.</span></span>  
  
|<span data-ttu-id="b06d1-136">数据类型</span><span class="sxs-lookup"><span data-stu-id="b06d1-136">Data type</span></span>|<span data-ttu-id="b06d1-137">SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="b06d1-137">SQL Server Native Client</span></span><br /><br /> <span data-ttu-id="b06d1-138">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="b06d1-138">SQL Server 2005</span></span>|<span data-ttu-id="b06d1-139">SQL Server Native Client 11.0</span><span class="sxs-lookup"><span data-stu-id="b06d1-139">SQL Server Native Client 11.0</span></span><br /><br /> [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]|<span data-ttu-id="b06d1-140">Windows 数据访问组件、MDAC 及</span><span class="sxs-lookup"><span data-stu-id="b06d1-140">Windows Data Access Components, MDAC, and</span></span><br /><br /> <span data-ttu-id="b06d1-141">SQL Server Native Client OLE DB 应用程序（其中 DataTypeCompatibility=80）</span><span class="sxs-lookup"><span data-stu-id="b06d1-141">SQL Server Native Client OLE DB applications with DataTypeCompatibility=80</span></span>|  
|---------------|--------------------------------------------------|-------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="b06d1-142">CLR UDT (\<= 8Kb)</span><span class="sxs-lookup"><span data-stu-id="b06d1-142">CLR UDT (\<= 8Kb)</span></span>|<span data-ttu-id="b06d1-143">udt</span><span class="sxs-lookup"><span data-stu-id="b06d1-143">udt</span></span>|<span data-ttu-id="b06d1-144">Udt</span><span class="sxs-lookup"><span data-stu-id="b06d1-144">Udt</span></span>|<span data-ttu-id="b06d1-145">Varbinary</span><span class="sxs-lookup"><span data-stu-id="b06d1-145">Varbinary</span></span>|  
|<span data-ttu-id="b06d1-146">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="b06d1-146">varbinary(max)</span></span>|<span data-ttu-id="b06d1-147">varbinary</span><span class="sxs-lookup"><span data-stu-id="b06d1-147">varbinary</span></span>|<span data-ttu-id="b06d1-148">varbinary</span><span class="sxs-lookup"><span data-stu-id="b06d1-148">varbinary</span></span>|<span data-ttu-id="b06d1-149">映像</span><span class="sxs-lookup"><span data-stu-id="b06d1-149">Image</span></span>|  
|<span data-ttu-id="b06d1-150">varchar(max)</span><span class="sxs-lookup"><span data-stu-id="b06d1-150">varchar(max)</span></span>|<span data-ttu-id="b06d1-151">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-151">varchar</span></span>|<span data-ttu-id="b06d1-152">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-152">varchar</span></span>|<span data-ttu-id="b06d1-153">文本</span><span class="sxs-lookup"><span data-stu-id="b06d1-153">Text</span></span>|  
|<span data-ttu-id="b06d1-154">nvarchar(max)</span><span class="sxs-lookup"><span data-stu-id="b06d1-154">nvarchar(max)</span></span>|<span data-ttu-id="b06d1-155">nvarchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-155">nvarchar</span></span>|<span data-ttu-id="b06d1-156">nvarchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-156">nvarchar</span></span>|<span data-ttu-id="b06d1-157">Ntext</span><span class="sxs-lookup"><span data-stu-id="b06d1-157">Ntext</span></span>|  
|<span data-ttu-id="b06d1-158">xml</span><span class="sxs-lookup"><span data-stu-id="b06d1-158">xml</span></span>|<span data-ttu-id="b06d1-159">xml</span><span class="sxs-lookup"><span data-stu-id="b06d1-159">xml</span></span>|<span data-ttu-id="b06d1-160">xml</span><span class="sxs-lookup"><span data-stu-id="b06d1-160">xml</span></span>|<span data-ttu-id="b06d1-161">Ntext</span><span class="sxs-lookup"><span data-stu-id="b06d1-161">Ntext</span></span>|  
|<span data-ttu-id="b06d1-162">CLR UDT ( # A0 8Kb) </span><span class="sxs-lookup"><span data-stu-id="b06d1-162">CLR UDT (> 8Kb)</span></span>|<span data-ttu-id="b06d1-163">udt</span><span class="sxs-lookup"><span data-stu-id="b06d1-163">udt</span></span>|<span data-ttu-id="b06d1-164">varbinary</span><span class="sxs-lookup"><span data-stu-id="b06d1-164">varbinary</span></span>|<span data-ttu-id="b06d1-165">映像</span><span class="sxs-lookup"><span data-stu-id="b06d1-165">Image</span></span>|  
|<span data-ttu-id="b06d1-166">date</span><span class="sxs-lookup"><span data-stu-id="b06d1-166">date</span></span>|<span data-ttu-id="b06d1-167">date</span><span class="sxs-lookup"><span data-stu-id="b06d1-167">date</span></span>|<span data-ttu-id="b06d1-168">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-168">varchar</span></span>|<span data-ttu-id="b06d1-169">Varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-169">Varchar</span></span>|  
|<span data-ttu-id="b06d1-170">datetime2</span><span class="sxs-lookup"><span data-stu-id="b06d1-170">datetime2</span></span>|<span data-ttu-id="b06d1-171">datetime2</span><span class="sxs-lookup"><span data-stu-id="b06d1-171">datetime2</span></span>|<span data-ttu-id="b06d1-172">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-172">varchar</span></span>|<span data-ttu-id="b06d1-173">Varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-173">Varchar</span></span>|  
|<span data-ttu-id="b06d1-174">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b06d1-174">datetimeoffset</span></span>|<span data-ttu-id="b06d1-175">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b06d1-175">datetimeoffset</span></span>|<span data-ttu-id="b06d1-176">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-176">varchar</span></span>|<span data-ttu-id="b06d1-177">Varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-177">Varchar</span></span>|  
|<span data-ttu-id="b06d1-178">time</span><span class="sxs-lookup"><span data-stu-id="b06d1-178">time</span></span>|<span data-ttu-id="b06d1-179">time</span><span class="sxs-lookup"><span data-stu-id="b06d1-179">time</span></span>|<span data-ttu-id="b06d1-180">varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-180">varchar</span></span>|<span data-ttu-id="b06d1-181">Varchar</span><span class="sxs-lookup"><span data-stu-id="b06d1-181">Varchar</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b06d1-182">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b06d1-182">See Also</span></span>  
 <span data-ttu-id="b06d1-183">[SQL Server Native Client 编程](sql-server-native-client-programming.md) </span><span class="sxs-lookup"><span data-stu-id="b06d1-183">[SQL Server Native Client Programming](sql-server-native-client-programming.md) </span></span>  
 [<span data-ttu-id="b06d1-184">安装 SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="b06d1-184">Installing SQL Server Native Client</span></span>](applications/installing-sql-server-native-client.md)  
  
  
