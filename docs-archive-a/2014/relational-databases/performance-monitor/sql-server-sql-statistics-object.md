---
title: SQL Server - SQL Statistics 对象 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- SQLServer:SQL Statistics
- SQL Statistics object
ms.assetid: da7dbb4b-f632-45a0-b1ab-c35cc2695c86
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 8aba118f93a9a4f38179e8e7c5156eecc24012ef
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87687796"
---
# <a name="sql-server-sql-statistics-object"></a><span data-ttu-id="e1611-102">SQL Server:SQL Statistics 对象</span><span class="sxs-lookup"><span data-stu-id="e1611-102">SQL Server, SQL Statistics Object</span></span>
  <span data-ttu-id="e1611-103">**中的** SQLServer:SQL Statistics [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 对象提供计数器来监视编译和发送到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的请求类型。</span><span class="sxs-lookup"><span data-stu-id="e1611-103">The **SQLServer:SQL Statistics** object in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provides counters to monitor compilation and the type of requests sent to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1611-104">通过监视查询编译和重新编译的次数以及 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例收到的批数，可了解 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 处理用户查询的速度，以及查询优化器处理查询的效率。</span><span class="sxs-lookup"><span data-stu-id="e1611-104">Monitoring the number of query compilations and recompilations and the number of batches received by an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] gives you an indication of how quickly [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is processing user queries and how effectively the query optimizer is processing the queries.</span></span>  
  
 <span data-ttu-id="e1611-105">编译时间在查询总时间中占到很大一部分。</span><span class="sxs-lookup"><span data-stu-id="e1611-105">Compilation is a significant part of a query's turnaround time.</span></span> <span data-ttu-id="e1611-106">为节省编译开销， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 将编译过的查询计划保存在一个查询缓存中。</span><span class="sxs-lookup"><span data-stu-id="e1611-106">In order to save the compilation cost, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] saves the compiled query plan in a query cache.</span></span> <span data-ttu-id="e1611-107">缓存的目标是通过存储编译过的查询以便再次使用来减少编译，从而在将来执行查询时，不需重新编译它。</span><span class="sxs-lookup"><span data-stu-id="e1611-107">The objective of the cache is to reduce compilation by storing compiled queries for later reuse, therefore ending the requirement to recompile queries when later executed.</span></span> <span data-ttu-id="e1611-108">但是，每个唯一的查询至少需要编译一次。</span><span class="sxs-lookup"><span data-stu-id="e1611-108">However, each unique query must be compiled at least one time.</span></span> <span data-ttu-id="e1611-109">以下因素可造成重新编译查询：</span><span class="sxs-lookup"><span data-stu-id="e1611-109">Query recompilations can be caused by the following factors:</span></span>  
  
-   <span data-ttu-id="e1611-110">架构更改，包括基本架构更改（例如在表中添加列或索引）和统计架构更改（例如在表中插入或删除很多行）。</span><span class="sxs-lookup"><span data-stu-id="e1611-110">Schema changes, including base schema changes such as adding columns or indexes to a table, or statistics schema changes such as inserting or deleting a significant number of rows from a table.</span></span>  
  
-   <span data-ttu-id="e1611-111">环境（SET 语句）改变。</span><span class="sxs-lookup"><span data-stu-id="e1611-111">Environment (SET statement) changes.</span></span> <span data-ttu-id="e1611-112">在 ANSI_PADDING 或 ANSI_NULLS 等会话设置中的更改，可能会导致查询的重新编译。</span><span class="sxs-lookup"><span data-stu-id="e1611-112">Changes in session settings such as ANSI_PADDING or ANSI_NULLS can cause a query to be recompiled.</span></span>  
  
 <span data-ttu-id="e1611-113">有关简单参数化和强制参数化的详细信息，请参阅 [ALTER DATABASE (Transact-SQL)](/sql/t-sql/statements/alter-database-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="e1611-113">For more information about simple and forced parameterization, see [ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql).</span></span>  
  
 <span data-ttu-id="e1611-114">下面列出了 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SQL Statistics 计数器。</span><span class="sxs-lookup"><span data-stu-id="e1611-114">These are the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **SQL Statistics** counters.</span></span>  
  
|<span data-ttu-id="e1611-115">SQL Server SQL Statistics 计数器</span><span class="sxs-lookup"><span data-stu-id="e1611-115">SQL Server SQL Statistics counters</span></span>|<span data-ttu-id="e1611-116">说明</span><span class="sxs-lookup"><span data-stu-id="e1611-116">Description</span></span>|  
|----------------------------------------|-----------------|  
|<span data-ttu-id="e1611-117">**Auto-Param Attempts/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-117">**Auto-Param Attempts/sec**</span></span>|<span data-ttu-id="e1611-118">每秒的自动参数化尝试数。</span><span class="sxs-lookup"><span data-stu-id="e1611-118">Number of auto-parameterization attempts per second.</span></span> <span data-ttu-id="e1611-119">其总数应为失败的、安全的和不安全的自动参数化尝试之和。</span><span class="sxs-lookup"><span data-stu-id="e1611-119">Total should be the sum of the failed, safe, and unsafe auto-parameterizations.</span></span> <span data-ttu-id="e1611-120">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例尝试通过将某些文字替换为参数来参数化 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 请求时，就会进行自动参数化，这样可以对多个相似的请求再次使用保存在缓存中的执行计划。</span><span class="sxs-lookup"><span data-stu-id="e1611-120">Auto-parameterization occurs when an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tries to parameterize a [!INCLUDE[tsql](../../../includes/tsql-md.md)] request by replacing some literals with parameters so that reuse of the resulting cached execution plan across multiple similar-looking requests is possible.</span></span> <span data-ttu-id="e1611-121">请注意，在更新版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中，自动参数化也称为简单参数化。</span><span class="sxs-lookup"><span data-stu-id="e1611-121">Note that auto-parameterizations are also known as simple parameterizations in newer versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1611-122">此计数器不包括强制参数化。</span><span class="sxs-lookup"><span data-stu-id="e1611-122">This counter does not include forced parameterizations.</span></span>|  
|<span data-ttu-id="e1611-123">**Batch Requests/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-123">**Batch Requests/sec**</span></span>|<span data-ttu-id="e1611-124">每秒收到的 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 命令批数。</span><span class="sxs-lookup"><span data-stu-id="e1611-124">Number of [!INCLUDE[tsql](../../../includes/tsql-md.md)] command batches received per second.</span></span> <span data-ttu-id="e1611-125">这一统计信息受所有约束（如 I/O、用户数、高速缓存大小、请求的复杂程度等）影响。</span><span class="sxs-lookup"><span data-stu-id="e1611-125">This statistic is affected by all constraints (such as I/O, number of users, cache size, complexity of requests, and so on).</span></span> <span data-ttu-id="e1611-126">批处理请求数值高意味着吞吐量很好。</span><span class="sxs-lookup"><span data-stu-id="e1611-126">High batch requests mean good throughput.</span></span>|  
|<span data-ttu-id="e1611-127">**Failed Auto-Params/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-127">**Failed Auto-Params/sec**</span></span>|<span data-ttu-id="e1611-128">每秒自动参数化尝试失败次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-128">Number of failed auto-parameterization attempts per second.</span></span> <span data-ttu-id="e1611-129">该值应很小。</span><span class="sxs-lookup"><span data-stu-id="e1611-129">This should be small.</span></span> <span data-ttu-id="e1611-130">请注意，在更高版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中，自动参数化也称为简单参数化。</span><span class="sxs-lookup"><span data-stu-id="e1611-130">Note that auto-parameterizations are also known as simple parameterizations in later versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="e1611-131">**Forced Parameterizations/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-131">**Forced Parameterizations/sec**</span></span>|<span data-ttu-id="e1611-132">每秒成功执行的强制参数化次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-132">Number of successful forced parameterizations per second.</span></span>|  
|<span data-ttu-id="e1611-133">**Guided Plan Executions/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-133">**Guided Plan Executions/sec**</span></span>|<span data-ttu-id="e1611-134">每秒执行的计划数，其中的查询计划是通过使用计划指南生成的。</span><span class="sxs-lookup"><span data-stu-id="e1611-134">Number of plan executions per second in which the query plan has been generated by using a plan guide.</span></span>|  
|<span data-ttu-id="e1611-135">**Misguided Plan Executions/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-135">**Misguided Plan Executions/sec**</span></span>|<span data-ttu-id="e1611-136">每秒执行的计划数，其中的查询计划无法使用计划指南生成。</span><span class="sxs-lookup"><span data-stu-id="e1611-136">Number of plan executions per second in which a plan guide could not be honored during plan generation.</span></span> <span data-ttu-id="e1611-137">系统将忽略计划指南并使用正常的编译过程生成执行计划。</span><span class="sxs-lookup"><span data-stu-id="e1611-137">The plan guide was disregarded and normal compilation was used to generate the executed plan.</span></span>|  
|<span data-ttu-id="e1611-138">**Safe Auto-Params/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-138">**Safe Auto-Params/sec**</span></span>|<span data-ttu-id="e1611-139">每秒安全自动参数化尝试次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-139">Number of safe auto-parameterization attempts per second.</span></span> <span data-ttu-id="e1611-140">安全指确定保存在缓存中的执行计划可以在不同的相似 [!INCLUDE[tsql](../../../includes/tsql-md.md)] 语句之间共享。</span><span class="sxs-lookup"><span data-stu-id="e1611-140">Safe refers to a determination that a cached execution plan can be shared between different similar-looking [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="e1611-141">进行多次自动参数化尝试，某些成为安全的，某些就失败了。</span><span class="sxs-lookup"><span data-stu-id="e1611-141">makes many auto-parameterization attempts some of which turn out to be safe and others fail.</span></span> <span data-ttu-id="e1611-142">请注意，在更高版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中，自动参数化也称为简单参数化。</span><span class="sxs-lookup"><span data-stu-id="e1611-142">Note that auto-parameterizations are also known as simple parameterizations in later versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1611-143">它不包括强制参数化。</span><span class="sxs-lookup"><span data-stu-id="e1611-143">This does not include forced parameterizations.</span></span>|  
|<span data-ttu-id="e1611-144">**SQL Attention rate**</span><span class="sxs-lookup"><span data-stu-id="e1611-144">**SQL Attention rate**</span></span>|<span data-ttu-id="e1611-145">每秒发出关注信号的数目。</span><span class="sxs-lookup"><span data-stu-id="e1611-145">Number of attentions per second.</span></span> <span data-ttu-id="e1611-146">发出一次关注信号就是终止当前运行请求的一次客户端请求。</span><span class="sxs-lookup"><span data-stu-id="e1611-146">An attention is a request by the client to end the currently running request.</span></span>|  
|<span data-ttu-id="e1611-147">**SQL Compilations/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-147">**SQL Compilations/sec**</span></span>|<span data-ttu-id="e1611-148">每秒的 SQL 编译数。</span><span class="sxs-lookup"><span data-stu-id="e1611-148">Number of SQL compilations per second.</span></span> <span data-ttu-id="e1611-149">表示编译代码路径被进入的次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-149">Indicates the number of times the compile code path is entered.</span></span> <span data-ttu-id="e1611-150">包括 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]中语句级重新编译导致的编译。</span><span class="sxs-lookup"><span data-stu-id="e1611-150">Includes compiles caused by statement-level recompilations in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e1611-151">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 用户活动稳定后，该值将达到稳定状态。</span><span class="sxs-lookup"><span data-stu-id="e1611-151">After [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] user activity is stable, this value reaches a steady state.</span></span>|  
|<span data-ttu-id="e1611-152">**SQL Re-Compilations/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-152">**SQL Re-Compilations/sec**</span></span>|<span data-ttu-id="e1611-153">每秒语句重新编译的次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-153">Number of statement recompiles per second.</span></span> <span data-ttu-id="e1611-154">计算触发语句重新编译的次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-154">Counts the number of times statement recompiles are triggered.</span></span> <span data-ttu-id="e1611-155">一般来说，这个数值最好较小。</span><span class="sxs-lookup"><span data-stu-id="e1611-155">Generally, you want the recompiles to be low.</span></span>|  
|<span data-ttu-id="e1611-156">**Unsafe Auto-Params/sec**</span><span class="sxs-lookup"><span data-stu-id="e1611-156">**Unsafe Auto-Params/sec**</span></span>|<span data-ttu-id="e1611-157">每秒不安全的自动参数化尝试次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-157">Number of unsafe auto-parameterization attempts per second.</span></span> <span data-ttu-id="e1611-158">例如，查询有某些特性会防止保存在缓存中的计划被共享。</span><span class="sxs-lookup"><span data-stu-id="e1611-158">For example, the query has some characteristics that prevent the cached plan from being shared.</span></span> <span data-ttu-id="e1611-159">它们将被指定为不安全的。</span><span class="sxs-lookup"><span data-stu-id="e1611-159">These are designated as unsafe.</span></span> <span data-ttu-id="e1611-160">此计数器不计算强制参数化次数。</span><span class="sxs-lookup"><span data-stu-id="e1611-160">This does not count the number of forced parameterizations.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e1611-161">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e1611-161">See Also</span></span>  
 <span data-ttu-id="e1611-162">[SQL Server Plan Cache 对象](sql-server-plan-cache-object.md) </span><span class="sxs-lookup"><span data-stu-id="e1611-162">[SQL Server, Plan Cache Object](sql-server-plan-cache-object.md) </span></span>  
 [<span data-ttu-id="e1611-163">监视资源使用情况（系统监视器）</span><span class="sxs-lookup"><span data-stu-id="e1611-163">Monitor Resource Usage &#40;System Monitor&#41;</span></span>](monitor-resource-usage-system-monitor.md)  
  
  
