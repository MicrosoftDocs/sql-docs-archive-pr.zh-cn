---
title: bcp_setcolfmt |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- bcp_setcolfmt
api_location:
- sqlncli11.dll
topic_type:
- apiref
helpviewer_keywords:
- bcp_setcolfmt function
ms.assetid: afb47987-39e7-4079-ad66-e0abf4d4c72b
author: rothja
ms.author: jroth
ms.openlocfilehash: bb3b1da62ab4e98ed4497dd11fcc20163025058b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587798"
---
# <a name="bcp_setcolfmt"></a><span data-ttu-id="12d13-102">bcp_setcolfmt</span><span class="sxs-lookup"><span data-stu-id="12d13-102">bcp_setcolfmt</span></span>
  <span data-ttu-id="12d13-103">**Bcp_setcolfmt**函数取代了[bcp_colfmt](bcp-colfmt.md)。</span><span class="sxs-lookup"><span data-stu-id="12d13-103">The **bcp_setcolfmt** function supersedes the [bcp_colfmt](bcp-colfmt.md).</span></span> <span data-ttu-id="12d13-104">在指定列排序规则时，必须使用**bcp_setcolfmt**函数。</span><span class="sxs-lookup"><span data-stu-id="12d13-104">In specifying the column collation, the **bcp_setcolfmt** function must be used.</span></span> <span data-ttu-id="12d13-105">[bcp_setbulkmode](bcp-setbulkmode.md)可用于指定多个列格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-105">[bcp_setbulkmode](bcp-setbulkmode.md) can be used to specify more than one column format.</span></span>  
  
 <span data-ttu-id="12d13-106">该函数提供在大容量复制操作中指定列格式的灵活方法。</span><span class="sxs-lookup"><span data-stu-id="12d13-106">This function provides a flexible approach to specifying the column format in a bulk copy operation.</span></span> <span data-ttu-id="12d13-107">它用于设置单独的列格式属性。</span><span class="sxs-lookup"><span data-stu-id="12d13-107">It is used to set individual column format attributes.</span></span> <span data-ttu-id="12d13-108">对的每个调用都将设置一个列格式特性**bcp_setcolfmt** 。</span><span class="sxs-lookup"><span data-stu-id="12d13-108">Each call to **bcp_setcolfmt** sets one column format attribute.</span></span>  
  
 <span data-ttu-id="12d13-109">**Bcp_setcolfmt**函数指定用户文件中数据的源或目标格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-109">The **bcp_setcolfmt** function specifies the source or target format of the data in a user file.</span></span> <span data-ttu-id="12d13-110">用作源格式时， **bcp_setcolfmt**指定在大容量复制到中的表中用作数据源的现有数据文件的格式 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="12d13-110">When used as a source format, **bcp_setcolfmt** specifies the format of an existing data file used as a data source of data in a bulk copy to a table in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="12d13-111">用作目标格式时，将使用**bcp_setcolfmt**指定的列格式创建数据文件。</span><span class="sxs-lookup"><span data-stu-id="12d13-111">When used as a target format, the data file is created using the column formats specified with **bcp_setcolfmt**.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="12d13-112">语法</span><span class="sxs-lookup"><span data-stu-id="12d13-112">Syntax</span></span>  
  
```  
  
RETCODE bcp_setcolfmt (  
HDBC   
hdbc  
,  
INT   
field  
,  
INT   
property  
,  
void*   
pValue  
,  
INT   
cbValue  
);  
  
```  
  
## <a name="arguments"></a><span data-ttu-id="12d13-113">参数</span><span class="sxs-lookup"><span data-stu-id="12d13-113">Arguments</span></span>  
 <span data-ttu-id="12d13-114">*hdbc*</span><span class="sxs-lookup"><span data-stu-id="12d13-114">*hdbc*</span></span>  
 <span data-ttu-id="12d13-115">是启用大容量复制的 ODBC 连接句柄。</span><span class="sxs-lookup"><span data-stu-id="12d13-115">Is the bulk copy-enabled ODBC connection handle.</span></span>  
  
 <span data-ttu-id="12d13-116">*Field — 字段*</span><span class="sxs-lookup"><span data-stu-id="12d13-116">*field*</span></span>  
 <span data-ttu-id="12d13-117">要设置其属性的按一定顺序的列号。</span><span class="sxs-lookup"><span data-stu-id="12d13-117">Is the ordinal column number for which the property is being set.</span></span>  
  
 <span data-ttu-id="12d13-118">*property*</span><span class="sxs-lookup"><span data-stu-id="12d13-118">*property*</span></span>  
 <span data-ttu-id="12d13-119">属性常量之一。</span><span class="sxs-lookup"><span data-stu-id="12d13-119">Is one of the property constants.</span></span> <span data-ttu-id="12d13-120">在下表中定义属性常量。</span><span class="sxs-lookup"><span data-stu-id="12d13-120">Property constants are defined in this table.</span></span>  
  
|<span data-ttu-id="12d13-121">Property</span><span class="sxs-lookup"><span data-stu-id="12d13-121">Property</span></span>|<span data-ttu-id="12d13-122">值</span><span class="sxs-lookup"><span data-stu-id="12d13-122">Value</span></span>|<span data-ttu-id="12d13-123">说明</span><span class="sxs-lookup"><span data-stu-id="12d13-123">Description</span></span>|  
|--------------|-----------|-----------------|  
|<span data-ttu-id="12d13-124">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="12d13-124">BCP_FMT_TYPE</span></span>|<span data-ttu-id="12d13-125">BYTE</span><span class="sxs-lookup"><span data-stu-id="12d13-125">BYTE</span></span>|<span data-ttu-id="12d13-126">用户文件中此列的数据类型。</span><span class="sxs-lookup"><span data-stu-id="12d13-126">Is the data type of this column in the user file.</span></span> <span data-ttu-id="12d13-127">如果不同于数据库表中相应列的数据类型，则大容量复制将根据情况转换数据。</span><span class="sxs-lookup"><span data-stu-id="12d13-127">If different from the data type of the corresponding column in the database table, bulk copy converts the data if possible.</span></span><br /><br /> <span data-ttu-id="12d13-128">BCP_FMT_TYPE 参数由 sqlncli.h 中的 SQL Server 数据类型标记枚举，而非采用 ODBC C 数据类型枚举器。</span><span class="sxs-lookup"><span data-stu-id="12d13-128">The BCP_FMT_TYPE parameter is enumerated by the SQL Server data type tokens in sqlncli.h, rather than the ODBC C data type enumerators.</span></span> <span data-ttu-id="12d13-129">例如，您可以使用特定于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的 SQLCHARACTER 类型指定一个字符串：ODBC 类型 SQL_C_CHAR。</span><span class="sxs-lookup"><span data-stu-id="12d13-129">For example, you can specify a character string, ODBC type SQL_C_CHAR, using the SQLCHARACTER type specific to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="12d13-130">若要为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据类型指定默认的数据表示形式，则将此参数设置为 0。</span><span class="sxs-lookup"><span data-stu-id="12d13-130">To specify the default data representation for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type, set this parameter to 0.</span></span><br /><br /> <span data-ttu-id="12d13-131">对于从 SQL Server 大容量复制到某一文件，在 BCP_FMT_TYPE 为 SQLDECIMAL 或 SQLNUMERIC 时：</span><span class="sxs-lookup"><span data-stu-id="12d13-131">For a bulk copy out of SQL Server into a file, when BCP_FMT_TYPE is SQLDECIMAL or SQLNUMERIC:</span></span><br /><br /> <span data-ttu-id="12d13-132">-如果源列不是**decimal**或**numeric**，则使用默认的精度和小数位数。</span><span class="sxs-lookup"><span data-stu-id="12d13-132">-   If the source column is not **decimal** or **numeric**, the default precision and scale are used.</span></span><br /><span data-ttu-id="12d13-133">-如果源列为**decimal**或**numeric**，则使用源列的精度和小数位数。</span><span class="sxs-lookup"><span data-stu-id="12d13-133">-   If the source column is **decimal** or **numeric**, the precision and scale of the source column are used.</span></span>|  
|<span data-ttu-id="12d13-134">BCP_FMT_INDICATOR_LEN</span><span class="sxs-lookup"><span data-stu-id="12d13-134">BCP_FMT_INDICATOR_LEN</span></span>|<span data-ttu-id="12d13-135">INT</span><span class="sxs-lookup"><span data-stu-id="12d13-135">INT</span></span>|<span data-ttu-id="12d13-136">以字节表示的指示器（前缀）的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-136">Is the length in bytes of the indicator (prefix).</span></span><br /><br /> <span data-ttu-id="12d13-137">它是列数据中以字节表示的长度/空指示器的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-137">It is the length, in bytes, of a length/null indicator within the column data.</span></span> <span data-ttu-id="12d13-138">有效的指示器长度值是 0（在未使用指示器时）、1、2 或 4。</span><span class="sxs-lookup"><span data-stu-id="12d13-138">Valid indicator length values are 0 (when using no indicator), 1, 2, or 4.</span></span><br /><br /> <span data-ttu-id="12d13-139">若要指定默认的大容量复制指示器用法，请将此参数设置为 SQL_VARLEN_DATA。</span><span class="sxs-lookup"><span data-stu-id="12d13-139">To specify default bulk copy indicator usage, set this parameter to SQL_VARLEN_DATA.</span></span><br /><br /> <span data-ttu-id="12d13-140">指示器在内存中出现在任何数据的紧前面，在数据文件中出现在它们适用于的数据的紧前面。</span><span class="sxs-lookup"><span data-stu-id="12d13-140">Indicators appear in memory directly before any data, and in the data file directly before the data to which they apply.</span></span><br /><br /> <span data-ttu-id="12d13-141">如果使用多种方法来指定数据文件列长度（例如指示器和最大列长度，或者指示器和终止符序列），则大容量复制将选择导致数据复制量最少的方法。</span><span class="sxs-lookup"><span data-stu-id="12d13-141">If more than one means of specifying a data file column length is used (such as an indicator and a maximum column length, or an indicator and a terminator sequence), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="12d13-142">如果列数据可能在长度上发生变化或列可能接受 NULL 作为值，则在没有调整数据格式的用户干预时，大容量复制生成的数据文件将包含指示器。</span><span class="sxs-lookup"><span data-stu-id="12d13-142">Data files generated by bulk copy when no user intervention adjusts the format of the data contain indicators when the column data can vary in length or the column can accept NULL as a value.</span></span>|  
|<span data-ttu-id="12d13-143">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="12d13-143">BCP_FMT_DATA_LEN</span></span>|<span data-ttu-id="12d13-144">DBINT</span><span class="sxs-lookup"><span data-stu-id="12d13-144">DBINT</span></span>|<span data-ttu-id="12d13-145">用字节表示的数据的长度（列长度）。</span><span class="sxs-lookup"><span data-stu-id="12d13-145">Is the length in bytes of the data (column length)</span></span><br /><br /> <span data-ttu-id="12d13-146">它是用户文件中此列的数据的用字节表示的最大长度，不包括任何长度指示器或终止符的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-146">It is the maximum length, in bytes, of this column's data in the user file, not including the length of any length indicator or terminator.</span></span><br /><br /> <span data-ttu-id="12d13-147">如果将 BCP_FMT_DATA_LEN 设置为 SQL_NULL_DATA，则指示数据文件列中的所有值均为或应该设置为 NULL。</span><span class="sxs-lookup"><span data-stu-id="12d13-147">Setting BCP_FMT_DATA_LEN to SQL_NULL_DATA indicates that all values in the data file column are, or should be set to, NULL.</span></span><br /><br /> <span data-ttu-id="12d13-148">如果将 BCP_FMT_DATA_LEN 设置为 SQL_VARLEN_DATA，则指示系统应确定各列中数据的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-148">Setting BCP_FMT_DATA_LEN to SQL_VARLEN_DATA indicates that the system should determine the length of data in each column.</span></span> <span data-ttu-id="12d13-149">对于某些列，这可能意味着生成长度/空指示符，以便置于来自 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的副本的数据前，或者意味着该指示符应位于复制到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的数据中。</span><span class="sxs-lookup"><span data-stu-id="12d13-149">For some columns, this could mean that a length/null indicator is generated to precede data on a copy from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or that the indicator is expected in data copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="12d13-150">对于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字符和二进制数据类型，BCP_FMT_DATA_LEN 可以是 SQL_VARLEN_DATA、SQL_NULL_DATA、0 或者某些正值。</span><span class="sxs-lookup"><span data-stu-id="12d13-150">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character and binary data types, BCP_FMT_DATA_LEN can be SQL_VARLEN_DATA, SQL_NULL_DATA, 0, or some positive value.</span></span> <span data-ttu-id="12d13-151">如果 BCP_FMT_DATA_LEN 是 SQL_VARLEN_DATA，则系统将使用长度指示符（如果存在）或终止符序列，以便确定数据的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-151">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the system uses either the length indicator, if present, or a terminator sequence to determine the length of the data.</span></span> <span data-ttu-id="12d13-152">如果长度指示符和终止符序列均提供，则大容量复制将采用导致数据复制量最少的方法。</span><span class="sxs-lookup"><span data-stu-id="12d13-152">If both a length indicator and a terminator sequence are supplied, bulk copy uses the one that results in the least amount of data being copied.</span></span> <span data-ttu-id="12d13-153">如果 BCP_FMT_DATA_LEN 是 SQL_VARLEN_DATA，数据类型是 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字符或二进制类型，并且长度指示器和终止符序列均未指定，则系统将返回错误消息。</span><span class="sxs-lookup"><span data-stu-id="12d13-153">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the data type is an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character or binary type, and neither a length indicator nor a terminator sequence is specified, the system returns an error message.</span></span><br /><br /> <span data-ttu-id="12d13-154">如果 BCP_FMT_DATA_LEN 是 0 或正值，则系统使用 BCP_FMT_DATA_LEN 作为最大数据长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-154">If BCP_FMT_DATA_LEN is 0 or a positive value, the system uses BCP_FMT_DATA_LEN as the maximum data length.</span></span> <span data-ttu-id="12d13-155">但是，如果除了正的 BCP_FMT_DATA_LEN 外，还提供了长度指示器或终止符序列，则系统将通过使用导致数据复制量最少的方法，确定数据长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-155">However, if, in addition to a positive BCP_FMT_DATA_LEN, a length indicator or terminator sequence is provided, the system determines the data length by using the method that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="12d13-156">BCP_FMT_DATA_LEN 值表示数据的字节计数。</span><span class="sxs-lookup"><span data-stu-id="12d13-156">The BCP_FMT_DATA_LEN value represents the count of bytes of data.</span></span> <span data-ttu-id="12d13-157">如果字符数据由 Unicode 宽字符表示，则正的 BCP_FMT_DATA_LEN 参数值表示字符数目乘以每个字符的大小（用字节表示）。</span><span class="sxs-lookup"><span data-stu-id="12d13-157">If character data is represented by Unicode wide characters, then a positive BCP_FMT_DATA_LEN parameter value represents the number of characters multiplied by the size, in bytes, of each character.</span></span>|  
|<span data-ttu-id="12d13-158">BCP_FMT_TERMINATOR</span><span class="sxs-lookup"><span data-stu-id="12d13-158">BCP_FMT_TERMINATOR</span></span>|<span data-ttu-id="12d13-159">LPCBYTE</span><span class="sxs-lookup"><span data-stu-id="12d13-159">LPCBYTE</span></span>|<span data-ttu-id="12d13-160">指向要用于此列的终止符序列（相应为 ANSI 或 Unicode）的指针。</span><span class="sxs-lookup"><span data-stu-id="12d13-160">Pointer to the terminator sequence (either ANSI or Unicode as appropriate) to be used for this column.</span></span> <span data-ttu-id="12d13-161">此参数主要用于字符数据类型，因为所有其他类型均属于固定长度，或者在二进制数据的情况下，要求长度指示器以精确记录提供的字节数目。</span><span class="sxs-lookup"><span data-stu-id="12d13-161">This parameter is useful mainly for character data types because all other types are of fixed length or, in the case of binary data, require an indicator of length to accurately record the number of bytes present.</span></span><br /><br /> <span data-ttu-id="12d13-162">为了避免终止提取的数据，或者指示用户文件中的数据不终止，可将此参数设置为 NULL。</span><span class="sxs-lookup"><span data-stu-id="12d13-162">To avoid terminating extracted data, or to indicate that data in a user file is not terminated, set this parameter to NULL.</span></span><br /><br /> <span data-ttu-id="12d13-163">如果使用多种方法指定用户文件列长度（例如终止符和长度指示器，或者终止符和最大列长度），则大容量复制选择导致数据复制量最少的方法。</span><span class="sxs-lookup"><span data-stu-id="12d13-163">If more than one means of specifying a user-file column length is used (such as a terminator and a length indicator, or a terminator and a maximum column length), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="12d13-164">大容量复制 API 根据需要执行 Unicode 到 MBCS 的字符转换。</span><span class="sxs-lookup"><span data-stu-id="12d13-164">The bulk copy API performs Unicode-to-MBCS character conversion as required.</span></span> <span data-ttu-id="12d13-165">执行此操作时请务必小心，以便确保终止符字节字符串和字节字符串的长度都正确设置。</span><span class="sxs-lookup"><span data-stu-id="12d13-165">Care must be taken to ensure that both the terminator byte string and the length of the byte string are set correctly.</span></span>|  
|<span data-ttu-id="12d13-166">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="12d13-166">BCP_FMT_SERVER_COL</span></span>|<span data-ttu-id="12d13-167">INT</span><span class="sxs-lookup"><span data-stu-id="12d13-167">INT</span></span>|<span data-ttu-id="12d13-168">数据库中列的序号位置</span><span class="sxs-lookup"><span data-stu-id="12d13-168">Ordinal position of the column in the database</span></span>|  
|<span data-ttu-id="12d13-169">BCP_FMT_COLLATION</span><span class="sxs-lookup"><span data-stu-id="12d13-169">BCP_FMT_COLLATION</span></span>|<span data-ttu-id="12d13-170">LPCSTR</span><span class="sxs-lookup"><span data-stu-id="12d13-170">LPCSTR</span></span>|<span data-ttu-id="12d13-171">排序规则名。</span><span class="sxs-lookup"><span data-stu-id="12d13-171">Collation name.</span></span>|  
  
 <span data-ttu-id="12d13-172">*pValue*</span><span class="sxs-lookup"><span data-stu-id="12d13-172">*pValue*</span></span>  
 <span data-ttu-id="12d13-173">指向要关联到*属性*的值的指针。</span><span class="sxs-lookup"><span data-stu-id="12d13-173">Is the pointer to the value to associate to the *property*.</span></span> <span data-ttu-id="12d13-174">它允许单独设置每个列格式属性。</span><span class="sxs-lookup"><span data-stu-id="12d13-174">It allows each column format property to be set individually.</span></span>  
  
 <span data-ttu-id="12d13-175">*cbvalue*</span><span class="sxs-lookup"><span data-stu-id="12d13-175">*cbvalue*</span></span>  
 <span data-ttu-id="12d13-176">以字节表示的属性缓冲区的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-176">Is the length of the property buffer in bytes.</span></span>  
  
## <a name="returns"></a><span data-ttu-id="12d13-177">返回</span><span class="sxs-lookup"><span data-stu-id="12d13-177">Returns</span></span>  
 <span data-ttu-id="12d13-178">SUCCEED 或 FAIL。</span><span class="sxs-lookup"><span data-stu-id="12d13-178">SUCCEED or FAIL.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="12d13-179">备注</span><span class="sxs-lookup"><span data-stu-id="12d13-179">Remarks</span></span>  
 <span data-ttu-id="12d13-180">此函数取代了**bcp_colfmt**函数。</span><span class="sxs-lookup"><span data-stu-id="12d13-180">This function supersedes the **bcp_colfmt** function.</span></span> <span data-ttu-id="12d13-181">**Bcp_setcolfmt**函数中提供了**bcp_colfmt**的所有功能。</span><span class="sxs-lookup"><span data-stu-id="12d13-181">All the functionality of **bcp_colfmt** is provided in **bcp_setcolfmt** function.</span></span> <span data-ttu-id="12d13-182">此外，还提供对列排序规则的支持。</span><span class="sxs-lookup"><span data-stu-id="12d13-182">In addition, support for column collation is also provided.</span></span> <span data-ttu-id="12d13-183">建议按照下面给出的顺序设置以下列格式属性：</span><span class="sxs-lookup"><span data-stu-id="12d13-183">It is recommended that the following column format attributes be set in the order given below:</span></span>  
  
 <span data-ttu-id="12d13-184">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="12d13-184">BCP_FMT_SERVER_COL</span></span>  
  
 <span data-ttu-id="12d13-185">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="12d13-185">BCP_FMT_DATA_LEN</span></span>  
  
 <span data-ttu-id="12d13-186">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="12d13-186">BCP_FMT_TYPE</span></span>  
  
 <span data-ttu-id="12d13-187">**Bcp_setcolfmt**函数允许您为大容量复制指定用户文件格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-187">The **bcp_setcolfmt** function allows you to specify the user-file format for bulk copies.</span></span> <span data-ttu-id="12d13-188">对于大容量复制，格式包含以下部分：</span><span class="sxs-lookup"><span data-stu-id="12d13-188">For bulk copy, a format contains the following parts:</span></span>  
  
-   <span data-ttu-id="12d13-189">从用户文件列到数据库列的映射。</span><span class="sxs-lookup"><span data-stu-id="12d13-189">A mapping from user-file columns to database columns.</span></span>  
  
-   <span data-ttu-id="12d13-190">每个用户文件列的数据类型。</span><span class="sxs-lookup"><span data-stu-id="12d13-190">The data type of each user-file column.</span></span>  
  
-   <span data-ttu-id="12d13-191">每个列的可选指示符的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-191">The length of the optional indicator for each column.</span></span>  
  
-   <span data-ttu-id="12d13-192">每个用户文件列的数据的最大长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-192">The maximum length of data per user-file column.</span></span>  
  
-   <span data-ttu-id="12d13-193">每个列的可选终止字节序列。</span><span class="sxs-lookup"><span data-stu-id="12d13-193">The optional terminating byte sequence for each column.</span></span>  
  
-   <span data-ttu-id="12d13-194">可选终止字节序列的长度。</span><span class="sxs-lookup"><span data-stu-id="12d13-194">The length of the optional terminating byte sequence.</span></span>  
  
 <span data-ttu-id="12d13-195">对**bcp_setcolfmt**的每个调用都指定一个用户文件列的格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-195">Each call to **bcp_setcolfmt** specifies the format for one user-file column.</span></span> <span data-ttu-id="12d13-196">例如，若要更改五行用户数据文件中三列的默认设置，请首先调用[bcp_columns](bcp-columns.md) \*\* (5) **，然后调用**bcp_setcolfmt\*\* 5 次，其中三个调用设置您的自定义格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-196">For example, to change the default settings for three columns in a five-column user data file, first call [bcp_columns](bcp-columns.md)**(5)**, and then call **bcp_setcolfmt** five times, with three of those calls setting your custom format.</span></span> <span data-ttu-id="12d13-197">对于剩余的两次调用，将 BCP_FMT_TYPE 设置为0，并分别将 BCP_FMT_INDICATOR_LENGTH、BCP_FMT_DATA_LEN 和*cbValue*设置为0、SQL_VARLEN_DATA 和0。</span><span class="sxs-lookup"><span data-stu-id="12d13-197">For the remaining two calls, set BCP_FMT_TYPE to 0, and set BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN, and *cbValue* to 0, SQL_VARLEN_DATA, and 0 respectively.</span></span> <span data-ttu-id="12d13-198">此过程复制全部五列，其中的三列采用您的自定义格式，另两列采用默认格式。</span><span class="sxs-lookup"><span data-stu-id="12d13-198">This procedure copies all five columns, three with your customized format and two with the default format.</span></span>  
  
 <span data-ttu-id="12d13-199">调用**bcp_setcolfmt**之前，必须先调用**bcp_columns**函数。</span><span class="sxs-lookup"><span data-stu-id="12d13-199">The **bcp_columns** function must be called before calling **bcp_setcolfmt**.</span></span>  
  
 <span data-ttu-id="12d13-200">您必须对用户文件中每个列的每个属性调用一次**bcp_setcolfmt** 。</span><span class="sxs-lookup"><span data-stu-id="12d13-200">You must call **bcp_setcolfmt** once for each property of each column in the user file.</span></span>  
  
 <span data-ttu-id="12d13-201">您不需要将用户文件中的所有数据都复制到 SQL Server 表中。</span><span class="sxs-lookup"><span data-stu-id="12d13-201">You do not need to copy all data in a user file to the SQL Server table.</span></span> <span data-ttu-id="12d13-202">若要跳过某一列，请指定该列的数据格式，并且将 BCP_FMT_SERVER_COL 参数设置为 0。</span><span class="sxs-lookup"><span data-stu-id="12d13-202">To skip a column, specify the format of the data for the column, setting the BCP_FMT_SERVER_COL parameter to 0.</span></span> <span data-ttu-id="12d13-203">如果您要跳过某一列，则必须指定其类型。</span><span class="sxs-lookup"><span data-stu-id="12d13-203">If you want to skip a column, you must specify its type.</span></span>  
  
 <span data-ttu-id="12d13-204">[Bcp_writefmt](bcp-writefmt.md)函数可用于保留格式规范。</span><span class="sxs-lookup"><span data-stu-id="12d13-204">The [bcp_writefmt](bcp-writefmt.md) function can be used to persist the format specification.</span></span>  
  
## <a name="bcp_setcolfmt-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="12d13-205">针对增强的日期和时间功能的 bcp_setcolfmt 支持</span><span class="sxs-lookup"><span data-stu-id="12d13-205">bcp_setcolfmt Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="12d13-206">与日期/时间类型的 BCP_FMT_TYPE 属性一起使用的类型是在[&#40;OLE DB 和 ODBC&#41;的增强日期和时间类型的大容量复制更改](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md)中指定的。</span><span class="sxs-lookup"><span data-stu-id="12d13-206">The types used with the BCP_FMT_TYPE property for date/time types are as specified in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
 <span data-ttu-id="12d13-207">有关详细信息，请参阅[ODBC&#41;&#40;日期和时间改进](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="12d13-207">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="12d13-208">另请参阅</span><span class="sxs-lookup"><span data-stu-id="12d13-208">See Also</span></span>  
 [<span data-ttu-id="12d13-209">大容量复制函数</span><span class="sxs-lookup"><span data-stu-id="12d13-209">Bulk Copy Functions</span></span>](sql-server-driver-extensions-bulk-copy-functions.md)  
  
  
