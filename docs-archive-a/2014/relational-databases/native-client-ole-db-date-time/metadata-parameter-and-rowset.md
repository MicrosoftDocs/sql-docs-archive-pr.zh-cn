---
title: 参数和行集元数据 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- metadata [OLE DB]
ms.assetid: 31b318a4-20e7-4db0-b367-eb9938859029
author: rothja
ms.author: jroth
ms.openlocfilehash: f3bddb4d83a8904b3def70853fe1e6614dd48d9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688891"
---
# <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="dec4b-102">参数和行集元数据</span><span class="sxs-lookup"><span data-stu-id="dec4b-102">Parameter and Rowset Metadata</span></span>
  <span data-ttu-id="dec4b-103">本主题提供了与 OLE DB 日期和时间增强功能相关的以下类型和类型成员的相关信息。</span><span class="sxs-lookup"><span data-stu-id="dec4b-103">This topic provides information about the following type and type members, related to the OLE DB date and time enhancements.</span></span>  
  
-   <span data-ttu-id="dec4b-104">DBBINDING 结构</span><span class="sxs-lookup"><span data-stu-id="dec4b-104">DBBINDING structure</span></span>  
  
-   `ICommandWithParameters::GetParameterInfo`  
  
-   `ICommandWithParameters::SetParameterInfo`  
  
-   `IColumnsRowset::GetColumnsRowset`  
  
-   `IColumnsInfo::GetColumnInfo`  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="dec4b-105">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="dec4b-105">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="dec4b-106">通过 prgParamInfo 在 DBPARAMINFO 结构中返回以下信息\*\*：</span><span class="sxs-lookup"><span data-stu-id="dec4b-106">The following information is returned in the DBPARAMINFO structure through *prgParamInfo*:</span></span>  
  
|<span data-ttu-id="dec4b-107">参数类型</span><span class="sxs-lookup"><span data-stu-id="dec4b-107">Parameter Type</span></span>|<span data-ttu-id="dec4b-108">*wType*</span><span class="sxs-lookup"><span data-stu-id="dec4b-108">*wType*</span></span>|<span data-ttu-id="dec4b-109">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="dec4b-109">*ulParamSize*</span></span>|<span data-ttu-id="dec4b-110">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="dec4b-110">*bPrecision*</span></span>|<span data-ttu-id="dec4b-111">*bScale*</span><span class="sxs-lookup"><span data-stu-id="dec4b-111">*bScale*</span></span>|<span data-ttu-id="dec4b-112">dwFlags\*\*</span><span class="sxs-lookup"><span data-stu-id="dec4b-112">*dwFlags*</span></span><br /><br /> <span data-ttu-id="dec4b-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="dec4b-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="dec4b-114">date</span><span class="sxs-lookup"><span data-stu-id="dec4b-114">date</span></span>|<span data-ttu-id="dec4b-115">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-115">DBTYPE_DBDATE</span></span>|<span data-ttu-id="dec4b-116">6</span><span class="sxs-lookup"><span data-stu-id="dec4b-116">6</span></span>|<span data-ttu-id="dec4b-117">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-117">10</span></span>|<span data-ttu-id="dec4b-118">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-118">0</span></span>|<span data-ttu-id="dec4b-119">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-119">Clear</span></span>|  
|<span data-ttu-id="dec4b-120">time</span><span class="sxs-lookup"><span data-stu-id="dec4b-120">time</span></span>|<span data-ttu-id="dec4b-121">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="dec4b-121">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="dec4b-122">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-122">10</span></span>|<span data-ttu-id="dec4b-123">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="dec4b-123">8, 10..16</span></span>|<span data-ttu-id="dec4b-124">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-124">0..7</span></span>|<span data-ttu-id="dec4b-125">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-125">Set</span></span>|  
|<span data-ttu-id="dec4b-126">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-126">smalldatetime</span></span>|<span data-ttu-id="dec4b-127">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-127">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-128">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-128">16</span></span>|<span data-ttu-id="dec4b-129">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-129">16</span></span>|<span data-ttu-id="dec4b-130">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-130">0</span></span>|<span data-ttu-id="dec4b-131">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-131">Clear</span></span>|  
|<span data-ttu-id="dec4b-132">datetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-132">datetime</span></span>|<span data-ttu-id="dec4b-133">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-133">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-134">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-134">16</span></span>|<span data-ttu-id="dec4b-135">23</span><span class="sxs-lookup"><span data-stu-id="dec4b-135">23</span></span>|<span data-ttu-id="dec4b-136">3</span><span class="sxs-lookup"><span data-stu-id="dec4b-136">3</span></span>|<span data-ttu-id="dec4b-137">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-137">Clear</span></span>|  
|<span data-ttu-id="dec4b-138">datetime2</span><span class="sxs-lookup"><span data-stu-id="dec4b-138">datetime2</span></span>|<span data-ttu-id="dec4b-139">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-139">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-140">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-140">16</span></span>|<span data-ttu-id="dec4b-141">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="dec4b-141">19,21..27</span></span>|<span data-ttu-id="dec4b-142">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-142">0..7</span></span>|<span data-ttu-id="dec4b-143">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-143">Set</span></span>|  
|<span data-ttu-id="dec4b-144">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="dec4b-144">datetimeoffset</span></span>|<span data-ttu-id="dec4b-145">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="dec4b-145">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="dec4b-146">20</span><span class="sxs-lookup"><span data-stu-id="dec4b-146">20</span></span>|<span data-ttu-id="dec4b-147">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="dec4b-147">26,28..34</span></span>|<span data-ttu-id="dec4b-148">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-148">0..7</span></span>|<span data-ttu-id="dec4b-149">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-149">Set</span></span>|  
  
 <span data-ttu-id="dec4b-150">请注意，在某些情况下，值范围不是连续的。</span><span class="sxs-lookup"><span data-stu-id="dec4b-150">Notice that in some cases value ranges are not continuous.</span></span> <span data-ttu-id="dec4b-151">这是因为当小数精度大于零时添加了小数点。</span><span class="sxs-lookup"><span data-stu-id="dec4b-151">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
 <span data-ttu-id="dec4b-152">DBPARAMFLAGS_SS_ISVARIABLESCALE 只有在连接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]（或更高版本）服务器时才有效。</span><span class="sxs-lookup"><span data-stu-id="dec4b-152">DBPARAMFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="dec4b-153">当连接到下级服务器时，永远不会设置 DBPARAMFLAGS_SS_ISVARIABLESCALE。</span><span class="sxs-lookup"><span data-stu-id="dec4b-153">DBPARAMFLAGS_SS_ISVARIABLESCALE is never set when connected to down-level servers.</span></span>  
  
## <a name="icommandwithparameterssetparameterinfo-and-implied-parameter-types"></a><span data-ttu-id="dec4b-154">ICommandWithParameters::SetParameterInfo 和隐含的参数类型</span><span class="sxs-lookup"><span data-stu-id="dec4b-154">ICommandWithParameters::SetParameterInfo and Implied Parameter Types</span></span>  
 <span data-ttu-id="dec4b-155">在 DBPARAMBINDINFO 结构中提供的信息必须符合以下规定：</span><span class="sxs-lookup"><span data-stu-id="dec4b-155">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="dec4b-156">pwszDataSourceType\*\*</span><span class="sxs-lookup"><span data-stu-id="dec4b-156">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="dec4b-157">（特定于访问接口）</span><span class="sxs-lookup"><span data-stu-id="dec4b-157">(provider specific)</span></span>|<span data-ttu-id="dec4b-158">pwszDataSourceType\*\*</span><span class="sxs-lookup"><span data-stu-id="dec4b-158">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="dec4b-159">（一般 OLE DB）</span><span class="sxs-lookup"><span data-stu-id="dec4b-159">(OLE DB generic)</span></span>|<span data-ttu-id="dec4b-160">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="dec4b-160">*ulParamSize*</span></span>|<span data-ttu-id="dec4b-161">*bScale*</span><span class="sxs-lookup"><span data-stu-id="dec4b-161">*bScale*</span></span>|  
|----------------------------------------------------|-------------------------------------------------|-------------------|--------------|  
||<span data-ttu-id="dec4b-162">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-162">DBTYPE_DATE</span></span>|<span data-ttu-id="dec4b-163">6</span><span class="sxs-lookup"><span data-stu-id="dec4b-163">6</span></span>|<span data-ttu-id="dec4b-164">忽略</span><span class="sxs-lookup"><span data-stu-id="dec4b-164">Ignored</span></span>|  
|<span data-ttu-id="dec4b-165">date</span><span class="sxs-lookup"><span data-stu-id="dec4b-165">date</span></span>|<span data-ttu-id="dec4b-166">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-166">DBTYPE_DBDATE</span></span>|<span data-ttu-id="dec4b-167">6</span><span class="sxs-lookup"><span data-stu-id="dec4b-167">6</span></span>|<span data-ttu-id="dec4b-168">忽略</span><span class="sxs-lookup"><span data-stu-id="dec4b-168">Ignored</span></span>|  
||<span data-ttu-id="dec4b-169">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="dec4b-169">DBTYPE_DBTIME</span></span>|<span data-ttu-id="dec4b-170">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-170">10</span></span>|<span data-ttu-id="dec4b-171">忽略</span><span class="sxs-lookup"><span data-stu-id="dec4b-171">Ignored</span></span>|  
|<span data-ttu-id="dec4b-172">time</span><span class="sxs-lookup"><span data-stu-id="dec4b-172">time</span></span>|<span data-ttu-id="dec4b-173">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="dec4b-173">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="dec4b-174">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-174">10</span></span>|<span data-ttu-id="dec4b-175">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-175">0..7</span></span>|  
|<span data-ttu-id="dec4b-176">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-176">smalldatetime</span></span>||<span data-ttu-id="dec4b-177">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-177">16</span></span>|<span data-ttu-id="dec4b-178">忽略</span><span class="sxs-lookup"><span data-stu-id="dec4b-178">Ignored</span></span>|  
|<span data-ttu-id="dec4b-179">datetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-179">datetime</span></span>||<span data-ttu-id="dec4b-180">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-180">16</span></span>|<span data-ttu-id="dec4b-181">忽略</span><span class="sxs-lookup"><span data-stu-id="dec4b-181">Ignored</span></span>|  
|<span data-ttu-id="dec4b-182">datetime2 或 DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-182">datetime2 or DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-183">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-183">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-184">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-184">16</span></span>|<span data-ttu-id="dec4b-185">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-185">0..7</span></span>|  
|<span data-ttu-id="dec4b-186">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="dec4b-186">datetimeoffset</span></span>|<span data-ttu-id="dec4b-187">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="dec4b-187">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="dec4b-188">20</span><span class="sxs-lookup"><span data-stu-id="dec4b-188">20</span></span>|<span data-ttu-id="dec4b-189">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-189">0..7</span></span>|  
  
 <span data-ttu-id="dec4b-190">bPrecision\*\* 参数将被忽略。</span><span class="sxs-lookup"><span data-stu-id="dec4b-190">The *bPrecision* parameter is ignored.</span></span>  
  
 <span data-ttu-id="dec4b-191">向服务器发送数据时将忽略“DBPARAMFLAGS_SS_ISVARIABLESCALE”。</span><span class="sxs-lookup"><span data-stu-id="dec4b-191">"DBPARAMFLAGS_SS_ISVARIABLESCALE" is ignored when sending data to the server.</span></span> <span data-ttu-id="dec4b-192">通过使用特定于访问接口的类型名称 "`datetime`”和“`smalldatetime`”，应用程序可以强制使用旧的表格格式数据流 (TDS) 类型。</span><span class="sxs-lookup"><span data-stu-id="dec4b-192">Applications can force the use of legacy tabular-data stream (TDS) types by using the provider-specific type names "`datetime`" and "`smalldatetime`".</span></span> <span data-ttu-id="dec4b-193">当连接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (或更高版本) 服务器时， `datetime2` 将使用 "" 格式，并根据需要在类型名称为 " `datetime2` " 或 "DBTYPE_DBTIMESTAMP" 时进行隐式服务器转换。</span><span class="sxs-lookup"><span data-stu-id="dec4b-193">When connected to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) servers, "`datetime2`" format will be used and an implicit server conversion will occur, if necessary, when the type name is "`datetime2`" or "DBTYPE_DBTIMESTAMP".</span></span> <span data-ttu-id="dec4b-194">*bScale*如果使用提供程序特定的类型名称 " `datetime` " 或 ""，则将忽略 bScale `smalldatetime` 。</span><span class="sxs-lookup"><span data-stu-id="dec4b-194">*bScale* is ignored if the provider specific type names "`datetime`" or "`smalldatetime`" are used.</span></span> <span data-ttu-id="dec4b-195">否则，appications 必须确保正确设置*bScale* 。</span><span class="sxs-lookup"><span data-stu-id="dec4b-195">Otherwise, appications must ensure that *bScale* is set correctly.</span></span> <span data-ttu-id="dec4b-196">从 MDAC 升级的应用程序和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 使用 "DBTYPE_DBTIMESTAMP" 的 Native Client 的应用程序如果未正确设置*bScale* ，则会失败。</span><span class="sxs-lookup"><span data-stu-id="dec4b-196">Applications upgraded from MDAC and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that use "DBTYPE_DBTIMESTAMP" will fail if they do not set *bScale* correctly.</span></span> <span data-ttu-id="dec4b-197">当连接到早于 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 的服务器实例时，采用“DBTYPE_DBTIMESTAMP”且值不为 0 或 3 的 bScale 值不正确，并且将返回 E_FAIL\*\*。</span><span class="sxs-lookup"><span data-stu-id="dec4b-197">When connected to server instances earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], a *bScale* value other than 0 or 3 with "DBTYPE_DBTIMESTAMP" is an error and E_FAIL will be returned.</span></span>  
  
 <span data-ttu-id="dec4b-198">如果未调用 ICommandWithParameters：： SetParameterInfo，则提供程序将在 IAccessor：： CreateAccessor 中指定的绑定类型中表示服务器类型，如下所示：</span><span class="sxs-lookup"><span data-stu-id="dec4b-198">When ICommandWithParameters::SetParameterInfo is not called, the provider imples the server type from the binding type as specified in IAccessor::CreateAccessor as follows:</span></span>  
  
|<span data-ttu-id="dec4b-199">绑定类型</span><span class="sxs-lookup"><span data-stu-id="dec4b-199">Binding Type</span></span>|<span data-ttu-id="dec4b-200">pwszDataSourceType\*\*</span><span class="sxs-lookup"><span data-stu-id="dec4b-200">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="dec4b-201">（特定于访问接口）</span><span class="sxs-lookup"><span data-stu-id="dec4b-201">(provider specific)</span></span>|  
|------------------|----------------------------------------------------|  
|<span data-ttu-id="dec4b-202">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-202">DBTYPE_DATE</span></span>|<span data-ttu-id="dec4b-203">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="dec4b-203">datetime2(0)</span></span>|  
|<span data-ttu-id="dec4b-204">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-204">DBTYPE_DBDATE</span></span>|<span data-ttu-id="dec4b-205">date</span><span class="sxs-lookup"><span data-stu-id="dec4b-205">date</span></span>|  
|<span data-ttu-id="dec4b-206">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="dec4b-206">DBTYPE_DBTIME</span></span>|<span data-ttu-id="dec4b-207">time(0)</span><span class="sxs-lookup"><span data-stu-id="dec4b-207">time(0)</span></span>|  
|<span data-ttu-id="dec4b-208">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="dec4b-208">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="dec4b-209">time(7)</span><span class="sxs-lookup"><span data-stu-id="dec4b-209">time(7)</span></span>|  
|<span data-ttu-id="dec4b-210">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-210">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-211">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="dec4b-211">datetime2(7)</span></span>|  
|<span data-ttu-id="dec4b-212">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="dec4b-212">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="dec4b-213">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="dec4b-213">datetimeoffset(7)</span></span>|  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="dec4b-214">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="dec4b-214">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="dec4b-215">`IColumnsRowset::GetColumnsRowset` 返回以下各列：</span><span class="sxs-lookup"><span data-stu-id="dec4b-215">`IColumnsRowset::GetColumnsRowset` returns the following columns:</span></span>  
  
|<span data-ttu-id="dec4b-216">列类型</span><span class="sxs-lookup"><span data-stu-id="dec4b-216">Column Type</span></span>|<span data-ttu-id="dec4b-217">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="dec4b-217">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="dec4b-218">DBCOLUM_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="dec4b-218">DBCOLUM_COLUMNSIZE</span></span>|<span data-ttu-id="dec4b-219">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="dec4b-219">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="dec4b-220">DBCOLUMN_SCALE、DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="dec4b-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|<span data-ttu-id="dec4b-221">DBCOLUMN_FLAGS、DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="dec4b-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span></span>|  
|-----------------|--------------------|-------------------------|-------------------------|--------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="dec4b-222">date</span><span class="sxs-lookup"><span data-stu-id="dec4b-222">date</span></span>|<span data-ttu-id="dec4b-223">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-223">DBTYPE_DBDATE</span></span>|<span data-ttu-id="dec4b-224">6</span><span class="sxs-lookup"><span data-stu-id="dec4b-224">6</span></span>|<span data-ttu-id="dec4b-225">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-225">10</span></span>|<span data-ttu-id="dec4b-226">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-226">0</span></span>|<span data-ttu-id="dec4b-227">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-227">Clear</span></span>|  
|<span data-ttu-id="dec4b-228">time</span><span class="sxs-lookup"><span data-stu-id="dec4b-228">time</span></span>|<span data-ttu-id="dec4b-229">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="dec4b-229">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="dec4b-230">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-230">10</span></span>|<span data-ttu-id="dec4b-231">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="dec4b-231">8, 10..16</span></span>|<span data-ttu-id="dec4b-232">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-232">0..7</span></span>|<span data-ttu-id="dec4b-233">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-233">Set</span></span>|  
|<span data-ttu-id="dec4b-234">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-234">smalldatetime</span></span>|<span data-ttu-id="dec4b-235">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-235">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-236">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-236">16</span></span>|<span data-ttu-id="dec4b-237">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-237">16</span></span>|<span data-ttu-id="dec4b-238">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-238">0</span></span>|<span data-ttu-id="dec4b-239">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-239">Clear</span></span>|  
|<span data-ttu-id="dec4b-240">datetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-240">datetime</span></span>|<span data-ttu-id="dec4b-241">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-241">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-242">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-242">16</span></span>|<span data-ttu-id="dec4b-243">23</span><span class="sxs-lookup"><span data-stu-id="dec4b-243">23</span></span>|<span data-ttu-id="dec4b-244">3</span><span class="sxs-lookup"><span data-stu-id="dec4b-244">3</span></span>|<span data-ttu-id="dec4b-245">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-245">Clear</span></span>|  
|<span data-ttu-id="dec4b-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="dec4b-246">datetime2</span></span>|<span data-ttu-id="dec4b-247">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-247">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-248">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-248">16</span></span>|<span data-ttu-id="dec4b-249">19、21..27</span><span class="sxs-lookup"><span data-stu-id="dec4b-249">19, 21..27</span></span>|<span data-ttu-id="dec4b-250">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-250">0..7</span></span>|<span data-ttu-id="dec4b-251">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-251">Set</span></span>|  
|<span data-ttu-id="dec4b-252">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="dec4b-252">datetimeoffset</span></span>|<span data-ttu-id="dec4b-253">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="dec4b-253">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="dec4b-254">20</span><span class="sxs-lookup"><span data-stu-id="dec4b-254">20</span></span>|<span data-ttu-id="dec4b-255">26、28..34</span><span class="sxs-lookup"><span data-stu-id="dec4b-255">26, 28..34</span></span>|<span data-ttu-id="dec4b-256">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-256">0..7</span></span>|<span data-ttu-id="dec4b-257">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-257">Set</span></span>|  
  
 <span data-ttu-id="dec4b-258">在 DBCOLUMN_FLAGS 中，对于日期/时间类型，DBCOLUMNFLAGS_ISFIXEDLENGTH 始终为 True，而下列标志则始终为 False：</span><span class="sxs-lookup"><span data-stu-id="dec4b-258">In DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="dec4b-259">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="dec4b-259">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="dec4b-260">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="dec4b-260">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="dec4b-261">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="dec4b-261">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="dec4b-262">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="dec4b-262">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="dec4b-263">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="dec4b-263">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="dec4b-264">DBCOLUMNFLAGS_ISROWVER</span><span class="sxs-lookup"><span data-stu-id="dec4b-264">DBCOLUMNFLAGS_ISROWVER</span></span>  
  
-   <span data-ttu-id="dec4b-265">DBCOLUMNFLAGS_MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="dec4b-265">DBCOLUMNFLAGS_MAYDEFER</span></span>  
  
 <span data-ttu-id="dec4b-266">可根据列的定义方式和实际查询设置其余标志（DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE 和 DBCOLUMNFLAGS_WRITEUNKNOWN）。</span><span class="sxs-lookup"><span data-stu-id="dec4b-266">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set, depending on how the column is defined and the actual query.</span></span>  
  
 <span data-ttu-id="dec4b-267">DBCOLUMN_FLAGS 中提供了新的 DBCOLUMNFLAGS_SS_ISVARIABLESCALE 标志，以使应用程序可以确定列的服务器类型，其中 DBCOLUMN_TYPE 为 DBTYPE_DBTIMESTAMP。</span><span class="sxs-lookup"><span data-stu-id="dec4b-267">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in DBCOLUMN_FLAGS to allow an application to determine the server type of columns, where DBCOLUMN_TYPE is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="dec4b-268">还必须使用 DBCOLUMN_SCALE 或 DBCOLUMN_DATETIMEPRECISION 标识服务器类型。</span><span class="sxs-lookup"><span data-stu-id="dec4b-268">DBCOLUMN_SCALE or DBCOLUMN_DATETIMEPRECISION must also be used to identify the server type.</span></span>  
  
 <span data-ttu-id="dec4b-269">仅当连接到 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]（或更高版本）服务器时 DBCOLUMNFLAGS_SS_ISVARIABLESCALE 才有效。</span><span class="sxs-lookup"><span data-stu-id="dec4b-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="dec4b-270">当连接到下级服务器时，未定义 DBCOLUMNFLAGS_SS_ISVARIABLESCALE。</span><span class="sxs-lookup"><span data-stu-id="dec4b-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is undefined when connected to down-level servers.</span></span>  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="dec4b-271">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="dec4b-271">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="dec4b-272">DBCOLUMNINFO 结构返回以下信息：</span><span class="sxs-lookup"><span data-stu-id="dec4b-272">DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="dec4b-273">参数类型</span><span class="sxs-lookup"><span data-stu-id="dec4b-273">Parameter Type</span></span>|<span data-ttu-id="dec4b-274">*wType*</span><span class="sxs-lookup"><span data-stu-id="dec4b-274">*wType*</span></span>|<span data-ttu-id="dec4b-275">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="dec4b-275">*ulColumnSize*</span></span>|<span data-ttu-id="dec4b-276">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="dec4b-276">*bPrecision*</span></span>|<span data-ttu-id="dec4b-277">*bScale*</span><span class="sxs-lookup"><span data-stu-id="dec4b-277">*bScale*</span></span>|<span data-ttu-id="dec4b-278">dwFlags\*\*</span><span class="sxs-lookup"><span data-stu-id="dec4b-278">*dwFlags*</span></span><br /><br /> <span data-ttu-id="dec4b-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="dec4b-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="dec4b-280">date</span><span class="sxs-lookup"><span data-stu-id="dec4b-280">date</span></span>|<span data-ttu-id="dec4b-281">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="dec4b-281">DBTYPE_DBDATE</span></span>|<span data-ttu-id="dec4b-282">6</span><span class="sxs-lookup"><span data-stu-id="dec4b-282">6</span></span>|<span data-ttu-id="dec4b-283">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-283">10</span></span>|<span data-ttu-id="dec4b-284">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-284">0</span></span>|<span data-ttu-id="dec4b-285">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-285">Clear</span></span>|  
|<span data-ttu-id="dec4b-286">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="dec4b-286">time(1..7)</span></span>|<span data-ttu-id="dec4b-287">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="dec4b-287">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="dec4b-288">10</span><span class="sxs-lookup"><span data-stu-id="dec4b-288">10</span></span>|<span data-ttu-id="dec4b-289">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="dec4b-289">8, 10..16</span></span>|<span data-ttu-id="dec4b-290">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-290">0..7</span></span>|<span data-ttu-id="dec4b-291">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-291">Set</span></span>|  
|<span data-ttu-id="dec4b-292">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-292">smalldatetime</span></span>|<span data-ttu-id="dec4b-293">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-293">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-294">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-294">16</span></span>|<span data-ttu-id="dec4b-295">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-295">16</span></span>|<span data-ttu-id="dec4b-296">0</span><span class="sxs-lookup"><span data-stu-id="dec4b-296">0</span></span>|<span data-ttu-id="dec4b-297">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-297">Clear</span></span>|  
|<span data-ttu-id="dec4b-298">datetime</span><span class="sxs-lookup"><span data-stu-id="dec4b-298">datetime</span></span>|<span data-ttu-id="dec4b-299">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-299">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-300">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-300">16</span></span>|<span data-ttu-id="dec4b-301">23</span><span class="sxs-lookup"><span data-stu-id="dec4b-301">23</span></span>|<span data-ttu-id="dec4b-302">3</span><span class="sxs-lookup"><span data-stu-id="dec4b-302">3</span></span>|<span data-ttu-id="dec4b-303">清除</span><span class="sxs-lookup"><span data-stu-id="dec4b-303">Clear</span></span>|  
|<span data-ttu-id="dec4b-304">datetime2</span><span class="sxs-lookup"><span data-stu-id="dec4b-304">datetime2</span></span>|<span data-ttu-id="dec4b-305">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="dec4b-305">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="dec4b-306">16</span><span class="sxs-lookup"><span data-stu-id="dec4b-306">16</span></span>|<span data-ttu-id="dec4b-307">19、21..27</span><span class="sxs-lookup"><span data-stu-id="dec4b-307">19, 21..27</span></span>|<span data-ttu-id="dec4b-308">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-308">0..7</span></span>|<span data-ttu-id="dec4b-309">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-309">Set</span></span>|  
|<span data-ttu-id="dec4b-310">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="dec4b-310">datetimeoffset</span></span>|<span data-ttu-id="dec4b-311">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="dec4b-311">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="dec4b-312">20</span><span class="sxs-lookup"><span data-stu-id="dec4b-312">20</span></span>|<span data-ttu-id="dec4b-313">26、28..34</span><span class="sxs-lookup"><span data-stu-id="dec4b-313">26, 28..34</span></span>|<span data-ttu-id="dec4b-314">0..7</span><span class="sxs-lookup"><span data-stu-id="dec4b-314">0..7</span></span>|<span data-ttu-id="dec4b-315">设置</span><span class="sxs-lookup"><span data-stu-id="dec4b-315">Set</span></span>|  
  
 <span data-ttu-id="dec4b-316">在 dwFlags 中，对于日期/时间类型，DBCOLUMNFLAGS_ISFIXEDLENGTH 始终为 True，而下列标志则始终为 False\*\*：</span><span class="sxs-lookup"><span data-stu-id="dec4b-316">In *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="dec4b-317">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="dec4b-317">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="dec4b-318">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="dec4b-318">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="dec4b-319">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="dec4b-319">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="dec4b-320">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="dec4b-320">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="dec4b-321">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="dec4b-321">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="dec4b-322">DBCOLUMNFLAGS_ISROWVER、MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="dec4b-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span></span>  
  
 <span data-ttu-id="dec4b-323">可以设置其余标志（DBCOLUMNFLAGS_ISNULLABLE、DBCOLUMNFLAGS_MAYBENULL、DBCOLUMNFLAGS_WRITE 和 DBCOLUMNFLAGS_WRITEUNKNOWN）。</span><span class="sxs-lookup"><span data-stu-id="dec4b-323">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set.</span></span>  
  
 <span data-ttu-id="dec4b-324">dwFlags 中提供了新的 DBCOLUMNFLAGS_SS_ISVARIABLESCALE 标志，以使应用程序可以确定列的服务器类型，其中 wType 为 DBTYPE_DBTIMESTAMP\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dec4b-324">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in *dwFlags* to allow an application to determine the server type of columns, where *wType* is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="dec4b-325">还必须使用 bScale 来标识服务器类型\*\*。</span><span class="sxs-lookup"><span data-stu-id="dec4b-325">*bScale* must also be used to identify the server type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dec4b-326">另请参阅</span><span class="sxs-lookup"><span data-stu-id="dec4b-326">See Also</span></span>  
 [<span data-ttu-id="dec4b-327">元数据 &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="dec4b-327">Metadata &#40;OLE DB&#41;</span></span>](../../database-engine/dev-guide/metadata-ole-db.md)  
  
  
