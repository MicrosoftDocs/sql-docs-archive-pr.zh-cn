---
title: 在服务器和客户端之间执行的转换 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- conversions [OLE DB], server to client
ms.assetid: 676fdf24-fb72-4ea0-a8d2-2b197da3c83f
author: rothja
ms.author: jroth
ms.openlocfilehash: dc64241eb76d59be457862ee5a9e7dd9fc8b84d8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692370"
---
# <a name="conversions-performed-from-server-to-client"></a><span data-ttu-id="02bec-102">在服务器和客户端之间执行的转换</span><span class="sxs-lookup"><span data-stu-id="02bec-102">Conversions Performed from Server to Client</span></span>
  <span data-ttu-id="02bec-103">本主题说明在 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]（或更高版本）与使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 编写的客户端应用程序之间执行的日期/时间转换。</span><span class="sxs-lookup"><span data-stu-id="02bec-103">This topic describes date/time conversions performed between [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) and a client application written with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="02bec-104">转换</span><span class="sxs-lookup"><span data-stu-id="02bec-104">Conversions</span></span>  
 <span data-ttu-id="02bec-105">下表说明了返回到客户端的类型与绑定中的类型之间的转换。</span><span class="sxs-lookup"><span data-stu-id="02bec-105">The following table describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="02bec-106">对于输出参数，如果已调用 ICommandWithParameters::SetParameterInfo，并且在 pwszDataSourceType\*\* 中指定的类型与服务器上的实际类型不匹配，该服务器将执行隐式转换，并且返回到客户端的类型将与通过 ICommandWithParameters::SetParameterInfo 指定的类型匹配。</span><span class="sxs-lookup"><span data-stu-id="02bec-106">For output parameters, if ICommandWithParameters::SetParameterInfo has been called and the type specified in *pwszDataSourceType* does not match the actual type on the server, an implicit conversion will be performed by the server, and the type returned to the client will match the type specified through ICommandWithParameters::SetParameterInfo.</span></span> <span data-ttu-id="02bec-107">当服务器的转换规则与本主题中描述的规则不同时，这可能会导致意外的转换结果。</span><span class="sxs-lookup"><span data-stu-id="02bec-107">This can lead to unexpected conversion results when the server's conversion rules are different from those described in this topic.</span></span> <span data-ttu-id="02bec-108">例如，在必须提供默认日期时，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 使用 1900-1-1，而不是 1899-12-30。</span><span class="sxs-lookup"><span data-stu-id="02bec-108">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1 rather than 1899-12-30.</span></span>  
  
|<span data-ttu-id="02bec-109">转换后 -></span><span class="sxs-lookup"><span data-stu-id="02bec-109">To -></span></span><br /><br /> <span data-ttu-id="02bec-110">From</span><span class="sxs-lookup"><span data-stu-id="02bec-110">From</span></span>|<span data-ttu-id="02bec-111">DATE</span><span class="sxs-lookup"><span data-stu-id="02bec-111">DATE</span></span>|<span data-ttu-id="02bec-112">DBDATE</span><span class="sxs-lookup"><span data-stu-id="02bec-112">DBDATE</span></span>|<span data-ttu-id="02bec-113">DBTIME</span><span class="sxs-lookup"><span data-stu-id="02bec-113">DBTIME</span></span>|<span data-ttu-id="02bec-114">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="02bec-114">DBTIME2</span></span>|<span data-ttu-id="02bec-115">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="02bec-115">DBTIMESTAMP</span></span>|<span data-ttu-id="02bec-116">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="02bec-116">DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="02bec-117">FILETIME</span><span class="sxs-lookup"><span data-stu-id="02bec-117">FILETIME</span></span>|<span data-ttu-id="02bec-118">BYTES</span><span class="sxs-lookup"><span data-stu-id="02bec-118">BYTES</span></span>|<span data-ttu-id="02bec-119">VARIANT</span><span class="sxs-lookup"><span data-stu-id="02bec-119">VARIANT</span></span>|<span data-ttu-id="02bec-120">SSVARIANT</span><span class="sxs-lookup"><span data-stu-id="02bec-120">SSVARIANT</span></span>|<span data-ttu-id="02bec-121">BSTR</span><span class="sxs-lookup"><span data-stu-id="02bec-121">BSTR</span></span>|<span data-ttu-id="02bec-122">STR</span><span class="sxs-lookup"><span data-stu-id="02bec-122">STR</span></span>|<span data-ttu-id="02bec-123">WSTR</span><span class="sxs-lookup"><span data-stu-id="02bec-123">WSTR</span></span>|  
|----------------------|----------|------------|------------|-------------|-----------------|-----------------------|--------------|-----------|-------------|---------------|----------|---------|----------|  
|<span data-ttu-id="02bec-124">Date</span><span class="sxs-lookup"><span data-stu-id="02bec-124">Date</span></span>|<span data-ttu-id="02bec-125">1,7</span><span class="sxs-lookup"><span data-stu-id="02bec-125">1,7</span></span>|<span data-ttu-id="02bec-126">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-126">OK</span></span>|-|-|<span data-ttu-id="02bec-127">1</span><span class="sxs-lookup"><span data-stu-id="02bec-127">1</span></span>|<span data-ttu-id="02bec-128">1,3</span><span class="sxs-lookup"><span data-stu-id="02bec-128">1,3</span></span>|<span data-ttu-id="02bec-129">1,7</span><span class="sxs-lookup"><span data-stu-id="02bec-129">1,7</span></span>|-|<span data-ttu-id="02bec-130">OK (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-130">OK (VT_BSTR)</span></span>|<span data-ttu-id="02bec-131">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-131">OK</span></span>|<span data-ttu-id="02bec-132">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-132">OK</span></span>|<span data-ttu-id="02bec-133">4</span><span class="sxs-lookup"><span data-stu-id="02bec-133">4</span></span>|<span data-ttu-id="02bec-134">4</span><span class="sxs-lookup"><span data-stu-id="02bec-134">4</span></span>|  
|<span data-ttu-id="02bec-135">时间</span><span class="sxs-lookup"><span data-stu-id="02bec-135">Time</span></span>|<span data-ttu-id="02bec-136">5、6、7</span><span class="sxs-lookup"><span data-stu-id="02bec-136">5,6,7</span></span>|-|<span data-ttu-id="02bec-137">9</span><span class="sxs-lookup"><span data-stu-id="02bec-137">9</span></span>|<span data-ttu-id="02bec-138">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-138">OK</span></span>|<span data-ttu-id="02bec-139">6</span><span class="sxs-lookup"><span data-stu-id="02bec-139">6</span></span>|<span data-ttu-id="02bec-140">3、6</span><span class="sxs-lookup"><span data-stu-id="02bec-140">3,6</span></span>|<span data-ttu-id="02bec-141">5、6</span><span class="sxs-lookup"><span data-stu-id="02bec-141">5,6</span></span>|-|<span data-ttu-id="02bec-142">OK (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-142">OK (VT_BSTR)</span></span>|<span data-ttu-id="02bec-143">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-143">OK</span></span>|<span data-ttu-id="02bec-144">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-144">OK</span></span>|<span data-ttu-id="02bec-145">4</span><span class="sxs-lookup"><span data-stu-id="02bec-145">4</span></span>|<span data-ttu-id="02bec-146">4</span><span class="sxs-lookup"><span data-stu-id="02bec-146">4</span></span>|  
|<span data-ttu-id="02bec-147">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="02bec-147">Smalldatetime</span></span>|<span data-ttu-id="02bec-148">7</span><span class="sxs-lookup"><span data-stu-id="02bec-148">7</span></span>|<span data-ttu-id="02bec-149">8</span><span class="sxs-lookup"><span data-stu-id="02bec-149">8</span></span>|<span data-ttu-id="02bec-150">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-150">9,10</span></span>|<span data-ttu-id="02bec-151">10</span><span class="sxs-lookup"><span data-stu-id="02bec-151">10</span></span>|<span data-ttu-id="02bec-152">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-152">OK</span></span>|<span data-ttu-id="02bec-153">3</span><span class="sxs-lookup"><span data-stu-id="02bec-153">3</span></span>|<span data-ttu-id="02bec-154">7</span><span class="sxs-lookup"><span data-stu-id="02bec-154">7</span></span>|-|<span data-ttu-id="02bec-155">7 (VT_DATE)</span><span class="sxs-lookup"><span data-stu-id="02bec-155">7 (VT_DATE)</span></span>|<span data-ttu-id="02bec-156">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-156">OK</span></span>|<span data-ttu-id="02bec-157">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-157">OK</span></span>|<span data-ttu-id="02bec-158">4</span><span class="sxs-lookup"><span data-stu-id="02bec-158">4</span></span>|<span data-ttu-id="02bec-159">4</span><span class="sxs-lookup"><span data-stu-id="02bec-159">4</span></span>|  
|<span data-ttu-id="02bec-160">datetime</span><span class="sxs-lookup"><span data-stu-id="02bec-160">Datetime</span></span>|<span data-ttu-id="02bec-161">5、7</span><span class="sxs-lookup"><span data-stu-id="02bec-161">5,7</span></span>|<span data-ttu-id="02bec-162">8</span><span class="sxs-lookup"><span data-stu-id="02bec-162">8</span></span>|<span data-ttu-id="02bec-163">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-163">9,10</span></span>|<span data-ttu-id="02bec-164">10</span><span class="sxs-lookup"><span data-stu-id="02bec-164">10</span></span>|<span data-ttu-id="02bec-165">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-165">OK</span></span>|<span data-ttu-id="02bec-166">3</span><span class="sxs-lookup"><span data-stu-id="02bec-166">3</span></span>|<span data-ttu-id="02bec-167">7</span><span class="sxs-lookup"><span data-stu-id="02bec-167">7</span></span>|-|<span data-ttu-id="02bec-168">7 (VT_DATE)</span><span class="sxs-lookup"><span data-stu-id="02bec-168">7 (VT_DATE)</span></span>|<span data-ttu-id="02bec-169">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-169">OK</span></span>|<span data-ttu-id="02bec-170">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-170">OK</span></span>|<span data-ttu-id="02bec-171">4</span><span class="sxs-lookup"><span data-stu-id="02bec-171">4</span></span>|<span data-ttu-id="02bec-172">4</span><span class="sxs-lookup"><span data-stu-id="02bec-172">4</span></span>|  
|<span data-ttu-id="02bec-173">Datetime2</span><span class="sxs-lookup"><span data-stu-id="02bec-173">Datetime2</span></span>|<span data-ttu-id="02bec-174">5、7</span><span class="sxs-lookup"><span data-stu-id="02bec-174">5,7</span></span>|<span data-ttu-id="02bec-175">8</span><span class="sxs-lookup"><span data-stu-id="02bec-175">8</span></span>|<span data-ttu-id="02bec-176">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-176">9,10</span></span>|<span data-ttu-id="02bec-177">10</span><span class="sxs-lookup"><span data-stu-id="02bec-177">10</span></span>|<span data-ttu-id="02bec-178">7</span><span class="sxs-lookup"><span data-stu-id="02bec-178">7</span></span>|<span data-ttu-id="02bec-179">3</span><span class="sxs-lookup"><span data-stu-id="02bec-179">3</span></span>|<span data-ttu-id="02bec-180">5、7</span><span class="sxs-lookup"><span data-stu-id="02bec-180">5,7</span></span>|-|<span data-ttu-id="02bec-181">OK (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-181">OK (VT_BSTR)</span></span>|<span data-ttu-id="02bec-182">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-182">OK</span></span>|<span data-ttu-id="02bec-183">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-183">OK</span></span>|<span data-ttu-id="02bec-184">4</span><span class="sxs-lookup"><span data-stu-id="02bec-184">4</span></span>|<span data-ttu-id="02bec-185">4</span><span class="sxs-lookup"><span data-stu-id="02bec-185">4</span></span>|  
|<span data-ttu-id="02bec-186">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="02bec-186">Datetimeoffset</span></span>|<span data-ttu-id="02bec-187">5、7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-187">5,7,11</span></span>|<span data-ttu-id="02bec-188">8，11</span><span class="sxs-lookup"><span data-stu-id="02bec-188">8,11</span></span>|<span data-ttu-id="02bec-189">9、10、11</span><span class="sxs-lookup"><span data-stu-id="02bec-189">9,10,11</span></span>|<span data-ttu-id="02bec-190">10,11</span><span class="sxs-lookup"><span data-stu-id="02bec-190">10,11</span></span>|<span data-ttu-id="02bec-191">7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-191">7,11</span></span>|<span data-ttu-id="02bec-192">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-192">OK</span></span>|<span data-ttu-id="02bec-193">5、7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-193">5,7,11</span></span>|-|<span data-ttu-id="02bec-194">OK (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-194">OK (VT_BSTR)</span></span>|<span data-ttu-id="02bec-195">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-195">OK</span></span>|<span data-ttu-id="02bec-196">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-196">OK</span></span>|<span data-ttu-id="02bec-197">4</span><span class="sxs-lookup"><span data-stu-id="02bec-197">4</span></span>|<span data-ttu-id="02bec-198">4</span><span class="sxs-lookup"><span data-stu-id="02bec-198">4</span></span>|  
|<span data-ttu-id="02bec-199">Char、Varchar、</span><span class="sxs-lookup"><span data-stu-id="02bec-199">Char, Varchar,</span></span><br /><br /> <span data-ttu-id="02bec-200">Nchar、Nvarchar</span><span class="sxs-lookup"><span data-stu-id="02bec-200">Nchar, Nvarchar</span></span>|<span data-ttu-id="02bec-201">7, 13</span><span class="sxs-lookup"><span data-stu-id="02bec-201">7, 13</span></span>|<span data-ttu-id="02bec-202">12</span><span class="sxs-lookup"><span data-stu-id="02bec-202">12</span></span>|<span data-ttu-id="02bec-203">12、9</span><span class="sxs-lookup"><span data-stu-id="02bec-203">12,9</span></span>|<span data-ttu-id="02bec-204">12</span><span class="sxs-lookup"><span data-stu-id="02bec-204">12</span></span>|<span data-ttu-id="02bec-205">12</span><span class="sxs-lookup"><span data-stu-id="02bec-205">12</span></span>|<span data-ttu-id="02bec-206">12</span><span class="sxs-lookup"><span data-stu-id="02bec-206">12</span></span>|<span data-ttu-id="02bec-207">7、13</span><span class="sxs-lookup"><span data-stu-id="02bec-207">7,13</span></span>|<span data-ttu-id="02bec-208">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-208">N/A</span></span>|<span data-ttu-id="02bec-209">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-209">N/A</span></span>|<span data-ttu-id="02bec-210">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-210">N/A</span></span>|<span data-ttu-id="02bec-211">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-211">N/A</span></span>|<span data-ttu-id="02bec-212">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-212">N/A</span></span>|<span data-ttu-id="02bec-213">空值</span><span class="sxs-lookup"><span data-stu-id="02bec-213">N/A</span></span>|  
|<span data-ttu-id="02bec-214">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-214">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-215">(datetime)</span><span class="sxs-lookup"><span data-stu-id="02bec-215">(datetime)</span></span>|<span data-ttu-id="02bec-216">7</span><span class="sxs-lookup"><span data-stu-id="02bec-216">7</span></span>|<span data-ttu-id="02bec-217">8</span><span class="sxs-lookup"><span data-stu-id="02bec-217">8</span></span>|<span data-ttu-id="02bec-218">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-218">9,10</span></span>|<span data-ttu-id="02bec-219">10</span><span class="sxs-lookup"><span data-stu-id="02bec-219">10</span></span>|<span data-ttu-id="02bec-220">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-220">OK</span></span>|<span data-ttu-id="02bec-221">3</span><span class="sxs-lookup"><span data-stu-id="02bec-221">3</span></span>|<span data-ttu-id="02bec-222">7</span><span class="sxs-lookup"><span data-stu-id="02bec-222">7</span></span>|-|<span data-ttu-id="02bec-223">7(VT_DATE)</span><span class="sxs-lookup"><span data-stu-id="02bec-223">7(VT_DATE)</span></span>|<span data-ttu-id="02bec-224">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-224">OK</span></span>|<span data-ttu-id="02bec-225">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-225">OK</span></span>|<span data-ttu-id="02bec-226">4</span><span class="sxs-lookup"><span data-stu-id="02bec-226">4</span></span>|<span data-ttu-id="02bec-227">4</span><span class="sxs-lookup"><span data-stu-id="02bec-227">4</span></span>|  
|<span data-ttu-id="02bec-228">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-228">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-229">(smalldatetime)</span><span class="sxs-lookup"><span data-stu-id="02bec-229">(smalldatetime)</span></span>|<span data-ttu-id="02bec-230">7</span><span class="sxs-lookup"><span data-stu-id="02bec-230">7</span></span>|<span data-ttu-id="02bec-231">8</span><span class="sxs-lookup"><span data-stu-id="02bec-231">8</span></span>|<span data-ttu-id="02bec-232">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-232">9,10</span></span>|<span data-ttu-id="02bec-233">10</span><span class="sxs-lookup"><span data-stu-id="02bec-233">10</span></span>|<span data-ttu-id="02bec-234">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-234">OK</span></span>|<span data-ttu-id="02bec-235">3</span><span class="sxs-lookup"><span data-stu-id="02bec-235">3</span></span>|<span data-ttu-id="02bec-236">7</span><span class="sxs-lookup"><span data-stu-id="02bec-236">7</span></span>|-|<span data-ttu-id="02bec-237">7(VT_DATE)</span><span class="sxs-lookup"><span data-stu-id="02bec-237">7(VT_DATE)</span></span>|<span data-ttu-id="02bec-238">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-238">OK</span></span>|<span data-ttu-id="02bec-239">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-239">OK</span></span>|<span data-ttu-id="02bec-240">4</span><span class="sxs-lookup"><span data-stu-id="02bec-240">4</span></span>|<span data-ttu-id="02bec-241">4</span><span class="sxs-lookup"><span data-stu-id="02bec-241">4</span></span>|  
|<span data-ttu-id="02bec-242">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-242">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-243">(date)</span><span class="sxs-lookup"><span data-stu-id="02bec-243">(date)</span></span>|<span data-ttu-id="02bec-244">1,7</span><span class="sxs-lookup"><span data-stu-id="02bec-244">1,7</span></span>|<span data-ttu-id="02bec-245">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-245">OK</span></span>|<span data-ttu-id="02bec-246">2</span><span class="sxs-lookup"><span data-stu-id="02bec-246">2</span></span>|<span data-ttu-id="02bec-247">2</span><span class="sxs-lookup"><span data-stu-id="02bec-247">2</span></span>|<span data-ttu-id="02bec-248">1</span><span class="sxs-lookup"><span data-stu-id="02bec-248">1</span></span>|<span data-ttu-id="02bec-249">1,3</span><span class="sxs-lookup"><span data-stu-id="02bec-249">1,3</span></span>|<span data-ttu-id="02bec-250">1,7</span><span class="sxs-lookup"><span data-stu-id="02bec-250">1,7</span></span>|-|<span data-ttu-id="02bec-251">OK(VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-251">OK(VT_BSTR)</span></span>|<span data-ttu-id="02bec-252">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-252">OK</span></span>|<span data-ttu-id="02bec-253">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-253">OK</span></span>|<span data-ttu-id="02bec-254">4</span><span class="sxs-lookup"><span data-stu-id="02bec-254">4</span></span>|<span data-ttu-id="02bec-255">4</span><span class="sxs-lookup"><span data-stu-id="02bec-255">4</span></span>|  
|<span data-ttu-id="02bec-256">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-256">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-257">(time)</span><span class="sxs-lookup"><span data-stu-id="02bec-257">(time)</span></span>|<span data-ttu-id="02bec-258">5、6、7</span><span class="sxs-lookup"><span data-stu-id="02bec-258">5,6,7</span></span>|<span data-ttu-id="02bec-259">2</span><span class="sxs-lookup"><span data-stu-id="02bec-259">2</span></span>|<span data-ttu-id="02bec-260">6</span><span class="sxs-lookup"><span data-stu-id="02bec-260">6</span></span>|<span data-ttu-id="02bec-261">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-261">OK</span></span>|<span data-ttu-id="02bec-262">6</span><span class="sxs-lookup"><span data-stu-id="02bec-262">6</span></span>|<span data-ttu-id="02bec-263">3、6</span><span class="sxs-lookup"><span data-stu-id="02bec-263">3,6</span></span>|<span data-ttu-id="02bec-264">5、6</span><span class="sxs-lookup"><span data-stu-id="02bec-264">5,6</span></span>|-|<span data-ttu-id="02bec-265">OK(VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-265">OK(VT_BSTR)</span></span>|<span data-ttu-id="02bec-266">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-266">OK</span></span>|<span data-ttu-id="02bec-267">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-267">OK</span></span>|<span data-ttu-id="02bec-268">4</span><span class="sxs-lookup"><span data-stu-id="02bec-268">4</span></span>|<span data-ttu-id="02bec-269">4</span><span class="sxs-lookup"><span data-stu-id="02bec-269">4</span></span>|  
|<span data-ttu-id="02bec-270">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-270">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-271">(datetime2)</span><span class="sxs-lookup"><span data-stu-id="02bec-271">(datetime2)</span></span>|<span data-ttu-id="02bec-272">5、7</span><span class="sxs-lookup"><span data-stu-id="02bec-272">5,7</span></span>|<span data-ttu-id="02bec-273">8</span><span class="sxs-lookup"><span data-stu-id="02bec-273">8</span></span>|<span data-ttu-id="02bec-274">9,10</span><span class="sxs-lookup"><span data-stu-id="02bec-274">9,10</span></span>|<span data-ttu-id="02bec-275">10</span><span class="sxs-lookup"><span data-stu-id="02bec-275">10</span></span>|<span data-ttu-id="02bec-276">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-276">OK</span></span>|<span data-ttu-id="02bec-277">3</span><span class="sxs-lookup"><span data-stu-id="02bec-277">3</span></span>|<span data-ttu-id="02bec-278">5、7</span><span class="sxs-lookup"><span data-stu-id="02bec-278">5,7</span></span>|-|<span data-ttu-id="02bec-279">OK(VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-279">OK(VT_BSTR)</span></span>|<span data-ttu-id="02bec-280">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-280">OK</span></span>|<span data-ttu-id="02bec-281">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-281">OK</span></span>|<span data-ttu-id="02bec-282">4</span><span class="sxs-lookup"><span data-stu-id="02bec-282">4</span></span>|<span data-ttu-id="02bec-283">4</span><span class="sxs-lookup"><span data-stu-id="02bec-283">4</span></span>|  
|<span data-ttu-id="02bec-284">Sql_variant</span><span class="sxs-lookup"><span data-stu-id="02bec-284">Sql_variant</span></span><br /><br /> <span data-ttu-id="02bec-285">(datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="02bec-285">(datetimeoffset)</span></span>|<span data-ttu-id="02bec-286">5、7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-286">5,7,11</span></span>|<span data-ttu-id="02bec-287">8，11</span><span class="sxs-lookup"><span data-stu-id="02bec-287">8,11</span></span>|<span data-ttu-id="02bec-288">9、10、11</span><span class="sxs-lookup"><span data-stu-id="02bec-288">9,10,11</span></span>|<span data-ttu-id="02bec-289">10,11</span><span class="sxs-lookup"><span data-stu-id="02bec-289">10,11</span></span>|<span data-ttu-id="02bec-290">7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-290">7,11</span></span>|<span data-ttu-id="02bec-291">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-291">OK</span></span>|<span data-ttu-id="02bec-292">5、7、11</span><span class="sxs-lookup"><span data-stu-id="02bec-292">5,7,11</span></span>|-|<span data-ttu-id="02bec-293">OK(VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="02bec-293">OK(VT_BSTR)</span></span>|<span data-ttu-id="02bec-294">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-294">OK</span></span>|<span data-ttu-id="02bec-295">OK</span><span class="sxs-lookup"><span data-stu-id="02bec-295">OK</span></span>|<span data-ttu-id="02bec-296">4</span><span class="sxs-lookup"><span data-stu-id="02bec-296">4</span></span>|<span data-ttu-id="02bec-297">4</span><span class="sxs-lookup"><span data-stu-id="02bec-297">4</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="02bec-298">符号含义</span><span class="sxs-lookup"><span data-stu-id="02bec-298">Key to Symbols</span></span>  
  
|<span data-ttu-id="02bec-299">符号</span><span class="sxs-lookup"><span data-stu-id="02bec-299">Symbol</span></span>|<span data-ttu-id="02bec-300">含义</span><span class="sxs-lookup"><span data-stu-id="02bec-300">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="02bec-301">确定</span><span class="sxs-lookup"><span data-stu-id="02bec-301">OK</span></span>|<span data-ttu-id="02bec-302">不需要任何转换。</span><span class="sxs-lookup"><span data-stu-id="02bec-302">No conversion is necessary.</span></span>|  
|-|<span data-ttu-id="02bec-303">不支持任何转换。</span><span class="sxs-lookup"><span data-stu-id="02bec-303">No conversion is supported.</span></span> <span data-ttu-id="02bec-304">如果在调用 IAccessor::CreateAccessor 时验证绑定，则在 rgStatus\*\* 中返回 DBBINDSTATUS_UPSUPPORTEDCONVERSION。</span><span class="sxs-lookup"><span data-stu-id="02bec-304">If the binding is validated when IAccessor::CreateAccessor is called, DBBINDSTATUS_UPSUPPORTEDCONVERSION is returned in *rgStatus*.</span></span> <span data-ttu-id="02bec-305">当延迟取值函数验证时，则设置 DBSTATUS_E_BADACCESSOR。</span><span class="sxs-lookup"><span data-stu-id="02bec-305">When accessor validation is deferred, DBSTATUS_E_BADACCESSOR is set.</span></span>|  
|<span data-ttu-id="02bec-306">1</span><span class="sxs-lookup"><span data-stu-id="02bec-306">1</span></span>|<span data-ttu-id="02bec-307">时间字段设置为零。</span><span class="sxs-lookup"><span data-stu-id="02bec-307">The time fields are set to zero.</span></span>|  
|<span data-ttu-id="02bec-308">2</span><span class="sxs-lookup"><span data-stu-id="02bec-308">2</span></span>|<span data-ttu-id="02bec-309">设置 DBSTATUS_E_CANTCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="02bec-309">DBSTATUS_E_CANTCONVERTVALUE is set.</span></span>|  
|<span data-ttu-id="02bec-310">3</span><span class="sxs-lookup"><span data-stu-id="02bec-310">3</span></span>|<span data-ttu-id="02bec-311">时区设置为零。</span><span class="sxs-lookup"><span data-stu-id="02bec-311">The timezone is set to zero.</span></span>|  
|<span data-ttu-id="02bec-312">4</span><span class="sxs-lookup"><span data-stu-id="02bec-312">4</span></span>|<span data-ttu-id="02bec-313">如果客户端缓冲区不够大，则设置 DBSTATUS_S_TRUNCATED。</span><span class="sxs-lookup"><span data-stu-id="02bec-313">If the client buffer is not big enough, DBSTATUS_S_TRUNCATED is set.</span></span> <span data-ttu-id="02bec-314">如果服务器类型包含秒的小数部分，结果字符串中的位数与服务器类型的小数位数完全匹配。</span><span class="sxs-lookup"><span data-stu-id="02bec-314">When the server type includes fractional seconds, the number of digits in the result string exactly matches the scale of the server type.</span></span>|  
|<span data-ttu-id="02bec-315">5</span><span class="sxs-lookup"><span data-stu-id="02bec-315">5</span></span>|<span data-ttu-id="02bec-316">截断的秒或秒的小数部分将被忽略。</span><span class="sxs-lookup"><span data-stu-id="02bec-316">Truncation of seconds or fractional seconds is ignored.</span></span>|  
|<span data-ttu-id="02bec-317">6</span><span class="sxs-lookup"><span data-stu-id="02bec-317">6</span></span>|<span data-ttu-id="02bec-318">除非源为字符串时间文字，并且目标为 DBTYPE_DATE，否则将日期设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="02bec-318">The date is set to the current date, unless the source is a string time literal and the destination is DBTYPE_DATE.</span></span> <span data-ttu-id="02bec-319">这种情况下，将使用 1899-12-30。</span><span class="sxs-lookup"><span data-stu-id="02bec-319">In this case, 1899-12-30 is used.</span></span>|  
|<span data-ttu-id="02bec-320">7</span><span class="sxs-lookup"><span data-stu-id="02bec-320">7</span></span>|<span data-ttu-id="02bec-321">如果值溢出，则设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="02bec-321">If the value overflows, DBSTATUS_E_DATAOVERFLOW is set.</span></span>|  
|<span data-ttu-id="02bec-322">8</span><span class="sxs-lookup"><span data-stu-id="02bec-322">8</span></span>|<span data-ttu-id="02bec-323">忽略时间字段。</span><span class="sxs-lookup"><span data-stu-id="02bec-323">Time fields are ignored.</span></span>|  
|<span data-ttu-id="02bec-324">9</span><span class="sxs-lookup"><span data-stu-id="02bec-324">9</span></span>|<span data-ttu-id="02bec-325">忽略秒的小数部分字段。</span><span class="sxs-lookup"><span data-stu-id="02bec-325">Fractional seconds fields are ignored.</span></span>|  
|<span data-ttu-id="02bec-326">10</span><span class="sxs-lookup"><span data-stu-id="02bec-326">10</span></span>|<span data-ttu-id="02bec-327">忽略日期部分。</span><span class="sxs-lookup"><span data-stu-id="02bec-327">The date component is ignored.</span></span>|  
|<span data-ttu-id="02bec-328">11</span><span class="sxs-lookup"><span data-stu-id="02bec-328">11</span></span>|<span data-ttu-id="02bec-329">将时间转换为客户端时区。</span><span class="sxs-lookup"><span data-stu-id="02bec-329">The time is converted to the client timezone.</span></span> <span data-ttu-id="02bec-330">如果在此转换过程中出现错误，则设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="02bec-330">If an error occurs during this conversion DBSTATUS_E_DATAOVERFLOW is set.</span></span>|  
|<span data-ttu-id="02bec-331">12</span><span class="sxs-lookup"><span data-stu-id="02bec-331">12</span></span>|<span data-ttu-id="02bec-332">字符串分析为 ISO 文字并转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="02bec-332">The string is parsed as an ISO literal and converted to the target type.</span></span> <span data-ttu-id="02bec-333">如果上述操作失败，该字符串则分析为 OLE 日期文字（还包含时间部分），并从 OLE 日期 (DBTYPE_DATE) 转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="02bec-333">If this fails, the string is parsed as an OLE date literal (which also has time components) and converted from an OLE date (DBTYPE_DATE) to the target type.</span></span> <span data-ttu-id="02bec-334">字符串必须符合成功分析 ISO 格式所允许的目标类型的文字语法。</span><span class="sxs-lookup"><span data-stu-id="02bec-334">The string must conform to the syntax for literals of the target type allowed for ISO format parsing to succeed.</span></span> <span data-ttu-id="02bec-335">若要成功分析 OLE，字符串必须符合可由 OLE 识别的语法。</span><span class="sxs-lookup"><span data-stu-id="02bec-335">For OLE parsing to succeed, the string must conform to the syntax recognized by OLE.</span></span> <span data-ttu-id="02bec-336">如果无法分析该字符串，则设置 DBSTATUS_E_CANTCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="02bec-336">If the string cannot be parsed, DBSTATUS_E_CANTCONVERTVALUE is set.</span></span> <span data-ttu-id="02bec-337">如果任一部分的值超出范围，则设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="02bec-337">If any component values are out of range, DBSTATUS_E_DATAOVERFLOW is set.</span></span>|  
|<span data-ttu-id="02bec-338">13</span><span class="sxs-lookup"><span data-stu-id="02bec-338">13</span></span>|<span data-ttu-id="02bec-339">字符串分析为 ISO 文字并转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="02bec-339">The string is parsed as an ISO literal and converted to the target type.</span></span> <span data-ttu-id="02bec-340">如果上述操作失败，该字符串则分析为 OLE 日期文字（还包含时间部分），并从 OLE 日期 (DBTYPE_DATE) 转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="02bec-340">If this fails, the string is parsed as an OLE date literal (which also has time components) and converted from an OLE date (DBTYPE_DATE) to the target type.</span></span> <span data-ttu-id="02bec-341">除非目标为 DBTYPE_DATE 或 DBTYPE_DBTIMESTAMP，否则该字符串必须符合日期时间文字的语法。</span><span class="sxs-lookup"><span data-stu-id="02bec-341">The string must conform to the syntax for datetime literals, unless the destination is DBTYPE_DATE or DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="02bec-342">在这种情况下，允许日期时间或时间文字，以便成功分析 ISO 格式。</span><span class="sxs-lookup"><span data-stu-id="02bec-342">If this is the case, either a datetime or time literal is allowed for ISO format parsing to succeed.</span></span> <span data-ttu-id="02bec-343">若要成功分析 OLE，字符串必须符合可由 OLE 识别的语法。</span><span class="sxs-lookup"><span data-stu-id="02bec-343">For OLE parsing to succeed, the string must conform to the syntax recognized by OLE.</span></span> <span data-ttu-id="02bec-344">如果无法分析该字符串，则设置 DBSTATUS_E_CANTCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="02bec-344">If the string cannot be parsed, DBSTATUS_E_CANTCONVERTVALUE is set.</span></span> <span data-ttu-id="02bec-345">如果任一部分的值超出范围，则设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="02bec-345">If any component values are out of range, DBSTATUS_E_DATAOVERFLOW is set.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="02bec-346">另请参阅</span><span class="sxs-lookup"><span data-stu-id="02bec-346">See Also</span></span>  
 [<span data-ttu-id="02bec-347">绑定和转换 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="02bec-347">Bindings and Conversions &#40;OLE DB&#41;</span></span>](conversions-ole-db.md)  
  
  
