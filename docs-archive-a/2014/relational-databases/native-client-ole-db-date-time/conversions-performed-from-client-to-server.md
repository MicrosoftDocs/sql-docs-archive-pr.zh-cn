---
title: 在客户端和服务器之间执行的转换 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- conversions [OLE DB], client to server
ms.assetid: 6bb24928-0f3e-4119-beda-cfd04a44a3eb
author: rothja
ms.author: jroth
ms.openlocfilehash: 5f167ff5399016fb41c482d37a6f6365bbcd2811
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692372"
---
# <a name="conversions-performed-from-client-to-server"></a><span data-ttu-id="03207-102">在客户端和服务器之间执行的转换</span><span class="sxs-lookup"><span data-stu-id="03207-102">Conversions Performed from Client to Server</span></span>
  <span data-ttu-id="03207-103">本主题说明在使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 编写的客户端应用程序与 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] （或更高版本）之间执行的日期/时间转换。</span><span class="sxs-lookup"><span data-stu-id="03207-103">This topic describes date/time conversions performed between a client application written with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later).</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="03207-104">转换</span><span class="sxs-lookup"><span data-stu-id="03207-104">Conversions</span></span>  
 <span data-ttu-id="03207-105">本主题介绍在客户端上执行的转换。</span><span class="sxs-lookup"><span data-stu-id="03207-105">This topic describes conversions made on the client.</span></span> <span data-ttu-id="03207-106">如果客户端指定的参数的秒的小数部分精度不同于服务器上定义的精度，那么，客户端转换将在该服务器允许成功执行该操作时导致失败。</span><span class="sxs-lookup"><span data-stu-id="03207-106">If the client specifies fractional seconds precision for a parameter that differs from that defined on the server, the client conversion might cause a failure in cases where the server would allow the operation to succeed.</span></span> <span data-ttu-id="03207-107">特别是，客户端将将秒的小数部分的任何截断视为错误，而 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 将时间值舍入为最接近的整数秒数。</span><span class="sxs-lookup"><span data-stu-id="03207-107">In particular, the client treats any truncation of fractional seconds as an error, whereas [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] rounds time values to the nearest whole second.</span></span>  
  
 <span data-ttu-id="03207-108">如果未调用 ICommandWithParameters：： SetParameterInfo，则 DBTYPE_DBTIMESTAMP 绑定转换为 `datetime2` 。</span><span class="sxs-lookup"><span data-stu-id="03207-108">If ICommandWithParameters::SetParameterInfo is not called, DBTYPE_DBTIMESTAMP bindings are converted as if they were `datetime2`.</span></span>  
  
|<span data-ttu-id="03207-109">转换后 -></span><span class="sxs-lookup"><span data-stu-id="03207-109">To -></span></span><br /><br /> <span data-ttu-id="03207-110">From</span><span class="sxs-lookup"><span data-stu-id="03207-110">From</span></span>|<span data-ttu-id="03207-111">DBDATE (date)</span><span class="sxs-lookup"><span data-stu-id="03207-111">DBDATE (date)</span></span>|<span data-ttu-id="03207-112">DBTIME (time)</span><span class="sxs-lookup"><span data-stu-id="03207-112">DBTIME (time)</span></span>|<span data-ttu-id="03207-113">DBTIME2 (time)</span><span class="sxs-lookup"><span data-stu-id="03207-113">DBTIME2 (time)</span></span>|<span data-ttu-id="03207-114">DBTIMESTAMP (smalldatetime)</span><span class="sxs-lookup"><span data-stu-id="03207-114">DBTIMESTAMP (smalldatetime)</span></span>|<span data-ttu-id="03207-115">DBTIMESTAMP (datetime)</span><span class="sxs-lookup"><span data-stu-id="03207-115">DBTIMESTAMP (datetime)</span></span>|<span data-ttu-id="03207-116">DBTIMESTAMP (datetime2)</span><span class="sxs-lookup"><span data-stu-id="03207-116">DBTIMESTAMP (datetime2)</span></span>|<span data-ttu-id="03207-117">DBTIMESTAMPOFFSET (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="03207-117">DBTIMESTAMPOFFSET (datetimeoffset)</span></span>|<span data-ttu-id="03207-118">STR</span><span class="sxs-lookup"><span data-stu-id="03207-118">STR</span></span>|<span data-ttu-id="03207-119">WSTR</span><span class="sxs-lookup"><span data-stu-id="03207-119">WSTR</span></span>|<span data-ttu-id="03207-120">SQLVARIANT</span><span class="sxs-lookup"><span data-stu-id="03207-120">SQLVARIANT</span></span><br /><br /> <span data-ttu-id="03207-121">(sql_variant)</span><span class="sxs-lookup"><span data-stu-id="03207-121">(sql_variant)</span></span>|  
|----------------------|---------------------|---------------------|----------------------|-----------------------------------|------------------------------|-------------------------------|------------------------------------------|---------|----------|-------------------------------------|  
|<span data-ttu-id="03207-122">DATE</span><span class="sxs-lookup"><span data-stu-id="03207-122">DATE</span></span>|<span data-ttu-id="03207-123">1,2</span><span class="sxs-lookup"><span data-stu-id="03207-123">1,2</span></span>|<span data-ttu-id="03207-124">1,3,4</span><span class="sxs-lookup"><span data-stu-id="03207-124">1,3,4</span></span>|<span data-ttu-id="03207-125">4,12</span><span class="sxs-lookup"><span data-stu-id="03207-125">4,12</span></span>|<span data-ttu-id="03207-126">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-126">1,12</span></span>|<span data-ttu-id="03207-127">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-127">1,12</span></span>|<span data-ttu-id="03207-128">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-128">1,12</span></span>|<span data-ttu-id="03207-129">1,5, 12</span><span class="sxs-lookup"><span data-stu-id="03207-129">1,5, 12</span></span>|<span data-ttu-id="03207-130">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-130">1,12</span></span>|<span data-ttu-id="03207-131">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-131">1,12</span></span>|<span data-ttu-id="03207-132">1,12</span><span class="sxs-lookup"><span data-stu-id="03207-132">1,12</span></span><br /><br /> <span data-ttu-id="03207-133">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="03207-133">datetime2(0)</span></span>|  
|<span data-ttu-id="03207-134">DBDATE</span><span class="sxs-lookup"><span data-stu-id="03207-134">DBDATE</span></span>|<span data-ttu-id="03207-135">1</span><span class="sxs-lookup"><span data-stu-id="03207-135">1</span></span>|-|-|<span data-ttu-id="03207-136">1,6</span><span class="sxs-lookup"><span data-stu-id="03207-136">1,6</span></span>|<span data-ttu-id="03207-137">1,6</span><span class="sxs-lookup"><span data-stu-id="03207-137">1,6</span></span>|<span data-ttu-id="03207-138">1,6</span><span class="sxs-lookup"><span data-stu-id="03207-138">1,6</span></span>|<span data-ttu-id="03207-139">1,5, 6</span><span class="sxs-lookup"><span data-stu-id="03207-139">1,5, 6</span></span>|<span data-ttu-id="03207-140">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-140">1,10</span></span>|<span data-ttu-id="03207-141">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-141">1,10</span></span>|<span data-ttu-id="03207-142">1</span><span class="sxs-lookup"><span data-stu-id="03207-142">1</span></span><br /><br /> <span data-ttu-id="03207-143">date</span><span class="sxs-lookup"><span data-stu-id="03207-143">date</span></span>|  
|<span data-ttu-id="03207-144">DBTIME</span><span class="sxs-lookup"><span data-stu-id="03207-144">DBTIME</span></span>|-|<span data-ttu-id="03207-145">1</span><span class="sxs-lookup"><span data-stu-id="03207-145">1</span></span>|<span data-ttu-id="03207-146">1</span><span class="sxs-lookup"><span data-stu-id="03207-146">1</span></span>|<span data-ttu-id="03207-147">1,7</span><span class="sxs-lookup"><span data-stu-id="03207-147">1,7</span></span>|<span data-ttu-id="03207-148">1,7</span><span class="sxs-lookup"><span data-stu-id="03207-148">1,7</span></span>|<span data-ttu-id="03207-149">1,7</span><span class="sxs-lookup"><span data-stu-id="03207-149">1,7</span></span>|<span data-ttu-id="03207-150">1,5, 7</span><span class="sxs-lookup"><span data-stu-id="03207-150">1,5, 7</span></span>|<span data-ttu-id="03207-151">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-151">1,10</span></span>|<span data-ttu-id="03207-152">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-152">1,10</span></span>|<span data-ttu-id="03207-153">1</span><span class="sxs-lookup"><span data-stu-id="03207-153">1</span></span><br /><br /> <span data-ttu-id="03207-154">Time(0)</span><span class="sxs-lookup"><span data-stu-id="03207-154">Time(0)</span></span>|  
|<span data-ttu-id="03207-155">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="03207-155">DBTIME2</span></span>|-|<span data-ttu-id="03207-156">1,3</span><span class="sxs-lookup"><span data-stu-id="03207-156">1,3</span></span>|<span data-ttu-id="03207-157">1</span><span class="sxs-lookup"><span data-stu-id="03207-157">1</span></span>|<span data-ttu-id="03207-158">1,7,10,14</span><span class="sxs-lookup"><span data-stu-id="03207-158">1,7,10,14</span></span>|<span data-ttu-id="03207-159">1,7,10,15</span><span class="sxs-lookup"><span data-stu-id="03207-159">1,7,10,15</span></span>|<span data-ttu-id="03207-160">1,7,10</span><span class="sxs-lookup"><span data-stu-id="03207-160">1,7,10</span></span>|<span data-ttu-id="03207-161">1,5,7,10</span><span class="sxs-lookup"><span data-stu-id="03207-161">1,5,7,10</span></span>|<span data-ttu-id="03207-162">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-162">1,10,11</span></span>|<span data-ttu-id="03207-163">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-163">1,10,11</span></span>|<span data-ttu-id="03207-164">1</span><span class="sxs-lookup"><span data-stu-id="03207-164">1</span></span><br /><br /> <span data-ttu-id="03207-165">Time(7)</span><span class="sxs-lookup"><span data-stu-id="03207-165">Time(7)</span></span>|  
|<span data-ttu-id="03207-166">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="03207-166">DBTIMESTAMP</span></span>|<span data-ttu-id="03207-167">1,2</span><span class="sxs-lookup"><span data-stu-id="03207-167">1,2</span></span>|<span data-ttu-id="03207-168">1,3,4</span><span class="sxs-lookup"><span data-stu-id="03207-168">1,3,4</span></span>|<span data-ttu-id="03207-169">1,4,10</span><span class="sxs-lookup"><span data-stu-id="03207-169">1,4,10</span></span>|<span data-ttu-id="03207-170">1,10,14</span><span class="sxs-lookup"><span data-stu-id="03207-170">1,10,14</span></span>|<span data-ttu-id="03207-171">1,10,15</span><span class="sxs-lookup"><span data-stu-id="03207-171">1,10,15</span></span>|<span data-ttu-id="03207-172">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-172">1,10</span></span>|<span data-ttu-id="03207-173">1,5,10</span><span class="sxs-lookup"><span data-stu-id="03207-173">1,5,10</span></span>|<span data-ttu-id="03207-174">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-174">1,10,11</span></span>|<span data-ttu-id="03207-175">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-175">1,10,11</span></span>|<span data-ttu-id="03207-176">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-176">1,10</span></span><br /><br /> <span data-ttu-id="03207-177">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="03207-177">datetime2(7)</span></span>|  
|<span data-ttu-id="03207-178">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="03207-178">DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="03207-179">1,2,8</span><span class="sxs-lookup"><span data-stu-id="03207-179">1,2,8</span></span>|<span data-ttu-id="03207-180">1,3,4,8</span><span class="sxs-lookup"><span data-stu-id="03207-180">1,3,4,8</span></span>|<span data-ttu-id="03207-181">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="03207-181">1,4,8,10</span></span>|<span data-ttu-id="03207-182">1,8,10,14</span><span class="sxs-lookup"><span data-stu-id="03207-182">1,8,10,14</span></span>|<span data-ttu-id="03207-183">1,8,10,15</span><span class="sxs-lookup"><span data-stu-id="03207-183">1,8,10,15</span></span>|<span data-ttu-id="03207-184">1,8,10</span><span class="sxs-lookup"><span data-stu-id="03207-184">1,8,10</span></span>|<span data-ttu-id="03207-185">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-185">1,10</span></span>|<span data-ttu-id="03207-186">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-186">1,10,11</span></span>|<span data-ttu-id="03207-187">1,10,11</span><span class="sxs-lookup"><span data-stu-id="03207-187">1,10,11</span></span>|<span data-ttu-id="03207-188">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-188">1,10</span></span><br /><br /> <span data-ttu-id="03207-189">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="03207-189">datetimeoffset(7)</span></span>|  
|<span data-ttu-id="03207-190">FILETIME</span><span class="sxs-lookup"><span data-stu-id="03207-190">FILETIME</span></span>|<span data-ttu-id="03207-191">1,2</span><span class="sxs-lookup"><span data-stu-id="03207-191">1,2</span></span>|<span data-ttu-id="03207-192">1,3,4</span><span class="sxs-lookup"><span data-stu-id="03207-192">1,3,4</span></span>|<span data-ttu-id="03207-193">1,4,13</span><span class="sxs-lookup"><span data-stu-id="03207-193">1,4,13</span></span>|<span data-ttu-id="03207-194">1,13</span><span class="sxs-lookup"><span data-stu-id="03207-194">1,13</span></span>|<span data-ttu-id="03207-195">1,13</span><span class="sxs-lookup"><span data-stu-id="03207-195">1,13</span></span>|<span data-ttu-id="03207-196">1,13</span><span class="sxs-lookup"><span data-stu-id="03207-196">1,13</span></span>|<span data-ttu-id="03207-197">1,5,13</span><span class="sxs-lookup"><span data-stu-id="03207-197">1,5,13</span></span>|<span data-ttu-id="03207-198">1,13</span><span class="sxs-lookup"><span data-stu-id="03207-198">1,13</span></span>|<span data-ttu-id="03207-199">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-199">1,10</span></span>|<span data-ttu-id="03207-200">1,13</span><span class="sxs-lookup"><span data-stu-id="03207-200">1,13</span></span><br /><br /> <span data-ttu-id="03207-201">datetime2(3)</span><span class="sxs-lookup"><span data-stu-id="03207-201">datetime2(3)</span></span>|  
|<span data-ttu-id="03207-202">BYTES</span><span class="sxs-lookup"><span data-stu-id="03207-202">BYTES</span></span>|-|-|-|-|-|-|-|<span data-ttu-id="03207-203">空值</span><span class="sxs-lookup"><span data-stu-id="03207-203">N/A</span></span>|<span data-ttu-id="03207-204">空值</span><span class="sxs-lookup"><span data-stu-id="03207-204">N/A</span></span>|<span data-ttu-id="03207-205">空值</span><span class="sxs-lookup"><span data-stu-id="03207-205">N/A</span></span>|  
|<span data-ttu-id="03207-206">VARIANT</span><span class="sxs-lookup"><span data-stu-id="03207-206">VARIANT</span></span>|<span data-ttu-id="03207-207">1</span><span class="sxs-lookup"><span data-stu-id="03207-207">1</span></span>|<span data-ttu-id="03207-208">1</span><span class="sxs-lookup"><span data-stu-id="03207-208">1</span></span>|<span data-ttu-id="03207-209">1</span><span class="sxs-lookup"><span data-stu-id="03207-209">1</span></span>|<span data-ttu-id="03207-210">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-210">1,10</span></span>|<span data-ttu-id="03207-211">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-211">1,10</span></span>|<span data-ttu-id="03207-212">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-212">1,10</span></span>|<span data-ttu-id="03207-213">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-213">1,10</span></span>|<span data-ttu-id="03207-214">空值</span><span class="sxs-lookup"><span data-stu-id="03207-214">N/A</span></span>|<span data-ttu-id="03207-215">空值</span><span class="sxs-lookup"><span data-stu-id="03207-215">N/A</span></span>|<span data-ttu-id="03207-216">1,10</span><span class="sxs-lookup"><span data-stu-id="03207-216">1,10</span></span>|  
|<span data-ttu-id="03207-217">SSVARIANT</span><span class="sxs-lookup"><span data-stu-id="03207-217">SSVARIANT</span></span>|<span data-ttu-id="03207-218">1,16</span><span class="sxs-lookup"><span data-stu-id="03207-218">1,16</span></span>|<span data-ttu-id="03207-219">1,16</span><span class="sxs-lookup"><span data-stu-id="03207-219">1,16</span></span>|<span data-ttu-id="03207-220">1,16</span><span class="sxs-lookup"><span data-stu-id="03207-220">1,16</span></span>|<span data-ttu-id="03207-221">1,10,16</span><span class="sxs-lookup"><span data-stu-id="03207-221">1,10,16</span></span>|<span data-ttu-id="03207-222">1,10,16</span><span class="sxs-lookup"><span data-stu-id="03207-222">1,10,16</span></span>|<span data-ttu-id="03207-223">1,10,16</span><span class="sxs-lookup"><span data-stu-id="03207-223">1,10,16</span></span>|<span data-ttu-id="03207-224">1,10,16</span><span class="sxs-lookup"><span data-stu-id="03207-224">1,10,16</span></span>|<span data-ttu-id="03207-225">空值</span><span class="sxs-lookup"><span data-stu-id="03207-225">N/A</span></span>|<span data-ttu-id="03207-226">空值</span><span class="sxs-lookup"><span data-stu-id="03207-226">N/A</span></span>|<span data-ttu-id="03207-227">1,16</span><span class="sxs-lookup"><span data-stu-id="03207-227">1,16</span></span>|  
|<span data-ttu-id="03207-228">BSTR</span><span class="sxs-lookup"><span data-stu-id="03207-228">BSTR</span></span>|<span data-ttu-id="03207-229">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-229">1,9</span></span>|<span data-ttu-id="03207-230">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-230">1,9</span></span>|<span data-ttu-id="03207-231">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-231">1,9,10</span></span>|<span data-ttu-id="03207-232">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-232">1,9,10</span></span>|<span data-ttu-id="03207-233">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-233">1,9,10</span></span>|<span data-ttu-id="03207-234">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-234">1,9,10</span></span>|<span data-ttu-id="03207-235">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-235">1,9,10</span></span>|<span data-ttu-id="03207-236">空值</span><span class="sxs-lookup"><span data-stu-id="03207-236">N/A</span></span>|<span data-ttu-id="03207-237">空值</span><span class="sxs-lookup"><span data-stu-id="03207-237">N/A</span></span>|<span data-ttu-id="03207-238">空值</span><span class="sxs-lookup"><span data-stu-id="03207-238">N/A</span></span>|  
|<span data-ttu-id="03207-239">STR</span><span class="sxs-lookup"><span data-stu-id="03207-239">STR</span></span>|<span data-ttu-id="03207-240">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-240">1,9</span></span>|<span data-ttu-id="03207-241">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-241">1,9</span></span>|<span data-ttu-id="03207-242">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-242">1,9,10</span></span>|<span data-ttu-id="03207-243">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-243">1,9,10</span></span>|<span data-ttu-id="03207-244">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-244">1,9,10</span></span>|<span data-ttu-id="03207-245">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-245">1,9,10</span></span>|<span data-ttu-id="03207-246">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-246">1,9,10</span></span>|<span data-ttu-id="03207-247">空值</span><span class="sxs-lookup"><span data-stu-id="03207-247">N/A</span></span>|<span data-ttu-id="03207-248">空值</span><span class="sxs-lookup"><span data-stu-id="03207-248">N/A</span></span>|<span data-ttu-id="03207-249">空值</span><span class="sxs-lookup"><span data-stu-id="03207-249">N/A</span></span>|  
|<span data-ttu-id="03207-250">WSTR</span><span class="sxs-lookup"><span data-stu-id="03207-250">WSTR</span></span>|<span data-ttu-id="03207-251">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-251">1,9</span></span>|<span data-ttu-id="03207-252">1,9</span><span class="sxs-lookup"><span data-stu-id="03207-252">1,9</span></span>|<span data-ttu-id="03207-253">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-253">1,9,10</span></span>|<span data-ttu-id="03207-254">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-254">1,9,10</span></span>|<span data-ttu-id="03207-255">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-255">1,9,10</span></span>|<span data-ttu-id="03207-256">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-256">1,9,10</span></span>|<span data-ttu-id="03207-257">1,9,10</span><span class="sxs-lookup"><span data-stu-id="03207-257">1,9,10</span></span>|<span data-ttu-id="03207-258">空值</span><span class="sxs-lookup"><span data-stu-id="03207-258">N/A</span></span>|<span data-ttu-id="03207-259">空值</span><span class="sxs-lookup"><span data-stu-id="03207-259">N/A</span></span>|<span data-ttu-id="03207-260">空值</span><span class="sxs-lookup"><span data-stu-id="03207-260">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="03207-261">符号含义</span><span class="sxs-lookup"><span data-stu-id="03207-261">Key to Symbols</span></span>  
  
|<span data-ttu-id="03207-262">符号</span><span class="sxs-lookup"><span data-stu-id="03207-262">Symbol</span></span>|<span data-ttu-id="03207-263">含义</span><span class="sxs-lookup"><span data-stu-id="03207-263">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="03207-264">不支持任何转换。</span><span class="sxs-lookup"><span data-stu-id="03207-264">No conversion is supported.</span></span> <span data-ttu-id="03207-265">如果在调用 IAccessor::CreateAccessor 时验证绑定，则在 rgStatus\*\* 中返回 DBBINDSTATUS_UPSUPPORTEDCONVERSION。</span><span class="sxs-lookup"><span data-stu-id="03207-265">If the binding is validated when IAccessor::CreateAccessor is called, DBBINDSTATUS_UPSUPPORTEDCONVERSION is returned in *rgStatus*.</span></span> <span data-ttu-id="03207-266">当延迟取值函数验证时，则设置 DBSTATUS_E_BADACCESSOR。</span><span class="sxs-lookup"><span data-stu-id="03207-266">When accessor validation is deferred, DBSTATUS_E_BADACCESSOR is set.</span></span>|  
|<span data-ttu-id="03207-267">空值</span><span class="sxs-lookup"><span data-stu-id="03207-267">N/A</span></span>|<span data-ttu-id="03207-268">不适用。</span><span class="sxs-lookup"><span data-stu-id="03207-268">Not applicable.</span></span>|  
|<span data-ttu-id="03207-269">1</span><span class="sxs-lookup"><span data-stu-id="03207-269">1</span></span>|<span data-ttu-id="03207-270">如果提供的数据无效，则设置 DBSTATUS_E_CANTCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="03207-270">If the data supplied is not valid, DBSTATUS_E_CANTCONVERTVALUE is set.</span></span> <span data-ttu-id="03207-271">在应用转换前验证输入数据，因此即使后续转换忽略某一部分，该部分仍然有效，以使转换成功完成。</span><span class="sxs-lookup"><span data-stu-id="03207-271">Input data is validated before conversions are applied, so even when a component will be ignored by a subsequent conversion it must still be valid for the conversion to succeed.</span></span>|  
|<span data-ttu-id="03207-272">2</span><span class="sxs-lookup"><span data-stu-id="03207-272">2</span></span>|<span data-ttu-id="03207-273">忽略时间字段。</span><span class="sxs-lookup"><span data-stu-id="03207-273">Time fields are ignored.</span></span>|  
|<span data-ttu-id="03207-274">3</span><span class="sxs-lookup"><span data-stu-id="03207-274">3</span></span>|<span data-ttu-id="03207-275">秒的小数部分必须为零，或者设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="03207-275">Fractional seconds must be zero or DBSTATUS_E_DATAOVERFLOW is set.</span></span>|  
|<span data-ttu-id="03207-276">4</span><span class="sxs-lookup"><span data-stu-id="03207-276">4</span></span>|<span data-ttu-id="03207-277">忽略日期部分。</span><span class="sxs-lookup"><span data-stu-id="03207-277">The date component is ignored.</span></span>|  
|<span data-ttu-id="03207-278">5</span><span class="sxs-lookup"><span data-stu-id="03207-278">5</span></span>|<span data-ttu-id="03207-279">根据客户端的时区设置设置时区。</span><span class="sxs-lookup"><span data-stu-id="03207-279">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="03207-280">6</span><span class="sxs-lookup"><span data-stu-id="03207-280">6</span></span>|<span data-ttu-id="03207-281">时间设置为零。</span><span class="sxs-lookup"><span data-stu-id="03207-281">The time is set to zero.</span></span>|  
|<span data-ttu-id="03207-282">7</span><span class="sxs-lookup"><span data-stu-id="03207-282">7</span></span>|<span data-ttu-id="03207-283">日期设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="03207-283">The date is set to the current date.</span></span>|  
|<span data-ttu-id="03207-284">8</span><span class="sxs-lookup"><span data-stu-id="03207-284">8</span></span>|<span data-ttu-id="03207-285">将时间转换为 UTC。</span><span class="sxs-lookup"><span data-stu-id="03207-285">The time is converted to UTC.</span></span> <span data-ttu-id="03207-286">如果在此转换过程中出现错误，则设置 DBSTATUS_E_CANTCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="03207-286">If an error occurs during this conversion, DBSTATUS_E_CANTCONVERTVALUE is set.</span></span>|  
|<span data-ttu-id="03207-287">9</span><span class="sxs-lookup"><span data-stu-id="03207-287">9</span></span>|<span data-ttu-id="03207-288">字符串分析为 ISO 文字并转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="03207-288">The string is parsed as an ISO literal and converted to the target type.</span></span> <span data-ttu-id="03207-289">如果上述操作失败，该字符串则分析为 OLE 日期文字（还包含时间部分），并从 OLE 日期 (DBTYPE_DATE) 转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="03207-289">If this fails, the string is parsed as an OLE date literal (which also has time components) and converted from an OLE date (DBTYPE_DATE) to the target type.</span></span><br /><br /> <span data-ttu-id="03207-290">如果目标类型为 DBTIMESTAMP、`smalldatetime`、`datetime` 或 `datetime2`，字符串必须符合日期、时间或 `datetime2` 文字的语法或 OLE 可识别的语法。</span><span class="sxs-lookup"><span data-stu-id="03207-290">If the target type is DBTIMESTAMP, `smalldatetime`, `datetime`, or `datetime2`, the string must conform to the syntax for date, time, or `datetime2` literals, or the syntax recognized by OLE.</span></span> <span data-ttu-id="03207-291">如果字符串为日期文字，所有时间部分将设置为零。</span><span class="sxs-lookup"><span data-stu-id="03207-291">If the string is a date literal, all time components are set to zero.</span></span> <span data-ttu-id="03207-292">如果字符串为时间文字，则将日期设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="03207-292">If the string is a time literal, the date is set to the current date.</span></span><br /><br /> <span data-ttu-id="03207-293">对于所有其他目标类型，字符串必须符合目标类型的文字语法。</span><span class="sxs-lookup"><span data-stu-id="03207-293">For all other target types, the string must conform to the syntax for literals of the target type.</span></span>|  
|<span data-ttu-id="03207-294">10</span><span class="sxs-lookup"><span data-stu-id="03207-294">10</span></span>|<span data-ttu-id="03207-295">如果截断秒的小数部分，且发生数据丢失，则设置 DBSTATUS_E_DATAOVERFLOW。</span><span class="sxs-lookup"><span data-stu-id="03207-295">If truncation of fractional seconds with data loss occurs, DBSTATUS_E_DATAOVERFLOW is set.</span></span> <span data-ttu-id="03207-296">对于字符串转换，仅当该字符串符合 ISO 语法时才能执行溢出检查。</span><span class="sxs-lookup"><span data-stu-id="03207-296">For string conversions, overflow checking is only possible when the string conforms to ISO syntax.</span></span> <span data-ttu-id="03207-297">如果字符串为 OLE 日期文字，则舍入秒的小数部分。</span><span class="sxs-lookup"><span data-stu-id="03207-297">If the string is an OLE date literal, fractional seconds are rounded.</span></span><br /><br /> <span data-ttu-id="03207-298">对于从 DBTIMESTAMP (datetime) 到 smalldatetime 的转换， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 将自行截断秒的值而不引发 DBSTATUS_E_DATAOVERFLOW 错误。</span><span class="sxs-lookup"><span data-stu-id="03207-298">For conversion from DBTIMESTAMP (datetime) to smalldatetime [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client will silently truncate the seconds value instead of raising the DBSTATUS_E_DATAOVERFLOW error.</span></span>|  
|<span data-ttu-id="03207-299">11</span><span class="sxs-lookup"><span data-stu-id="03207-299">11</span></span>|<span data-ttu-id="03207-300">秒的小数部分的位数（小数位数）根据下表的目标列的大小确定。</span><span class="sxs-lookup"><span data-stu-id="03207-300">The number of fractional second digits (the scale) is determined from the destination column's size, according to the following table.</span></span> <span data-ttu-id="03207-301">对于大于表中范围的列大小，则暗指小数位数为 9。</span><span class="sxs-lookup"><span data-stu-id="03207-301">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="03207-302">此转换应允许最高 9 位的秒的小数部分位数，这是 OLE DB 允许的最大位数。</span><span class="sxs-lookup"><span data-stu-id="03207-302">This conversion should allow for up to nine fractional second digits, the maximum allowed by OLE DB.</span></span><br /><br /> <span data-ttu-id="03207-303">但是，如果源类型为 DBTIMESTAMP 且秒的小数部分为零，则不会生成秒的小数部分位数或小数点。</span><span class="sxs-lookup"><span data-stu-id="03207-303">However, if the source type is DBTIMESTAMP and the fractional seconds is zero, no fractional second digits or decimal point are generated.</span></span> <span data-ttu-id="03207-304">此行为确保使用早期 OLE DB 访问接口开发的应用程序的向后兼容性。</span><span class="sxs-lookup"><span data-stu-id="03207-304">This behavior ensures backwards compatibility for applications developed using older OLE DB providers.</span></span><br /><br /> <span data-ttu-id="03207-305">列大小为 ~0 则表示 OLE DB 的大小不受限制（即 9 位数，除非应用 DBTIMESTAMP 的三位数规则）。</span><span class="sxs-lookup"><span data-stu-id="03207-305">A column size of ~0 implies unlimited size in OLE DB (9 digits, unless the 3-digit rule for DBTIMESTAMP applies).</span></span><br /><br /> <span data-ttu-id="03207-306">**DBTIME2** - 8, 10..18（长度，以字符为单位）；0, 1..9（小数位数）</span><span class="sxs-lookup"><span data-stu-id="03207-306">**DBTIME2** - 8, 10..18 (length in chars); 0, 1..9 (scale)</span></span><br /><br /> <span data-ttu-id="03207-307">**DBTIMESTAMP** - 19, 21..29（长度，以字符为单位）；0, 1..9（小数位数）</span><span class="sxs-lookup"><span data-stu-id="03207-307">**DBTIMESTAMP** - 19, 21..29 (length in chars); 0, 1..9 (scale)</span></span><br /><br /> <span data-ttu-id="03207-308">**DBTIMESTAMPOFFSET** - 26, 28..36（长度，以字符为单位）；0, 1..9（小数位数）</span><span class="sxs-lookup"><span data-stu-id="03207-308">**DBTIMESTAMPOFFSET** - 26, 28..36 (length in chars); 0, 1..9 (scale)</span></span>|  
|<span data-ttu-id="03207-309">12</span><span class="sxs-lookup"><span data-stu-id="03207-309">12</span></span>|<span data-ttu-id="03207-310">将保留 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前的 DBTYPE_DATE 转换语义。</span><span class="sxs-lookup"><span data-stu-id="03207-310">Conversion semantics prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] for DBTYPE_DATE are maintained.</span></span> <span data-ttu-id="03207-311">秒的小数部分被截断为零。</span><span class="sxs-lookup"><span data-stu-id="03207-311">Fractional seconds are truncated to zero.</span></span>|  
|<span data-ttu-id="03207-312">13</span><span class="sxs-lookup"><span data-stu-id="03207-312">13</span></span>|<span data-ttu-id="03207-313">将保留 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前的 DBTYPE_FILETIME 转换语义。</span><span class="sxs-lookup"><span data-stu-id="03207-313">Conversion semantics prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] for DBTYPE_FILETIME are maintained.</span></span> <span data-ttu-id="03207-314">如果使用 Windows FileTimeToSystemTime API，秒的小数部分精度则限制为 1 毫秒。</span><span class="sxs-lookup"><span data-stu-id="03207-314">If you use the Windows FileTimeToSystemTime API, the fractional seconds precision is limited to 1 millisecond.</span></span>|  
|<span data-ttu-id="03207-315">14</span><span class="sxs-lookup"><span data-stu-id="03207-315">14</span></span>|<span data-ttu-id="03207-316">将保留 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前的 `smalldatetime` 转换语义。</span><span class="sxs-lookup"><span data-stu-id="03207-316">Conversion semantics prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] for `smalldatetime` are maintained.</span></span> <span data-ttu-id="03207-317">秒设置为零。</span><span class="sxs-lookup"><span data-stu-id="03207-317">Seconds are set to zero.</span></span>|  
|<span data-ttu-id="03207-318">15</span><span class="sxs-lookup"><span data-stu-id="03207-318">15</span></span>|<span data-ttu-id="03207-319">将保留 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 之前的 `datetime` 转换语义。</span><span class="sxs-lookup"><span data-stu-id="03207-319">Conversion semantics prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] for `datetime` are maintained.</span></span> <span data-ttu-id="03207-320">秒舍入为最接近的 1/300 秒。</span><span class="sxs-lookup"><span data-stu-id="03207-320">Seconds are rounded to the nearest 300th of a second.</span></span>|  
|<span data-ttu-id="03207-321">16</span><span class="sxs-lookup"><span data-stu-id="03207-321">16</span></span>|<span data-ttu-id="03207-322">嵌入 SSVARIANT 客户端结构的指定类型值的转换行为与未嵌入 SSVARIANT 客户端结构的相同类型和相同值的行为相同。</span><span class="sxs-lookup"><span data-stu-id="03207-322">The conversion behavior of a value (of a given type) embedded in a SSVARIANT client struct is the same as the behavior of the same value and type when not embedded in a SSVARIANT client struct.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="03207-323">另请参阅</span><span class="sxs-lookup"><span data-stu-id="03207-323">See Also</span></span>  
 [<span data-ttu-id="03207-324">绑定和转换 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="03207-324">Bindings and Conversions &#40;OLE DB&#41;</span></span>](conversions-ole-db.md)  
  
  
