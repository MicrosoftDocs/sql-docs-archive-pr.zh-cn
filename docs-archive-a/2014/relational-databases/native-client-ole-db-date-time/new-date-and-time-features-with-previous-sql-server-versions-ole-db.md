---
title: 具有以前 SQL Server 版本的新的日期和时间功能 (OLE DB) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- date/time [OLE DB], enhanced behavior with earlier SQL Server versions
ms.assetid: 96976bac-018c-47cc-b1b2-fa9605eb55e5
author: rothja
ms.author: jroth
ms.openlocfilehash: c7b1bda9b7bf8808ae622f9f68368d395f49a9be
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589550"
---
# <a name="new-date-and-time-features-with-previous-sql-server-versions-ole-db"></a><span data-ttu-id="ab6bf-102">SQL Server 早期版本的新日期和时间功能 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-102">New Date and Time Features with Previous SQL Server Versions (OLE DB)</span></span>
  <span data-ttu-id="ab6bf-103">本主题介绍当使用增强的日期和时间功能的客户端应用程序与早于的版本通信时的预期行为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] ，以及当使用早于的 Native client 版本编译的客户端 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 向支持日期和时间增强功能的服务器发送命令时的预期行为。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-103">This topic describes the expected behavior when a client application that uses enhanced date and time features communicates with a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], and when a client compiled with a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] sends commands to a server that supports enhanced date and time features.</span></span>  
  
## <a name="down-level-client-behavior"></a><span data-ttu-id="ab6bf-104">下级客户端行为</span><span class="sxs-lookup"><span data-stu-id="ab6bf-104">Down-Level Client Behavior</span></span>  
 <span data-ttu-id="ab6bf-105">使用早于的 Native Client 版本的客户端应用程序将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 新的日期/时间类型视为 `nvarchar` 列。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-105">Client applications that use a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] see the new date/time types as `nvarchar` columns.</span></span> <span data-ttu-id="ab6bf-106">这些列内容是文字表示。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-106">The column contents are literal representations.</span></span> <span data-ttu-id="ab6bf-107">有关详细信息，请参阅[数据类型支持 OLE DB 日期和时间改进](data-type-support-for-ole-db-date-and-time-improvements.md)的 "数据格式：字符串和文字" 部分。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-107">For more information, see the "Data Formats: Strings and Literals" section of [Data Type Support for OLE DB Date and Time Improvements](data-type-support-for-ole-db-date-and-time-improvements.md).</span></span> <span data-ttu-id="ab6bf-108">列大小是为列指定的精度的最大文字长度。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-108">The column size is the maximum literal length for the precision specified for the column.</span></span>  
  
 <span data-ttu-id="ab6bf-109">目录 API 将返回与返回给客户端的下级数据类型代码（例如 `nvarchar`）和关联的下级表示形式（例如相应的文字格式）一致的元数据。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-109">Catalog APIs will return metadata consistent with the down-level data type code returned to the client (for example, `nvarchar`) and the associated down-level representation (for example, the appropriate literal format).</span></span> <span data-ttu-id="ab6bf-110">不过，返回的数据类型名称将为 real [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 类型名称。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-110">However, the data type name returned will be the real [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] type name.</span></span>  
  
 <span data-ttu-id="ab6bf-111">当下级客户端应用程序针对 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (或更高版本运行时) 服务器上对日期/时间类型进行架构更改时，预期的行为如下所示：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-111">When a down-level client application runs against a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server on which schema changes to date/time types have been made, the expected behavior is as follows:</span></span>  
  
|<span data-ttu-id="ab6bf-112">OLE DB 客户端类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-112">OLE DB client type</span></span>|<span data-ttu-id="ab6bf-113">SQL Server 2005 类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-113">SQL Server 2005 type</span></span>|<span data-ttu-id="ab6bf-114">SQL Server 2008 (或更高版本) 类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-114">SQL Server 2008 (or later) type</span></span>|<span data-ttu-id="ab6bf-115">结果转换（服务器到客户端）</span><span class="sxs-lookup"><span data-stu-id="ab6bf-115">Result conversion (server to client)</span></span>|<span data-ttu-id="ab6bf-116">参数转换（客户端到服务器）</span><span class="sxs-lookup"><span data-stu-id="ab6bf-116">Parameter conversion (client to server)</span></span>|  
|------------------------|--------------------------|---------------------------------------|--------------------------------------------|-----------------------------------------------|  
|<span data-ttu-id="ab6bf-117">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-117">DBTYPE_DBDATE</span></span>|<span data-ttu-id="ab6bf-118">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-118">Datetime</span></span>|<span data-ttu-id="ab6bf-119">日期</span><span class="sxs-lookup"><span data-stu-id="ab6bf-119">Date</span></span>|<span data-ttu-id="ab6bf-120">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-120">OK</span></span>|<span data-ttu-id="ab6bf-121">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-121">OK</span></span>|  
|<span data-ttu-id="ab6bf-122">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-122">DBTYPE_DBTIMESTAMP</span></span>|||<span data-ttu-id="ab6bf-123">时间字段设置为零。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-123">Time fields set to zero.</span></span>|<span data-ttu-id="ab6bf-124">如果时间字段非零，则 IRowsetChange 将因字符串截断而失败。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-124">IRowsetChange will fail due to string truncation if the time field is non-zero.</span></span>|  
|<span data-ttu-id="ab6bf-125">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-125">DBTYPE_DBTIME</span></span>||<span data-ttu-id="ab6bf-126">Time(0)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-126">Time(0)</span></span>|<span data-ttu-id="ab6bf-127">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-127">OK</span></span>|<span data-ttu-id="ab6bf-128">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-128">OK</span></span>|  
|<span data-ttu-id="ab6bf-129">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-129">DBTYPE_DBTIMESTAMP</span></span>|||<span data-ttu-id="ab6bf-130">日期字段设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-130">Date fields set to current date.</span></span>|<span data-ttu-id="ab6bf-131">如果秒的小数部分为非零，IRowsetChange 将失败，原因是字符串截断。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-131">IRowsetChange will fail due to string truncation if fractional seconds are non-zero.</span></span><br /><br /> <span data-ttu-id="ab6bf-132">日期将被忽略。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-132">Date is ignored.</span></span>|  
|<span data-ttu-id="ab6bf-133">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-133">DBTYPE_DBTIME</span></span>||<span data-ttu-id="ab6bf-134">Time(7)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-134">Time(7)</span></span>|<span data-ttu-id="ab6bf-135">失败-时间文本无效。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-135">Fails - invalid time literal.</span></span>|<span data-ttu-id="ab6bf-136">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-136">OK</span></span>|  
|<span data-ttu-id="ab6bf-137">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-137">DBTYPE_DBTIMESTAMP</span></span>|||<span data-ttu-id="ab6bf-138">失败-时间文本无效。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-138">Fails - invalid time literal.</span></span>|<span data-ttu-id="ab6bf-139">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-139">OK</span></span>|  
|<span data-ttu-id="ab6bf-140">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-140">DBTYPE_DBTIMESTAMP</span></span>||<span data-ttu-id="ab6bf-141">Datetime2 (3) </span><span class="sxs-lookup"><span data-stu-id="ab6bf-141">Datetime2(3)</span></span>|<span data-ttu-id="ab6bf-142">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-142">OK</span></span>|<span data-ttu-id="ab6bf-143">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-143">OK</span></span>|  
|<span data-ttu-id="ab6bf-144">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-144">DBTYPE_DBTIMESTAMP</span></span>||<span data-ttu-id="ab6bf-145">Datetime2 (7) </span><span class="sxs-lookup"><span data-stu-id="ab6bf-145">Datetime2(7)</span></span>|<span data-ttu-id="ab6bf-146">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-146">OK</span></span>|<span data-ttu-id="ab6bf-147">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-147">OK</span></span>|  
|<span data-ttu-id="ab6bf-148">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-148">DBTYPE_DBDATE</span></span>|<span data-ttu-id="ab6bf-149">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-149">Smalldatetime</span></span>|<span data-ttu-id="ab6bf-150">日期</span><span class="sxs-lookup"><span data-stu-id="ab6bf-150">Date</span></span>|<span data-ttu-id="ab6bf-151">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-151">OK</span></span>|<span data-ttu-id="ab6bf-152">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-152">OK</span></span>|  
|<span data-ttu-id="ab6bf-153">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-153">DBTYPE_DBTIMESTAMP</span></span>|||<span data-ttu-id="ab6bf-154">时间字段设置为零。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-154">Time fields set to zero.</span></span>|<span data-ttu-id="ab6bf-155">如果时间字段非零，则 IRowsetChange 将因字符串截断而失败。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-155">IRowsetChange will fail due to string truncation if time field is non-zero.</span></span>|  
|<span data-ttu-id="ab6bf-156">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-156">DBTYPE_DBTIME</span></span>||<span data-ttu-id="ab6bf-157">Time(0)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-157">Time(0)</span></span>|<span data-ttu-id="ab6bf-158">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-158">OK</span></span>|<span data-ttu-id="ab6bf-159">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-159">OK</span></span>|  
|<span data-ttu-id="ab6bf-160">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-160">DBTYPE_DBTIMESTAMP</span></span>|||<span data-ttu-id="ab6bf-161">日期字段设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-161">Date fields set to current date.</span></span>|<span data-ttu-id="ab6bf-162">如果秒的小数部分为非零，IRowsetChange 将失败，原因是字符串截断。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-162">IRowsetChange will fail due to string truncation if fractional seconds are non-zero.</span></span><br /><br /> <span data-ttu-id="ab6bf-163">日期将被忽略。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-163">Date is ignored.</span></span>|  
|<span data-ttu-id="ab6bf-164">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-164">DBTYPE_DBTIMESTAMP</span></span>||<span data-ttu-id="ab6bf-165">Datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-165">Datetime2(0)</span></span>|<span data-ttu-id="ab6bf-166">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-166">OK</span></span>|<span data-ttu-id="ab6bf-167">确定</span><span class="sxs-lookup"><span data-stu-id="ab6bf-167">OK</span></span>|  
  
 <span data-ttu-id="ab6bf-168">“可以”表示如果已适用于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]，应继续适用于 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]（或更高版本）。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-168">OK means that if it worked with [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], it should continue to work with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later).</span></span>  
  
 <span data-ttu-id="ab6bf-169">只考虑了以下常见的架构更改：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-169">Only the following common schema changes have been considered:</span></span>  
  
-   <span data-ttu-id="ab6bf-170">使用新类型，这种情况下在逻辑上应用程序只需要一个日期或时间值。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-170">Using a new type where logically an application requires only a date or time value.</span></span> <span data-ttu-id="ab6bf-171">但是，强制了应用程序使用 `datetime` 或 `smalldatetime`，因为单独的日期和时间类型不可用。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-171">However, the application was forced to use `datetime` or `smalldatetime` because separate date and time types were not available.</span></span>  
  
-   <span data-ttu-id="ab6bf-172">使用新类型以获得其他秒小数精度或准确性。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-172">Using a new type to gain additional fractional seconds precision or accuracy.</span></span>  
  
-   <span data-ttu-id="ab6bf-173">切换到 `datetime2`，因为这是首选的日期和时间数据类型。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-173">Switching to `datetime2` because this is the preferred data type for date and time.</span></span>  
  
 <span data-ttu-id="ab6bf-174">如果源类型的字符串表示形式大于目标类型的字符串表示形式，则使用通过 ICommandWithParameters：： GetParameterInfo 或架构行集获取的服务器元数据的应用程序通过 ICommandWithParameters：： SetParameterInfo 设置参数类型信息会失败。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-174">Applications that use server metadata obtained through ICommandWithParameters::GetParameterInfo or schema rowsets to set parameter type information through ICommandWithParameters::SetParameterInfo will fail during client conversions where the string representation of a source type is larger than the string representation of the destination type.</span></span> <span data-ttu-id="ab6bf-175">例如，如果客户端绑定使用 DBTYPE_DBTIMESTAMP 并且服务器列是日期，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native client 会将值转换为 "yyyy-mm-dd hh： mm： ss"，但服务器元数据将返回为 `nvarchar(10)` 。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-175">For example, if a client binding uses DBTYPE_DBTIMESTAMP and the server column is date, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client will convert the value to "yyyy-dd-mm hh:mm:ss.fff", but server metadata will be returned as `nvarchar(10)`.</span></span> <span data-ttu-id="ab6bf-176">生成的溢出会导致 DBSTATUS_E_CATCONVERTVALUE。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-176">The resulting overflow causes DBSTATUS_E_CATCONVERTVALUE.</span></span> <span data-ttu-id="ab6bf-177">IRowsetChange 的数据转换会出现类似的问题，因为行集元数据是通过结果集元数据设置的。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-177">Similar problems arise with data conversions by IRowsetChange, because the rowset metadata is set from the resultset metadata.</span></span>  
  
### <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="ab6bf-178">参数和行集元数据</span><span class="sxs-lookup"><span data-stu-id="ab6bf-178">Parameter and Rowset Metadata</span></span>  
 <span data-ttu-id="ab6bf-179">本部分介绍使用早于的 Native Client 版本编译的客户端的参数、结果列和架构行集的元数据 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-179">This section describes metadata for parameters, result columns, and schema rowsets for clients that are compiled with a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span></span>  
  
#### <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="ab6bf-180">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="ab6bf-180">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="ab6bf-181">DBPARAMINFO 结构通过*prgParamInfo*参数返回以下信息：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-181">The DBPARAMINFO structure returns the following information through the *prgParamInfo* parameter:</span></span>  
  
|<span data-ttu-id="ab6bf-182">参数类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-182">Parameter type</span></span>|<span data-ttu-id="ab6bf-183">wType</span><span class="sxs-lookup"><span data-stu-id="ab6bf-183">wType</span></span>|<span data-ttu-id="ab6bf-184">ulParamSize</span><span class="sxs-lookup"><span data-stu-id="ab6bf-184">ulParamSize</span></span>|<span data-ttu-id="ab6bf-185">bPrecision</span><span class="sxs-lookup"><span data-stu-id="ab6bf-185">bPrecision</span></span>|<span data-ttu-id="ab6bf-186">bScale</span><span class="sxs-lookup"><span data-stu-id="ab6bf-186">bScale</span></span>|  
|--------------------|-----------|-----------------|----------------|------------|  
|<span data-ttu-id="ab6bf-187">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-187">date</span></span>|<span data-ttu-id="ab6bf-188">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-188">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-189">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-189">10</span></span>|<span data-ttu-id="ab6bf-190">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-190">~0</span></span>|<span data-ttu-id="ab6bf-191">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-191">~0</span></span>|  
|<span data-ttu-id="ab6bf-192">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-192">time</span></span>|<span data-ttu-id="ab6bf-193">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-193">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-194">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-194">8, 10..16</span></span>|<span data-ttu-id="ab6bf-195">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-195">~0</span></span>|<span data-ttu-id="ab6bf-196">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-196">~0</span></span>|  
|<span data-ttu-id="ab6bf-197">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-197">smalldatetime</span></span>|<span data-ttu-id="ab6bf-198">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-198">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-199">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-199">16</span></span>|<span data-ttu-id="ab6bf-200">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-200">16</span></span>|<span data-ttu-id="ab6bf-201">0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-201">0</span></span>|  
|<span data-ttu-id="ab6bf-202">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-202">datetime</span></span>|<span data-ttu-id="ab6bf-203">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-203">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-204">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-204">16</span></span>|<span data-ttu-id="ab6bf-205">23</span><span class="sxs-lookup"><span data-stu-id="ab6bf-205">23</span></span>|<span data-ttu-id="ab6bf-206">3</span><span class="sxs-lookup"><span data-stu-id="ab6bf-206">3</span></span>|  
|<span data-ttu-id="ab6bf-207">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-207">datetime2</span></span>|<span data-ttu-id="ab6bf-208">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-208">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-209">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-209">19,21..27</span></span>|<span data-ttu-id="ab6bf-210">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-210">~0</span></span>|<span data-ttu-id="ab6bf-211">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-211">~0</span></span>|  
|<span data-ttu-id="ab6bf-212">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-212">datetimeoffset</span></span>|<span data-ttu-id="ab6bf-213">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-213">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-214">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-214">26,28..34</span></span>|<span data-ttu-id="ab6bf-215">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-215">~0</span></span>|<span data-ttu-id="ab6bf-216">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-216">~0</span></span>|  
  
 <span data-ttu-id="ab6bf-217">请注意，某些值范围不是连续的，例如，8,10..16 中缺少 9。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-217">Notice that some of these value ranges are not continuous; for example, 9 is missing in 8,10..16.</span></span> <span data-ttu-id="ab6bf-218">这是因为当小数精度大于零时添加了小数点。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-218">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
#### <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="ab6bf-219">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-219">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="ab6bf-220">会返回以下列：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-220">The following columns are returned:</span></span>  
  
|<span data-ttu-id="ab6bf-221">列类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-221">Column type</span></span>|<span data-ttu-id="ab6bf-222">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-222">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="ab6bf-223">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-223">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="ab6bf-224">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="ab6bf-224">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="ab6bf-225">DBCOLUMN_SCALE、DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="ab6bf-225">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|--------------------------------------------------|  
|<span data-ttu-id="ab6bf-226">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-226">date</span></span>|<span data-ttu-id="ab6bf-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-228">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-228">10</span></span>|<span data-ttu-id="ab6bf-229">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-229">NULL</span></span>|<span data-ttu-id="ab6bf-230">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-230">NULL</span></span>|  
|<span data-ttu-id="ab6bf-231">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-231">time</span></span>|<span data-ttu-id="ab6bf-232">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-232">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-233">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-233">8, 10..16</span></span>|<span data-ttu-id="ab6bf-234">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-234">NULL</span></span>|<span data-ttu-id="ab6bf-235">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-235">NULL</span></span>|  
|<span data-ttu-id="ab6bf-236">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-236">smalldatetime</span></span>|<span data-ttu-id="ab6bf-237">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-237">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-238">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-238">16</span></span>|<span data-ttu-id="ab6bf-239">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-239">16</span></span>|<span data-ttu-id="ab6bf-240">0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-240">0</span></span>|  
|<span data-ttu-id="ab6bf-241">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-241">datetime</span></span>|<span data-ttu-id="ab6bf-242">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-242">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-243">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-243">16</span></span>|<span data-ttu-id="ab6bf-244">23</span><span class="sxs-lookup"><span data-stu-id="ab6bf-244">23</span></span>|<span data-ttu-id="ab6bf-245">3</span><span class="sxs-lookup"><span data-stu-id="ab6bf-245">3</span></span>|  
|<span data-ttu-id="ab6bf-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-246">datetime2</span></span>|<span data-ttu-id="ab6bf-247">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-247">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-248">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-248">19,21..27</span></span>|<span data-ttu-id="ab6bf-249">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-249">NULL</span></span>|<span data-ttu-id="ab6bf-250">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-250">NULL</span></span>|  
|<span data-ttu-id="ab6bf-251">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-251">datetimeoffset</span></span>|<span data-ttu-id="ab6bf-252">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-252">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-253">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-253">26,28..34</span></span>|<span data-ttu-id="ab6bf-254">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-254">NULL</span></span>|<span data-ttu-id="ab6bf-255">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-255">NULL</span></span>|  
  
#### <a name="columnsinfogetcolumninfo"></a><span data-ttu-id="ab6bf-256">ColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="ab6bf-256">ColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="ab6bf-257">DBCOLUMNINFO 结构返回以下信息：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-257">The DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="ab6bf-258">参数类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-258">Parameter Type</span></span>|<span data-ttu-id="ab6bf-259">wType</span><span class="sxs-lookup"><span data-stu-id="ab6bf-259">wType</span></span>|<span data-ttu-id="ab6bf-260">ulColumnSize</span><span class="sxs-lookup"><span data-stu-id="ab6bf-260">ulColumnSize</span></span>|<span data-ttu-id="ab6bf-261">bPrecision</span><span class="sxs-lookup"><span data-stu-id="ab6bf-261">bPrecision</span></span>|<span data-ttu-id="ab6bf-262">bScale</span><span class="sxs-lookup"><span data-stu-id="ab6bf-262">bScale</span></span>|  
|--------------------|-----------|------------------|----------------|------------|  
|<span data-ttu-id="ab6bf-263">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-263">date</span></span>|<span data-ttu-id="ab6bf-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-265">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-265">10</span></span>|<span data-ttu-id="ab6bf-266">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-266">~0</span></span>|<span data-ttu-id="ab6bf-267">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-267">~0</span></span>|  
|<span data-ttu-id="ab6bf-268">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-268">time(1..7)</span></span>|<span data-ttu-id="ab6bf-269">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-269">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-270">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-270">8, 10..16</span></span>|<span data-ttu-id="ab6bf-271">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-271">~0</span></span>|<span data-ttu-id="ab6bf-272">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-272">~0</span></span>|  
|<span data-ttu-id="ab6bf-273">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-273">smalldatetime</span></span>|<span data-ttu-id="ab6bf-274">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-274">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-275">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-275">16</span></span>|<span data-ttu-id="ab6bf-276">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-276">16</span></span>|<span data-ttu-id="ab6bf-277">0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-277">0</span></span>|  
|<span data-ttu-id="ab6bf-278">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-278">datetime</span></span>|<span data-ttu-id="ab6bf-279">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-279">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-280">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-280">16</span></span>|<span data-ttu-id="ab6bf-281">23</span><span class="sxs-lookup"><span data-stu-id="ab6bf-281">23</span></span>|<span data-ttu-id="ab6bf-282">3</span><span class="sxs-lookup"><span data-stu-id="ab6bf-282">3</span></span>|  
|<span data-ttu-id="ab6bf-283">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-283">datetime2</span></span>|<span data-ttu-id="ab6bf-284">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-284">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-285">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-285">19,21..27</span></span>|<span data-ttu-id="ab6bf-286">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-286">~0</span></span>|<span data-ttu-id="ab6bf-287">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-287">~0</span></span>|  
|<span data-ttu-id="ab6bf-288">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-288">datetimeoffset</span></span>|<span data-ttu-id="ab6bf-289">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-289">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-290">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-290">26,28..34</span></span>|<span data-ttu-id="ab6bf-291">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-291">~0</span></span>|<span data-ttu-id="ab6bf-292">~0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-292">~0</span></span>|  
  
### <a name="schema-rowsets"></a><span data-ttu-id="ab6bf-293">架构行集</span><span class="sxs-lookup"><span data-stu-id="ab6bf-293">Schema Rowsets</span></span>  
 <span data-ttu-id="ab6bf-294">本部分论述了新数据类型的参数、结果列以及架构行集的元数据。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-294">This section discusses metadata for parameters, result columns, and schema rowsets for new data types.</span></span> <span data-ttu-id="ab6bf-295">此信息非常有用，因为你有使用早于 Native Client 的工具开发的客户端提供程序 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-295">This information is useful is you have a client provider developed using tools earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
#### <a name="columns-rowset"></a><span data-ttu-id="ab6bf-296">COLUMNS 行集</span><span class="sxs-lookup"><span data-stu-id="ab6bf-296">COLUMNS Rowset</span></span>  
 <span data-ttu-id="ab6bf-297">对于日期/时间类型将返回以下列值：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-297">The following column values are returned for date/time types:</span></span>  
  
|<span data-ttu-id="ab6bf-298">列类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-298">Column type</span></span>|<span data-ttu-id="ab6bf-299">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-299">DATA_TYPE</span></span>|<span data-ttu-id="ab6bf-300">CHARACTER_MAXIMUM_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-300">CHARACTER_MAXIMUM_LENGTH</span></span>|<span data-ttu-id="ab6bf-301">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-301">CHARACTER_OCTET_LENGTH</span></span>|<span data-ttu-id="ab6bf-302">DATETIME_PRECISION</span><span class="sxs-lookup"><span data-stu-id="ab6bf-302">DATETIME_PRECISION</span></span>|  
|-----------------|----------------|--------------------------------|------------------------------|-------------------------|  
|<span data-ttu-id="ab6bf-303">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-303">date</span></span>|<span data-ttu-id="ab6bf-304">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-304">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-305">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-305">10</span></span>|<span data-ttu-id="ab6bf-306">20</span><span class="sxs-lookup"><span data-stu-id="ab6bf-306">20</span></span>|<span data-ttu-id="ab6bf-307">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-307">NULL</span></span>|  
|<span data-ttu-id="ab6bf-308">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-308">time</span></span>|<span data-ttu-id="ab6bf-309">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-309">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-310">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-310">8, 10..16</span></span>|<span data-ttu-id="ab6bf-311">16，20. 32</span><span class="sxs-lookup"><span data-stu-id="ab6bf-311">16,20..32</span></span>|<span data-ttu-id="ab6bf-312">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-312">NULL</span></span>|  
|<span data-ttu-id="ab6bf-313">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-313">smalldatetime</span></span>|<span data-ttu-id="ab6bf-314">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-314">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-315">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-315">NULL</span></span>|<span data-ttu-id="ab6bf-316">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-316">NULL</span></span>|<span data-ttu-id="ab6bf-317">0</span><span class="sxs-lookup"><span data-stu-id="ab6bf-317">0</span></span>|  
|<span data-ttu-id="ab6bf-318">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-318">datetime</span></span>|<span data-ttu-id="ab6bf-319">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-319">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-320">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-320">NULL</span></span>|<span data-ttu-id="ab6bf-321">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-321">NULL</span></span>|<span data-ttu-id="ab6bf-322">3</span><span class="sxs-lookup"><span data-stu-id="ab6bf-322">3</span></span>|  
|<span data-ttu-id="ab6bf-323">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-323">datetime2</span></span>|<span data-ttu-id="ab6bf-324">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-324">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-325">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-325">19,21..27</span></span>|<span data-ttu-id="ab6bf-326">38，42。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-326">38,42..54</span></span>|<span data-ttu-id="ab6bf-327">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-327">NULL</span></span>|  
|<span data-ttu-id="ab6bf-328">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-328">datetimeoffset</span></span>|<span data-ttu-id="ab6bf-329">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-329">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-330">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-330">26,28..34</span></span>|<span data-ttu-id="ab6bf-331">52，56。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-331">52, 56..68</span></span>|<span data-ttu-id="ab6bf-332">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-332">NULL</span></span>|  
  
#### <a name="procedure_parameters-rowset"></a><span data-ttu-id="ab6bf-333">PROCEDURE_PARAMETERS 行集</span><span class="sxs-lookup"><span data-stu-id="ab6bf-333">PROCEDURE_PARAMETERS Rowset</span></span>  
 <span data-ttu-id="ab6bf-334">对于日期/时间类型将返回以下列值：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-334">The following column values are returned for date/time types:</span></span>  
  
|<span data-ttu-id="ab6bf-335">列类型</span><span class="sxs-lookup"><span data-stu-id="ab6bf-335">Column type</span></span>|<span data-ttu-id="ab6bf-336">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-336">DATA_TYPE</span></span>|<span data-ttu-id="ab6bf-337">CHARACTER_MAXIMUM_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-337">CHARACTER_MAXIMUM_LENGTH</span></span>|<span data-ttu-id="ab6bf-338">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-338">CHARACTER_OCTET_LENGTH</span></span>|<span data-ttu-id="ab6bf-339">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-339">TYPE_NAME</span></span><br /><br /> <span data-ttu-id="ab6bf-340">LOCAL_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-340">LOCAL_TYPE_NAME</span></span>|  
|-----------------|----------------|--------------------------------|------------------------------|--------------------------------------|  
|<span data-ttu-id="ab6bf-341">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-341">date</span></span>|<span data-ttu-id="ab6bf-342">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-342">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-343">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-343">10</span></span>|<span data-ttu-id="ab6bf-344">20</span><span class="sxs-lookup"><span data-stu-id="ab6bf-344">20</span></span>|<span data-ttu-id="ab6bf-345">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-345">date</span></span>|  
|<span data-ttu-id="ab6bf-346">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-346">time</span></span>|<span data-ttu-id="ab6bf-347">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-347">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-348">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-348">8, 10..16</span></span>|<span data-ttu-id="ab6bf-349">16，20. 32</span><span class="sxs-lookup"><span data-stu-id="ab6bf-349">16,20..32</span></span>|<span data-ttu-id="ab6bf-350">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-350">time</span></span>|  
|<span data-ttu-id="ab6bf-351">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-351">smalldatetime</span></span>|<span data-ttu-id="ab6bf-352">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-352">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-353">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-353">NULL</span></span>|<span data-ttu-id="ab6bf-354">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-354">NULL</span></span>|<span data-ttu-id="ab6bf-355">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-355">smalldatetime</span></span>|  
|<span data-ttu-id="ab6bf-356">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-356">datetime</span></span>|<span data-ttu-id="ab6bf-357">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-357">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-358">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-358">NULL</span></span>|<span data-ttu-id="ab6bf-359">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-359">NULL</span></span>|<span data-ttu-id="ab6bf-360">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-360">datetime</span></span>|  
|<span data-ttu-id="ab6bf-361">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-361">datetime2</span></span>|<span data-ttu-id="ab6bf-362">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-362">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-363">19，21. 27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-363">19,21..27</span></span>|<span data-ttu-id="ab6bf-364">38，42。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-364">38,42..54</span></span>|<span data-ttu-id="ab6bf-365">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-365">datetime2</span></span>|  
|<span data-ttu-id="ab6bf-366">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-366">datetimeoffset</span></span>|<span data-ttu-id="ab6bf-367">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-367">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-368">26，28. 34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-368">26,28..34</span></span>|<span data-ttu-id="ab6bf-369">52，56。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-369">52, 56..68</span></span>|<span data-ttu-id="ab6bf-370">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-370">datetimeoffset</span></span>|  
  
#### <a name="provider_types-rowset"></a><span data-ttu-id="ab6bf-371">PROVIDER_TYPES 行集</span><span class="sxs-lookup"><span data-stu-id="ab6bf-371">PROVIDER_TYPES Rowset</span></span>  
 <span data-ttu-id="ab6bf-372">对于日期/时间类型将返回以下行：</span><span class="sxs-lookup"><span data-stu-id="ab6bf-372">The following rows are returned for date/time types:</span></span>  
  
|<span data-ttu-id="ab6bf-373">类型 -></span><span class="sxs-lookup"><span data-stu-id="ab6bf-373">Type -></span></span><br /><br /> <span data-ttu-id="ab6bf-374">列</span><span class="sxs-lookup"><span data-stu-id="ab6bf-374">Column</span></span>|<span data-ttu-id="ab6bf-375">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-375">date</span></span>|<span data-ttu-id="ab6bf-376">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-376">time</span></span>|<span data-ttu-id="ab6bf-377">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-377">smalldatetime</span></span>|<span data-ttu-id="ab6bf-378">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-378">datetime</span></span>|<span data-ttu-id="ab6bf-379">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-379">datetime2</span></span>|<span data-ttu-id="ab6bf-380">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-380">datetimeoffset</span></span>|  
|--------------------------|----------|----------|-------------------|--------------|---------------|--------------------|  
|<span data-ttu-id="ab6bf-381">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-381">TYPE_NAME</span></span>|<span data-ttu-id="ab6bf-382">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-382">date</span></span>|<span data-ttu-id="ab6bf-383">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-383">time</span></span>|<span data-ttu-id="ab6bf-384">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-384">smalldatetime</span></span>|<span data-ttu-id="ab6bf-385">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-385">datetime</span></span>|<span data-ttu-id="ab6bf-386">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-386">datetime2</span></span>|<span data-ttu-id="ab6bf-387">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-387">datetimeoffset</span></span>|  
|<span data-ttu-id="ab6bf-388">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-388">DATA_TYPE</span></span>|<span data-ttu-id="ab6bf-389">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-389">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-390">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-390">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-391">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-391">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-392">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="ab6bf-392">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="ab6bf-393">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-393">DBTYPE_WSTR</span></span>|<span data-ttu-id="ab6bf-394">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="ab6bf-394">DBTYPE_WSTR</span></span>|  
|<span data-ttu-id="ab6bf-395">COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-395">COLUMN_SIZE</span></span>|<span data-ttu-id="ab6bf-396">10</span><span class="sxs-lookup"><span data-stu-id="ab6bf-396">10</span></span>|<span data-ttu-id="ab6bf-397">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-397">16</span></span>|<span data-ttu-id="ab6bf-398">16</span><span class="sxs-lookup"><span data-stu-id="ab6bf-398">16</span></span>|<span data-ttu-id="ab6bf-399">23</span><span class="sxs-lookup"><span data-stu-id="ab6bf-399">23</span></span>|<span data-ttu-id="ab6bf-400">27</span><span class="sxs-lookup"><span data-stu-id="ab6bf-400">27</span></span>|<span data-ttu-id="ab6bf-401">34</span><span class="sxs-lookup"><span data-stu-id="ab6bf-401">34</span></span>|  
|<span data-ttu-id="ab6bf-402">LITERAL_PREFIX</span><span class="sxs-lookup"><span data-stu-id="ab6bf-402">LITERAL_PREFIX</span></span>|<span data-ttu-id="ab6bf-403">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-403">'</span></span>|<span data-ttu-id="ab6bf-404">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-404">'</span></span>|<span data-ttu-id="ab6bf-405">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-405">'</span></span>|<span data-ttu-id="ab6bf-406">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-406">'</span></span>|<span data-ttu-id="ab6bf-407">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-407">'</span></span>|<span data-ttu-id="ab6bf-408">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-408">'</span></span>|  
|<span data-ttu-id="ab6bf-409">LITERAL_SUFFIX</span><span class="sxs-lookup"><span data-stu-id="ab6bf-409">LITERAL_SUFFIX</span></span>|<span data-ttu-id="ab6bf-410">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-410">'</span></span>|<span data-ttu-id="ab6bf-411">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-411">'</span></span>|<span data-ttu-id="ab6bf-412">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-412">'</span></span>|<span data-ttu-id="ab6bf-413">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-413">'</span></span>|<span data-ttu-id="ab6bf-414">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-414">'</span></span>|<span data-ttu-id="ab6bf-415">'</span><span class="sxs-lookup"><span data-stu-id="ab6bf-415">'</span></span>|  
|<span data-ttu-id="ab6bf-416">CREATE_PARAMS</span><span class="sxs-lookup"><span data-stu-id="ab6bf-416">CREATE_PARAMS</span></span>|<span data-ttu-id="ab6bf-417">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-417">NULL</span></span>|<span data-ttu-id="ab6bf-418">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-418">NULL</span></span>|<span data-ttu-id="ab6bf-419">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-419">NULL</span></span>|<span data-ttu-id="ab6bf-420">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-420">NULL</span></span>|<span data-ttu-id="ab6bf-421">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-421">NULL</span></span>|<span data-ttu-id="ab6bf-422">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-422">NULL</span></span>|  
|<span data-ttu-id="ab6bf-423">IS_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-423">IS_NULLABLE</span></span>|<span data-ttu-id="ab6bf-424">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-424">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-425">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-425">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-426">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-426">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-427">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-427">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-428">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-428">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-429">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-429">VARIANT_TRUE</span></span>|  
|<span data-ttu-id="ab6bf-430">CASE_SENSITIVE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-430">CASE_SENSITIVE</span></span>|<span data-ttu-id="ab6bf-431">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-431">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-432">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-432">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-433">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-433">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-434">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-434">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-435">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-435">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-436">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-436">VARIANT_FALSE</span></span>|  
|<span data-ttu-id="ab6bf-437">可搜索</span><span class="sxs-lookup"><span data-stu-id="ab6bf-437">SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-438">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-438">DB_SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-439">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-439">DB_SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-440">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-440">DB_SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-441">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-441">DB_SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-442">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-442">DB_SEARCHABLE</span></span>|<span data-ttu-id="ab6bf-443">DB_SEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-443">DB_SEARCHABLE</span></span>|  
|<span data-ttu-id="ab6bf-444">UNSIGNED_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-444">UNSIGNED_ATTRIBUTE</span></span>|<span data-ttu-id="ab6bf-445">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-445">NULL</span></span>|<span data-ttu-id="ab6bf-446">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-446">NULL</span></span>|<span data-ttu-id="ab6bf-447">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-447">NULL</span></span>|<span data-ttu-id="ab6bf-448">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-448">NULL</span></span>|<span data-ttu-id="ab6bf-449">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-449">NULL</span></span>|<span data-ttu-id="ab6bf-450">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-450">NULL</span></span>|  
|<span data-ttu-id="ab6bf-451">FIXED_PREC_SCALE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-451">FIXED_PREC_SCALE</span></span>|<span data-ttu-id="ab6bf-452">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-452">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-453">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-453">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-454">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-454">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-455">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-455">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-456">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-456">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-457">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-457">VARIANT_FALSE</span></span>|  
|<span data-ttu-id="ab6bf-458">AUTO_UNIQUE_VALUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-458">AUTO_UNIQUE_VALUE</span></span>|<span data-ttu-id="ab6bf-459">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-459">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-460">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-460">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-461">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-461">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-462">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-462">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-463">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-463">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-464">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-464">VARIANT_FALSE</span></span>|  
|<span data-ttu-id="ab6bf-465">LOCAL_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ab6bf-465">LOCAL_TYPE_NAME</span></span>|<span data-ttu-id="ab6bf-466">date</span><span class="sxs-lookup"><span data-stu-id="ab6bf-466">date</span></span>|<span data-ttu-id="ab6bf-467">time</span><span class="sxs-lookup"><span data-stu-id="ab6bf-467">time</span></span>|<span data-ttu-id="ab6bf-468">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-468">smalldatetime</span></span>|<span data-ttu-id="ab6bf-469">datetime</span><span class="sxs-lookup"><span data-stu-id="ab6bf-469">datetime</span></span>|<span data-ttu-id="ab6bf-470">datetime2</span><span class="sxs-lookup"><span data-stu-id="ab6bf-470">datetime2</span></span>|<span data-ttu-id="ab6bf-471">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="ab6bf-471">datetimeoffset</span></span>|  
|<span data-ttu-id="ab6bf-472">MINIMUM_SCALE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-472">MINIMUM_SCALE</span></span>|<span data-ttu-id="ab6bf-473">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-473">NULL</span></span>|<span data-ttu-id="ab6bf-474">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-474">NULL</span></span>|<span data-ttu-id="ab6bf-475">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-475">NULL</span></span>|<span data-ttu-id="ab6bf-476">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-476">NULL</span></span>|<span data-ttu-id="ab6bf-477">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-477">NULL</span></span>|<span data-ttu-id="ab6bf-478">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-478">NULL</span></span>|  
|<span data-ttu-id="ab6bf-479">MAXIMUM_SCALE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-479">MAXIMUM_SCALE</span></span>|<span data-ttu-id="ab6bf-480">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-480">NULL</span></span>|<span data-ttu-id="ab6bf-481">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-481">NULL</span></span>|<span data-ttu-id="ab6bf-482">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-482">NULL</span></span>|<span data-ttu-id="ab6bf-483">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-483">NULL</span></span>|<span data-ttu-id="ab6bf-484">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-484">NULL</span></span>|<span data-ttu-id="ab6bf-485">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-485">NULL</span></span>|  
|<span data-ttu-id="ab6bf-486">GUID</span><span class="sxs-lookup"><span data-stu-id="ab6bf-486">GUID</span></span>|<span data-ttu-id="ab6bf-487">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-487">NULL</span></span>|<span data-ttu-id="ab6bf-488">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-488">NULL</span></span>|<span data-ttu-id="ab6bf-489">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-489">NULL</span></span>|<span data-ttu-id="ab6bf-490">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-490">NULL</span></span>|<span data-ttu-id="ab6bf-491">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-491">NULL</span></span>|<span data-ttu-id="ab6bf-492">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-492">NULL</span></span>|  
|<span data-ttu-id="ab6bf-493">TYPELIB</span><span class="sxs-lookup"><span data-stu-id="ab6bf-493">TYPELIB</span></span>|<span data-ttu-id="ab6bf-494">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-494">NULL</span></span>|<span data-ttu-id="ab6bf-495">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-495">NULL</span></span>|<span data-ttu-id="ab6bf-496">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-496">NULL</span></span>|<span data-ttu-id="ab6bf-497">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-497">NULL</span></span>|<span data-ttu-id="ab6bf-498">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-498">NULL</span></span>|<span data-ttu-id="ab6bf-499">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-499">NULL</span></span>|  
|<span data-ttu-id="ab6bf-500">VERSION</span><span class="sxs-lookup"><span data-stu-id="ab6bf-500">VERSION</span></span>|<span data-ttu-id="ab6bf-501">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-501">NULL</span></span>|<span data-ttu-id="ab6bf-502">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-502">NULL</span></span>|<span data-ttu-id="ab6bf-503">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-503">NULL</span></span>|<span data-ttu-id="ab6bf-504">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-504">NULL</span></span>|<span data-ttu-id="ab6bf-505">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-505">NULL</span></span>|<span data-ttu-id="ab6bf-506">Null</span><span class="sxs-lookup"><span data-stu-id="ab6bf-506">NULL</span></span>|  
|<span data-ttu-id="ab6bf-507">IS_LONG</span><span class="sxs-lookup"><span data-stu-id="ab6bf-507">IS_LONG</span></span>|<span data-ttu-id="ab6bf-508">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-508">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-509">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-509">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-510">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-510">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-511">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-511">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-512">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-512">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-513">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-513">VARIANT_FALSE</span></span>|  
|<span data-ttu-id="ab6bf-514">BEST_MATCH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-514">BEST_MATCH</span></span>|<span data-ttu-id="ab6bf-515">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-515">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-516">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-516">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-517">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-517">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-518">VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-518">VARIANT_TRUE</span></span>|<span data-ttu-id="ab6bf-519">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-519">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-520">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-520">VARIANT_FALSE</span></span>|  
|<span data-ttu-id="ab6bf-521">IS_FIXEDLENGTH</span><span class="sxs-lookup"><span data-stu-id="ab6bf-521">IS_FIXEDLENGTH</span></span>|<span data-ttu-id="ab6bf-522">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-522">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-523">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-523">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-524">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-524">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-525">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-525">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-526">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-526">VARIANT_FALSE</span></span>|<span data-ttu-id="ab6bf-527">VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="ab6bf-527">VARIANT_FALSE</span></span>|  
  
## <a name="down-level-server-behavior"></a><span data-ttu-id="ab6bf-528">下级服务器行为</span><span class="sxs-lookup"><span data-stu-id="ab6bf-528">Down-Level Server Behavior</span></span>  
 <span data-ttu-id="ab6bf-529">连接到早于的服务器时 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] ，尝试使用新的服务器类型名称 (例如，使用 ICommandWithParameters：： SetParameterInfo 或 ITableDefinition：： CreateTable) 会导致 DB_E_BADTYPENAME。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-529">When connected to a server of an earlier version than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], any attempt to use the new server type names (for example, with ICommandWithParameters::SetParameterInfo or ITableDefinition::CreateTable) will result in DB_E_BADTYPENAME.</span></span>  
  
 <span data-ttu-id="ab6bf-530">如果在不使用类型名称的情况下针对参数或结果绑定新类型，且新类型用于隐式指定服务器类型，或服务器类型到客户端类型之间没有有效的转换，则将返回 DB_E_ERRORSOCCURRED，且 DBBINDSTATUS_UNSUPPORTED_CONVERSION 设置为在执行时使用的取值函数的绑定状态。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-530">If new types are bound for parameters or results without the use of a type name, and either the new type is used to specify the server type implicitly or there is no valid conversion from the server type to the client type, DB_E_ERRORSOCCURRED is returned, and DBBINDSTATUS_UNSUPPORTED_CONVERSION is set as the binding status for the accessor used at Execute.</span></span>  
  
 <span data-ttu-id="ab6bf-531">如果在连接时支持从缓冲区类型到服务器版本的服务器类型之间的客户端转换，则可以使用所有客户端缓冲区类型。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-531">If there is a supported client conversion from the buffer type to the server type for the server version on the connection, all client buffer types can be used.</span></span> <span data-ttu-id="ab6bf-532">在此上下文中，如果未调用 ICommandWithParameters：： SetParameterInfo，则*服务器类型*表示由 ICommandWithParameters：： SetParameterInfo 指定的类型或由缓冲区类型隐含的类型。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-532">In this context, *server type* means the type specified by ICommandWithParameters::SetParameterInfo, or implied by the buffer type if ICommandWithParameters::SetParameterInfo has not been called.</span></span> <span data-ttu-id="ab6bf-533">这意味着 DBTYPE_DBTIME2 和 DBTYPE_DBTIMESTAMPOFFSET 可用于下级服务器，或在 DataTypeCompatibility=80 时，对支持的服务器类型的客户端转换成功的情况下，也可使用。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-533">This means that DBTYPE_DBTIME2 and DBTYPE_DBTIMESTAMPOFFSET can be used with down-level servers, or when DataTypeCompatibility=80, if the client conversion to a supported server type succeeds.</span></span> <span data-ttu-id="ab6bf-534">当然，如果服务器类型不正确，且该服务器类型不能执行对实际服务器类型的隐式转换，则服务器仍可能报告错误。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-534">Of course, if the server type is incorrect, an error might still be reported by the server if it cannot perform an implicit conversion to the actual server type.</span></span>  
  
## <a name="ssprop_init_datatypecompatibility-behavior"></a><span data-ttu-id="ab6bf-535">SSPROP_INIT_DATATYPECOMPATIBILITY 行为</span><span class="sxs-lookup"><span data-stu-id="ab6bf-535">SSPROP_INIT_DATATYPECOMPATIBILITY Behavior</span></span>  
 <span data-ttu-id="ab6bf-536">将 SSPROP_INIT_DATATYPECOMPATIBILITY 设置为 SSPROPVAL_DATATYPECOMPATIBILITY_SQL2000 时，新的日期/时间类型和关联的元数据将显示在客户端上，因为它们对于下级客户端显示，如[&#40;OLE DB 和 ODBC&#41;的对增强日期和时间类型的大容量复制更改](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-536">When SSPROP_INIT_DATATYPECOMPATIBILITY is set to SSPROPVAL_DATATYPECOMPATIBILITY_SQL2000, the new date/time types and associated metadata appear to clients as they appear for down-level clients, as described in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="ab6bf-537">IRowsetFind 的可比性</span><span class="sxs-lookup"><span data-stu-id="ab6bf-537">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="ab6bf-538">允许对新的日期/时间类型使用所有比较运算符，因为这些比较运算符显示为字符串类型，而不是显示为日期/时间类型。</span><span class="sxs-lookup"><span data-stu-id="ab6bf-538">All comparison operators are allowed for the new date/time types, because they appear as string types rather than date/time types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ab6bf-539">另请参阅</span><span class="sxs-lookup"><span data-stu-id="ab6bf-539">See Also</span></span>  
 [<span data-ttu-id="ab6bf-540">日期和时间改进 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="ab6bf-540">Date and Time Improvements &#40;OLE DB&#41;</span></span>](date-and-time-improvements-ole-db.md)  
  
  
