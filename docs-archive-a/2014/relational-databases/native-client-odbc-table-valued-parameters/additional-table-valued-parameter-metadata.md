---
title: 其他表值参数元数据 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), catalog functions to retrieve metadata
- table-valued parameters (ODBC), metadata
ms.assetid: 6c193188-5185-4373-9a0d-76cfc150c828
author: rothja
ms.author: jroth
ms.openlocfilehash: 9907b6bdbabcea427e5feffd14369e8aa718094f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589561"
---
# <a name="additional-table-valued-parameter-metadata"></a><span data-ttu-id="5bda4-102">其他表值参数的元数据</span><span class="sxs-lookup"><span data-stu-id="5bda4-102">Additional Table-Valued Parameter Metadata</span></span>
  <span data-ttu-id="5bda4-103">若要检索表值参数的元数据，应用程序将调用 SQLProcedureColumns。</span><span class="sxs-lookup"><span data-stu-id="5bda4-103">To retrieve metadata for a table-valued parameter, an application calls SQLProcedureColumns.</span></span> <span data-ttu-id="5bda4-104">对于表值参数，SQLProcedureColumns 将返回单个行。</span><span class="sxs-lookup"><span data-stu-id="5bda4-104">For a table-valued parameter, SQLProcedureColumns returns a single row.</span></span> <span data-ttu-id="5bda4-105">添加了两个额外 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 特定的列 SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME，以提供与表值参数关联的表类型的架构和目录信息。</span><span class="sxs-lookup"><span data-stu-id="5bda4-105">Two additional [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific columns, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME, have been added to provide schema and catalog information for table types associated with table-valued parameters.</span></span> <span data-ttu-id="5bda4-106">为了符合 ODBC 规范，SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 的显示位置位于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 早期版本中添加的所有驱动程序特定列之前，并位于 ODBC 自身委托的所有列之后。</span><span class="sxs-lookup"><span data-stu-id="5bda4-106">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver-specific columns added in earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="5bda4-107">下表列出了对表值参数非常重要的列。</span><span class="sxs-lookup"><span data-stu-id="5bda4-107">The following table lists columns that are significant for table-valued parameters.</span></span>  
  
|<span data-ttu-id="5bda4-108">列名称</span><span class="sxs-lookup"><span data-stu-id="5bda4-108">Column name</span></span>|<span data-ttu-id="5bda4-109">数据类型</span><span class="sxs-lookup"><span data-stu-id="5bda4-109">Data type</span></span>|<span data-ttu-id="5bda4-110">值/注释</span><span class="sxs-lookup"><span data-stu-id="5bda4-110">Value/comments</span></span>|  
|-----------------|---------------|---------------------|  
|<span data-ttu-id="5bda4-111">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="5bda4-111">DATA_TYPE</span></span>|<span data-ttu-id="5bda4-112">Smallint（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-112">Smallint not NULL</span></span>|<span data-ttu-id="5bda4-113">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="5bda4-113">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="5bda4-114">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="5bda4-114">TYPE_NAME</span></span>|<span data-ttu-id="5bda4-115">WVarchar(128)（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-115">WVarchar(128) not NULL</span></span>|<span data-ttu-id="5bda4-116">表值参数的类型名称。</span><span class="sxs-lookup"><span data-stu-id="5bda4-116">The type name of the table-valued parameter.</span></span>|  
|<span data-ttu-id="5bda4-117">COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="5bda4-117">COLUMN_SIZE</span></span>|<span data-ttu-id="5bda4-118">Integer</span><span class="sxs-lookup"><span data-stu-id="5bda4-118">Integer</span></span>|<span data-ttu-id="5bda4-119">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-119">NULL</span></span>|  
|<span data-ttu-id="5bda4-120">BUFFER_LENGTH</span><span class="sxs-lookup"><span data-stu-id="5bda4-120">BUFFER_LENGTH</span></span>|<span data-ttu-id="5bda4-121">Integer</span><span class="sxs-lookup"><span data-stu-id="5bda4-121">Integer</span></span>|<span data-ttu-id="5bda4-122">0</span><span class="sxs-lookup"><span data-stu-id="5bda4-122">0</span></span>|  
|<span data-ttu-id="5bda4-123">DECIMAL_DIGITS</span><span class="sxs-lookup"><span data-stu-id="5bda4-123">DECIMAL_DIGITS</span></span>|<span data-ttu-id="5bda4-124">Smallint</span><span class="sxs-lookup"><span data-stu-id="5bda4-124">Smallint</span></span>|<span data-ttu-id="5bda4-125">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-125">NULL</span></span>|  
|<span data-ttu-id="5bda4-126">NUM_PREC_RADIX</span><span class="sxs-lookup"><span data-stu-id="5bda4-126">NUM_PREC_RADIX</span></span>|<span data-ttu-id="5bda4-127">Smallint</span><span class="sxs-lookup"><span data-stu-id="5bda4-127">Smallint</span></span>|<span data-ttu-id="5bda4-128">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-128">NULL</span></span>|  
|<span data-ttu-id="5bda4-129">NULLABLE</span><span class="sxs-lookup"><span data-stu-id="5bda4-129">NULLABLE</span></span>|<span data-ttu-id="5bda4-130">Smallint（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-130">Smallint not NULL</span></span>|<span data-ttu-id="5bda4-131">SQL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="5bda4-131">SQL_NULLABLE</span></span>|  
|<span data-ttu-id="5bda4-132">REMARKS</span><span class="sxs-lookup"><span data-stu-id="5bda4-132">REMARKS</span></span>|<span data-ttu-id="5bda4-133">Varchar</span><span class="sxs-lookup"><span data-stu-id="5bda4-133">Varchar</span></span>|<span data-ttu-id="5bda4-134">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-134">NULL</span></span>|  
|<span data-ttu-id="5bda4-135">COLUMN_DEF</span><span class="sxs-lookup"><span data-stu-id="5bda4-135">COLUMN_DEF</span></span>|<span data-ttu-id="5bda4-136">WVarchar(4000)</span><span class="sxs-lookup"><span data-stu-id="5bda4-136">WVarchar(4000)</span></span>|<span data-ttu-id="5bda4-137">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-137">NULL</span></span>|  
|<span data-ttu-id="5bda4-138">SQL_DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="5bda4-138">SQL_DATA_TYPE</span></span>|<span data-ttu-id="5bda4-139">Smallint（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-139">Smallint not NULL</span></span>|<span data-ttu-id="5bda4-140">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="5bda4-140">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="5bda4-141">SQL_DATETIME_SUB</span><span class="sxs-lookup"><span data-stu-id="5bda4-141">SQL_DATETIME_SUB</span></span>|<span data-ttu-id="5bda4-142">Smallint</span><span class="sxs-lookup"><span data-stu-id="5bda4-142">Smallint</span></span>|<span data-ttu-id="5bda4-143">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-143">NULL</span></span>|  
|<span data-ttu-id="5bda4-144">CHAR_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="5bda4-144">CHAR_OCTET_LENGTH</span></span>|<span data-ttu-id="5bda4-145">Integer</span><span class="sxs-lookup"><span data-stu-id="5bda4-145">Integer</span></span>|<span data-ttu-id="5bda4-146">Null</span><span class="sxs-lookup"><span data-stu-id="5bda4-146">NULL</span></span>|  
|<span data-ttu-id="5bda4-147">ORDINAL_POSITION</span><span class="sxs-lookup"><span data-stu-id="5bda4-147">ORDINAL_POSITION</span></span>|<span data-ttu-id="5bda4-148">Integer（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-148">Integer not NULL</span></span>|<span data-ttu-id="5bda4-149">参数的序号位置。</span><span class="sxs-lookup"><span data-stu-id="5bda4-149">The ordinal position of the parameter.</span></span>|  
|<span data-ttu-id="5bda4-150">IS_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="5bda4-150">IS_NULLABLE</span></span>|<span data-ttu-id="5bda4-151">Varchar</span><span class="sxs-lookup"><span data-stu-id="5bda4-151">Varchar</span></span>|<span data-ttu-id="5bda4-152">"YES"</span><span class="sxs-lookup"><span data-stu-id="5bda4-152">"YES"</span></span>|  
|<span data-ttu-id="5bda4-153">SS_TYPE_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="5bda4-153">SS_TYPE_CATALOG_NAME</span></span>|<span data-ttu-id="5bda4-154">WVarchar(128)（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-154">WVarchar(128) not NULL</span></span>|<span data-ttu-id="5bda4-155">包含表值参数表类型的类型定义的目录。</span><span class="sxs-lookup"><span data-stu-id="5bda4-155">The catalog that contains the type definition for the table type of the table-valued parameter.</span></span>|  
|<span data-ttu-id="5bda4-156">SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="5bda4-156">SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="5bda4-157">WVarchar(128)（非 NULL）</span><span class="sxs-lookup"><span data-stu-id="5bda4-157">WVarchar(128) not NULL</span></span>|<span data-ttu-id="5bda4-158">包含表值参数表类型的类型定义的架构。</span><span class="sxs-lookup"><span data-stu-id="5bda4-158">The schema that contains the type definition for the table type of the table-valued parameter.</span></span>|  
  
 <span data-ttu-id="5bda4-159">WVarchar 列在 ODBC 规范中定义为 Varchar，但实际上在所有最新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC 驱动程序中作为 WVarchar 返回。</span><span class="sxs-lookup"><span data-stu-id="5bda4-159">The WVarchar columns are defined as Varchar in the ODBC specification, but are actually returned as WVarchar in all recent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC drivers.</span></span> <span data-ttu-id="5bda4-160">该更改是在向 ODBC 3.5 规范添加 Unicide 支持时执行的，但不能显式指出。</span><span class="sxs-lookup"><span data-stu-id="5bda4-160">This change was made when Unicide support was added to the ODBC 3.5 specification, but not called out explicitly.</span></span>  
  
 <span data-ttu-id="5bda4-161">若要获取表值参数的其他元数据，应用程序将使用目录函数 SQLColumns 和 SQLPrimaryKeys。</span><span class="sxs-lookup"><span data-stu-id="5bda4-161">To obtain additional metadata for table-valued parameters, an application uses the catalog functions SQLColumns and SQLPrimaryKeys.</span></span> <span data-ttu-id="5bda4-162">在针对表值参数调用这些函数之前，应用程序必须将语句属性 SQL_SOPT_SS_NAME_SCOPE 设置为 SQL_SS_NAME_SCOPE_TABLE_TYPE。</span><span class="sxs-lookup"><span data-stu-id="5bda4-162">Before these functions are called for table-valued parameters, the application must set the statement attribute SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_TABLE_TYPE.</span></span> <span data-ttu-id="5bda4-163">该值表示应用程序需要表类型的元数据，而不是实际表。</span><span class="sxs-lookup"><span data-stu-id="5bda4-163">This value indicates that the application requires metadata for a table type rather than an actual table.</span></span> <span data-ttu-id="5bda4-164">然后，应用程序将表值参数的 TYPE_NAME 作为*TableName*参数传递。</span><span class="sxs-lookup"><span data-stu-id="5bda4-164">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span> <span data-ttu-id="5bda4-165">SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 分别与*CatalogName*和*SchemaName*参数一起使用，以标识表值参数的目录和架构。</span><span class="sxs-lookup"><span data-stu-id="5bda4-165">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="5bda4-166">在应用程序检索完表值参数的元数据之后，该应用程序必须将 SQL_SOPT_SS_NAME_SCOPE 设置回原来的默认值 SQL_SS_NAME_SCOPE_TABLE。</span><span class="sxs-lookup"><span data-stu-id="5bda4-166">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="5bda4-167">将 SQL_SOPT_SS_NAME_SCOPE 设置为 SQL_SS_NAME_SCOPE_TABLE 时，对链接服务器的查询将失败。</span><span class="sxs-lookup"><span data-stu-id="5bda4-167">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="5bda4-168">对包含服务器组件的目录的 SQLColumns 或 SQLPrimaryKeys 的调用将失败。</span><span class="sxs-lookup"><span data-stu-id="5bda4-168">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5bda4-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5bda4-169">See Also</span></span>  
 [<span data-ttu-id="5bda4-170">ODBC&#41;&#40;表值参数</span><span class="sxs-lookup"><span data-stu-id="5bda4-170">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
