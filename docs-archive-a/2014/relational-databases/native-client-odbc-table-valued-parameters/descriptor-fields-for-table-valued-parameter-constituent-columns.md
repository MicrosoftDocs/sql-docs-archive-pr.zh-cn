---
title: 表值参数构成列的描述符字段 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields for constituent columns
ms.assetid: 944b3968-fd47-4847-98d6-b87e8ef2acdc
author: rothja
ms.author: jroth
ms.openlocfilehash: 7474a4a80309f6ce9754fefabfd0080c89f803b3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589558"
---
# <a name="descriptor-fields-for-table-valued-parameter-constituent-columns"></a><span data-ttu-id="22dcb-102">表值参数构成列的描述符字段</span><span class="sxs-lookup"><span data-stu-id="22dcb-102">Descriptor Fields for Table-Valued Parameter Constituent Columns</span></span>
  <span data-ttu-id="22dcb-103">本部分中描述的表值参数描述符字段是通过将[SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md)和[SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md)与实现参数描述符的句柄结合使用来进行操作的， (IPD) 。</span><span class="sxs-lookup"><span data-stu-id="22dcb-103">The table-valued parameter descriptor fields described in this section are manipulated by using [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) and [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) with the handle for the implementation parameter descriptor (IPD).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="22dcb-104">备注</span><span class="sxs-lookup"><span data-stu-id="22dcb-104">Remarks</span></span>  
 <span data-ttu-id="22dcb-105">SQL_DESC_AUTO_UNIQUE_VALUE 用于表值参数以及其他功能。</span><span class="sxs-lookup"><span data-stu-id="22dcb-105">SQL_DESC_AUTO_UNIQUE_VALUE is used for table-valued parameters as well as other features.</span></span>  
  
|<span data-ttu-id="22dcb-106">属性名称</span><span class="sxs-lookup"><span data-stu-id="22dcb-106">Attribute name</span></span>|<span data-ttu-id="22dcb-107">类型</span><span class="sxs-lookup"><span data-stu-id="22dcb-107">Type</span></span>|<span data-ttu-id="22dcb-108">说明</span><span class="sxs-lookup"><span data-stu-id="22dcb-108">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="22dcb-109">SQL_DESC_AUTO_UNIQUE_VALUE</span><span class="sxs-lookup"><span data-stu-id="22dcb-109">SQL_DESC_AUTO_UNIQUE_VALUE</span></span>|<span data-ttu-id="22dcb-110">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="22dcb-110">SQLINTEGER</span></span>|<span data-ttu-id="22dcb-111">SQL_TRUE 指示该列是标识列。</span><span class="sxs-lookup"><span data-stu-id="22dcb-111">SQL_TRUE indicates that this column is an identity column.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="22dcb-112">可使用此信息来优化性能，但不要求应用程序为标识列设置该设置。</span><span class="sxs-lookup"><span data-stu-id="22dcb-112">can use this information to optimize performance, but applications are not required to set it for identity columns.</span></span>|  
  
 <span data-ttu-id="22dcb-113">以下属性将添加到应用程序参数描述符 (APD) 和实现参数描述符 (IPD) 中的所有参数类型：</span><span class="sxs-lookup"><span data-stu-id="22dcb-113">The following attributes are added to all parameter types in the application parameter descriptor (APD) and implementation parameter descriptor (IPD):</span></span>  
  
|<span data-ttu-id="22dcb-114">属性名称</span><span class="sxs-lookup"><span data-stu-id="22dcb-114">Attribute name</span></span>|<span data-ttu-id="22dcb-115">类型</span><span class="sxs-lookup"><span data-stu-id="22dcb-115">Type</span></span>|<span data-ttu-id="22dcb-116">说明</span><span class="sxs-lookup"><span data-stu-id="22dcb-116">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="22dcb-117">SQL_CA_SS_COLUMN_COMPUTED</span><span class="sxs-lookup"><span data-stu-id="22dcb-117">SQL_CA_SS_COLUMN_COMPUTED</span></span>|<span data-ttu-id="22dcb-118">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="22dcb-118">SQLSMALLINT</span></span>|<span data-ttu-id="22dcb-119">SQL_TRUE 指示该列是计算列。</span><span class="sxs-lookup"><span data-stu-id="22dcb-119">SQL_TRUE indicates that this column is computed.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="22dcb-120">可使用此信息来优化性能，但不要求应用程序为计算列设置该设置。</span><span class="sxs-lookup"><span data-stu-id="22dcb-120">can use this information to optimize performance, but applications are not required to set it for computed columns.</span></span><br /><br /> <span data-ttu-id="22dcb-121">对于非表值参数列的绑定，将忽略此属性。</span><span class="sxs-lookup"><span data-stu-id="22dcb-121">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="22dcb-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span><span class="sxs-lookup"><span data-stu-id="22dcb-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span></span>|<span data-ttu-id="22dcb-123">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="22dcb-123">SQLSMALLINT</span></span>|<span data-ttu-id="22dcb-124">SQL_TRUE 指示表值参数列参与唯一键。</span><span class="sxs-lookup"><span data-stu-id="22dcb-124">SQL_TRUE indicates that a table-valued parameter column participates in a unique key.</span></span> <span data-ttu-id="22dcb-125">这可能导致查询性能提高。</span><span class="sxs-lookup"><span data-stu-id="22dcb-125">This can result in better query performance.</span></span> <span data-ttu-id="22dcb-126">对于非表值参数列的绑定，将忽略此属性。</span><span class="sxs-lookup"><span data-stu-id="22dcb-126">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="22dcb-127">SQL_CA_SS_COLUMN_SORT_ORDER</span><span class="sxs-lookup"><span data-stu-id="22dcb-127">SQL_CA_SS_COLUMN_SORT_ORDER</span></span>|<span data-ttu-id="22dcb-128">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="22dcb-128">SQLSMALLINT</span></span>|<span data-ttu-id="22dcb-129">指示表值参数列的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="22dcb-129">Indicates the sort order of a table-valued parameter column.</span></span> <span data-ttu-id="22dcb-130">这可能导致查询性能提高。</span><span class="sxs-lookup"><span data-stu-id="22dcb-130">This can result in better query performance.</span></span> <span data-ttu-id="22dcb-131">对于非表值参数列的绑定，将忽略此属性。</span><span class="sxs-lookup"><span data-stu-id="22dcb-131">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="22dcb-132">下面列出了可能的值：</span><span class="sxs-lookup"><span data-stu-id="22dcb-132">The possible values are the following:</span></span><br /><br /> <span data-ttu-id="22dcb-133">-SQL_SS_ASCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="22dcb-133">-   SQL_SS_ASCENDING_ORDER</span></span><br /><span data-ttu-id="22dcb-134">-SQL_SS_DESCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="22dcb-134">-   SQL_SS_DESCENDING_ORDER</span></span><br /><span data-ttu-id="22dcb-135">-SQL_SS_ORDER_UNSPECIFIED</span><span class="sxs-lookup"><span data-stu-id="22dcb-135">-   SQL_SS_ORDER_UNSPECIFIED</span></span><br /><br /> <span data-ttu-id="22dcb-136">SQL_SS_ASCENDING_ORDER 和 SQL_SS_DESCENDING_ORDER 以外的值将产生 SQLSTATE 为 HY024 的错误和“属性值无效”消息，并且将被视为此属性的默认值 SQL_SS_ORDER_UNSPECIFIED。</span><span class="sxs-lookup"><span data-stu-id="22dcb-136">Values other than SQL_SS_ASCENDING_ORDER and SQL_SS_DESCENDING_ORDER generate an error with SQLSTATE HY024 and message 'Invalid attribute value' and are treated as SQL_SS_ORDER_UNSPECIFIED, which is the default value for this attribute.</span></span>|  
|<span data-ttu-id="22dcb-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span><span class="sxs-lookup"><span data-stu-id="22dcb-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span></span>|<span data-ttu-id="22dcb-138">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="22dcb-138">SQLSMALLINT</span></span>|<span data-ttu-id="22dcb-139">指示表值参数列在列集中的序号，它定义表值参数的整体排序顺序。</span><span class="sxs-lookup"><span data-stu-id="22dcb-139">Indicates the ordinal of a table-valued parameter column in the set of columns that define the overall ordering for a table-valued parameter.</span></span> <span data-ttu-id="22dcb-140">这可能导致查询性能提高。</span><span class="sxs-lookup"><span data-stu-id="22dcb-140">This can result in better query performance.</span></span> <span data-ttu-id="22dcb-141">对于非表值参数列的绑定，将忽略此属性。</span><span class="sxs-lookup"><span data-stu-id="22dcb-141">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="22dcb-142">排序序号从 1 开始。</span><span class="sxs-lookup"><span data-stu-id="22dcb-142">Sort ordinals start at 1.</span></span> <span data-ttu-id="22dcb-143">默认值 0 指示表值参数列未进行列排序。</span><span class="sxs-lookup"><span data-stu-id="22dcb-143">A value of 0, the default, indicates that a table-valued parameter column does not have column ordering.</span></span>|  
|<span data-ttu-id="22dcb-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span><span class="sxs-lookup"><span data-stu-id="22dcb-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span></span>|<span data-ttu-id="22dcb-145">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="22dcb-145">SQLSMALLINT</span></span>|<span data-ttu-id="22dcb-146">指示表值参数中的所有行是否都将具有此列的默认值。</span><span class="sxs-lookup"><span data-stu-id="22dcb-146">Indicates whether all rows in the table-valued parameter will have the default value for this column.</span></span> <span data-ttu-id="22dcb-147">对于表值参数，无法逐行选择默认值。</span><span class="sxs-lookup"><span data-stu-id="22dcb-147">For table-valued parameters, it is not possible to select the default value on a row-by-row basis.</span></span> <span data-ttu-id="22dcb-148">值 SQL_FALSE 指示行将具有非默认值。</span><span class="sxs-lookup"><span data-stu-id="22dcb-148">A value of SQL_FALSE indicates that rows will have non-default values.</span></span> <span data-ttu-id="22dcb-149">这是默认设置。</span><span class="sxs-lookup"><span data-stu-id="22dcb-149">This is the default.</span></span> <span data-ttu-id="22dcb-150">值 SQL_TRUE 指示此列的所有行都将具有默认值。</span><span class="sxs-lookup"><span data-stu-id="22dcb-150">A value of SQL_TRUE indicates that this column will have default values for all rows.</span></span><br /><br /> <span data-ttu-id="22dcb-151">如果设置为 SQL_TRUE，则不会将任何数据发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="22dcb-151">If set to SQL_TRUE, no data will be sent to the server.</span></span><br /><br /> <span data-ttu-id="22dcb-152">如果服务器处理不需要相应列值，则此字段还可以用于标识列或计算列。</span><span class="sxs-lookup"><span data-stu-id="22dcb-152">This field can also be used with identity or computed columns if the column values are not required for server processing.</span></span>|  
  
 <span data-ttu-id="22dcb-153">这些属性仅对表值参数列有效。</span><span class="sxs-lookup"><span data-stu-id="22dcb-153">These attributes are only valid for table-valued parameter columns.</span></span> <span data-ttu-id="22dcb-154">对于其他参数，将忽略它们。</span><span class="sxs-lookup"><span data-stu-id="22dcb-154">They are ignored for other parameters.</span></span>  
  
 <span data-ttu-id="22dcb-155">如果为表值参数列设置了 SQL_CA_SS_COL_HAS_DEFAULT_VALUE，则该列的 SQL_DESC_DATA_PTR 必须为 Null 指针。</span><span class="sxs-lookup"><span data-stu-id="22dcb-155">If SQL_CA_SS_COL_HAS_DEFAULT_VALUE is set for a table-valued parameter column, SQL_DESC_DATA_PTR for that column must be a null pointer.</span></span> <span data-ttu-id="22dcb-156">否则，SQLExecute 或 SQLExecDirect 将返回 SQL_ERROR。</span><span class="sxs-lookup"><span data-stu-id="22dcb-156">Otherwise, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="22dcb-157">将使用 SQLSTATE = 07S01 和消息 "参数，列的默认参数的无效用法" 生成诊断记录 \<p> \<c> ，其中 \<p> 是参数序数， \<c> 是列序号。</span><span class="sxs-lookup"><span data-stu-id="22dcb-157">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>, column \<c>", where \<p> is the parameter ordinal and \<c> is the column ordinal.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="22dcb-158">另请参阅</span><span class="sxs-lookup"><span data-stu-id="22dcb-158">See Also</span></span>  
 [<span data-ttu-id="22dcb-159">ODBC&#41;&#40;表值参数</span><span class="sxs-lookup"><span data-stu-id="22dcb-159">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
