---
title: ODBC 游标库 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580261"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="f9a77-102">ODBC 游标库</span><span class="sxs-lookup"><span data-stu-id="f9a77-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="f9a77-103">某些 ODBC 驱动程序仅支持默认游标设置;这些驱动程序也不支持定位游标操作，如**SQLSetPos**。</span><span class="sxs-lookup"><span data-stu-id="f9a77-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="f9a77-104">ODBC 游标库是用于对通常不支持块状游标或静态游标的驱动程序实现这些游标的 Microsoft 数据访问组件 (MDAC) 的组件。</span><span class="sxs-lookup"><span data-stu-id="f9a77-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="f9a77-105">游标库还实现了定位的 UPDATE 和 DELETE 语句，并为它创建的游标实现了**SQLSetPos** 。</span><span class="sxs-lookup"><span data-stu-id="f9a77-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="f9a77-106">ODBC 游标库作为 ODBC 驱动程序管理器和 ODBC 驱动程序之间的层实现。</span><span class="sxs-lookup"><span data-stu-id="f9a77-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="f9a77-107">如果加载 ODBC 游标库，ODBC 驱动程序管理器则将与游标相关的所有命令路由到该游标库，而不是驱动程序。</span><span class="sxs-lookup"><span data-stu-id="f9a77-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="f9a77-108">游标库通过从基础驱动程序提取整个结果集并将此结果集缓存到客户端来实现游标。</span><span class="sxs-lookup"><span data-stu-id="f9a77-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="f9a77-109">当使用 ODBC 游标库时，应用程序仅限于该游标库的游标功能；对基础驱动程序中的其他游标功能的支持不可用于该应用程序。</span><span class="sxs-lookup"><span data-stu-id="f9a77-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="f9a77-110">通常不需要将 ODBC 游标库与 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序一起使用，因为与 ODBC 游标库相比，该驱动程序自身支持更多的游标功能。</span><span class="sxs-lookup"><span data-stu-id="f9a77-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="f9a77-111">与 Native Client ODBC 驱动程序一起使用 ODBC 游标库的唯一原因 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 是，驱动程序通过服务器游标实现其游标支持，而服务器游标不支持所有 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="f9a77-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="f9a77-112">如果需要配合使用静态游标和存储过程、批处理或包含 COMPUTE、COMPUTE BY、FOR BROWSE 或 INTO 的 SQL 语句，请考虑使用 ODBC 游标库。</span><span class="sxs-lookup"><span data-stu-id="f9a77-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="f9a77-113">但是，使用游标库时应非常小心，因为它在客户端上缓存整个结果集，这可能占用大量内存并降低性能。</span><span class="sxs-lookup"><span data-stu-id="f9a77-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="f9a77-114">应用程序在连接到数据源之前，使用[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)来设置 SQL_ATTR_ODBC_CURSORS 连接属性，从而按连接方式调用游标库。</span><span class="sxs-lookup"><span data-stu-id="f9a77-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="f9a77-115">SQL_ATTR_ODBC_CURSORS 设置为下列三个值之一：</span><span class="sxs-lookup"><span data-stu-id="f9a77-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="f9a77-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="f9a77-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="f9a77-117">当此选项设置为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT odbc 驱动程序时，ODBC 游标库将替代 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] NATIVE client odbc 驱动程序的本机游标支持。</span><span class="sxs-lookup"><span data-stu-id="f9a77-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="f9a77-118">只有该游标库支持的游标类型才能用于连接；不能使用服务器游标。</span><span class="sxs-lookup"><span data-stu-id="f9a77-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="f9a77-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="f9a77-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="f9a77-120">如果设置了此选项，则 native Client ODBC 驱动程序的本机支持的所有游标都 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 可以用于连接。</span><span class="sxs-lookup"><span data-stu-id="f9a77-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="f9a77-121">不能使用 ODBC 游标库。</span><span class="sxs-lookup"><span data-stu-id="f9a77-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="f9a77-122">所有游标均作为服务器游标实现。</span><span class="sxs-lookup"><span data-stu-id="f9a77-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="f9a77-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="f9a77-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="f9a77-124">如果设置了此选项，则效果与 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驱动程序一起使用时的效果 SQL_CUR_USE_DRIVER 相同。</span><span class="sxs-lookup"><span data-stu-id="f9a77-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="f9a77-125">在连接时，ODBC 驱动程序管理器会进行测试，以查看连接的 ODBC 驱动程序是否支持[SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md)的 SQL_FETCH_PRIOR 选项。</span><span class="sxs-lookup"><span data-stu-id="f9a77-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="f9a77-126">如果驱动程序不支持此选项，ODBC 驱动程序管理器则加载 ODBC 游标库。</span><span class="sxs-lookup"><span data-stu-id="f9a77-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="f9a77-127">如果驱动程序支持此选项，ODBC 驱动程序管理器则不加载 ODBC 游标库，应用程序将使用该驱动程序的本机支持。</span><span class="sxs-lookup"><span data-stu-id="f9a77-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="f9a77-128">由于 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驱动程序支持 SQL_FETCH_PRIOR，Odbc 驱动程序管理器不会加载 odbc 游标库。</span><span class="sxs-lookup"><span data-stu-id="f9a77-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="f9a77-129">游标库允许应用程序对一个连接使用多个活动语句，以及可滚动、可更新的游标。</span><span class="sxs-lookup"><span data-stu-id="f9a77-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="f9a77-130">必须加载游标库以支持该功能。</span><span class="sxs-lookup"><span data-stu-id="f9a77-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="f9a77-131">使用[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md)指定应如何使用游标库，并使用[SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md)来指定游标类型、并发和行集大小。</span><span class="sxs-lookup"><span data-stu-id="f9a77-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f9a77-132">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f9a77-132">See Also</span></span>  
 [<span data-ttu-id="f9a77-133">如何实现游标</span><span class="sxs-lookup"><span data-stu-id="f9a77-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
