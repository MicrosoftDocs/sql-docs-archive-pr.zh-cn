---
title: OLE DB 表值参数类型支持（方法）| Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580221"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="c5d33-102">OLE DB 表值参数类型支持（方法）</span><span class="sxs-lookup"><span data-stu-id="c5d33-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="c5d33-103">以下标准 OLE DB 方法支持表值参数：</span><span class="sxs-lookup"><span data-stu-id="c5d33-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="c5d33-104">方法</span><span class="sxs-lookup"><span data-stu-id="c5d33-104">Method</span></span>|<span data-ttu-id="c5d33-105">表值参数支持</span><span class="sxs-lookup"><span data-stu-id="c5d33-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="c5d33-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="c5d33-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="c5d33-107">在您了解表值参数的类型信息并且希望基于该类型信息实例化表值参数行集对象时使用。</span><span class="sxs-lookup"><span data-stu-id="c5d33-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="c5d33-108">有关详细信息，请参阅[表值参数行集创建](table-valued-parameter-rowset-creation.md)中的“静态方案”。</span><span class="sxs-lookup"><span data-stu-id="c5d33-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="c5d33-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="c5d33-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="c5d33-110">在您不了解表值参数的类型信息并且希望基于从服务器检索的元数据信息实例化表值参数行集对象时使用。</span><span class="sxs-lookup"><span data-stu-id="c5d33-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="c5d33-111">有关详细信息，请参阅[表值参数行集创建](table-valued-parameter-rowset-creation.md)中的“动态方案”。</span><span class="sxs-lookup"><span data-stu-id="c5d33-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="c5d33-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="c5d33-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="c5d33-113">若要指定表值参数命令参数，使用者应在 DBPARAMBINDINFO 结构的 pwszName 成员中将参数类型指定为“table”或“DBTYPE_TABLE”\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="c5d33-114">ulParamSize\*\* 设置为 ~0。</span><span class="sxs-lookup"><span data-stu-id="c5d33-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="c5d33-115">有关详细信息，请参阅[执行包含表值参数的命令](executing-commands-containing-table-valued-parameters.md)中的“表值参数规范”。</span><span class="sxs-lookup"><span data-stu-id="c5d33-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="c5d33-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="c5d33-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="c5d33-117">设置特定于表值参数的属性，如架构名称、类型名称、列顺序和默认列。</span><span class="sxs-lookup"><span data-stu-id="c5d33-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="c5d33-118">使用者在 SSPARAMPROPS 结构的 iOrdinal 中指定参数的序号\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="c5d33-119">请求的属性集为 DBPROPSET_SQLSERVERPARAMETER。</span><span class="sxs-lookup"><span data-stu-id="c5d33-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="c5d33-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="c5d33-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="c5d33-121">获取某一指定命令的所有参数的类型。</span><span class="sxs-lookup"><span data-stu-id="c5d33-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="c5d33-122">对于表值参数，DBPARAMINFO 结构中的 wType 字段的类型为 DBTYPE_TABLE\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="c5d33-123">ulParamSize 字段将设置为 ~0 以指示未知长度\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="c5d33-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="c5d33-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="c5d33-125">获取 DBTYPE_TABLE 类型的参数的附加类型信息。</span><span class="sxs-lookup"><span data-stu-id="c5d33-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="c5d33-126">使用者在 SSPARAMPROPS 结构的 iOrdinal 成员中指定参数的序号\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="c5d33-127">使用者可以请求 ISSCommandWithParameters::SetParameterProperties 下所列的 DBPROPSET_SQLSERVERPARAMETER 属性集中的任意属性。</span><span class="sxs-lookup"><span data-stu-id="c5d33-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="c5d33-128">由于使用者不清楚表值参数类型，访问接口必须将 SSPROP_PARAM_TYPE_TYPENAME、SSPROP_PARAM_TYPE_SCHEMANAME 和 SSPROP_PARAM_TYPE_CATALOGNAME 设置为各自的正确值。</span><span class="sxs-lookup"><span data-stu-id="c5d33-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="c5d33-129">其余属性（SSPROP_PARAM_TABLE_DEFAULT_COLUMNS 和 SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER）将具有各自的默认值。</span><span class="sxs-lookup"><span data-stu-id="c5d33-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="c5d33-130">在使用者发现表值参数类型名称之后，它使用 IOpenRowset::OpenRowset 创建此表值参数的实例，同时指定表值参数类型的名称。</span><span class="sxs-lookup"><span data-stu-id="c5d33-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="c5d33-131">有关详细信息，请参阅[表值参数类型发现](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="c5d33-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="c5d33-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="c5d33-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="c5d33-133">获取表值参数行集属性。</span><span class="sxs-lookup"><span data-stu-id="c5d33-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="c5d33-134">使用者可以使用这些属性对绑定进行最佳设置。</span><span class="sxs-lookup"><span data-stu-id="c5d33-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="c5d33-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="c5d33-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="c5d33-136">检索有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表的元数据信息。</span><span class="sxs-lookup"><span data-stu-id="c5d33-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="c5d33-137">对于表值参数，同一接口提供有关各列的详细元数据信息，如下所示：</span><span class="sxs-lookup"><span data-stu-id="c5d33-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="c5d33-138">-DBCOLUMN_FLAGS 通过 DBCOLUMNFLAGS_ISNULLABLE 位指示为空性。</span><span class="sxs-lookup"><span data-stu-id="c5d33-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="c5d33-139">-DBCOLUMN_ISUNIQUE 指示列是否为标识列。</span><span class="sxs-lookup"><span data-stu-id="c5d33-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="c5d33-140">-DBCOLUMN_COMPUTEMODE 指示列是否为计算列。</span><span class="sxs-lookup"><span data-stu-id="c5d33-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="c5d33-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="c5d33-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="c5d33-142">若要将表值参数行集对象绑定到命令参数，应创建一个取值函数，并将该函数的 wType 成员设置为 DBTYPE_TABLE\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="c5d33-143">DBOBJECT 结构将包含 iid 成员中的 IID_IRowset 或其他任何有效行集对象接口\*\*。</span><span class="sxs-lookup"><span data-stu-id="c5d33-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="c5d33-144">其余字段的处理方式类似于 DBTYPE_IUNKNOWN。</span><span class="sxs-lookup"><span data-stu-id="c5d33-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c5d33-145">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c5d33-145">See Also</span></span>  
 <span data-ttu-id="c5d33-146">[OLE DB 表值参数类型支持](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="c5d33-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="c5d33-147">[表值参数行集创建](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="c5d33-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="c5d33-148">使用表值参数 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="c5d33-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
