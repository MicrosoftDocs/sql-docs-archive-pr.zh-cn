---
title: sql_variant 对日期和时间类型的支持 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- sql_variant data type
ms.assetid: 12ff1ea6-e2cc-40e6-910c-3126974a90b3
author: rothja
ms.author: jroth
ms.openlocfilehash: 0818f0ccee72264ea7cab69b90e18418179031ca
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692390"
---
# <a name="sql_variant-support-for-date-and-time-types"></a><span data-ttu-id="e1c54-102">sql_variant 对日期和时间类型的支持</span><span class="sxs-lookup"><span data-stu-id="e1c54-102">sql_variant Support for Date and Time Types</span></span>
  <span data-ttu-id="e1c54-103">本主题描述 `sql_variant` 数据类型如何支持增强的日期和时间功能。</span><span class="sxs-lookup"><span data-stu-id="e1c54-103">This topic describes how the `sql_variant` data type supports enhanced date and time functionality.</span></span>  
  
 <span data-ttu-id="e1c54-104">列属性 SQL_CA_SS_VARIANT_TYPE 用于返回变体结果列的 C 类型。</span><span class="sxs-lookup"><span data-stu-id="e1c54-104">The column attribute SQL_CA_SS_VARIANT_TYPE is used to return the C type of a variant result column.</span></span> [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] <span data-ttu-id="e1c54-105">引入了新增的属性 SQL_CA_SS_VARIANT_SQL_TYPE，该属性在实现行描述符 (IRD) 中设置变体结果列的 SQL 类型。</span><span class="sxs-lookup"><span data-stu-id="e1c54-105">introduces an additional attribute, SQL_CA_SS_VARIANT_SQL_TYPE, which sets the SQL type of a variant result column in the implementation row descriptor (IRD).</span></span> <span data-ttu-id="e1c54-106">还可以在实现参数描述符 (IPD) 中使用 SQL_CA_SS_VARIANT_SQL_TYPE，以指定将 SQL_C_BINARY C 类型与 SQL_SS_VARIANT 类型绑定的 SQL_SS_TIME2 或 SQL_SS_TIMESTAMPOFFSET 参数的 SQL 类型。</span><span class="sxs-lookup"><span data-stu-id="e1c54-106">SQL_CA_SS_VARIANT_SQL_TYPE can also be used in the implementation parameter descriptor (IPD) to specify the SQL type of a SQL_SS_TIME2 or SQL_SS_TIMESTAMPOFFSET parameter that has SQL_C_BINARY C type bound with type SQL_SS_VARIANT.</span></span>  
  
 <span data-ttu-id="e1c54-107">可以通过 SQLColAttribute 设置 SQL_SS_TIME2 和 SQL_SS_TIMESTAMPOFFSET 的新类型。</span><span class="sxs-lookup"><span data-stu-id="e1c54-107">The new types SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET can be set by SQLColAttribute.</span></span> <span data-ttu-id="e1c54-108">SQL_CA_SS_VARIANT_SQL_TYPE 可以通过 SQLGetDescField 返回。</span><span class="sxs-lookup"><span data-stu-id="e1c54-108">SQL_CA_SS_VARIANT_SQL_TYPE can be returned by SQLGetDescField.</span></span>  
  
 <span data-ttu-id="e1c54-109">对于结果列，驱动程序将从变体转换到日期/时间类型。</span><span class="sxs-lookup"><span data-stu-id="e1c54-109">For result columns, the driver will convert from the variant to date/time types.</span></span> <span data-ttu-id="e1c54-110">有关详细信息，请参阅[从 SQL 转换为 C](datetime-data-type-conversions-from-sql-to-c.md)。绑定到 SQL_C_BINARY 时，缓冲区长度必须足够大，以便接收对应于 SQL 类型的结构。</span><span class="sxs-lookup"><span data-stu-id="e1c54-110">For more information, see [Conversions from SQL to C](datetime-data-type-conversions-from-sql-to-c.md). When binding to SQL_C_BINARY, the buffer length must be large enough to receive the struct that corresponds to the SQL type.</span></span>  
  
 <span data-ttu-id="e1c54-111">对于 SQL_SS_TIME2 和 SQL_SS_TIMESTAMPOFFSET 参数，驱动程序会将 C 值转换为 `sql_variant` 值，下表对此进行了描述。</span><span class="sxs-lookup"><span data-stu-id="e1c54-111">For the SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET parameters, the driver will convert C values to `sql_variant` values, as described in the table below.</span></span> <span data-ttu-id="e1c54-112">如果参数被绑定为 SQL_C_BINARY 并且服务器类型是 SQL_SS_VARIANT，那么，除非应用程序已将 SQL_CA_SS_VARIANT_SQL_TYPE 设置为其他某个 SQL 类型，否则该参数将被视为二进制值。</span><span class="sxs-lookup"><span data-stu-id="e1c54-112">If a parameter is bound as SQL_C_BINARY and the server type is SQL_SS_VARIANT, it will be treated as a binary value unless the application has set SQL_CA_SS_VARIANT_SQL_TYPE to some other SQL type.</span></span> <span data-ttu-id="e1c54-113">这种情况下，SQL_CA_SS_VARIANT_SQL_TYPE 优先；就是说，如果设置 SQL_CA_SS_VARIANT_SQL_TYPE，它将覆盖从 C 类型推导出变体 SQL 类型的默认行为。</span><span class="sxs-lookup"><span data-stu-id="e1c54-113">In this case, SQL_CA_SS_VARIANT_SQL_TYPE takes precedence; that is, if SQL_CA_SS_VARIANT_SQL_TYPE is set, it overrides the default behavior of deducing the variant SQL type from the C type.</span></span>  
  
|<span data-ttu-id="e1c54-114">C 类型</span><span class="sxs-lookup"><span data-stu-id="e1c54-114">C type</span></span>|<span data-ttu-id="e1c54-115">服务器类型</span><span class="sxs-lookup"><span data-stu-id="e1c54-115">Server type</span></span>|<span data-ttu-id="e1c54-116">注释</span><span class="sxs-lookup"><span data-stu-id="e1c54-116">Comments</span></span>|  
|------------|-----------------|--------------|  
|<span data-ttu-id="e1c54-117">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="e1c54-117">SQL_C_CHAR</span></span>|<span data-ttu-id="e1c54-118">varchar</span><span class="sxs-lookup"><span data-stu-id="e1c54-118">varchar</span></span>|<span data-ttu-id="e1c54-119">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-119">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-120">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="e1c54-120">SQL_C_WCHAR</span></span>|<span data-ttu-id="e1c54-121">nvarcar</span><span class="sxs-lookup"><span data-stu-id="e1c54-121">nvarcar</span></span>|<span data-ttu-id="e1c54-122">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-122">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-123">SQL_C_TINYINT</span><span class="sxs-lookup"><span data-stu-id="e1c54-123">SQL_C_TINYINT</span></span>|<span data-ttu-id="e1c54-124">smallint</span><span class="sxs-lookup"><span data-stu-id="e1c54-124">smallint</span></span>|<span data-ttu-id="e1c54-125">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-125">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-126">SQL_C_STINYINT</span><span class="sxs-lookup"><span data-stu-id="e1c54-126">SQL_C_STINYINT</span></span>|<span data-ttu-id="e1c54-127">smallint</span><span class="sxs-lookup"><span data-stu-id="e1c54-127">smallint</span></span>|<span data-ttu-id="e1c54-128">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-128">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-129">SQL_C_SHORT</span><span class="sxs-lookup"><span data-stu-id="e1c54-129">SQL_C_SHORT</span></span>|<span data-ttu-id="e1c54-130">smallint</span><span class="sxs-lookup"><span data-stu-id="e1c54-130">smallint</span></span>|<span data-ttu-id="e1c54-131">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-131">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-132">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="e1c54-132">SQL_C_SSHORT</span></span>|<span data-ttu-id="e1c54-133">smallint</span><span class="sxs-lookup"><span data-stu-id="e1c54-133">smallint</span></span>|<span data-ttu-id="e1c54-134">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-134">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-135">SQL_C_USHORT</span><span class="sxs-lookup"><span data-stu-id="e1c54-135">SQL_C_USHORT</span></span>|<span data-ttu-id="e1c54-136">int</span><span class="sxs-lookup"><span data-stu-id="e1c54-136">int</span></span>|<span data-ttu-id="e1c54-137">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-137">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-138">SQL_C_LONG</span><span class="sxs-lookup"><span data-stu-id="e1c54-138">SQL_C_LONG</span></span>|<span data-ttu-id="e1c54-139">int</span><span class="sxs-lookup"><span data-stu-id="e1c54-139">int</span></span>|<span data-ttu-id="e1c54-140">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-140">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-141">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="e1c54-141">SQL_C_SLONG</span></span>|<span data-ttu-id="e1c54-142">int</span><span class="sxs-lookup"><span data-stu-id="e1c54-142">int</span></span>|<span data-ttu-id="e1c54-143">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-143">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-144">SQL_C_ULONG</span><span class="sxs-lookup"><span data-stu-id="e1c54-144">SQL_C_ULONG</span></span>|<span data-ttu-id="e1c54-145">bigint</span><span class="sxs-lookup"><span data-stu-id="e1c54-145">bigint</span></span>|<span data-ttu-id="e1c54-146">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-146">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-147">SQL_C_SBIGINT</span><span class="sxs-lookup"><span data-stu-id="e1c54-147">SQL_C_SBIGINT</span></span>|<span data-ttu-id="e1c54-148">bigint</span><span class="sxs-lookup"><span data-stu-id="e1c54-148">bigint</span></span>|<span data-ttu-id="e1c54-149">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-149">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-150">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="e1c54-150">SQL_C_FLOAT</span></span>|<span data-ttu-id="e1c54-151">real</span><span class="sxs-lookup"><span data-stu-id="e1c54-151">real</span></span>|<span data-ttu-id="e1c54-152">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-152">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-153">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="e1c54-153">SQL_C_DOUBLE</span></span>|<span data-ttu-id="e1c54-154">FLOAT</span><span class="sxs-lookup"><span data-stu-id="e1c54-154">float</span></span>|<span data-ttu-id="e1c54-155">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-155">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-156">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="e1c54-156">SQL_C_BIT</span></span>|<span data-ttu-id="e1c54-157">bit</span><span class="sxs-lookup"><span data-stu-id="e1c54-157">bit</span></span>|<span data-ttu-id="e1c54-158">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-158">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-159">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="e1c54-159">SQL_C_UTINYINT</span></span>|<span data-ttu-id="e1c54-160">tinyint</span><span class="sxs-lookup"><span data-stu-id="e1c54-160">tinyint</span></span>|<span data-ttu-id="e1c54-161">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-161">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-162">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e1c54-162">SQL_C_BINARY</span></span>|<span data-ttu-id="e1c54-163">varbinary</span><span class="sxs-lookup"><span data-stu-id="e1c54-163">varbinary</span></span>|<span data-ttu-id="e1c54-164">SQL_CA_SS_VARIANT_SQL_TYPE 未设置。</span><span class="sxs-lookup"><span data-stu-id="e1c54-164">SQL_CA_SS_VARIANT_SQL_TYPE is not set.</span></span>|  
|<span data-ttu-id="e1c54-165">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e1c54-165">SQL_C_BINARY</span></span>|<span data-ttu-id="e1c54-166">time</span><span class="sxs-lookup"><span data-stu-id="e1c54-166">time</span></span>|<span data-ttu-id="e1c54-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e1c54-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span></span><br /><br /> <span data-ttu-id="e1c54-168">"小数位数" 设置为 "SQL_DESC_PRECISION () 的*DecimalDigits*参数 `SQLBindParameter` 。</span><span class="sxs-lookup"><span data-stu-id="e1c54-168">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e1c54-169">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e1c54-169">SQL_C_BINARY</span></span>|<span data-ttu-id="e1c54-170">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="e1c54-170">datetimeoffset</span></span>|<span data-ttu-id="e1c54-171">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e1c54-171">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="e1c54-172">"小数位数" 设置为 "SQL_DESC_PRECISION () 的*DecimalDigits*参数 `SQLBindParameter` 。</span><span class="sxs-lookup"><span data-stu-id="e1c54-172">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e1c54-173">SQL_C_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="e1c54-173">SQL_C_TYPE_DATE</span></span>|<span data-ttu-id="e1c54-174">date</span><span class="sxs-lookup"><span data-stu-id="e1c54-174">date</span></span>|<span data-ttu-id="e1c54-175">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-175">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-176">SQL_C_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="e1c54-176">SQL_C_TYPE_TIME</span></span>|<span data-ttu-id="e1c54-177">time(0)</span><span class="sxs-lookup"><span data-stu-id="e1c54-177">time(0)</span></span>|<span data-ttu-id="e1c54-178">忽略 SQL_CA_SS_VARIANT_SQL_TYPE。</span><span class="sxs-lookup"><span data-stu-id="e1c54-178">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e1c54-179">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e1c54-179">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="e1c54-180">datetime2</span><span class="sxs-lookup"><span data-stu-id="e1c54-180">datetime2</span></span>|<span data-ttu-id="e1c54-181">"小数位数" 设置为 "SQL_DESC_PRECISION () 的*DecimalDigits*参数 `SQLBindParameter` 。</span><span class="sxs-lookup"><span data-stu-id="e1c54-181">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e1c54-182">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="e1c54-182">SQL_C_NUMERIC</span></span>|<span data-ttu-id="e1c54-183">Decimal</span><span class="sxs-lookup"><span data-stu-id="e1c54-183">decimal</span></span>|<span data-ttu-id="e1c54-184">精度设置为 SQL_DESC_PRECISION () 的*ColumnSize*参数 `SQLBindParameter` 。</span><span class="sxs-lookup"><span data-stu-id="e1c54-184">Precision is set to SQL_DESC_PRECISION (the *ColumnSize* parameter of `SQLBindParameter`).</span></span><br /><br /> <span data-ttu-id="e1c54-185">规模集设置为 SQL_DESC_SCALE (SQLBindParameter) 的*DecimalDigits*参数。</span><span class="sxs-lookup"><span data-stu-id="e1c54-185">Scale set to SQL_DESC_SCALE (the *DecimalDigits* parameter of SQLBindParameter).</span></span>|  
|<span data-ttu-id="e1c54-186">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e1c54-186">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="e1c54-187">time</span><span class="sxs-lookup"><span data-stu-id="e1c54-187">time</span></span>|<span data-ttu-id="e1c54-188">忽略 SQL_CA_SS_VARIANT_SQL_TYPE</span><span class="sxs-lookup"><span data-stu-id="e1c54-188">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
|<span data-ttu-id="e1c54-189">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e1c54-189">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="e1c54-190">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="e1c54-190">datetimeoffset</span></span>|<span data-ttu-id="e1c54-191">忽略 SQL_CA_SS_VARIANT_SQL_TYPE</span><span class="sxs-lookup"><span data-stu-id="e1c54-191">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e1c54-192">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e1c54-192">See Also</span></span>  
 [<span data-ttu-id="e1c54-193">ODBC&#41;&#40;的日期和时间改进</span><span class="sxs-lookup"><span data-stu-id="e1c54-193">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
