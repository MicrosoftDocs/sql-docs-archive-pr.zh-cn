---
title: " (OLE DB 和 ODBC) 的增强日期和时间类型的大容量复制更改 |Microsoft Docs"
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC, bulk copy operations
- bulk copy [ODBC], changes for date/time improvements
ms.assetid: c29e0f5e-9b3c-42b3-9856-755f4510832f
author: rothja
ms.author: jroth
ms.openlocfilehash: cbb9a03a5ef7a85be279d5b3a210fa24af61622f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586641"
---
# <a name="bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc"></a><span data-ttu-id="b379a-102">增强的日期和时间类型的大容量复制更改（OLE DB 和 ODBC）</span><span class="sxs-lookup"><span data-stu-id="b379a-102">Bulk Copy Changes for Enhanced Date and Time Types (OLE DB and ODBC)</span></span>
  <span data-ttu-id="b379a-103">本主题描述为支持大容量复制功能而增强的日期/时间功能。</span><span class="sxs-lookup"><span data-stu-id="b379a-103">This topic describes the date/time enhancements to support bulk copy functionality.</span></span> <span data-ttu-id="b379a-104">本主题中的信息对于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 中的 OLE DB 和 ODBC 均适用。</span><span class="sxs-lookup"><span data-stu-id="b379a-104">The information in this topic is valid for both OLE DB and ODBC in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
## <a name="format-files"></a><span data-ttu-id="b379a-105">格式化文件</span><span class="sxs-lookup"><span data-stu-id="b379a-105">Format Files</span></span>  
 <span data-ttu-id="b379a-106">在以交互方式生成格式化文件时，下表描述用于指定日期/时间类型和相应的宿主文件数据类型名称的输入。</span><span class="sxs-lookup"><span data-stu-id="b379a-106">When building format files interactively, the following table describes the input used to specify date/time types and the corresponding host-file data type names.</span></span>  
  
|<span data-ttu-id="b379a-107">文件存储类型</span><span class="sxs-lookup"><span data-stu-id="b379a-107">File storage type</span></span>|<span data-ttu-id="b379a-108">宿主文件数据类型</span><span class="sxs-lookup"><span data-stu-id="b379a-108">Host file data type</span></span>|<span data-ttu-id="b379a-109">响应提示： "输入字段 <的文件存储类型 field_name> [ \<default> ]："</span><span class="sxs-lookup"><span data-stu-id="b379a-109">Response to the prompt: "Enter the file storage type of field <field_name> [\<default>]:"</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="b379a-110">datetime</span><span class="sxs-lookup"><span data-stu-id="b379a-110">Datetime</span></span>|<span data-ttu-id="b379a-111">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="b379a-111">SQLDATETIME</span></span>|<span data-ttu-id="b379a-112">d</span><span class="sxs-lookup"><span data-stu-id="b379a-112">d</span></span>|  
|<span data-ttu-id="b379a-113">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="b379a-113">Smalldatetime</span></span>|<span data-ttu-id="b379a-114">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="b379a-114">SQLDATETIM4</span></span>|<span data-ttu-id="b379a-115">D</span><span class="sxs-lookup"><span data-stu-id="b379a-115">D</span></span>|  
|<span data-ttu-id="b379a-116">Date</span><span class="sxs-lookup"><span data-stu-id="b379a-116">Date</span></span>|<span data-ttu-id="b379a-117">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="b379a-117">SQLDATE</span></span>|<span data-ttu-id="b379a-118">de</span><span class="sxs-lookup"><span data-stu-id="b379a-118">de</span></span>|  
|<span data-ttu-id="b379a-119">时间</span><span class="sxs-lookup"><span data-stu-id="b379a-119">Time</span></span>|<span data-ttu-id="b379a-120">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="b379a-120">SQLTIME</span></span>|<span data-ttu-id="b379a-121">te</span><span class="sxs-lookup"><span data-stu-id="b379a-121">te</span></span>|  
|<span data-ttu-id="b379a-122">Datetime2</span><span class="sxs-lookup"><span data-stu-id="b379a-122">Datetime2</span></span>|<span data-ttu-id="b379a-123">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="b379a-123">SQLDATETIME2</span></span>|<span data-ttu-id="b379a-124">d2</span><span class="sxs-lookup"><span data-stu-id="b379a-124">d2</span></span>|  
|<span data-ttu-id="b379a-125">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b379a-125">Datetimeoffset</span></span>|<span data-ttu-id="b379a-126">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="b379a-126">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="b379a-127">do</span><span class="sxs-lookup"><span data-stu-id="b379a-127">do</span></span>|  
  
 <span data-ttu-id="b379a-128">XML 格式化文件 XSD 将增加以下内容：</span><span class="sxs-lookup"><span data-stu-id="b379a-128">The XML format file XSD will have the following additions:</span></span>  
  
```  
<xs:complexType name="SQLDATETIME2">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATETIMEOFFSET">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLDATE">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
<xs:complexType name="SQLTIME">  
    <xs:complexContent>  
        <xs:extension base="bl:Fixed"/>  
    </xs:complexContent>  
</xs:complexType>  
```  
  
## <a name="character-data-files"></a><span data-ttu-id="b379a-129">字符数据文件</span><span class="sxs-lookup"><span data-stu-id="b379a-129">Character Data Files</span></span>  
 <span data-ttu-id="b379a-130">在字符数据文件中，日期和时间值按数据类型的 "数据格式：字符串和文字" 一节中所述的方式表示，该部分针对 ODBC 的[Odbc 日期和时间改进](data-type-support-for-odbc-date-and-time-improvements.md)，或对 OLE DB 的[OLE DB 日期和时间改进的数据类型支持](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md)。</span><span class="sxs-lookup"><span data-stu-id="b379a-130">In character data files, date and time values are represented as described in the "Data Formats: Strings and Literals" section of [Data Type Support for ODBC Date and Time Improvements](data-type-support-for-odbc-date-and-time-improvements.md) for ODBC, or of [Data Type Support for OLE DB Date and Time Improvements](../native-client-ole-db-date-time/data-type-support-for-ole-db-date-and-time-improvements.md) for OLE DB.</span></span>  
  
 <span data-ttu-id="b379a-131">在本机数据解答中，四个新类型的日期和时间值表示为其 TDS 表示形式，其小数位数为 7 (，因为这是受支持的最大值 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，bcp 数据文件不存储这些列的小数位数) 。</span><span class="sxs-lookup"><span data-stu-id="b379a-131">In native data fles, date and time values for the four new types are represented as their TDS representations with a scale of 7 (because this is the maximum supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and bcp data files do not store the scale of these columns).</span></span> <span data-ttu-id="b379a-132">不会更改现有 `datetime` `smalldatetime` 类型或其表格格式数据流 (TDS) 表示形式的存储。</span><span class="sxs-lookup"><span data-stu-id="b379a-132">There is no change to the storage of the existing `datetime` and `smalldatetime` type or their tabular data stream (TDS) representations.</span></span>  
  
 <span data-ttu-id="b379a-133">针对 OLE DB 的不同存储类型的存储大小如下：</span><span class="sxs-lookup"><span data-stu-id="b379a-133">The storage sizes for the different storage types are as follows for OLE DB:</span></span>  
  
|<span data-ttu-id="b379a-134">文件存储类型</span><span class="sxs-lookup"><span data-stu-id="b379a-134">File storage type</span></span>|<span data-ttu-id="b379a-135">存储大小（以字节为单位）</span><span class="sxs-lookup"><span data-stu-id="b379a-135">Storage size in bytes</span></span>|  
|-----------------------|---------------------------|  
|<span data-ttu-id="b379a-136">datetime</span><span class="sxs-lookup"><span data-stu-id="b379a-136">datetime</span></span>|<span data-ttu-id="b379a-137">8</span><span class="sxs-lookup"><span data-stu-id="b379a-137">8</span></span>|  
|<span data-ttu-id="b379a-138">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="b379a-138">smalldatetime</span></span>|<span data-ttu-id="b379a-139">4</span><span class="sxs-lookup"><span data-stu-id="b379a-139">4</span></span>|  
|<span data-ttu-id="b379a-140">date</span><span class="sxs-lookup"><span data-stu-id="b379a-140">date</span></span>|<span data-ttu-id="b379a-141">3</span><span class="sxs-lookup"><span data-stu-id="b379a-141">3</span></span>|  
|<span data-ttu-id="b379a-142">time</span><span class="sxs-lookup"><span data-stu-id="b379a-142">time</span></span>|<span data-ttu-id="b379a-143">6</span><span class="sxs-lookup"><span data-stu-id="b379a-143">6</span></span>|  
|<span data-ttu-id="b379a-144">datetime2</span><span class="sxs-lookup"><span data-stu-id="b379a-144">datetime2</span></span>|<span data-ttu-id="b379a-145">9</span><span class="sxs-lookup"><span data-stu-id="b379a-145">9</span></span>|  
|<span data-ttu-id="b379a-146">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b379a-146">datetimeoffset</span></span>|<span data-ttu-id="b379a-147">11</span><span class="sxs-lookup"><span data-stu-id="b379a-147">11</span></span>|  
  
 <span data-ttu-id="b379a-148">针对 ODBC 的大小如下。</span><span class="sxs-lookup"><span data-stu-id="b379a-148">The sizes are as follows for ODBC.</span></span> <span data-ttu-id="b379a-149">请注意，不必在格式化文件或数据文件中存储精度，因为 BCP.exe 将始终从服务器检索精度。</span><span class="sxs-lookup"><span data-stu-id="b379a-149">Note that it is not necessary to store precision in either format or data files, because BCP.exe will always retrieve precision from the server.</span></span>  
  
|<span data-ttu-id="b379a-150">文件存储类型</span><span class="sxs-lookup"><span data-stu-id="b379a-150">File storage type</span></span>|<span data-ttu-id="b379a-151">存储大小（以字节为单位）</span><span class="sxs-lookup"><span data-stu-id="b379a-151">Storage size in bytes</span></span>|<span data-ttu-id="b379a-152">存储格式</span><span class="sxs-lookup"><span data-stu-id="b379a-152">Storage format</span></span>|  
|-----------------------|---------------------------|--------------------|  
|<span data-ttu-id="b379a-153">datetime (d)</span><span class="sxs-lookup"><span data-stu-id="b379a-153">datetime (d)</span></span>|<span data-ttu-id="b379a-154">8</span><span class="sxs-lookup"><span data-stu-id="b379a-154">8</span></span>|<span data-ttu-id="b379a-155">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-155">TDS</span></span>|  
|<span data-ttu-id="b379a-156">smalldatetime (D)</span><span class="sxs-lookup"><span data-stu-id="b379a-156">smalldatetime (D)</span></span>|<span data-ttu-id="b379a-157">4</span><span class="sxs-lookup"><span data-stu-id="b379a-157">4</span></span>|<span data-ttu-id="b379a-158">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-158">TDS</span></span>|  
|<span data-ttu-id="b379a-159">date (de)</span><span class="sxs-lookup"><span data-stu-id="b379a-159">date (de)</span></span>|<span data-ttu-id="b379a-160">3</span><span class="sxs-lookup"><span data-stu-id="b379a-160">3</span></span>|<span data-ttu-id="b379a-161">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-161">TDS</span></span>|  
|<span data-ttu-id="b379a-162">time (te)</span><span class="sxs-lookup"><span data-stu-id="b379a-162">time (te)</span></span>|<span data-ttu-id="b379a-163">6</span><span class="sxs-lookup"><span data-stu-id="b379a-163">6</span></span>|<span data-ttu-id="b379a-164">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-164">TDS</span></span>|  
|<span data-ttu-id="b379a-165">datetime2 (d2)</span><span class="sxs-lookup"><span data-stu-id="b379a-165">datetime2 (d2)</span></span>|<span data-ttu-id="b379a-166">9</span><span class="sxs-lookup"><span data-stu-id="b379a-166">9</span></span>|<span data-ttu-id="b379a-167">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-167">TDS</span></span>|  
|<span data-ttu-id="b379a-168">datetimeoffset (do)</span><span class="sxs-lookup"><span data-stu-id="b379a-168">datetimeoffset (do)</span></span>|<span data-ttu-id="b379a-169">11</span><span class="sxs-lookup"><span data-stu-id="b379a-169">11</span></span>|<span data-ttu-id="b379a-170">TDS</span><span class="sxs-lookup"><span data-stu-id="b379a-170">TDS</span></span>|  
  
## <a name="bcp-types-in-sqlnclih"></a><span data-ttu-id="b379a-171">sqlncli.h 中的 BCP 类型</span><span class="sxs-lookup"><span data-stu-id="b379a-171">BCP Types in sqlncli.h</span></span>  
 <span data-ttu-id="b379a-172">以下类型在 sqlncli.h 中定义，以便用于对 ODBC 的 BCP API 扩展。</span><span class="sxs-lookup"><span data-stu-id="b379a-172">The following types are defined in sqlncli.h to be used with the BCP API extensions to ODBC.</span></span> <span data-ttu-id="b379a-173">这些类型使用 OLE DB 中 IBCPSession::BCPColFmt 的 eUserDataType\*\* 参数进行传递。</span><span class="sxs-lookup"><span data-stu-id="b379a-173">These types are passed with the *eUserDataType* parameter of IBCPSession::BCPColFmt in OLE DB.</span></span>  
  
|<span data-ttu-id="b379a-174">文件存储类型</span><span class="sxs-lookup"><span data-stu-id="b379a-174">File storage type</span></span>|<span data-ttu-id="b379a-175">宿主文件数据类型</span><span class="sxs-lookup"><span data-stu-id="b379a-175">Host file data type</span></span>|<span data-ttu-id="b379a-176">键入 sqlncli.msi 以用于 IBCPSession：： BCPColFmt</span><span class="sxs-lookup"><span data-stu-id="b379a-176">Type in sqlncli.h for use with IBCPSession::BCPColFmt</span></span>|<span data-ttu-id="b379a-177">值</span><span class="sxs-lookup"><span data-stu-id="b379a-177">Value</span></span>|  
|-----------------------|-------------------------|-----------------------------------------------------------|-----------|  
|<span data-ttu-id="b379a-178">datetime</span><span class="sxs-lookup"><span data-stu-id="b379a-178">Datetime</span></span>|<span data-ttu-id="b379a-179">SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="b379a-179">SQLDATETIME</span></span>|<span data-ttu-id="b379a-180">BCP_TYPE_SQLDATETIME</span><span class="sxs-lookup"><span data-stu-id="b379a-180">BCP_TYPE_SQLDATETIME</span></span>|<span data-ttu-id="b379a-181">0x3d</span><span class="sxs-lookup"><span data-stu-id="b379a-181">0x3d</span></span>|  
|<span data-ttu-id="b379a-182">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="b379a-182">Smalldatetime</span></span>|<span data-ttu-id="b379a-183">SQLDATETIM4</span><span class="sxs-lookup"><span data-stu-id="b379a-183">SQLDATETIM4</span></span>|<span data-ttu-id="b379a-184">BCP_TYPE_SQLDATETIME4</span><span class="sxs-lookup"><span data-stu-id="b379a-184">BCP_TYPE_SQLDATETIME4</span></span>|<span data-ttu-id="b379a-185">0x3a</span><span class="sxs-lookup"><span data-stu-id="b379a-185">0x3a</span></span>|  
|<span data-ttu-id="b379a-186">Date</span><span class="sxs-lookup"><span data-stu-id="b379a-186">Date</span></span>|<span data-ttu-id="b379a-187">SQLDATE</span><span class="sxs-lookup"><span data-stu-id="b379a-187">SQLDATE</span></span>|<span data-ttu-id="b379a-188">BCP_TYPE_SQLDATE</span><span class="sxs-lookup"><span data-stu-id="b379a-188">BCP_TYPE_SQLDATE</span></span>|<span data-ttu-id="b379a-189">0x28</span><span class="sxs-lookup"><span data-stu-id="b379a-189">0x28</span></span>|  
|<span data-ttu-id="b379a-190">时间</span><span class="sxs-lookup"><span data-stu-id="b379a-190">Time</span></span>|<span data-ttu-id="b379a-191">SQLTIME</span><span class="sxs-lookup"><span data-stu-id="b379a-191">SQLTIME</span></span>|<span data-ttu-id="b379a-192">BCP_TYPE_SQLTIME</span><span class="sxs-lookup"><span data-stu-id="b379a-192">BCP_TYPE_SQLTIME</span></span>|<span data-ttu-id="b379a-193">0x29</span><span class="sxs-lookup"><span data-stu-id="b379a-193">0x29</span></span>|  
|<span data-ttu-id="b379a-194">Datetime2</span><span class="sxs-lookup"><span data-stu-id="b379a-194">Datetime2</span></span>|<span data-ttu-id="b379a-195">SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="b379a-195">SQLDATETIME2</span></span>|<span data-ttu-id="b379a-196">BCP_TYPE_SQLDATETIME2</span><span class="sxs-lookup"><span data-stu-id="b379a-196">BCP_TYPE_SQLDATETIME2</span></span>|<span data-ttu-id="b379a-197">0x2a</span><span class="sxs-lookup"><span data-stu-id="b379a-197">0x2a</span></span>|  
|<span data-ttu-id="b379a-198">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b379a-198">Datetimeoffset</span></span>|<span data-ttu-id="b379a-199">SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="b379a-199">SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="b379a-200">BCP_TYPE_SQLDATETIMEOFFSET</span><span class="sxs-lookup"><span data-stu-id="b379a-200">BCP_TYPE_SQLDATETIMEOFFSET</span></span>|<span data-ttu-id="b379a-201">0x2b</span><span class="sxs-lookup"><span data-stu-id="b379a-201">0x2b</span></span>|  
  
## <a name="bcp-data-type-conversions"></a><span data-ttu-id="b379a-202">BCP 数据类型转换</span><span class="sxs-lookup"><span data-stu-id="b379a-202">BCP Data Type Conversions</span></span>  
 <span data-ttu-id="b379a-203">下表提供转换信息。</span><span class="sxs-lookup"><span data-stu-id="b379a-203">The following tables provide conversion information.</span></span>  
  
 <span data-ttu-id="b379a-204">**OLE DB 说明** 以下转换由 IBCPSession 执行。</span><span class="sxs-lookup"><span data-stu-id="b379a-204">**OLE DB Note** The following conversions are performed by IBCPSession.</span></span> <span data-ttu-id="b379a-205">IRowsetFastLoad 使用[从客户端转换到服务器](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md)中定义的 OLE DB 转换。</span><span class="sxs-lookup"><span data-stu-id="b379a-205">IRowsetFastLoad uses OLE DB conversions as defined in [Conversions Performed from Client to Server](../native-client-ole-db-date-time/conversions-performed-from-client-to-server.md).</span></span> <span data-ttu-id="b379a-206">请注意，日期时间值将舍入为 1 秒的 1/300，smalldatetime 值在执行下述客户端转换后将秒设置为零。</span><span class="sxs-lookup"><span data-stu-id="b379a-206">Note that datetime values are rounded to 1/300th of a second and smalldatetime values have seconds set to zero after client conversions described below have been performed.</span></span> <span data-ttu-id="b379a-207">日期时间舍入将传播至小时和分钟，而非日期。</span><span class="sxs-lookup"><span data-stu-id="b379a-207">Datetime rounding propagates through hours and minutes, but not the date.</span></span>  
  
|<span data-ttu-id="b379a-208">转换后 -></span><span class="sxs-lookup"><span data-stu-id="b379a-208">To --></span></span><br /><br /> <span data-ttu-id="b379a-209">From</span><span class="sxs-lookup"><span data-stu-id="b379a-209">From</span></span>|<span data-ttu-id="b379a-210">date</span><span class="sxs-lookup"><span data-stu-id="b379a-210">date</span></span>|<span data-ttu-id="b379a-211">time</span><span class="sxs-lookup"><span data-stu-id="b379a-211">time</span></span>|<span data-ttu-id="b379a-212">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="b379a-212">smalldatetime</span></span>|<span data-ttu-id="b379a-213">datetime</span><span class="sxs-lookup"><span data-stu-id="b379a-213">datetime</span></span>|<span data-ttu-id="b379a-214">datetime2</span><span class="sxs-lookup"><span data-stu-id="b379a-214">datetime2</span></span>|<span data-ttu-id="b379a-215">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b379a-215">datetimeoffset</span></span>|<span data-ttu-id="b379a-216">char</span><span class="sxs-lookup"><span data-stu-id="b379a-216">char</span></span>|<span data-ttu-id="b379a-217">wchar</span><span class="sxs-lookup"><span data-stu-id="b379a-217">wchar</span></span>|  
|------------------------|----------|----------|-------------------|--------------|---------------|--------------------|----------|-----------|  
|<span data-ttu-id="b379a-218">Date</span><span class="sxs-lookup"><span data-stu-id="b379a-218">Date</span></span>|<span data-ttu-id="b379a-219">1</span><span class="sxs-lookup"><span data-stu-id="b379a-219">1</span></span>|-|<span data-ttu-id="b379a-220">1,6</span><span class="sxs-lookup"><span data-stu-id="b379a-220">1,6</span></span>|<span data-ttu-id="b379a-221">1,6</span><span class="sxs-lookup"><span data-stu-id="b379a-221">1,6</span></span>|<span data-ttu-id="b379a-222">1,6</span><span class="sxs-lookup"><span data-stu-id="b379a-222">1,6</span></span>|<span data-ttu-id="b379a-223">1,5,6</span><span class="sxs-lookup"><span data-stu-id="b379a-223">1,5,6</span></span>|<span data-ttu-id="b379a-224">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-224">1,3</span></span>|<span data-ttu-id="b379a-225">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-225">1,3</span></span>|  
|<span data-ttu-id="b379a-226">时间</span><span class="sxs-lookup"><span data-stu-id="b379a-226">Time</span></span>|<span data-ttu-id="b379a-227">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-227">N/A</span></span>|<span data-ttu-id="b379a-228">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-228">1,10</span></span>|<span data-ttu-id="b379a-229">1,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-229">1,7,10</span></span>|<span data-ttu-id="b379a-230">1,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-230">1,7,10</span></span>|<span data-ttu-id="b379a-231">1,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-231">1,7,10</span></span>|<span data-ttu-id="b379a-232">1,5,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-232">1,5,7,10</span></span>|<span data-ttu-id="b379a-233">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-233">1,3</span></span>|<span data-ttu-id="b379a-234">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-234">1,3</span></span>|  
|<span data-ttu-id="b379a-235">Smalldatetime</span><span class="sxs-lookup"><span data-stu-id="b379a-235">Smalldatetime</span></span>|<span data-ttu-id="b379a-236">1,2</span><span class="sxs-lookup"><span data-stu-id="b379a-236">1,2</span></span>|<span data-ttu-id="b379a-237">1,4,10</span><span class="sxs-lookup"><span data-stu-id="b379a-237">1,4,10</span></span>|<span data-ttu-id="b379a-238">1</span><span class="sxs-lookup"><span data-stu-id="b379a-238">1</span></span>|<span data-ttu-id="b379a-239">1</span><span class="sxs-lookup"><span data-stu-id="b379a-239">1</span></span>|<span data-ttu-id="b379a-240">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-240">1,10</span></span>|<span data-ttu-id="b379a-241">1,5,10</span><span class="sxs-lookup"><span data-stu-id="b379a-241">1,5,10</span></span>|<span data-ttu-id="b379a-242">1,11</span><span class="sxs-lookup"><span data-stu-id="b379a-242">1,11</span></span>|<span data-ttu-id="b379a-243">1,11</span><span class="sxs-lookup"><span data-stu-id="b379a-243">1,11</span></span>|  
|<span data-ttu-id="b379a-244">datetime</span><span class="sxs-lookup"><span data-stu-id="b379a-244">Datetime</span></span>|<span data-ttu-id="b379a-245">1,2</span><span class="sxs-lookup"><span data-stu-id="b379a-245">1,2</span></span>|<span data-ttu-id="b379a-246">1,4,10</span><span class="sxs-lookup"><span data-stu-id="b379a-246">1,4,10</span></span>|<span data-ttu-id="b379a-247">1,12</span><span class="sxs-lookup"><span data-stu-id="b379a-247">1,12</span></span>|<span data-ttu-id="b379a-248">1</span><span class="sxs-lookup"><span data-stu-id="b379a-248">1</span></span>|<span data-ttu-id="b379a-249">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-249">1,10</span></span>|<span data-ttu-id="b379a-250">1,5,10</span><span class="sxs-lookup"><span data-stu-id="b379a-250">1,5,10</span></span>|<span data-ttu-id="b379a-251">1,11</span><span class="sxs-lookup"><span data-stu-id="b379a-251">1,11</span></span>|<span data-ttu-id="b379a-252">1,11</span><span class="sxs-lookup"><span data-stu-id="b379a-252">1,11</span></span>|  
|<span data-ttu-id="b379a-253">Datetime2</span><span class="sxs-lookup"><span data-stu-id="b379a-253">Datetime2</span></span>|<span data-ttu-id="b379a-254">1,2</span><span class="sxs-lookup"><span data-stu-id="b379a-254">1,2</span></span>|<span data-ttu-id="b379a-255">1,4,10</span><span class="sxs-lookup"><span data-stu-id="b379a-255">1,4,10</span></span>|<span data-ttu-id="b379a-256">1,10 (ODBC)1,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-256">1,10 (ODBC)1,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-257">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-257">1,10</span></span>|<span data-ttu-id="b379a-258">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-258">1,10</span></span>|<span data-ttu-id="b379a-259">1,5,10</span><span class="sxs-lookup"><span data-stu-id="b379a-259">1,5,10</span></span>|<span data-ttu-id="b379a-260">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-260">1,3</span></span>|<span data-ttu-id="b379a-261">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-261">1,3</span></span>|  
|<span data-ttu-id="b379a-262">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="b379a-262">Datetimeoffset</span></span>|<span data-ttu-id="b379a-263">1,2,8</span><span class="sxs-lookup"><span data-stu-id="b379a-263">1,2,8</span></span>|<span data-ttu-id="b379a-264">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-264">1,4,8,10</span></span>|<span data-ttu-id="b379a-265">1,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-265">1,8,10</span></span>|<span data-ttu-id="b379a-266">1,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-266">1,8,10</span></span>|<span data-ttu-id="b379a-267">1,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-267">1,8,10</span></span>|<span data-ttu-id="b379a-268">1,10</span><span class="sxs-lookup"><span data-stu-id="b379a-268">1,10</span></span>|<span data-ttu-id="b379a-269">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-269">1,3</span></span>|<span data-ttu-id="b379a-270">1,3</span><span class="sxs-lookup"><span data-stu-id="b379a-270">1,3</span></span>|  
|<span data-ttu-id="b379a-271">Char/wchar (date)</span><span class="sxs-lookup"><span data-stu-id="b379a-271">Char/wchar (date)</span></span>|<span data-ttu-id="b379a-272">9</span><span class="sxs-lookup"><span data-stu-id="b379a-272">9</span></span>|-|<span data-ttu-id="b379a-273">9,6 (ODBC)9,6,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-273">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-274">9,6 (ODBC)9,6,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-274">9,6 (ODBC)9,6,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-275">9,6</span><span class="sxs-lookup"><span data-stu-id="b379a-275">9,6</span></span>|<span data-ttu-id="b379a-276">9,5,6</span><span class="sxs-lookup"><span data-stu-id="b379a-276">9,5,6</span></span>|<span data-ttu-id="b379a-277">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-277">N/A</span></span>|<span data-ttu-id="b379a-278">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-278">N/A</span></span>|  
|<span data-ttu-id="b379a-279">Char/wchar (time)</span><span class="sxs-lookup"><span data-stu-id="b379a-279">Char/wchar (time)</span></span>|-|<span data-ttu-id="b379a-280">9,10</span><span class="sxs-lookup"><span data-stu-id="b379a-280">9,10</span></span>|<span data-ttu-id="b379a-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-281">9,7,10 (ODBC)9,7,10,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-282">9,7,10 (ODBC)9,7,10, 12 (OLE DB)</span></span>|<span data-ttu-id="b379a-283">9,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-283">9,7,10</span></span>|<span data-ttu-id="b379a-284">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="b379a-284">9,5,7,10</span></span>|<span data-ttu-id="b379a-285">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-285">N/A</span></span>|<span data-ttu-id="b379a-286">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-286">N/A</span></span>|  
|<span data-ttu-id="b379a-287">Char/wchar (datetime)</span><span class="sxs-lookup"><span data-stu-id="b379a-287">Char/wchar (datetime)</span></span>|<span data-ttu-id="b379a-288">9,2</span><span class="sxs-lookup"><span data-stu-id="b379a-288">9,2</span></span>|<span data-ttu-id="b379a-289">9,4,10</span><span class="sxs-lookup"><span data-stu-id="b379a-289">9,4,10</span></span>|<span data-ttu-id="b379a-290">9,10 (ODBC)9,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-290">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-291">9,10 (ODBC)9,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-291">9,10 (ODBC)9,10,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-292">9,10</span><span class="sxs-lookup"><span data-stu-id="b379a-292">9,10</span></span>|<span data-ttu-id="b379a-293">9,5,10</span><span class="sxs-lookup"><span data-stu-id="b379a-293">9,5,10</span></span>|<span data-ttu-id="b379a-294">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-294">N/A</span></span>|<span data-ttu-id="b379a-295">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-295">N/A</span></span>|  
|<span data-ttu-id="b379a-296">Char/wchar (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="b379a-296">Char/wchar (datetimeoffset)</span></span>|<span data-ttu-id="b379a-297">9,2,8</span><span class="sxs-lookup"><span data-stu-id="b379a-297">9,2,8</span></span>|<span data-ttu-id="b379a-298">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-298">9,4,8,10</span></span>|<span data-ttu-id="b379a-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-299">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-300">9,8,10 (ODBC)9,8,10,12 (OLE DB)</span></span>|<span data-ttu-id="b379a-301">9,8,10</span><span class="sxs-lookup"><span data-stu-id="b379a-301">9,8,10</span></span>|<span data-ttu-id="b379a-302">9,10</span><span class="sxs-lookup"><span data-stu-id="b379a-302">9,10</span></span>|<span data-ttu-id="b379a-303">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-303">N/A</span></span>|<span data-ttu-id="b379a-304">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-304">N/A</span></span>|  
  
#### <a name="key-to-symbols"></a><span data-ttu-id="b379a-305">符号含义</span><span class="sxs-lookup"><span data-stu-id="b379a-305">Key to Symbols</span></span>  
  
|<span data-ttu-id="b379a-306">符号</span><span class="sxs-lookup"><span data-stu-id="b379a-306">Symbol</span></span>|<span data-ttu-id="b379a-307">含义</span><span class="sxs-lookup"><span data-stu-id="b379a-307">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="b379a-308">不支持任何转换。</span><span class="sxs-lookup"><span data-stu-id="b379a-308">No conversion is supported.</span></span><br /><br /> <span data-ttu-id="b379a-309">生成 ODBC 诊断记录，同时还生成 SQLSTATE 07006 和消息“受限制的数据类型属性冲突”。</span><span class="sxs-lookup"><span data-stu-id="b379a-309">An ODBC diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="b379a-310">1</span><span class="sxs-lookup"><span data-stu-id="b379a-310">1</span></span>|<span data-ttu-id="b379a-311">如果提供的数据无效，则生成 ODBC 诊断记录，同时还生成 SQLSTATE 22007 和消息“日期时间格式无效”。</span><span class="sxs-lookup"><span data-stu-id="b379a-311">If the data supplied is not valid, an ODBC  diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span> <span data-ttu-id="b379a-312">对于 datetimeoffset 值，在转换为 UTC 后时间部分必须处于规定范围内，即使不要求转换为 UTC。</span><span class="sxs-lookup"><span data-stu-id="b379a-312">For datetimeoffset values, the time portion must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="b379a-313">这是因为 TDS 和服务器始终规范化 UTC 的 datetimeoffset 值中的时间。</span><span class="sxs-lookup"><span data-stu-id="b379a-313">This is because TDS and the server always normalize the time in datetimeoffset values for UTC.</span></span> <span data-ttu-id="b379a-314">因此，在转换为 UTC 后，客户端必须检查时间部分是否处于支持的范围内。</span><span class="sxs-lookup"><span data-stu-id="b379a-314">So the client must check that time components are within the range supported after conversion to UTC.</span></span>|  
|<span data-ttu-id="b379a-315">2</span><span class="sxs-lookup"><span data-stu-id="b379a-315">2</span></span>|<span data-ttu-id="b379a-316">忽略时间部分。</span><span class="sxs-lookup"><span data-stu-id="b379a-316">The time component is ignored.</span></span>|  
|<span data-ttu-id="b379a-317">3</span><span class="sxs-lookup"><span data-stu-id="b379a-317">3</span></span>|<span data-ttu-id="b379a-318">对于 ODBC，如果发生截断且发生数据丢失，则会生成包含 SQLSTATE 22001 和消息 "字符串数据，右截断" 的诊断记录，该小数位数) 根据下表的目标列的大小确定 (小数位数。</span><span class="sxs-lookup"><span data-stu-id="b379a-318">For ODBC, If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and message 'String data, right truncated' The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="b379a-319">对于大于表中范围的列大小，则暗指小数位数为 7。</span><span class="sxs-lookup"><span data-stu-id="b379a-319">For column sizes larger than the range in the table, a scale of 7 is implied.</span></span> <span data-ttu-id="b379a-320">此转换应允许最高 9 位的秒的小数形式位数，这是 ODBC 允许的最大位数。</span><span class="sxs-lookup"><span data-stu-id="b379a-320">This conversion should allow for up to nine fractional second digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="b379a-321">**键入：** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="b379a-321">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="b379a-322">**暗指的小数位数 0** 8</span><span class="sxs-lookup"><span data-stu-id="b379a-322">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="b379a-323">**隐含比例 1. 7** 10，16</span><span class="sxs-lookup"><span data-stu-id="b379a-323">**Implied scale 1..7** 10,16</span></span><br /><br /> <br /><br /> <span data-ttu-id="b379a-324">**键入：** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="b379a-324">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="b379a-325">**暗指的小数位数 0：** 19</span><span class="sxs-lookup"><span data-stu-id="b379a-325">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="b379a-326">**隐含比例 1 .. 7：** 21 .. 27</span><span class="sxs-lookup"><span data-stu-id="b379a-326">**Implied scale 1..7:** 21..27</span></span><br /><br /> <br /><br /> <span data-ttu-id="b379a-327">**类型：** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="b379a-327">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="b379a-328">**暗指的小数位数 0：** 26</span><span class="sxs-lookup"><span data-stu-id="b379a-328">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="b379a-329">**默示比例为 1 .. 7：** 28 .. 34</span><span class="sxs-lookup"><span data-stu-id="b379a-329">**Implied scale 1..7:** 28..34</span></span><br /><br /> <span data-ttu-id="b379a-330">对于 OLE DB，如果发生具有数据丢失的截断，则会发出错误。</span><span class="sxs-lookup"><span data-stu-id="b379a-330">For OLE DB, if truncation with data loss occurs, an error is posted.</span></span> <span data-ttu-id="b379a-331">对于 datetime2，秒的小数部分位数（小数位数）是由目标列的大小确定（以下表为依据）。</span><span class="sxs-lookup"><span data-stu-id="b379a-331">For datetime2, the number of fractional seconds digits (the scale) is determined from the destination column's size according to the following table.</span></span> <span data-ttu-id="b379a-332">对于大于表中范围的列大小，则暗指小数位数为 9。</span><span class="sxs-lookup"><span data-stu-id="b379a-332">For column sizes larger than the range in the table a scale of 9 is implied.</span></span> <span data-ttu-id="b379a-333">此转换应允许最高 9 位的秒的小数部分位数，这是 OLE DB 允许的最大位数。</span><span class="sxs-lookup"><span data-stu-id="b379a-333">This conversion should allow for up to nine fractional second digits, the maximum allowed by OLE DB.</span></span><br /><br /> <span data-ttu-id="b379a-334">**键入：** DBTIME2</span><span class="sxs-lookup"><span data-stu-id="b379a-334">**Type:** DBTIME2</span></span><br /><br /> <span data-ttu-id="b379a-335">**暗指的小数位数 0** 8</span><span class="sxs-lookup"><span data-stu-id="b379a-335">**Implied scale 0** 8</span></span><br /><br /> <span data-ttu-id="b379a-336">**暗指的小数位数 1..9** 1..9</span><span class="sxs-lookup"><span data-stu-id="b379a-336">**Implied scale 1..9** 1..9</span></span><br /><br /> <br /><br /> <span data-ttu-id="b379a-337">**键入：** DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="b379a-337">**Type:** DBTIMESTAMP</span></span><br /><br /> <span data-ttu-id="b379a-338">**暗指的小数位数 0：** 19</span><span class="sxs-lookup"><span data-stu-id="b379a-338">**Implied scale 0:** 19</span></span><br /><br /> <span data-ttu-id="b379a-339">**暗指的小数位数 1..9：** 21..29</span><span class="sxs-lookup"><span data-stu-id="b379a-339">**Implied scale 1..9:** 21..29</span></span><br /><br /> <br /><br /> <span data-ttu-id="b379a-340">**类型：** DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="b379a-340">**Type:** DBTIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="b379a-341">**暗指的小数位数 0：** 26</span><span class="sxs-lookup"><span data-stu-id="b379a-341">**Implied scale 0:** 26</span></span><br /><br /> <span data-ttu-id="b379a-342">**暗指的小数位数 1..9：** 28..36</span><span class="sxs-lookup"><span data-stu-id="b379a-342">**Implied scale 1..9:** 28..36</span></span>|  
|<span data-ttu-id="b379a-343">4</span><span class="sxs-lookup"><span data-stu-id="b379a-343">4</span></span>|<span data-ttu-id="b379a-344">忽略日期部分。</span><span class="sxs-lookup"><span data-stu-id="b379a-344">The date component is ignored.</span></span>|  
|<span data-ttu-id="b379a-345">5</span><span class="sxs-lookup"><span data-stu-id="b379a-345">5</span></span>|<span data-ttu-id="b379a-346">时区设置为 UTC（例如 00:00）。</span><span class="sxs-lookup"><span data-stu-id="b379a-346">The timezone is set to UTC (for example, 00:00).</span></span>|  
|<span data-ttu-id="b379a-347">6</span><span class="sxs-lookup"><span data-stu-id="b379a-347">6</span></span>|<span data-ttu-id="b379a-348">时间设置为零。</span><span class="sxs-lookup"><span data-stu-id="b379a-348">The time is set to zero.</span></span>|  
|<span data-ttu-id="b379a-349">7</span><span class="sxs-lookup"><span data-stu-id="b379a-349">7</span></span>|<span data-ttu-id="b379a-350">日期设置为 1900-01-01。</span><span class="sxs-lookup"><span data-stu-id="b379a-350">The date is set to 1900-01-01.</span></span>|  
|<span data-ttu-id="b379a-351">8</span><span class="sxs-lookup"><span data-stu-id="b379a-351">8</span></span>|<span data-ttu-id="b379a-352">忽略时区偏移量。</span><span class="sxs-lookup"><span data-stu-id="b379a-352">The timezone offset is ignored.</span></span>|  
|<span data-ttu-id="b379a-353">9</span><span class="sxs-lookup"><span data-stu-id="b379a-353">9</span></span>|<span data-ttu-id="b379a-354">根据遇到的第一个标点符号以及出现的剩余部分，该字符串将被分析和转换为 date、datetime、datetimeoffset 或 time 值。</span><span class="sxs-lookup"><span data-stu-id="b379a-354">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and presence of remaining components.</span></span> <span data-ttu-id="b379a-355">然后，根据本主题末尾的表中针对此过程发现的源类型的规则，此字符串将转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="b379a-355">The string is then converted to the target type, following the rules in the table at the end of this topic for the source type discovered by this process.</span></span> <span data-ttu-id="b379a-356">如果提供的数据不能在分析时无错，或者任何组成部分超出允许的范围，或者不存在从文字类型到目标类型的转换，则发出错误 (OLE DB)，或者生成 ODBC 诊断记录，同时还生成 SQLSTATE 22018 和消息“为转换指定的字符值无效”。</span><span class="sxs-lookup"><span data-stu-id="b379a-356">If the data supplied cannot be parsed without error, or if any component part is outside the range allowed, or if there is no conversion from the literal type to target type, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="b379a-357">对于 datetime 和 smalldatetime 参数，如果年份处于这些类型支持的范围外，则发出错误 (OLE DB)，或者生成 ODBC 诊断记录，同时还生成 SQLSATE 22007 和消息“日期时间格式无效”。</span><span class="sxs-lookup"><span data-stu-id="b379a-357">For datetime and smalldatetime parameters, if the year is outside the range these types support, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="b379a-358">对于 datetimeoffset，在转换为 UTC 后该值必须处于规定范围内，即使不要求转换为 UTC。</span><span class="sxs-lookup"><span data-stu-id="b379a-358">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="b379a-359">这是因为 TDS 和服务器始终规范化 UTC 的 datetimeoffset 值中的时间，因此在转换为 UTC 后，客户端必须确认时间部分处于支持的范围内。</span><span class="sxs-lookup"><span data-stu-id="b379a-359">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="b379a-360">如果该值不在支持的 UTC 范围内，则发出错误 (OLE DB)，或者生成 ODBC 诊断记录，同时还生成 SQLSTATE 22007 和消息“日期时间格式无效”。</span><span class="sxs-lookup"><span data-stu-id="b379a-360">If the value is not within the supported UTC range, an error is posted (OLE DB), or an ODBC diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="b379a-361">10</span><span class="sxs-lookup"><span data-stu-id="b379a-361">10</span></span>|<span data-ttu-id="b379a-362">如果在客户端到服务器转换时发生具有数据丢失的截断，则发出错误 (OLE DB)，或者生成 ODBC 诊断记录，同时还生成 SQLSTATE 22008 和消息“日期时间字段溢出”。</span><span class="sxs-lookup"><span data-stu-id="b379a-362">If truncation with data loss occurs on a client to server conversion, an error is posted (OLE DB) or an ODBC diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="b379a-363">如果值处于服务器使用的 UTC 范围可表示的范围外，也会发生此错误。</span><span class="sxs-lookup"><span data-stu-id="b379a-363">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span> <span data-ttu-id="b379a-364">如果在服务器到客户端转换时发生秒或秒的小数部分截断，则只会显示警告。</span><span class="sxs-lookup"><span data-stu-id="b379a-364">If seconds or fractional seconds truncation occurs in a server to client conversion, there is only a warning.</span></span>|  
|<span data-ttu-id="b379a-365">11</span><span class="sxs-lookup"><span data-stu-id="b379a-365">11</span></span>|<span data-ttu-id="b379a-366">如果发生具有数据丢失的截断，则生成诊断记录。</span><span class="sxs-lookup"><span data-stu-id="b379a-366">If truncation with data loss occurs, a diagnostic record is generated.</span></span><br /><br /> <span data-ttu-id="b379a-367">在服务器到客户端转换时，这是警告 (ODBC SQLSTATE S1000)。</span><span class="sxs-lookup"><span data-stu-id="b379a-367">On a server-to-client conversion, this is a warning (ODBC SQLSTATE S1000).</span></span><br /><br /> <span data-ttu-id="b379a-368">在客户端到服务器转换时，这是错误 (ODBC SQLSTATE 22001)。</span><span class="sxs-lookup"><span data-stu-id="b379a-368">On a client-to-server conversion, this is an error (ODBC SQLSTATE 22001).</span></span>|  
|<span data-ttu-id="b379a-369">12</span><span class="sxs-lookup"><span data-stu-id="b379a-369">12</span></span>|<span data-ttu-id="b379a-370">秒设置为零，秒的小数部分被放弃。</span><span class="sxs-lookup"><span data-stu-id="b379a-370">Seconds are set to zero and fractional seconds are discarded.</span></span> <span data-ttu-id="b379a-371">可能没有截断错误。</span><span class="sxs-lookup"><span data-stu-id="b379a-371">No truncation error is possible.</span></span>|  
|<span data-ttu-id="b379a-372">空值</span><span class="sxs-lookup"><span data-stu-id="b379a-372">N/A</span></span>|<span data-ttu-id="b379a-373">现有 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和更早版本的行为将保持。</span><span class="sxs-lookup"><span data-stu-id="b379a-373">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b379a-374">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b379a-374">See Also</span></span>  
 <span data-ttu-id="b379a-375">[ODBC&#41;&#40;的日期和时间改进](date-and-time-improvements-odbc.md) </span><span class="sxs-lookup"><span data-stu-id="b379a-375">[Date and Time Improvements &#40;ODBC&#41;](date-and-time-improvements-odbc.md) </span></span>  
 [<span data-ttu-id="b379a-376">日期和时间改进 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b379a-376">Date and Time Improvements &#40;OLE DB&#41;</span></span>](../native-client-ole-db-date-time/date-and-time-improvements-ole-db.md)  
  
  
