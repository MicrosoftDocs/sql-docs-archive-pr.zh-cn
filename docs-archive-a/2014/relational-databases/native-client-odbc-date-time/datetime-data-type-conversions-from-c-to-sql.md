---
title: 从 C 到 SQL 的转换 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], C to SQL
ms.assetid: 7ac098db-9147-4883-8da9-a58ab24a0d31
author: rothja
ms.author: jroth
ms.openlocfilehash: 2ec8856b9c516ff3693da2ebf1077289d414e589
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589032"
---
# <a name="conversions-from-c-to-sql"></a><span data-ttu-id="fdb1f-102">由 C 转换为 SQL</span><span class="sxs-lookup"><span data-stu-id="fdb1f-102">Conversions from C to SQL</span></span>
  <span data-ttu-id="fdb1f-103">本主题列出了从 C 类型转换为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 日期/时间类型时要考虑的问题。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-103">This topic lists issues to consider when you convert from C types to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types.</span></span>  
  
 <span data-ttu-id="fdb1f-104">下表中介绍的转换适用于在客户端上所进行的转换。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-104">The conversions described in the following table apply to conversions made on the client.</span></span> <span data-ttu-id="fdb1f-105">如果客户端指定的参数的秒小数部分精度不同于服务器上定义的精度，客户端转换可能成功，但是当调用 `SQLExecute` 或 `SQLExecuteDirect` 时，服务器将返回错误。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-105">In cases where the client specifies fractional second precision for a parameter that differs from that defined on the server, the client conversion might succeed but the server will return an error when `SQLExecute` or `SQLExecuteDirect` is called.</span></span> <span data-ttu-id="fdb1f-106">特别是，ODBC 将对秒的小数部分的任何截断视为错误，而 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 则会进行舍入；例如，当从 `datetime2(6)` 转换到 `datetime2(2)` 时发生舍入。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-106">In particular, ODBC treats any truncation of fractional seconds as an error, whereas the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] behavior is to round; for example, rounding occurs when you go from `datetime2(6)` to `datetime2(2)`.</span></span> <span data-ttu-id="fdb1f-107">Datetime 列值舍入为 1/300 秒，服务器将 smalldatetime 列的秒数设置为零。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-107">Datetime column values are rounded to 1/300th of a second and smalldatetime columns have seconds set to zero by the server.</span></span>  
  
|||||||||  
|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="fdb1f-108">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="fdb1f-108">SQL_TYPE_DATE</span></span>|<span data-ttu-id="fdb1f-109">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="fdb1f-109">SQL_TYPE_TIME</span></span>|<span data-ttu-id="fdb1f-110">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="fdb1f-110">SQL_SS_TIME2</span></span>|<span data-ttu-id="fdb1f-111">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fdb1f-111">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="fdb1f-112">SQL_SS_TIMSTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="fdb1f-112">SQL_SS_TIMSTAMPOFFSET</span></span>|<span data-ttu-id="fdb1f-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="fdb1f-113">SQL_CHAR</span></span>|<span data-ttu-id="fdb1f-114">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="fdb1f-114">SQL_WCHAR</span></span>|  
|<span data-ttu-id="fdb1f-115">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="fdb1f-115">SQL_C_DATE</span></span>|<span data-ttu-id="fdb1f-116">1</span><span class="sxs-lookup"><span data-stu-id="fdb1f-116">1</span></span>|-|-|<span data-ttu-id="fdb1f-117">1,6</span><span class="sxs-lookup"><span data-stu-id="fdb1f-117">1,6</span></span>|<span data-ttu-id="fdb1f-118">1,5,6</span><span class="sxs-lookup"><span data-stu-id="fdb1f-118">1,5,6</span></span>|<span data-ttu-id="fdb1f-119">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-119">1,13</span></span>|<span data-ttu-id="fdb1f-120">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-120">1,13</span></span>|  
|<span data-ttu-id="fdb1f-121">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="fdb1f-121">SQL_C_TIME</span></span>|-|<span data-ttu-id="fdb1f-122">1</span><span class="sxs-lookup"><span data-stu-id="fdb1f-122">1</span></span>|<span data-ttu-id="fdb1f-123">1</span><span class="sxs-lookup"><span data-stu-id="fdb1f-123">1</span></span>|<span data-ttu-id="fdb1f-124">1,7</span><span class="sxs-lookup"><span data-stu-id="fdb1f-124">1,7</span></span>|<span data-ttu-id="fdb1f-125">1、5、7</span><span class="sxs-lookup"><span data-stu-id="fdb1f-125">1,5,7</span></span>|<span data-ttu-id="fdb1f-126">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-126">1,13</span></span>|<span data-ttu-id="fdb1f-127">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-127">1,13</span></span>|  
|<span data-ttu-id="fdb1f-128">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="fdb1f-128">SQL_C_SS_TIME2</span></span>|-|<span data-ttu-id="fdb1f-129">1,3</span><span class="sxs-lookup"><span data-stu-id="fdb1f-129">1,3</span></span>|<span data-ttu-id="fdb1f-130">1,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-130">1,10</span></span>|<span data-ttu-id="fdb1f-131">1,7</span><span class="sxs-lookup"><span data-stu-id="fdb1f-131">1,7</span></span>|<span data-ttu-id="fdb1f-132">1、5、7</span><span class="sxs-lookup"><span data-stu-id="fdb1f-132">1,5,7</span></span>|<span data-ttu-id="fdb1f-133">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-133">1,13</span></span>|<span data-ttu-id="fdb1f-134">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-134">1,13</span></span>|  
|<span data-ttu-id="fdb1f-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span></span>|<span data-ttu-id="fdb1f-136">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-136">N/A</span></span>|<span data-ttu-id="fdb1f-137">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-137">N/A</span></span>|<span data-ttu-id="fdb1f-138">1,10,11</span><span class="sxs-lookup"><span data-stu-id="fdb1f-138">1,10,11</span></span>|<span data-ttu-id="fdb1f-139">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-139">N/A</span></span>|<span data-ttu-id="fdb1f-140">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-140">N/A</span></span>|<span data-ttu-id="fdb1f-141">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-141">N/A</span></span>|<span data-ttu-id="fdb1f-142">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-142">N/A</span></span>|  
|<span data-ttu-id="fdb1f-143">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fdb1f-143">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="fdb1f-144">1,2</span><span class="sxs-lookup"><span data-stu-id="fdb1f-144">1,2</span></span>|<span data-ttu-id="fdb1f-145">1,3,4</span><span class="sxs-lookup"><span data-stu-id="fdb1f-145">1,3,4</span></span>|<span data-ttu-id="fdb1f-146">1,4,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-146">1,4,10</span></span>|<span data-ttu-id="fdb1f-147">1,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-147">1,10</span></span>|<span data-ttu-id="fdb1f-148">1,5,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-148">1,5,10</span></span>|<span data-ttu-id="fdb1f-149">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-149">1,13</span></span>|<span data-ttu-id="fdb1f-150">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-150">1,13</span></span>|  
|<span data-ttu-id="fdb1f-151">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="fdb1f-151">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="fdb1f-152">1,2,8</span><span class="sxs-lookup"><span data-stu-id="fdb1f-152">1,2,8</span></span>|<span data-ttu-id="fdb1f-153">1,3,4,8</span><span class="sxs-lookup"><span data-stu-id="fdb1f-153">1,3,4,8</span></span>|<span data-ttu-id="fdb1f-154">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-154">1,4,8,10</span></span>|<span data-ttu-id="fdb1f-155">1,8,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-155">1,8,10</span></span>|<span data-ttu-id="fdb1f-156">1,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-156">1,10</span></span>|<span data-ttu-id="fdb1f-157">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-157">1,13</span></span>|<span data-ttu-id="fdb1f-158">1,13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-158">1,13</span></span>|  
|<span data-ttu-id="fdb1f-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span></span>|<span data-ttu-id="fdb1f-160">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-160">N/A</span></span>|<span data-ttu-id="fdb1f-161">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-161">N/A</span></span>|<span data-ttu-id="fdb1f-162">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-162">N/A</span></span>|<span data-ttu-id="fdb1f-163">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-163">N/A</span></span>|<span data-ttu-id="fdb1f-164">1,10,11</span><span class="sxs-lookup"><span data-stu-id="fdb1f-164">1,10,11</span></span>|<span data-ttu-id="fdb1f-165">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-165">N/A</span></span>|<span data-ttu-id="fdb1f-166">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-166">N/A</span></span>|  
|<span data-ttu-id="fdb1f-167">SQL_C_CHAR/SQL_WCHAR (date)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-167">SQL_C_CHAR/SQL_WCHAR (date)</span></span>|<span data-ttu-id="fdb1f-168">9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-168">9</span></span>|<span data-ttu-id="fdb1f-169">9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-169">9</span></span>|<span data-ttu-id="fdb1f-170">9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-170">9</span></span>|<span data-ttu-id="fdb1f-171">9,6</span><span class="sxs-lookup"><span data-stu-id="fdb1f-171">9,6</span></span>|<span data-ttu-id="fdb1f-172">9,5,6</span><span class="sxs-lookup"><span data-stu-id="fdb1f-172">9,5,6</span></span>|<span data-ttu-id="fdb1f-173">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-173">N/A</span></span>|<span data-ttu-id="fdb1f-174">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-174">N/A</span></span>|  
|<span data-ttu-id="fdb1f-175">SQL_C_CHAR/SQL_WCHAR (time2)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-175">SQL_C_CHAR/SQL_WCHAR (time2)</span></span>|<span data-ttu-id="fdb1f-176">9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-176">9</span></span>|<span data-ttu-id="fdb1f-177">9，3</span><span class="sxs-lookup"><span data-stu-id="fdb1f-177">9,3</span></span>|<span data-ttu-id="fdb1f-178">9,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-178">9,10</span></span>|<span data-ttu-id="fdb1f-179">9,7,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-179">9,7,10</span></span>|<span data-ttu-id="fdb1f-180">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-180">9,5,7,10</span></span>|<span data-ttu-id="fdb1f-181">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-181">N/A</span></span>|<span data-ttu-id="fdb1f-182">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-182">N/A</span></span>|  
|<span data-ttu-id="fdb1f-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span></span>|<span data-ttu-id="fdb1f-184">9,2</span><span class="sxs-lookup"><span data-stu-id="fdb1f-184">9,2</span></span>|<span data-ttu-id="fdb1f-185">9，3，4</span><span class="sxs-lookup"><span data-stu-id="fdb1f-185">9,3,4</span></span>|<span data-ttu-id="fdb1f-186">9,4,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-186">9,4,10</span></span>|<span data-ttu-id="fdb1f-187">9,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-187">9,10</span></span>|<span data-ttu-id="fdb1f-188">9,5,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-188">9,5,10</span></span>|<span data-ttu-id="fdb1f-189">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-189">N/A</span></span>|<span data-ttu-id="fdb1f-190">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-190">N/A</span></span>|  
|<span data-ttu-id="fdb1f-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span></span>|<span data-ttu-id="fdb1f-192">9,2,8</span><span class="sxs-lookup"><span data-stu-id="fdb1f-192">9,2,8</span></span>|<span data-ttu-id="fdb1f-193">9、3、4、8</span><span class="sxs-lookup"><span data-stu-id="fdb1f-193">9,3,4,8</span></span>|<span data-ttu-id="fdb1f-194">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-194">9,4,8,10</span></span>|<span data-ttu-id="fdb1f-195">9,8,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-195">9,8,10</span></span>|<span data-ttu-id="fdb1f-196">9,10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-196">9,10</span></span>|<span data-ttu-id="fdb1f-197">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-197">N/A</span></span>|<span data-ttu-id="fdb1f-198">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-198">N/A</span></span>|  
|<span data-ttu-id="fdb1f-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span></span>|<span data-ttu-id="fdb1f-200">1,11</span><span class="sxs-lookup"><span data-stu-id="fdb1f-200">1,11</span></span>|<span data-ttu-id="fdb1f-201">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-201">N/A</span></span>|<span data-ttu-id="fdb1f-202">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-202">N/A</span></span>|<span data-ttu-id="fdb1f-203">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-203">N/A</span></span>|<span data-ttu-id="fdb1f-204">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-204">N/A</span></span>|<span data-ttu-id="fdb1f-205">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-205">N/A</span></span>|<span data-ttu-id="fdb1f-206">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-206">N/A</span></span>|  
|<span data-ttu-id="fdb1f-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span></span>|<span data-ttu-id="fdb1f-208">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-208">N/A</span></span>|<span data-ttu-id="fdb1f-209">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-209">N/A</span></span>|<span data-ttu-id="fdb1f-210">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-210">N/A</span></span>|<span data-ttu-id="fdb1f-211">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-211">N/A</span></span>|<span data-ttu-id="fdb1f-212">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-212">N/A</span></span>|<span data-ttu-id="fdb1f-213">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-213">N/A</span></span>|<span data-ttu-id="fdb1f-214">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-214">N/A</span></span>|  
|<span data-ttu-id="fdb1f-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="fdb1f-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span></span>|<span data-ttu-id="fdb1f-216">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-216">N/A</span></span>|<span data-ttu-id="fdb1f-217">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-217">N/A</span></span>|<span data-ttu-id="fdb1f-218">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-218">N/A</span></span>|<span data-ttu-id="fdb1f-219">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-219">N/A</span></span>|<span data-ttu-id="fdb1f-220">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-220">N/A</span></span>|<span data-ttu-id="fdb1f-221">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-221">N/A</span></span>|<span data-ttu-id="fdb1f-222">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-222">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="fdb1f-223">符号含义</span><span class="sxs-lookup"><span data-stu-id="fdb1f-223">Key to Symbols</span></span>  
  
|<span data-ttu-id="fdb1f-224">符号</span><span class="sxs-lookup"><span data-stu-id="fdb1f-224">Symbol</span></span>|<span data-ttu-id="fdb1f-225">含义</span><span class="sxs-lookup"><span data-stu-id="fdb1f-225">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="fdb1f-226">不支持任何转换。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-226">No conversion is supported.</span></span> <span data-ttu-id="fdb1f-227">生成具有 SQLSTATE 07006 和消息“受限制的数据类型属性冲突”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-227">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="fdb1f-228">1</span><span class="sxs-lookup"><span data-stu-id="fdb1f-228">1</span></span>|<span data-ttu-id="fdb1f-229">如果提供的数据无效，则生成具有 SQLSTATE 22007 和消息“日期时间格式无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-229">If the data supplied is not valid, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="fdb1f-230">2</span><span class="sxs-lookup"><span data-stu-id="fdb1f-230">2</span></span>|<span data-ttu-id="fdb1f-231">时间字段必须为零，否则，将生成具有 SQLSTATE 22008 和消息“小数部分截断”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-231">Time fields must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="fdb1f-232">3</span><span class="sxs-lookup"><span data-stu-id="fdb1f-232">3</span></span>|<span data-ttu-id="fdb1f-233">秒的小数部分必须为零，否则将生成具有 SQLSTATE 22008 和消息“小数部分截断”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-233">Fractional seconds must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="fdb1f-234">4</span><span class="sxs-lookup"><span data-stu-id="fdb1f-234">4</span></span>|<span data-ttu-id="fdb1f-235">忽略日期部分。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-235">The date component is ignored.</span></span>|  
|<span data-ttu-id="fdb1f-236">5</span><span class="sxs-lookup"><span data-stu-id="fdb1f-236">5</span></span>|<span data-ttu-id="fdb1f-237">根据客户端的时区设置设置时区。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-237">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="fdb1f-238">6</span><span class="sxs-lookup"><span data-stu-id="fdb1f-238">6</span></span>|<span data-ttu-id="fdb1f-239">时间设置为零。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-239">The time is set to zero.</span></span>|  
|<span data-ttu-id="fdb1f-240">7</span><span class="sxs-lookup"><span data-stu-id="fdb1f-240">7</span></span>|<span data-ttu-id="fdb1f-241">日期设置为当前日期。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-241">The date is set to the current date.</span></span>|  
|<span data-ttu-id="fdb1f-242">8</span><span class="sxs-lookup"><span data-stu-id="fdb1f-242">8</span></span>|<span data-ttu-id="fdb1f-243">将时间从客户端的时区转换为 UTC。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-243">The time is converted from the client's timezone to UTC.</span></span> <span data-ttu-id="fdb1f-244">如果在此转换过程中发生错误，则生成具有 SQLSTATE 22008 和消息“日期时间字段溢出”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-244">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="fdb1f-245">9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-245">9</span></span>|<span data-ttu-id="fdb1f-246">根据遇到的第一个标点符号以及存在的剩余部分分析该字符串，并将其转换为 date、datetime、datetimeoffset 或 time 值。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-246">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and the presence of remaining components.</span></span> <span data-ttu-id="fdb1f-247">然后，根据上表中针对此过程发现的源类型的规则，此字符串将转换为目标类型。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-247">The string is then converted to the target type, following the rules in the preceding table for the source type discovered by this process.</span></span> <span data-ttu-id="fdb1f-248">如果在分析数据时检测到错误，则生成具有 SQLSTATE 22018 和消息“为转换指定的字符值无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-248">If an error is detected while parsing the data, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="fdb1f-249">对于 datetime 和 smalldatetime 参数，如果年份超出这些类型支持的范围，则生成具有 SQLSTATE 22007 和消息“日期时间格式无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-249">For datetime and smalldatetime parameters, if the year is outside the range supported by these types, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="fdb1f-250">对于 datetimeoffset，在转换为 UTC 后该值必须处于规定范围内，即使不要求转换为 UTC。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-250">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="fdb1f-251">这是因为 TDS 和服务器始终规范化 UTC 的 datetimeoffset 值中的时间，因此在转换为 UTC 后，客户端必须确认时间部分处于支持的范围内。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-251">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="fdb1f-252">如果值不在支持的 UTC 范围内，则生成具有 SQLSTATE 22007 和消息“日期时间格式无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-252">If the value is not within the supported UTC range, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="fdb1f-253">10</span><span class="sxs-lookup"><span data-stu-id="fdb1f-253">10</span></span>|<span data-ttu-id="fdb1f-254">如果发生截断且丢失数据，将生成一条具有 SQLSTATE 22008 和消息“时间格式无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-254">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22008 and the message "Invalid time format".</span></span> <span data-ttu-id="fdb1f-255">如果值处于服务器使用的 UTC 范围可表示的范围外，也会发生此错误。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-255">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span>|  
|<span data-ttu-id="fdb1f-256">11</span><span class="sxs-lookup"><span data-stu-id="fdb1f-256">11</span></span>|<span data-ttu-id="fdb1f-257">如果数据的字节长度不等于 SQL 类型所需的结构的大小，则生成具有 SQLSTATE 22003 和消息“数值超出了范围”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-257">If the byte length of the data does not equal the size of the struct required by the SQL type, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="fdb1f-258">12</span><span class="sxs-lookup"><span data-stu-id="fdb1f-258">12</span></span>|<span data-ttu-id="fdb1f-259">如果数据的字节长度为 4 或 8，则采用原始 TDS smalldatetime 或 datetime 格式将数据发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-259">If the byte length of the data is 4 or 8, the data is sent to the server in raw TDS smalldatetime or datetime format.</span></span> <span data-ttu-id="fdb1f-260">如果数据的字节长度与 SQL_TIMESTAMP_STRUCT 大小完全匹配，则将该数据转换为 datetime2 的 TDS 格式。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-260">If the byte length of the data exactly matches the size of SQL_TIMESTAMP_STRUCT, the data is converted to the TDS format for datetime2.</span></span>|  
|<span data-ttu-id="fdb1f-261">13</span><span class="sxs-lookup"><span data-stu-id="fdb1f-261">13</span></span>|<span data-ttu-id="fdb1f-262">如果发生截断且丢失数据，则生成具有 SQLSTATE 22001 和消息“字符串数据，右端被截断”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-262">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and the message "String data, right truncated".</span></span><br /><br /> <span data-ttu-id="fdb1f-263">刻度)  (小数部分的小数位数取决于下列各项：</span><span class="sxs-lookup"><span data-stu-id="fdb1f-263">The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following:</span></span><br /><br /> <span data-ttu-id="fdb1f-264">**键入：** SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="fdb1f-264">**Type:** SQL_C_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="fdb1f-265">暗指的小数位数</span><span class="sxs-lookup"><span data-stu-id="fdb1f-265">Implied Scale</span></span><br /><br /> <span data-ttu-id="fdb1f-266">0</span><span class="sxs-lookup"><span data-stu-id="fdb1f-266">0</span></span><br /><br /> <span data-ttu-id="fdb1f-267">19</span><span class="sxs-lookup"><span data-stu-id="fdb1f-267">19</span></span><br /><br /> <span data-ttu-id="fdb1f-268">暗指的小数位数</span><span class="sxs-lookup"><span data-stu-id="fdb1f-268">Implied Scale</span></span><br /><br /> <span data-ttu-id="fdb1f-269">1. 9</span><span class="sxs-lookup"><span data-stu-id="fdb1f-269">1..9</span></span><br /><br /> <span data-ttu-id="fdb1f-270">21..29</span><span class="sxs-lookup"><span data-stu-id="fdb1f-270">21..29</span></span><br /><br /> <span data-ttu-id="fdb1f-271">但是，对于 SQL_C_TYPE_TIMESTAMP，如果秒的小数部分可以在不丢失数据的情况下由三位数表示，并且列大小为 23 或更大，则生成确切的三位数的秒小数部分。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-271">However, for SQL_C_TYPE_TIMESTAMP, if the fractional seconds can be represented with three digits without data loss and the column size is 23 or larger, then exactly three fractional seconds' digits are generated.</span></span> <span data-ttu-id="fdb1f-272">此行为确保使用早期 ODBC 驱动程序开发的应用程序的向后兼容性。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-272">This behavior ensures backwards compatibility for applications developed using older ODBC drivers.</span></span><br /><br /> <span data-ttu-id="fdb1f-273">对于大于表中范围的列大小，则暗指小数位数为 9。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-273">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="fdb1f-274">此转换应允许的秒的小数部分位数多达 9 位，这是 ODBC 允许的最大位数。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-274">This conversion should allow for up to nine fractional seconds digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="fdb1f-275">列大小为零则暗指 ODBC 中可变长度字符类型的大小无限制（即 9 位，除非应用 SQL_C_TYPE_TIMESTAMP 的三位数规则）。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-275">A column size of zero implies unlimited size for variable length character types in ODBC (9 digits, unless the 3-digit rule for SQL_C_TYPE_TIMESTAMP applies).</span></span> <span data-ttu-id="fdb1f-276">指定列大小为零且具有固定长度的字符类型是错误的。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-276">Specifying a column size of zero with a fixed length character type is an error.</span></span>|  
|<span data-ttu-id="fdb1f-277">空值</span><span class="sxs-lookup"><span data-stu-id="fdb1f-277">N/A</span></span>|<span data-ttu-id="fdb1f-278">现有 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和更早版本的行为将保持。</span><span class="sxs-lookup"><span data-stu-id="fdb1f-278">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="fdb1f-279">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fdb1f-279">See Also</span></span>  
 [<span data-ttu-id="fdb1f-280">ODBC&#41;&#40;的日期和时间改进</span><span class="sxs-lookup"><span data-stu-id="fdb1f-280">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
