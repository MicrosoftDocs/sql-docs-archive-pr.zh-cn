---
title: 数据类型用法 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC data types
- ODBC data types, about ODBC data types
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- data types [ODBC]
- SQL Server Native Client ODBC driver, data types
- data types [ODBC], about data types
ms.assetid: 4f19b0d6-94ac-4a98-a121-57d38787864c
author: rothja
ms.author: jroth
ms.openlocfilehash: 8333f45fd9e3b742b3765efaee5ae7a865161bc2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693293"
---
# <a name="data-type-usage"></a><span data-ttu-id="bcb18-102">数据类型用法</span><span class="sxs-lookup"><span data-stu-id="bcb18-102">Data Type Usage</span></span>
  <span data-ttu-id="bcb18-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序并 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 强制使用以下数据类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] impose the following use of data types.</span></span>  
  
|<span data-ttu-id="bcb18-104">数据类型</span><span class="sxs-lookup"><span data-stu-id="bcb18-104">Data type</span></span>|<span data-ttu-id="bcb18-105">限制</span><span class="sxs-lookup"><span data-stu-id="bcb18-105">Limitation</span></span>|  
|---------------|----------------|  
|<span data-ttu-id="bcb18-106">日期文字</span><span class="sxs-lookup"><span data-stu-id="bcb18-106">Date literals</span></span>|<span data-ttu-id="bcb18-107">日期文字在 SQL_TYPE_TIMESTAMP 列中存储 ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime**或**smalldatetime**) 数据类型时，时间值为12：00： 00.000 am。</span><span class="sxs-lookup"><span data-stu-id="bcb18-107">Date literals, when stored in a SQL_TYPE_TIMESTAMP column ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types of **datetime** or **smalldatetime**), have a time value of 12:00:00.000 A.M.</span></span>|  
|<span data-ttu-id="bcb18-108">**money**和**smallmoney**</span><span class="sxs-lookup"><span data-stu-id="bcb18-108">**money** and **smallmoney**</span></span>|<span data-ttu-id="bcb18-109">只有**money**和**smallmoney**数据类型的整数部分才有意义。</span><span class="sxs-lookup"><span data-stu-id="bcb18-109">Only the integer parts of the **money** and **smallmoney** data types are significant.</span></span> <span data-ttu-id="bcb18-110">如果 SQL **money**数据的小数部分在数据类型转换期间被截断，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序将返回一个警告，而不是错误。</span><span class="sxs-lookup"><span data-stu-id="bcb18-110">If the decimal part of SQL **money** data is truncated during data type conversion, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver returns a warning, not an error.</span></span>|  
|<span data-ttu-id="bcb18-111">SQL_BINARY（可以为 Null）</span><span class="sxs-lookup"><span data-stu-id="bcb18-111">SQL_BINARY (nullable)</span></span>|<span data-ttu-id="bcb18-112">连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 版和更早版本的实例时，如果 SQL_BINARY 列可以为 Null，则在数据源中存储的数据不使用零进行填充。</span><span class="sxs-lookup"><span data-stu-id="bcb18-112">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 6.0 and earlier, if a SQL_BINARY column is nullable, the data that is stored in the data source is not padded with zeroes.</span></span> <span data-ttu-id="bcb18-113">检索此类列中的数据时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驱动程序会在右侧使用零填充该驱动程序。</span><span class="sxs-lookup"><span data-stu-id="bcb18-113">When data from such a column is retrieved, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver pads it with zeroes on the right.</span></span> <span data-ttu-id="bcb18-114">但是，在由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 执行的操作（比如串联）中所创建的数据则没有这样的填充。</span><span class="sxs-lookup"><span data-stu-id="bcb18-114">However, data that is created in operations performed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], such as concatenation, does not have such padding.</span></span><br /><br /> <span data-ttu-id="bcb18-115">而且，在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 或更早版本的实例中将数据放在这样的列中时，如果数据太长而无法放入列中，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 将截断右侧数据。</span><span class="sxs-lookup"><span data-stu-id="bcb18-115">Also, when data is placed in such a column in an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 or earlier, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] truncates the data on the right if it is too long to fit into the column.</span></span> <span data-ttu-id="bcb18-116">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序支持连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-116">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="bcb18-117">SQL_CHAR（截断）</span><span class="sxs-lookup"><span data-stu-id="bcb18-117">SQL_CHAR (truncation)</span></span>|<span data-ttu-id="bcb18-118">在连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 和更早版本的实例并将数据放入 SQL_CHAR 列中时，如果数据太长而无法放入该列中，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 将在没有警告的情况下从右侧截断它。</span><span class="sxs-lookup"><span data-stu-id="bcb18-118">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 and earlier, and data is placed into a SQL_CHAR column, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] truncates it on the right without warning if the data is too long to fit into the column.</span></span> <span data-ttu-id="bcb18-119">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序支持连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-119">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="bcb18-120">SQL_CHAR（可以为 Null）</span><span class="sxs-lookup"><span data-stu-id="bcb18-120">SQL_CHAR (nullable)</span></span>|<span data-ttu-id="bcb18-121">连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 和更早版本的实例时，如果 SQL_CHAR 列可以为 Null，则不以空白填充数据源中存储的数据。</span><span class="sxs-lookup"><span data-stu-id="bcb18-121">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.0 and earlier, if a SQL_CHAR column is nullable, the data that is stored in the data source is not padded with blanks.</span></span> <span data-ttu-id="bcb18-122">检索此类列中的数据时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驱动程序会在右侧使用空白来填充它。</span><span class="sxs-lookup"><span data-stu-id="bcb18-122">When data from such a column is retrieved, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver pads it with blanks on the right.</span></span> <span data-ttu-id="bcb18-123">但是，在由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 执行的操作（比如串联）中所创建的数据则没有这样的填充。</span><span class="sxs-lookup"><span data-stu-id="bcb18-123">However, data that is created in operations performed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], such as concatenation, does not have such padding.</span></span> <span data-ttu-id="bcb18-124">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序支持连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-124">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="bcb18-125">SQL_LONGVARBINARY、SQL_LONGVARCHAR、SQL_WLONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="bcb18-125">SQL_LONGVARBINARY, SQL_LONGVARCHAR, SQL_WLONGVARCHAR</span></span>|<span data-ttu-id="bcb18-126">当连接到实例6时，完全支持对 SQL_LONGVARBINARY、SQL_LONGVARCHAR 或 SQL_WLONGVARCHAR 数据类型 (使用 WHERE 子句) 的列的更新 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。*x*及更高版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-126">Updates of columns with SQL_LONGVARBINARY, SQL_LONGVARCHAR, or SQL_WLONGVARCHAR data types (using a WHERE clause) that affect multiple rows are fully supported when connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.*x* and later.</span></span> <span data-ttu-id="bcb18-127">当连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的实例时，S1000 错误 "部分插入/更新"。</span><span class="sxs-lookup"><span data-stu-id="bcb18-127">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, an S1000 error, "Partial insert/update.</span></span> <span data-ttu-id="bcb18-128">文本或图像列的插入/更新失败”。</span><span class="sxs-lookup"><span data-stu-id="bcb18-128">The insert/update of a text or image column(s) did not succeed" is returned if the update affects more than one row.</span></span> <span data-ttu-id="bcb18-129">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序支持连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-129">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="bcb18-130">字符串函数参数</span><span class="sxs-lookup"><span data-stu-id="bcb18-130">String function parameters</span></span>|<span data-ttu-id="bcb18-131">字符串函数*string_exp*参数的数据类型必须为 SQL_CHAR 或 SQL_VARCHAR。</span><span class="sxs-lookup"><span data-stu-id="bcb18-131">*string_exp* parameters to the string functions must be of data type SQL_CHAR or SQL_VARCHAR.</span></span> <span data-ttu-id="bcb18-132">在字符串函数中不支持 SQL_LONG_VARCHAR 数据类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-132">SQL_LONG_VARCHAR data types are not supported in the string functions.</span></span> <span data-ttu-id="bcb18-133">*Count*参数必须小于或等于8000，因为 SQL_CHAR 和 SQL_VARCHAR 数据类型的最大长度限制为8000个字符。</span><span class="sxs-lookup"><span data-stu-id="bcb18-133">The *count* parameter must be less than or equal to 8,000 because the SQL_CHAR and SQL_VARCHAR data types are limited to a maximum length of 8,000 characters.</span></span>|  
|<span data-ttu-id="bcb18-134">时间文字</span><span class="sxs-lookup"><span data-stu-id="bcb18-134">Time literals</span></span>|<span data-ttu-id="bcb18-135">当时间文本存储在 SQL_TIMESTAMP 列中时 ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据类型为**datetime**或**smalldatetime**) ，其日期值为1900年1月1日。</span><span class="sxs-lookup"><span data-stu-id="bcb18-135">Time literals, when stored in a SQL_TIMESTAMP column ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types of **datetime** or **smalldatetime**), have a date value of January 1, 1900.</span></span>|  
|<span data-ttu-id="bcb18-136">**timestamp**</span><span class="sxs-lookup"><span data-stu-id="bcb18-136">**timestamp**</span></span>|<span data-ttu-id="bcb18-137">只有空值才能手动插入到**timestamp**列。</span><span class="sxs-lookup"><span data-stu-id="bcb18-137">Only a NULL value can be manually inserted into a **timestamp** column.</span></span> <span data-ttu-id="bcb18-138">但是，因为**timestamp**列由自动更新，所以将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 覆盖 NULL 值。</span><span class="sxs-lookup"><span data-stu-id="bcb18-138">However, because **timestamp**columns are automatically updated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], a NULL value is overwritten.</span></span>|  
|<span data-ttu-id="bcb18-139">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="bcb18-139">**tinyint**</span></span>|<span data-ttu-id="bcb18-140">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **Tinyint**数据类型无符号。</span><span class="sxs-lookup"><span data-stu-id="bcb18-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **tinyint** data type is unsigned.</span></span> <span data-ttu-id="bcb18-141">默认情况下， **tinyint**列绑定到数据类型为的变量 SQL_C_UTINYINT。</span><span class="sxs-lookup"><span data-stu-id="bcb18-141">A **tinyint** column is bound to a variable of data type SQL_C_UTINYINT by default.</span></span>|  
|<span data-ttu-id="bcb18-142">别名数据类型</span><span class="sxs-lookup"><span data-stu-id="bcb18-142">Alias data types</span></span>|<span data-ttu-id="bcb18-143">当连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的实例时，ODBC 驱动程序将 NULL 添加到未显式声明列的为 null 性的列定义。</span><span class="sxs-lookup"><span data-stu-id="bcb18-143">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, the ODBC driver adds NULL to a column definition that does not explicitly declare a column's nullability.</span></span> <span data-ttu-id="bcb18-144">因此，将忽略在别名数据类型的定义中存储的为 Null 性。</span><span class="sxs-lookup"><span data-stu-id="bcb18-144">Therefore, the nullability that is stored in the definition of an alias data type is ignored.</span></span><br /><br /> <span data-ttu-id="bcb18-145">当连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*的实例时，如果别名数据类型的列的基本数据类型为**char**或**binary** ，并且没有声明为 null 性的列，则将创建为数据类型**varchar**或**varbinary**。</span><span class="sxs-lookup"><span data-stu-id="bcb18-145">When connected to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 4.2*x*, columns with an alias data type that has a base data type of **char** or **binary** and for which no nullability is declared are created as data type **varchar** or **varbinary**.</span></span> <span data-ttu-id="bcb18-146">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md)、 [SQLColumns](../native-client-odbc-api/sqlcolumns.md)和[SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md)返回 SQL_VARCHAR 或 SQL_VARBINARY 作为这些列的数据类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-146">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md), [SQLColumns](../native-client-odbc-api/sqlcolumns.md), and [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) return SQL_VARCHAR or SQL_VARBINARY as the data type for these columns.</span></span> <span data-ttu-id="bcb18-147">不对从这些列检索的数据进行填充。</span><span class="sxs-lookup"><span data-stu-id="bcb18-147">Data that is retrieved from these columns is not padded.</span></span> <span data-ttu-id="bcb18-148">**注意：** [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序支持连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-148">**Note:**  The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does support connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 6.5 and earlier.</span></span>|  
|<span data-ttu-id="bcb18-149">LONG 数据类型</span><span class="sxs-lookup"><span data-stu-id="bcb18-149">LONG data types</span></span>|<span data-ttu-id="bcb18-150">*执行时数据*参数会限制 SQL_LONGVARBINARY 和 SQL_LONGVARCHAR 数据类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-150">*data-at-execution* parameters are restricted for both the SQL_LONGVARBINARY and the SQL_LONGVARCHAR data types.</span></span>|  
|<span data-ttu-id="bcb18-151">大值类型</span><span class="sxs-lookup"><span data-stu-id="bcb18-151">Large value types</span></span>|<span data-ttu-id="bcb18-152">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序将在接受或返回 ODBC SQL 数据类型的 api 中分别\*\* (\*\* 最大 (类型) 、 **varbinary (max) **和**nvarchar) 最大 SQL_VARCHAR**类型 SQL_VARBINARY SQL_WVARCHAR () 类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-152">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver will expose **varchar(max)**, **varbinary(max)**, and **nvarchar(max)** types as SQL_VARCHAR, SQL_VARBINARY and SQL_WVARCHAR (respectively) in APIs that accept or return ODBC SQL data types.</span></span>|  
|<span data-ttu-id="bcb18-153"> (UDT 的用户定义类型) </span><span class="sxs-lookup"><span data-stu-id="bcb18-153">User-defined type (UDT)</span></span>|<span data-ttu-id="bcb18-154">UDT 列被映射为 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="bcb18-154">UDT columns are mapped as SQL_SS_UDT.</span></span> <span data-ttu-id="bcb18-155">如果使用 UDT 的 ToString() 或 ToXMLString() 方法或者通过 CAST/CONVERT 函数，在 SQL 语句中将 UDT 列显式映射到另一种类型，则在结果集中该列的类型将反映该列被转换成的实际类型。</span><span class="sxs-lookup"><span data-stu-id="bcb18-155">If a UDT column is mapped explicitly to another type in the SQL statement using the ToString() or ToXMLString() methods of the UDT, or via the CAST/CONVERT functions, the type of the column in the result set will reflect the actual type to which the column was converted.</span></span><br /><br /> <span data-ttu-id="bcb18-156">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序只能作为二进制文件绑定到 UDT 列。</span><span class="sxs-lookup"><span data-stu-id="bcb18-156">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver can only bind to a UDT column as binary.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="bcb18-157">仅支持在 SQL_SS_UDT 和 SQL_C_BINARY 数据类型之间的转换。</span><span class="sxs-lookup"><span data-stu-id="bcb18-157">only supports conversion between the SQL_SS_UDT and SQL_C_BINARY data types.</span></span>|  
|<span data-ttu-id="bcb18-158">XML</span><span class="sxs-lookup"><span data-stu-id="bcb18-158">XML</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="bcb18-159">会自动将 XML 转换为 Unicode 文本。</span><span class="sxs-lookup"><span data-stu-id="bcb18-159">will automatically convert XML to Unicode text.</span></span> <span data-ttu-id="bcb18-160">XML 类型将映射为 SQL_SS_XML。</span><span class="sxs-lookup"><span data-stu-id="bcb18-160">The XML type is mapped as SQL_SS_XML.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="bcb18-161">另请参阅</span><span class="sxs-lookup"><span data-stu-id="bcb18-161">See Also</span></span>  
 [<span data-ttu-id="bcb18-162">&#40;ODBC&#41;处理结果</span><span class="sxs-lookup"><span data-stu-id="bcb18-162">Processing Results &#40;ODBC&#41;</span></span>](processing-results-odbc.md)  
  
  
