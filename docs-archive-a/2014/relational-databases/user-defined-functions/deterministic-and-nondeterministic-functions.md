---
title: 确定性函数和不确定性函数 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- built-in functions [SQL Server]
- nondeterministic functions
- extended stored procedures [SQL Server], functions that call
- deterministic functions
- user-defined functions [SQL Server], deterministic
ms.assetid: 2f3ce5f5-c81c-4470-8141-8144d4f218dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 9e755532e06d64e273408c7e81936a1c2d370697
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693228"
---
# <a name="deterministic-and-nondeterministic-functions"></a><span data-ttu-id="75272-102">确定性函数和不确定性函数</span><span class="sxs-lookup"><span data-stu-id="75272-102">Deterministic and Nondeterministic Functions</span></span>
  <span data-ttu-id="75272-103">只要使用特定的输入值集并且数据库具有相同的状态，那么不管何时调用，确定性函数始终都会返回相同的结果。</span><span class="sxs-lookup"><span data-stu-id="75272-103">Deterministic functions always return the same result any time they are called with a specific set of input values and given the same state of the database.</span></span> <span data-ttu-id="75272-104">即使访问的数据库的状态不变，每次使用特定的输入值集调用非确定性函数都可能会返回不同的结果。</span><span class="sxs-lookup"><span data-stu-id="75272-104">Nondeterministic functions may return different results each time they are called with a specific set of input values even if the database state that they access remains the same.</span></span> <span data-ttu-id="75272-105">例如，函数 AVG 对上述给定的限定条件始终返回相同的值，但返回当前 datetime 值的 GETDATE 函数始终会返回不同的结果。</span><span class="sxs-lookup"><span data-stu-id="75272-105">For example, the function AVG always returns the same result given the qualifications stated above, but the GETDATE function, which returns the current datetime value, always returns a different result.</span></span>  
  
 <span data-ttu-id="75272-106">有多个用户定义函数的属性通过对调用函数的计算列进行索引或通过引用函数的索引视图确定 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 为函数的结果建立索引的功能。</span><span class="sxs-lookup"><span data-stu-id="75272-106">There are several properties of user-defined functions that determine the ability of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to index the results of the function, either through indexes on computed columns that call the function, or through indexed views that reference the function.</span></span> <span data-ttu-id="75272-107">函数的确定性是一个属性。</span><span class="sxs-lookup"><span data-stu-id="75272-107">The determinism of a function is one such property.</span></span> <span data-ttu-id="75272-108">例如，如果一个视图引用了任何不确定性函数，则无法对该视图创建聚集索引。</span><span class="sxs-lookup"><span data-stu-id="75272-108">For example, a clustered index cannot be created on a view if the view references any nondeterministic functions.</span></span> <span data-ttu-id="75272-109">有关函数属性（包括函数确定性）的详细信息，请参阅 [用户定义函数](user-defined-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="75272-109">For more information about the properties of functions, including determinism, see [User-Defined Functions](user-defined-functions.md).</span></span>  
  
 <span data-ttu-id="75272-110">本主题介绍了内置系统函数的确定性，以及在包含对扩展存储过程的调用时对用户定义函数的确定性的影响。</span><span class="sxs-lookup"><span data-stu-id="75272-110">This topic identifies the determinism of built-in system functions and the effect on the deterministic property of user-defined functions when it contains a call to extended stored procedures.</span></span>  
  
## <a name="built-in-function-determinism"></a><span data-ttu-id="75272-111">内置函数的确定性</span><span class="sxs-lookup"><span data-stu-id="75272-111">Built-in Function Determinism</span></span>  
 <span data-ttu-id="75272-112">用户无法影响任何内置函数的确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-112">You cannot influence the determinism of any built-in function.</span></span> <span data-ttu-id="75272-113">每个内置函数都根据 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实现该函数的方式而分为确定性函数或非确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-113">Each built-in function is deterministic or nondeterministic based on how the function is implemented by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="75272-114">例如，在查询中指定 ORDER BY 子句不会更改查询中使用的函数的决定机制。</span><span class="sxs-lookup"><span data-stu-id="75272-114">For example, specifying an ORDER BY clause in a query does not change the determinism of a function that used in that query.</span></span>  
  
 <span data-ttu-id="75272-115">所有字符串内置函数都具有确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-115">All of the string built-in functions are deterministic.</span></span> <span data-ttu-id="75272-116">有关这些函数的列表，请参阅[字符串函数 (Transact-SQL)](/sql/t-sql/functions/string-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="75272-116">For a list of these functions, see [String Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="75272-117">内置函数类别中除字符串函数以外的下列内置函数始终具有确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-117">The following built-in functions from categories of built-in functions other than string functions are always deterministic.</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="75272-118">ABS</span><span class="sxs-lookup"><span data-stu-id="75272-118">ABS</span></span>|<span data-ttu-id="75272-119">DATEDIFF</span><span class="sxs-lookup"><span data-stu-id="75272-119">DATEDIFF</span></span>|<span data-ttu-id="75272-120">POWER</span><span class="sxs-lookup"><span data-stu-id="75272-120">POWER</span></span>|  
|<span data-ttu-id="75272-121">ACOS</span><span class="sxs-lookup"><span data-stu-id="75272-121">ACOS</span></span>|<span data-ttu-id="75272-122">DAY</span><span class="sxs-lookup"><span data-stu-id="75272-122">DAY</span></span>|<span data-ttu-id="75272-123">RADIANS</span><span class="sxs-lookup"><span data-stu-id="75272-123">RADIANS</span></span>|  
|<span data-ttu-id="75272-124">ASIN</span><span class="sxs-lookup"><span data-stu-id="75272-124">ASIN</span></span>|<span data-ttu-id="75272-125">DEGREES</span><span class="sxs-lookup"><span data-stu-id="75272-125">DEGREES</span></span>|<span data-ttu-id="75272-126">ROUND</span><span class="sxs-lookup"><span data-stu-id="75272-126">ROUND</span></span>|  
|<span data-ttu-id="75272-127">ATAN</span><span class="sxs-lookup"><span data-stu-id="75272-127">ATAN</span></span>|<span data-ttu-id="75272-128">EXP</span><span class="sxs-lookup"><span data-stu-id="75272-128">EXP</span></span>|<span data-ttu-id="75272-129">SIGN</span><span class="sxs-lookup"><span data-stu-id="75272-129">SIGN</span></span>|  
|<span data-ttu-id="75272-130">ATN2</span><span class="sxs-lookup"><span data-stu-id="75272-130">ATN2</span></span>|<span data-ttu-id="75272-131">FLOOR</span><span class="sxs-lookup"><span data-stu-id="75272-131">FLOOR</span></span>|<span data-ttu-id="75272-132">SIN</span><span class="sxs-lookup"><span data-stu-id="75272-132">SIN</span></span>|  
|<span data-ttu-id="75272-133">CEILING</span><span class="sxs-lookup"><span data-stu-id="75272-133">CEILING</span></span>|<span data-ttu-id="75272-134">ISNULL</span><span class="sxs-lookup"><span data-stu-id="75272-134">ISNULL</span></span>|<span data-ttu-id="75272-135">SQUARE</span><span class="sxs-lookup"><span data-stu-id="75272-135">SQUARE</span></span>|  
|<span data-ttu-id="75272-136">COALESCE</span><span class="sxs-lookup"><span data-stu-id="75272-136">COALESCE</span></span>|<span data-ttu-id="75272-137">ISNUMERIC</span><span class="sxs-lookup"><span data-stu-id="75272-137">ISNUMERIC</span></span>|<span data-ttu-id="75272-138">SQRT</span><span class="sxs-lookup"><span data-stu-id="75272-138">SQRT</span></span>|  
|<span data-ttu-id="75272-139">COS</span><span class="sxs-lookup"><span data-stu-id="75272-139">COS</span></span>|<span data-ttu-id="75272-140">LOG</span><span class="sxs-lookup"><span data-stu-id="75272-140">LOG</span></span>|<span data-ttu-id="75272-141">TAN</span><span class="sxs-lookup"><span data-stu-id="75272-141">TAN</span></span>|  
|<span data-ttu-id="75272-142">COT</span><span class="sxs-lookup"><span data-stu-id="75272-142">COT</span></span>|<span data-ttu-id="75272-143">LOG10</span><span class="sxs-lookup"><span data-stu-id="75272-143">LOG10</span></span>|<span data-ttu-id="75272-144">YEAR</span><span class="sxs-lookup"><span data-stu-id="75272-144">YEAR</span></span>|  
|<span data-ttu-id="75272-145">DATALENGTH</span><span class="sxs-lookup"><span data-stu-id="75272-145">DATALENGTH</span></span>|<span data-ttu-id="75272-146">MONTH</span><span class="sxs-lookup"><span data-stu-id="75272-146">MONTH</span></span>||  
|<span data-ttu-id="75272-147">DATEADD</span><span class="sxs-lookup"><span data-stu-id="75272-147">DATEADD</span></span>|<span data-ttu-id="75272-148">NULLIF</span><span class="sxs-lookup"><span data-stu-id="75272-148">NULLIF</span></span>||  
  
 <span data-ttu-id="75272-149">下列函数并非始终是确定性函数，但是在以确定性方式指定后，可用于索引视图或计算列的索引。</span><span class="sxs-lookup"><span data-stu-id="75272-149">The following functions are not always deterministic, but can be used in indexed views or indexes on computed columns when they are specified in a deterministic manner.</span></span>  
  
|<span data-ttu-id="75272-150">函数</span><span class="sxs-lookup"><span data-stu-id="75272-150">Function</span></span>|<span data-ttu-id="75272-151">注释</span><span class="sxs-lookup"><span data-stu-id="75272-151">Comments</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="75272-152">所有聚合函数</span><span class="sxs-lookup"><span data-stu-id="75272-152">all aggregate functions</span></span>|<span data-ttu-id="75272-153">除非用 OVER 和 ORDER BY 子句指定聚合函数，否则所有聚合函数都具有确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-153">All aggregate functions are deterministic unless they are specified with the OVER and ORDER BY clauses.</span></span> <span data-ttu-id="75272-154">有关这些函数的列表，请参阅[聚合函数 (Transact-SQL)](/sql/t-sql/functions/aggregate-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="75272-154">For a list of these functions, see [Aggregate Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql).</span></span>|  
|<span data-ttu-id="75272-155">CAST</span><span class="sxs-lookup"><span data-stu-id="75272-155">CAST</span></span>|<span data-ttu-id="75272-156">除非与 `datetime`、`smalldatetime` 或 `sql_variant` 一起使用，否则为确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-156">Deterministic unless used with `datetime`, `smalldatetime`, or `sql_variant`.</span></span>|  
|<span data-ttu-id="75272-157">CONVERT</span><span class="sxs-lookup"><span data-stu-id="75272-157">CONVERT</span></span>|<span data-ttu-id="75272-158">除非存在下列条件，否则为确定性函数：</span><span class="sxs-lookup"><span data-stu-id="75272-158">Deterministic unless one of these conditions exists:</span></span><br /><br /> <span data-ttu-id="75272-159">源类型是 `sql_variant`。</span><span class="sxs-lookup"><span data-stu-id="75272-159">Source type is `sql_variant`.</span></span><br /><br /> <span data-ttu-id="75272-160">目标类型是 `sql_variant`，其源类型具有不确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-160">Target type is `sql_variant` and its source type is nondeterministic.</span></span><br /><br /> <span data-ttu-id="75272-161">源类型或目标类型是 `datetime` 或 `smalldatetime`，其他源类型或目标类型是字符串，并且指定了不确定的样式。</span><span class="sxs-lookup"><span data-stu-id="75272-161">Source or target type is `datetime` or `smalldatetime`, the other source or target type is a character string, and a nondeterministic style is specified.</span></span> <span data-ttu-id="75272-162">若要为确定样式，则样式参数必须是常量。</span><span class="sxs-lookup"><span data-stu-id="75272-162">To be deterministic, the style parameter must be a constant.</span></span> <span data-ttu-id="75272-163">此外，除了样式 20 和 21，小于或等于 100 的样式都具有不确定性。</span><span class="sxs-lookup"><span data-stu-id="75272-163">Additionally, styles less than or equal to 100 are nondeterministic, except for styles 20 and 21.</span></span> <span data-ttu-id="75272-164">大于 100 的样式具有确定性，但样式 106、107、109 和 113 除外。</span><span class="sxs-lookup"><span data-stu-id="75272-164">Styles greater than 100 are deterministic, except for styles 106, 107, 109 and 113.</span></span>|  
|<span data-ttu-id="75272-165">CHECKSUM</span><span class="sxs-lookup"><span data-stu-id="75272-165">CHECKSUM</span></span>|<span data-ttu-id="75272-166">确定性函数，CHECKSUM(\*) 除外。</span><span class="sxs-lookup"><span data-stu-id="75272-166">Deterministic, with the exception of CHECKSUM(\*).</span></span>|  
|<span data-ttu-id="75272-167">ISDATE</span><span class="sxs-lookup"><span data-stu-id="75272-167">ISDATE</span></span>|<span data-ttu-id="75272-168">只有与 CONVERT 函数一起使用、指定 CONVERT 样式参数并且样式不等于 0、100、9 或 109 时，才是确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-168">Deterministic only if used with the CONVERT function, the CONVERT style parameter is specified and style is not equal to 0, 100, 9, or 109.</span></span>|  
|<span data-ttu-id="75272-169">RAND</span><span class="sxs-lookup"><span data-stu-id="75272-169">RAND</span></span>|<span data-ttu-id="75272-170">仅当指定 *seed* 参数时，RAND 才是确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-170">RAND is deterministic only when a *seed* parameter is specified.</span></span>|  
  
 <span data-ttu-id="75272-171">所有配置、游标、元数据、安全和系统统计函数都是非确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-171">All the configuration, cursor, metadata, security, and system statistical functions are nondeterministic.</span></span> <span data-ttu-id="75272-172">有关这些函数的列表，请参阅[配置函数 (Transact-SQL)](/sql/t-sql/functions/configuration-functions-transact-sql)、[游标函数 (Transact-SQL)](/sql/t-sql/functions/cursor-functions-transact-sql)、[元数据函数 (Transact-SQL)](/sql/t-sql/functions/metadata-functions-transact-sql)、[安全函数 (Transact-SQL)](/sql/t-sql/functions/security-functions-transact-sql) 和[系统统计函数 (Transact-SQL)](/sql/t-sql/functions/system-statistical-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="75272-172">For a list of these functions, see [Configuration Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql), [Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql), [Metadata Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql), [Security Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql), and [System Statistical Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="75272-173">其他类别中的下列内置函数始终为非确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-173">The following built-in functions from other categories are always nondeterministic.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="75272-174">@@CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="75272-174">@@CONNECTIONS</span></span>|<span data-ttu-id="75272-175">GETDATE</span><span class="sxs-lookup"><span data-stu-id="75272-175">GETDATE</span></span>|  
|<span data-ttu-id="75272-176">@@CPU_BUSY</span><span class="sxs-lookup"><span data-stu-id="75272-176">@@CPU_BUSY</span></span>|<span data-ttu-id="75272-177">GETUTCDATE</span><span class="sxs-lookup"><span data-stu-id="75272-177">GETUTCDATE</span></span>|  
|<span data-ttu-id="75272-178">@@DBTS</span><span class="sxs-lookup"><span data-stu-id="75272-178">@@DBTS</span></span>|<span data-ttu-id="75272-179">GET_TRANSMISSION_STATUS</span><span class="sxs-lookup"><span data-stu-id="75272-179">GET_TRANSMISSION_STATUS</span></span>|  
|<span data-ttu-id="75272-180">@@IDLE</span><span class="sxs-lookup"><span data-stu-id="75272-180">@@IDLE</span></span>|<span data-ttu-id="75272-181">LAG</span><span class="sxs-lookup"><span data-stu-id="75272-181">LAG</span></span>|  
|<span data-ttu-id="75272-182">@@IO_BUSY</span><span class="sxs-lookup"><span data-stu-id="75272-182">@@IO_BUSY</span></span>|<span data-ttu-id="75272-183">LAST_VALUE</span><span class="sxs-lookup"><span data-stu-id="75272-183">LAST_VALUE</span></span>|  
|<span data-ttu-id="75272-184">@@MAX_CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="75272-184">@@MAX_CONNECTIONS</span></span>|<span data-ttu-id="75272-185">LEAD</span><span class="sxs-lookup"><span data-stu-id="75272-185">LEAD</span></span>|  
|<span data-ttu-id="75272-186">@@PACK_RECEIVED</span><span class="sxs-lookup"><span data-stu-id="75272-186">@@PACK_RECEIVED</span></span>|<span data-ttu-id="75272-187">MIN_ACTIVE_ROWVERSION</span><span class="sxs-lookup"><span data-stu-id="75272-187">MIN_ACTIVE_ROWVERSION</span></span>|  
|<span data-ttu-id="75272-188">@@PACK_SENT</span><span class="sxs-lookup"><span data-stu-id="75272-188">@@PACK_SENT</span></span>|<span data-ttu-id="75272-189">NEWID</span><span class="sxs-lookup"><span data-stu-id="75272-189">NEWID</span></span>|  
|<span data-ttu-id="75272-190">@@PACKET_ERRORS</span><span class="sxs-lookup"><span data-stu-id="75272-190">@@PACKET_ERRORS</span></span>|<span data-ttu-id="75272-191">NEWSEQUENTIALID</span><span class="sxs-lookup"><span data-stu-id="75272-191">NEWSEQUENTIALID</span></span>|  
|<span data-ttu-id="75272-192">@@TIMETICKS</span><span class="sxs-lookup"><span data-stu-id="75272-192">@@TIMETICKS</span></span>|<span data-ttu-id="75272-193">NEXT VALUE FOR</span><span class="sxs-lookup"><span data-stu-id="75272-193">NEXT VALUE FOR</span></span>|  
|<span data-ttu-id="75272-194">@@TOTAL_ERRORS</span><span class="sxs-lookup"><span data-stu-id="75272-194">@@TOTAL_ERRORS</span></span>|<span data-ttu-id="75272-195">NTILE</span><span class="sxs-lookup"><span data-stu-id="75272-195">NTILE</span></span>|  
|<span data-ttu-id="75272-196">@@TOTAL_READ</span><span class="sxs-lookup"><span data-stu-id="75272-196">@@TOTAL_READ</span></span>|<span data-ttu-id="75272-197">PARSENAME</span><span class="sxs-lookup"><span data-stu-id="75272-197">PARSENAME</span></span>|  
|<span data-ttu-id="75272-198">@@TOTAL_WRITE</span><span class="sxs-lookup"><span data-stu-id="75272-198">@@TOTAL_WRITE</span></span>|<span data-ttu-id="75272-199">PERCENTILE_CONT</span><span class="sxs-lookup"><span data-stu-id="75272-199">PERCENTILE_CONT</span></span>|  
|<span data-ttu-id="75272-200">CUME_DIST</span><span class="sxs-lookup"><span data-stu-id="75272-200">CUME_DIST</span></span>|<span data-ttu-id="75272-201">PERCENTILE_DISC</span><span class="sxs-lookup"><span data-stu-id="75272-201">PERCENTILE_DISC</span></span>|  
|<span data-ttu-id="75272-202">CURRENT_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="75272-202">CURRENT_TIMESTAMP</span></span>|<span data-ttu-id="75272-203">PERCENT_RANK</span><span class="sxs-lookup"><span data-stu-id="75272-203">PERCENT_RANK</span></span>|  
|<span data-ttu-id="75272-204">DENSE_RANK</span><span class="sxs-lookup"><span data-stu-id="75272-204">DENSE_RANK</span></span>|<span data-ttu-id="75272-205">RAND</span><span class="sxs-lookup"><span data-stu-id="75272-205">RAND</span></span>|  
|<span data-ttu-id="75272-206">FIRST_VALUE</span><span class="sxs-lookup"><span data-stu-id="75272-206">FIRST_VALUE</span></span>|<span data-ttu-id="75272-207">RANK</span><span class="sxs-lookup"><span data-stu-id="75272-207">RANK</span></span>|  
||<span data-ttu-id="75272-208">ROW_NUMBER</span><span class="sxs-lookup"><span data-stu-id="75272-208">ROW_NUMBER</span></span>|  
||<span data-ttu-id="75272-209">TEXTPTR</span><span class="sxs-lookup"><span data-stu-id="75272-209">TEXTPTR</span></span>|  
  
## <a name="calling-extended-stored-procedures-from-functions"></a><span data-ttu-id="75272-210">从函数中调用扩展存储过程</span><span class="sxs-lookup"><span data-stu-id="75272-210">Calling Extended Stored Procedures from Functions</span></span>  
 <span data-ttu-id="75272-211">由于扩展存储过程会对数据库产生副面影响，因此调用扩展存储过程的函数为不确定性函数。</span><span class="sxs-lookup"><span data-stu-id="75272-211">Functions that call extended stored procedures are nondeterministic, because the extended stored procedures can cause side effects on the database.</span></span> <span data-ttu-id="75272-212">负面影响为对数据库全局状态的更改，如更新表、更新文件或网络等外部资源；例如，修改文件或发送电子邮件。</span><span class="sxs-lookup"><span data-stu-id="75272-212">Side effects are changes to a global state of the database, such as an update to a table, or to an external resource, such as a file or the network; for example, modifying a file or sending an e-mail message.</span></span> <span data-ttu-id="75272-213">从用户定义函数中执行扩展存储过程时，不应该依靠返回一致的结果集。</span><span class="sxs-lookup"><span data-stu-id="75272-213">You should not rely on returning a consistent result set when executing an extended stored procedure from a user-defined function.</span></span> <span data-ttu-id="75272-214">建议不要使用对数据库产生负面影响的用户定义函数。</span><span class="sxs-lookup"><span data-stu-id="75272-214">User-defined functions that create side effects on the database are not recommended.</span></span>  
  
 <span data-ttu-id="75272-215">从函数内部调用扩展存储过程时，该扩展存储过程不能向客户端返回结果集。</span><span class="sxs-lookup"><span data-stu-id="75272-215">When called from inside a function, the extended stored procedure cannot return result sets to the client.</span></span> <span data-ttu-id="75272-216">任何向客户端返回结果集的开放式数据服务 API 将产生返回代码 FAIL。</span><span class="sxs-lookup"><span data-stu-id="75272-216">Any Open Data Services API that returns result sets to the client will have a return code of FAIL.</span></span>  
  
 <span data-ttu-id="75272-217">扩展存储过程可以连接回 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="75272-217">The extended stored procedure can connect back to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="75272-218">但是，该过程不能与调用扩展存储过程的原始函数联接同一事务。</span><span class="sxs-lookup"><span data-stu-id="75272-218">However, the procedure cannot join the same transaction as the original function that invoked the extended stored procedure.</span></span>  
  
 <span data-ttu-id="75272-219">类似于从批处理或存储过程中调用，扩展存储过程在运行 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Windows 安全帐户的上下文中执行。</span><span class="sxs-lookup"><span data-stu-id="75272-219">Similar to invocations from a batch or stored procedure, the extended stored procedure is executed in the context of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows security account under which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="75272-220">扩展存储过程的所有者在授予其他用户执行该过程的权限时应该考虑此问题。</span><span class="sxs-lookup"><span data-stu-id="75272-220">The owner of the extended stored procedure should consider this when granting permissions to other users to execute the procedure.</span></span>  
  
  
