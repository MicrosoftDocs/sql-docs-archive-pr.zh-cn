---
title: 从程序变量大容量复制 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [ODBC], program variables
- bcp_bind function
- mapping data types [ODBC]
- SQL Server Native Client ODBC driver, bulk copy
- data types [ODBC], bulk copying
- ODBC, bulk copy operations
- program variables [ODBC]
ms.assetid: e4284a1b-7534-4b34-8488-b8d05ed67b8c
author: rothja
ms.author: jroth
ms.openlocfilehash: 5a50e8e104d63c63138a1ae14e27104181e6d9fd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591326"
---
# <a name="bulk-copying-from-program-variables"></a><span data-ttu-id="cd388-102">从程序变量执行大容量复制</span><span class="sxs-lookup"><span data-stu-id="cd388-102">Bulk Copying from Program Variables</span></span>
  <span data-ttu-id="cd388-103">可以直接从程序变量执行大容量复制。</span><span class="sxs-lookup"><span data-stu-id="cd388-103">You can bulk copy directly from program variables.</span></span> <span data-ttu-id="cd388-104">分配用于保存行数据的变量并调用[bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md)启动大容量复制后，为每一列调用[bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) ，以指定与列关联的程序变量的位置和格式。</span><span class="sxs-lookup"><span data-stu-id="cd388-104">After allocating variables to hold the data for a row and calling [bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md) to start the bulk copy, call [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) for each column to specify the location and format of the program variable to be associated with the column.</span></span> <span data-ttu-id="cd388-105">用数据填充每个变量，然后调用[bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md)将一行数据发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="cd388-105">Fill each variable with data, then call [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) to send one row of data to the server.</span></span> <span data-ttu-id="cd388-106">重复填充变量并调用**bcp_sendrow**的过程，直到所有行都发送到服务器，然后调用[bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md)以指定操作已完成。</span><span class="sxs-lookup"><span data-stu-id="cd388-106">Repeat the process of filling the variables and calling **bcp_sendrow** until all the rows have been sent to the server, then call [bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md) to specify that the operation is complete.</span></span>  
  
 <span data-ttu-id="cd388-107">**Bcp_bind**_pData_参数包含绑定到列的变量的地址。</span><span class="sxs-lookup"><span data-stu-id="cd388-107">The **bcp_bind**_pData_ parameter contains the address of the variable being bound to the column.</span></span> <span data-ttu-id="cd388-108">每列的数据都可以通过以下两种方式之一存储：</span><span class="sxs-lookup"><span data-stu-id="cd388-108">The data for each column can be stored in one of two ways:</span></span>  
  
-   <span data-ttu-id="cd388-109">分配一个变量以保存数据。</span><span class="sxs-lookup"><span data-stu-id="cd388-109">Allocate one variable to hold the data.</span></span>  
  
-   <span data-ttu-id="cd388-110">分配指示器变量，后面紧随数据变量。</span><span class="sxs-lookup"><span data-stu-id="cd388-110">Allocate an indicator variable followed immediately by the data variable.</span></span>  
  
 <span data-ttu-id="cd388-111">指示器变量指示可变长度列的数据长度，如果列允许 NULL 值，还指示 NULL 值。</span><span class="sxs-lookup"><span data-stu-id="cd388-111">The indicator variable indicates the length of the data for variable-length columns, and also indicates NULL values if the column allows NULLs.</span></span> <span data-ttu-id="cd388-112">如果仅使用数据变量，则此变量的地址存储在**bcp_bind**_pData_参数中。</span><span class="sxs-lookup"><span data-stu-id="cd388-112">If only a data variable is used, then the address of this variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="cd388-113">如果使用指示器变量，则指示器变量的地址存储在**bcp_bind**_pData_参数中。</span><span class="sxs-lookup"><span data-stu-id="cd388-113">If an indicator variable is used, the address of the indicator variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="cd388-114">大容量复制函数通过添加**bcp_bind**_cbIndicator_和*pData*参数来计算数据变量的位置。</span><span class="sxs-lookup"><span data-stu-id="cd388-114">The bulk copy functions calculate the location of the data variable by adding the **bcp_bind**_cbIndicator_ and *pData* parameters.</span></span>  
  
 <span data-ttu-id="cd388-115">**bcp_bind**支持三种方法来处理可变长度数据：</span><span class="sxs-lookup"><span data-stu-id="cd388-115">**bcp_bind** supports three methods for dealing with variable-length data:</span></span>  
  
-   <span data-ttu-id="cd388-116">仅将*cbData*与数据变量一起使用。</span><span class="sxs-lookup"><span data-stu-id="cd388-116">Use *cbData* with only a data variable.</span></span> <span data-ttu-id="cd388-117">将数据的长度放置在*cbData*中。</span><span class="sxs-lookup"><span data-stu-id="cd388-117">Place the length of the data in *cbData*.</span></span> <span data-ttu-id="cd388-118">每次要大容量复制的数据的长度更改时，调用[bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)重置*cbData*。</span><span class="sxs-lookup"><span data-stu-id="cd388-118">Each time the length of the data to be bulk copied changes, call [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)to reset *cbData*.</span></span> <span data-ttu-id="cd388-119">如果使用其他两种方法之一，则为*cbData*指定 SQL_VARLEN_DATA。</span><span class="sxs-lookup"><span data-stu-id="cd388-119">If one of the other two methods is being used, specify SQL_VARLEN_DATA for *cbData*.</span></span> <span data-ttu-id="cd388-120">如果为列提供的所有数据值都为 NULL，则为*cbData*指定 SQL_NULL_DATA。</span><span class="sxs-lookup"><span data-stu-id="cd388-120">If all the data values being supplied for a column are NULL, specify SQL_NULL_DATA for *cbData*.</span></span>  
  
-   <span data-ttu-id="cd388-121">使用指示器变量。</span><span class="sxs-lookup"><span data-stu-id="cd388-121">Use indicator variables.</span></span> <span data-ttu-id="cd388-122">随着每个新数据值移入数据变量，将该值的长度存储在指示器变量中。</span><span class="sxs-lookup"><span data-stu-id="cd388-122">As each new data value is moved into the data variable, store the length of the value in the indicator variable.</span></span> <span data-ttu-id="cd388-123">如果使用另一种方法，请将*cbIndicator*指定为0。</span><span class="sxs-lookup"><span data-stu-id="cd388-123">If one of the other two methods is being used, specify 0 for *cbIndicator*.</span></span>  
  
-   <span data-ttu-id="cd388-124">使用终止符指针。</span><span class="sxs-lookup"><span data-stu-id="cd388-124">Use terminator pointers.</span></span> <span data-ttu-id="cd388-125">加载**bcp_bind**_pTerm_参数，其中包含终止数据的位模式的地址。</span><span class="sxs-lookup"><span data-stu-id="cd388-125">Load the **bcp_bind**_pTerm_ parameter with the address of the bit pattern that terminates the data.</span></span> <span data-ttu-id="cd388-126">如果使用其他两种方法之一，则为*pTerm*指定 NULL。</span><span class="sxs-lookup"><span data-stu-id="cd388-126">If one of the other two methods is being used, specify NULL for *pTerm*.</span></span>  
  
 <span data-ttu-id="cd388-127">这三种方法都可以在相同的**bcp_bind**调用上使用，在这种情况下，将使用导致复制的数据量最少的规范。</span><span class="sxs-lookup"><span data-stu-id="cd388-127">All three of these methods can be used on the same **bcp_bind** call, in which case the specification that results in the smallest amount of data being copied is used.</span></span>  
  
 <span data-ttu-id="cd388-128">**Bcp_bind**_类型_参数使用 db-library 数据类型标识符，而非 ODBC 数据类型标识符。</span><span class="sxs-lookup"><span data-stu-id="cd388-128">The **bcp_bind**_type_ parameter uses DB-Library data type identifiers, not ODBC data type identifiers.</span></span> <span data-ttu-id="cd388-129">在 sqlncli.msi 中定义了 DB-LIBRARY 数据类型标识符，以便与 ODBC **bcp_bind**函数结合使用。</span><span class="sxs-lookup"><span data-stu-id="cd388-129">DB-Library data type identifiers are defined in sqlncli.h for use with the ODBC **bcp_bind** function.</span></span>  
  
 <span data-ttu-id="cd388-130">大容量复制函数并不支持所有 ODBC C 数据类型。</span><span class="sxs-lookup"><span data-stu-id="cd388-130">Bulk copy functions do not support all ODBC C data types.</span></span> <span data-ttu-id="cd388-131">例如，大容量复制函数不支持 ODBC SQL_C_TYPE_TIMESTAMP 结构，因此请使用[SQLBindCol](../native-client-odbc-api/sqlbindcol.md)或[SQLGetData](../native-client-odbc-api/sqlgetdata.md)将 odbc SQL_TYPE_TIMESTAMP 数据转换为 SQL_C_CHAR 变量。</span><span class="sxs-lookup"><span data-stu-id="cd388-131">For example, the bulk copy functions do not support the ODBC SQL_C_TYPE_TIMESTAMP structure, so use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) or [SQLGetData](../native-client-odbc-api/sqlgetdata.md) to convert ODBC SQL_TYPE_TIMESTAMP data to a SQL_C_CHAR variable.</span></span> <span data-ttu-id="cd388-132">如果随后将**bcp_bind**与 SQLCHARACTER 的*类型*参数结合使用，将变量绑定到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime**列，则大容量复制函数会将字符变量中的 timestamp 转义子句转换为正确的日期时间格式。</span><span class="sxs-lookup"><span data-stu-id="cd388-132">If you then use **bcp_bind** with a *type* parameter of SQLCHARACTER to bind the variable to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime** column, the bulk copy functions convert the timestamp escape clause in the character variable to the proper datetime format.</span></span>  
  
 <span data-ttu-id="cd388-133">下表列出了从 ODBC SQL 数据类型映射到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据类型时推荐使用的数据类型。</span><span class="sxs-lookup"><span data-stu-id="cd388-133">The following table lists the recommended data types to use in mapping from an ODBC SQL data type to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span>  
  
|<span data-ttu-id="cd388-134">ODBC SQL 数据类型</span><span class="sxs-lookup"><span data-stu-id="cd388-134">ODBC SQLdata type</span></span>|<span data-ttu-id="cd388-135">ODBC C 数据类型</span><span class="sxs-lookup"><span data-stu-id="cd388-135">ODBC C data type</span></span>|<span data-ttu-id="cd388-136">bcp_bind*类型*参数</span><span class="sxs-lookup"><span data-stu-id="cd388-136">bcp_bind *type* parameter</span></span>|<span data-ttu-id="cd388-137">SQL Server 数据类型</span><span class="sxs-lookup"><span data-stu-id="cd388-137">SQL Server data type</span></span>|  
|-----------------------|----------------------|--------------------------------|--------------------------|  
|<span data-ttu-id="cd388-138">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-138">SQL_CHAR</span></span>|<span data-ttu-id="cd388-139">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-139">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-140">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-140">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-141">**字符**</span><span class="sxs-lookup"><span data-stu-id="cd388-141">**character**</span></span><br /><br /> <span data-ttu-id="cd388-142">**char**</span><span class="sxs-lookup"><span data-stu-id="cd388-142">**char**</span></span>|  
|<span data-ttu-id="cd388-143">SQL_VARCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-143">SQL_VARCHAR</span></span>|<span data-ttu-id="cd388-144">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-144">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-145">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-145">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-146">**varchar**</span><span class="sxs-lookup"><span data-stu-id="cd388-146">**varchar**</span></span><br /><br /> <span data-ttu-id="cd388-147">**字符变化**</span><span class="sxs-lookup"><span data-stu-id="cd388-147">**character varying**</span></span><br /><br /> <span data-ttu-id="cd388-148">**char varying**</span><span class="sxs-lookup"><span data-stu-id="cd388-148">**char varying**</span></span><br /><br /> <span data-ttu-id="cd388-149">**sysname**</span><span class="sxs-lookup"><span data-stu-id="cd388-149">**sysname**</span></span>|  
|<span data-ttu-id="cd388-150">SQL_LONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-150">SQL_LONGVARCHAR</span></span>|<span data-ttu-id="cd388-151">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-151">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-152">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-152">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-153">**text**</span><span class="sxs-lookup"><span data-stu-id="cd388-153">**text**</span></span>|  
|<span data-ttu-id="cd388-154">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-154">SQL_WCHAR</span></span>|<span data-ttu-id="cd388-155">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-155">SQL_C_WCHAR</span></span>|<span data-ttu-id="cd388-156">SQLNCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-156">SQLNCHAR</span></span>|<span data-ttu-id="cd388-157">**nchar**</span><span class="sxs-lookup"><span data-stu-id="cd388-157">**nchar**</span></span>|  
|<span data-ttu-id="cd388-158">SQL_WVARCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-158">SQL_WVARCHAR</span></span>|<span data-ttu-id="cd388-159">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-159">SQL_C_WCHAR</span></span>|<span data-ttu-id="cd388-160">SQLNVARCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-160">SQLNVARCHAR</span></span>|<span data-ttu-id="cd388-161">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="cd388-161">**nvarchar**</span></span>|  
|<span data-ttu-id="cd388-162">SQL_WLONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-162">SQL_WLONGVARCHAR</span></span>|<span data-ttu-id="cd388-163">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-163">SQL_C_WCHAR</span></span>|<span data-ttu-id="cd388-164">SQLNTEXT</span><span class="sxs-lookup"><span data-stu-id="cd388-164">SQLNTEXT</span></span>|<span data-ttu-id="cd388-165">**ntext**</span><span class="sxs-lookup"><span data-stu-id="cd388-165">**ntext**</span></span>|  
|<span data-ttu-id="cd388-166">SQL_DECIMAL</span><span class="sxs-lookup"><span data-stu-id="cd388-166">SQL_DECIMAL</span></span>|<span data-ttu-id="cd388-167">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-167">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-168">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-168">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-169">**decimal**</span><span class="sxs-lookup"><span data-stu-id="cd388-169">**decimal**</span></span><br /><br /> <span data-ttu-id="cd388-170">**十进制**</span><span class="sxs-lookup"><span data-stu-id="cd388-170">**dec**</span></span><br /><br /> <span data-ttu-id="cd388-171">**money**</span><span class="sxs-lookup"><span data-stu-id="cd388-171">**money**</span></span><br /><br /> <span data-ttu-id="cd388-172">**smallmoney**</span><span class="sxs-lookup"><span data-stu-id="cd388-172">**smallmoney**</span></span>|  
|<span data-ttu-id="cd388-173">SQL_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="cd388-173">SQL_NUMERIC</span></span>|<span data-ttu-id="cd388-174">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="cd388-174">SQL_C_NUMERIC</span></span>|<span data-ttu-id="cd388-175">SQLNUMERICN</span><span class="sxs-lookup"><span data-stu-id="cd388-175">SQLNUMERICN</span></span>|<span data-ttu-id="cd388-176">**numeric**</span><span class="sxs-lookup"><span data-stu-id="cd388-176">**numeric**</span></span>|  
|<span data-ttu-id="cd388-177">SQL_BIT</span><span class="sxs-lookup"><span data-stu-id="cd388-177">SQL_BIT</span></span>|<span data-ttu-id="cd388-178">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="cd388-178">SQL_C_BIT</span></span>|<span data-ttu-id="cd388-179">SQLBIT</span><span class="sxs-lookup"><span data-stu-id="cd388-179">SQLBIT</span></span>|<span data-ttu-id="cd388-180">**bit**</span><span class="sxs-lookup"><span data-stu-id="cd388-180">**bit**</span></span>|  
|<span data-ttu-id="cd388-181">SQL_TINYINT（有符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-181">SQL_TINYINT (signed)</span></span>|<span data-ttu-id="cd388-182">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="cd388-182">SQL_C_SSHORT</span></span>|<span data-ttu-id="cd388-183">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="cd388-183">SQLINT2</span></span>|<span data-ttu-id="cd388-184">**smallint**</span><span class="sxs-lookup"><span data-stu-id="cd388-184">**smallint**</span></span>|  
|<span data-ttu-id="cd388-185">SQL_TINYINT（无符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-185">SQL_TINYINT (unsigned)</span></span>|<span data-ttu-id="cd388-186">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="cd388-186">SQL_C_UTINYINT</span></span>|<span data-ttu-id="cd388-187">SQLINT1</span><span class="sxs-lookup"><span data-stu-id="cd388-187">SQLINT1</span></span>|<span data-ttu-id="cd388-188">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="cd388-188">**tinyint**</span></span>|  
|<span data-ttu-id="cd388-189">SQL_SMALL_INT（有符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-189">SQL_SMALL_INT (signed)</span></span>|<span data-ttu-id="cd388-190">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="cd388-190">SQL_C_SSHORT</span></span>|<span data-ttu-id="cd388-191">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="cd388-191">SQLINT2</span></span>|<span data-ttu-id="cd388-192">**smallint**</span><span class="sxs-lookup"><span data-stu-id="cd388-192">**smallint**</span></span>|  
|<span data-ttu-id="cd388-193">SQL_SMALL_INT（无符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-193">SQL_SMALL_INT (unsigned)</span></span>|<span data-ttu-id="cd388-194">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="cd388-194">SQL_C_SLONG</span></span>|<span data-ttu-id="cd388-195">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="cd388-195">SQLINT4</span></span>|<span data-ttu-id="cd388-196">**int**</span><span class="sxs-lookup"><span data-stu-id="cd388-196">**int**</span></span><br /><br /> <span data-ttu-id="cd388-197">**integer**</span><span class="sxs-lookup"><span data-stu-id="cd388-197">**integer**</span></span>|  
|<span data-ttu-id="cd388-198">SQL_INTEGER（有符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-198">SQL_INTEGER (signed)</span></span>|<span data-ttu-id="cd388-199">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="cd388-199">SQL_C_SLONG</span></span>|<span data-ttu-id="cd388-200">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="cd388-200">SQLINT4</span></span>|<span data-ttu-id="cd388-201">**int**</span><span class="sxs-lookup"><span data-stu-id="cd388-201">**int**</span></span><br /><br /> <span data-ttu-id="cd388-202">**integer**</span><span class="sxs-lookup"><span data-stu-id="cd388-202">**integer**</span></span>|  
|<span data-ttu-id="cd388-203">SQL_INTEGER（无符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-203">SQL_INTEGER (unsigned)</span></span>|<span data-ttu-id="cd388-204">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-204">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-205">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-205">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-206">**decimal**</span><span class="sxs-lookup"><span data-stu-id="cd388-206">**decimal**</span></span><br /><br /> <span data-ttu-id="cd388-207">**十进制**</span><span class="sxs-lookup"><span data-stu-id="cd388-207">**dec**</span></span>|  
|<span data-ttu-id="cd388-208">SQL_BIGINT（有符号和无符号）</span><span class="sxs-lookup"><span data-stu-id="cd388-208">SQL_BIGINT (signed and unsigned)</span></span>|<span data-ttu-id="cd388-209">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-209">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-210">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-210">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-211">**bigint**</span><span class="sxs-lookup"><span data-stu-id="cd388-211">**bigint**</span></span>|  
|<span data-ttu-id="cd388-212">SQL_REAL</span><span class="sxs-lookup"><span data-stu-id="cd388-212">SQL_REAL</span></span>|<span data-ttu-id="cd388-213">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="cd388-213">SQL_C_FLOAT</span></span>|<span data-ttu-id="cd388-214">SQLFLT4</span><span class="sxs-lookup"><span data-stu-id="cd388-214">SQLFLT4</span></span>|<span data-ttu-id="cd388-215">**real**</span><span class="sxs-lookup"><span data-stu-id="cd388-215">**real**</span></span>|  
|<span data-ttu-id="cd388-216">SQL_FLOAT</span><span class="sxs-lookup"><span data-stu-id="cd388-216">SQL_FLOAT</span></span>|<span data-ttu-id="cd388-217">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="cd388-217">SQL_C_DOUBLE</span></span>|<span data-ttu-id="cd388-218">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="cd388-218">SQLFLT8</span></span>|<span data-ttu-id="cd388-219">**float**</span><span class="sxs-lookup"><span data-stu-id="cd388-219">**float**</span></span>|  
|<span data-ttu-id="cd388-220">SQL_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="cd388-220">SQL_DOUBLE</span></span>|<span data-ttu-id="cd388-221">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="cd388-221">SQL_C_DOUBLE</span></span>|<span data-ttu-id="cd388-222">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="cd388-222">SQLFLT8</span></span>|<span data-ttu-id="cd388-223">**float**</span><span class="sxs-lookup"><span data-stu-id="cd388-223">**float**</span></span>|  
|<span data-ttu-id="cd388-224">SQL_BINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-224">SQL_BINARY</span></span>|<span data-ttu-id="cd388-225">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-225">SQL_C_BINARY</span></span>|<span data-ttu-id="cd388-226">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-226">SQLBINARY</span></span>|<span data-ttu-id="cd388-227">**binary**</span><span class="sxs-lookup"><span data-stu-id="cd388-227">**binary**</span></span><br /><br /> <span data-ttu-id="cd388-228">**timestamp**</span><span class="sxs-lookup"><span data-stu-id="cd388-228">**timestamp**</span></span>|  
|<span data-ttu-id="cd388-229">SQL_VARBINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-229">SQL_VARBINARY</span></span>|<span data-ttu-id="cd388-230">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-230">SQL_C_BINARY</span></span>|<span data-ttu-id="cd388-231">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-231">SQLBINARY</span></span>|<span data-ttu-id="cd388-232">**varbinary**</span><span class="sxs-lookup"><span data-stu-id="cd388-232">**varbinary**</span></span><br /><br /> <span data-ttu-id="cd388-233">**二进制改变**</span><span class="sxs-lookup"><span data-stu-id="cd388-233">**binary varying**</span></span>|  
|<span data-ttu-id="cd388-234">SQL_LONGVARBINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-234">SQL_LONGVARBINARY</span></span>|<span data-ttu-id="cd388-235">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-235">SQL_C_BINARY</span></span>|<span data-ttu-id="cd388-236">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="cd388-236">SQLBINARY</span></span>|<span data-ttu-id="cd388-237">**图像**</span><span class="sxs-lookup"><span data-stu-id="cd388-237">**image**</span></span>|  
|<span data-ttu-id="cd388-238">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="cd388-238">SQL_TYPE_DATE</span></span>|<span data-ttu-id="cd388-239">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-239">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-240">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-240">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-241">**datetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-241">**datetime**</span></span><br /><br /> <span data-ttu-id="cd388-242">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-242">**smalldatetime**</span></span>|  
|<span data-ttu-id="cd388-243">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="cd388-243">SQL_TYPE_TIME</span></span>|<span data-ttu-id="cd388-244">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-244">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-245">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-245">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-246">**datetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-246">**datetime**</span></span><br /><br /> <span data-ttu-id="cd388-247">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-247">**smalldatetime**</span></span>|  
|<span data-ttu-id="cd388-248">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="cd388-248">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="cd388-249">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-249">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-250">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-250">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-251">**datetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-251">**datetime**</span></span><br /><br /> <span data-ttu-id="cd388-252">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="cd388-252">**smalldatetime**</span></span>|  
|<span data-ttu-id="cd388-253">SQL_GUID</span><span class="sxs-lookup"><span data-stu-id="cd388-253">SQL_GUID</span></span>|<span data-ttu-id="cd388-254">SQL_C_GUID</span><span class="sxs-lookup"><span data-stu-id="cd388-254">SQL_C_GUID</span></span>|<span data-ttu-id="cd388-255">SQLUNIQUEID</span><span class="sxs-lookup"><span data-stu-id="cd388-255">SQLUNIQUEID</span></span>|<span data-ttu-id="cd388-256">**uniqueidentifier**</span><span class="sxs-lookup"><span data-stu-id="cd388-256">**uniqueidentifier**</span></span>|  
|<span data-ttu-id="cd388-257">SQL_INTERVAL_</span><span class="sxs-lookup"><span data-stu-id="cd388-257">SQL_INTERVAL_</span></span>|<span data-ttu-id="cd388-258">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="cd388-258">SQL_C_CHAR</span></span>|<span data-ttu-id="cd388-259">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="cd388-259">SQLCHARACTER</span></span>|<span data-ttu-id="cd388-260">**char**</span><span class="sxs-lookup"><span data-stu-id="cd388-260">**char**</span></span>|  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="cd388-261">不具有有符号**tinyint**、无符号**smallint**或无符号**整数**数据类型。</span><span class="sxs-lookup"><span data-stu-id="cd388-261">does not have signed **tinyint**, unsigned **smallint**, or unsigned **int** data types.</span></span> <span data-ttu-id="cd388-262">若要在迁移这些数据类型时防止丢失数据值，应使用第二大整数数据类型创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表。</span><span class="sxs-lookup"><span data-stu-id="cd388-262">To prevent the loss of data values when migrating these data types, create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with the next largest integer data type.</span></span> <span data-ttu-id="cd388-263">若要防止用户以后添加原始数据类型所允许范围之外的值，应对 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 列应用一条规则，将允许的值限定在原始源中的数据类型所支持的范围之内：</span><span class="sxs-lookup"><span data-stu-id="cd388-263">To prevent users from later adding values outside the range allowed by the original data type, apply a rule to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] column to restrict the allowable values to the range supported by the data type in the original source:</span></span>  
  
```  
CREATE TABLE Sample_Ints(STinyIntCol   SMALLINT,  
USmallIntCol INT)  
GO  
CREATE RULE STinyInt_Rule  
AS   
@range >= -128 AND @range <= 127  
GO  
CREATE RULE USmallInt_Rule  
AS   
@range >= 0 AND @range <= 65535  
GO  
sp_bindrule STinyInt_Rule, 'Sample_Ints.STinyIntCol'  
GO  
sp_bindrule USmallInt_Rule, 'Sample_Ints.USmallIntCol'  
GO  
```  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="cd388-264">不直接支持 interval 数据类型。</span><span class="sxs-lookup"><span data-stu-id="cd388-264">does not support interval data types directly.</span></span> <span data-ttu-id="cd388-265">不过，应用程序可以将 interval 转义序列作为字符串存储在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 字符列中。</span><span class="sxs-lookup"><span data-stu-id="cd388-265">An application can, however, store interval escape sequences as character strings in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character column.</span></span> <span data-ttu-id="cd388-266">该应用程序可以读取它们供以后使用，但是它们无法用在 [!INCLUDE[tsql](../../includes/tsql-md.md)] 语句中。</span><span class="sxs-lookup"><span data-stu-id="cd388-266">The application can read them for later use, but they cannot be used in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
 <span data-ttu-id="cd388-267">可以使用大容量复制函数将从 ODBC 数据源中读取的数据快速加载到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中。</span><span class="sxs-lookup"><span data-stu-id="cd388-267">The bulk copy functions can be used to quickly load data into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that has been read from an ODBC data source.</span></span> <span data-ttu-id="cd388-268">使用[SQLBindCol](../native-client-odbc-api/sqlbindcol.md)将结果集的列绑定到程序变量，然后使用**bcp_bind**将相同的程序变量绑定到大容量复制操作。</span><span class="sxs-lookup"><span data-stu-id="cd388-268">Use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) to bind the columns of a result set to program variables, then use **bcp_bind** to bind the same program variables to a bulk copy operation.</span></span> <span data-ttu-id="cd388-269">然后，调用[SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md)或**SQLFetch**将数据从 ODBC 数据源提取到程序变量中，并调用[bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md)将数据从程序变量大容量复制到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="cd388-269">Calling [SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md) or **SQLFetch** then fetches a row of data from the ODBC data source into the program variables, and calling [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) bulk copies the data from the program variables to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span></span>  
  
 <span data-ttu-id="cd388-270">应用程序可以在任何需要更改最初在**bcp_bind** _pData_参数中指定的数据变量的地址时使用[bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md)函数。</span><span class="sxs-lookup"><span data-stu-id="cd388-270">An application can use the [bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md) function anytime it needs to change the address of the data variable originally specified in the **bcp_bind** _pData_ parameter.</span></span> <span data-ttu-id="cd388-271">应用程序可以在任何需要更改最初在**bcp_bind**_cbData_参数中指定的数据长度时使用[bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)函数。</span><span class="sxs-lookup"><span data-stu-id="cd388-271">An application can use the [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md) function anytime it needs to change the data length originally specified in the **bcp_bind**_cbData_ parameter.</span></span>  
  
 <span data-ttu-id="cd388-272">无法使用大容量复制功能将数据从 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 读取到程序变量中；没有与 "bcp_readrow" 函数类似的功能。</span><span class="sxs-lookup"><span data-stu-id="cd388-272">You cannot read data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] into program variables using bulk copy; there is nothing like a "bcp_readrow" function.</span></span> <span data-ttu-id="cd388-273">只能将数据从应用程序发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="cd388-273">You can only send data from the application to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cd388-274">另请参阅</span><span class="sxs-lookup"><span data-stu-id="cd388-274">See Also</span></span>  
 [<span data-ttu-id="cd388-275">&#40;ODBC&#41;执行大容量复制操作</span><span class="sxs-lookup"><span data-stu-id="cd388-275">Performing Bulk Copy Operations &#40;ODBC&#41;</span></span>](performing-bulk-copy-operations-odbc.md)  
  
  
