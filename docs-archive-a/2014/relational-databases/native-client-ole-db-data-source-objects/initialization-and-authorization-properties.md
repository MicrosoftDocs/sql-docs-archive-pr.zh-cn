---
title: 初始化和授权属性 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- authorization [OLE DB]
- properties [OLE DB]
- SQL Server Native Client OLE DB provider, initialization properties
- SQL Server Native Client OLE DB provider, authorization properties
- initialization properties [OLE DB]
ms.assetid: 913ab38c-e443-446c-b326-7447e95aa7f9
author: rothja
ms.author: jroth
ms.openlocfilehash: 923c593ffd64682e7d32847a7b4c36ad61c1b768
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87578193"
---
# <a name="initialization-and-authorization-properties"></a><span data-ttu-id="9c7d4-102">初始化和授权属性</span><span class="sxs-lookup"><span data-stu-id="9c7d4-102">Initialization and Authorization Properties</span></span>
  <span data-ttu-id="9c7d4-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口将 OLE DB 初始化和授权属性解释如下：</span><span class="sxs-lookup"><span data-stu-id="9c7d4-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider interprets OLE DB initialization and authorization properties as follows:</span></span>  
  
|<span data-ttu-id="9c7d4-104">属性 ID</span><span class="sxs-lookup"><span data-stu-id="9c7d4-104">Property ID</span></span>|<span data-ttu-id="9c7d4-105">说明</span><span class="sxs-lookup"><span data-stu-id="9c7d4-105">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="9c7d4-106">DBPROP_AUTH_CACHE_AUTHINFO</span><span class="sxs-lookup"><span data-stu-id="9c7d4-106">DBPROP_AUTH_CACHE_AUTHINFO</span></span>|<span data-ttu-id="9c7d4-107">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口不缓存身份验证信息。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-107">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not cache authentication information.</span></span><br /><br /> <span data-ttu-id="9c7d4-108">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-108">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-109">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-109">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-110">DBPROP_AUTH_ENCRYPT_PASSWORD</span><span class="sxs-lookup"><span data-stu-id="9c7d4-110">DBPROP_AUTH_ENCRYPT_PASSWORD</span></span>|<span data-ttu-id="9c7d4-111">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序使用标准 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的安全机制来隐藏密码。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-111">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses standard [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] security mechanisms to conceal passwords.</span></span><br /><br /> <span data-ttu-id="9c7d4-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-113">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-113">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-114">DBPROP_AUTH_INTEGRATED</span><span class="sxs-lookup"><span data-stu-id="9c7d4-114">DBPROP_AUTH_INTEGRATED</span></span>|<span data-ttu-id="9c7d4-115">如果 DBPROP_AUTH_INTEGRATED 设置为 NULL 指针、Null 字符串或“SSPI”VT_BSTR 值，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用 Windows 身份验证模式来授权用户访问由 DBPROP_INIT_DATASOURCE 和 DBPROP_INIT_CATALOG 属性指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-115">If DBPROP_AUTH_INTEGRATED is set to a NULL pointer, a null string, or 'SSPI' VT_BSTR value, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses Windows Authentication Mode to authorize user access to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database specified by the DBPROP_INIT_DATASOURCE and DBPROP_INIT_CATALOG properties.</span></span><br /><br /> <span data-ttu-id="9c7d4-116">如果它设置为 VT_EMPTY（默认值），则使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安全机制。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-116">If it is set to VT_EMPTY (the default), [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] security is used.</span></span> <span data-ttu-id="9c7d4-117">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 登录和密码是在 DBPROP_AUTH_USERID 和 DBPROP_AUTH_PASSWORD 属性中指定的。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-117">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login and password are specified in the DBPROP_AUTH_USERID and DBPROP_AUTH_PASSWORD properties.</span></span>|  
|<span data-ttu-id="9c7d4-118">DBPROP_AUTH_MASK_PASSWORD</span><span class="sxs-lookup"><span data-stu-id="9c7d4-118">DBPROP_AUTH_MASK_PASSWORD</span></span>|<span data-ttu-id="9c7d4-119">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用标准的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安全机制来隐藏密码。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-119">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses standard [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] security mechanisms to conceal passwords.</span></span><br /><br /> <span data-ttu-id="9c7d4-120">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-120">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-121">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-121">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-122">DBPROP_AUTH_PASSWORD</span><span class="sxs-lookup"><span data-stu-id="9c7d4-122">DBPROP_AUTH_PASSWORD</span></span>|<span data-ttu-id="9c7d4-123">分配给 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 登录名的密码。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-123">Password assigned to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login.</span></span> <span data-ttu-id="9c7d4-124">选用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 身份验证来授权访问 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库时，将使用该属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-124">This property is used when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication is selected for authorizing access to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="9c7d4-125">DBPROP_AUTH_PERSIST_ENCRYPTED</span><span class="sxs-lookup"><span data-stu-id="9c7d4-125">DBPROP_AUTH_PERSIST_ENCRYPTED</span></span>|<span data-ttu-id="9c7d4-126">保存身份验证信息时，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口不加密这些信息。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-126">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not encrypt authentication information when persisted.</span></span><br /><br /> <span data-ttu-id="9c7d4-127">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-127">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-128">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-128">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-129">DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO</span><span class="sxs-lookup"><span data-stu-id="9c7d4-129">DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO</span></span>|<span data-ttu-id="9c7d4-130">如果需要，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口保存包括密码的图像在内的身份验证值。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-130">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider persists authentication values, including an image of a password, if requested to do so.</span></span> <span data-ttu-id="9c7d4-131">不提供加密。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-131">No encryption is provided.</span></span>|  
|<span data-ttu-id="9c7d4-132">DBPROP_AUTH_USERID</span><span class="sxs-lookup"><span data-stu-id="9c7d4-132">DBPROP_AUTH_USERID</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9c7d4-133">登录名。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-133">login.</span></span> <span data-ttu-id="9c7d4-134">选用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 身份验证来授权访问 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库时，将使用该属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-134">This property is used when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication is selected for authorizing access to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="9c7d4-135">DBPROP_INIT_ASYNCH</span><span class="sxs-lookup"><span data-stu-id="9c7d4-135">DBPROP_INIT_ASYNCH</span></span>|<span data-ttu-id="9c7d4-136">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口支持异步启动。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-136">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports asynchronous initiation.</span></span><br /><br /> <span data-ttu-id="9c7d4-137">如果设置 DBPROP_INIT_ASYNCH 属性中的 DBPROPVAL_ASYNCH_INITIALIZE 位，将导致 IDBInitialize::Initialize 成为非阻止调用\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-137">Setting the DBPROPVAL_ASYNCH_INITIALIZE bit in the DBPROP_INIT_ASYNCH property causes **IDBInitialize::Initialize** to become a non-blocking call.</span></span> <span data-ttu-id="9c7d4-138">有关详细信息，请参阅[执行异步操作](../native-client/features/performing-asynchronous-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-138">For more information, see [Performing Asynchronous Operations](../native-client/features/performing-asynchronous-operations.md).</span></span>|  
|<span data-ttu-id="9c7d4-139">DBPROP_INIT_CATALOG</span><span class="sxs-lookup"><span data-stu-id="9c7d4-139">DBPROP_INIT_CATALOG</span></span>|<span data-ttu-id="9c7d4-140">要连接的现有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-140">Name of an existing [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database to which to connect.</span></span>|  
|<span data-ttu-id="9c7d4-141">DBPROP_INIT_DATASOURCE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-141">DBPROP_INIT_DATASOURCE</span></span>|<span data-ttu-id="9c7d4-142">运行 [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的服务器的网络名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-142">Network name of a server running an instance of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9c7d4-143">如果计算机上有多个 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 正在运行的实例，则为了连接到值的特定实例， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DBPROP_INIT_DATASOURCE 指定为\* \\ \ServerName\InstanceName\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-143">If there are multiple instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] running on the computer, in order to connect to a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] the value DBPROP_INIT_DATASOURCE is specified as *\\\ServerName\InstanceName*.</span></span> <span data-ttu-id="9c7d4-144">转义序列 \\\ 表示反斜杠自身。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-144">The escape sequence \\\ is used for backslash itself.</span></span>|  
|<span data-ttu-id="9c7d4-145">DBPROP_INIT_GENERALTIMEOUT</span><span class="sxs-lookup"><span data-stu-id="9c7d4-145">DBPROP_INIT_GENERALTIMEOUT</span></span>|<span data-ttu-id="9c7d4-146">指示请求之前的秒数，而不是数据源初始化和命令执行，超时。值0表示无限期超时。通过网络连接或在分布式或事务处理方案中运行的提供程序可以支持此属性，以便在长时间运行的请求时通知登记的组件超时。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-146">Indicates the number of seconds before a request, other than data source initialization and command execution, times out. A value of 0 indicates an infinite time-out. Providers that work over network connections or in distributed or transacted scenarios can support this property to advise an enlisted component to time-out in the event of a long-running request.</span></span> <span data-ttu-id="9c7d4-147">数据源初始化和命令执行的超时仍分别由 DBPROP_INIT_TIMEOUT 和 DBPROP_COMMANDTIMEOUT 控制。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-147">Time-outs for data source initialization and command execution remain governed by DBPROP_INIT_TIMEOUT and DBPROP_COMMANDTIMEOUT, respectively.</span></span><br /><br /> <span data-ttu-id="9c7d4-148">DBPROP_INIT_GENERALTIMEOUT 是只读的；如果尝试设置它，将返回 dwstatus 错误 DBPROPSTATUS_NOTSETTABLE\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-148">DBPROP_INIT_GENERALTIMEOUT is read-only, and if one tries to set it the *dwstatus* error of DBPROPSTATUS_NOTSETTABLE is returned.</span></span>|  
|<span data-ttu-id="9c7d4-149">DBPROP_INIT_HWND</span><span class="sxs-lookup"><span data-stu-id="9c7d4-149">DBPROP_INIT_HWND</span></span>|<span data-ttu-id="9c7d4-150">来自调用应用程序的 Windows 句柄。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-150">The Windows handle from the calling application.</span></span> <span data-ttu-id="9c7d4-151">如果允许提示用户输入初始化属性，则必须有有效的窗口句柄，才能显示初始化对话框。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-151">A valid window handle is required for the initialization dialog box displayed when prompting for initialization properties is allowed.</span></span>|  
|<span data-ttu-id="9c7d4-152">DBPROP_INIT_IMPERSONATION_LEVEL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-152">DBPROP_INIT_IMPERSONATION_LEVEL</span></span>|<span data-ttu-id="9c7d4-153">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口不支持模拟级别调整。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-153">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not support impersonation level adjustment.</span></span><br /><br /> <span data-ttu-id="9c7d4-154">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-154">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-155">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-155">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-156">DBPROP_INIT_LCID</span><span class="sxs-lookup"><span data-stu-id="9c7d4-156">DBPROP_INIT_LCID</span></span>|<span data-ttu-id="9c7d4-157">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口将验证区域设置 ID，如果区域设置 ID 不受支持或未安装在客户端上，它会返回错误。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-157">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider validates the locale ID and returns an error if the locale ID is not supported or is not installed on the client.</span></span>|  
|<span data-ttu-id="9c7d4-158">DBPROP_INIT_LOCATION</span><span class="sxs-lookup"><span data-stu-id="9c7d4-158">DBPROP_INIT_LOCATION</span></span>|<span data-ttu-id="9c7d4-159">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-160">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-160">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-161">DBPROP_INIT_MODE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-161">DBPROP_INIT_MODE</span></span>|<span data-ttu-id="9c7d4-162">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-162">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-163">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-163">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-164">DBPROP_INIT_PROMPT</span><span class="sxs-lookup"><span data-stu-id="9c7d4-164">DBPROP_INIT_PROMPT</span></span>|<span data-ttu-id="9c7d4-165">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口支持数据源初始化的所有提示模式。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-165">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports all prompting modes for data source initialization.</span></span> <span data-ttu-id="9c7d4-166">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口使用 DBPROMPT_NOPROMPT 作为此属性的默认设置。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-166">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses DBPROMPT_NOPROMPT as its default setting for the property.</span></span>|  
|<span data-ttu-id="9c7d4-167">DBPROP_INIT_PROTECTION_LEVEL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-167">DBPROP_INIT_PROTECTION_LEVEL</span></span>|<span data-ttu-id="9c7d4-168">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口不支持在与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的连接上使用保护级别。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-168">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not support a protection level on connections to instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="9c7d4-169">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在尝试设置属性值时返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-169">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED on an attempt to set the property value.</span></span> <span data-ttu-id="9c7d4-170">DBPROP 结构的 dwStatus 成员指示 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-170">The *dwStatus* member of the DBPROP Structure indicates DBPROPSTATUS_NOTSUPPORTED.</span></span>|  
|<span data-ttu-id="9c7d4-171">DBPROP_INIT_PROVIDERSTRING</span><span class="sxs-lookup"><span data-stu-id="9c7d4-171">DBPROP_INIT_PROVIDERSTRING</span></span>|<span data-ttu-id="9c7d4-172">请参阅本主题后面部分中的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口字符串。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-172">See the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider string later in this topic.</span></span>|  
|<span data-ttu-id="9c7d4-173">DBPROP_INIT_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="9c7d4-173">DBPROP_INIT_TIMEOUT</span></span>|<span data-ttu-id="9c7d4-174">如果无法在指定的秒数内建立与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的连接，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口将在初始化时返回错误。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-174">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error on initialization if a connection to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cannot be established within the number of seconds specified.</span></span>|  
  
 <span data-ttu-id="9c7d4-175">在特定于访问接口的属性集中 DBPROPSET_SQLSERVERDBINIT， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序定义了这些附加的初始化属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-175">In the provider-specific property set DBPROPSET_SQLSERVERDBINIT, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider defines these additional initialization properties.</span></span>  
  
|<span data-ttu-id="9c7d4-176">属性 ID</span><span class="sxs-lookup"><span data-stu-id="9c7d4-176">Property ID</span></span>|<span data-ttu-id="9c7d4-177">说明</span><span class="sxs-lookup"><span data-stu-id="9c7d4-177">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="9c7d4-178">SSPROP_AUTH_OLD_PASSWORD</span><span class="sxs-lookup"><span data-stu-id="9c7d4-178">SSPROP_AUTH_OLD_PASSWORD</span></span>|<span data-ttu-id="9c7d4-179">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-179">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-180">R/W：写</span><span class="sxs-lookup"><span data-stu-id="9c7d4-180">R/W: Write</span></span><br /><br /> <span data-ttu-id="9c7d4-181">默认值：VT_EMPTY</span><span class="sxs-lookup"><span data-stu-id="9c7d4-181">Default: VT_EMPTY</span></span><br /><br /> <span data-ttu-id="9c7d4-182">说明：当前或过期的密码。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-182">Description: The current or expired password.</span></span> <span data-ttu-id="9c7d4-183">有关详细信息，请参阅[以编程方式更改密码](../native-client/features/changing-passwords-programmatically.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-183">For more information, see [Changing Passwords Programmatically](../native-client/features/changing-passwords-programmatically.md).</span></span>|  
|<span data-ttu-id="9c7d4-184">SSPROP_INIT_APPNAME</span><span class="sxs-lookup"><span data-stu-id="9c7d4-184">SSPROP_INIT_APPNAME</span></span>|<span data-ttu-id="9c7d4-185">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-186">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-186">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-187">说明：客户端应用程序名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-187">Description: The client application name.</span></span>|  
|<span data-ttu-id="9c7d4-188">SSPROP_INIT_AUTOTRANSLATE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-188">SSPROP_INIT_AUTOTRANSLATE</span></span>|<span data-ttu-id="9c7d4-189">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-189">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="9c7d4-190">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-190">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-191">默认值：VARIANT_TRUE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-191">Default: VARIANT_TRUE</span></span><br /><br /> <span data-ttu-id="9c7d4-192">说明：OEM/ANSI 字符转换。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-192">Description: OEM/ANSI character conversion.</span></span><br /><br /> <span data-ttu-id="9c7d4-193">VARIANT_TRUE：[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口通过进行 Unicode 转换来转换在客户端和服务器之间发送的 ANSI 字符串，从而最大程度地减少匹配客户端和服务器上的代码页之间的扩展字符方面的问题：</span><span class="sxs-lookup"><span data-stu-id="9c7d4-193">VARIANT_TRUE: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider translates ANSI character strings sent between the client and server by converting through Unicode to minimize problems in matching extended characters between the code pages on the client and the server:</span></span><br /><br /> <span data-ttu-id="9c7d4-194">对于发送到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]char、varchar 或 text 变量、参数或列实例的客户端 DBTYPE_STR 数据，它们先使用客户端 ANSI 代码页 (ACP) 从字符转换到 Unicode，再使用服务器的 ACP 从 Unicode 转换到字符\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-194">Client DBTYPE_STR data sent to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]**char**, **varchar**, or **text** variable, parameter, or column is converted from character to Unicode using the client ANSI code page (ACP) and then converted from Unicode to character using the ACP of the server.</span></span><br /><br /> <span data-ttu-id="9c7d4-195">对于发送到客户端 DBTYPE_STR 变量的  char、varchar 或 text 数据，它们使用服务器 ACP 从字符转换为 Unicode，再使用客户端 ACP 从 Unicode 转换为字符[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] \*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-195">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **char**, **varchar**, or **text** data sent to a client DBTYPE_STR variable is converted from character to Unicode using the server ACP and then converted from Unicode to character using the client ACP.</span></span><br /><br /> <span data-ttu-id="9c7d4-196">这些转换由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口在客户端上执行。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-196">These conversions are performed on the client by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="9c7d4-197">这要求客户端上有在服务器上使用的同一 ACP。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-197">This requires that the same ACP used on the server be available on the client.</span></span><br /><br /> <span data-ttu-id="9c7d4-198">这些设置对于为下面这些传输而发生的转换无效：</span><span class="sxs-lookup"><span data-stu-id="9c7d4-198">These settings have no effect on the conversions that occur for these transfers:</span></span><br /><br /> <span data-ttu-id="9c7d4-199">发送到服务器上的 char、varchar 或 text 的 Unicode DBTYPE_WSTR 客户端数据\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-199">Unicode DBTYPE_WSTR client data sent to **char**, **varchar**, or **text** on the server.</span></span><br /><br /> <span data-ttu-id="9c7d4-200">发送到客户端上的 Unicode DBTYPE_WSTR 变量的 char、varchar 或 text 服务器数据\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-200">**char**, **varchar**, or **text** server data sent to a Unicode DBTYPE_WSTR variable on the client.</span></span><br /><br /> <span data-ttu-id="9c7d4-201">发送到服务器上的 Unicode nchar、nvarchar 或 ntext 的 ANSI DBTYPE_STR 客户端数据\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-201">ANSI DBTYPE_STR client data sent to Unicode **nchar**, **nvarchar**, or **ntext** on the server.</span></span><br /><br /> <span data-ttu-id="9c7d4-202">发送到客户端上的 ANSI DBTYPE_STR 变量的 Unicode char、varchar 或 text 服务器数据\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-202">Unicode **char**, **varchar**, or **text** server data sent to an ANSI DBTYPE_STR variable on the client.</span></span><br /><br /> <span data-ttu-id="9c7d4-203">VARIANT_FALSE：[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口不执行字符转换。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-203">VARIANT_FALSE: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not perform character translations.</span></span><br /><br /> <span data-ttu-id="9c7d4-204">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native client OLE DB 提供程序不会转换发送到服务器上的**char**、 **varchar**或**text**变量、参数或列的客户端 ANSI 字符 DBTYPE_STR 的数据。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-204">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not translate client ANSI character DBTYPE_STR data sent to **char**, **varchar**, or **text** variables, parameters, or columns on the server.</span></span> <span data-ttu-id="9c7d4-205">对于从服务器发送到客户端上的 DBTYPE_STR 变量的 char、varchar 或 text 数据，不执行转换\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-205">No translation is performed on **char**, **varchar**, or **text** data sent from the server to DBTYPE_STR variables on the client.</span></span><br /><br /> <span data-ttu-id="9c7d4-206">如果客户端和 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例正在使用不同的 ACP，可能会错误地解释扩展字符。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-206">If the client and the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are using different ACPs, extended characters can be misinterpreted.</span></span>|  
|<span data-ttu-id="9c7d4-207">SSPROP_INIT_CURRENTLANGUAGE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-207">SSPROP_INIT_CURRENTLANGUAGE</span></span>|<span data-ttu-id="9c7d4-208">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-208">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-209">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-209">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-210">说明：[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 语言名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-210">Description: A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] language name.</span></span> <span data-ttu-id="9c7d4-211">标识用于系统消息选择和格式化的语言。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-211">Identifies the language used for system message selection and formatting.</span></span> <span data-ttu-id="9c7d4-212">必须在运行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的计算机上安装该语言，否则数据源初始化将失败。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-212">The language must be installed on the computer running an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] or data source initialization fails.</span></span>|  
|<span data-ttu-id="9c7d4-213">SSPROP_INIT_DATATYPECOMPATIBILITY</span><span class="sxs-lookup"><span data-stu-id="9c7d4-213">SSPROP_INIT_DATATYPECOMPATIBILITY</span></span>|<span data-ttu-id="9c7d4-214">类型：VT_UI2</span><span class="sxs-lookup"><span data-stu-id="9c7d4-214">Type: VT_UI2</span></span><br /><br /> <span data-ttu-id="9c7d4-215">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-215">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-216">默认值：0</span><span class="sxs-lookup"><span data-stu-id="9c7d4-216">Default: 0</span></span><br /><br /> <span data-ttu-id="9c7d4-217">说明：在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 和 ActiveX 数据对象 (ADO) 应用程序之间实现数据类型兼容。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-217">Description: Enables data type compatibility between [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and ActiveX Data Object (ADO) applications.</span></span> <span data-ttu-id="9c7d4-218">如果使用默认值 0，则数据类型处理将默认采用由访问接口使用的方案。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-218">If the default value of 0 is used, data type handling defaults to that used by the provider.</span></span> <span data-ttu-id="9c7d4-219">如果使用值 80，则数据类型处理仅使用 [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] 数据类型。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-219">If the value of 80 is used, data type handling uses only [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] data types.</span></span> <span data-ttu-id="9c7d4-220">有关详细信息，请参阅将[ADO 用于 SQL Server Native Client](../native-client/applications/using-ado-with-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-220">For more information, see [Using ADO with SQL Server Native Client](../native-client/applications/using-ado-with-sql-server-native-client.md).</span></span>|  
|<span data-ttu-id="9c7d4-221">SSPROP_INIT_ENCRYPT</span><span class="sxs-lookup"><span data-stu-id="9c7d4-221">SSPROP_INIT_ENCRYPT</span></span>|<span data-ttu-id="9c7d4-222">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-222">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="9c7d4-223">R/W：读/写</span><span class="sxs-lookup"><span data-stu-id="9c7d4-223">R/W: Read/Write</span></span><br /><br /> <span data-ttu-id="9c7d4-224">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-224">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="9c7d4-225">说明：若要加密通过网络传输的数据，应将 SSPROP_INIT_ENCRYPT 属性设置为 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-225">Description: To encrypt the data going over the network, SSPROP_INIT_ENCRYPT property is set to VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="9c7d4-226">如果打开了“启用协议加密”，则不论 SSPROP_INIT_ENCRYPT 如何设置，始终都会进行加密。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-226">If Enable Protocol Encryption is on, encryption will always occur, regardless of the setting of SSPROP_INIT_ENCRYPT.</span></span> <span data-ttu-id="9c7d4-227">如果将它关闭，并将 SSPROP_INIT_ENCRYPT 设置为 VARIANT_TRUE，那么将进行加密。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-227">If it is off and SSPROP_INIT_ENCRYPT is set to VARIANT_TRUE, then encryption will occur.</span></span><br /><br /> <span data-ttu-id="9c7d4-228">如果关闭“启用协议加密”，并将 SSPROP_INIT_ENCRYPT 设置为 VARIANT_FALSE，那么不进行加密。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-228">If Enable Protocol Encryption is off and SSPROP_INIT_ENCRYPT is set to VARIANT_FALSE, then no encryption occurs.</span></span>|  
|<span data-ttu-id="9c7d4-229">SSPROP_INIT_FAILOVERPARTNER</span><span class="sxs-lookup"><span data-stu-id="9c7d4-229">SSPROP_INIT_FAILOVERPARTNER</span></span>|<span data-ttu-id="9c7d4-230">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-230">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-231">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-231">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-232">说明：指定用于数据库镜像的故障转移伙伴的名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-232">Description: Specifies the name of the failover partner for database mirroring.</span></span> <span data-ttu-id="9c7d4-233">它是初始化属性，并且只能在初始化之前设置。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-233">It is an initialization property and can only be set before initialization.</span></span> <span data-ttu-id="9c7d4-234">在初始化之后，它将返回由主服务器返回的故障转移伙伴（如果有）。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-234">After initialization it will return the failover partner, if any, returned by the primary server.</span></span><br /><br /> <span data-ttu-id="9c7d4-235">这允许智能应用程序缓存最新确定的备份服务器，但这样的应用程序应当知道，仅当初次建立（对于池连接则是重置）连接时该信息才会更新，因而在经过长时间的连接后可能会过时。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-235">This allows a smart application to cache the most recently determined backup server, but such applications should be aware that the information is only updated when the connection is first established (or reset, if pooled) and can become out of date for long term connections.</span></span><br /><br /> <span data-ttu-id="9c7d4-236">建立连接之后，应用程序可以查询该属性，以确定故障转移伙伴的标识。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-236">After making the connection, the application can query this attribute to determine the identity of the failover partner.</span></span> <span data-ttu-id="9c7d4-237">如果主服务器没有故障转移伙伴，则此属性将返回空字符串。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-237">If the primary server has no failover partner this property will return an empty string.</span></span> <span data-ttu-id="9c7d4-238">有关详细信息，请参阅[使用数据库镜像](../native-client/features/using-database-mirroring.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-238">For more information, see [Using Database Mirroring](../native-client/features/using-database-mirroring.md).</span></span>|  
|<span data-ttu-id="9c7d4-239">SSPROP_INIT_FILENAME</span><span class="sxs-lookup"><span data-stu-id="9c7d4-239">SSPROP_INIT_FILENAME</span></span>|<span data-ttu-id="9c7d4-240">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-240">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-241">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-241">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-242">说明：指定可附加数据库的主文件名。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-242">Description: Specifies the primary file name of an attachable database.</span></span> <span data-ttu-id="9c7d4-243">附加此数据库并使其成为连接的默认数据库。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-243">This database is attached and becomes the default database for the connection.</span></span> <span data-ttu-id="9c7d4-244">若要使用 SSPROP_INIT_FILENAME，必须指定该数据库的名称作为初始化属性 DBPROP_INIT_CATALOG 的值。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-244">To use SSPROP_INIT_FILENAME, you must specify the name of the database as the value of the initialization property DBPROP_INIT_CATALOG.</span></span> <span data-ttu-id="9c7d4-245">如果该数据库名称不存在，它将查找在 SSPROP_INIT_FILENAME 中指定的主文件名，并使用在 DBPROP_INIT_CATALOG 中指定的名称来附加该数据库。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-245">If the database name does not exist, then it looks for the primary file name specified in SSPROP_INIT_FILENAME and attaches that database with the name specified in DBPROP_INIT_CATALOG.</span></span> <span data-ttu-id="9c7d4-246">如果数据库是以前附加的，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 不重新附加它。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-246">If the database was previously attached, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not reattach it.</span></span>|  
|<span data-ttu-id="9c7d4-247">SSPROP_INIT_MARSCONNECTION</span><span class="sxs-lookup"><span data-stu-id="9c7d4-247">SSPROP_INIT_MARSCONNECTION</span></span>|<span data-ttu-id="9c7d4-248">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-248">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="9c7d4-249">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-249">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-250">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-250">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="9c7d4-251">说明：指定是否对连接启用多个活动结果集 (MARS)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-251">Description: Specifies if Multiple Active Result Sets (MARS) are enabled for the connection.</span></span> <span data-ttu-id="9c7d4-252">必须在与数据库建立连接之前将该选项设置为 true。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-252">This option must be set to true before a connection is made to the database.</span></span> <span data-ttu-id="9c7d4-253">有关详细信息，请参阅[使用多个活动的结果集 (MARS)](../native-client/features/using-multiple-active-result-sets-mars.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-253">For more information, see [Using Multiple Active Result Sets &#40;MARS&#41;](../native-client/features/using-multiple-active-result-sets-mars.md).</span></span>|  
|<span data-ttu-id="9c7d4-254">SSPROP_INIT_NETWORKADDRESS</span><span class="sxs-lookup"><span data-stu-id="9c7d4-254">SSPROP_INIT_NETWORKADDRESS</span></span>|<span data-ttu-id="9c7d4-255">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-255">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-256">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-256">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-257">说明：运行由 DBPROP_INIT_DATASOURCE 属性指定的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的服务器的网络地址。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-257">Description: The network address of the server running an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specified by the DBPROP_INIT_DATASOURCE property.</span></span>|  
|<span data-ttu-id="9c7d4-258">SSPROP_INIT_NETWORKLIBRARY</span><span class="sxs-lookup"><span data-stu-id="9c7d4-258">SSPROP_INIT_NETWORKLIBRARY</span></span>|<span data-ttu-id="9c7d4-259">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-259">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-260">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-260">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-261">说明：用于与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例通信的网络库 (DLL) 的名称。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-261">Description: The name of the networklibrary (DLL) used to communicate with an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9c7d4-262">该名称不应当包含路径或 .dll 文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-262">The name should not include the path or the .dll file name extension.</span></span><br /><br /> <span data-ttu-id="9c7d4-263">可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 客户端配置实用工具来自定义其默认值。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-263">The default can be customized using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Client Configuration Utility.</span></span> <span data-ttu-id="9c7d4-264">**注意：** 此属性仅支持 TCP 和命名管道。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-264">**Note:**  Only TCP and Named Pipes are supported by this property.</span></span> <span data-ttu-id="9c7d4-265">如果该属性在使用时带有前缀，最后将得到导致错误的双前缀，因为该属性用于在内部生成前缀。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-265">If you use this property with a prefix, you end up with a double prefix which results in an error, because the property is used to generate a prefix internally.</span></span>|  
|<span data-ttu-id="9c7d4-266">SSPROP_INIT_PACKETSIZE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-266">SSPROP_INIT_PACKETSIZE</span></span>|<span data-ttu-id="9c7d4-267">类型：VT_I4</span><span class="sxs-lookup"><span data-stu-id="9c7d4-267">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="9c7d4-268">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-268">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-269">说明：以字节为单位表示的网络数据包大小。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-269">Description: A network packet size in bytes.</span></span> <span data-ttu-id="9c7d4-270">数据包大小属性值必须介于 512 和 32,767 之间。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-270">The packet size property value must be between 512 and 32,767.</span></span> <span data-ttu-id="9c7d4-271">默认的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口网络数据包大小是 4,096。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-271">The default [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider network packet size is 4,096.</span></span>|  
|<span data-ttu-id="9c7d4-272">SSPROP_INIT_TAGCOLUMNCOLLATION</span><span class="sxs-lookup"><span data-stu-id="9c7d4-272">SSPROP_INIT_TAGCOLUMNCOLLATION</span></span>|<span data-ttu-id="9c7d4-273">类型：BOOL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-273">Type: BOOL</span></span><br /><br /> <span data-ttu-id="9c7d4-274">R/W：写</span><span class="sxs-lookup"><span data-stu-id="9c7d4-274">R/W: Write</span></span><br /><br /> <span data-ttu-id="9c7d4-275">默认值：FALSE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-275">Default: FALSE</span></span><br /><br /> <span data-ttu-id="9c7d4-276">说明：使用服务器端游标时，在数据库更新期间使用。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-276">Description: Is used during a database update when server-side cursors are used.</span></span> <span data-ttu-id="9c7d4-277">该属性用从服务器而不是客户端上的代码页获得的排序规则信息来标记数据。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-277">This property tags the data with collation information obtained from the server instead of the code page on the client.</span></span> <span data-ttu-id="9c7d4-278">当前，该属性仅供分布式查询进程使用，因为它知道目标数据的排序规则，并能正确转换它。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-278">Currently, this property is used only by the distributed query process because it knows the collation of destination data and converts it correctly.</span></span>|  
|<span data-ttu-id="9c7d4-279">SSPROP_INIT_TRUST_SERVER_CERTIFICATE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-279">SSPROP_INIT_TRUST_SERVER_CERTIFICATE</span></span>|<span data-ttu-id="9c7d4-280">键入：VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9c7d4-280">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="9c7d4-281">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-281">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-282">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="9c7d4-282">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="9c7d4-283">说明：用于启用或禁用服务器证书验证。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-283">Description: Used to enable or disable server certificate validation.</span></span> <span data-ttu-id="9c7d4-284">该属性是读/写属性，但在已建立连接之后尝试设置它将导致错误。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-284">This property is read/write, but attempting to set it after a connection has been established will result in an error.</span></span><br /><br /> <span data-ttu-id="9c7d4-285">如果客户端配置为要求进行证书验证，则忽略该属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-285">This property is ignored if the client is configured to require certificate validation.</span></span> <span data-ttu-id="9c7d4-286">但是，应用程序可以将它与 SSPROP_INIT_ENCRYPT 一起使用，以保证即使将客户端配置为不要求加密，并且客户端上不提供证书，仍然会对应用程序与服务器之间的连接进行加密。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-286">However, an application can use it together with SSPROP_INIT_ENCRYPT to guarantee that its connection to the server is encrypted, even if the client is configured not to require encryption and no certificate is provisioned on the client.</span></span><br /><br /> <span data-ttu-id="9c7d4-287">客户端应用程序可以在打开连接后查询此属性，以确定使用的实际加密和验证设置。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-287">Client applications can query this property after a connection has been opened to determine the actual encryption and validation settings in use.</span></span> <span data-ttu-id="9c7d4-288">**注意：** 使用不带证书验证的加密可针对数据包探查提供部分保护，但不能防止中间人攻击。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-288">**Note:**  Using encryption without certificate validation provides partial protection against packet sniffing, but it does not protect against man-in-the-middle attacks.</span></span> <span data-ttu-id="9c7d4-289">它只是允许对发送到服务器的登录名和数据进行加密，而无需验证服务器证书。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-289">It simply allows for encrypting the login and data sent to the server without validating the server certificate.</span></span> <br /><br /> <span data-ttu-id="9c7d4-290">有关详细信息，请参阅[使用加密但不验证](../native-client/features/using-encryption-without-validation.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-290">For more information, see [Using Encryption Without Validation](../native-client/features/using-encryption-without-validation.md).</span></span>|  
|<span data-ttu-id="9c7d4-291">SSPROP_INIT_USEPROCFORPREP</span><span class="sxs-lookup"><span data-stu-id="9c7d4-291">SSPROP_INIT_USEPROCFORPREP</span></span>|<span data-ttu-id="9c7d4-292">类型：VT_I4</span><span class="sxs-lookup"><span data-stu-id="9c7d4-292">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="9c7d4-293">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-293">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-294">默认值：SSPROPVAL_USEPROCFORPREP_ON</span><span class="sxs-lookup"><span data-stu-id="9c7d4-294">Default: SSPROPVAL_USEPROCFORPREP_ON</span></span><br /><br /> <span data-ttu-id="9c7d4-295">说明：[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 存储过程的使用情况。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-295">Description: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stored procedure use.</span></span> <span data-ttu-id="9c7d4-296">定义 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 临时存储过程的使用，以支持 ICommandPrepare 接口\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-296">Defines the use of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] temporary stored procedures to support the **ICommandPrepare** interface.</span></span> <span data-ttu-id="9c7d4-297">仅当连接到 SQL Server 6.5 时，该属性才有意义。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-297">This property was meaningful only when connecting to SQL Server 6.5.</span></span> <span data-ttu-id="9c7d4-298">对于更高版本，将忽略该属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-298">The property is ignored for later versions.</span></span><br /><br /> <span data-ttu-id="9c7d4-299">SSPROPVAL_USEPROCFORPREP_OFF：准备命令时，不创建临时存储过程。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-299">SSPROPVAL_USEPROCFORPREP_OFF: A temporary stored procedure is not created when a command is prepared.</span></span><br /><br /> <span data-ttu-id="9c7d4-300">SSPROPVAL_USEPROCFORPREP_ON：准备命令时，创建临时存储过程。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-300">SSPROPVAL_USEPROCFORPREP_ON: A temporary stored procedure is created when a command is prepared.</span></span> <span data-ttu-id="9c7d4-301">释放会话时，删除临时存储过程。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-301">The temporary stored procedures are dropped when the session is released.</span></span><br /><br /> <span data-ttu-id="9c7d4-302">SSPROPVAL_USEPROCFORPREP_ON_DROP：准备命令时，创建临时存储过程。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-302">SSPROPVAL_USEPROCFORPREP_ON_DROP: A temporary stored procedure is created when a command is prepared.</span></span> <span data-ttu-id="9c7d4-303">使用 ICommandPrepare::Unprepare 撤销命令时，使用 ICommandText::SetCommandText 为命令对象指定新命令时，或释放对命令的所有应用程序引用时，删除该过程\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-303">The procedure is dropped when the command is unprepared with **ICommandPrepare::Unprepare**, when a new command is specified for the command object with **ICommandText::SetCommandText**, or when all application references to the command are released.</span></span>|  
|<span data-ttu-id="9c7d4-304">SSPROP_INIT_WSID</span><span class="sxs-lookup"><span data-stu-id="9c7d4-304">SSPROP_INIT_WSID</span></span>|<span data-ttu-id="9c7d4-305">键入：VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9c7d4-305">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="9c7d4-306">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="9c7d4-306">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="9c7d4-307">说明：用于标识工作站的字符串。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-307">Description: A string identifying the workstation.</span></span>|  
  
 <span data-ttu-id="9c7d4-308">在特定于访问接口的属性集中 DBPROPSET_SQLSERVERDATASOURCEINFO， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序定义了其他属性; 有关详细信息，请参阅[数据源信息属性](data-source-information-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-308">In the provider-specific property set DBPROPSET_SQLSERVERDATASOURCEINFO, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider defines the additional properties; see [Data Source Information Properties](data-source-information-properties.md) for more information.</span></span>  
  
## <a name="the-sql-server-native-client-ole-db-provider-string"></a><span data-ttu-id="9c7d4-309">SQL Server Native Client OLE DB 访问接口字符串</span><span class="sxs-lookup"><span data-stu-id="9c7d4-309">The SQL Server Native Client OLE DB Provider String</span></span>  
 <span data-ttu-id="9c7d4-310">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口可以识别访问接口字符串属性值中类似 ODBC 的语法。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-310">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider recognizes an ODBC-like syntax in provider string property values.</span></span> <span data-ttu-id="9c7d4-311">在建立与 OLE DB 数据源的连接时，访问接口字符串属性将作为 OLE DB 初始化属性 DBPROP_INIT_PROVIDERSTRING 的值提供。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-311">The provider string property is provided as the value of the OLE DB initialization property DBPROP_INIT_PROVIDERSTRING when a connection is established to the OLE DB data source.</span></span> <span data-ttu-id="9c7d4-312">该属性指定在实现与 OLE DB 数据源的连接时所需的特定于 OLE DB 访问接口的连接数据。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-312">This property specifies OLE DB provider-specific connection data required to implement a connection to the OLE DB data source.</span></span> <span data-ttu-id="9c7d4-313">在字符串中，各元素是使用分号分隔的。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-313">Within the string, elements are delimited by using a semicolon.</span></span> <span data-ttu-id="9c7d4-314">字符串中的最后一个元素必须以分号结束。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-314">The final element in the string must be terminated with a semicolon.</span></span> <span data-ttu-id="9c7d4-315">每个元素均由一个关键字、一个等号字符和在初始化时传递的值组成。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-315">Each element consists of a keyword, an equal sign character, and the value passed on initialization.</span></span> <span data-ttu-id="9c7d4-316">例如：</span><span class="sxs-lookup"><span data-stu-id="9c7d4-316">For example:</span></span>  
  
```  
Server=MyServer;UID=MyUserName;  
```  
  
 <span data-ttu-id="9c7d4-317">使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口，使用者永远都不需要使用访问接口字符串属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-317">With the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider, the consumer never needs to use the provider string property.</span></span> <span data-ttu-id="9c7d4-318">通过使用 OLE DB 或特定于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 访问接口的初始化属性，使用者可以设置在访问接口字符串中反映的任何初始化属性。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-318">The consumer can set any initialization property reflected in the provider string by using either OLE DB or [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific initialization properties.</span></span>  
  
 <span data-ttu-id="9c7d4-319">有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序中可用的关键字列表，请参阅将[连接字符串关键字用于 SQL Server Native Client](../native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md)。</span><span class="sxs-lookup"><span data-stu-id="9c7d4-319">For a list of the keywords available in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider, see [Using Connection String Keywords with SQL Server Native Client](../native-client/applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9c7d4-320">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9c7d4-320">See Also</span></span>  
 [<span data-ttu-id="9c7d4-321">数据源对象 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="9c7d4-321">Data Source Objects &#40;OLE DB&#41;</span></span>](data-source-objects-ole-db.md)  
  
  
