---
title: 数据源属性 (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client OLE DB provider, data source properties
- properties [OLE DB]
- data source properties [OLE DB]
- OLE DB data source properties [SQL Server Native Client]
ms.assetid: 6e14fefc-4e0b-4847-a833-4cf0abe65d50
author: rothja
ms.author: jroth
ms.openlocfilehash: b3c3c2d34897b1e88894f67118fe51bd35a01089
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693276"
---
# <a name="data-source-properties-ole-db"></a><span data-ttu-id="270e9-102">数据源属性 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="270e9-102">Data Source Properties (OLE DB)</span></span>
  <span data-ttu-id="270e9-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序按如下方式实现数据源属性。</span><span class="sxs-lookup"><span data-stu-id="270e9-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements data source properties as follows.</span></span>  
  
|<span data-ttu-id="270e9-104">属性 ID</span><span class="sxs-lookup"><span data-stu-id="270e9-104">Property ID</span></span>|<span data-ttu-id="270e9-105">说明</span><span class="sxs-lookup"><span data-stu-id="270e9-105">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="270e9-106">DBPROP_CURRENTCATALOG</span><span class="sxs-lookup"><span data-stu-id="270e9-106">DBPROP_CURRENTCATALOG</span></span>|<span data-ttu-id="270e9-107">R/W：读/写 默认值：无</span><span class="sxs-lookup"><span data-stu-id="270e9-107">R/W: Read/write Default: None</span></span><br /><br /> <span data-ttu-id="270e9-108">说明：的值 DBPROP_CURRENTCATALOG 报告 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 本机客户端 OLE DB 提供程序会话的当前数据库。</span><span class="sxs-lookup"><span data-stu-id="270e9-108">Description: The value of DBPROP_CURRENTCATALOG reports the current database for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="270e9-109">设置该属性值与使用 [!INCLUDE[tsql](../../includes/tsql-md.md)] USE database 语句设置当前数据库的效果相同\*\*。</span><span class="sxs-lookup"><span data-stu-id="270e9-109">Setting the property value has the identical effect as setting the current database by using the [!INCLUDE[tsql](../../includes/tsql-md.md)] USE *database* statement.</span></span><br /><br /> <span data-ttu-id="270e9-110">从 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 开始，如果调用 [sp_defaultdb](/sql/relational-databases/system-stored-procedures/sp-defaultdb-transact-sql)，并以小写字母指定数据库名称，即使该数据库名称最初是使用大小写混合形式创建的，DBPROP_CURRENTCATALOG 仍将以小写字母返回该名称。</span><span class="sxs-lookup"><span data-stu-id="270e9-110">Beginning with [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], if you call [sp_defaultdb](/sql/relational-databases/system-stored-procedures/sp-defaultdb-transact-sql) and specify the database name in lower case, even if the database was originally created with a mixed case name, DBPROP_CURRENTCATALOG will return the name in lower case.</span></span> <span data-ttu-id="270e9-111">对于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的早期版本，DBPROP_CURRENTCATALOG 将返回预期的大小写混合形式。</span><span class="sxs-lookup"><span data-stu-id="270e9-111">With previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], DBPROP_CURRENTCATALOG will return the expected mixed case.</span></span>|  
|<span data-ttu-id="270e9-112">DBPROP_MULTIPLECONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="270e9-112">DBPROP_MULTIPLECONNECTIONS</span></span>|<span data-ttu-id="270e9-113">R/W：读/写 默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="270e9-113">R/W: Read/write Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="270e9-114">说明：如果将 DBPROP_MULTIPLECONNECTIONS 设置为 VARIANT_TRUE，当连接运行的命令未生成行集或生成的行集不是服务器游标时，执行其他命令时将新建一个连接，以便执行该命令。</span><span class="sxs-lookup"><span data-stu-id="270e9-114">Description: If the connection is running a command that does not produce a rowset or produces a rowset that is not a server cursor and you execute another command, a new connection will be created to execute the new command if DBPROP_MULTIPLECONNECTIONS is VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="270e9-115">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]如果 DBPROP_MULTIPLECONNECTION VARIANT_FALSE 或者如果某个事务在连接上处于活动状态，则 Native Client OLE DB 提供程序将不会创建另一个连接。</span><span class="sxs-lookup"><span data-stu-id="270e9-115">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider will not create another connection if DBPROP_MULTIPLECONNECTION is VARIANT_FALSE or if a transaction is active on the connection.</span></span> <span data-ttu-id="270e9-116">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]如果 DBPROP_MULTIPLECONNECTIONS 是 VARIANT_FALSE，则 Native Client OLE DB 提供程序将返回 DB_E_OBJECTOPEN，并且如果存在活动事务，则返回 E_FAIL。</span><span class="sxs-lookup"><span data-stu-id="270e9-116">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_E_OBJECTOPEN if DBPROP_MULTIPLECONNECTIONS is VARIANT_FALSE and returns E_FAIL if there is an active transaction.</span></span> <span data-ttu-id="270e9-117">事务和锁定是在每个连接的基础上通过 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 来管理的。</span><span class="sxs-lookup"><span data-stu-id="270e9-117">Transactions and locking are managed by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on a per connection basis.</span></span> <span data-ttu-id="270e9-118">如果生成第二个连接，则该独立连接上的命令不能共享锁定。</span><span class="sxs-lookup"><span data-stu-id="270e9-118">If a second connection is generated, the commands on the separate connections do not share locks.</span></span> <span data-ttu-id="270e9-119">若要确保一个命令不会阻塞另一个命令，请对其他命令所请求的行保持锁定。</span><span class="sxs-lookup"><span data-stu-id="270e9-119">To ensure that one command does not block another, hold locks on rows requested by the other command.</span></span> <span data-ttu-id="270e9-120">当创建多个会话时，将同样保持该锁定。</span><span class="sxs-lookup"><span data-stu-id="270e9-120">This also holds true when creating multiple sessions.</span></span><br /><br /> <span data-ttu-id="270e9-121">每个会话都具有一个单独的连接。</span><span class="sxs-lookup"><span data-stu-id="270e9-121">Each session has a separate connection.</span></span>|  
  
 <span data-ttu-id="270e9-122">在特定于访问接口的属性集中 DBPROPSET_SQLSERVERDATASOURCE， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序定义以下附加数据源属性。</span><span class="sxs-lookup"><span data-stu-id="270e9-122">In the provider-specific property set DBPROPSET_SQLSERVERDATASOURCE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider defines the following additional data source properties.</span></span>  
  
|<span data-ttu-id="270e9-123">属性 ID</span><span class="sxs-lookup"><span data-stu-id="270e9-123">Property ID</span></span>|<span data-ttu-id="270e9-124">说明</span><span class="sxs-lookup"><span data-stu-id="270e9-124">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="270e9-125">SSPROP_ENABLEFASTLOAD</span><span class="sxs-lookup"><span data-stu-id="270e9-125">SSPROP_ENABLEFASTLOAD</span></span>|<span data-ttu-id="270e9-126">R/W：读/写 默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="270e9-126">R/W: Read/write Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="270e9-127">说明：若要从内存启用大容量复制，应将 SSPROP_ENABLEFASTLOAD 属性设置为 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="270e9-127">Description: To enable bulk copy from memory, SSPROP_ENABLEFASTLOAD property should be set to VARIANT_TRUE.</span></span> <span data-ttu-id="270e9-128">对数据源设置该属性之后，使用者可通过新建的会话访问 [IRowsetFastLoad](../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) 接口。</span><span class="sxs-lookup"><span data-stu-id="270e9-128">With this property set on the data source, the newly created session allows consumer access to the [IRowsetFastLoad](../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface.</span></span><br /><br /> <span data-ttu-id="270e9-129">如果将该属性设置为 VARIANT_TRUE，则可以通过请求 IID_IRowsetFastLoad 接口或将 SSPROP_IRowsetFastLoad 设置为 VARIANT_TRUE，利用 IOpenRowset::OpenRowset 来使用 IRowsetFastLoad 接口\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="270e9-129">If the property is set to VARIANT_TRUE, **IRowsetFastLoad** interface is available through **IOpenRowset::OpenRowset** by requesting the **IID_IRowsetFastLoad** interface or by setting **SSPROP_IRowsetFastLoad** to VARIANT_TRUE.</span></span>|  
|<span data-ttu-id="270e9-130">SSPROP_ENABLEBULKCOPY</span><span class="sxs-lookup"><span data-stu-id="270e9-130">SSPROP_ENABLEBULKCOPY</span></span>|<span data-ttu-id="270e9-131">R/W：读/写 默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="270e9-131">R/W: Read/write Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="270e9-132">说明：若要从文件启用大容量复制，应将 SSPROP_ENABLEBULKCOPY 属性设置为 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="270e9-132">Description: To enable bulk copy from files, SSPROP_ENABLEBULKCOPY property should be set to VARIANT_TRUE.</span></span> <span data-ttu-id="270e9-133">对数据源设置该属性之后，使用者可以访问与会话位于同一级别的 IBCPSession 接口。</span><span class="sxs-lookup"><span data-stu-id="270e9-133">With this property set on the data source, consumer access to the IBCPSession interface is available under the same level as Sessions.</span></span><br /><br /> <span data-ttu-id="270e9-134">此外，还必须将 SSPROP_IRowsetFastLoad 设置为 VARIANT_TRUE。</span><span class="sxs-lookup"><span data-stu-id="270e9-134">SSPROP_IRowsetFastLoad must also be set to VARIANT_TRUE.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="270e9-135">另请参阅</span><span class="sxs-lookup"><span data-stu-id="270e9-135">See Also</span></span>  
 [<span data-ttu-id="270e9-136">数据源对象 (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="270e9-136">Data Source Objects &#40;OLE DB&#41;</span></span>](../../relational-databases/native-client-ole-db-data-source-objects/data-source-objects-ole-db.md)  
  
  
