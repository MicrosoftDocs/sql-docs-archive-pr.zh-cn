---
title: Broker:Conversation 事件类 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
topic_type:
- apiref
helpviewer_keywords:
- Broker:Conversation event class
ms.assetid: 784707b5-cc67-46a3-8ae6-8f8ecf4b27c0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 921b23c6aab8be27534d67d7a85bd7adc8258409
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691724"
---
# <a name="brokerconversation-event-class"></a><span data-ttu-id="93dbe-102">Broker:Conversation 事件类</span><span class="sxs-lookup"><span data-stu-id="93dbe-102">Broker:Conversation Event Class</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-103">生成 **Broker:Conversation** 事件来报告 Service Broker 会话的进度。</span><span class="sxs-lookup"><span data-stu-id="93dbe-103">generates a **Broker:Conversation** event to report the progress of a Service Broker conversation.</span></span>  
  
## <a name="brokerconversation-event-class-data-columns"></a><span data-ttu-id="93dbe-104">Broker:Conversation 事件类的数据列</span><span class="sxs-lookup"><span data-stu-id="93dbe-104">Broker:Conversation Event Class Data Columns</span></span>  
  
|<span data-ttu-id="93dbe-105">数据列</span><span class="sxs-lookup"><span data-stu-id="93dbe-105">Data column</span></span>|<span data-ttu-id="93dbe-106">类型</span><span class="sxs-lookup"><span data-stu-id="93dbe-106">Type</span></span>|<span data-ttu-id="93dbe-107">说明</span><span class="sxs-lookup"><span data-stu-id="93dbe-107">Description</span></span>|<span data-ttu-id="93dbe-108">列号</span><span class="sxs-lookup"><span data-stu-id="93dbe-108">Column number</span></span>|<span data-ttu-id="93dbe-109">可筛选</span><span class="sxs-lookup"><span data-stu-id="93dbe-109">Filterable</span></span>|  
|-----------------|----------|-----------------|-------------------|----------------|  
|<span data-ttu-id="93dbe-110">ApplicationName </span><span class="sxs-lookup"><span data-stu-id="93dbe-110">**ApplicationName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-111">客户端应用程序的名称，该客户端应用程序创建了指向 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的连接。</span><span class="sxs-lookup"><span data-stu-id="93dbe-111">The name of the client application that created the connection to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="93dbe-112">该列由应用程序传递的值填充，而不是由所显示的程序名填充。</span><span class="sxs-lookup"><span data-stu-id="93dbe-112">This column is populated with the values passed by the application instead of the displayed name of the program.</span></span>|<span data-ttu-id="93dbe-113">10</span><span class="sxs-lookup"><span data-stu-id="93dbe-113">10</span></span>|<span data-ttu-id="93dbe-114">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-114">Yes</span></span>|  
|<span data-ttu-id="93dbe-115">**ClientProcessID**</span><span class="sxs-lookup"><span data-stu-id="93dbe-115">**ClientProcessID**</span></span>|`int`|<span data-ttu-id="93dbe-116">由主机分配给正在运行客户端应用程序的进程的 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-116">The ID assigned by the host computer to the process where the client application is running.</span></span> <span data-ttu-id="93dbe-117">如果客户端提供了客户端进程 ID，则填充此数据列。</span><span class="sxs-lookup"><span data-stu-id="93dbe-117">This data column is populated if the client process ID is provided by the client.</span></span>|<span data-ttu-id="93dbe-118">9</span><span class="sxs-lookup"><span data-stu-id="93dbe-118">9</span></span>|<span data-ttu-id="93dbe-119">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-119">Yes</span></span>|  
|<span data-ttu-id="93dbe-120">**DatabaseID**</span><span class="sxs-lookup"><span data-stu-id="93dbe-120">**DatabaseID**</span></span>|`int`|<span data-ttu-id="93dbe-121">由 USE *database* 语句指定的数据库的 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-121">The ID of the database that is specified by the USE *database* statement.</span></span> <span data-ttu-id="93dbe-122">如果未发出 USE *database*语句，则为默认数据库的 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-122">If no USE *database*statement has been issued, the ID of the default database.</span></span> [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="93dbe-123">数据列而且服务器可用，则 **ServerName** 将显示数据库名。</span><span class="sxs-lookup"><span data-stu-id="93dbe-123">displays the name of the database if the **ServerName** data column is captured in the trace and the server is available.</span></span> <span data-ttu-id="93dbe-124">使用**DB_ID**函数确定数据库的值。</span><span class="sxs-lookup"><span data-stu-id="93dbe-124">Determine the value for a database by using the **DB_ID** function.</span></span>|<span data-ttu-id="93dbe-125">3</span><span class="sxs-lookup"><span data-stu-id="93dbe-125">3</span></span>|<span data-ttu-id="93dbe-126">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-126">Yes</span></span>|  
|<span data-ttu-id="93dbe-127">**EventClass**</span><span class="sxs-lookup"><span data-stu-id="93dbe-127">**EventClass**</span></span>|`int`|<span data-ttu-id="93dbe-128">捕获的事件类的类型。</span><span class="sxs-lookup"><span data-stu-id="93dbe-128">The type of event class captured.</span></span> <span data-ttu-id="93dbe-129">对于 **Broker:Conversation** ，始终为 **124**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-129">Always **124** for **Broker:Conversation**.</span></span>|<span data-ttu-id="93dbe-130">27</span><span class="sxs-lookup"><span data-stu-id="93dbe-130">27</span></span>|<span data-ttu-id="93dbe-131">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-131">No</span></span>|  
|<span data-ttu-id="93dbe-132">**EventSequence**</span><span class="sxs-lookup"><span data-stu-id="93dbe-132">**EventSequence**</span></span>|`int`|<span data-ttu-id="93dbe-133">此事件的序列号。</span><span class="sxs-lookup"><span data-stu-id="93dbe-133">Sequence number for this event.</span></span>|<span data-ttu-id="93dbe-134">51</span><span class="sxs-lookup"><span data-stu-id="93dbe-134">51</span></span>|<span data-ttu-id="93dbe-135">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-135">No</span></span>|  
|<span data-ttu-id="93dbe-136">**EventSubClass**</span><span class="sxs-lookup"><span data-stu-id="93dbe-136">**EventSubClass**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-137">事件子类的类型。</span><span class="sxs-lookup"><span data-stu-id="93dbe-137">The type of event subclass.</span></span> <span data-ttu-id="93dbe-138">它提供了有关每个事件类的详细信息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-138">This provides more information about each event class.</span></span>|<span data-ttu-id="93dbe-139">21</span><span class="sxs-lookup"><span data-stu-id="93dbe-139">21</span></span>|<span data-ttu-id="93dbe-140">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-140">Yes</span></span>|  
|<span data-ttu-id="93dbe-141">**GUID**</span><span class="sxs-lookup"><span data-stu-id="93dbe-141">**GUID**</span></span>|`uniqueidentifier`|<span data-ttu-id="93dbe-142">对话的会话 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-142">The conversation ID of the dialog.</span></span> <span data-ttu-id="93dbe-143">此标识符将作为消息的一部分进行传输，并在会话双方之间共享。</span><span class="sxs-lookup"><span data-stu-id="93dbe-143">This identifier is transmitted as part of the message, and is shared between both sides of the conversation.</span></span>|<span data-ttu-id="93dbe-144">54</span><span class="sxs-lookup"><span data-stu-id="93dbe-144">54</span></span>|<span data-ttu-id="93dbe-145">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-145">No</span></span>|  
|<span data-ttu-id="93dbe-146">**HostName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-146">**HostName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-147">正在运行客户端程序的计算机的名称。</span><span class="sxs-lookup"><span data-stu-id="93dbe-147">The name of the computer on which the client is running.</span></span> <span data-ttu-id="93dbe-148">如果客户端提供了主机名，则填充此数据列。</span><span class="sxs-lookup"><span data-stu-id="93dbe-148">This data column is populated if the host name is provided by the client.</span></span> <span data-ttu-id="93dbe-149">若要确定主机名，请使用**HOST_NAME**函数。</span><span class="sxs-lookup"><span data-stu-id="93dbe-149">To determine the host name, use the **HOST_NAME** function.</span></span>|<span data-ttu-id="93dbe-150">8</span><span class="sxs-lookup"><span data-stu-id="93dbe-150">8</span></span>|<span data-ttu-id="93dbe-151">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-151">Yes</span></span>|  
|<span data-ttu-id="93dbe-152">**IsSystem**</span><span class="sxs-lookup"><span data-stu-id="93dbe-152">**IsSystem**</span></span>|`int`|<span data-ttu-id="93dbe-153">指示事件是发生在系统进程中还是发生在用户进程中。</span><span class="sxs-lookup"><span data-stu-id="93dbe-153">Indicates whether the event occurred on a system process or a user process.</span></span><br /><br /> <span data-ttu-id="93dbe-154">0 = 用户</span><span class="sxs-lookup"><span data-stu-id="93dbe-154">0 = user</span></span><br /><br /> <span data-ttu-id="93dbe-155">1 = 系统</span><span class="sxs-lookup"><span data-stu-id="93dbe-155">1 = system</span></span>|<span data-ttu-id="93dbe-156">60</span><span class="sxs-lookup"><span data-stu-id="93dbe-156">60</span></span>|<span data-ttu-id="93dbe-157">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-157">No</span></span>|  
|<span data-ttu-id="93dbe-158">**LoginSid**</span><span class="sxs-lookup"><span data-stu-id="93dbe-158">**LoginSid**</span></span>|`image`|<span data-ttu-id="93dbe-159">已登录用户的安全标识号 (SID)。</span><span class="sxs-lookup"><span data-stu-id="93dbe-159">The security identification number (SID) of the logged-in user.</span></span> <span data-ttu-id="93dbe-160">服务器中的每个登录名都具有唯一的 SID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-160">Each SID is unique for each login in the server.</span></span>|<span data-ttu-id="93dbe-161">41</span><span class="sxs-lookup"><span data-stu-id="93dbe-161">41</span></span>|<span data-ttu-id="93dbe-162">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-162">Yes</span></span>|  
|<span data-ttu-id="93dbe-163">**名称**</span><span class="sxs-lookup"><span data-stu-id="93dbe-163">**MethodName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-164">会话所属的会话组。</span><span class="sxs-lookup"><span data-stu-id="93dbe-164">The conversation group that the conversation belongs to.</span></span>|<span data-ttu-id="93dbe-165">47</span><span class="sxs-lookup"><span data-stu-id="93dbe-165">47</span></span>|<span data-ttu-id="93dbe-166">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-166">No</span></span>|  
|<span data-ttu-id="93dbe-167">**NTDomainName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-167">**NTDomainName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-168">用户所属的 Windows 域。</span><span class="sxs-lookup"><span data-stu-id="93dbe-168">The Windows domain to which the user belongs.</span></span>|<span data-ttu-id="93dbe-169">7</span><span class="sxs-lookup"><span data-stu-id="93dbe-169">7</span></span>|<span data-ttu-id="93dbe-170">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-170">Yes</span></span>|  
|<span data-ttu-id="93dbe-171">**NTUserName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-171">**NTUserName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-172">拥有生成此事件的连接的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="93dbe-172">The name of the user that owns the connection that generated this event.</span></span>|<span data-ttu-id="93dbe-173">6</span><span class="sxs-lookup"><span data-stu-id="93dbe-173">6</span></span>|<span data-ttu-id="93dbe-174">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-174">Yes</span></span>|  
|<span data-ttu-id="93dbe-175">**ObjectName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-175">**ObjectName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-176">对话的会话句柄。</span><span class="sxs-lookup"><span data-stu-id="93dbe-176">The conversation handle of the dialog.</span></span>|<span data-ttu-id="93dbe-177">34</span><span class="sxs-lookup"><span data-stu-id="93dbe-177">34</span></span>|<span data-ttu-id="93dbe-178">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-178">No</span></span>|  
|<span data-ttu-id="93dbe-179">**Priority**</span><span class="sxs-lookup"><span data-stu-id="93dbe-179">**Priority**</span></span>|`int`|<span data-ttu-id="93dbe-180">会话的优先级</span><span class="sxs-lookup"><span data-stu-id="93dbe-180">The priority level of the conversation</span></span>|<span data-ttu-id="93dbe-181">5</span><span class="sxs-lookup"><span data-stu-id="93dbe-181">5</span></span>|<span data-ttu-id="93dbe-182">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-182">Yes</span></span>|  
|<span data-ttu-id="93dbe-183">**RoleName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-183">**RoleName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-184">会话句柄的角色。</span><span class="sxs-lookup"><span data-stu-id="93dbe-184">The role of the conversation handle.</span></span> <span data-ttu-id="93dbe-185">这可以是 **initiator** 或 **target**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-185">This is either **initiator** or **target**.</span></span>|<span data-ttu-id="93dbe-186">38</span><span class="sxs-lookup"><span data-stu-id="93dbe-186">38</span></span>|<span data-ttu-id="93dbe-187">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-187">No</span></span>|  
|<span data-ttu-id="93dbe-188">**ServerName**</span><span class="sxs-lookup"><span data-stu-id="93dbe-188">**ServerName**</span></span>|`nvarchar`|<span data-ttu-id="93dbe-189">正在跟踪的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的名称。</span><span class="sxs-lookup"><span data-stu-id="93dbe-189">The name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that is being traced.</span></span>|<span data-ttu-id="93dbe-190">26</span><span class="sxs-lookup"><span data-stu-id="93dbe-190">26</span></span>|<span data-ttu-id="93dbe-191">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-191">No</span></span>|  
|<span data-ttu-id="93dbe-192">**严重性**</span><span class="sxs-lookup"><span data-stu-id="93dbe-192">**Severity**</span></span>|`int`|<span data-ttu-id="93dbe-193">在此事件报告错误时表示 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 错误的严重级别。</span><span class="sxs-lookup"><span data-stu-id="93dbe-193">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error severity, if this event reports an error.</span></span>|<span data-ttu-id="93dbe-194">29</span><span class="sxs-lookup"><span data-stu-id="93dbe-194">29</span></span>|<span data-ttu-id="93dbe-195">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-195">No</span></span>|  
|<span data-ttu-id="93dbe-196">**SPID**</span><span class="sxs-lookup"><span data-stu-id="93dbe-196">**SPID**</span></span>|`int`|<span data-ttu-id="93dbe-197">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 为客户端所关联的进程分配的服务器进程 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-197">The server process ID that is assigned by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the process that is associated with the client.</span></span>|<span data-ttu-id="93dbe-198">12</span><span class="sxs-lookup"><span data-stu-id="93dbe-198">12</span></span>|<span data-ttu-id="93dbe-199">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-199">Yes</span></span>|  
|<span data-ttu-id="93dbe-200">**StartTime**</span><span class="sxs-lookup"><span data-stu-id="93dbe-200">**StartTime**</span></span>|`datetime`|<span data-ttu-id="93dbe-201">该事件的启动时间（如果可用）。</span><span class="sxs-lookup"><span data-stu-id="93dbe-201">The time when the event started, when available.</span></span>|<span data-ttu-id="93dbe-202">14</span><span class="sxs-lookup"><span data-stu-id="93dbe-202">14</span></span>|<span data-ttu-id="93dbe-203">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-203">Yes</span></span>|  
|<span data-ttu-id="93dbe-204">**TextData**</span><span class="sxs-lookup"><span data-stu-id="93dbe-204">**TextData**</span></span>|`ntext`|<span data-ttu-id="93dbe-205">会话的当前状态。</span><span class="sxs-lookup"><span data-stu-id="93dbe-205">The current state of the conversation.</span></span> <span data-ttu-id="93dbe-206">下列类型作之一：</span><span class="sxs-lookup"><span data-stu-id="93dbe-206">One of the following:</span></span><br /><br /> <span data-ttu-id="93dbe-207">**因此**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-207">**SO**.</span></span> <span data-ttu-id="93dbe-208">已开始出站。</span><span class="sxs-lookup"><span data-stu-id="93dbe-208">Started outbound.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-209">已处理了此会话的 BEGIN CONVERSATION，但尚未发送消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-209">processed a BEGIN CONVERSATION for this conversation, but no messages have been sent.</span></span><br /><br /> <span data-ttu-id="93dbe-210">**SI**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-210">**SI**.</span></span> <span data-ttu-id="93dbe-211">已开始入站。</span><span class="sxs-lookup"><span data-stu-id="93dbe-211">Started inbound.</span></span> <span data-ttu-id="93dbe-212">另一个 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 实例开始了与当前实例的新会话，但当前实例尚未完成第一条消息的接收工作。</span><span class="sxs-lookup"><span data-stu-id="93dbe-212">Another instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] started a new conversation with the current instance, but the current instance has not finished receiving the first message.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-213">不按照顺序接收消息，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 可能会在此状态下创建会话。</span><span class="sxs-lookup"><span data-stu-id="93dbe-213">might create the conversation in this state if the first message is fragmented or [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] receives messages out of order.</span></span> <span data-ttu-id="93dbe-214">但是，如果为会话接收的第一个传输包含了完整的第一条消息，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 可能会在 CO 状态下创建会话。</span><span class="sxs-lookup"><span data-stu-id="93dbe-214">However, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might create the conversation in the CO state if the first transmission that was received for the conversation contains the complete first message.</span></span><br /><br /> <span data-ttu-id="93dbe-215">**CO**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-215">**CO**.</span></span> <span data-ttu-id="93dbe-216">正在进行会话。</span><span class="sxs-lookup"><span data-stu-id="93dbe-216">Conversing.</span></span> <span data-ttu-id="93dbe-217">会话已建立，会话的双方都可以发送消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-217">The conversation is established, and both sides of the conversation can send messages.</span></span> <span data-ttu-id="93dbe-218">典型服务的大部分通信都在会话处于此状态时发生。</span><span class="sxs-lookup"><span data-stu-id="93dbe-218">Most communication for a typical service happens when the conversation is in this state.</span></span><br /><br /> <span data-ttu-id="93dbe-219">**DI**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-219">**DI**.</span></span> <span data-ttu-id="93dbe-220">已断开连接的入站。</span><span class="sxs-lookup"><span data-stu-id="93dbe-220">Disconnected inbound.</span></span> <span data-ttu-id="93dbe-221">会话的远程端已发出 END CONVERSATION。</span><span class="sxs-lookup"><span data-stu-id="93dbe-221">The remote side of the conversation has issued an END CONVERSATION.</span></span> <span data-ttu-id="93dbe-222">会话将保持此状态，直到会话的本地端发出 END CONVERSATION。</span><span class="sxs-lookup"><span data-stu-id="93dbe-222">The conversation remains in this state until the local side of the conversation issues an END CONVERSATION.</span></span> <span data-ttu-id="93dbe-223">应用程序仍然可以接收会话消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-223">An application can still receive messages for the conversation.</span></span> <span data-ttu-id="93dbe-224">由于会话的远程端已经结束了会话，因此应用程序无法通过此会话发送消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-224">Because the remote side of the conversation has ended the conversation, an application cannot send messages on this conversation.</span></span> <span data-ttu-id="93dbe-225">当应用程序发出 END CONVERSATION 时，会话将转为“关闭”(CD) 状态。</span><span class="sxs-lookup"><span data-stu-id="93dbe-225">When an application issues an END CONVERSATION, the conversation moves to the Closed (CD) state.</span></span><br /><br /> <span data-ttu-id="93dbe-226">**执行**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-226">**DO**.</span></span> <span data-ttu-id="93dbe-227">已断开连接的出站。</span><span class="sxs-lookup"><span data-stu-id="93dbe-227">Disconnected outbound.</span></span> <span data-ttu-id="93dbe-228">会话的本地端已发出 END CONVERSATION。</span><span class="sxs-lookup"><span data-stu-id="93dbe-228">The local side of the conversation has issued an END CONVERSATION.</span></span> <span data-ttu-id="93dbe-229">会话将保持此状态，直到会话的远程端确认 END CONVERSATION。</span><span class="sxs-lookup"><span data-stu-id="93dbe-229">The conversation remains in this state until the remote side of the conversation acknowledges the END CONVERSATION.</span></span> <span data-ttu-id="93dbe-230">应用程序将无法发送或接收会话消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-230">An application cannot send or receive messages for the conversation.</span></span> <span data-ttu-id="93dbe-231">当会话的远程端确认 END CONVERSATION 之后，会话将转为“关闭”(CD) 状态。</span><span class="sxs-lookup"><span data-stu-id="93dbe-231">When the remote side of the conversation acknowledges the END CONVERSATION, the conversation moves to the Closed (CD) state.</span></span><br /><br /> <span data-ttu-id="93dbe-232">**ER**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-232">**ER**.</span></span> <span data-ttu-id="93dbe-233">错误。</span><span class="sxs-lookup"><span data-stu-id="93dbe-233">Error.</span></span> <span data-ttu-id="93dbe-234">此端点发生错误。</span><span class="sxs-lookup"><span data-stu-id="93dbe-234">An error has occurred on this endpoint.</span></span> <span data-ttu-id="93dbe-235">Error、Severity 和 State 列中包含与发生的具体错误有关的信息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-235">The Error, Severity, and State columns contain information about the specific error that occurred.</span></span><br /><br /> <span data-ttu-id="93dbe-236">**CD**。</span><span class="sxs-lookup"><span data-stu-id="93dbe-236">**CD**.</span></span> <span data-ttu-id="93dbe-237">已关闭。</span><span class="sxs-lookup"><span data-stu-id="93dbe-237">Closed.</span></span> <span data-ttu-id="93dbe-238">会话端点不再使用。</span><span class="sxs-lookup"><span data-stu-id="93dbe-238">The conversation endpoint is no longer in use.</span></span>|<span data-ttu-id="93dbe-239">1</span><span class="sxs-lookup"><span data-stu-id="93dbe-239">1</span></span>|<span data-ttu-id="93dbe-240">是</span><span class="sxs-lookup"><span data-stu-id="93dbe-240">Yes</span></span>|  
|<span data-ttu-id="93dbe-241">**Transaction ID**</span><span class="sxs-lookup"><span data-stu-id="93dbe-241">**Transaction ID**</span></span>|`bigint`|<span data-ttu-id="93dbe-242">系统为事务分配的 ID。</span><span class="sxs-lookup"><span data-stu-id="93dbe-242">The system-assigned ID of the transaction.</span></span>|<span data-ttu-id="93dbe-243">4</span><span class="sxs-lookup"><span data-stu-id="93dbe-243">4</span></span>|<span data-ttu-id="93dbe-244">否</span><span class="sxs-lookup"><span data-stu-id="93dbe-244">No</span></span>|  
  
 <span data-ttu-id="93dbe-245">下表列出了此事件类的子类值。</span><span class="sxs-lookup"><span data-stu-id="93dbe-245">The following table lists the subclass values for this event class.</span></span>  
  
|<span data-ttu-id="93dbe-246">ID</span><span class="sxs-lookup"><span data-stu-id="93dbe-246">ID</span></span>|<span data-ttu-id="93dbe-247">子类</span><span class="sxs-lookup"><span data-stu-id="93dbe-247">Subclass</span></span>|<span data-ttu-id="93dbe-248">说明</span><span class="sxs-lookup"><span data-stu-id="93dbe-248">Description</span></span>|  
|--------|--------------|-----------------|  
|<span data-ttu-id="93dbe-249">1</span><span class="sxs-lookup"><span data-stu-id="93dbe-249">1</span></span>|<span data-ttu-id="93dbe-250">SEND Message</span><span class="sxs-lookup"><span data-stu-id="93dbe-250">SEND Message</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-251">当执行 SEND 语句时，生成**Send Message**事件 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-251">generates a **SEND Message** event when the [!INCLUDE[ssDE](../../includes/ssde-md.md)] executes a SEND statement.</span></span>|  
|<span data-ttu-id="93dbe-252">2</span><span class="sxs-lookup"><span data-stu-id="93dbe-252">2</span></span>|<span data-ttu-id="93dbe-253">END CONVERSATION</span><span class="sxs-lookup"><span data-stu-id="93dbe-253">END CONVERSATION</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-254">当执行不包含 WITH ERROR 子句的 END 会话语句时，将生成**结束会话**事件 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-254">generates an **END CONVERSATION** event when the [!INCLUDE[ssDE](../../includes/ssde-md.md)] executes an END CONVERSATION statement that does not include the WITH ERROR clause.</span></span>|  
|<span data-ttu-id="93dbe-255">3</span><span class="sxs-lookup"><span data-stu-id="93dbe-255">3</span></span>|<span data-ttu-id="93dbe-256">END CONVERSATION WITH ERROR</span><span class="sxs-lookup"><span data-stu-id="93dbe-256">END CONVERSATION WITH ERROR</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-257">当执行包含 WITH ERROR 子句的 END 会话语句时，将生成带有错误事件的**结束会话** [!INCLUDE[ssDE](../../includes/ssde-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-257">generates an **END CONVERSATION WITH ERROR** event when the [!INCLUDE[ssDE](../../includes/ssde-md.md)] executes an END CONVERSATION statement that includes the WITH ERROR clause.</span></span>|  
|<span data-ttu-id="93dbe-258">4</span><span class="sxs-lookup"><span data-stu-id="93dbe-258">4</span></span>|<span data-ttu-id="93dbe-259">Broker Initiated Error</span><span class="sxs-lookup"><span data-stu-id="93dbe-259">Broker Initiated Error</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-260">每当创建错误消息时，都会生成**Broker 启动的错误**事件 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-260">generates a **Broker Initiated Error** event whenever [!INCLUDE[ssSB](../../includes/sssb-md.md)] creates an error message.</span></span> <span data-ttu-id="93dbe-261">例如，当 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 无法成功为对话发送消息时，将为该对话创建错误消息并生成此事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-261">For example, when [!INCLUDE[ssSB](../../includes/sssb-md.md)] cannot successfully route a message for a dialog, the broker creates an error message for the dialog and generates this event.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-262">不生成此事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-262">does not generate this event when an application program ends a conversation with an error.</span></span>|  
|<span data-ttu-id="93dbe-263">5</span><span class="sxs-lookup"><span data-stu-id="93dbe-263">5</span></span>|<span data-ttu-id="93dbe-264">Terminate Dialog</span><span class="sxs-lookup"><span data-stu-id="93dbe-264">Terminate Dialog</span></span>|[!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="93dbe-265">终止了对话。</span><span class="sxs-lookup"><span data-stu-id="93dbe-265">terminated the dialog.</span></span> [!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="93dbe-266">为了响应阻止对话继续进行的条件而终止了对话，但这不同于会话错误或会话正常结束。</span><span class="sxs-lookup"><span data-stu-id="93dbe-266">terminates dialogs in response to conditions that prevent the dialog from continuing, but which are not errors or the normal end of a conversation.</span></span> <span data-ttu-id="93dbe-267">例如，删除一个服务将导致 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 终止该服务的所有对话。</span><span class="sxs-lookup"><span data-stu-id="93dbe-267">For example, dropping a service causes [!INCLUDE[ssSB](../../includes/sssb-md.md)] to terminate all dialogs for that service.</span></span>|  
|<span data-ttu-id="93dbe-268">6</span><span class="sxs-lookup"><span data-stu-id="93dbe-268">6</span></span>|<span data-ttu-id="93dbe-269">Received Sequenced Message</span><span class="sxs-lookup"><span data-stu-id="93dbe-269">Received Sequenced Message</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-270">当收到包含消息序列号的消息时，生成一个接收的**排序消息**事件类 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-270">generates a **Received Sequenced Message** event class when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] receives a message that contains a message sequence number.</span></span> <span data-ttu-id="93dbe-271">所有用户定义的消息类型都是已编序的消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-271">All user-defined message types are sequenced messages.</span></span> [!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="93dbe-272">会在两种情况下生成未编序的消息：</span><span class="sxs-lookup"><span data-stu-id="93dbe-272">generates an unsequenced message in two cases:</span></span><br /><br /> <span data-ttu-id="93dbe-273">[!INCLUDE[ssSB](../../includes/sssb-md.md)] 生成的错误消息是未编序的。</span><span class="sxs-lookup"><span data-stu-id="93dbe-273">Error messages generated by [!INCLUDE[ssSB](../../includes/sssb-md.md)] are unsequenced.</span></span><br /><br /> <span data-ttu-id="93dbe-274">消息确认可能是未编序的。</span><span class="sxs-lookup"><span data-stu-id="93dbe-274">Message acknowledgements might be unsequenced.</span></span> <span data-ttu-id="93dbe-275">为提高效率， [!INCLUDE[ssSB](../../includes/sssb-md.md)] 会在已编序的消息中包含任何可用的消息确认。</span><span class="sxs-lookup"><span data-stu-id="93dbe-275">For efficiency, [!INCLUDE[ssSB](../../includes/sssb-md.md)] includes message any available acknowledgement as part of a sequenced message .</span></span> <span data-ttu-id="93dbe-276">不过，如果应用程序没有在特定时间段内将已编序的消息发送到远程端点， [!INCLUDE[ssSB](../../includes/sssb-md.md)] 将为消息确认创建一个未编序的消息。</span><span class="sxs-lookup"><span data-stu-id="93dbe-276">However, if an application does not send a sequenced message to the remote endpoint within a certain period of time, [!INCLUDE[ssSB](../../includes/sssb-md.md)] creates an unsequenced message for the message acknowledgement.</span></span>|  
|<span data-ttu-id="93dbe-277">7</span><span class="sxs-lookup"><span data-stu-id="93dbe-277">7</span></span>|<span data-ttu-id="93dbe-278">Received END CONVERSATION</span><span class="sxs-lookup"><span data-stu-id="93dbe-278">Received END CONVERSATION</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-279">从会话的另一端收到 End Dialog 消息时 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 生成 Received END CONVERSATION 事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-279">generates a Received END CONVERSATION event when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] receives an End Dialog message from the other side of the conversation.</span></span>|  
|<span data-ttu-id="93dbe-280">8</span><span class="sxs-lookup"><span data-stu-id="93dbe-280">8</span></span>|<span data-ttu-id="93dbe-281">Received END CONVERSATION WITH ERROR</span><span class="sxs-lookup"><span data-stu-id="93dbe-281">Received END CONVERSATION WITH ERROR</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-282">当从会话的另一端收到用户定义的错误时 **，生成接收到的结束会话并带有错误**事件 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-282">generates a **Received END CONVERSATION WITH ERROR** event when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] receives a user-defined error from the other side of the conversation.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-283">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 收到 Broker 定义的错误时，不会生成此事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-283">does not generate this event when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] receives a broker-defined error.</span></span>|  
|<span data-ttu-id="93dbe-284">9</span><span class="sxs-lookup"><span data-stu-id="93dbe-284">9</span></span>|<span data-ttu-id="93dbe-285">Received Broker Error Message</span><span class="sxs-lookup"><span data-stu-id="93dbe-285">Received Broker Error Message</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-286">当从会话的另一端收到 broker 定义的错误消息时，将生成 "**已收到 Broker 错误消息**" 事件 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-286">generates a **Received Broker Error Message** event when [!INCLUDE[ssSB](../../includes/sssb-md.md)] receives a broker-defined error message from the other side of the conversation.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-287">收到 Broker 定义的错误时， [!INCLUDE[ssSB](../../includes/sssb-md.md)] 不会生成此事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-287">does not generate this event when [!INCLUDE[ssSB](../../includes/sssb-md.md)] receives an error message that was generated by an application.</span></span><br /><br /> <span data-ttu-id="93dbe-288">例如，如果当前数据库包含一个指向转发数据库的默认路由，则 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 将把包含未知服务名称的消息发送到转发数据库。</span><span class="sxs-lookup"><span data-stu-id="93dbe-288">For example, if the current database contains a default route to a forwarding database, [!INCLUDE[ssSB](../../includes/sssb-md.md)] routes a message with an unknown service name to the forwarding database.</span></span> <span data-ttu-id="93dbe-289">如果该数据库不能发送此消息，则该数据库中的 Broker 将创建一个错误消息并将该错误消息返回到当前数据库。</span><span class="sxs-lookup"><span data-stu-id="93dbe-289">If that database cannot route the message, the broker in that database creates an error message and returns that error message to the current database.</span></span> <span data-ttu-id="93dbe-290">当前数据库从转发数据库收到 Broker 生成的错误后，将生成 **Received Broker Error Message** 事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-290">When the current database receives the broker-generated error from the forwarding database, the current database generates a **Received Broker Error Message** event.</span></span>|  
|<span data-ttu-id="93dbe-291">10</span><span class="sxs-lookup"><span data-stu-id="93dbe-291">10</span></span>|<span data-ttu-id="93dbe-292">Received END CONVERSATION Ack</span><span class="sxs-lookup"><span data-stu-id="93dbe-292">Received END CONVERSATION Ack</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-293">当会话的另一方确认会话的此端发送的结束对话框或错误消息时，将生成**接收的结束会话 Ack**事件类。</span><span class="sxs-lookup"><span data-stu-id="93dbe-293">generates a **Received END CONVERSATION Ack** event class when the other side of a conversation acknowledges an End Dialog or Error message sent by this side of the conversation.</span></span>|  
|<span data-ttu-id="93dbe-294">11</span><span class="sxs-lookup"><span data-stu-id="93dbe-294">11</span></span>|<span data-ttu-id="93dbe-295">BEGIN DIALOG</span><span class="sxs-lookup"><span data-stu-id="93dbe-295">BEGIN DIALOG</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-296">当数据库引擎执行 BEGIN DIALOG 命令时，将生成**BEGIN dialog**事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-296">generates a **BEGIN DIALOG** event when the Database Engine executes a BEGIN DIALOG command.</span></span>|  
|<span data-ttu-id="93dbe-297">12</span><span class="sxs-lookup"><span data-stu-id="93dbe-297">12</span></span>|<span data-ttu-id="93dbe-298">Dialog Created</span><span class="sxs-lookup"><span data-stu-id="93dbe-298">Dialog Created</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="93dbe-299">创建对话框时生成**对话框创建**的事件 [!INCLUDE[ssSB](../../includes/sssb-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="93dbe-299">generates a **Dialog Created** event when [!INCLUDE[ssSB](../../includes/sssb-md.md)] creates an endpoint for a dialog.</span></span> [!INCLUDE[ssSB](../../includes/sssb-md.md)] <span data-ttu-id="93dbe-300">都将创建一个端点，而不管当前数据库是对话的发起方还是对话的目标。</span><span class="sxs-lookup"><span data-stu-id="93dbe-300">creates an endpoint whenever a new dialog is established, regardless of whether the current database is the initiator or the target of the dialog.</span></span>|  
|<span data-ttu-id="93dbe-301">13</span><span class="sxs-lookup"><span data-stu-id="93dbe-301">13</span></span>|<span data-ttu-id="93dbe-302">END CONVERSATION WITH CLEANUP</span><span class="sxs-lookup"><span data-stu-id="93dbe-302">END CONVERSATION WITH CLEANUP</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="93dbe-303">执行包含 WITH CLEANUP 子句的 END CONVERSATION 语句时 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 生成 END CONVERSATION WITH CLEANUP 事件。</span><span class="sxs-lookup"><span data-stu-id="93dbe-303">generates an END CONVERSATION WITH CLEANUP event when the [!INCLUDE[ssDE](../../includes/ssde-md.md)] executes an END CONVERSATION statement that includes the WITH CLEANUP clause.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="93dbe-304">另请参阅</span><span class="sxs-lookup"><span data-stu-id="93dbe-304">See Also</span></span>  
 [<span data-ttu-id="93dbe-305">SQL Server Service Broker</span><span class="sxs-lookup"><span data-stu-id="93dbe-305">SQL Server Service Broker</span></span>](../../database-engine/configure-windows/sql-server-service-broker.md)  
  
  
