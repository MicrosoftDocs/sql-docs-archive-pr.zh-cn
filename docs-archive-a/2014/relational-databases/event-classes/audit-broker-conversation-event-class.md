---
title: Audit Broker Conversation 事件类 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
topic_type:
- apiref
helpviewer_keywords:
- Audit Broker Conversation event class
ms.assetid: d58e3577-e297-42e5-b8fe-206665a75d13
author: stevestein
ms.author: sstein
ms.openlocfilehash: 46c09737aeafffd04f3dc2c129692bbf78d2c096
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689915"
---
# <a name="audit-broker-conversation-event-class"></a><span data-ttu-id="ed9e3-102">Audit Broker Conversation 事件类</span><span class="sxs-lookup"><span data-stu-id="ed9e3-102">Audit Broker Conversation Event Class</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="ed9e3-103">创建了 **Audit Broker Conversation** 事件以报告与 Service Broker 对话安全有关的审核消息。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-103">creates an **Audit Broker Conversation** event to report audit messages related to Service Broker dialog security.</span></span>  
  
## <a name="audit-broker-conversation-event-class-data-columns"></a><span data-ttu-id="ed9e3-104">Audit Broker Conversation 事件类的数据列</span><span class="sxs-lookup"><span data-stu-id="ed9e3-104">Audit Broker Conversation Event Class Data Columns</span></span>  
  
|<span data-ttu-id="ed9e3-105">数据列</span><span class="sxs-lookup"><span data-stu-id="ed9e3-105">Data column</span></span>|<span data-ttu-id="ed9e3-106">类型</span><span class="sxs-lookup"><span data-stu-id="ed9e3-106">Type</span></span>|<span data-ttu-id="ed9e3-107">说明</span><span class="sxs-lookup"><span data-stu-id="ed9e3-107">Description</span></span>|<span data-ttu-id="ed9e3-108">列号</span><span class="sxs-lookup"><span data-stu-id="ed9e3-108">Column number</span></span>|<span data-ttu-id="ed9e3-109">可筛选</span><span class="sxs-lookup"><span data-stu-id="ed9e3-109">Filterable</span></span>|  
|-----------------|----------|-----------------|-------------------|----------------|  
|<span data-ttu-id="ed9e3-110">ApplicationName </span><span class="sxs-lookup"><span data-stu-id="ed9e3-110">**ApplicationName**</span></span>|<span data-ttu-id="ed9e3-111">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-111">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-112">客户端应用程序的名称，该客户端应用程序创建了指向 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的连接。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-112">The name of the client application that created the connection to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ed9e3-113">此列由应用程序传递的值填充，而不是由所显示的程序名填充。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-113">This column is populated with the values passed by the application rather than the displayed name of the program.</span></span>|<span data-ttu-id="ed9e3-114">10</span><span class="sxs-lookup"><span data-stu-id="ed9e3-114">10</span></span>|<span data-ttu-id="ed9e3-115">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-115">Yes</span></span>|  
|<span data-ttu-id="ed9e3-116">**BigintData1**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-116">**BigintData1**</span></span>|<span data-ttu-id="ed9e3-117">**bigint**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-117">**bigint**</span></span>|<span data-ttu-id="ed9e3-118">消息序列号。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-118">The message sequence number of the message.</span></span>|<span data-ttu-id="ed9e3-119">52</span><span class="sxs-lookup"><span data-stu-id="ed9e3-119">52</span></span>|<span data-ttu-id="ed9e3-120">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-120">No</span></span>|  
|<span data-ttu-id="ed9e3-121">**ClientProcessID**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-121">**ClientProcessID**</span></span>|<span data-ttu-id="ed9e3-122">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-122">**int**</span></span>|<span data-ttu-id="ed9e3-123">由主机分配给正在运行客户端应用程序的进程的 ID。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-123">The ID assigned by the host computer to the process where the client application is running.</span></span> <span data-ttu-id="ed9e3-124">如果客户端提供了客户端进程 ID，则填充此数据列。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-124">This data column is populated if the client process ID is provided by the client.</span></span>|<span data-ttu-id="ed9e3-125">9</span><span class="sxs-lookup"><span data-stu-id="ed9e3-125">9</span></span>|<span data-ttu-id="ed9e3-126">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-126">Yes</span></span>|  
|<span data-ttu-id="ed9e3-127">**DatabaseID**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-127">**DatabaseID**</span></span>|<span data-ttu-id="ed9e3-128">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-128">**int**</span></span>|<span data-ttu-id="ed9e3-129">由 USE *database* 语句指定的数据库的 ID；如果未对给定实例发出 USE *database* 语句，则为默认数据库的 ID。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-129">The ID of the database specified by the USE *database* statement, or the ID of the default database if no USE *database* statement has been issued for a given instance.</span></span> [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="ed9e3-130">数据列而且服务器可用，则 **ServerName** 将显示数据库名。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-130">displays the name of the database if the **ServerName** data column is captured in the trace and the server is available.</span></span> <span data-ttu-id="ed9e3-131">可使用 DB_ID 函数来确定数据库的值。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-131">Determine the value for a database by using the DB_ID function.</span></span>|<span data-ttu-id="ed9e3-132">3</span><span class="sxs-lookup"><span data-stu-id="ed9e3-132">3</span></span>|<span data-ttu-id="ed9e3-133">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-133">Yes</span></span>|  
|<span data-ttu-id="ed9e3-134">**错误**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-134">**Error**</span></span>|<span data-ttu-id="ed9e3-135">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-135">**int**</span></span>|<span data-ttu-id="ed9e3-136">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 错误号（如果此事件报告了错误）。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-136">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error number, if this event reports an error.</span></span>|<span data-ttu-id="ed9e3-137">31</span><span class="sxs-lookup"><span data-stu-id="ed9e3-137">31</span></span>|<span data-ttu-id="ed9e3-138">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-138">No</span></span>|  
|<span data-ttu-id="ed9e3-139">**EventClass**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-139">**EventClass**</span></span>|<span data-ttu-id="ed9e3-140">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-140">**int**</span></span>|<span data-ttu-id="ed9e3-141">捕获的事件类的类型。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-141">The type of event class captured.</span></span> <span data-ttu-id="ed9e3-142">对于 **Audit Broker Conversation** ，始终为 **158**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-142">Always **158** for **Audit Broker Conversation**.</span></span>|<span data-ttu-id="ed9e3-143">27</span><span class="sxs-lookup"><span data-stu-id="ed9e3-143">27</span></span>|<span data-ttu-id="ed9e3-144">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-144">No</span></span>|  
|<span data-ttu-id="ed9e3-145">**EventSubClass**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-145">**EventSubClass**</span></span>|<span data-ttu-id="ed9e3-146">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-146">**int**</span></span>|<span data-ttu-id="ed9e3-147">事件子类的类型，提供有关每个事件类的进一步信息。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-147">The type of event subclass, providing further information about each event class.</span></span> <span data-ttu-id="ed9e3-148">下表列出了此事件的事件子类值。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-148">The table below lists the event subclass values for this event.</span></span>|<span data-ttu-id="ed9e3-149">21</span><span class="sxs-lookup"><span data-stu-id="ed9e3-149">21</span></span>|<span data-ttu-id="ed9e3-150">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-150">Yes</span></span>|  
|<span data-ttu-id="ed9e3-151">**FileName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-151">**FileName**</span></span>|<span data-ttu-id="ed9e3-152">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-152">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-153">登录失败的原因。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-153">The reason for the login failure.</span></span> <span data-ttu-id="ed9e3-154">如果登录成功，则此列为空。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-154">If the login succeeded, this column is empty.</span></span>|<span data-ttu-id="ed9e3-155">36</span><span class="sxs-lookup"><span data-stu-id="ed9e3-155">36</span></span>|<span data-ttu-id="ed9e3-156">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-156">No</span></span>|  
|<span data-ttu-id="ed9e3-157">**GUID**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-157">**GUID**</span></span>|<span data-ttu-id="ed9e3-158">**uniqueidentifier**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-158">**uniqueidentifier**</span></span>|<span data-ttu-id="ed9e3-159">对话的会话 ID。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-159">The conversation id of the dialog.</span></span> <span data-ttu-id="ed9e3-160">此标识符将作为消息的一部分进行传输，并在会话双方之间共享。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-160">This identifier is transmitted as part of the message, and is shared between both sides of the conversation.</span></span>|<span data-ttu-id="ed9e3-161">54</span><span class="sxs-lookup"><span data-stu-id="ed9e3-161">54</span></span>|<span data-ttu-id="ed9e3-162">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-162">No</span></span>|  
|<span data-ttu-id="ed9e3-163">**HostName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-163">**HostName**</span></span>|<span data-ttu-id="ed9e3-164">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-164">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-165">正在运行客户端程序的计算机的名称。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-165">The name of the computer on which the client is running.</span></span> <span data-ttu-id="ed9e3-166">如果客户端提供了主机名，则填充此数据列。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-166">This data column is populated if the host name is provided by the client.</span></span> <span data-ttu-id="ed9e3-167">若要确定主机名，请使用 **HOST_NAME** 函数。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-167">To determine the host name, use the **HOST_NAME** function.</span></span>|<span data-ttu-id="ed9e3-168">8</span><span class="sxs-lookup"><span data-stu-id="ed9e3-168">8</span></span>|<span data-ttu-id="ed9e3-169">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-169">Yes</span></span>|  
|<span data-ttu-id="ed9e3-170">**IntegerData**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-170">**IntegerData**</span></span>|<span data-ttu-id="ed9e3-171">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-171">**int**</span></span>|<span data-ttu-id="ed9e3-172">消息片段数。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-172">The fragment number of the message.</span></span>|<span data-ttu-id="ed9e3-173">25</span><span class="sxs-lookup"><span data-stu-id="ed9e3-173">25</span></span>|<span data-ttu-id="ed9e3-174">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-174">No</span></span>|  
|<span data-ttu-id="ed9e3-175">**NTDomainName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-175">**NTDomainName**</span></span>|<span data-ttu-id="ed9e3-176">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-176">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-177">用户所属的 Windows 域。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-177">The Windows domain to which the user belongs.</span></span>|<span data-ttu-id="ed9e3-178">7</span><span class="sxs-lookup"><span data-stu-id="ed9e3-178">7</span></span>|<span data-ttu-id="ed9e3-179">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-179">Yes</span></span>|  
|<span data-ttu-id="ed9e3-180">**NTUserName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-180">**NTUserName**</span></span>|<span data-ttu-id="ed9e3-181">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-181">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-182">拥有生成此事件的连接的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-182">The name of the user that owns the connection that generated this event.</span></span>|<span data-ttu-id="ed9e3-183">6</span><span class="sxs-lookup"><span data-stu-id="ed9e3-183">6</span></span>|<span data-ttu-id="ed9e3-184">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-184">Yes</span></span>|  
|<span data-ttu-id="ed9e3-185">**ObjectId**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-185">**ObjectId**</span></span>|<span data-ttu-id="ed9e3-186">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-186">**int**</span></span>|<span data-ttu-id="ed9e3-187">目标服务的用户 ID。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-187">The user ID of the target service.</span></span>|<span data-ttu-id="ed9e3-188">22</span><span class="sxs-lookup"><span data-stu-id="ed9e3-188">22</span></span>|<span data-ttu-id="ed9e3-189">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-189">No</span></span>|  
|<span data-ttu-id="ed9e3-190">**RoleName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-190">**RoleName**</span></span>|<span data-ttu-id="ed9e3-191">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-191">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-192">会话句柄的角色。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-192">The role of the conversation handle.</span></span> <span data-ttu-id="ed9e3-193">这可以是 **initiator** 或 **target**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-193">This is either **initiator** or **target**.</span></span>|<span data-ttu-id="ed9e3-194">38</span><span class="sxs-lookup"><span data-stu-id="ed9e3-194">38</span></span>|<span data-ttu-id="ed9e3-195">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-195">No</span></span>|  
|<span data-ttu-id="ed9e3-196">**ServerName**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-196">**ServerName**</span></span>|<span data-ttu-id="ed9e3-197">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-197">**nvarchar**</span></span>|<span data-ttu-id="ed9e3-198">所跟踪的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的名称。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-198">The name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] being traced.</span></span>|<span data-ttu-id="ed9e3-199">26</span><span class="sxs-lookup"><span data-stu-id="ed9e3-199">26</span></span>|<span data-ttu-id="ed9e3-200">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-200">No</span></span>|  
|<span data-ttu-id="ed9e3-201">**严重性**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-201">**Severity**</span></span>|<span data-ttu-id="ed9e3-202">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-202">**int**</span></span>|<span data-ttu-id="ed9e3-203">在此事件报告错误时表示 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 错误的严重级别。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-203">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error severity, if this event reports an error.</span></span>|<span data-ttu-id="ed9e3-204">29</span><span class="sxs-lookup"><span data-stu-id="ed9e3-204">29</span></span>|<span data-ttu-id="ed9e3-205">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-205">No</span></span>|  
|<span data-ttu-id="ed9e3-206">**SPID**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-206">**SPID**</span></span>|<span data-ttu-id="ed9e3-207">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-207">**int**</span></span>|<span data-ttu-id="ed9e3-208">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 为客户端所关联的进程分配的服务器进程 ID。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-208">The server process ID assigned by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the process associated with the client.</span></span>|<span data-ttu-id="ed9e3-209">12</span><span class="sxs-lookup"><span data-stu-id="ed9e3-209">12</span></span>|<span data-ttu-id="ed9e3-210">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-210">Yes</span></span>|  
|<span data-ttu-id="ed9e3-211">**StartTime**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-211">**StartTime**</span></span>|<span data-ttu-id="ed9e3-212">**datetime**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-212">**datetime**</span></span>|<span data-ttu-id="ed9e3-213">事件（如果有）的开始时间。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-213">The time at which the event started, when available.</span></span>|<span data-ttu-id="ed9e3-214">14</span><span class="sxs-lookup"><span data-stu-id="ed9e3-214">14</span></span>|<span data-ttu-id="ed9e3-215">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-215">Yes</span></span>|  
|<span data-ttu-id="ed9e3-216">**State**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-216">**State**</span></span>|<span data-ttu-id="ed9e3-217">**int**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-217">**int**</span></span>|<span data-ttu-id="ed9e3-218">指示 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 源代码中生成该事件的位置。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-218">Indicates the location within the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] source code that produced the event.</span></span> <span data-ttu-id="ed9e3-219">可能生成此事件的每个位置都有不同的状态代码。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-219">Each location that may produce this event has a different state code.</span></span> <span data-ttu-id="ed9e3-220">Microsoft 支持工程师可使用此状态代码查找生成该事件的位置。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-220">A Microsoft support engineer can use this state code to find where the event was produced.</span></span>|<span data-ttu-id="ed9e3-221">30</span><span class="sxs-lookup"><span data-stu-id="ed9e3-221">30</span></span>|<span data-ttu-id="ed9e3-222">否</span><span class="sxs-lookup"><span data-stu-id="ed9e3-222">No</span></span>|  
|<span data-ttu-id="ed9e3-223">**TextData**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-223">**TextData**</span></span>|<span data-ttu-id="ed9e3-224">**ntext**</span><span class="sxs-lookup"><span data-stu-id="ed9e3-224">**ntext**</span></span>|<span data-ttu-id="ed9e3-225">如果发生错误，将显示一条用来说明失败原因的消息。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-225">For errors, contains a message that describes the reason for the failure.</span></span> <span data-ttu-id="ed9e3-226">以下值之一：</span><span class="sxs-lookup"><span data-stu-id="ed9e3-226">One of the following values:</span></span><br /><br /> <span data-ttu-id="ed9e3-227">**Cert not found**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-227">**Cert not found**.</span></span> <span data-ttu-id="ed9e3-228">针对对话协议安全指定的用户没有证书。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-228">The user specified for dialog protocol security has no certificate.</span></span><br /><br /> <span data-ttu-id="ed9e3-229">**Not in valid time period**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-229">**Not in valid time period**.</span></span> <span data-ttu-id="ed9e3-230">针对对话协议安全指定的用户有一份证书，但该证书已过期。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-230">The user specified for dialog protocol security has a certificate, but the certificate has expired.</span></span><br /><br /> <span data-ttu-id="ed9e3-231">**Cert too large for memory allocation**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-231">**Cert too large for memory allocation**.</span></span> <span data-ttu-id="ed9e3-232">针对对话协议安全指定的用户有一份证书，但该证书过大。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-232">The user specified for dialog protocol security has a certificate, but the certificate is too large.</span></span> <span data-ttu-id="ed9e3-233">Service Broker 支持的最大证书大小为 32,768 字节。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-233">The maximum certificate size that Service Broker supports is 32,768 bytes.</span></span><br /><br /> <span data-ttu-id="ed9e3-234">**Private key not found**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-234">**Private key not found**.</span></span> <span data-ttu-id="ed9e3-235">针对对话协议安全指定的用户有一份证书，但没有与该证书相关联的私钥。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-235">The user specified for dialog protocol security has a certificate, but there is no private key associated with that certificate.</span></span><br /><br /> <span data-ttu-id="ed9e3-236">**The cert's private key size is incompatible with the crypto provider**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-236">**The cert's private key size is incompatible with the crypto provider**.</span></span> <span data-ttu-id="ed9e3-237">无法成功处理证书的私钥大小。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-237">The private key for the certificate has a key size that cannot be successfully processed.</span></span> <span data-ttu-id="ed9e3-238">私钥大小必须是 64 字节的倍数。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-238">The private key size must be a multiple of 64 bytes.</span></span><br /><br /> <span data-ttu-id="ed9e3-239">**The cert's public key size is incompatible with the crypto provider**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-239">**The cert's public key size is incompatible with the crypto provider**.</span></span> <span data-ttu-id="ed9e3-240">无法成功处理证书的公钥大小。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-240">The public key for the certificate has a key size that cannot be successfully processed.</span></span> <span data-ttu-id="ed9e3-241">公钥大小必须是 64 字节的倍数。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-241">The public key size must be a multiple of 64 bytes.</span></span><br /><br /> <span data-ttu-id="ed9e3-242">**The cert's private key size is incompatible with the encrypted key exchange key**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-242">**The cert's private key size is incompatible with the encrypted key exchange key**.</span></span> <span data-ttu-id="ed9e3-243">密钥交换密钥中指定的密钥大小与证书的私钥大小不匹配。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-243">The key size specified in the key exchange key does not match the size of the private key for the certificate.</span></span> <span data-ttu-id="ed9e3-244">这通常表示远程计算机上的证书与数据库中的证书不匹配。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-244">This generally indicates that the certificate on the remote computer does not match the certificate in the database.</span></span><br /><br /> <span data-ttu-id="ed9e3-245">**The cert's public key size is incompatible with the security header's signature**。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-245">**The cert's public key size is incompatible with the security header's signature**.</span></span> <span data-ttu-id="ed9e3-246">无法通过证书的公钥来验证安全标头的签名。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-246">The security header contains a signature that cannot be validated with the certificate's public key.</span></span> <span data-ttu-id="ed9e3-247">这通常表示远程计算机上的证书与数据库中的证书不匹配。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-247">This generally indicates that the certificate on the remote computer does not match the certificate in the database.</span></span>|<span data-ttu-id="ed9e3-248">1</span><span class="sxs-lookup"><span data-stu-id="ed9e3-248">1</span></span>|<span data-ttu-id="ed9e3-249">是</span><span class="sxs-lookup"><span data-stu-id="ed9e3-249">Yes</span></span>|  
  
 <span data-ttu-id="ed9e3-250">下表列出了此事件类的子类值。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-250">The table below lists the subclass values for this event class.</span></span>  
  
|<span data-ttu-id="ed9e3-251">ID</span><span class="sxs-lookup"><span data-stu-id="ed9e3-251">ID</span></span>|<span data-ttu-id="ed9e3-252">子类</span><span class="sxs-lookup"><span data-stu-id="ed9e3-252">Subclass</span></span>|<span data-ttu-id="ed9e3-253">说明</span><span class="sxs-lookup"><span data-stu-id="ed9e3-253">Description</span></span>|  
|--------|--------------|-----------------|  
|<span data-ttu-id="ed9e3-254">1</span><span class="sxs-lookup"><span data-stu-id="ed9e3-254">1</span></span>|<span data-ttu-id="ed9e3-255">No Security Header</span><span class="sxs-lookup"><span data-stu-id="ed9e3-255">No Security Header</span></span>|<span data-ttu-id="ed9e3-256">安全会话期间，Service Broker 接收到不包含会话密钥的消息。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-256">During a secure conversation, Service Broker received a message that did not contain a session key.</span></span> <span data-ttu-id="ed9e3-257">建立了安全会话后，对话协议要求会话中的所有消息都包含会话密钥。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-257">Once a secure conversation is established, the dialog protocol requires that all messages in the conversation contain a session key.</span></span>|  
|<span data-ttu-id="ed9e3-258">2</span><span class="sxs-lookup"><span data-stu-id="ed9e3-258">2</span></span>|<span data-ttu-id="ed9e3-259">No Certificate</span><span class="sxs-lookup"><span data-stu-id="ed9e3-259">No Certificate</span></span>|<span data-ttu-id="ed9e3-260">Service Broker 无法为会话中的某一名参与者找到可用的证书。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-260">Service Broker could not locate a usable certificate for one of the participants in the conversation.</span></span> <span data-ttu-id="ed9e3-261">为了保证会话安全，数据库必须同时包含会话发送方和接收方的证书。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-261">To secure a conversation, the database must contain a certificate for both the sender and the recipient of the conversation.</span></span>|  
|<span data-ttu-id="ed9e3-262">3</span><span class="sxs-lookup"><span data-stu-id="ed9e3-262">3</span></span>|<span data-ttu-id="ed9e3-263">Invalid Signature</span><span class="sxs-lookup"><span data-stu-id="ed9e3-263">Invalid Signature</span></span>|<span data-ttu-id="ed9e3-264">Broker 无法使用发送方证书中的公钥来验证发送方所提供的消息签名。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-264">Broker could not verify the message signature supplied by the sender using the public key in the sender's certificate.</span></span> <span data-ttu-id="ed9e3-265">这可能表示消息已损坏、消息被篡改、远程服务和本地服务没有配置相同的用户证书的或者证书已过期。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-265">This may indicate that the message is corrupt, that the message has been tampered with, that the remote service and the local service are not configured with the same user certificate, or that the certificate is out of date.</span></span>|  
|<span data-ttu-id="ed9e3-266">4</span><span class="sxs-lookup"><span data-stu-id="ed9e3-266">4</span></span>|<span data-ttu-id="ed9e3-267">Run As Target Failure</span><span class="sxs-lookup"><span data-stu-id="ed9e3-267">Run As Target Failure</span></span>|<span data-ttu-id="ed9e3-268">目标用户不具有对目标队列的接收权限。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-268">The destination user does not have receive permissions on the destination queue.</span></span> <span data-ttu-id="ed9e3-269">为了防止未经授权的用户接收消息，如果目标用户无法接收消息队列，则无论初始用户是否有权将消息排队，Service Broker 都不会将消息排队。</span><span class="sxs-lookup"><span data-stu-id="ed9e3-269">To prevent unauthorized users from receiving messages, Service Broker does not enqueue messages with a destination user that cannot receive from the queue, regardless of whether the initiating user has permission to enqueue messages.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ed9e3-270">另请参阅</span><span class="sxs-lookup"><span data-stu-id="ed9e3-270">See Also</span></span>  
 [<span data-ttu-id="ed9e3-271">SQL Server Service Broker</span><span class="sxs-lookup"><span data-stu-id="ed9e3-271">SQL Server Service Broker</span></span>](../../database-engine/configure-windows/sql-server-service-broker.md)  
  
  
