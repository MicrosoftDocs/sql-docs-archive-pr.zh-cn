---
title: 资源调控器资源池 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- Resource Governor, resource pool
- resource pool [SQL Server], overview
- resource pool [SQL Server]
ms.assetid: 306b6278-e54f-42e6-b746-95a9315e0cbe
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 574d70f23541888ade1e9b827f52fed801c20205
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689306"
---
# <a name="resource-governor-resource-pool"></a><span data-ttu-id="a5640-102">资源调控器资源池</span><span class="sxs-lookup"><span data-stu-id="a5640-102">Resource Governor Resource Pool</span></span>
  <span data-ttu-id="a5640-103">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 资源调控器中，资源池表示 [!INCLUDE[ssDE](../../includes/ssde-md.md)]实例的部分物理资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-103">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resource Governor, a resource pool represents a subset of the physical resources of an instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span> <span data-ttu-id="a5640-104">通过资源调控器，您可以指定针对传入应用程序请求可在资源池内使用的 CPU、物理 IO 和内存的使用量的限制。</span><span class="sxs-lookup"><span data-stu-id="a5640-104">Resource Governor enables you to specify limits on the amount of CPU, physical IO, and memory that incoming application requests can use within the resource pool.</span></span> <span data-ttu-id="a5640-105">每个资源池均可包含一个或多个工作负荷组。</span><span class="sxs-lookup"><span data-stu-id="a5640-105">Each resource pool can contain one or more workload groups.</span></span> <span data-ttu-id="a5640-106">在某个会话启动时，资源调控器分类器会将此会话分配给一个特定的工作负荷组，并且此会话必须使用分配给该工作负荷组的资源运行。</span><span class="sxs-lookup"><span data-stu-id="a5640-106">When a session is started, the Resource Governor classifier assigns the session to a specific workload group, and the session must run using the resources assigned to the workload group.</span></span>  
  
## <a name="resource-pool-concepts"></a><span data-ttu-id="a5640-107">资源池概念</span><span class="sxs-lookup"><span data-stu-id="a5640-107">Resource Pool Concepts</span></span>  
 <span data-ttu-id="a5640-108">资源池或池表示服务器的物理资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-108">A resource pool, or pool, represents the physical resources of the server.</span></span> <span data-ttu-id="a5640-109">您可以将池看作 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例内部的一个虚拟 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="a5640-109">You can think of a pool as a virtual [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance inside of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="a5640-110">池有两个部分。</span><span class="sxs-lookup"><span data-stu-id="a5640-110">A pool has two parts.</span></span> <span data-ttu-id="a5640-111">一部分不与其他池重叠，这使得资源预留最少。</span><span class="sxs-lookup"><span data-stu-id="a5640-111">One part does not overlap with other pools, which enables minimum resource reservation.</span></span> <span data-ttu-id="a5640-112">另一部分与其他池共享，支持最大可能的资源消耗。</span><span class="sxs-lookup"><span data-stu-id="a5640-112">The other part is shared with other pools, which supports maximum possible resource consumption.</span></span> <span data-ttu-id="a5640-113">通过为每个资源（CPU、内存和物理 IO）指定以下一个或多个设置定义池资源：</span><span class="sxs-lookup"><span data-stu-id="a5640-113">The pool resources are defined by specifying one or more of the following settings for each resource (CPU, memory, and physical IO):</span></span>  
  
-   <span data-ttu-id="a5640-114">**MIN_CPU_PERCENT 和 MAX_CPU_PERCENT**</span><span class="sxs-lookup"><span data-stu-id="a5640-114">**MIN_CPU_PERCENT and MAX_CPU_PERCENT**</span></span>  
  
     <span data-ttu-id="a5640-115">这些设置是在存在 CPU 争用时针对资源池中所有请求的最小和最大有保障的平均 CPU 带宽。</span><span class="sxs-lookup"><span data-stu-id="a5640-115">These settings are the minimum and maximum guaranteed average CPU bandwidth for all requests in the resource pool when there is CPU contention.</span></span> <span data-ttu-id="a5640-116">您可以使用这些设置为多个工作负荷建立基于各工作负荷需要的可预测 CPU 资源使用量。</span><span class="sxs-lookup"><span data-stu-id="a5640-116">You can use these settings to establish predictable CPU resource usage for multiple workloads that is based on the needs of each workload.</span></span> <span data-ttu-id="a5640-117">例如，假定公司中的销售和营销部门共享同一个数据库。</span><span class="sxs-lookup"><span data-stu-id="a5640-117">For example, assume the Sales and Marketing departments in a company share the same database.</span></span> <span data-ttu-id="a5640-118">销售部门具有大量占用 CPU 的含高优先级查询的工作负荷。</span><span class="sxs-lookup"><span data-stu-id="a5640-118">The Sales department has a CPU-intensive workload with high-priority queries.</span></span> <span data-ttu-id="a5640-119">营销部门也具有大量占用 CPU 的工作负荷，但具有较低优先级的查询。</span><span class="sxs-lookup"><span data-stu-id="a5640-119">The Marketing department also has a CPU-intensive workload, but has lower-priority queries.</span></span> <span data-ttu-id="a5640-120">通过为每个部门创建单独的资源池，您可以为“销售”资源池分配 70% 的 *最小* CPU 百分比，为“营销”资源池分配 30% 的 *最大* CPU 百分比。</span><span class="sxs-lookup"><span data-stu-id="a5640-120">By creating a separate resource pool for each department, you can assign a *minimum* CPU percentage of 70 for the Sales resource pool and a *maximum* CPU percentage of 30 for the Marketing resource pool.</span></span> <span data-ttu-id="a5640-121">这确保销售工作负荷收到其要求的 CPU 资源，并且营销工作负荷与销售工作负荷对 CPU 的需求保持相互独立。</span><span class="sxs-lookup"><span data-stu-id="a5640-121">This ensures that the Sales workload receives the CPU resources it requires and the Marketing workload is isolated from the CPU demands of the Sales workload.</span></span> <span data-ttu-id="a5640-122">请注意，该最大 CPU 百分比是一种投机性质的最大值。</span><span class="sxs-lookup"><span data-stu-id="a5640-122">Note that the maximum CPU percentage is an opportunistic maximum.</span></span> <span data-ttu-id="a5640-123">如果有可用 CPU 容量，该工作负荷将占用这些可用 CPU 容量直至 100%。</span><span class="sxs-lookup"><span data-stu-id="a5640-123">If there is available CPU capacity, the workload uses it up to 100 percent.</span></span> <span data-ttu-id="a5640-124">该最大值仅适用于存在对 CPU 资源的争用的情况。</span><span class="sxs-lookup"><span data-stu-id="a5640-124">The maximum value only applies when there is contention for CPU resources.</span></span> <span data-ttu-id="a5640-125">在此示例中，如果销售工作负荷被禁用，则营销工作负荷可以占用 100% 的 CPU（如果需要）。</span><span class="sxs-lookup"><span data-stu-id="a5640-125">In this example, if the Sales workload is switched off, the Marketing workload can use 100 percent of the CPU if needed.</span></span>  
  
-   <span data-ttu-id="a5640-126">**CAP_CPU_PERCENT**</span><span class="sxs-lookup"><span data-stu-id="a5640-126">**CAP_CPU_PERCENT**</span></span>  
  
     <span data-ttu-id="a5640-127">此设置对资源池中所有请求的 CPU 带宽有硬性上限。</span><span class="sxs-lookup"><span data-stu-id="a5640-127">This settings is a hard cap limit on the CPU bandwidth for all requests in the resource pool.</span></span> <span data-ttu-id="a5640-128">与资源池关联的工作负荷可以使用高于 MAX_CPU_PERCENT 值的 CPU 容量（如果可用），但不能超过 CAP_CPU_PERCENT 的值。</span><span class="sxs-lookup"><span data-stu-id="a5640-128">Workloads associated with the pool can use CPU capacity above the value of MAX_CPU_PERCENT if it is available, but not above the value of CAP_CPU_PERCENT.</span></span> <span data-ttu-id="a5640-129">使用上面的示例，假定正在针对营销部门的资源使用量对其收费。</span><span class="sxs-lookup"><span data-stu-id="a5640-129">Using the example above, lets assume that the Marketing department is being charged for their resource usage.</span></span> <span data-ttu-id="a5640-130">他们希望可预测的计费并且不希望支付超过 30% 的 CPU。</span><span class="sxs-lookup"><span data-stu-id="a5640-130">They want predictable billing and do not want to pay for more than 30 percent of the CPU.</span></span> <span data-ttu-id="a5640-131">这可以通过为“营销”资源池将 CAP_CPU_PERCENT 设置为 30 来实现。</span><span class="sxs-lookup"><span data-stu-id="a5640-131">This can be accomplished by setting the CAP_CPU_PERCENT to 30 for the Marketing resource pool.</span></span>  
  
-   <span data-ttu-id="a5640-132">**MIN_MEMORY_PERCENT 和 MAX_MEMORY_PERCENT**</span><span class="sxs-lookup"><span data-stu-id="a5640-132">**MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT**</span></span>  
  
     <span data-ttu-id="a5640-133">这些设置是为此资源池保留的、不能与其他资源池共享的最小和最大内存量。</span><span class="sxs-lookup"><span data-stu-id="a5640-133">These settings are the minimum and maximum amount of memory reserved for the resource pool that can not be shared with other resource pools.</span></span> <span data-ttu-id="a5640-134">此处引用的内存是授予查询执行的内存，而非缓冲池内存（例如，数据和索引页）。</span><span class="sxs-lookup"><span data-stu-id="a5640-134">The memory referenced here is query execution grant memory, not buffer pool memory (for example, data and index pages).</span></span> <span data-ttu-id="a5640-135">为某一资源池设置最小内存值意味着您在确保指定的内存百分比将可用于可在此资源池中运行的任何请求。</span><span class="sxs-lookup"><span data-stu-id="a5640-135">Setting a minimum memory value for a pool means that you are ensuring that the percentage of memory specified will be available for any requests that might run in this resource pool.</span></span> <span data-ttu-id="a5640-136">与 MIN_CPU_PERCENT 相比，这是个重要的不同之处，因为在此情况下，内存可能保留在给定的资源池中，即使该资源池在属于该池的工作负荷组中没有任何请求。</span><span class="sxs-lookup"><span data-stu-id="a5640-136">This is an important differentiator compared to MIN_CPU_PERCENT, because in this case memory may remain in the given resource pool even when the pool does not have any requests in the workload groups belonging to this pool.</span></span> <span data-ttu-id="a5640-137">因此，在使用此设置时务必要非常小心，因为此内存将不可用于任何其他池，即使没有任何活动请求。</span><span class="sxs-lookup"><span data-stu-id="a5640-137">Therefore it is crucial that you be very careful when using this setting, because this memory will be unavailable for use by any other pool, even when there are no active requests.</span></span> <span data-ttu-id="a5640-138">为某一资源池设置最大内存值意味着在该资源池中正在运行请求时，它们将永远不会获得超过此总体内存百分比的内存。</span><span class="sxs-lookup"><span data-stu-id="a5640-138">Setting a maximum memory value for a pool means that when requests are running in this pool, they will never get more than this percentage of overall memory.</span></span>  
  
-   <span data-ttu-id="a5640-139">**AFFINITY**</span><span class="sxs-lookup"><span data-stu-id="a5640-139">**AFFINITY**</span></span>  
  
     <span data-ttu-id="a5640-140">通过此设置，您可以将某一资源池与一个或多个计划程序或 NUMA 节点相关联，以便实现更好的对 CPU 资源的隔离。</span><span class="sxs-lookup"><span data-stu-id="a5640-140">This setting lets you affinitize a resource pool to one or more schedulers or NUMA nodes for greater isolation of CPU resources.</span></span> <span data-ttu-id="a5640-141">使用上面的销售和营销方案，假定销售部门需要更好隔离的环境，并且希望在所有时候都占用 100% 的 CPU 内核。</span><span class="sxs-lookup"><span data-stu-id="a5640-141">Using the Sales and Marketing scenario above, lets assume that the Sales department needs a more isolated environment and wants 100 percent of a CPU core at all times.</span></span> <span data-ttu-id="a5640-142">通过使用 AFFINITY 选项，可在不同的 CPU 上计划销售和营销工作负荷。</span><span class="sxs-lookup"><span data-stu-id="a5640-142">By using the AFFINITY option the Sales and Marketing workloads can be scheduled on different CPUs.</span></span> <span data-ttu-id="a5640-143">假定针对“营销”池的 CAP_CPU_PERCENT 仍存在，并且营销工作负荷继续占用一个内核的最高 30%，而销售工作负荷占用其他内核的 100%。</span><span class="sxs-lookup"><span data-stu-id="a5640-143">Assuming the CAP_CPU_PERCENT on the Marketing pool is still in place, the Marketing workload continues to use a maximum of 30 percent of one core, while the Sales workload uses 100 percent of the other core.</span></span> <span data-ttu-id="a5640-144">就销售和营销工作负荷而言，它们运行在两个独立的计算机上。</span><span class="sxs-lookup"><span data-stu-id="a5640-144">As far as the Sales and Marketing workloads are concerned, they are running on two isolated machines.</span></span>  
  
-   <span data-ttu-id="a5640-145">**MIN_IOPS_PER_VOLUME 和 MAX_IOPS_PER_VOLUME**</span><span class="sxs-lookup"><span data-stu-id="a5640-145">**MIN_IOPS_PER_VOLUME and MAX_IOPS_PER_VOLUME**</span></span>  
  
     <span data-ttu-id="a5640-146">这些设置是针对某一资源池的每个磁盘卷每秒的最小和最大物理 IO 操作数 (IOPS)。</span><span class="sxs-lookup"><span data-stu-id="a5640-146">These settings are the minimum and maximum physical IO operations per second (IOPS) per disk volume for a resource pool.</span></span> <span data-ttu-id="a5640-147">您可以使用这些设置控制针对某一给定资源池的用户线程而发出的物理 IO 数。</span><span class="sxs-lookup"><span data-stu-id="a5640-147">You can use these settings to control the physical IOs issued for user threads for a given resource pool.</span></span> <span data-ttu-id="a5640-148">例如，销售部门在较大批次中生成若干月末报表。</span><span class="sxs-lookup"><span data-stu-id="a5640-148">For example, the Sales department generates several end-of-month reports in large batches.</span></span> <span data-ttu-id="a5640-149">这些批次中的查询可生成可导致磁盘卷饱和并且影响数据库中其他更高优先级工作负荷性能的 IO。</span><span class="sxs-lookup"><span data-stu-id="a5640-149">The queries in these batches can generate IOs that can saturate the disk volume and impact the performance of other higher priority workloads in the database.</span></span> <span data-ttu-id="a5640-150">若要隔离此工作负荷，对于销售部门资源池，将 MIN_IOPS_PER_VOLUME 设置为 20，并将 MAX_IOPS_PER_VOLUME 设置为 100，以此控制可发出用于工作负荷的 IO 级别。</span><span class="sxs-lookup"><span data-stu-id="a5640-150">To isolate this workload, the MIN_IOPS_PER_VOLUME is set to 20 and the MAX_IOPS_PER_VOLUME is set to 100 for the Sales department resource pool, which controls the level of IOs that can issued for the workload.</span></span>  
  
 <span data-ttu-id="a5640-151">配置 CPU 或内存时，所有池的 MIN 值之和不能超过服务器资源的 100%。</span><span class="sxs-lookup"><span data-stu-id="a5640-151">When configuring CPU or Memory, the sum of MIN values across all pools cannot exceed 100 percent of the server resources.</span></span> <span data-ttu-id="a5640-152">此外，配置 CPU 或内存时，MAX 值和 CAP 值可以设置为 MIN 和 100% 之间（包括 100%）的任何值。</span><span class="sxs-lookup"><span data-stu-id="a5640-152">In addition, when configuring CPU or Memory, MAX and CAP values can be set anywhere in the range between MIN and 100 percent inclusive.</span></span>  
  
 <span data-ttu-id="a5640-153">如果某个池定义了非零 MIN，将重新调整其他池的有效 MAX 值。</span><span class="sxs-lookup"><span data-stu-id="a5640-153">If a pool has a nonzero MIN defined, the effective MAX value of other pools is readjusted.</span></span> <span data-ttu-id="a5640-154">从 100% 中减去为某个池配置的 MAX 值的最小值以及其他池的 MIN 值之和。</span><span class="sxs-lookup"><span data-stu-id="a5640-154">The minimum of the configured MAX value of a pool and the sum of the MIN values of other pools is subtracted from 100 percent.</span></span>  
  
 <span data-ttu-id="a5640-155">下表说明了几个上述概念。</span><span class="sxs-lookup"><span data-stu-id="a5640-155">The following table illustrates a few of the preceding concepts.</span></span> <span data-ttu-id="a5640-156">该表显示了内部池、默认池和两个用户定义池的设置。</span><span class="sxs-lookup"><span data-stu-id="a5640-156">The table shows the settings for the internal pool, the default pool, and two user-defined pools.</span></span> <span data-ttu-id="a5640-157">下面的公式用于计算有效 MAX 百分比和共享百分比。</span><span class="sxs-lookup"><span data-stu-id="a5640-157">The following formulas are used for calculating the effective MAX% and the shared %.</span></span>  
  
-   <span data-ttu-id="a5640-158">Min(X,Y) 表示 X 和 Y 中的较小值。</span><span class="sxs-lookup"><span data-stu-id="a5640-158">Min(X,Y) means the smaller value of X and Y.</span></span>  
  
-   <span data-ttu-id="a5640-159">Sum(X) 表示所有池的 X 值之和。</span><span class="sxs-lookup"><span data-stu-id="a5640-159">Sum(X) means the sum of value X across all pools.</span></span>  
  
-   <span data-ttu-id="a5640-160">总计共享百分比 = 100 - sum(MIN %)。</span><span class="sxs-lookup"><span data-stu-id="a5640-160">Total shared % = 100 - sum(MIN %).</span></span>  
  
-   <span data-ttu-id="a5640-161">有效 MAX 百分比 = min(X,Y)。</span><span class="sxs-lookup"><span data-stu-id="a5640-161">Effective MAX % = min(X,Y).</span></span>  
  
-   <span data-ttu-id="a5640-162">共享百分比 = 有效 MAX 百分比 - MIN 百分比。</span><span class="sxs-lookup"><span data-stu-id="a5640-162">Shared % = Effective MAX % - MIN %.</span></span>  
  
|<span data-ttu-id="a5640-163">池名称</span><span class="sxs-lookup"><span data-stu-id="a5640-163">Pool name</span></span>|<span data-ttu-id="a5640-164">MIN 百分比设置</span><span class="sxs-lookup"><span data-stu-id="a5640-164">MIN % setting</span></span>|<span data-ttu-id="a5640-165">MAX 百分比设置</span><span class="sxs-lookup"><span data-stu-id="a5640-165">MAX % setting</span></span>|<span data-ttu-id="a5640-166">计算的有效 MAX 百分比</span><span class="sxs-lookup"><span data-stu-id="a5640-166">Calculated effective MAX %</span></span>|<span data-ttu-id="a5640-167">计算的共享百分比</span><span class="sxs-lookup"><span data-stu-id="a5640-167">Calculated shared %</span></span>|<span data-ttu-id="a5640-168">注释</span><span class="sxs-lookup"><span data-stu-id="a5640-168">Comment</span></span>|  
|---------------|-------------------|-------------------|--------------------------------|-------------------------|-------------|  
|<span data-ttu-id="a5640-169">内部</span><span class="sxs-lookup"><span data-stu-id="a5640-169">internal</span></span>|<span data-ttu-id="a5640-170">0</span><span class="sxs-lookup"><span data-stu-id="a5640-170">0</span></span>|<span data-ttu-id="a5640-171">100</span><span class="sxs-lookup"><span data-stu-id="a5640-171">100</span></span>|<span data-ttu-id="a5640-172">100</span><span class="sxs-lookup"><span data-stu-id="a5640-172">100</span></span>|<span data-ttu-id="a5640-173">0</span><span class="sxs-lookup"><span data-stu-id="a5640-173">0</span></span>|<span data-ttu-id="a5640-174">有效 MAX 百分比和共享百分比不适用于内部池。</span><span class="sxs-lookup"><span data-stu-id="a5640-174">Effective MAX% and shared% are not applicable to the internal pool.</span></span>|  
|<span data-ttu-id="a5640-175">default</span><span class="sxs-lookup"><span data-stu-id="a5640-175">default</span></span>|<span data-ttu-id="a5640-176">0</span><span class="sxs-lookup"><span data-stu-id="a5640-176">0</span></span>|<span data-ttu-id="a5640-177">100</span><span class="sxs-lookup"><span data-stu-id="a5640-177">100</span></span>|<span data-ttu-id="a5640-178">30</span><span class="sxs-lookup"><span data-stu-id="a5640-178">30</span></span>|<span data-ttu-id="a5640-179">30</span><span class="sxs-lookup"><span data-stu-id="a5640-179">30</span></span>|<span data-ttu-id="a5640-180">有效 MAX 值的计算如下：min(100,100-(20+50)) = 30。</span><span class="sxs-lookup"><span data-stu-id="a5640-180">The effective MAX value is calculated as: min(100,100-(20+50)) = 30.</span></span> <span data-ttu-id="a5640-181">计算的共享百分比为有效 MAX - MIN = 30。</span><span class="sxs-lookup"><span data-stu-id="a5640-181">The calculated shared % is effective MAX - MIN = 30.</span></span>|  
|<span data-ttu-id="a5640-182">池 1</span><span class="sxs-lookup"><span data-stu-id="a5640-182">Pool 1</span></span>|<span data-ttu-id="a5640-183">20</span><span class="sxs-lookup"><span data-stu-id="a5640-183">20</span></span>|<span data-ttu-id="a5640-184">100</span><span class="sxs-lookup"><span data-stu-id="a5640-184">100</span></span>|<span data-ttu-id="a5640-185">50</span><span class="sxs-lookup"><span data-stu-id="a5640-185">50</span></span>|<span data-ttu-id="a5640-186">30</span><span class="sxs-lookup"><span data-stu-id="a5640-186">30</span></span>|<span data-ttu-id="a5640-187">有效 MAX 值的计算方式为：min(100,100-50) = 50。</span><span class="sxs-lookup"><span data-stu-id="a5640-187">The effective MAX value is calculated as: min(100,100-50) = 50.</span></span> <span data-ttu-id="a5640-188">计算的共享百分比为有效 MAX - MIN = 30。</span><span class="sxs-lookup"><span data-stu-id="a5640-188">The calculated Shared % is Effective MAX - MIN = 30.</span></span>|  
|<span data-ttu-id="a5640-189">池 2</span><span class="sxs-lookup"><span data-stu-id="a5640-189">Pool 2</span></span>|<span data-ttu-id="a5640-190">50</span><span class="sxs-lookup"><span data-stu-id="a5640-190">50</span></span>|<span data-ttu-id="a5640-191">70</span><span class="sxs-lookup"><span data-stu-id="a5640-191">70</span></span>|<span data-ttu-id="a5640-192">70</span><span class="sxs-lookup"><span data-stu-id="a5640-192">70</span></span>|<span data-ttu-id="a5640-193">20</span><span class="sxs-lookup"><span data-stu-id="a5640-193">20</span></span>|<span data-ttu-id="a5640-194">有效 MAX 值的计算方式为：min(70,100-20) = 70。</span><span class="sxs-lookup"><span data-stu-id="a5640-194">The effective MAX value is calculated as: min(70,100-20) = 70.</span></span> <span data-ttu-id="a5640-195">共享百分比的计算方式为：有效 MAX - MIN = 20。</span><span class="sxs-lookup"><span data-stu-id="a5640-195">The calculated Shared % is Effective MAX - MIN = 20.</span></span>|  
  
 <span data-ttu-id="a5640-196">以上表为示例，我们可以进一步说明创建其他池时进行的调整。</span><span class="sxs-lookup"><span data-stu-id="a5640-196">Using the preceding table as an example we can further illustrate the adjustments that take place when another pool is created.</span></span> <span data-ttu-id="a5640-197">此池为池 3，MIN 百分比设置为 5。</span><span class="sxs-lookup"><span data-stu-id="a5640-197">This pool is Pool 3 and has a MIN % setting of 5.</span></span>  
  
|<span data-ttu-id="a5640-198">池名称</span><span class="sxs-lookup"><span data-stu-id="a5640-198">Pool name</span></span>|<span data-ttu-id="a5640-199">MIN 百分比设置</span><span class="sxs-lookup"><span data-stu-id="a5640-199">MIN % setting</span></span>|<span data-ttu-id="a5640-200">MAX 百分比设置</span><span class="sxs-lookup"><span data-stu-id="a5640-200">MAX % setting</span></span>|<span data-ttu-id="a5640-201">计算的有效 MAX 百分比</span><span class="sxs-lookup"><span data-stu-id="a5640-201">Calculated effective MAX %</span></span>|<span data-ttu-id="a5640-202">计算的共享百分比</span><span class="sxs-lookup"><span data-stu-id="a5640-202">Calculated shared %</span></span>|<span data-ttu-id="a5640-203">注释</span><span class="sxs-lookup"><span data-stu-id="a5640-203">Comment</span></span>|  
|---------------|-------------------|-------------------|--------------------------------|-------------------------|-------------|  
|<span data-ttu-id="a5640-204">内部</span><span class="sxs-lookup"><span data-stu-id="a5640-204">internal</span></span>|<span data-ttu-id="a5640-205">0</span><span class="sxs-lookup"><span data-stu-id="a5640-205">0</span></span>|<span data-ttu-id="a5640-206">100</span><span class="sxs-lookup"><span data-stu-id="a5640-206">100</span></span>|<span data-ttu-id="a5640-207">100</span><span class="sxs-lookup"><span data-stu-id="a5640-207">100</span></span>|<span data-ttu-id="a5640-208">0</span><span class="sxs-lookup"><span data-stu-id="a5640-208">0</span></span>|<span data-ttu-id="a5640-209">有效 MAX 百分比和共享百分比不适用于内部池。</span><span class="sxs-lookup"><span data-stu-id="a5640-209">Effective MAX % and shared % are not applicable to the internal pool.</span></span>|  
|<span data-ttu-id="a5640-210">default</span><span class="sxs-lookup"><span data-stu-id="a5640-210">default</span></span>|<span data-ttu-id="a5640-211">0</span><span class="sxs-lookup"><span data-stu-id="a5640-211">0</span></span>|<span data-ttu-id="a5640-212">100</span><span class="sxs-lookup"><span data-stu-id="a5640-212">100</span></span>|<span data-ttu-id="a5640-213">25</span><span class="sxs-lookup"><span data-stu-id="a5640-213">25</span></span>|<span data-ttu-id="a5640-214">25</span><span class="sxs-lookup"><span data-stu-id="a5640-214">25</span></span>|<span data-ttu-id="a5640-215">有效 MAX 值的计算如下：min(100,100-(20+50+5)) = 25。</span><span class="sxs-lookup"><span data-stu-id="a5640-215">The effective MAX value is calculated as: min(100,100-(20+50+5)) = 25.</span></span> <span data-ttu-id="a5640-216">计算的共享百分比为有效 MAX - MIN = 25。</span><span class="sxs-lookup"><span data-stu-id="a5640-216">The calculated shared % is Effective MAX - MIN = 25.</span></span>|  
|<span data-ttu-id="a5640-217">池 1</span><span class="sxs-lookup"><span data-stu-id="a5640-217">Pool 1</span></span>|<span data-ttu-id="a5640-218">20</span><span class="sxs-lookup"><span data-stu-id="a5640-218">20</span></span>|<span data-ttu-id="a5640-219">100</span><span class="sxs-lookup"><span data-stu-id="a5640-219">100</span></span>|<span data-ttu-id="a5640-220">45</span><span class="sxs-lookup"><span data-stu-id="a5640-220">45</span></span>|<span data-ttu-id="a5640-221">25</span><span class="sxs-lookup"><span data-stu-id="a5640-221">25</span></span>|<span data-ttu-id="a5640-222">有效 MAX 值的计算方式为：min(100,100-55) = 45。</span><span class="sxs-lookup"><span data-stu-id="a5640-222">The effective MAX value is calculated as: min(100,100-55) = 45.</span></span> <span data-ttu-id="a5640-223">计算的共享百分比为有效 MAX - MIN = 25。</span><span class="sxs-lookup"><span data-stu-id="a5640-223">The calculated Shared % is Effective MAX - MIN = 25.</span></span>|  
|<span data-ttu-id="a5640-224">池 2</span><span class="sxs-lookup"><span data-stu-id="a5640-224">Pool 2</span></span>|<span data-ttu-id="a5640-225">50</span><span class="sxs-lookup"><span data-stu-id="a5640-225">50</span></span>|<span data-ttu-id="a5640-226">70</span><span class="sxs-lookup"><span data-stu-id="a5640-226">70</span></span>|<span data-ttu-id="a5640-227">70</span><span class="sxs-lookup"><span data-stu-id="a5640-227">70</span></span>|<span data-ttu-id="a5640-228">20</span><span class="sxs-lookup"><span data-stu-id="a5640-228">20</span></span>|<span data-ttu-id="a5640-229">有效 MAX 值的计算方式为：min(70,100-25) = 70。</span><span class="sxs-lookup"><span data-stu-id="a5640-229">The effective MAX value is calculated as: min(70,100-25) = 70.</span></span> <span data-ttu-id="a5640-230">共享百分比的计算方式为：有效 MAX - MIN = 20。</span><span class="sxs-lookup"><span data-stu-id="a5640-230">The calculated Shared % is effective MAX - MIN = 20.</span></span>|  
|<span data-ttu-id="a5640-231">池 3</span><span class="sxs-lookup"><span data-stu-id="a5640-231">Pool 3</span></span>|<span data-ttu-id="a5640-232">5</span><span class="sxs-lookup"><span data-stu-id="a5640-232">5</span></span>|<span data-ttu-id="a5640-233">100</span><span class="sxs-lookup"><span data-stu-id="a5640-233">100</span></span>|<span data-ttu-id="a5640-234">30</span><span class="sxs-lookup"><span data-stu-id="a5640-234">30</span></span>|<span data-ttu-id="a5640-235">25</span><span class="sxs-lookup"><span data-stu-id="a5640-235">25</span></span>|<span data-ttu-id="a5640-236">有效 MAX 值的计算如下：min(100,100-70) = 30。</span><span class="sxs-lookup"><span data-stu-id="a5640-236">The effective MAX value is calculated as: min(100,100-70) = 30.</span></span> <span data-ttu-id="a5640-237">计算的共享百分比为有效 MAX - MIN = 25。</span><span class="sxs-lookup"><span data-stu-id="a5640-237">The calculated Shared % is effective MAX - MIN = 25.</span></span>|  
  
 <span data-ttu-id="a5640-238">池的共享部分用于指示在有可用资源时，可用资源的流向。</span><span class="sxs-lookup"><span data-stu-id="a5640-238">The shared part of the pool is used to indicate where available resources can go if resources are available.</span></span> <span data-ttu-id="a5640-239">但是，在消耗资源时，资源流向指定的池，不能共享。</span><span class="sxs-lookup"><span data-stu-id="a5640-239">However, when resources are consumed they go to the specified pool and are not shared.</span></span> <span data-ttu-id="a5640-240">这在给定池中没有请求并且为该池指定的资源可以释放到其他池时，能够提高资源使用率。</span><span class="sxs-lookup"><span data-stu-id="a5640-240">This may improve resource utilization in cases where there are no requests in a given pool and the resources configured to the pool can be freed up for other pools.</span></span>  
  
 <span data-ttu-id="a5640-241">池配置的某些极特殊情况是：</span><span class="sxs-lookup"><span data-stu-id="a5640-241">Some extreme cases of pool configuration are:</span></span>  
  
-   <span data-ttu-id="a5640-242">所有池定义的最小值的总计表示 100% 的服务器资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-242">All pools define minimums that in total represent 100 percent of the server resources.</span></span> <span data-ttu-id="a5640-243">在这种情况下，有效最大值等于最小值。</span><span class="sxs-lookup"><span data-stu-id="a5640-243">In this case the effective maximums are equal to minimums.</span></span> <span data-ttu-id="a5640-244">这等于将服务器资源划分为无重叠部分，而不考虑任何指定池内的资源消耗情况。</span><span class="sxs-lookup"><span data-stu-id="a5640-244">This is equivalent to dividing the server resources into non-overlapping pieces regardless of resources are consumed inside any given pool.</span></span>  
  
-   <span data-ttu-id="a5640-245">所有池的最小值为零。</span><span class="sxs-lookup"><span data-stu-id="a5640-245">All pools have zero minimums.</span></span> <span data-ttu-id="a5640-246">所有池竞争使用可用资源，其最终大小基于各个池消耗的资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-246">All the pools compete for available resources and their final sizes are based on resource consumption in each pool.</span></span> <span data-ttu-id="a5640-247">其他因素（如策略）也对调整最终池大小起作用。</span><span class="sxs-lookup"><span data-stu-id="a5640-247">Other factors such as policies play a role in shaping the final pool size.</span></span>  
  
 <span data-ttu-id="a5640-248">资源调控器预定义两个资源池：内部池和默认池。</span><span class="sxs-lookup"><span data-stu-id="a5640-248">Resource Governor predefines two resource pools, the internal pool and the default pool.</span></span>  
  
 <span data-ttu-id="a5640-249">**内部池**</span><span class="sxs-lookup"><span data-stu-id="a5640-249">**Internal Pool**</span></span>  
  
 <span data-ttu-id="a5640-250">内部池表示由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 自身消耗的资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-250">The internal pool represents the resources consumed by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] itself.</span></span> <span data-ttu-id="a5640-251">这个池始终只包含内部组，在任何情况下都不允许更改池。</span><span class="sxs-lookup"><span data-stu-id="a5640-251">This pool always contains only the internal group, and the pool is not alterable in any way.</span></span> <span data-ttu-id="a5640-252">不限制内部池的资源消耗。</span><span class="sxs-lookup"><span data-stu-id="a5640-252">Resource consumption by the internal pool is not restricted.</span></span> <span data-ttu-id="a5640-253">池中的所有工作负荷均视为服务器函数的关键内容，资源调控器允许内部池在与其他池的限制发生冲突时争用资源。</span><span class="sxs-lookup"><span data-stu-id="a5640-253">Any workloads in the pool are considered critical for server function, and Resource Governor allows the internal pool to pressure other pools even if it means the violation of limits set for the other pools.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a5640-254">不从总体资源使用情况中减去内部池和内部组资源使用情况。</span><span class="sxs-lookup"><span data-stu-id="a5640-254">The internal pool and internal group resource usage is not subtracted from the overall resource usage.</span></span> <span data-ttu-id="a5640-255">使用可用的总体资源计算百分比。</span><span class="sxs-lookup"><span data-stu-id="a5640-255">Percentages are calculated from the overall resources available.</span></span>  
  
 <span data-ttu-id="a5640-256">**默认池**</span><span class="sxs-lookup"><span data-stu-id="a5640-256">**Default Pool**</span></span>  
  
 <span data-ttu-id="a5640-257">默认池是第一个预定义的用户池。</span><span class="sxs-lookup"><span data-stu-id="a5640-257">The default pool is the first predefined user pool.</span></span> <span data-ttu-id="a5640-258">在进行任何配置之前，默认池只包含默认组。</span><span class="sxs-lookup"><span data-stu-id="a5640-258">Prior to any configuration the default pool only contains the default group.</span></span> <span data-ttu-id="a5640-259">不能创建或删除默认池，但可以更改。</span><span class="sxs-lookup"><span data-stu-id="a5640-259">The default pool cannot be created or dropped but it can be altered.</span></span> <span data-ttu-id="a5640-260">默认池除了包含默认组，还可以包含用户定义的组。</span><span class="sxs-lookup"><span data-stu-id="a5640-260">The default pool can contain user-defined groups in addition to the default group.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a5640-261">可以更改默认组，但不能从默认池中移出。</span><span class="sxs-lookup"><span data-stu-id="a5640-261">The default group is alterable but it cannot be moved out of the default pool.</span></span>  
  
 <span data-ttu-id="a5640-262">**用户定义的资源池**</span><span class="sxs-lookup"><span data-stu-id="a5640-262">**User-Defined Resource Pools**</span></span>  
  
 <span data-ttu-id="a5640-263">用户定义的资源池是在您的环境中为特定的工作负荷创建的资源池。</span><span class="sxs-lookup"><span data-stu-id="a5640-263">User-defined resource pools are those that you create for specific workloads in your environment.</span></span> <span data-ttu-id="a5640-264">资源调控器提供用于创建、更改和删除资源池的 DDL 语句。</span><span class="sxs-lookup"><span data-stu-id="a5640-264">Resource Governor provides DDL statements for creating, changing, and dropping resource pools.</span></span>  
  
## <a name="resource-pool-tasks"></a><span data-ttu-id="a5640-265">资源池任务</span><span class="sxs-lookup"><span data-stu-id="a5640-265">Resource Pool Tasks</span></span>  
  
|<span data-ttu-id="a5640-266">任务说明</span><span class="sxs-lookup"><span data-stu-id="a5640-266">Task Description</span></span>|<span data-ttu-id="a5640-267">主题</span><span class="sxs-lookup"><span data-stu-id="a5640-267">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="a5640-268">说明如何创建一个资源池。</span><span class="sxs-lookup"><span data-stu-id="a5640-268">Describes how to create a resource pool.</span></span>|[<span data-ttu-id="a5640-269">创建资源池</span><span class="sxs-lookup"><span data-stu-id="a5640-269">Create a Resource Pool</span></span>](create-a-resource-pool.md)|  
|<span data-ttu-id="a5640-270">说明如何更改资源池设置。</span><span class="sxs-lookup"><span data-stu-id="a5640-270">Describes how to change resource pool settings.</span></span>|[<span data-ttu-id="a5640-271">更改资源池设置</span><span class="sxs-lookup"><span data-stu-id="a5640-271">Change Resource Pool Settings</span></span>](change-resource-pool-settings.md)|  
|<span data-ttu-id="a5640-272">说明如何删除资源池。</span><span class="sxs-lookup"><span data-stu-id="a5640-272">Describes how to delete a resource pool.</span></span>|[<span data-ttu-id="a5640-273">删除资源池</span><span class="sxs-lookup"><span data-stu-id="a5640-273">Delete a Resource Pool</span></span>](delete-a-resource-pool.md)|  
  
## <a name="see-also"></a><span data-ttu-id="a5640-274">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a5640-274">See Also</span></span>  
 <span data-ttu-id="a5640-275">[资源调控器](resource-governor.md) </span><span class="sxs-lookup"><span data-stu-id="a5640-275">[Resource Governor](resource-governor.md) </span></span>  
 <span data-ttu-id="a5640-276">[资源调控器工作负荷组](resource-governor-workload-group.md) </span><span class="sxs-lookup"><span data-stu-id="a5640-276">[Resource Governor Workload Group](resource-governor-workload-group.md) </span></span>  
 <span data-ttu-id="a5640-277">[资源调控器分类器函数](resource-governor-classifier-function.md) </span><span class="sxs-lookup"><span data-stu-id="a5640-277">[Resource Governor Classifier Function](resource-governor-classifier-function.md) </span></span>  
 <span data-ttu-id="a5640-278">[使用模板配置资源调控器](configure-resource-governor-using-a-template.md) </span><span class="sxs-lookup"><span data-stu-id="a5640-278">[Configure Resource Governor Using a Template](configure-resource-governor-using-a-template.md) </span></span>  
 [<span data-ttu-id="a5640-279">查看资源调控器属性</span><span class="sxs-lookup"><span data-stu-id="a5640-279">View Resource Governor Properties</span></span>](view-resource-governor-properties.md)  
  
  
