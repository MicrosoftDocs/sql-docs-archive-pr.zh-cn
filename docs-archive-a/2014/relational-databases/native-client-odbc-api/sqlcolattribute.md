---
title: SQLColAttribute |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLColAttribute function
ms.assetid: a5387d9e-a243-4cfe-b786-7fad5842b1d6
author: rothja
ms.author: jroth
ms.openlocfilehash: 10207fe12a7bea5b5edb8c6e558aec6ce3b2f148
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87581189"
---
# <a name="sqlcolattribute"></a><span data-ttu-id="da72c-102">SQLColAttribute</span><span class="sxs-lookup"><span data-stu-id="da72c-102">SQLColAttribute</span></span>
  <span data-ttu-id="da72c-103">您可以使用 `SQLColAttribute` 检索已准备或执行的 ODBC 语句的结果集列的属性。</span><span class="sxs-lookup"><span data-stu-id="da72c-103">You can use `SQLColAttribute` to retrieve an attribute of a result set column for either prepared or executed ODBC statements.</span></span> <span data-ttu-id="da72c-104">`SQLColAttribute`对预定义语句调用将导致往返 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="da72c-104">Calling `SQLColAttribute` on prepared statements causes a roundtrip to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="da72c-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序接收语句执行过程中的结果集列数据，因此，在 `SQLColAttribute` **SQLExecute**或**SQLExecDirect**完成后调用，不涉及服务器往返。</span><span class="sxs-lookup"><span data-stu-id="da72c-105">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver receives result set column data as part of statement execution, so calling `SQLColAttribute` after the completion of **SQLExecute** or **SQLExecDirect** does not involve a server roundtrip.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="da72c-106">ODBC 列标识符属性并非可用于所有 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-106">ODBC column identifier attributes are not available on all [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] result sets.</span></span>  
  
|<span data-ttu-id="da72c-107">字段标识符</span><span class="sxs-lookup"><span data-stu-id="da72c-107">Field identifier</span></span>|<span data-ttu-id="da72c-108">说明</span><span class="sxs-lookup"><span data-stu-id="da72c-108">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="da72c-109">SQL_COLUMN_TABLE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-109">SQL_COLUMN_TABLE_NAME</span></span>|<span data-ttu-id="da72c-110">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-110">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span>|  
|<span data-ttu-id="da72c-111">SQL_DESC_BASE_COLUMN_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-111">SQL_DESC_BASE_COLUMN_NAME</span></span>|<span data-ttu-id="da72c-112">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-112">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span>|  
|<span data-ttu-id="da72c-113">SQL_DESC_BASE_TABLE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-113">SQL_DESC_BASE_TABLE_NAME</span></span>|<span data-ttu-id="da72c-114">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-114">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span>|  
|<span data-ttu-id="da72c-115">SQL_DESC_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-115">SQL_DESC_CATALOG_NAME</span></span>|<span data-ttu-id="da72c-116">数据库名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-116">Database name.</span></span> <span data-ttu-id="da72c-117">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-117">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span>|  
|<span data-ttu-id="da72c-118">SQL_DESC_LABEL</span><span class="sxs-lookup"><span data-stu-id="da72c-118">SQL_DESC_LABEL</span></span>|<span data-ttu-id="da72c-119">可用于所有结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-119">Available on all result sets.</span></span> <span data-ttu-id="da72c-120">此值与 SQL_DESC_NAME 字段的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="da72c-120">The value is identical to the value of the SQL_DESC_NAME field.</span></span><br /><br /> <span data-ttu-id="da72c-121">仅当某列是表达式的结果，并且表达式不包含标签分配时，此字段的长度才为零。</span><span class="sxs-lookup"><span data-stu-id="da72c-121">The field is zero length only if a column is the result of an expression and the expression does not contain a label assignment.</span></span>|  
|<span data-ttu-id="da72c-122">SQL_DESC_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-122">SQL_DESC_NAME</span></span>|<span data-ttu-id="da72c-123">可用于所有结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-123">Available on all result sets.</span></span> <span data-ttu-id="da72c-124">此值与 SQL_DESC_LABEL 字段的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="da72c-124">The value is identical to the value of the SQL_DESC_LABEL field.</span></span><br /><br /> <span data-ttu-id="da72c-125">仅当某列是表达式的结果，并且表达式不包含标签分配时，此字段的长度才为零。</span><span class="sxs-lookup"><span data-stu-id="da72c-125">The field is zero length only if a column is the result of an expression and the expression does not contain a label assignment.</span></span>|  
|<span data-ttu-id="da72c-126">SQL_DESC_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-126">SQL_DESC_SCHEMA_NAME</span></span>|<span data-ttu-id="da72c-127">所有者名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-127">Owner name.</span></span> <span data-ttu-id="da72c-128">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-128">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span><br /><br /> <span data-ttu-id="da72c-129">仅当在 SELECT 语句中为列指定所有者名称时才可用。</span><span class="sxs-lookup"><span data-stu-id="da72c-129">Available only if the owner name is specified for the column in the SELECT statement.</span></span>|  
|<span data-ttu-id="da72c-130">SQL_DESC_TABLE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-130">SQL_DESC_TABLE_NAME</span></span>|<span data-ttu-id="da72c-131">可用于从生成服务器游标的语句检索的结果集，或从包含 FOR BROWSE 子句的已执行 SELECT 语句检索的结果集。</span><span class="sxs-lookup"><span data-stu-id="da72c-131">Available on result sets retrieved from statements that generate server cursors or on executed SELECT statements containing a FOR BROWSE clause.</span></span>|  
|<span data-ttu-id="da72c-132">SQL_DESC_UNNAMED</span><span class="sxs-lookup"><span data-stu-id="da72c-132">SQL_DESC_UNNAMED</span></span>|<span data-ttu-id="da72c-133">对于结果集中的所有列均为 SQL_NAMED，除非某列是不包含标签分配作为表达式一部分的表达式的结果。</span><span class="sxs-lookup"><span data-stu-id="da72c-133">SQL_NAMED for all columns in a result set unless a column is the result of an expression that does not contain a label assignment as part of the expression.</span></span> <span data-ttu-id="da72c-134">当 SQL_DESC_UNNAMED 返回 SQL_UNNAMED 时，所有 ODBC 列标识符属性对于该列都包含零长度字符串。</span><span class="sxs-lookup"><span data-stu-id="da72c-134">When SQL_DESC_UNNAMED returns SQL_UNNAMED, all ODBC column identifier attributes contain zero length strings for the column.</span></span>|  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="da72c-135">当为 `SQLColAttribute` 已准备好但未执行的语句调用时，Native CLIENT ODBC 驱动程序使用 SET FMTONLY 语句来减少服务器开销。</span><span class="sxs-lookup"><span data-stu-id="da72c-135">Native Client ODBC driver uses the SET FMTONLY statement to reduce server overhead when `SQLColAttribute` is called for prepared but unexecuted statements.</span></span>  
  
 <span data-ttu-id="da72c-136">对于大值类型， `SQLColAttribute` 将返回以下值：</span><span class="sxs-lookup"><span data-stu-id="da72c-136">For large value types, `SQLColAttribute` will return the following values:</span></span>  
  
|<span data-ttu-id="da72c-137">字段标识符</span><span class="sxs-lookup"><span data-stu-id="da72c-137">Field identifier</span></span>|<span data-ttu-id="da72c-138">更改说明</span><span class="sxs-lookup"><span data-stu-id="da72c-138">Description of change</span></span>|  
|----------------------|---------------------------|  
|<span data-ttu-id="da72c-139">SQL_DESC_DISPLAY_SIZE</span><span class="sxs-lookup"><span data-stu-id="da72c-139">SQL_DESC_DISPLAY_SIZE</span></span>|<span data-ttu-id="da72c-140">这是要显示列中数据所需的最大字符数。</span><span class="sxs-lookup"><span data-stu-id="da72c-140">This is the maximum number of characters required to display data from the column.</span></span> <span data-ttu-id="da72c-141">对于大值类型列，返回的值为 SQL_SS_LENGTH_UNLIMITED。</span><span class="sxs-lookup"><span data-stu-id="da72c-141">For large value type columns, the value returned is SQL_SS_LENGTH_UNLIMITED.</span></span>|  
|<span data-ttu-id="da72c-142">SQL_DESC_LENGTH</span><span class="sxs-lookup"><span data-stu-id="da72c-142">SQL_DESC_LENGTH</span></span>|<span data-ttu-id="da72c-143">返回结果集中该列的实际长度。</span><span class="sxs-lookup"><span data-stu-id="da72c-143">Returns the actual length of the column in the result set.</span></span> <span data-ttu-id="da72c-144">对于大值类型列，返回的值为 SQL_SS_LENGTH_UNLIMITED。</span><span class="sxs-lookup"><span data-stu-id="da72c-144">For large value type columns, the value returned is SQL_SS_LENGTH_UNLIMITED.</span></span>|  
|<span data-ttu-id="da72c-145">SQL_DESC_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="da72c-145">SQL_DESC_OCTET_LENGTH</span></span>|<span data-ttu-id="da72c-146">返回大值类型列的最大长度。</span><span class="sxs-lookup"><span data-stu-id="da72c-146">Returns the maximum length of a large value type column.</span></span> <span data-ttu-id="da72c-147">SQL_SS_LENGTH_UNLIMITED 用于指示大小不受限制。</span><span class="sxs-lookup"><span data-stu-id="da72c-147">SQL_SS_LENGTH_UNLIMITED is used to indicate unlimited size.</span></span>|  
|<span data-ttu-id="da72c-148">SQL_DESC_PRECISION</span><span class="sxs-lookup"><span data-stu-id="da72c-148">SQL_DESC_PRECISION</span></span>|<span data-ttu-id="da72c-149">对于大值类型列，返回值 SQL_SS_LENGTH_UNLIMITED。</span><span class="sxs-lookup"><span data-stu-id="da72c-149">Returns the value SQL_SS_LENGTH_UNLIMITED for large value type columns.</span></span>|  
|<span data-ttu-id="da72c-150">SQL_DESC_TYPE</span><span class="sxs-lookup"><span data-stu-id="da72c-150">SQL_DESC_TYPE</span></span>|<span data-ttu-id="da72c-151">对于大值类型，返回 SQL_VARCHAR、SQL_WVARCHAR 和 SQL_VARBINARY。</span><span class="sxs-lookup"><span data-stu-id="da72c-151">Returns SQL_VARCHAR, SQL_WVARCHAR, and SQL_VARBINARY for large value types.</span></span>|  
|<span data-ttu-id="da72c-152">SQL_DESC_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-152">SQL_DESC_TYPE_NAME</span></span>|<span data-ttu-id="da72c-153">对于大值类型，返回“varchar”、“varbinary”和“nvarchar”。</span><span class="sxs-lookup"><span data-stu-id="da72c-153">Returns "varchar", "varbinary", "nvarchar" for the large value types.</span></span>|  
  
 <span data-ttu-id="da72c-154">对于所有版本，当已准备的一批 SQL 语句生成多个结果集时，只为第一个结果集报告列属性。</span><span class="sxs-lookup"><span data-stu-id="da72c-154">For all versions, column attributes are reported for only the first result set when multiple result sets are generated by a prepared batch of SQL statements.</span></span>  
  
 <span data-ttu-id="da72c-155">以下列属性是由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 驱动程序公开的扩展。</span><span class="sxs-lookup"><span data-stu-id="da72c-155">The following column attributes are extensions exposed by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="da72c-156">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序将返回*NumericAttrPtr*参数中的所有值。</span><span class="sxs-lookup"><span data-stu-id="da72c-156">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver returns all values in the *NumericAttrPtr* parameter.</span></span> <span data-ttu-id="da72c-157">这些值作为 SDWORD（signed long，有符号长值）返回，但 SQL_CA_SS_COMPUTE_BYLIST 除外，它是指向 WORD 数组的指针。</span><span class="sxs-lookup"><span data-stu-id="da72c-157">The values are returned as SDWORD (signed long) except SQL_CA_SS_COMPUTE_BYLIST, which is a pointer to a WORD array.</span></span>  
  
|<span data-ttu-id="da72c-158">字段标识符</span><span class="sxs-lookup"><span data-stu-id="da72c-158">Field identifier</span></span>|<span data-ttu-id="da72c-159">返回的值</span><span class="sxs-lookup"><span data-stu-id="da72c-159">Value returned</span></span>|  
|----------------------|--------------------|  
|<span data-ttu-id="da72c-160">SQL_CA_SS_COLUMN_HIDDEN\*</span><span class="sxs-lookup"><span data-stu-id="da72c-160">SQL_CA_SS_COLUMN_HIDDEN\*</span></span>|<span data-ttu-id="da72c-161">如果所引用的列为隐藏主键（创建隐藏主键是为了支持包含 FOR BROWSE 的 Transact-SQL SELECT 语句）的一部分，则为 TRUE。</span><span class="sxs-lookup"><span data-stu-id="da72c-161">TRUE if the column referenced is part of a hidden primary key created to support a Transact-SQL SELECT statement containing FOR BROWSE.</span></span>|  
|<span data-ttu-id="da72c-162">SQL_CA_SS_COLUMN_ID</span><span class="sxs-lookup"><span data-stu-id="da72c-162">SQL_CA_SS_COLUMN_ID</span></span>|<span data-ttu-id="da72c-163">当前 Transact-SQL SELECT 语句内 COMPUTE 子句结果列的序号位置。</span><span class="sxs-lookup"><span data-stu-id="da72c-163">Ordinal position of a COMPUTE clause result column within the current Transact-SQL SELECT statement.</span></span>|  
|<span data-ttu-id="da72c-164">SQL_CA_SS_COLUMN_KEY\*</span><span class="sxs-lookup"><span data-stu-id="da72c-164">SQL_CA_SS_COLUMN_KEY\*</span></span>|<span data-ttu-id="da72c-165">如果所引用的列是该行的主键的一部分且 Transact-SQL SELECT 语句包含 FOR BROWSE，则为 TRUE。</span><span class="sxs-lookup"><span data-stu-id="da72c-165">TRUE if the column referenced is part of a primary key for the row and the Transact-SQL SELECT statement contains FOR BROWSE.</span></span>|  
|<span data-ttu-id="da72c-166">SQL_CA_SS_COLUMN_OP</span><span class="sxs-lookup"><span data-stu-id="da72c-166">SQL_CA_SS_COLUMN_OP</span></span>|<span data-ttu-id="da72c-167">一个整数，用于指定负责 COMPUTE 子句列中的值的聚合运算符。</span><span class="sxs-lookup"><span data-stu-id="da72c-167">Integer specifying the aggregate operator responsible for the value in a COMPUTE clause column.</span></span> <span data-ttu-id="da72c-168">整数值的定义位于 sqlncli.h 中。</span><span class="sxs-lookup"><span data-stu-id="da72c-168">Definitions of the integer values are in sqlncli.h.</span></span>|  
|<span data-ttu-id="da72c-169">SQL_CA_SS_COLUMN_ORDER</span><span class="sxs-lookup"><span data-stu-id="da72c-169">SQL_CA_SS_COLUMN_ORDER</span></span>|<span data-ttu-id="da72c-170">该列在 ODBC 或 Transact-SQL SELECT 语句的 ORDER BY 子句中的序号位置。</span><span class="sxs-lookup"><span data-stu-id="da72c-170">Ordinal position of the column within an ODBC or Transact-SQL SELECT statement's ORDER BY clause.</span></span>|  
|<span data-ttu-id="da72c-171">SQL_CA_SS_COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="da72c-171">SQL_CA_SS_COLUMN_SIZE</span></span>|<span data-ttu-id="da72c-172">将从列中检索的数据值绑定到 SQL_C_BINARY 变量所需的最大长度（以字节为单位）。</span><span class="sxs-lookup"><span data-stu-id="da72c-172">Maximum length, in bytes, required to bind a data value retrieved from the column to a SQL_C_BINARY variable.</span></span>|  
|<span data-ttu-id="da72c-173">SQL_CA_SS_COLUMN_SSTYPE</span><span class="sxs-lookup"><span data-stu-id="da72c-173">SQL_CA_SS_COLUMN_SSTYPE</span></span>|<span data-ttu-id="da72c-174">SQL Server 列中存储的数据的本机数据类型。</span><span class="sxs-lookup"><span data-stu-id="da72c-174">Native data type of data stored in the SQL Server column.</span></span> <span data-ttu-id="da72c-175">类型值的定义位于 sqlncli.h 中。</span><span class="sxs-lookup"><span data-stu-id="da72c-175">Definitions of the type values are in sqlncli.h.</span></span>|  
|<span data-ttu-id="da72c-176">SQL_CA_SS_COLUMN_UTYPE</span><span class="sxs-lookup"><span data-stu-id="da72c-176">SQL_CA_SS_COLUMN_UTYPE</span></span>|<span data-ttu-id="da72c-177">SQL Server 列的用户定义数据类型的基本数据类型。</span><span class="sxs-lookup"><span data-stu-id="da72c-177">Base data type of the SQL Server column's user-defined data type.</span></span> <span data-ttu-id="da72c-178">类型值的定义位于 sqlncli.h 中。</span><span class="sxs-lookup"><span data-stu-id="da72c-178">Definitions of the type values are in sqlncli.h.</span></span>|  
|<span data-ttu-id="da72c-179">SQL_CA_SS_COLUMN_VARYLEN</span><span class="sxs-lookup"><span data-stu-id="da72c-179">SQL_CA_SS_COLUMN_VARYLEN</span></span>|<span data-ttu-id="da72c-180">如果列的数据在长度方面可能变化，则为 TRUE，否则为 FALSE。</span><span class="sxs-lookup"><span data-stu-id="da72c-180">TRUE if the column's data can vary in length, FALSE otherwise.</span></span>|  
|<span data-ttu-id="da72c-181">SQL_CA_SS_COMPUTE_BYLIST</span><span class="sxs-lookup"><span data-stu-id="da72c-181">SQL_CA_SS_COMPUTE_BYLIST</span></span>|<span data-ttu-id="da72c-182">指向一个 WORD（unsigned short，无符号短值）数组的指针，该数组指定在 COMPUTE 子句的 BY 短语中使用的列。</span><span class="sxs-lookup"><span data-stu-id="da72c-182">Pointer to an array of WORD (unsigned short) specifying the columns used in the BY phrase of a COMPUTE clause.</span></span> <span data-ttu-id="da72c-183">如果 COMPUTE 子句未指定 BY 短语，则返回 NULL 指针。</span><span class="sxs-lookup"><span data-stu-id="da72c-183">If the COMPUTE clause does not specify a BY phrase, a NULL pointer is returned.</span></span><br /><br /> <span data-ttu-id="da72c-184">数组的第一个元素包含 BY 列表列的计数。</span><span class="sxs-lookup"><span data-stu-id="da72c-184">The first element of the array contains the count of BY list columns.</span></span> <span data-ttu-id="da72c-185">其他元素为列序号。</span><span class="sxs-lookup"><span data-stu-id="da72c-185">Additional elements are the column ordinals.</span></span>|  
|<span data-ttu-id="da72c-186">SQL_CA_SS_COMPUTE_ID</span><span class="sxs-lookup"><span data-stu-id="da72c-186">SQL_CA_SS_COMPUTE_ID</span></span>|<span data-ttu-id="da72c-187">*computeid*是当前 transact-sql SELECT 语句中 COMPUTE 子句的结果的行。</span><span class="sxs-lookup"><span data-stu-id="da72c-187">*computeid* of a row that is the result of a COMPUTE clause in the current Transact-SQL SELECT statement.</span></span>|  
|<span data-ttu-id="da72c-188">SQL_CA_SS_NUM_COMPUTES</span><span class="sxs-lookup"><span data-stu-id="da72c-188">SQL_CA_SS_NUM_COMPUTES</span></span>|<span data-ttu-id="da72c-189">在当前 Transact-SQL SELECT 语句中指定的 COMPUTE 子句的数量。</span><span class="sxs-lookup"><span data-stu-id="da72c-189">Number of COMPUTE clauses specified in the current Transact-SQL SELECT statement.</span></span>|  
|<span data-ttu-id="da72c-190">SQL_CA_SS_NUM_ORDERS</span><span class="sxs-lookup"><span data-stu-id="da72c-190">SQL_CA_SS_NUM_ORDERS</span></span>|<span data-ttu-id="da72c-191">在 ODBC 或 Transact-SQL SELECT 语句的 ORDER BY 子句中指定的列数。</span><span class="sxs-lookup"><span data-stu-id="da72c-191">Number of columns specified in an ODBC or Transact-SQL SELECT statement's ORDER BY clause.</span></span>|  
  
 <span data-ttu-id="da72c-192">\*如果语句属性 SQL_SOPT_SS_HIDDEN_COLUMNS 设置为 SQL_HC_ON，则可用。</span><span class="sxs-lookup"><span data-stu-id="da72c-192">\*   Available if statement attribute SQL_SOPT_SS_HIDDEN_COLUMNS is set to SQL_HC_ON.</span></span>  
  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="da72c-193">引入了驱动程序特定的描述符字段，以提供额外的信息来分别表示 XML 架构集合名称、架构名称和目录名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-193">introduced driver-specific descriptor fields to provide additional information to denote the XML schema collection name, the schema name, and the catalog name, respectively.</span></span> <span data-ttu-id="da72c-194">如果这些属性包含非字母数字字符，则它们不需要引号或转义符。</span><span class="sxs-lookup"><span data-stu-id="da72c-194">These properties do not require quotation marks or an escape character if they contain non-alphanumeric characters.</span></span> <span data-ttu-id="da72c-195">下表列出这些新的描述符字段：</span><span class="sxs-lookup"><span data-stu-id="da72c-195">The following table lists these new descriptor fields:</span></span>  
  
|<span data-ttu-id="da72c-196">列名称</span><span class="sxs-lookup"><span data-stu-id="da72c-196">Column name</span></span>|<span data-ttu-id="da72c-197">类型</span><span class="sxs-lookup"><span data-stu-id="da72c-197">Type</span></span>|<span data-ttu-id="da72c-198">说明</span><span class="sxs-lookup"><span data-stu-id="da72c-198">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="da72c-199">SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-199">SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME</span></span>|<span data-ttu-id="da72c-200">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-200">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-201">在其中定义 XML 架构集合名称的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-201">The name of the catalog where an XML schema collection name is defined.</span></span> <span data-ttu-id="da72c-202">如果找不到目录名称，则此变量包含空字符串。</span><span class="sxs-lookup"><span data-stu-id="da72c-202">If the catalog name cannot be found, then this variable contains an empty string.</span></span><br /><br /> <span data-ttu-id="da72c-203">将从 IRD 的 SQL_DESC_SS_XML_SCHEMACOLLECTION_CATALOG_NAME 记录字段（此字段是一个读写字段）中返回此信息。</span><span class="sxs-lookup"><span data-stu-id="da72c-203">This information is returned from the SQL_DESC_SS_XML_SCHEMACOLLECTION_CATALOG_NAME record field of the IRD, which is a read-write field.</span></span>|  
|<span data-ttu-id="da72c-204">SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAM E</span><span class="sxs-lookup"><span data-stu-id="da72c-204">SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAM E</span></span>|<span data-ttu-id="da72c-205">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-205">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-206">在其中定义 XML 架构集合名称的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-206">The name of the schema where an XML schema collection name is defined.</span></span> <span data-ttu-id="da72c-207">如果找不到架构名称，则此变量包含空字符串。</span><span class="sxs-lookup"><span data-stu-id="da72c-207">If the schema name cannot be found, then this variable contains an empty string.</span></span><br /><br /> <span data-ttu-id="da72c-208">将从 IRD 的 SQL_DESC_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME 记录字段（此字段是一个读写字段）中返回此信息。</span><span class="sxs-lookup"><span data-stu-id="da72c-208">This information is returned from the SQL_DESC_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME record field of the IRD, which is a read-write field.</span></span>|  
|<span data-ttu-id="da72c-209">SQL_CA_SS_XML_SCHEMACOLLECTION_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-209">SQL_CA_SS_XML_SCHEMACOLLECTION_NAME</span></span>|<span data-ttu-id="da72c-210">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-210">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-211">XML 架构集合的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-211">The name of an XML schema collection.</span></span> <span data-ttu-id="da72c-212">如果找不到此名称，则此变量包含空字符串。</span><span class="sxs-lookup"><span data-stu-id="da72c-212">If the name cannot be found, then this variable contains an empty string.</span></span><br /><br /> <span data-ttu-id="da72c-213">将从 IRD 的 SQL_DESC_SS_XML_SCHEMACOLLECTION_NAME 记录字段（此字段是一个读写字段）中返回此信息。</span><span class="sxs-lookup"><span data-stu-id="da72c-213">This information is returned from the SQL_DESC_SS_XML_SCHEMACOLLECTION_NAME record field of the IRD, which is a read-write field.</span></span>|  
  
 <span data-ttu-id="da72c-214">此外，[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 引入了新的驱动程序特定的描述符字段，以便为结果集的用户定义类型 (UDT) 列或为存储过程或参数化查询的 UDT 参数提供附加信息。</span><span class="sxs-lookup"><span data-stu-id="da72c-214">Also, [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] introduced new driver-specific descriptor fields to provide additional information for either a user-defined type (UDT) column of a result set or a UDT parameter of a stored procedure or parameterized query.</span></span> <span data-ttu-id="da72c-215">如果这些属性包含非字母数字字符，则它们不需要引号或转义符。</span><span class="sxs-lookup"><span data-stu-id="da72c-215">These properties do not require quotation marks or an escape character if they contain non-alphanumeric characters.</span></span> <span data-ttu-id="da72c-216">下表列出这些新的描述符字段：</span><span class="sxs-lookup"><span data-stu-id="da72c-216">The following table lists these new descriptor fields:</span></span>  
  
|<span data-ttu-id="da72c-217">列名</span><span class="sxs-lookup"><span data-stu-id="da72c-217">Column Name</span></span>|<span data-ttu-id="da72c-218">类型</span><span class="sxs-lookup"><span data-stu-id="da72c-218">Type</span></span>|<span data-ttu-id="da72c-219">说明</span><span class="sxs-lookup"><span data-stu-id="da72c-219">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="da72c-220">SQL_CA_SS_UDT_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-220">SQL_CA_SS_UDT_CATALOG_NAME</span></span>|<span data-ttu-id="da72c-221">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-221">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-222">包含 UDT 的目录的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-222">The name of the catalog containing the UDT.</span></span>|  
|<span data-ttu-id="da72c-223">SQL_CA_SS_UDT_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-223">SQL_CA_SS_UDT_SCHEMA_NAME</span></span>|<span data-ttu-id="da72c-224">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-224">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-225">包含 UDT 的架构的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-225">The name of the schema containing the UDT.</span></span>|  
|<span data-ttu-id="da72c-226">SQL_CA_SS_UDT_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-226">SQL_CA_SS_UDT_TYPE_NAME</span></span>|<span data-ttu-id="da72c-227">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-227">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-228">UDT 的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-228">The name of the UDT.</span></span>|  
|<span data-ttu-id="da72c-229">SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="da72c-229">SQL_CA_SS_UDT_ASSEMBLY_TYPE_NAME</span></span>|<span data-ttu-id="da72c-230">CharacterAttributePtr</span><span class="sxs-lookup"><span data-stu-id="da72c-230">CharacterAttributePtr</span></span>|<span data-ttu-id="da72c-231">UDT 的程序集完全限定名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-231">The assembly qualified name of the UDT.</span></span>|  
  
 <span data-ttu-id="da72c-232">现有的描述符字段标识符 SQL_DESC_TYPE_NAME 用于指示 UDT 的名称。</span><span class="sxs-lookup"><span data-stu-id="da72c-232">The existing descriptor field identifier SQL_DESC_TYPE_NAME is used to indicate the name of the UDT.</span></span> <span data-ttu-id="da72c-233">UDT 类型列的 SQL_DESC_TYPE 字段为 SQL_SS_UDT。</span><span class="sxs-lookup"><span data-stu-id="da72c-233">The SQL_DESC_TYPE field for a UDT type column is SQL_SS_UDT.</span></span>  
  
## <a name="sqlcolattribute-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="da72c-234">SQLColAttribute 对日期和时间增强功能的支持</span><span class="sxs-lookup"><span data-stu-id="da72c-234">SQLColAttribute Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="da72c-235">有关为日期/时间类型返回的值，请参阅[参数和结果元数据](../native-client-odbc-date-time/metadata-parameter-and-result.md)中的 "IRD 字段中返回的信息" 部分。</span><span class="sxs-lookup"><span data-stu-id="da72c-235">For the values returned for date/time types, see the "Information Returned in IRD Fields" section in [Parameter and Result Metadata](../native-client-odbc-date-time/metadata-parameter-and-result.md).</span></span>  
  
 <span data-ttu-id="da72c-236">有关详细信息，请参阅[ODBC&#41;&#40;日期和时间改进](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="da72c-236">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqlcolattribute-support-for-large-clr-udts"></a><span data-ttu-id="da72c-237">SQLColAttribute 对大型 CLR UDT 的支持</span><span class="sxs-lookup"><span data-stu-id="da72c-237">SQLColAttribute Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="da72c-238">`SQLColAttribute` 支持大型 CLR 用户定义类型 (UDT)。</span><span class="sxs-lookup"><span data-stu-id="da72c-238">`SQLColAttribute` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="da72c-239">有关详细信息，请参阅[&#40;ODBC&#41;的大型 CLR 用户定义类型](../native-client/odbc/large-clr-user-defined-types-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="da72c-239">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="sqlcolattribute-support-for-sparse-columns"></a><span data-ttu-id="da72c-240">SQLColAttribute 对于稀疏列的支持</span><span class="sxs-lookup"><span data-stu-id="da72c-240">SQLColAttribute Support for Sparse Columns</span></span>  
 <span data-ttu-id="da72c-241">SQLColAttribute 查询新的实现行描述符 (IRD) 字段 SQL_CA_SS_IS_COLUMN_SET，以确定列是否为 `column_set` 列。</span><span class="sxs-lookup"><span data-stu-id="da72c-241">SQLColAttribute queries the new implementation row descriptor (IRD) field, SQL_CA_SS_IS_COLUMN_SET, to determine if a column is a `column_set` column.</span></span>  
  
 <span data-ttu-id="da72c-242">有关详细信息，请参阅[稀疏列支持 &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="da72c-242">For more information, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="da72c-243">另请参阅</span><span class="sxs-lookup"><span data-stu-id="da72c-243">See Also</span></span>  
 <span data-ttu-id="da72c-244">[SQLColAttribute 函数](https://go.microsoft.com/fwlink/?LinkId=59334) </span><span class="sxs-lookup"><span data-stu-id="da72c-244">[SQLColAttribute Function](https://go.microsoft.com/fwlink/?LinkId=59334) </span></span>  
 <span data-ttu-id="da72c-245">[ODBC API 实现细节](odbc-api-implementation-details.md) </span><span class="sxs-lookup"><span data-stu-id="da72c-245">[ODBC API Implementation Details](odbc-api-implementation-details.md) </span></span>  
 [<span data-ttu-id="da72c-246">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="da72c-246">SQLSetStmtAttr</span></span>](sqlsetstmtattr.md)  
  
  
