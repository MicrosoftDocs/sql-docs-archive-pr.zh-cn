---
title: SQLSetStmtAttr |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586661"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="ea014-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="ea014-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="ea014-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序不支持混合（键集/动态）游标模型。</span><span class="sxs-lookup"><span data-stu-id="ea014-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="ea014-104">如果将该值设置为非 0 值，尝试使用 SQL_ATTR_KEYSET_SIZE 设置键集大小将失败。</span><span class="sxs-lookup"><span data-stu-id="ea014-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="ea014-105">应用程序对所有语句设置 SQL_ATTR_ROW_ARRAY_SIZE，以声明**SQLFetch**或[SQLFetchScroll](sqlfetchscroll.md)函数调用返回的行数。</span><span class="sxs-lookup"><span data-stu-id="ea014-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="ea014-106">在指示服务器游标的语句中，驱动程序使用 SQL_ATTR_ROW_ARRAY_SIZE 确定服务器为满足游标的提取请求而生成的行块的大小。</span><span class="sxs-lookup"><span data-stu-id="ea014-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="ea014-107">在动态游标的块大小内，如果事务隔离级别足以确保对已提交事务的可重复读取，行的成员身份和顺序则是固定的。</span><span class="sxs-lookup"><span data-stu-id="ea014-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="ea014-108">游标在该值指示的块之外完全处于动态状态。</span><span class="sxs-lookup"><span data-stu-id="ea014-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="ea014-109">服务器游标块大小完全处于动态状态，并且可以在提取过程中的任一点更改。</span><span class="sxs-lookup"><span data-stu-id="ea014-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="ea014-110">SQLSetStmtAttr 和表值参数</span><span class="sxs-lookup"><span data-stu-id="ea014-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="ea014-111">在访问表值参数列的描述符字段之前，可以使用 SQLSetStmtAttr 在应用程序参数描述符 (APD) 中设置 SQL_SOPT_SS_PARAM_FOCUS。</span><span class="sxs-lookup"><span data-stu-id="ea014-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="ea014-112">如果尝试将 SQL_SOPT_SS_PARAM_FOCUS 设置为不是表值参数的参数的序号，则 SQLSetStmtAttr 将返回 SQL_ERROR 并使用 SQLSTATE = HY024 和消息 "属性值无效" 创建诊断记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="ea014-113">返回 SQL_ERROR 时，不更改 SQL_SOPT_SS_PARAM_FOCUS。</span><span class="sxs-lookup"><span data-stu-id="ea014-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="ea014-114">将 SQL_SOPT_SS_PARAM_FOCUS 设置为 0 可以恢复对参数的描述符记录的访问权限。</span><span class="sxs-lookup"><span data-stu-id="ea014-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="ea014-115">SQLSetStmtAttr 也可用于设置 SQL_SOPT_SS_NAME_SCOPE。</span><span class="sxs-lookup"><span data-stu-id="ea014-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="ea014-116">有关详细信息，请参阅本主题后面的 SQL_SOPT_SS_NAME_SCOPE 部分。</span><span class="sxs-lookup"><span data-stu-id="ea014-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="ea014-117">有关详细信息，请参阅[预定义语句的表值参数元数据](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)。</span><span class="sxs-lookup"><span data-stu-id="ea014-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="ea014-118">有关表值参数的详细信息，请参阅[ODBC&#41;&#40;表值参数](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="ea014-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="ea014-119">SQLSetStmtAttr 对稀疏列的支持</span><span class="sxs-lookup"><span data-stu-id="ea014-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="ea014-120">SQLSetStmtAttr 可用于设置 SQL_SOPT_SS_NAME_SCOPE。</span><span class="sxs-lookup"><span data-stu-id="ea014-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="ea014-121">有关详细信息，请参阅本主题后面的 SQL_SOPT_SS_NAME_SCOPE 部分。有关稀疏列的详细信息，请参阅[稀疏列支持 &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="ea014-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="ea014-122">语句属性</span><span class="sxs-lookup"><span data-stu-id="ea014-122">Statement Attributes</span></span>  
 <span data-ttu-id="ea014-123">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序还支持以下特定于驱动程序的语句属性。</span><span class="sxs-lookup"><span data-stu-id="ea014-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="ea014-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="ea014-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="ea014-125">SQL_SOPT_SS_CURSOR 属性指定驱动程序是否将在游标上使用特定于驱动程序的性能选项。</span><span class="sxs-lookup"><span data-stu-id="ea014-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="ea014-126">设置这些选项时，不允许[SQLGetData](sqlgetdata.md) 。</span><span class="sxs-lookup"><span data-stu-id="ea014-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="ea014-127">默认设置为 SQL_CO_OFF。</span><span class="sxs-lookup"><span data-stu-id="ea014-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="ea014-128">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="ea014-129">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-129">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-130">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="ea014-131">SQL_CO_OFF</span></span>|<span data-ttu-id="ea014-132">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-132">Default.</span></span> <span data-ttu-id="ea014-133">禁用快速只进、只读游标和自动提取，启用只进只读游标上的**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="ea014-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="ea014-134">将 SQL_SOPT_SS_CURSOR_OPTIONS 设置为 SQL_CO_OFF 时，游标类型将不会发生更改。</span><span class="sxs-lookup"><span data-stu-id="ea014-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="ea014-135">也就是说，快速只进游标将保持为快速只进游标。</span><span class="sxs-lookup"><span data-stu-id="ea014-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="ea014-136">若要更改游标类型，应用程序现在必须使用/SQL_ATTR_CURSOR_TYPE 设置不同的游标类型 `SQLSetStmtAttr` 。</span><span class="sxs-lookup"><span data-stu-id="ea014-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="ea014-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="ea014-137">SQL_CO_FFO</span></span>|<span data-ttu-id="ea014-138">启用快速只进只读游标，禁用只进、只读游标上的**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="ea014-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="ea014-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="ea014-139">SQL_CO_AF</span></span>|<span data-ttu-id="ea014-140">针对任意游标类型启用自动提取选项。</span><span class="sxs-lookup"><span data-stu-id="ea014-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="ea014-141">如果为语句句柄设置了此选项，则**SQLExecute**或**SQLExecDirect**将生成隐式**SQLFetchScroll** (SQL_FIRST) 。</span><span class="sxs-lookup"><span data-stu-id="ea014-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="ea014-142">此时将打开游标，并在与服务器的单个往返中返回第一批行。</span><span class="sxs-lookup"><span data-stu-id="ea014-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="ea014-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="ea014-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="ea014-144">使用自动提取选项启用快速只进游标。</span><span class="sxs-lookup"><span data-stu-id="ea014-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="ea014-145">它与同时指定 SQL_CO_AF 和 SQL_CO_FFO 的效果相同。</span><span class="sxs-lookup"><span data-stu-id="ea014-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="ea014-146">当设置这些选项时，服务器将在检测到已提取最后一行时自动关闭游标。</span><span class="sxs-lookup"><span data-stu-id="ea014-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="ea014-147">应用程序仍必须 SQL_CLOSE) 或[SQLCloseCursor](sqlclosecursor.md)调用[SQLFreeStmt](sqlfreestmt.md) (，但驱动程序不必向服务器发送关闭通知。</span><span class="sxs-lookup"><span data-stu-id="ea014-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="ea014-148">如果选择列表包含**text**、 **ntext**或**image**列，则快速只进游标将转换为动态游标，并允许**SQLGetData** 。</span><span class="sxs-lookup"><span data-stu-id="ea014-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="ea014-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="ea014-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="ea014-150">SQL_SOPT_SS_DEFER_PREPARE 特性确定是立即准备还是推迟语句，直到执行**SQLExecute**、 [SQLDescribeCol](sqldescribecol.md)或[SQLDescribeParam](sqldescribeparam.md) 。</span><span class="sxs-lookup"><span data-stu-id="ea014-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="ea014-151">在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 和早期版本中，将忽略此属性（没有延迟的准备）。</span><span class="sxs-lookup"><span data-stu-id="ea014-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="ea014-152">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="ea014-153">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-153">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-154">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="ea014-155">SQL_DP_ON</span></span>|<span data-ttu-id="ea014-156">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-156">Default.</span></span> <span data-ttu-id="ea014-157">调用[SQLPrepare 函数](https://go.microsoft.com/fwlink/?LinkId=59360)后，将延迟语句准备，直到**调用 SQLExecute**或执行元属性操作 (**SQLDescribeCol**或**SQLDescribeParam**) 。</span><span class="sxs-lookup"><span data-stu-id="ea014-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="ea014-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="ea014-158">SQL_DP_OFF</span></span>|<span data-ttu-id="ea014-159">语句在执行**SQLPrepare**后立即准备就绪。</span><span class="sxs-lookup"><span data-stu-id="ea014-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="ea014-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="ea014-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="ea014-161">SQL_SOPT_SS_REGIONALIZE 属性用于确定语句级别的数据转换。</span><span class="sxs-lookup"><span data-stu-id="ea014-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="ea014-162">该属性使驱动程序在将日期、时间和货币值转换为字符串时遵循客户端区域设置。</span><span class="sxs-lookup"><span data-stu-id="ea014-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="ea014-163">该转换仅针对从 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 本机数据类型到字符串的转换。</span><span class="sxs-lookup"><span data-stu-id="ea014-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="ea014-164">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="ea014-165">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-165">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-166">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="ea014-167">SQL_RE_OFF</span></span>|<span data-ttu-id="ea014-168">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-168">Default.</span></span> <span data-ttu-id="ea014-169">驱动程序不能将日期、时间和货币数据转换为使用客户端区域设置的字符串。</span><span class="sxs-lookup"><span data-stu-id="ea014-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="ea014-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="ea014-170">SQL_RE_ON</span></span>|<span data-ttu-id="ea014-171">驱动程序在将日期、时间和货币数据转换为字符串数据时使用客户端区域设置。</span><span class="sxs-lookup"><span data-stu-id="ea014-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="ea014-172">区域转换设置应用于货币、数字、日期和时间数据类型。</span><span class="sxs-lookup"><span data-stu-id="ea014-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="ea014-173">转换设置仅适用于将货币、数字、日期或时间值转换为字符串的输出转换。</span><span class="sxs-lookup"><span data-stu-id="ea014-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ea014-174">当启用语句选项 SQL_SOPT_SS_REGIONALIZE 时，驱动程序使用当前用户的区域设置注册表设置。</span><span class="sxs-lookup"><span data-stu-id="ea014-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="ea014-175">例如，如果应用程序通过调用**SetThreadLocale**，则不接受当前线程的区域设置。</span><span class="sxs-lookup"><span data-stu-id="ea014-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="ea014-176">改变数据源的区域行为可能导致应用程序失败。</span><span class="sxs-lookup"><span data-stu-id="ea014-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="ea014-177">对于分析日期字符串并期望日期字符串按 ODBC 定义的方式显示的应用程序，更改该值可能会对它们产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="ea014-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="ea014-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="ea014-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="ea014-179">SQL_SOPT_SS_TEXTPTR_LOGGING 属性用于切换对包含**文本**或**图像**数据的列进行的操作的日志记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="ea014-180">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="ea014-181">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-181">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-182">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="ea014-183">SQL_TL_OFF</span></span>|<span data-ttu-id="ea014-184">禁用对**文本**和**图像**数据执行的操作的日志记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="ea014-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="ea014-185">SQL_TL_ON</span></span>|<span data-ttu-id="ea014-186">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-186">Default.</span></span> <span data-ttu-id="ea014-187">启用对**文本**和**图像**数据执行的操作的日志记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="ea014-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="ea014-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="ea014-189">SQL_SOPT_SS_HIDDEN_COLUMNS 属性在结果集中公开隐含在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE 语句中的列。</span><span class="sxs-lookup"><span data-stu-id="ea014-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="ea014-190">默认情况下，驱动程序不公开这些列。</span><span class="sxs-lookup"><span data-stu-id="ea014-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="ea014-191">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="ea014-192">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-192">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-193">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="ea014-194">SQL_HC_OFF</span></span>|<span data-ttu-id="ea014-195">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-195">Default.</span></span> <span data-ttu-id="ea014-196">结果集中不显示 FOR BROWSE 列。</span><span class="sxs-lookup"><span data-stu-id="ea014-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="ea014-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="ea014-197">SQL_HC_ON</span></span>|<span data-ttu-id="ea014-198">公开 FOR BROWSE 列。</span><span class="sxs-lookup"><span data-stu-id="ea014-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="ea014-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="ea014-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="ea014-200">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT 属性返回查询通知请求的消息文本。</span><span class="sxs-lookup"><span data-stu-id="ea014-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="ea014-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="ea014-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="ea014-202">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS 属性指定用于查询通知请求的选项。</span><span class="sxs-lookup"><span data-stu-id="ea014-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="ea014-203">这些选项是在采用 `name=value` 语法的字符串中指定的，如下所示。</span><span class="sxs-lookup"><span data-stu-id="ea014-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="ea014-204">应用程序负责创建服务并从队列中读取通知。</span><span class="sxs-lookup"><span data-stu-id="ea014-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="ea014-205">查询通知选项字符串的语法为：</span><span class="sxs-lookup"><span data-stu-id="ea014-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="ea014-206">例如：</span><span class="sxs-lookup"><span data-stu-id="ea014-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="ea014-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="ea014-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="ea014-208">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT 属性指定查询通知保持活动状态的秒数。</span><span class="sxs-lookup"><span data-stu-id="ea014-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="ea014-209">默认值为 432000 秒（5 天）。</span><span class="sxs-lookup"><span data-stu-id="ea014-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="ea014-210">*将 valueptr*值的类型为 SQLLEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="ea014-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="ea014-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="ea014-212">SQL_SOPT_SS_PARAM_FOCUS 属性指定后续 SQLBindParameter、SQLGetDescField、SQLSetDescField、SQLGetDescRec 和 SQLSetDescRec 调用的焦点。</span><span class="sxs-lookup"><span data-stu-id="ea014-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="ea014-213">SQL_SOPT_SS_PARAM_FOCUS 的类型为 SQLULEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="ea014-214">默认值为 0，表示这些调用将对与 SQL 语句中的参数标记相对应的参数进行寻址。</span><span class="sxs-lookup"><span data-stu-id="ea014-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="ea014-215">当设置为表值参数的参数编号时，这些调用将对该表值参数的列进行寻址。</span><span class="sxs-lookup"><span data-stu-id="ea014-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="ea014-216">当设置的值不是表值参数的参数编号时，这些调用将返回错误 IM020：“参数焦点未引用表值参数”。</span><span class="sxs-lookup"><span data-stu-id="ea014-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="ea014-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="ea014-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="ea014-218">SQL_SOPT_SS_NAME_SCOPE 属性指定后续目录函数调用的名称范围。</span><span class="sxs-lookup"><span data-stu-id="ea014-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="ea014-219">SQLColumns 返回的结果集取决于 SQL_SOPT_SS_NAME_SCOPE 的设置。</span><span class="sxs-lookup"><span data-stu-id="ea014-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="ea014-220">SQL_SOPT_SS_NAME_SCOPE 的类型为 SQLULEN。</span><span class="sxs-lookup"><span data-stu-id="ea014-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="ea014-221">*将 valueptr*值</span><span class="sxs-lookup"><span data-stu-id="ea014-221">*ValuePtr* value</span></span>|<span data-ttu-id="ea014-222">说明</span><span class="sxs-lookup"><span data-stu-id="ea014-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="ea014-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="ea014-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="ea014-224">默认。</span><span class="sxs-lookup"><span data-stu-id="ea014-224">Default.</span></span><br /><br /> <span data-ttu-id="ea014-225">当使用表值参数时，指示应返回实际表的元数据。</span><span class="sxs-lookup"><span data-stu-id="ea014-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="ea014-226">当使用稀疏列功能时，SQLColumns 将仅返回不是稀疏成员的列 `column_set` 。</span><span class="sxs-lookup"><span data-stu-id="ea014-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="ea014-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="ea014-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="ea014-228">指示应用程序需要表类型的元数据，而不是实际表（目录函数应返回表类型的元数据）。</span><span class="sxs-lookup"><span data-stu-id="ea014-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="ea014-229">然后，应用程序将表值参数的 TYPE_NAME 作为*TableName*参数传递。</span><span class="sxs-lookup"><span data-stu-id="ea014-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="ea014-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="ea014-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="ea014-231">当使用稀疏列功能时，无论成员身份如何，SQLColumns 都将返回所有列 `column_set` 。</span><span class="sxs-lookup"><span data-stu-id="ea014-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="ea014-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="ea014-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="ea014-233">当使用稀疏列功能时，SQLColumns 仅返回作为稀疏的成员的列 `column_set` 。</span><span class="sxs-lookup"><span data-stu-id="ea014-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="ea014-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="ea014-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="ea014-235">等同于 SQL_SS_NAME_SCOPE_TABLE。</span><span class="sxs-lookup"><span data-stu-id="ea014-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="ea014-236">SS_TYPE_CATALOG_NAME 和 SS_TYPE_SCHEMA_NAME 分别与*CatalogName*和*SchemaName*参数一起使用，以标识表值参数的目录和架构。</span><span class="sxs-lookup"><span data-stu-id="ea014-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="ea014-237">在应用程序检索完表值参数的元数据之后，该应用程序必须将 SQL_SOPT_SS_NAME_SCOPE 设置回原来的默认值 SQL_SS_NAME_SCOPE_TABLE。</span><span class="sxs-lookup"><span data-stu-id="ea014-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="ea014-238">将 SQL_SOPT_SS_NAME_SCOPE 设置为 SQL_SS_NAME_SCOPE_TABLE 时，对链接服务器的查询将失败。</span><span class="sxs-lookup"><span data-stu-id="ea014-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="ea014-239">对包含服务器组件的目录的 SQLColumns 或 SQLPrimaryKeys 的调用将失败。</span><span class="sxs-lookup"><span data-stu-id="ea014-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="ea014-240">如果尝试将 SQL_SOPT_SS_NAME_SCOPE 设置为无效值，则返回 SQL_ERROR，并生成具有 SQLSTATE HY024 和消息“属性值无效”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="ea014-241">如果在 SQL_SOPT_SS_NAME_SCOPE 具有除 SQL_SS_NAME_SCOPE_TABLE 以外的值时调用了其他目录函数 then SQLTables、SQLColumns 或 SQLPrimaryKeys，则返回 SQL_ERROR。</span><span class="sxs-lookup"><span data-stu-id="ea014-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="ea014-242">生成具有 SQLSTATE HY010 和消息“函数序列错误(SQL_SOPT_SS_NAME_SCOPE 未设置为 SQL_SS_NAME_SCOPE_TABLE)”的诊断记录。</span><span class="sxs-lookup"><span data-stu-id="ea014-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea014-243">另请参阅</span><span class="sxs-lookup"><span data-stu-id="ea014-243">See Also</span></span>  
 <span data-ttu-id="ea014-244">[SQLGetStmtAttr 函数](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="ea014-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="ea014-245">ODBC API 实现细节</span><span class="sxs-lookup"><span data-stu-id="ea014-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
