---
title: SQLRowCount |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLRowCount function
ms.assetid: 967ed3d4-3d31-4485-ac92-027076ebc829
author: rothja
ms.author: jroth
ms.openlocfilehash: 410023d960bad6dde1060a509cc1bf46f67d77cc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87590756"
---
# <a name="sqlrowcount"></a><span data-ttu-id="03f43-102">SQLRowCount</span><span class="sxs-lookup"><span data-stu-id="03f43-102">SQLRowCount</span></span>
  <span data-ttu-id="03f43-103">当参数值的数组绑定到语句执行时， `SQLRowCount` 如果参数值的任意行在语句执行中生成错误条件，则将返回 SQL_ERROR。</span><span class="sxs-lookup"><span data-stu-id="03f43-103">When arrays of parameter values are bound for statement execution, `SQLRowCount` returns SQL_ERROR if any row of parameter values generates an error condition in statement execution.</span></span> <span data-ttu-id="03f43-104">不通过函数的*RowCountPtr*参数返回值。</span><span class="sxs-lookup"><span data-stu-id="03f43-104">No value is returned through the *RowCountPtr* argument of the function.</span></span>  
  
 <span data-ttu-id="03f43-105">应用程序可以利用 SQL_ATTR_PARAMS_PROCESSED_PTR 语句属性捕获在错误发生之前已处理的参数个数。</span><span class="sxs-lookup"><span data-stu-id="03f43-105">The application can take advantage of the SQL_ATTR_PARAMS_PROCESSED_PTR statement attribute to capture the number of parameters processed prior to the error occurring.</span></span>  
  
 <span data-ttu-id="03f43-106">此外，应用程序还可以使用由状态值构成的数组（通过使用 SQL_ATTR_PARAM_STATUS_PTR 语句属性进行绑定），来捕获生成错误的参数行的数组偏移量。</span><span class="sxs-lookup"><span data-stu-id="03f43-106">Further, the application can use an array of status values, bound by using the SQL_ATTR_PARAM_STATUS_PTR statement attribute, to capture the array offsets of offending parameter rows.</span></span> <span data-ttu-id="03f43-107">应用程序可以遍历状态数组以确定已处理的实际行数。</span><span class="sxs-lookup"><span data-stu-id="03f43-107">The application can traverse the status array to determine the actual number of rows processed.</span></span>  
  
 <span data-ttu-id="03f43-108">当 [!INCLUDE[tsql](../../includes/tsql-md.md)] 执行包含 output 子句的 INSERT、UPDATE、DELETE 或 MERGE 语句时，SQLRowCount 将不会返回受影响的行数，直到输出子句生成的结果集中的所有行都已被使用。</span><span class="sxs-lookup"><span data-stu-id="03f43-108">When a [!INCLUDE[tsql](../../includes/tsql-md.md)] INSERT, UPDATE, DELETE, or MERGE statement with an OUTPUT clause is executed, SQLRowCount will not return the count of rows affected until all the rows in the result set generated by the OUTPUT clause have been consumed.</span></span> <span data-ttu-id="03f43-109">若要要使用这些行，请调用 SQLFetch 或 SQLFetchScroll。</span><span class="sxs-lookup"><span data-stu-id="03f43-109">To sconsume these rows, you call SQLFetch or SQLFetchScroll.</span></span> <span data-ttu-id="03f43-110">SQLResultCols 将返回-1，直到使用完所有结果行为止。</span><span class="sxs-lookup"><span data-stu-id="03f43-110">SQLResultCols will return -1 until all result rows have been consumed.</span></span> <span data-ttu-id="03f43-111">在 SQLFetch 或 SQLFetchScroll 返回 SQL_NO_DATA 之后，应用程序必须调用 SQLRowCount 来确定受影响的行数，然后再调用 SQLMoreResults 以移到下一个结果。</span><span class="sxs-lookup"><span data-stu-id="03f43-111">After SQLFetch or SQLFetchScroll returns SQL_NO_DATA, the application must call SQLRowCount to determine the number of rows affected before calling SQLMoreResults to move to the next result.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="03f43-112">另请参阅</span><span class="sxs-lookup"><span data-stu-id="03f43-112">See Also</span></span>  
 <span data-ttu-id="03f43-113">[SQLRowCount 函数](https://go.microsoft.com/fwlink/?LinkId=59367) </span><span class="sxs-lookup"><span data-stu-id="03f43-113">[SQLRowCount Function](https://go.microsoft.com/fwlink/?LinkId=59367) </span></span>  
 [<span data-ttu-id="03f43-114">ODBC API 实现细节</span><span class="sxs-lookup"><span data-stu-id="03f43-114">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
