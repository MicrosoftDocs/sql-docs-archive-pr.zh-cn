---
title: SQLBrowseConnect |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBrowseConnect function
ms.assetid: 57faf388-c7ca-4696-9845-34e0a10cc5f7
author: rothja
ms.author: jroth
ms.openlocfilehash: ca203e02195d72683744aa8dd31d41a81c260ab4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693851"
---
# <a name="sqlbrowseconnect"></a><span data-ttu-id="68717-102">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="68717-102">SQLBrowseConnect</span></span>
  <span data-ttu-id="68717-103">**SQLBrowseConnect**使用可分类为三个级别的连接信息的关键字。</span><span class="sxs-lookup"><span data-stu-id="68717-103">**SQLBrowseConnect** uses keywords that can be categorized into three levels of connection information.</span></span> <span data-ttu-id="68717-104">对于每个关键字，下表指示是否返回有效值列表以及该关键字是否可选。</span><span class="sxs-lookup"><span data-stu-id="68717-104">For each keyword, the following table indicates whether a list of valid values is returned and whether the keyword is optional.</span></span>  
  
## <a name="level-1"></a><span data-ttu-id="68717-105">级别 1</span><span class="sxs-lookup"><span data-stu-id="68717-105">Level 1</span></span>  
  
|<span data-ttu-id="68717-106">关键字</span><span class="sxs-lookup"><span data-stu-id="68717-106">Keyword</span></span>|<span data-ttu-id="68717-107">是否返回列表？</span><span class="sxs-lookup"><span data-stu-id="68717-107">List returned?</span></span>|<span data-ttu-id="68717-108">是否可选？</span><span class="sxs-lookup"><span data-stu-id="68717-108">Optional?</span></span>|<span data-ttu-id="68717-109">说明</span><span class="sxs-lookup"><span data-stu-id="68717-109">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="68717-110">DSN</span><span class="sxs-lookup"><span data-stu-id="68717-110">DSN</span></span>|<span data-ttu-id="68717-111">空值</span><span class="sxs-lookup"><span data-stu-id="68717-111">N/A</span></span>|<span data-ttu-id="68717-112">否</span><span class="sxs-lookup"><span data-stu-id="68717-112">No</span></span>|<span data-ttu-id="68717-113">**SQLDataSources**返回的数据源的名称。</span><span class="sxs-lookup"><span data-stu-id="68717-113">Name of the data source returned by **SQLDataSources**.</span></span> <span data-ttu-id="68717-114">如果使用 DRIVER 关键字，则无法使用 DSN 关键字。</span><span class="sxs-lookup"><span data-stu-id="68717-114">The DSN keyword cannot be used if the DRIVER keyword is used.</span></span>|  
|<span data-ttu-id="68717-115">DRIVER</span><span class="sxs-lookup"><span data-stu-id="68717-115">DRIVER</span></span>|<span data-ttu-id="68717-116">空值</span><span class="sxs-lookup"><span data-stu-id="68717-116">N/A</span></span>|<span data-ttu-id="68717-117">否</span><span class="sxs-lookup"><span data-stu-id="68717-117">No</span></span>|<span data-ttu-id="68717-118">Microsoft？？</span><span class="sxs-lookup"><span data-stu-id="68717-118">Microsoft??</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="68717-119">Native Client ODBC driver name 为 { [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native client 11}。</span><span class="sxs-lookup"><span data-stu-id="68717-119">Native Client ODBC driver name is {[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 11}.</span></span> <span data-ttu-id="68717-120">如果使用 DSN 关键字，则无法使用 DRIVER 关键字。</span><span class="sxs-lookup"><span data-stu-id="68717-120">The DRIVER keyword cannot be used if the DSN keyword is used.</span></span>|  
  
## <a name="level-2"></a><span data-ttu-id="68717-121">级别 2</span><span class="sxs-lookup"><span data-stu-id="68717-121">Level 2</span></span>  
  
|<span data-ttu-id="68717-122">关键字</span><span class="sxs-lookup"><span data-stu-id="68717-122">Keyword</span></span>|<span data-ttu-id="68717-123">是否返回列表？</span><span class="sxs-lookup"><span data-stu-id="68717-123">List returned?</span></span>|<span data-ttu-id="68717-124">是否可选？</span><span class="sxs-lookup"><span data-stu-id="68717-124">Optional?</span></span>|<span data-ttu-id="68717-125">说明</span><span class="sxs-lookup"><span data-stu-id="68717-125">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="68717-126">SERVER</span><span class="sxs-lookup"><span data-stu-id="68717-126">SERVER</span></span>|<span data-ttu-id="68717-127">是</span><span class="sxs-lookup"><span data-stu-id="68717-127">Yes</span></span>|<span data-ttu-id="68717-128">否</span><span class="sxs-lookup"><span data-stu-id="68717-128">No</span></span>|<span data-ttu-id="68717-129">数据源所驻留网络上的服务器名称。</span><span class="sxs-lookup"><span data-stu-id="68717-129">Name of the server on the network on which the data source resides.</span></span> <span data-ttu-id="68717-130">可以输入术语 "(local)" 作为服务器，在此情况下，即使此为非联网版本，也可以使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的本地副本。</span><span class="sxs-lookup"><span data-stu-id="68717-130">The term "(local)" can be entered as the server, in which case a local copy of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be used, even when this is a non-networked version.</span></span>|  
|<span data-ttu-id="68717-131">UID</span><span class="sxs-lookup"><span data-stu-id="68717-131">UID</span></span>|<span data-ttu-id="68717-132">否</span><span class="sxs-lookup"><span data-stu-id="68717-132">No</span></span>|<span data-ttu-id="68717-133">是</span><span class="sxs-lookup"><span data-stu-id="68717-133">Yes</span></span>|<span data-ttu-id="68717-134">用户登录 ID。</span><span class="sxs-lookup"><span data-stu-id="68717-134">User login ID.</span></span>|  
|<span data-ttu-id="68717-135">PWD</span><span class="sxs-lookup"><span data-stu-id="68717-135">PWD</span></span>|<span data-ttu-id="68717-136">否</span><span class="sxs-lookup"><span data-stu-id="68717-136">No</span></span>|<span data-ttu-id="68717-137">是（取决于用户）</span><span class="sxs-lookup"><span data-stu-id="68717-137">Yes (depends on the user)</span></span>|<span data-ttu-id="68717-138">用户指定的密码。</span><span class="sxs-lookup"><span data-stu-id="68717-138">User-specified password.</span></span>|  
|<span data-ttu-id="68717-139">APP</span><span class="sxs-lookup"><span data-stu-id="68717-139">APP</span></span>|<span data-ttu-id="68717-140">否</span><span class="sxs-lookup"><span data-stu-id="68717-140">No</span></span>|<span data-ttu-id="68717-141">是</span><span class="sxs-lookup"><span data-stu-id="68717-141">Yes</span></span>|<span data-ttu-id="68717-142">调用**SQLBrowseConnect**的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="68717-142">Name of the application calling **SQLBrowseConnect**.</span></span>|  
|<span data-ttu-id="68717-143">WSID</span><span class="sxs-lookup"><span data-stu-id="68717-143">WSID</span></span>|<span data-ttu-id="68717-144">否</span><span class="sxs-lookup"><span data-stu-id="68717-144">No</span></span>|<span data-ttu-id="68717-145">是</span><span class="sxs-lookup"><span data-stu-id="68717-145">Yes</span></span>|<span data-ttu-id="68717-146">工作站 ID。</span><span class="sxs-lookup"><span data-stu-id="68717-146">Workstation ID.</span></span> <span data-ttu-id="68717-147">通常，这是运行应用程序的计算机的网络名称。</span><span class="sxs-lookup"><span data-stu-id="68717-147">Typically, this is the network name of the computer on which the application runs.</span></span>|  
  
## <a name="level-3"></a><span data-ttu-id="68717-148">Level 3</span><span class="sxs-lookup"><span data-stu-id="68717-148">Level 3</span></span>  
  
|<span data-ttu-id="68717-149">关键字</span><span class="sxs-lookup"><span data-stu-id="68717-149">Keyword</span></span>|<span data-ttu-id="68717-150">是否返回列表？</span><span class="sxs-lookup"><span data-stu-id="68717-150">List returned?</span></span>|<span data-ttu-id="68717-151">是否可选？</span><span class="sxs-lookup"><span data-stu-id="68717-151">Optional?</span></span>|<span data-ttu-id="68717-152">说明</span><span class="sxs-lookup"><span data-stu-id="68717-152">Description</span></span>|  
|-------------|--------------------|---------------|-----------------|  
|<span data-ttu-id="68717-153">DATABASE</span><span class="sxs-lookup"><span data-stu-id="68717-153">DATABASE</span></span>|<span data-ttu-id="68717-154">是</span><span class="sxs-lookup"><span data-stu-id="68717-154">Yes</span></span>|<span data-ttu-id="68717-155">是</span><span class="sxs-lookup"><span data-stu-id="68717-155">Yes</span></span>|<span data-ttu-id="68717-156">数据库的名称 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="68717-156">Name of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span>|  
|<span data-ttu-id="68717-157">LANGUAGE</span><span class="sxs-lookup"><span data-stu-id="68717-157">LANGUAGE</span></span>|<span data-ttu-id="68717-158">是</span><span class="sxs-lookup"><span data-stu-id="68717-158">Yes</span></span>|<span data-ttu-id="68717-159">是</span><span class="sxs-lookup"><span data-stu-id="68717-159">Yes</span></span>|<span data-ttu-id="68717-160">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 使用的区域语言。</span><span class="sxs-lookup"><span data-stu-id="68717-160">National language used by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
  
 <span data-ttu-id="68717-161">**SQLBrowseConnect**忽略存储在 ODBC 数据源定义中的数据库和语言关键字的值。</span><span class="sxs-lookup"><span data-stu-id="68717-161">**SQLBrowseConnect** ignores the values of the DATABASE and LANGUAGE keywords stored in the ODBC data source definitions.</span></span> <span data-ttu-id="68717-162">如果传递到**SQLBrowseConnect**的连接字符串中指定的数据库或语言无效，则**SQLBrowseConnect**将返回 SQL_NEED_DATA 和3级连接属性。</span><span class="sxs-lookup"><span data-stu-id="68717-162">If the database or language specified in the connection string passed to **SQLBrowseConnect** is invalid, **SQLBrowseConnect** returns SQL_NEED_DATA and the level 3 connection attributes.</span></span>  
  
 <span data-ttu-id="68717-163">以下属性（通过调用[SQLSetConnectAttr](sqlsetconnectattr.md)设置）确定由**SQLBrowseConnect**返回的结果集。</span><span class="sxs-lookup"><span data-stu-id="68717-163">The following attributes, which are set by calling [SQLSetConnectAttr](sqlsetconnectattr.md), determine the result set returned by **SQLBrowseConnect**.</span></span>  
  
|<span data-ttu-id="68717-164">Attribute</span><span class="sxs-lookup"><span data-stu-id="68717-164">Attribute</span></span>|<span data-ttu-id="68717-165">说明</span><span class="sxs-lookup"><span data-stu-id="68717-165">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="68717-166">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="68717-166">SQL_COPT_SS_BROWSE_CONNECT</span></span>|<span data-ttu-id="68717-167">如果将其设置为 SQL_MORE_INFO_YES，则**SQLBrowseConnect**将返回服务器属性的扩展字符串。</span><span class="sxs-lookup"><span data-stu-id="68717-167">If it is set to SQL_MORE_INFO_YES, **SQLBrowseConnect** returns an extended string of server properties.</span></span><br /><br /> <span data-ttu-id="68717-168">下面是**SQLBrowseConnect**返回的扩展字符串示例： ServerName\InstanceName;聚集： No;版本：8.00.131</span><span class="sxs-lookup"><span data-stu-id="68717-168">The following is an example of an extended string returned by **SQLBrowseConnect**:ServerName\InstanceName;Clustered:No;Version:8.00.131</span></span><br /><br /> <span data-ttu-id="68717-169">在此字符串中，分号用于分隔与服务器有关的各部分信息，</span><span class="sxs-lookup"><span data-stu-id="68717-169">In this string, semi-colons separate various pieces of information about the server.</span></span> <span data-ttu-id="68717-170">逗号用于分隔不同的服务器实例。</span><span class="sxs-lookup"><span data-stu-id="68717-170">Use commas to separate different server instances.</span></span>|  
|<span data-ttu-id="68717-171">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="68717-171">SQL_COPT_SS_BROWSE_SERVER</span></span>|<span data-ttu-id="68717-172">如果指定了服务器名称，则**SQLBrowseConnect**将返回指定服务器的信息。</span><span class="sxs-lookup"><span data-stu-id="68717-172">If a server name is specified, **SQLBrowseConnect** will return information for the server specified.</span></span> <span data-ttu-id="68717-173">如果 SQL_COPT_SS_BROWSE_SERVER 设置为 NULL，则**SQLBrowseConnect**将返回域中所有服务器的信息。</span><span class="sxs-lookup"><span data-stu-id="68717-173">If SQL_COPT_SS_BROWSE_SERVER is set to NULL, **SQLBrowseConnect** returns information for all servers in the domain.</span></span><br /><br /> <span data-ttu-id="68717-174">由于网络问题， **SQLBrowseConnect**可能无法及时接收来自所有服务器的响应。</span><span class="sxs-lookup"><span data-stu-id="68717-174">Due to network issues, **SQLBrowseConnect** might not receive a timely response from all servers.</span></span> <span data-ttu-id="68717-175">因此，每个请求所返回的服务器列表都可能不同。</span><span class="sxs-lookup"><span data-stu-id="68717-175">Therefore, the list of servers returned can vary for each request.</span></span>|  
|<span data-ttu-id="68717-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span><span class="sxs-lookup"><span data-stu-id="68717-176">SQL_COPT_SS_BROWSE_CACHE_DATA</span></span>|<span data-ttu-id="68717-177">如果 SQL_COPT_SS_BROWSE_CACHE_DATA 属性设置为 SQL_CACHE_DATA_YES，当缓冲区长度不足以容纳结果时，您可以提取块区中的数据。</span><span class="sxs-lookup"><span data-stu-id="68717-177">When the SQL_COPT_SS_BROWSE_CACHE_DATA attribute is set to SQL_CACHE_DATA_YES, you can fetch data in chunks when the buffer length is not large enough to hold the result.</span></span> <span data-ttu-id="68717-178">此长度在 SQLBrowseConnect 的 BufferLength 参数中指定。</span><span class="sxs-lookup"><span data-stu-id="68717-178">This length is specified in the BufferLength argument to SQLBrowseConnect.</span></span><br /><br /> <span data-ttu-id="68717-179">当有更多的数据可用时，将返回 SQL_NEED_DATA。</span><span class="sxs-lookup"><span data-stu-id="68717-179">SQL_NEED_DATA is returned when more data is available.</span></span> <span data-ttu-id="68717-180">如果检索不到更多的数据，将返回 SQL_SUCCESS。</span><span class="sxs-lookup"><span data-stu-id="68717-180">SQL_SUCCESS is returned when there is no more data to retrieve.</span></span><br /><br /> <span data-ttu-id="68717-181">默认值是 SQL_CACHE_DATA_NO。</span><span class="sxs-lookup"><span data-stu-id="68717-181">The default is SQL_CACHE_DATA_NO.</span></span>|  
  
## <a name="sqlbrowseconnect-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="68717-182">对高可用性、灾难恢复的 SQLBrowseConnect 支持</span><span class="sxs-lookup"><span data-stu-id="68717-182">SQLBrowseConnect Support for High Availability, Disaster Recovery</span></span>  
 <span data-ttu-id="68717-183">有关使用**SQLBrowseConnect**连接到群集的详细信息 [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] ，请参阅[高可用性和灾难恢复的 SQL Server Native Client 支持](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)。</span><span class="sxs-lookup"><span data-stu-id="68717-183">For more information on using **SQLBrowseConnect** to connect to an [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] cluster, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
## <a name="sqlbrowseconnect-support-for-service-principal-names-spns"></a><span data-ttu-id="68717-184">对服务主体名称 (SPN) 的 SQLBrowseConnect 支持</span><span class="sxs-lookup"><span data-stu-id="68717-184">SQLBrowseConnect Support for Service Principal Names (SPNs)</span></span>  
 <span data-ttu-id="68717-185">当打开连接时，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client 将 SQL_COPT_SS_MUTUALLY_AUTHENTICATED 和 SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD 设置为用于打开此连接的身份验证方法。</span><span class="sxs-lookup"><span data-stu-id="68717-185">When a connection is opened, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client sets SQL_COPT_SS_MUTUALLY_AUTHENTICATED and SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD to the authentication method used to open the connection.</span></span>  
  
 <span data-ttu-id="68717-186">有关 Spn 的详细信息，请参阅[&#40;ODBC&#41;的客户端连接中的服务主体名称 &#40;spn&#41; ](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="68717-186">For more information about SPNs, see [Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span></span>  
  
## <a name="change-history"></a><span data-ttu-id="68717-187">更改历史记录</span><span class="sxs-lookup"><span data-stu-id="68717-187">Change History</span></span>  
  
|<span data-ttu-id="68717-188">更新的内容</span><span class="sxs-lookup"><span data-stu-id="68717-188">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="68717-189">介绍了 SQL_COPT_SS_BROWSE_CACHE_DATA。</span><span class="sxs-lookup"><span data-stu-id="68717-189">Documented SQL_COPT_SS_BROWSE_CACHE_DATA.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="68717-190">另请参阅</span><span class="sxs-lookup"><span data-stu-id="68717-190">See Also</span></span>  
 <span data-ttu-id="68717-191">[SQLBrowseConnect 函数](https://go.microsoft.com/fwlink/?LinkId=59329) </span><span class="sxs-lookup"><span data-stu-id="68717-191">[SQLBrowseConnect Function](https://go.microsoft.com/fwlink/?LinkId=59329) </span></span>  
 [<span data-ttu-id="68717-192">ODBC API 实现细节</span><span class="sxs-lookup"><span data-stu-id="68717-192">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
