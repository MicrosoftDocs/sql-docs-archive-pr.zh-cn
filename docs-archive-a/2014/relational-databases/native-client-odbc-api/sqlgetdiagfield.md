---
title: SQLGetDiagField |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLGetDiagField function
ms.assetid: 395245ba-0372-43ec-b9a4-a29410d85a6d
author: rothja
ms.author: jroth
ms.openlocfilehash: 356a627105c6e6dabbf4b55a5d43f8b37d2712b2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691712"
---
# <a name="sqlgetdiagfield"></a><span data-ttu-id="d9a5b-102">SQLGetDiagField</span><span class="sxs-lookup"><span data-stu-id="d9a5b-102">SQLGetDiagField</span></span>
  <span data-ttu-id="d9a5b-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native CLIENT ODBC 驱动程序为指定了以下附加诊断字段 `SQLGetDiagField` 。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver specifies the following additional diagnostics fields for `SQLGetDiagField`.</span></span> <span data-ttu-id="d9a5b-104">这些字段支持 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 应用程序的大量错误报告功能，并且可以在连接的 ODBC 连接句柄和 ODBC 语句句柄上生成的所有诊断记录中使用。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-104">These fields support rich error reporting for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] applications and are available in all diagnostics records generated on connected ODBC connection handles and ODBC statement handles.</span></span> <span data-ttu-id="d9a5b-105">这些字段在 sqlncli.h 中定义。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-105">The fields are defined in sqlncli.h.</span></span>  
  
|<span data-ttu-id="d9a5b-106">诊断记录字段</span><span class="sxs-lookup"><span data-stu-id="d9a5b-106">Diagnostics record field</span></span>|<span data-ttu-id="d9a5b-107">说明</span><span class="sxs-lookup"><span data-stu-id="d9a5b-107">Description</span></span>|  
|------------------------------|-----------------|  
|<span data-ttu-id="d9a5b-108">SQL_DIAG_SS_LINE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-108">SQL_DIAG_SS_LINE</span></span>|<span data-ttu-id="d9a5b-109">报告生成错误的存储过程的行号。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-109">Reports the line number of a stored procedure generating an error.</span></span> <span data-ttu-id="d9a5b-110">只有 SQL_DIAG_SS_PROCNAME 返回值时，SQL_DIAG_SS_LINE 的值才有意义。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-110">The value of SQL_DIAG_SS_LINE is meaningful only if SQL_DIAG_SS_PROCNAME returns a value.</span></span> <span data-ttu-id="d9a5b-111">该值作为无符号 16 位整数返回。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-111">The value is returned as an unsigned, 16-bit integer.</span></span>|  
|<span data-ttu-id="d9a5b-112">SQL_DIAG_SS_MSGSTATE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-112">SQL_DIAG_SS_MSGSTATE</span></span>|<span data-ttu-id="d9a5b-113">错误消息的状态。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-113">The state of an error message.</span></span> <span data-ttu-id="d9a5b-114">有关错误消息状态的信息，请参阅[RAISERROR](/sql/t-sql/language-elements/raiserror-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-114">For information about the error message state, see [RAISERROR](/sql/t-sql/language-elements/raiserror-transact-sql).</span></span> <span data-ttu-id="d9a5b-115">该值作为有符号 32 位整数返回。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-115">The value is returned as a signed, 32-bit integer.</span></span>|  
|<span data-ttu-id="d9a5b-116">SQL_DIAG_SS_PROCNAME</span><span class="sxs-lookup"><span data-stu-id="d9a5b-116">SQL_DIAG_SS_PROCNAME</span></span>|<span data-ttu-id="d9a5b-117">根据需要生成错误的存储过程的名称。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-117">Name of the stored procedure generating an error, if appropriate.</span></span> <span data-ttu-id="d9a5b-118">该值作为字符串返回。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-118">The value is returned as a character string.</span></span> <span data-ttu-id="d9a5b-119">字符串的长度（以字符为单位）取决于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的版本。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-119">The length of the string (in characters) depends on the version of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d9a5b-120">可以通过调用[SQLGetInfo](sqlgetinfo.md)请求 SQL_MAX_PROCEDURE_NAME_LEN 的值来确定此值。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-120">It can be determined by calling [SQLGetInfo](sqlgetinfo.md) requesting the value for SQL_MAX_PROCEDURE_NAME_LEN.</span></span>|  
|<span data-ttu-id="d9a5b-121">SQL_DIAG_SS_SEVERITY</span><span class="sxs-lookup"><span data-stu-id="d9a5b-121">SQL_DIAG_SS_SEVERITY</span></span>|<span data-ttu-id="d9a5b-122">关联错误消息的严重级别。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-122">The severity level of the associated error message.</span></span> <span data-ttu-id="d9a5b-123">该值作为有符号 32 位整数返回。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-123">The value is returned as a signed, 32-bit integer.</span></span>|  
|<span data-ttu-id="d9a5b-124">SQL_DIAG_SS_SRVNAME</span><span class="sxs-lookup"><span data-stu-id="d9a5b-124">SQL_DIAG_SS_SRVNAME</span></span>|<span data-ttu-id="d9a5b-125">发生错误的服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-125">The name of the server on which the error occurred.</span></span> <span data-ttu-id="d9a5b-126">该值作为字符串返回。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-126">The value is returned as a character string.</span></span> <span data-ttu-id="d9a5b-127">字符串的长度（以字符为单位）由 sqlncli.h 中的 SQL_MAX_SQLSERVERNAME 宏定义。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-127">The length of the string (in characters) is defined by the SQL_MAX_SQLSERVERNAME macro in sqlncli.h.</span></span>|  
  
 <span data-ttu-id="d9a5b-128">包含字符数据的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 特定诊断字段（即 SQL_DIAG_SS_PROCNAME 和 SQL_DIAG_SS_SRVNAME）将该数据作为以 Null 值结束的 ANSI 或 Unicode 字符串返回给客户端。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-128">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific diagnostic fields that contain character data, SQL_DIAG_SS_PROCNAME and SQL_DIAG_SS_SRVNAME, return that data to the client as null terminated, ANSI, or Unicode strings.</span></span> <span data-ttu-id="d9a5b-129">如有必要，应根据字符宽度调整字符计数。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-129">If necessary, the count of characters should be adjusted by the character width.</span></span> <span data-ttu-id="d9a5b-130">或者，还可以使用可移植 C 数据类型（如 TCHAR 或 SQLTCHAR）确保正确的程序可变长度。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-130">Alternately, a portable C data type such as TCHAR or SQLTCHAR can be used to ensure correct program variable length.</span></span>  
  
 <span data-ttu-id="d9a5b-131">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC 驱动程序报告标识最后尝试的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 语句的以下额外动态函数代码。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-131">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver reports the following additional dynamic function codes that identify the last attempted [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] statement.</span></span> <span data-ttu-id="d9a5b-132">动态函数代码在诊断记录集的标头（记录 0）中返回，因此可在每次执行时（成功或失败）使用。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-132">The dynamic function code is returned in the header (record 0) of the diagnostics record set and is therefore available on every execution (successful or not).</span></span>  
  
|<span data-ttu-id="d9a5b-133">动态函数代码</span><span class="sxs-lookup"><span data-stu-id="d9a5b-133">Dynamic function code</span></span>|<span data-ttu-id="d9a5b-134">源</span><span class="sxs-lookup"><span data-stu-id="d9a5b-134">Source</span></span>|  
|---------------------------|------------|  
|<span data-ttu-id="d9a5b-135">SQL_DIAG_DFC_SS_ALTER_DATABASE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-135">SQL_DIAG_DFC_SS_ALTER_DATABASE</span></span>|<span data-ttu-id="d9a5b-136">ALTER DATABASE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-136">ALTER DATABASE statement</span></span>|  
|<span data-ttu-id="d9a5b-137">SQL_DIAG_DFC_SS_CHECKPOINT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-137">SQL_DIAG_DFC_SS_CHECKPOINT</span></span>|<span data-ttu-id="d9a5b-138">CHECKPOINT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-138">CHECKPOINT statement</span></span>|  
|<span data-ttu-id="d9a5b-139">SQL_DIAG_DFC_SS_CONDITION</span><span class="sxs-lookup"><span data-stu-id="d9a5b-139">SQL_DIAG_DFC_SS_CONDITION</span></span>|<span data-ttu-id="d9a5b-140">在语句的 WHERE 或 HAVING 子句中引发的错误。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-140">Error arose in the WHERE or HAVING clauses of a statement.</span></span>|  
|<span data-ttu-id="d9a5b-141">SQL_DIAG_DFC_SS_CREATE_DATABASE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-141">SQL_DIAG_DFC_SS_CREATE_DATABASE</span></span>|<span data-ttu-id="d9a5b-142">CREATE DATABASE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-142">CREATE DATABASE statement</span></span>|  
|<span data-ttu-id="d9a5b-143">SQL_DIAG_DFC_SS_CREATE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-143">SQL_DIAG_DFC_SS_CREATE_DEFAULT</span></span>|<span data-ttu-id="d9a5b-144">CREATE DEFAULT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-144">CREATE DEFAULT statement</span></span>|  
|<span data-ttu-id="d9a5b-145">SQL_DIAG_DFC_SS_CREATE_PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-145">SQL_DIAG_DFC_SS_CREATE_PROCEDURE</span></span>|<span data-ttu-id="d9a5b-146">CREATE PROCEDURE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-146">CREATE PROCEDURE statement</span></span>|  
|<span data-ttu-id="d9a5b-147">SQL_DIAG_DFC_SS_CREATE_RULE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-147">SQL_DIAG_DFC_SS_CREATE_RULE</span></span>|<span data-ttu-id="d9a5b-148">CREATE RULE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-148">CREATE RULE statement</span></span>|  
|<span data-ttu-id="d9a5b-149">SQL_DIAG_DFC_SS_CREATE_TRIGGER</span><span class="sxs-lookup"><span data-stu-id="d9a5b-149">SQL_DIAG_DFC_SS_CREATE_TRIGGER</span></span>|<span data-ttu-id="d9a5b-150">CREATE TRIGGER 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-150">CREATE TRIGGER statement</span></span>|  
|<span data-ttu-id="d9a5b-151">SQL_DIAG_DFC_SS_CURSOR_DECLARE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-151">SQL_DIAG_DFC_SS_CURSOR_DECLARE</span></span>|<span data-ttu-id="d9a5b-152">DECLARE CURSOR 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-152">DECLARE CURSOR statement</span></span>|  
|<span data-ttu-id="d9a5b-153">SQL_DIAG_DFC_SS_CURSOR_OPEN</span><span class="sxs-lookup"><span data-stu-id="d9a5b-153">SQL_DIAG_DFC_SS_CURSOR_OPEN</span></span>|<span data-ttu-id="d9a5b-154">OPEN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-154">OPEN statement</span></span>|  
|<span data-ttu-id="d9a5b-155">SQL_DIAG_DFC_SS_CURSOR_FETCH</span><span class="sxs-lookup"><span data-stu-id="d9a5b-155">SQL_DIAG_DFC_SS_CURSOR_FETCH</span></span>|<span data-ttu-id="d9a5b-156">FETCH 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-156">FETCH statement</span></span>|  
|<span data-ttu-id="d9a5b-157">SQL_DIAG_DFC_SS_CURSOR_CLOSE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-157">SQL_DIAG_DFC_SS_CURSOR_CLOSE</span></span>|<span data-ttu-id="d9a5b-158">CLOSE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-158">CLOSE statement</span></span>|  
|<span data-ttu-id="d9a5b-159">SQL_DIAG_DFC_SS_DEALLOCATE_CURSOR</span><span class="sxs-lookup"><span data-stu-id="d9a5b-159">SQL_DIAG_DFC_SS_DEALLOCATE_CURSOR</span></span>|<span data-ttu-id="d9a5b-160">DEALLOCATE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-160">DEALLOCATE statement</span></span>|  
|<span data-ttu-id="d9a5b-161">SQL_DIAG_DFC_SS_DBCC</span><span class="sxs-lookup"><span data-stu-id="d9a5b-161">SQL_DIAG_DFC_SS_DBCC</span></span>|<span data-ttu-id="d9a5b-162">DBCC 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-162">DBCC statement</span></span>|  
|<span data-ttu-id="d9a5b-163">SQL_DIAG_DFC_SS_DENY</span><span class="sxs-lookup"><span data-stu-id="d9a5b-163">SQL_DIAG_DFC_SS_DENY</span></span>|<span data-ttu-id="d9a5b-164">DENY 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-164">DENY statement</span></span>|  
|<span data-ttu-id="d9a5b-165">SQL_DIAG_DFC_SS_DROP_DATABASE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-165">SQL_DIAG_DFC_SS_DROP_DATABASE</span></span>|<span data-ttu-id="d9a5b-166">DROP DATABASE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-166">DROP DATABASE statement</span></span>|  
|<span data-ttu-id="d9a5b-167">SQL_DIAG_DFC_SS_DROP_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-167">SQL_DIAG_DFC_SS_DROP_DEFAULT</span></span>|<span data-ttu-id="d9a5b-168">DROP DEFAULT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-168">DROP DEFAULT statement</span></span>|  
|<span data-ttu-id="d9a5b-169">SQL_DIAG_DFC_SS_DROP_PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-169">SQL_DIAG_DFC_SS_DROP_PROCEDURE</span></span>|<span data-ttu-id="d9a5b-170">DROP PROCEDURE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-170">DROP PROCEDURE statement</span></span>|  
|<span data-ttu-id="d9a5b-171">SQL_DIAG_DFC_SS_DROP_RULE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-171">SQL_DIAG_DFC_SS_DROP_RULE</span></span>|<span data-ttu-id="d9a5b-172">DROP RULE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-172">DROP RULE statement</span></span>|  
|<span data-ttu-id="d9a5b-173">SQL_DIAG_DFC_SS_DROP_TRIGGER</span><span class="sxs-lookup"><span data-stu-id="d9a5b-173">SQL_DIAG_DFC_SS_DROP_TRIGGER</span></span>|<span data-ttu-id="d9a5b-174">DROP TRIGGER 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-174">DROP TRIGGER statement</span></span>|  
|<span data-ttu-id="d9a5b-175">SQL_DIAG_DFC_SS_DUMP_DATABASE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-175">SQL_DIAG_DFC_SS_DUMP_DATABASE</span></span>|<span data-ttu-id="d9a5b-176">BACKUP 或 DUMP DATABASE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-176">BACKUP or DUMP DATABASE statement</span></span>|  
|<span data-ttu-id="d9a5b-177">SQL_DIAG_DFC_SS_DUMP_TABLE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-177">SQL_DIAG_DFC_SS_DUMP_TABLE</span></span>|<span data-ttu-id="d9a5b-178">DUMP TABLE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-178">DUMP TABLE statement</span></span>|  
|<span data-ttu-id="d9a5b-179">SQL_DIAG_DFC_SS_DUMP_TRANSACTION</span><span class="sxs-lookup"><span data-stu-id="d9a5b-179">SQL_DIAG_DFC_SS_DUMP_TRANSACTION</span></span>|<span data-ttu-id="d9a5b-180">BACKUP 或 DUMP TRANSACTION 语句。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-180">BACKUP or DUMP TRANSACTION statement.</span></span> <span data-ttu-id="d9a5b-181">如果**chkpt. 上的 trunc** ，则还会返回 CHECKPOINT 语句的。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-181">Also returned for a CHECKPOINT statement if the **trunc. log on chkpt.**</span></span> <span data-ttu-id="d9a5b-182">数据库选项为 on。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-182">database option is on.</span></span>|  
|<span data-ttu-id="d9a5b-183">SQL_DIAG_DFC_SS_GOTO</span><span class="sxs-lookup"><span data-stu-id="d9a5b-183">SQL_DIAG_DFC_SS_GOTO</span></span>|<span data-ttu-id="d9a5b-184">GOTO 控制流语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-184">GOTO control-of-flow statement</span></span>|  
|<span data-ttu-id="d9a5b-185">SQL_DIAG_DFC_SS_INSERT_BULK</span><span class="sxs-lookup"><span data-stu-id="d9a5b-185">SQL_DIAG_DFC_SS_INSERT_BULK</span></span>|<span data-ttu-id="d9a5b-186">INSERT BULK 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-186">INSERT BULK statement</span></span>|  
|<span data-ttu-id="d9a5b-187">SQL_DIAG_DFC_SS_KILL</span><span class="sxs-lookup"><span data-stu-id="d9a5b-187">SQL_DIAG_DFC_SS_KILL</span></span>|<span data-ttu-id="d9a5b-188">KILL 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-188">KILL statement</span></span>|  
|<span data-ttu-id="d9a5b-189">SQL_DIAG_DFC_SS_LOAD_DATABASE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-189">SQL_DIAG_DFC_SS_LOAD_DATABASE</span></span>|<span data-ttu-id="d9a5b-190">LOAD 或 RESTORE DATABASE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-190">LOAD or RESTORE DATABASE statement</span></span>|  
|<span data-ttu-id="d9a5b-191">SQL_DIAG_DFC_SS_LOAD_HEADERONLY</span><span class="sxs-lookup"><span data-stu-id="d9a5b-191">SQL_DIAG_DFC_SS_LOAD_HEADERONLY</span></span>|<span data-ttu-id="d9a5b-192">LOAD 或 RESTORE HEADERONLY 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-192">LOAD or RESTORE HEADERONLY statement</span></span>|  
|<span data-ttu-id="d9a5b-193">SQL_DIAG_DFC_SS_LOAD_TABLE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-193">SQL_DIAG_DFC_SS_LOAD_TABLE</span></span>|<span data-ttu-id="d9a5b-194">LOAD TABLE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-194">LOAD TABLE statement</span></span>|  
|<span data-ttu-id="d9a5b-195">SQL_DIAG_DFC_SS_LOAD_TRANSACTION</span><span class="sxs-lookup"><span data-stu-id="d9a5b-195">SQL_DIAG_DFC_SS_LOAD_TRANSACTION</span></span>|<span data-ttu-id="d9a5b-196">LOAD 或 RESTORE TRANSACTION 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-196">LOAD or RESTORE TRANSACTION statement</span></span>|  
|<span data-ttu-id="d9a5b-197">SQL_DIAG_DFC_SS_PRINT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-197">SQL_DIAG_DFC_SS_PRINT</span></span>|<span data-ttu-id="d9a5b-198">PRINT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-198">PRINT statement</span></span>|  
|<span data-ttu-id="d9a5b-199">SQL_DIAG_DFC_SS_RAISERROR</span><span class="sxs-lookup"><span data-stu-id="d9a5b-199">SQL_DIAG_DFC_SS_RAISERROR</span></span>|<span data-ttu-id="d9a5b-200">RAISERROR 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-200">RAISERROR statement</span></span>|  
|<span data-ttu-id="d9a5b-201">SQL_DIAG_DFC_SS_READTEXT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-201">SQL_DIAG_DFC_SS_READTEXT</span></span>|<span data-ttu-id="d9a5b-202">READTEXT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-202">READTEXT statement</span></span>|  
|<span data-ttu-id="d9a5b-203">SQL_DIAG_DFC_SS_RECONFIGURE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-203">SQL_DIAG_DFC_SS_RECONFIGURE</span></span>|<span data-ttu-id="d9a5b-204">RECONFIGURE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-204">RECONFIGURE statement</span></span>|  
|<span data-ttu-id="d9a5b-205">SQL_DIAG_DFC_SS_RETURN</span><span class="sxs-lookup"><span data-stu-id="d9a5b-205">SQL_DIAG_DFC_SS_RETURN</span></span>|<span data-ttu-id="d9a5b-206">RETURN 控制流语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-206">RETURN control-of-flow statement</span></span>|  
|<span data-ttu-id="d9a5b-207">SQL_DIAG_DFC_SS_SELECT_INTO</span><span class="sxs-lookup"><span data-stu-id="d9a5b-207">SQL_DIAG_DFC_SS_SELECT_INTO</span></span>|<span data-ttu-id="d9a5b-208">SELECT INTO 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-208">SELECT INTO statement</span></span>|  
|<span data-ttu-id="d9a5b-209">SQL_DIAG_DFC_SS_SET</span><span class="sxs-lookup"><span data-stu-id="d9a5b-209">SQL_DIAG_DFC_SS_SET</span></span>|<span data-ttu-id="d9a5b-210">SET 语句（常规，所有选项）</span><span class="sxs-lookup"><span data-stu-id="d9a5b-210">SET statement (generic, all options)</span></span>|  
|<span data-ttu-id="d9a5b-211">SQL_DIAG_DFC_SS_SET_IDENTITY_INSERT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-211">SQL_DIAG_DFC_SS_SET_IDENTITY_INSERT</span></span>|<span data-ttu-id="d9a5b-212">SET IDENTITY_INSERT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-212">SET IDENTITY_INSERT statement</span></span>|  
|<span data-ttu-id="d9a5b-213">SQL_DIAG_DFC_SS_SET_ROW_COUNT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-213">SQL_DIAG_DFC_SS_SET_ROW_COUNT</span></span>|<span data-ttu-id="d9a5b-214">SET ROWCOUNT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-214">SET ROWCOUNT statement</span></span>|  
|<span data-ttu-id="d9a5b-215">SQL_DIAG_DFC_SS_SET_STATISTICS</span><span class="sxs-lookup"><span data-stu-id="d9a5b-215">SQL_DIAG_DFC_SS_SET_STATISTICS</span></span>|<span data-ttu-id="d9a5b-216">SET STATISTICS IO 或 SET STATISTICS TIME 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-216">SET STATISTICS IO or SET STATISTICS TIME statements</span></span>|  
|<span data-ttu-id="d9a5b-217">SQL_DIAG_DFC_SS_SET_TEXTSIZE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-217">SQL_DIAG_DFC_SS_SET_TEXTSIZE</span></span>|<span data-ttu-id="d9a5b-218">SET TEXTSIZE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-218">SET TEXTSIZE statement</span></span>|  
|<span data-ttu-id="d9a5b-219">SQL_DIAG_DFC_SS_SETUSER</span><span class="sxs-lookup"><span data-stu-id="d9a5b-219">SQL_DIAG_DFC_SS_SETUSER</span></span>|<span data-ttu-id="d9a5b-220">SETUSER 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-220">SETUSER statement</span></span>|  
|<span data-ttu-id="d9a5b-221">SQL_DIAG_DFC_SS_SET_XCTLVL</span><span class="sxs-lookup"><span data-stu-id="d9a5b-221">SQL_DIAG_DFC_SS_SET_XCTLVL</span></span>|<span data-ttu-id="d9a5b-222">SET TRANSACTION ISOLATION LEVEL 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-222">SET TRANSACTION ISOLATION LEVEL statement</span></span>|  
|<span data-ttu-id="d9a5b-223">SQL_DIAG_DFC_SS_SHUTDOWN</span><span class="sxs-lookup"><span data-stu-id="d9a5b-223">SQL_DIAG_DFC_SS_SHUTDOWN</span></span>|<span data-ttu-id="d9a5b-224">SHUTDOWN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-224">SHUTDOWN statement</span></span>|  
|<span data-ttu-id="d9a5b-225">SQL_DIAG_DFC_SS_TRANS_BEGIN</span><span class="sxs-lookup"><span data-stu-id="d9a5b-225">SQL_DIAG_DFC_SS_TRANS_BEGIN</span></span>|<span data-ttu-id="d9a5b-226">BEGIN TRAN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-226">BEGIN TRAN statement</span></span>|  
|<span data-ttu-id="d9a5b-227">SQL_DIAG_DFC_SS_TRANS_COMMIT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-227">SQL_DIAG_DFC_SS_TRANS_COMMIT</span></span>|<span data-ttu-id="d9a5b-228">COMMIT TRAN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-228">COMMIT TRAN statement</span></span>|  
|<span data-ttu-id="d9a5b-229">SQL_DIAG_DFC_SS_TRANS_PREPARE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-229">SQL_DIAG_DFC_SS_TRANS_PREPARE</span></span>|<span data-ttu-id="d9a5b-230">准备提交分布式事务</span><span class="sxs-lookup"><span data-stu-id="d9a5b-230">Prepare to commit a distributed transaction</span></span>|  
|<span data-ttu-id="d9a5b-231">SQL_DIAG_DFC_SS_TRANS_ROLLBACK</span><span class="sxs-lookup"><span data-stu-id="d9a5b-231">SQL_DIAG_DFC_SS_TRANS_ROLLBACK</span></span>|<span data-ttu-id="d9a5b-232">ROLLBACK TRAN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-232">ROLLBACK TRAN statement</span></span>|  
|<span data-ttu-id="d9a5b-233">SQL_DIAG_DFC_SS_TRANS_SAVE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-233">SQL_DIAG_DFC_SS_TRANS_SAVE</span></span>|<span data-ttu-id="d9a5b-234">SAVE TRAN 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-234">SAVE TRAN statement</span></span>|  
|<span data-ttu-id="d9a5b-235">SQL_DIAG_DFC_SS_TRUNCATE_TABLE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-235">SQL_DIAG_DFC_SS_TRUNCATE_TABLE</span></span>|<span data-ttu-id="d9a5b-236">TRUNCATE TABLE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-236">TRUNCATE TABLE statement</span></span>|  
|<span data-ttu-id="d9a5b-237">SQL_DIAG_DFC_SS_UPDATE_STATISTICS</span><span class="sxs-lookup"><span data-stu-id="d9a5b-237">SQL_DIAG_DFC_SS_UPDATE_STATISTICS</span></span>|<span data-ttu-id="d9a5b-238">UPDATE STATISTICS 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-238">UPDATE STATISTICS statement</span></span>|  
|<span data-ttu-id="d9a5b-239">SQL_DIAG_DFC_SS_UPDATETEXT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-239">SQL_DIAG_DFC_SS_UPDATETEXT</span></span>|<span data-ttu-id="d9a5b-240">UPDATETEXT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-240">UPDATETEXT statement</span></span>|  
|<span data-ttu-id="d9a5b-241">SQL_DIAG_DFC_SS_USE</span><span class="sxs-lookup"><span data-stu-id="d9a5b-241">SQL_DIAG_DFC_SS_USE</span></span>|<span data-ttu-id="d9a5b-242">USE 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-242">USE statement</span></span>|  
|<span data-ttu-id="d9a5b-243">SQL_DIAG_DFC_SS_WAITFOR</span><span class="sxs-lookup"><span data-stu-id="d9a5b-243">SQL_DIAG_DFC_SS_WAITFOR</span></span>|<span data-ttu-id="d9a5b-244">WAITFOR 控制流语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-244">WAITFOR control-of-flow statement</span></span>|  
|<span data-ttu-id="d9a5b-245">SQL_DIAG_DFC_SS_WRITETEXT</span><span class="sxs-lookup"><span data-stu-id="d9a5b-245">SQL_DIAG_DFC_SS_WRITETEXT</span></span>|<span data-ttu-id="d9a5b-246">WRITETEXT 语句</span><span class="sxs-lookup"><span data-stu-id="d9a5b-246">WRITETEXT statement</span></span>|  
  
## <a name="sqlgetdiagfield-and-table-valued-parameters"></a><span data-ttu-id="d9a5b-247">SQLGetDiagField 和表值参数</span><span class="sxs-lookup"><span data-stu-id="d9a5b-247">SQLGetDiagField and Table-Valued Parameters</span></span>  
 <span data-ttu-id="d9a5b-248">SQLGetDiagField 可用于检索两个诊断字段： SQL_DIAG_SS_TABLE_COLUMN_NUMBER 和 SQL_DIAG_SS_TABLE_ROW_NUMBER。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-248">SQLGetDiagField can be used to retrieve two diagnostic fields: SQL_DIAG_SS_TABLE_COLUMN_NUMBER and SQL_DIAG_SS_TABLE_ROW_NUMBER.</span></span> <span data-ttu-id="d9a5b-249">这些字段可帮助您确定哪个值导致了与诊断记录关联的错误或警告。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-249">These fields help you determine which value caused the error or warning associated with the diagnostic record.</span></span>  
  
 <span data-ttu-id="d9a5b-250">有关表值参数的详细信息，请参阅[ODBC&#41;&#40;表值参数](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)。</span><span class="sxs-lookup"><span data-stu-id="d9a5b-250">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d9a5b-251">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d9a5b-251">See Also</span></span>  
 <span data-ttu-id="d9a5b-252">[SQLGetDiagField 函数](https://go.microsoft.com/fwlink/?LinkId=59352) </span><span class="sxs-lookup"><span data-stu-id="d9a5b-252">[SQLGetDiagField Function](https://go.microsoft.com/fwlink/?LinkId=59352) </span></span>  
 [<span data-ttu-id="d9a5b-253">ODBC API 实现细节</span><span class="sxs-lookup"><span data-stu-id="d9a5b-253">ODBC API Implementation Details</span></span>](../../relational-databases/native-client-odbc-api/odbc-api-implementation-details.md)  
  
  
