---
title: 创建 SQL Server 表 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- tables [OLE DB]
- SQL Server Native Client OLE DB provider, tables
- DBCOLUMNDESC usage
- adding tables
- CreateTable function
ms.assetid: a7b8d142-d76a-44d9-a583-86ac5109fbe8
author: rothja
ms.author: jroth
ms.openlocfilehash: 7b3d11a26c2f5d27f28a60effdb26978edd07409
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587790"
---
# <a name="creating-sql-server-tables"></a><span data-ttu-id="7bc8b-102">创建 SQL Server 表</span><span class="sxs-lookup"><span data-stu-id="7bc8b-102">Creating SQL Server Tables</span></span>
  <span data-ttu-id="7bc8b-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序公开**ITableDefinition：： CreateTable**函数，允许使用者创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes the **ITableDefinition::CreateTable** function, allowing consumers to create [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="7bc8b-104">使用者使用**CreateTable**来创建使用者命名的永久表，并使用由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序生成的唯一名称的永久或临时表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-104">Consumers use **CreateTable** to create consumer-named permanent tables, and permanent or temporary tables with unique names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
 <span data-ttu-id="7bc8b-105">当使用者调用**ITableDefinition：： CreateTable**时，如果 DBPROP_TBL_TEMPTABLE 属性的值 VARIANT_TRUE，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将为使用者生成一个临时表名称。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-105">When the consumer calls **ITableDefinition::CreateTable**, if the value of the DBPROP_TBL_TEMPTABLE property is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="7bc8b-106">使用者将 CreateTable 方法的 pTableID 参数设置为 NULL\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-106">The consumer sets the *pTableID* parameter of the **CreateTable** method to NULL.</span></span> <span data-ttu-id="7bc8b-107">使用 Native Client OLE DB 提供程序生成的名称的临时表 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 不会显示在**表**行集中，而是可以通过**IOpenRowset**接口进行访问。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-107">The temporary tables with names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider do not appear in the **TABLES** rowset, but are accessible through the **IOpenRowset** interface.</span></span>  
  
 <span data-ttu-id="7bc8b-108">当使用者在*pTableID*参数的*UName*联合的*pwszName*成员中指定表名时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 使用该名称创建一个表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-108">When consumers specify the table name in the *pwszName* member of the *uName* union in the *pTableID* parameter, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with that name.</span></span> <span data-ttu-id="7bc8b-109">将应用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表命名约束，并且表名可以指示永久表或者指示本地或全局临时表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table naming constraints apply, and the table name can indicate a permanent table, or either a local or global temporary table.</span></span> <span data-ttu-id="7bc8b-110">有关详细信息，请参阅 [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-110">For more information, see [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql).</span></span> <span data-ttu-id="7bc8b-111">ppTableID 参数可为 NULL\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-111">The *ppTableID* parameter can be NULL.</span></span>  
  
 <span data-ttu-id="7bc8b-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序可以生成永久或临时表的名称。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider can generate the names of permanent or temporary tables.</span></span> <span data-ttu-id="7bc8b-113">当使用者将*pTableID*参数设置为 NULL 并将*ppTableID*设置为指向有效的 DBID 时 \* ， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将在*PpTableID*的值指向的 dbid 的*pwszName*成员中*uName*返回表的生成名称。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-113">When the consumer sets the *pTableID* parameter to NULL and sets *ppTableID* to point to a valid DBID\*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns the generated name of the table in the *pwszName* member of the *uName* union of the DBID pointed to by the value of *ppTableID*.</span></span> <span data-ttu-id="7bc8b-114">若要创建临时的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序命名的表，使用者在*rgPropertySets*参数中引用的表属性集中包含 OLE DB 的表属性 DBPROP_TBL_TEMPTABLE。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-114">To create a temporary, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider-named table, the consumer includes the OLE DB table property DBPROP_TBL_TEMPTABLE in a table property set referenced in the *rgPropertySets* parameter.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="7bc8b-115">Native Client OLE DB 提供程序命名的临时表是本地的。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-115">Native Client OLE DB provider-named temporary tables are local.</span></span>  
  
 <span data-ttu-id="7bc8b-116">如果 pTableID 参数的 eKind 成员未指示 DBKIND_NAME，CreateTable 将返回 DB_E_BADTABLEID\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-116">**CreateTable** returns DB_E_BADTABLEID if the *eKind* member of the *pTableID* parameter does not indicate DBKIND_NAME.</span></span>  
  
## <a name="dbcolumndesc-usage"></a><span data-ttu-id="7bc8b-117">DBCOLUMNDESC 用法</span><span class="sxs-lookup"><span data-stu-id="7bc8b-117">DBCOLUMNDESC Usage</span></span>  
 <span data-ttu-id="7bc8b-118">使用者可通过使用 pwszTypeName 成员或 wType 成员指示列数据类型\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-118">The consumer can indicate a column data type by using either the *pwszTypeName* member or the *wType* member.</span></span> <span data-ttu-id="7bc8b-119">如果使用者在*pwszTypeName*中指定数据类型，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将忽略*wType*的值。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-119">If the consumer specifies the data type in *pwszTypeName*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider ignores the value of *wType*.</span></span>  
  
 <span data-ttu-id="7bc8b-120">如果使用 pwszTypeName 成员，则使用者将通过使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据类型名称指定数据类型\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-120">If using the *pwszTypeName* member, the consumer specifies the data type by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type names.</span></span> <span data-ttu-id="7bc8b-121">有效的数据类型名称是在 PROVIDER_TYPES 架构行集的 TYPE_NAME 列中返回的名称。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-121">Valid data type names are those returned in the TYPE_NAME column of the PROVIDER_TYPES schema rowset.</span></span>  
  
 <span data-ttu-id="7bc8b-122">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序识别*wType*成员中 OLE DB 枚举的 DBTYPE 值的子集。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-122">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider recognizes a subset of OLE DB-enumerated DBTYPE values in the *wType* member.</span></span> <span data-ttu-id="7bc8b-123">有关详细信息，请参阅 [ITableDefinition 中的数据类型映射](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-123">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7bc8b-124">如果使用者设置 pTypeInfo 或 pclsid 成员以指定列数据类型，则 CreateTable 返回 DB_E_BADTYPE\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-124">**CreateTable** returns DB_E_BADTYPE if consumer sets either the *pTypeInfo* or *pclsid* member to specify the column data type.</span></span>  
  
 <span data-ttu-id="7bc8b-125">使用者在 DBCOLUMNDESC dbcid 成员的 uName 联合的 pwszName 成员中指定列名\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-125">The consumer specifies the column name in the *pwszName* member of the *uName* union of the DBCOLUMNDESC *dbcid* member.</span></span> <span data-ttu-id="7bc8b-126">该列名指定为 Unicode 字符串。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-126">The column name is specified as a Unicode character string.</span></span> <span data-ttu-id="7bc8b-127">dbcid 的 eKind 成员必须为 DBKIND_NAME\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-127">The *eKind* member of *dbcid* must be DBKIND_NAME.</span></span> <span data-ttu-id="7bc8b-128">如果 eKind 无效且 pwszName 为 NULL，或者如果 pwszName 的值不是有效的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识符，则 CreateTable 返回 DB_E_BADCOLUMNID\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-128">**CreateTable** returns DB_E_BADCOLUMNID if *eKind* is invalid, *pwszName* is NULL, or if the value of *pwszName* is not a valid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identifier.</span></span>  
  
 <span data-ttu-id="7bc8b-129">所有列属性均可用于为表定义的所有列上。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-129">All column properties are available on all columns defined for the table.</span></span> <span data-ttu-id="7bc8b-130">如果所设置的属性值相互冲突，则 CreateTable 可能返回 DB_S_ERRORSOCCURRED 或 DB_E_ERRORSOCCURRED\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-130">**CreateTable** can return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED if property values are set in conflict.</span></span> <span data-ttu-id="7bc8b-131">当无效的列属性设置导致 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表创建失败时，CreateTable 将返回错误\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-131">**CreateTable** returns an error when invalid column property settings cause [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table-creation failure.</span></span>  
  
 <span data-ttu-id="7bc8b-132">DBCOLUMNDESC 中的列属性解释如下。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-132">Column properties in a DBCOLUMNDESC are interpreted as follows.</span></span>  
  
|<span data-ttu-id="7bc8b-133">属性 ID</span><span class="sxs-lookup"><span data-stu-id="7bc8b-133">Property ID</span></span>|<span data-ttu-id="7bc8b-134">说明</span><span class="sxs-lookup"><span data-stu-id="7bc8b-134">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="7bc8b-135">DBPROP_COL_AUTOINCREMENT</span><span class="sxs-lookup"><span data-stu-id="7bc8b-135">DBPROP_COL_AUTOINCREMENT</span></span>|<span data-ttu-id="7bc8b-136">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-136">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-137">默认值：VARIANT_FALSE。说明：对于所创建的列设置标识属性。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-137">Default: VARIANT_FALSE Description: Sets the identity property on the column created.</span></span> <span data-ttu-id="7bc8b-138">对于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]，标识属性对表中的单一列有效。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-138">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the identity property is valid for a single column within a table.</span></span> <span data-ttu-id="7bc8b-139">如果将多个列的属性设置为 VARIANT_TRUE，则当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序尝试在服务器上创建表时，将生成错误。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-139">Setting the property to VARIANT_TRUE for more than a single column generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="7bc8b-140">当小数位数为 0 时，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识属性仅对 integer、numeric 和 decimal 类型有效\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property is only valid for the **integer**, **numeric**, and **decimal** types when the scale is 0.</span></span> <span data-ttu-id="7bc8b-141">当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序尝试在服务器上创建表时，将属性设置为对任何其他数据类型的列 VARIANT_TRUE 将生成错误。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-141">Setting the property to VARIANT_TRUE on a column of any other data type generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="7bc8b-142">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]当 DBPROP_COL_AUTOINCREMENT 和 DBPROP_COL_NULLABLE 均为 VARIANT_TRUE 并且未 DBPROP_COL_NULLABLE DBPROPOPTIONS_REQUIRED 的*dwOption*时，Native Client OLE DB 提供程序将返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-142">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE is not DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="7bc8b-143">当 DBPROP_COL_AUTOINCREMENT 和 DBPROP_COL_NULLABLE 均为 VARIANT_TRUE，且 DBPROP_COL_NULLABLE 的 dwOption 等于 DBPROPOPTIONS_REQUIRED 时，返回 DB_E_ERRORSOCCURRED\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-143">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="7bc8b-144">此列使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识属性进行定义，并且 DBPROP_COL_NULLABLE dwStatus 成员设置为 DBPROPSTATUS_CONFLICTING\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-144">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span>|  
|<span data-ttu-id="7bc8b-145">DBPROP_COL_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="7bc8b-145">DBPROP_COL_DEFAULT</span></span>|<span data-ttu-id="7bc8b-146">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-146">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-147">默认值：无</span><span class="sxs-lookup"><span data-stu-id="7bc8b-147">Default: None</span></span><br /><br /> <span data-ttu-id="7bc8b-148">说明：为该列创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT 约束。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-148">Description: Creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT constraint for the column.</span></span><br /><br /> <span data-ttu-id="7bc8b-149">vValue DBPROP 成员可以属于许多类型中的任何一种\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-149">The *vValue* DBPROP member can be any of a number of types.</span></span> <span data-ttu-id="7bc8b-150">vValue.vt 成员指定的类型应与列的数据类型兼容\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-150">The *vValue.vt* member should specify a type compatible with the data type of the column.</span></span> <span data-ttu-id="7bc8b-151">例如，对于定义为 DBTYPE_WSTR 的某列将 BSTR N/A 定义为默认值就是一个兼容的匹配。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-151">For example, defining BSTR N/A as the default value for a column defined as DBTYPE_WSTR is a compatible match.</span></span> <span data-ttu-id="7bc8b-152">如果对定义为 DBTYPE_R8 的列定义相同的默认值，则当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序尝试在服务器上创建表时，将生成错误。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-152">Defining the same default on a column defined as DBTYPE_R8 generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span>|  
|<span data-ttu-id="7bc8b-153">DBPROP_COL_DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="7bc8b-153">DBPROP_COL_DESCRIPTION</span></span>|<span data-ttu-id="7bc8b-154">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-154">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-155">默认值：无</span><span class="sxs-lookup"><span data-stu-id="7bc8b-155">Default: None</span></span><br /><br /> <span data-ttu-id="7bc8b-156">说明： DBPROP_COL_DESCRIPTION 列属性不是由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序实现的。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-156">Description: The DBPROP_COL_DESCRIPTION column property is not implemented by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="7bc8b-157">当使用者尝试写入属性值时，DBPROP 结构的 dwStatus 成员将返回 DBPROPSTATUS_NOTSUPPORTED\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-157">The *dwStatus* member of the DBPROP structure returns DBPROPSTATUS_NOTSUPPORTED when the consumer attempts to write the property value.</span></span><br /><br /> <span data-ttu-id="7bc8b-158">设置属性不会为 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序提供致命错误。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-158">Setting the property does not constitute a fatal error for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="7bc8b-159">如果所有其他参数值有效，则创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-159">If all other parameter values are valid, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table is created.</span></span>|  
|<span data-ttu-id="7bc8b-160">DBPROP_COL_FIXEDLENGTH</span><span class="sxs-lookup"><span data-stu-id="7bc8b-160">DBPROP_COL_FIXEDLENGTH</span></span>|<span data-ttu-id="7bc8b-161">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-161">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-162">默认值：VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="7bc8b-162">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="7bc8b-163">说明： [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 当使用者使用 DBCOLUMNDESC 的*wType*成员定义列的数据类型时，Native Client OLE DB 提供程序使用 DBPROP_COL_FIXEDLENGTH 确定数据类型映射。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-163">Description: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses DBPROP_COL_FIXEDLENGTH to determine data type-mapping when the consumer defines a column's data type by using the *wType* member of the DBCOLUMNDESC.</span></span> <span data-ttu-id="7bc8b-164">有关详细信息，请参阅 [ITableDefinition 中的数据类型映射](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-164">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>|  
|<span data-ttu-id="7bc8b-165">DBPROP_COL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="7bc8b-165">DBPROP_COL_NULLABLE</span></span>|<span data-ttu-id="7bc8b-166">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-166">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-167">默认值：无</span><span class="sxs-lookup"><span data-stu-id="7bc8b-167">Default: None</span></span><br /><br /> <span data-ttu-id="7bc8b-168">说明：在创建表时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序指示列是否应在设置了属性时接受 null 值。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-168">Description: When creating the table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider indicates whether the column should accept null values if the property is set.</span></span> <span data-ttu-id="7bc8b-169">如果未设置此属性，则该列能否接受 NULL 作为值将由 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS 默认数据库选项确定。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-169">When the property is not set, the ability of the column to accept NULL as a value is determined by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS default database option.</span></span><br /><br /> <span data-ttu-id="7bc8b-170">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 提供程序是符合 ISO 要求的提供程序。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider is an ISO-compliant provider.</span></span> <span data-ttu-id="7bc8b-171">所连接的会话展现 ISO 行为。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-171">Connected sessions exhibit ISO behaviors.</span></span> <span data-ttu-id="7bc8b-172">如果使用者未设置 DBPROP_COL_NULLABLE，则列接受 NULL 值。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-172">If the consumer does not set DBPROP_COL_NULLABLE, columns accept null values.</span></span>|  
|<span data-ttu-id="7bc8b-173">DBPROP_COL_PRIMARYKEY</span><span class="sxs-lookup"><span data-stu-id="7bc8b-173">DBPROP_COL_PRIMARYKEY</span></span>|<span data-ttu-id="7bc8b-174">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-174">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-175">默认值： VARIANT_FALSE 说明： VARIANT_TRUE 时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将创建具有 PRIMARY KEY 约束的列。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-175">Default: VARIANT_FALSE Description: When VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates the column with a PRIMARY KEY constraint.</span></span><br /><br /> <span data-ttu-id="7bc8b-176">当定义为列属性时，仅单一列能够确定约束。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-176">When defined as a column property, only a single column can determine the constraint.</span></span> <span data-ttu-id="7bc8b-177">如果将多个列的属性 VARIANT_TRUE 设置为，则当 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序尝试创建该表时，将返回错误 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-177">Setting the property VARIANT_TRUE for more than a single column returns an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span><br /><br /> <span data-ttu-id="7bc8b-178">注意：使用者可通过 IIndexDefinition::CreateIndex 在两列或更多列上创建 PRIMARY KEY 约束\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-178">Note: The consumer can use **IIndexDefinition::CreateIndex** to create a PRIMARY KEY constraint on two or more columns.</span></span><br /><br /> <span data-ttu-id="7bc8b-179">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]当 DBPROP_COL_PRIMARYKEY 和 DBPROP_COL_UNIQUE 均为 VARIANT_TRUE 并且未 DBPROP_COL_UNIQUE DBPROPOPTIONS_REQUIRED 的*dwOption*时，Native Client OLE DB 提供程序将返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-179">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="7bc8b-180">当 DBPROP_COL_PRIMARYKEY 和 DBPROP_COL_UNIQUE 均为 VARIANT_TRUE，且 DBPROP_COL_UNIQUE 的 dwOption 等于 DBPROPOPTIONS_REQUIRED 时，返回 DB_E_ERRORSOCCURRED\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-180">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="7bc8b-181">此列使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识属性进行定义，并且 DBPROP_COL_PRIMARYKEY dwStatus 成员设置为 DBPROPSTATUS_CONFLICTING\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-181">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="7bc8b-182">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]当 DBPROP_COL_PRIMARYKEY 和 DBPROP_COL_NULLABLE 都 VARIANT_TRUE 时，Native Client OLE DB 提供程序将返回错误。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-182">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error when DBPROP_COL_PRIMARYKEY and DBPROP_COL_NULLABLE are both VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="7bc8b-183">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 当使用者尝试对无效数据类型的列创建 PRIMARY KEY 约束时，Native Client OLE DB 提供程序将返回错误 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-183">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a PRIMARY KEY constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="7bc8b-184">对于使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据类型 bit、text、ntext 和 image 创建的列，无法定义 PRIMARY KEY 约束\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-184">PRIMARY KEY constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types **bit**, **text**, **ntext**, and **image**.</span></span>|  
|<span data-ttu-id="7bc8b-185">DBPROP_COL_UNIQUE</span><span class="sxs-lookup"><span data-stu-id="7bc8b-185">DBPROP_COL_UNIQUE</span></span>|<span data-ttu-id="7bc8b-186">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-186">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-187">默认值：VARIANT_FALSE。说明：将 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UNIQUE 约束应用于列。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-187">Default: VARIANT_FALSE Description: Applies a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UNIQUE constraint to the column.</span></span><br /><br /> <span data-ttu-id="7bc8b-188">当定义为列属性时，此约束仅应用于单一列。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-188">When defined as a column property, the constraint is applied on a single column only.</span></span> <span data-ttu-id="7bc8b-189">使用者可以使用 IIndexDefinition::CreateIndex 将 UNIQUE 约束应用于两列或更多列的组合值\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-189">The consumer can use **IIndexDefinition::CreateIndex** to apply a UNIQUE constraint on the combined values of two or more columns.</span></span><br /><br /> <span data-ttu-id="7bc8b-190">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]当 DBPROP_COL_PRIMARYKEY 和 DBPROP_COL_UNIQUE 都是 VARIANT_TRUE 并且*dwOption*未 DBPROPOPTIONS_REQUIRED 时，Native Client OLE DB 提供程序将返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-190">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="7bc8b-191">当 DBPROP_COL_PRIMARYKEY 和 DBPROP_COL_UNIQUE 均为 VARIANT_TRUE，且 dwOption 等于 DBPROPOPTIONS_REQUIRED 时，将返回 DB_E_ERRORSOCCURRED\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-191">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="7bc8b-192">此列使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识属性进行定义，并且 DBPROP_COL_PRIMARYKEY dwStatus 成员设置为 DBPROPSTATUS_CONFLICTING\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-192">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="7bc8b-193">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]当 DBPROP_COL_NULLABLE 和 DBPROP_COL_UNIQUE 都是 VARIANT_TRUE 并且*dwOption*未 DBPROPOPTIONS_REQUIRED 时，Native Client OLE DB 提供程序将返回 DB_S_ERRORSOCCURRED。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-193">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="7bc8b-194">当 DBPROP_COL_NULLABLE 和 DBPROP_COL_UNIQUE 均为 VARIANT_TRUE，且 dwOption 等于 DBPROPOPTIONS_REQUIRED 时，将返回 DB_E_ERRORSOCCURRED\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-194">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="7bc8b-195">此列使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 标识属性进行定义，并且 DBPROP_COL_NULLABLE dwStatus 成员设置为 DBPROPSTATUS_CONFLICTING\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-195">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="7bc8b-196">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 当使用者尝试对无效数据类型的列创建 UNIQUE 约束时，Native Client OLE DB 提供程序将返回错误 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-196">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a UNIQUE constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="7bc8b-197">无法在使用  bit[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] \*\*\*\* 数据类型创建的列上定义 UNIQUE 约束。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-197">UNIQUE constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** data type.</span></span>|  
  
 <span data-ttu-id="7bc8b-198">当使用者调用**ITableDefinition：： CreateTable**时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将按如下所示解释表属性。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-198">When the consumer calls **ITableDefinition::CreateTable**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider interprets table properties as follows.</span></span>  
  
|<span data-ttu-id="7bc8b-199">属性 ID</span><span class="sxs-lookup"><span data-stu-id="7bc8b-199">Property ID</span></span>|<span data-ttu-id="7bc8b-200">说明</span><span class="sxs-lookup"><span data-stu-id="7bc8b-200">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="7bc8b-201">DBPROP_TBL_TEMPTABLE</span><span class="sxs-lookup"><span data-stu-id="7bc8b-201">DBPROP_TBL_TEMPTABLE</span></span>|<span data-ttu-id="7bc8b-202">R/W：读取/写入</span><span class="sxs-lookup"><span data-stu-id="7bc8b-202">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="7bc8b-203">默认值： VARIANT_FALSE 说明：默认情况下， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将创建使用者命名的表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-203">Default: VARIANT_FALSE Description: By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates tables named by the consumer.</span></span> <span data-ttu-id="7bc8b-204">VARIANT_TRUE 时， [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序将为使用者生成一个临时表名称。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-204">When VARIANT_TRUE, The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="7bc8b-205">使用者将 CreateTable 的 pTableID 参数设置为 NULL\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-205">The consumer sets the *pTableID* parameter of **CreateTable** to NULL.</span></span> <span data-ttu-id="7bc8b-206">ppTableID 参数必须包含有效指针\*\*。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-206">The *ppTableID* parameter must contain a valid pointer.</span></span>|  
  
 <span data-ttu-id="7bc8b-207">如果使用者请求在成功创建的表上打开行集，则 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 提供程序会打开游标支持的行集。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-207">If the consumer requests that a rowset be opened on a successfully created table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider opens a cursor-supported rowset.</span></span> <span data-ttu-id="7bc8b-208">可以在所传递的属性集中指示任何行集属性。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-208">Any rowset properties can be indicated in the property sets passed.</span></span>  
  
 <span data-ttu-id="7bc8b-209">此示例创建一个 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表。</span><span class="sxs-lookup"><span data-stu-id="7bc8b-209">This example creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span>  
  
```  
// This CREATE TABLE statement shows the details of the table created by   
// the following example code.  
//  
// CREATE TABLE OrderDetails  
// (  
//    OrderID      int      NOT NULL  
//    ProductID   int      NOT NULL  
//    CONSTRAINT PK_OrderDetails  
//         PRIMARY KEY CLUSTERED (OrderID, ProductID),  
//    UnitPrice   money      NOT NULL,  
//    Quantity   int      NOT NULL,  
//    Discount   decimal(2,2)   NOT NULL  
//        DEFAULT 0  
// )  
//  
// The PRIMARY KEY constraint is created in an additional example.  
HRESULT CreateTable  
    (  
    ITableDefinition* pITableDefinition  
    )  
    {  
    DBID            dbidTable;  
    const ULONG     nCols = 5;  
    ULONG           nCol;  
    ULONG           nProp;  
    DBCOLUMNDESC    dbcoldesc[nCols];  
  
    HRESULT         hr;  
  
    // Set up column descriptions. First, set default property values for  
    //  the columns.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        dbcoldesc[nCol].pwszTypeName = NULL;  
        dbcoldesc[nCol].pTypeInfo = NULL;  
        dbcoldesc[nCol].rgPropertySets = new DBPROPSET;  
        dbcoldesc[nCol].pclsid = NULL;  
        dbcoldesc[nCol].cPropertySets = 1;  
        dbcoldesc[nCol].ulColumnSize = 0;  
        dbcoldesc[nCol].dbcid.eKind = DBKIND_NAME;  
        dbcoldesc[nCol].wType = DBTYPE_I4;  
        dbcoldesc[nCol].bPrecision = 0;  
        dbcoldesc[nCol].bScale = 0;  
  
        dbcoldesc[nCol].rgPropertySets[0].rgProperties =   
            new DBPROP[NCOLPROPS_MAX];  
        dbcoldesc[nCol].rgPropertySets[0].cProperties = NCOLPROPS_MAX;  
        dbcoldesc[nCol].rgPropertySets[0].guidPropertySet =  
            DBPROPSET_COLUMN;  
  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                dwOptions = DBPROPOPTIONS_REQUIRED;  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].colid  
                 = DB_NULLID;  
  
            VariantInit(  
                &(dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                    vValue));  
  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt = VT_BOOL;  
            }  
        }  
  
    // Set the column-specific information.  
    dbcoldesc[0].dbcid.uName.pwszName = L"OrderID";  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[0].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[1].dbcid.uName.pwszName = L"ProductID";  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[1].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[2].dbcid.uName.pwszName = L"UnitPrice";  
    dbcoldesc[2].wType = DBTYPE_CY;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[2].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[3].dbcid.uName.pwszName = L"Quantity";  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[3].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[4].dbcid.uName.pwszName = L"Discount";  
    dbcoldesc[4].wType = DBTYPE_NUMERIC;  
    dbcoldesc[4].bPrecision = 2;  
    dbcoldesc[4].bScale = 2;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].dwPropertyID =   
        DBPROP_COL_DEFAULT;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.vt = VT_BSTR;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.bstrVal =  
        SysAllocString(L"0");  
    dbcoldesc[4].rgPropertySets[0].cProperties = 2;  
  
    // Set up the dbid for OrderDetails.  
    dbidTable.eKind = DBKIND_NAME;  
    dbidTable.uName.pwszName = L"OrderDetails";  
  
    if (FAILED(hr = pITableDefinition->CreateTable(NULL, &dbidTable,  
        nCols, dbcoldesc, NULL, 0, NULL, NULL, NULL)))  
        {  
        DumpError(pITableDefinition, IID_ITableDefinition);  
        goto SAFE_EXIT;  
        }  
  
SAFE_EXIT:  
    // Clean up dynamic allocation in the property sets.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            if (dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt == VT_BSTR)  
                {  
                SysFreeString(dbcoldesc[nCol].rgPropertySets[0].  
                    rgProperties[nProp].vValue.bstrVal);  
                }  
            }  
  
        delete [] dbcoldesc[nCol].rgPropertySets[0].rgProperties;  
        delete [] dbcoldesc[nCol].rgPropertySets;  
        }  
  
    return (hr);  
    }  
```  
  
## <a name="see-also"></a><span data-ttu-id="7bc8b-210">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7bc8b-210">See Also</span></span>  
 [<span data-ttu-id="7bc8b-211">表和索引</span><span class="sxs-lookup"><span data-stu-id="7bc8b-211">Tables and Indexes</span></span>](../../relational-databases/native-client-ole-db-tables-indexes/tables-and-indexes.md)  
  
  
