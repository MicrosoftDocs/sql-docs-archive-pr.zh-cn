---
title: SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689468"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="a4f53-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a4f53-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="a4f53-103">支持 Windows PowerShell，Windows PowerShell 是一个功能强大的脚本 shell，管理员和开发人员可以通过它自动执行服务器管理和应用程序部署。</span><span class="sxs-lookup"><span data-stu-id="a4f53-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="a4f53-104">与 [!INCLUDE[tsql](../includes/tsql-md.md)] 脚本相比，Windows PowerShell 语言能够支持更复杂的逻辑，这使得 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理员能够生成强大的管理脚本。</span><span class="sxs-lookup"><span data-stu-id="a4f53-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="a4f53-105">Windows PowerShell 脚本还可用来管理其他 [!INCLUDE[msCoName](../includes/msconame-md.md)] 服务器产品，</span><span class="sxs-lookup"><span data-stu-id="a4f53-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="a4f53-106">这为管理员提供一个跨服务器的公用脚本语言。</span><span class="sxs-lookup"><span data-stu-id="a4f53-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="a4f53-107">SQL Server PowerShell 组件</span><span class="sxs-lookup"><span data-stu-id="a4f53-107">SQL Server PowerShell Components</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="a4f53-108">提供了一个名为 `sqlps` 的 Windows PowerShell 模块，该模块用于将 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 组件导入到 Windows PowerShell 2.0 环境或脚本中。</span><span class="sxs-lookup"><span data-stu-id="a4f53-108">provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="a4f53-109"> 模块加载两个可用来实现以下内容的 Windows PowerShell 管理单元：</span><span class="sxs-lookup"><span data-stu-id="a4f53-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="a4f53-110">一个 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序（允许使用类似于文件系统路径的简单导航机制）。</span><span class="sxs-lookup"><span data-stu-id="a4f53-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="a4f53-111">您可以生成类似于文件系统路径的路径，在该路径中，驱动器与 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理对象模型关联，节点基于对象模型类。</span><span class="sxs-lookup"><span data-stu-id="a4f53-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="a4f53-112">然后，你可以使用熟悉的命令（如 **cd** 和 **dir** ），按照在命令提示符窗口中导航文件夹的类似方式导航路径。</span><span class="sxs-lookup"><span data-stu-id="a4f53-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="a4f53-113">可以使用其他命令（如 **ren** 或 **del**）对路径中的节点执行操作。</span><span class="sxs-lookup"><span data-stu-id="a4f53-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="a4f53-114">一组 cmdlet（它们在 Windows PowerShell 脚本中用于指定 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 操作）。</span><span class="sxs-lookup"><span data-stu-id="a4f53-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="a4f53-115">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlet 支持各种操作，如运行包含 **或 XQuery 语句的** sqlcmd [!INCLUDE[tsql](../includes/tsql-md.md)] 脚本。</span><span class="sxs-lookup"><span data-stu-id="a4f53-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="a4f53-116">若要了解有关 Windows PowerShell 的信息，请参阅 [Windows PowerShell 入门指南](https://msdn.microsoft.com/library/hh857337.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a4f53-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="a4f53-117">SQL Server 版本</span><span class="sxs-lookup"><span data-stu-id="a4f53-117">SQL Server Versions</span></span>  
 <span data-ttu-id="a4f53-118">[!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell 组件可用于管理 [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] 或更高版本的实例。</span><span class="sxs-lookup"><span data-stu-id="a4f53-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="a4f53-119">[!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] 的实例必须运行 SP2 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="a4f53-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="a4f53-120">[!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] 的实例必须运行 SP4 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="a4f53-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="a4f53-121">将 [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell 组件与 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]的早期版本一起使用时，这些组件的功能将限制为在那些版本中提供的功能。</span><span class="sxs-lookup"><span data-stu-id="a4f53-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="a4f53-122">SQL Server PowerShell 任务</span><span class="sxs-lookup"><span data-stu-id="a4f53-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="a4f53-123">任务说明</span><span class="sxs-lookup"><span data-stu-id="a4f53-123">Task Description</span></span>|<span data-ttu-id="a4f53-124">主题</span><span class="sxs-lookup"><span data-stu-id="a4f53-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="a4f53-125">介绍用于运行 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell 组件、打开 PowerShell 会话和加载 `sqlps` 模块的首选机制。</span><span class="sxs-lookup"><span data-stu-id="a4f53-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="a4f53-126"> 模块在  PowerShell 提供程序和 cmdlet 以及该提供程序和 cmdlet 使用的 SQL Server 管理对象 (SMO) 程序集中加载。</span><span class="sxs-lookup"><span data-stu-id="a4f53-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="a4f53-127">导入 SQLPS 模块</span><span class="sxs-lookup"><span data-stu-id="a4f53-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="a4f53-128">介绍如何仅加载 SMO 程序集而不加载提供程序或 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a4f53-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="a4f53-129">在 Windows PowerShell 中加载 SMO 程序集</span><span class="sxs-lookup"><span data-stu-id="a4f53-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="a4f53-130">介绍如何通过右键单击“对象资源管理器”\*\*\*\* 中的节点来运行 Windows PowerShell 会话。</span><span class="sxs-lookup"><span data-stu-id="a4f53-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)] <span data-ttu-id="a4f53-131">启动 Windows PowerShell 会话，加载 `sqlps` 模块，并将 SQL Server 提供程序路径设置为选定的对象。</span><span class="sxs-lookup"><span data-stu-id="a4f53-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="a4f53-132">从 SQL Server Management Studio 中运行 Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a4f53-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="a4f53-133">介绍如何创建运行 Windows PowerShell 脚本的 SQL Server 代理作业步骤。</span><span class="sxs-lookup"><span data-stu-id="a4f53-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="a4f53-134">然后，可以将作业安排在特定时间或响应事件时运行。</span><span class="sxs-lookup"><span data-stu-id="a4f53-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="a4f53-135">在 SQL Server 代理中运行 Windows PowerShell 步骤</span><span class="sxs-lookup"><span data-stu-id="a4f53-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="a4f53-136">介绍如何使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序浏览 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 对象的层次结构。</span><span class="sxs-lookup"><span data-stu-id="a4f53-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="a4f53-137">SQL Server PowerShell 提供程序</span><span class="sxs-lookup"><span data-stu-id="a4f53-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="a4f53-138">介绍如何使用指定 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 操作（如运行 [!INCLUDE[ssDE](../includes/ssde-md.md)] 脚本）的 [!INCLUDE[tsql](../includes/tsql-md.md)] cmdlet。</span><span class="sxs-lookup"><span data-stu-id="a4f53-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="a4f53-139">使用数据库引擎 cmdlet</span><span class="sxs-lookup"><span data-stu-id="a4f53-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="a4f53-140">介绍如何指定包含 Windows PowerShell 不支持的字符的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 分隔标识符。</span><span class="sxs-lookup"><span data-stu-id="a4f53-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="a4f53-141">PowerShell 中的 SQL Server 标识符</span><span class="sxs-lookup"><span data-stu-id="a4f53-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="a4f53-142">介绍如何建立 SQL Server 身份验证连接。</span><span class="sxs-lookup"><span data-stu-id="a4f53-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="a4f53-143">默认情况下，SQL Server PowerShell 组件使用 Windows 身份验证连接，该连接使用运行 Windows PowerShell 的进程的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="a4f53-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="a4f53-144">在数据库引擎 PowerShell 中管理身份验证</span><span class="sxs-lookup"><span data-stu-id="a4f53-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="a4f53-145">介绍如何使用由 SQL Server PowerShell 提供程序实现的变量来控制使用 Windows PowerShell Tab 填写功能时列出的对象数。</span><span class="sxs-lookup"><span data-stu-id="a4f53-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="a4f53-146">当处理包含大量对象的数据库时，这一点特别有用。</span><span class="sxs-lookup"><span data-stu-id="a4f53-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="a4f53-147">管理 Tab 自动补全 (SQL Server PowerShell)</span><span class="sxs-lookup"><span data-stu-id="a4f53-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="a4f53-148">介绍如何使用 Get-Help 以获取有关 Windows PowerShell 环境中的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 组件的信息。</span><span class="sxs-lookup"><span data-stu-id="a4f53-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="a4f53-149">Get Help SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="a4f53-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
