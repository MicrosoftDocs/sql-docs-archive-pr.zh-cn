---
title: SQL Server PowerShell 提供程序 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
helpviewer_keywords:
- PowerShell [SQL Server], provider
- PowerShell [SQL Server], SQL Server PowerShell Provider
- Providers [PowerShell]
- SMO [SQL Server], PowerShell
- PowerShell [SQL Server], SMO
- SQL Server Management Objects, PowerShell
ms.assetid: b97acc43-fcd2-4ae5-b218-e183bab916f9
author: stevestein
ms.author: sstein
ms.openlocfilehash: 425c49fe8ebed1ea75c7872f9b99af5ea0f510ff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689469"
---
# <a name="sql-server-powershell-provider"></a><span data-ttu-id="6cbe0-102">SQL Server PowerShell Provider</span><span class="sxs-lookup"><span data-stu-id="6cbe0-102">SQL Server PowerShell Provider</span></span>
  <span data-ttu-id="6cbe0-103">用于 Windows PowerShell 的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序用类似于文件系统路径的路径公开 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 对象的层次结构。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-103">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider for Windows PowerShell exposes the hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects in paths similar to file system paths.</span></span> <span data-ttu-id="6cbe0-104">可以使用路径来查找对象，然后使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理对象 (SMO) 模型中的方法来针对对象执行操作。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-104">You can use the paths to locate an object, and then use methods from the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Management Object (SMO) models to perform actions on the objects.</span></span>  
  
## <a name="benefits-of-the-sql-server-powershell-provider"></a><span data-ttu-id="6cbe0-105">SQL Server PowerShell 提供程序的优点</span><span class="sxs-lookup"><span data-stu-id="6cbe0-105">Benefits of the SQL Server PowerShell Provider</span></span>  
 <span data-ttu-id="6cbe0-106">通过 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序实现的路径有助于轻松地以交互方式查看 SQL Server 实例中的所有对象。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-106">The paths implemented by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider enable easily and interactively reviewing all of the objects in an instance of SQL Server.</span></span> <span data-ttu-id="6cbe0-107">您可以使用与您通常用于导航文件系统路径的命令相似的 Windows PowerShell 别名来导航路径。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-107">You can navigate the paths using Windows PowerShell aliases similar to the commands you typically use to navigate file system paths.</span></span>  
  
## <a name="the-sql-server-powershell-hierarchy"></a><span data-ttu-id="6cbe0-108">SQL Server PowerShell 层次结构</span><span class="sxs-lookup"><span data-stu-id="6cbe0-108">The SQL Server PowerShell Hierarchy</span></span>  
 <span data-ttu-id="6cbe0-109">可以用层次结构表示其数据或对象模型的产品使用 Windows PowerShell 提供程序来公开层次结构。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-109">Products whose data or object models can be represented in a hierarchy use Windows PowerShell providers to expose the hierarchies.</span></span> <span data-ttu-id="6cbe0-110">该层次结构是使用与 Windows 文件系统所用结构相似的驱动器和路径结构公开的。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-110">The hierarchy is exposed by using a drive and path structure similar to what the Windows file system uses.</span></span>  
  
 <span data-ttu-id="6cbe0-111">每个 Windows PowerShell 提供程序都实现一个或多个驱动器。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-111">Each Windows PowerShell provider implements one or more drives.</span></span> <span data-ttu-id="6cbe0-112">每个驱动器都是相关对象的层次结构的根节点。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-112">Each drive is the root node of a hierarchy of related objects.</span></span> <span data-ttu-id="6cbe0-113">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序实现一个 SQLSERVER: 驱动器。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-113">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider implements a SQLSERVER: drive.</span></span> <span data-ttu-id="6cbe0-114">该提供程序还为 SQLSERVER: 驱动器定义了一组主文件夹。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-114">The provider also defines a set of primary folders for the SQLSERVER: drive.</span></span> <span data-ttu-id="6cbe0-115">每个文件夹及其子文件夹表示一组可通过使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 管理对象模型访问的对象。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-115">Each folder and its subfolders represent the set of objects that can be accessed by using a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model.</span></span> <span data-ttu-id="6cbe0-116">当关注某个以这些主文件夹之一开始的路径中的子文件夹时，可以使用相关对象模型中的方法对该节点所表示的对象执行操作。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-116">When you are focused on a subfolder in a path that starts with one of these primary folders, you can use the methods from the associated object model to perform actions on the object that is represented by the node.</span></span> <span data-ttu-id="6cbe0-117">下表列出了由 [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] 提供程序实现的 Windows PowerShell 文件夹。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-117">The Windows PowerShell folders implemented by the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] provider are listed in the following table.</span></span>  
  
|<span data-ttu-id="6cbe0-118">Folder</span><span class="sxs-lookup"><span data-stu-id="6cbe0-118">Folder</span></span>|<span data-ttu-id="6cbe0-119">SQL Server 对象模型命名空间</span><span class="sxs-lookup"><span data-stu-id="6cbe0-119">SQL Server object model namespace</span></span>|<span data-ttu-id="6cbe0-120">对象</span><span class="sxs-lookup"><span data-stu-id="6cbe0-120">Objects</span></span>|  
|------------|---------------------------------------|-------------|  
|<span data-ttu-id="6cbe0-121">SQLSERVER:\SQL</span><span class="sxs-lookup"><span data-stu-id="6cbe0-121">SQLSERVER:\SQL</span></span>|<xref:Microsoft.SqlServer.Management.Smo><br /><br /> <xref:Microsoft.SqlServer.Management.Smo.Agent><br /><br /> <xref:Microsoft.SqlServer.Management.Smo.Broker><br /><br /> <xref:Microsoft.SqlServer.Management.Smo.Mail>|<span data-ttu-id="6cbe0-122">数据库对象，如表、视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-122">Database objects, such as tables, views, and stored procedures.</span></span>|  
|<span data-ttu-id="6cbe0-123">SQLSERVER:\SQLPolicy</span><span class="sxs-lookup"><span data-stu-id="6cbe0-123">SQLSERVER:\SQLPolicy</span></span>|<xref:Microsoft.SqlServer.Management.Dmf><br /><br /> <xref:Microsoft.SqlServer.Management.Facets>|<span data-ttu-id="6cbe0-124">基于策略的管理对象，如策略和方面。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-124">Policy-based management objects, such as policies and facets.</span></span>|  
|<span data-ttu-id="6cbe0-125">SQLSERVER:\SQLRegistration</span><span class="sxs-lookup"><span data-stu-id="6cbe0-125">SQLSERVER:\SQLRegistration</span></span>|<xref:Microsoft.SqlServer.Management.RegisteredServers><br /><br /> <xref:Microsoft.SqlServer.Management.Smo.RegSvrEnum>|<span data-ttu-id="6cbe0-126">已注册的服务器对象，如服务器组和已注册服务器。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-126">Registered server objects, such as server groups and registered servers.</span></span>|  
|<span data-ttu-id="6cbe0-127">SQLSERVER:\Utility</span><span class="sxs-lookup"><span data-stu-id="6cbe0-127">SQLSERVER:\Utility</span></span>|<xref:Microsoft.SqlServer.Management.Utility>|<span data-ttu-id="6cbe0-128">实用工具对象，例如， [!INCLUDE[ssDE](../includes/ssde-md.md)]的托管实例</span><span class="sxs-lookup"><span data-stu-id="6cbe0-128">Utility objects, such as managed instances of the [!INCLUDE[ssDE](../includes/ssde-md.md)].</span></span>|  
|<span data-ttu-id="6cbe0-129">SQLSERVER:\DAC</span><span class="sxs-lookup"><span data-stu-id="6cbe0-129">SQLSERVER:\DAC</span></span>|[<span data-ttu-id="6cbe0-130">Microsoft SqlServer. DAC</span><span class="sxs-lookup"><span data-stu-id="6cbe0-130">Microsoft.SqlServer.Management.DAC</span></span>](/dotnet/api/microsoft.sqlserver.management.utility.deployeddac)|<span data-ttu-id="6cbe0-131">数据层应用程序对象（如 DAC 包）和操作（如部署 DAC）。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-131">Data-tier application objects such as DAC packages, and operations such as deploying a DAC.</span></span>|  
|<span data-ttu-id="6cbe0-132">SQLSERVER:\DataCollection</span><span class="sxs-lookup"><span data-stu-id="6cbe0-132">SQLSERVER:\DataCollection</span></span>|<xref:Microsoft.SqlServer.Management.Collector>|<span data-ttu-id="6cbe0-133">数据收集器对象，如收集组和配置存储区。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-133">Data collector objects, such as collection sets and configuration stores.</span></span>|  
|<span data-ttu-id="6cbe0-134">SQLSERVER:\IntegrationServices</span><span class="sxs-lookup"><span data-stu-id="6cbe0-134">SQLSERVER:\IntegrationServices</span></span>|<xref:Microsoft.SqlServer.Management.IntegrationServices>|[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="6cbe0-135">对象，如项目、包和环境。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-135">objects such as projects, packages, and environments.</span></span>|  
|<span data-ttu-id="6cbe0-136">SQLSERVER:\SQLAS</span><span class="sxs-lookup"><span data-stu-id="6cbe0-136">SQLSERVER:\SQLAS</span></span>|<xref:Microsoft.AnalysisServices>|[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] <span data-ttu-id="6cbe0-137">对象，例如多维数据集、聚合和维度。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-137">objects such as cubes, aggregations, and dimensions.</span></span>|  
  
 <span data-ttu-id="6cbe0-138">例如，可以使用 SQLSERVER:\SQL 文件夹作为路径的开头，该路径可以表示 SMO 对象模型支持的任何对象。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-138">For example, you can use the SQLSERVER:\SQL folder to start paths that can represent any object that is supported by the SMO object model.</span></span> <span data-ttu-id="6cbe0-139">Sqlserver： \ sql 路径的主要部分是 sqlserver： \ sql \\ *ComputerName* \\ *InstanceName*。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-139">The leading part of a SQLSERVER:\SQL path is SQLSERVER:\SQL\\*ComputerName*\\*InstanceName*.</span></span> <span data-ttu-id="6cbe0-140">实例名称后面的节点在对象集合（如 *数据库* 或 *视图*）和对象名称（如 AdventureWorks2012）之间交替变化。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-140">The nodes after the instance name alternate between object collections (such as *Databases* or *Views*) and object names (such as AdventureWorks2012).</span></span> <span data-ttu-id="6cbe0-141">架构不用对象类表示。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-141">Schemas are not represented as object classes.</span></span> <span data-ttu-id="6cbe0-142">在为架构中的顶层对象（如表或视图）指定节点时，必须以 *SchemaName.ObjectName*格式指定对象名称。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-142">When you specify the node for a top-level object in a schema, such as a table or view, you must specify the object name in the format *SchemaName.ObjectName*.</span></span>  
  
 <span data-ttu-id="6cbe0-143">这是 AdventureWorks2012 数据库的 Purchasing 架构中的 Vendor 表的路径，该数据库位于本地计算机上的 [!INCLUDE[ssDE](../includes/ssde-md.md)] 默认实例中：</span><span class="sxs-lookup"><span data-stu-id="6cbe0-143">This is the path of the Vendor table in the Purchasing schema of the AdventureWorks2012 database in a default instance of the [!INCLUDE[ssDE](../includes/ssde-md.md)] on the local computer:</span></span>  
  
```  
SQLSERVER:\SQL\localhost\DEFAULT\Databases\AdventureWorks2012\Tables\Purchasing.Vendor  
```  
  
 <span data-ttu-id="6cbe0-144">有关 SMO 对象模型层次结构的详细信息，请参阅 [SMO Object Model Diagram](../relational-databases/server-management-objects-smo/smo-object-model-diagram.md)。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-144">For more information about the SMO object model hierarchy, see [SMO Object Model Diagram](../relational-databases/server-management-objects-smo/smo-object-model-diagram.md).</span></span>  
  
 <span data-ttu-id="6cbe0-145">路径中的集合节点与相关对象模型中的集合类相关联。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-145">Collection nodes in a path are associated with a collection class in the associated object model.</span></span> <span data-ttu-id="6cbe0-146">对象名节点与相关对象模型中的对象类相关联，如下表中所示。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-146">Object name nodes are associated with an object class in the associated object model, as in the following table.</span></span>  
  
|<span data-ttu-id="6cbe0-147">路径</span><span class="sxs-lookup"><span data-stu-id="6cbe0-147">Path</span></span>|<span data-ttu-id="6cbe0-148">SMO 类</span><span class="sxs-lookup"><span data-stu-id="6cbe0-148">SMO class</span></span>|  
|----------|---------------|  
|<span data-ttu-id="6cbe0-149">SQLSERVER:\SQL\MyComputer\DEFAULT\Databases</span><span class="sxs-lookup"><span data-stu-id="6cbe0-149">SQLSERVER:\SQL\MyComputer\DEFAULT\Databases</span></span>|<xref:Microsoft.SqlServer.Management.Smo.DatabaseCollection>|  
|<span data-ttu-id="6cbe0-150">SQLSERVER:\SQL\MyComputer\DEFAULT\Databases\AdventureWorks2012</span><span class="sxs-lookup"><span data-stu-id="6cbe0-150">SQLSERVER:\SQL\MyComputer\DEFAULT\Databases\AdventureWorks2012</span></span>|<xref:Microsoft.SqlServer.Management.Smo.Database>|  
  
## <a name="sql-server-provider-tasks"></a><span data-ttu-id="6cbe0-151">SQL Server 提供程序任务</span><span class="sxs-lookup"><span data-stu-id="6cbe0-151">SQL Server Provider Tasks</span></span>  
  
|<span data-ttu-id="6cbe0-152">任务说明</span><span class="sxs-lookup"><span data-stu-id="6cbe0-152">Task Description</span></span>|<span data-ttu-id="6cbe0-153">主题</span><span class="sxs-lookup"><span data-stu-id="6cbe0-153">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="6cbe0-154">介绍如何使用 Windows PowerShell cmdlet 导航路径中的节点，以及如何在每个节点获取该节点上对象的列表。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-154">Describes how to use Windows PowerShell cmdlets to navigate through the nodes in a path, and at each node get a list of the objects at that node.</span></span>|[<span data-ttu-id="6cbe0-155">导航 SQL ServerPowerShell 路径</span><span class="sxs-lookup"><span data-stu-id="6cbe0-155">Navigate SQL Server PowerShell Paths</span></span>](navigate-sql-server-powershell-paths.md)|  
|<span data-ttu-id="6cbe0-156">介绍如何使用 SMO 方法和属性对路径中的节点表示的对象进行报告和执行任务。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-156">Describes how to use the SMO methods and properties to report on and perform work on the object represented by a node in a path.</span></span> <span data-ttu-id="6cbe0-157">还介绍如何获取该节点的 SMO 方法和属性的列表。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-157">Also describes how to get a list of the SMO methods and properties for that node.</span></span>|[<span data-ttu-id="6cbe0-158">使用 SQL ServerPowerShell 路径</span><span class="sxs-lookup"><span data-stu-id="6cbe0-158">Work With SQL Server PowerShell Paths</span></span>](work-with-sql-server-powershell-paths.md)|  
|<span data-ttu-id="6cbe0-159">介绍如何将 SMO 统一资源名称 (URN) 转换为 SQL Server 提供程序路径。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-159">Describes how to convert a SMO Uniform Resource Name (URN) to a SQL Server provider path.</span></span>|[<span data-ttu-id="6cbe0-160">将 URN 转换为 SQL Server 提供程序路径</span><span class="sxs-lookup"><span data-stu-id="6cbe0-160">Convert URNs to SQL Server Provider Paths</span></span>](../database-engine/convert-urns-to-sql-server-provider-paths.md)|  
|<span data-ttu-id="6cbe0-161">介绍如何使用 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 提供程序打开 SQL Server 身份验证连接。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-161">Describes how to open SQL Server Authentication connections by using the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider.</span></span> <span data-ttu-id="6cbe0-162">默认情况下，提供程序使用通过运行 Windows PowerShell 会话的 Windows 帐户的凭据生成的 Windows 身份验证连接。</span><span class="sxs-lookup"><span data-stu-id="6cbe0-162">By default, the provider uses Windows Authentication connections made using the credentials of the Windows account running the Windows PowerShell session.</span></span>|[<span data-ttu-id="6cbe0-163">在数据库引擎 PowerShell 中管理身份验证</span><span class="sxs-lookup"><span data-stu-id="6cbe0-163">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
  
## <a name="see-also"></a><span data-ttu-id="6cbe0-164">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6cbe0-164">See Also</span></span>  
 [<span data-ttu-id="6cbe0-165">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cbe0-165">SQL Server PowerShell</span></span>](sql-server-powershell.md)  
  
  
