---
title: 语法 (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- expressions [Integration Services], syntax
- syntax [Integration Services]
ms.assetid: 61c053c5-1182-4ad0-b804-51cbd19aa0ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d7be12ee5e0467e3789fbe2771d881d9ae3f25f3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689962"
---
# <a name="syntax-ssis"></a><span data-ttu-id="e2cd3-102">语法 (SSIS)</span><span class="sxs-lookup"><span data-stu-id="e2cd3-102">Syntax (SSIS)</span></span>
  <span data-ttu-id="e2cd3-103">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 表达式语法与 C 和 C# 语言使用的语法类似。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-103">The [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] expression syntax is similar to the syntax that the C and C# languages use.</span></span> <span data-ttu-id="e2cd3-104">表达式可包括多种元素，例如标识符（列和变量）、文字、运算符和函数。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-104">Expressions include elements such as identifiers (columns and variables), literals, operators, and functions.</span></span> <span data-ttu-id="e2cd3-105">本主题概述了表达式计算器语法在应用于不同的表达式元素时的特殊要求。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-105">This topic summarizes the unique requirements of the expression evaluator syntax as they apply to different expression elements.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e2cd3-106">在以前版本的 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]中，如果某表达式的计算结果具有 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 数据类型 DT_WSTR 或 DT_STR，则结果将具有 4000 个字符的限制。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-106">In previous releases of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], there was a 4000-character limit on the evaluation result of an expression when the result had the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] data type DT_WSTR or DT_STR.</span></span> <span data-ttu-id="e2cd3-107">这一限制已被取消。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-107">This limit has been removed.</span></span>  
  
 <span data-ttu-id="e2cd3-108">有关使用特定运算符和函数的示例表达式，请参阅以下主题中关于每个运算符和函数的主题：[运算符（SSIS 表达式）](operators-ssis-expression.md)和[函数（SSIS 表达式）](functions-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-108">For sample expressions that use specific operators and functions, see the topic about each operator and function in the topics: [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md) and [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
 <span data-ttu-id="e2cd3-109">有关使用多个运算符和函数以及标识符和文本的示例表达式，请参阅 [高级 Integration Services 表达式的示例](examples-of-advanced-integration-services-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-109">For sample expressions that use multiple operators and functions as well as identifiers and literals, see [Examples of Advanced Integration Services Expressions](examples-of-advanced-integration-services-expressions.md).</span></span>  
  
 <span data-ttu-id="e2cd3-110">有关要在属性表达式中使用的示例表达式，请参阅 [在包中使用属性表达式](use-property-expressions-in-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-110">For sample expressions to use in property expressions, see [Use Property Expressions in Packages](use-property-expressions-in-packages.md).</span></span>  
  
## <a name="identifiers"></a><span data-ttu-id="e2cd3-111">标识符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-111">Identifiers</span></span>  
 <span data-ttu-id="e2cd3-112">表达式可包含列和变量标识符。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-112">Expressions can include column and variable identifiers.</span></span> <span data-ttu-id="e2cd3-113">列可以源自数据源或由数据流中的转换创建。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-113">The columns can originate in the data source or can be created by transformations in the data flow.</span></span> <span data-ttu-id="e2cd3-114">表达式可以使用沿袭标识符来引用列。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-114">Expressions can use lineage identifiers to refer to columns.</span></span> <span data-ttu-id="e2cd3-115">沿袭标识符是唯一地标识包元素的数字。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-115">Lineage identifiers are numbers that uniquely identify package elements.</span></span> <span data-ttu-id="e2cd3-116">表达式中引用的沿袭标识符必须包含井号 (#) 前缀。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-116">Lineage identifiers, referenced in an expression, must include the pound (#) prefix.</span></span> <span data-ttu-id="e2cd3-117">例如，使用 #138 引用沿袭标识符 138。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-117">For example, the lineage identifier 138 is referenced using #138.</span></span>  
  
 <span data-ttu-id="e2cd3-118">表达式可包含 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 提供的系统变量和自定义变量。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-118">Expressions can include the system variables that [!INCLUDE[ssIS](../../includes/ssis-md.md)] provides and custom variables.</span></span> <span data-ttu-id="e2cd3-119">表达式中引用的变量必须包含 \@ 前缀。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-119">Variables, when referenced in an expression, must include the \@ prefix.</span></span> <span data-ttu-id="e2cd3-120">例如，使用 \@Counter 引用 `Counter` 变量。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-120">For example, the `Counter` variable is referenced using \@Counter.</span></span> <span data-ttu-id="e2cd3-121">\@ 字符不属于变量名，仅向表达式计算器指明标识符是变量。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-121">The \@ character is not part of the variable name; it only indicates to the expression evaluator that the identifier is a variable.</span></span> <span data-ttu-id="e2cd3-122">有关详细信息，请参阅[标识符 (SSIS)](identifiers-ssis.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-122">For more information, see [Identifiers &#40;SSIS&#41;](identifiers-ssis.md).</span></span>  
  
## <a name="literals"></a><span data-ttu-id="e2cd3-123">文字</span><span class="sxs-lookup"><span data-stu-id="e2cd3-123">Literals</span></span>  
 <span data-ttu-id="e2cd3-124">表达式可以包含数值、字符串和布尔文字。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-124">Expressions can include numeric, string, and Boolean literals.</span></span> <span data-ttu-id="e2cd3-125">表达式中使用的字符串文字必须用引号引起来。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-125">String literals used in expressions must be enclosed in quotation marks.</span></span> <span data-ttu-id="e2cd3-126">数值和布尔文字不使用引号。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-126">Numeric and Boolean literals do not take quotation marks.</span></span> <span data-ttu-id="e2cd3-127">表达式语言包含用于常用转义字符的转义序列。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-127">The expression language includes escape sequences for characters that are frequently escaped.</span></span> <span data-ttu-id="e2cd3-128">有关详细信息，请参阅[文字 (SSIS)](numeric-string-and-boolean-literals.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-128">For more information, see [Literals &#40;SSIS&#41;](numeric-string-and-boolean-literals.md).</span></span>  
  
## <a name="operators"></a><span data-ttu-id="e2cd3-129">运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-129">Operators</span></span>  
 <span data-ttu-id="e2cd3-130">表达式计算器提供了一组运算符，这些运算符可提供与 Transact-SQL、C++ 和 C# 等语言中的运算符集类似的功能。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-130">The expression evaluator provides a set of operators that provides functionality similar to the set of operators in languages such as Transact-SQL, C++, and C#.</span></span> <span data-ttu-id="e2cd3-131">但是，表达式语言还包含其他运算符，并使用您可能不熟悉的其他符号。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-131">However, the expression language includes additional operators and uses different symbols than those you may be familiar with.</span></span> <span data-ttu-id="e2cd3-132">有关详细信息，请参阅[运算符（SSIS 表达式）](operators-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-132">For more information, see [Operators &#40;SSIS Expression&#41;](operators-ssis-expression.md).</span></span>  
  
### <a name="namespace-resolution-operator"></a><span data-ttu-id="e2cd3-133">命名空间解析运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-133">Namespace Resolution Operator</span></span>  
 <span data-ttu-id="e2cd3-134">表达式使用命名空间解析运算符 (::) 来消除同名变量的歧义。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-134">Expressions use the namespace resolution operator (::) to disambiguate variables that have the same name.</span></span> <span data-ttu-id="e2cd3-135">通过使用命名空间解析运算符，您可以用变量的命名空间来限定变量，从而可以在一个包中使用多个同名变量。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-135">By using the namespace resolution operator, you can qualify the variable with its namespace, which makes it possible to use multiple variables with the same name in a package.</span></span>  
  
#### <a name="cast-operator"></a><span data-ttu-id="e2cd3-136">转换运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-136">Cast Operator</span></span>  
 <span data-ttu-id="e2cd3-137">转换运算符将表达式结果、列值、变量值和常量从一种数据类型转换为另一种数据类型。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-137">The cast operator converts expression results, column values, variable values, and constants from one data type to another.</span></span> <span data-ttu-id="e2cd3-138">表达式语言提供的转换运算符与 C 和 C# 语言提供的运算符类似。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-138">The cast operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="e2cd3-139">在 Transact-SQL 中，CAST 和 CONVERT 函数提供了此功能。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-139">In Transact-SQL, the CAST and CONVERT functions provide this functionality.</span></span> <span data-ttu-id="e2cd3-140">转换运算符语法与 CAST 和 CONVERT 使用的语法在下列方面存在差别：</span><span class="sxs-lookup"><span data-stu-id="e2cd3-140">The syntax of the cast operator is different from ones used by CAST and CONVERT in the following ways:</span></span>  
  
-   <span data-ttu-id="e2cd3-141">可将表达式用作参数。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-141">It can use an expression as an argument.</span></span>  
  
-   <span data-ttu-id="e2cd3-142">其语法不包含 CAST 关键字。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-142">Its syntax does not include the CAST keyword.</span></span>  
  
-   <span data-ttu-id="e2cd3-143">其语法不包含 AS 关键字。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-143">Its syntax does not include the AS keyword.</span></span>  
  
##### <a name="conditional-operator"></a><span data-ttu-id="e2cd3-144">条件运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-144">Conditional Operator</span></span>  
 <span data-ttu-id="e2cd3-145">条件运算符基于布尔表达式的值返回两个表达式之一。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-145">The conditional operator returns one of two expressions, based on the evaluation of a Boolean expression.</span></span> <span data-ttu-id="e2cd3-146">表达式语言提供的条件运算符与 C 和 C# 语言提供的运算符类似。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-146">The conditional operator provided by the expression language is similar to the one provided by the C and C# languages.</span></span> <span data-ttu-id="e2cd3-147">在多维表达式 (MDX) 中，IIF 函数提供类似的功能。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-147">In multidimensional expressions (MDX), the IIF function provides similar functionality.</span></span>  
  
###### <a name="logical-operators"></a><span data-ttu-id="e2cd3-148">逻辑运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-148">Logical Operators</span></span>  
 <span data-ttu-id="e2cd3-149">表达式语言支持逻辑非运算符的 !</span><span class="sxs-lookup"><span data-stu-id="e2cd3-149">The expression language supports the !</span></span> <span data-ttu-id="e2cd3-150">字符。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-150">character for the logical NOT operator.</span></span> <span data-ttu-id="e2cd3-151">在 Transact-SQL 中，! 运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-151">In Transact-SQL, the !</span></span> <span data-ttu-id="e2cd3-152">内置于关系运算符集中。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-152">operator is built into the set of relational operators.</span></span> <span data-ttu-id="e2cd3-153">例如，Transact-SQL 提供 > 和 !> 运算符。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-153">For example, Transact-SQL provides the > and the !> operators.</span></span> <span data-ttu-id="e2cd3-154">[!INCLUDE[ssIS](../../includes/ssis-md.md)] 表达式语言不支持 ! 运算符与</span><span class="sxs-lookup"><span data-stu-id="e2cd3-154">The [!INCLUDE[ssIS](../../includes/ssis-md.md)] expression language does not support the combination of the !</span></span> <span data-ttu-id="e2cd3-155">其他运算符的组合。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-155">operator and other operators.</span></span> <span data-ttu-id="e2cd3-156">例如，将 ! 和 > 组合为 !> 是</span><span class="sxs-lookup"><span data-stu-id="e2cd3-156">For example, it is not valid to combine !</span></span> <span data-ttu-id="e2cd3-157">无效的。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-157">and > into !>.</span></span> <span data-ttu-id="e2cd3-158">但是，表达式语言支持用于“不等于”比较的内置 != 字符组合。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-158">However, the expression language does support a built-in != combination of characters for the not-equal-to comparison.</span></span>  
  
###### <a name="equality-operators"></a><span data-ttu-id="e2cd3-159">相等运算符</span><span class="sxs-lookup"><span data-stu-id="e2cd3-159">Equality Operators</span></span>  
 <span data-ttu-id="e2cd3-160">表达式计算器语法提供 == 相等运算符。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-160">The expression evaluator grammar provides the == equality operator.</span></span> <span data-ttu-id="e2cd3-161">此运算符等价于 Transact-SQL 中的 = 运算符和 C# 中的 == 运算符。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-161">This operator is the equivalent of the = operator in Transact-SQL and the == operator in C#.</span></span>  
  
## <a name="functions"></a><span data-ttu-id="e2cd3-162">函数</span><span class="sxs-lookup"><span data-stu-id="e2cd3-162">Functions</span></span>  
 <span data-ttu-id="e2cd3-163">表达式语言包含类似于 Transact-SQL 函数和 C# 方法的日期和时间函数、数学函数及字符串函数。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-163">The expression language includes date and time functions, mathematical functions, and string functions that are similar to Transact-SQL functions and C# methods.</span></span>  
  
 <span data-ttu-id="e2cd3-164">一些函数具有与 Transact-SQL 函数相同的名称，但在表达式计算器中，功能稍有不同。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-164">A few functions have the same names as Transact-SQL functions, but have subtly different functionality in the expression evaluator.</span></span>  
  
-   <span data-ttu-id="e2cd3-165">在 Transact-SQL 中，ISNULL 函数将 Null 值替换为指定值，而表达式计算器的 ISNULL 函数则根据表达式是否为 Null 返回布尔值。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-165">In Transact-SQL, the ISNULL function replaces null values with a specified value, whereas the expression evaluator ISNULL function returns a Boolean based on whether an expression is null.</span></span>  
  
-   <span data-ttu-id="e2cd3-166">在 Transact-SQL 中，ROUND 函数提供截断结果集的选项，而表达式计算器的 ROUND 函数则不提供。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-166">In Transact-SQL, the ROUND function includes an option to truncate the result set, whereas the expression evaluator ROUND function does not.</span></span>  
  
 <span data-ttu-id="e2cd3-167">有关详细信息，请参阅[函数（SSIS 表达式）](functions-ssis-expression.md)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-167">For more information, see [Functions &#40;SSIS Expression&#41;](functions-ssis-expression.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="e2cd3-168">Related Tasks</span><span class="sxs-lookup"><span data-stu-id="e2cd3-168">Related Tasks</span></span>  
 [<span data-ttu-id="e2cd3-169">在数据流组件中使用表达式</span><span class="sxs-lookup"><span data-stu-id="e2cd3-169">Use an Expression in a Data Flow Component</span></span>](../use-an-expression-in-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="e2cd3-170">相关内容</span><span class="sxs-lookup"><span data-stu-id="e2cd3-170">Related Content</span></span>  
  
-   <span data-ttu-id="e2cd3-171">pragmaticworks.com 上的技术文章 [SSIS 表达式小抄表](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet)。</span><span class="sxs-lookup"><span data-stu-id="e2cd3-171">Technical article, [SSIS Expression Cheat Sheet](https://pragmaticworks.com/Resources/Cheat-Sheets/SSIS-Expression-Cheat-Sheet), on pragmaticworks.com</span></span>  
  
-   <span data-ttu-id="e2cd3-172">social.technet.microsoft.com 上的技术文章 [SSIS 表达式示例](https://go.microsoft.com/fwlink/?LinkId=220761)</span><span class="sxs-lookup"><span data-stu-id="e2cd3-172">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>  
  
  
