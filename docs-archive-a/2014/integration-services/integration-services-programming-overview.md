---
title: Integration Services 编程概述 | Microsoft Docs
ms.custom: ''
ms.date: 11/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Integration Services, programming
- architecture [Integration Services]
- assemblies [Integration Services]
- SSIS, programming
- SQL Server Integration Services, programming
- run-time engine [Integration Services]
- packages [Integration Services], programming
- data flow engine [Integration Services]
- languages [Integration Services]
ms.assetid: 262babc6-eea5-4609-bc65-07d64cbcfee9
author: chugugrace
ms.author: chugu
ms.openlocfilehash: d9dc548b2987f068f579f053a6b2d205186b416e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586872"
---
# <a name="integration-services-programming-overview"></a><span data-ttu-id="48ef6-102">Integration Services 编程概述</span><span class="sxs-lookup"><span data-stu-id="48ef6-102">Integration Services Programming Overview</span></span>
  [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="48ef6-103">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 具有将数据移动和转换与包控制流和管理分开的体系结构。</span><span class="sxs-lookup"><span data-stu-id="48ef6-103">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] has an architecture that separates data movement and transformation from package control flow and management.</span></span> <span data-ttu-id="48ef6-104">有两个截然不同的引擎定义此体系结构，对 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 进行编程可以扩展这两个引擎并使其自动化。</span><span class="sxs-lookup"><span data-stu-id="48ef6-104">There are two distinct engines that define this architecture and that can be automated and extended when programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="48ef6-105">运行时引擎实现控制流和包管理基础结构，该基础结构使开发人员能够控制执行流并为日志记录、事件处理程序和变量设置选项。</span><span class="sxs-lookup"><span data-stu-id="48ef6-105">The run-time engine implements the control flow and package management infrastructure that lets developers control the flow of execution and set options for logging, event handlers, and variables.</span></span> <span data-ttu-id="48ef6-106">数据流引擎是一个专用高性能引擎，专用于提取、转换和加载数据。</span><span class="sxs-lookup"><span data-stu-id="48ef6-106">The data flow engine is a specialized, high performance engine that is exclusively dedicated to extracting, transforming, and loading data.</span></span> <span data-ttu-id="48ef6-107">对 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 进行编程时，将针对这两个引擎进行编程。</span><span class="sxs-lookup"><span data-stu-id="48ef6-107">When programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], you will be programming against these two engines.</span></span>  
  
 <span data-ttu-id="48ef6-108">下图描绘了 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 的体系结构。</span><span class="sxs-lookup"><span data-stu-id="48ef6-108">The following image depicts the architecture of [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="48ef6-109">![集成服务体系结构](media/mw-dts-01.gif "集成服务体系结构")</span><span class="sxs-lookup"><span data-stu-id="48ef6-109">![Integration Services architecture](media/mw-dts-01.gif "Integration Services architecture")</span></span>  
  
## <a name="integration-services-run-time-engine"></a><span data-ttu-id="48ef6-110">Integration Services 运行时引擎</span><span class="sxs-lookup"><span data-stu-id="48ef6-110">Integration Services Run-time Engine</span></span>  
 <span data-ttu-id="48ef6-111">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 运行时引擎通过实现启用执行顺序、日志记录、变量和事件处理的基础结构来控制包的管理和执行。</span><span class="sxs-lookup"><span data-stu-id="48ef6-111">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] run-time engine controls the management and execution of packages, by implementing the infrastructure that enables execution order, logging, variables, and event handling.</span></span> <span data-ttu-id="48ef6-112">开发人员对 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 运行时引擎进行编程可自动化包的创建、配置和执行操作，并可创建自定义任务和其他扩展插件。</span><span class="sxs-lookup"><span data-stu-id="48ef6-112">Programming the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] run-time engine lets developers automate the creation, configuration, and execution of packages and create custom tasks and other extensions.</span></span>  
  
 <span data-ttu-id="48ef6-113">有关详细信息，请参阅[使用脚本任务扩展包](extending-packages-scripting/task/extending-the-package-with-the-script-task.md)、[开发自定义任务](extending-packages-custom-objects/task/developing-a-custom-task.md)和[以编程方式生成包](building-packages-programmatically/building-packages-programmatically.md)。</span><span class="sxs-lookup"><span data-stu-id="48ef6-113">For more information, see [Extending the Package with the Script Task](extending-packages-scripting/task/extending-the-package-with-the-script-task.md), [Developing a Custom Task](extending-packages-custom-objects/task/developing-a-custom-task.md), and [Building Packages Programmatically](building-packages-programmatically/building-packages-programmatically.md).</span></span>  
  
## <a name="integration-services-data-flow-engine"></a><span data-ttu-id="48ef6-114">Integration Services 数据流引擎</span><span class="sxs-lookup"><span data-stu-id="48ef6-114">Integration Services Data Flow Engine</span></span>  
 <span data-ttu-id="48ef6-115">数据流引擎管理数据流任务，是一个专门用于从不同源移动和转换数据的专用高性能任务。</span><span class="sxs-lookup"><span data-stu-id="48ef6-115">The data flow engine manages the data flow task, which is a specialized, high performance task dedicated to moving and transforming data from disparate sources.</span></span> <span data-ttu-id="48ef6-116">不像其他任务，数据流任务包含称为数据流组件的其他对象，可以是源、转换或目标。</span><span class="sxs-lookup"><span data-stu-id="48ef6-116">Unlike other tasks, the data flow task contains additional objects called data flow components, which can be sources, transformations, or destinations.</span></span> <span data-ttu-id="48ef6-117">这些组件是移动任务组成部分的核心。</span><span class="sxs-lookup"><span data-stu-id="48ef6-117">These components are the core moving parts of the task.</span></span> <span data-ttu-id="48ef6-118">它们定义数据的移动和转换。</span><span class="sxs-lookup"><span data-stu-id="48ef6-118">They define the movement and transformation of data.</span></span> <span data-ttu-id="48ef6-119">开发人员对数据流引擎进行编程可自动化数据流任务中组件的创建和配置，并可创建自定义组件。</span><span class="sxs-lookup"><span data-stu-id="48ef6-119">Programming the data flow engine lets developers automate the creation and configuration of the components in a data flow task, and create custom components.</span></span>  
  
 <span data-ttu-id="48ef6-120">有关详细[信息，请](extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md)参阅 [使用脚本组件扩展数据流] (扩展包-脚本编写/数据流-脚本组件/扩展-数据流---------------------------- [Building Packages Programmatically](building-packages-programmatically/building-packages-programmatically.md)---------------------</span><span class="sxs-lookup"><span data-stu-id="48ef6-120">For more information, see [Extending the Data Flow with the Script Component](extending-packages-scripting/data-flow-script-component/extending-the-data-flow-with-the-script-component.md, [Developing a Custom Data Flow Component](extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md), and [Building Packages Programmatically](building-packages-programmatically/building-packages-programmatically.md).</span></span>  
  
## <a name="supported-languages"></a><span data-ttu-id="48ef6-121">支持的语言</span><span class="sxs-lookup"><span data-stu-id="48ef6-121">Supported Languages</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="48ef6-122">完全支持 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="48ef6-122">fully supports the [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="48ef6-123">这使开发人员可以自主选择符合 .NET 的语言来对 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 进行编程。</span><span class="sxs-lookup"><span data-stu-id="48ef6-123">This lets developers program [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] in their choice of .NET-compliant languages.</span></span> <span data-ttu-id="48ef6-124">尽管运行时引擎和数据流引擎都是用本机代码编写的，但是都可以通过完全托管对象模型来使用。</span><span class="sxs-lookup"><span data-stu-id="48ef6-124">Although both the run-time engine and the data flow engine are written in native code, they are both available through a fully managed object model.</span></span>  
  
 <span data-ttu-id="48ef6-125">可以用 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] [!INCLUDE[msCoName](../includes/msconame-md.md)] 或者另一种代码或文本编辑器对 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 包、自定义任务和组件进行编程。</span><span class="sxs-lookup"><span data-stu-id="48ef6-125">You can program [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages, custom tasks, and components in [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] or in another code or text editor.</span></span> [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] <span data-ttu-id="48ef6-126">为开发人员提供了许多工具和功能以简化和加速编码、调试和测试的迭代周期。</span><span class="sxs-lookup"><span data-stu-id="48ef6-126">offers the developer many tools and features to simplify and accelerate the iterative cycles of coding, debugging, and testing.</span></span> [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] <span data-ttu-id="48ef6-127">还使部署更加容易。</span><span class="sxs-lookup"><span data-stu-id="48ef6-127">also makes deployment easier.</span></span> <span data-ttu-id="48ef6-128">但是，您不需要 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 编译和生成 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 代码项目。</span><span class="sxs-lookup"><span data-stu-id="48ef6-128">However, you do not need [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] to compile and build [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] code projects.</span></span> <span data-ttu-id="48ef6-129">[!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK 包括 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 和 [!INCLUDE[csprcs](../includes/csprcs-md.md)] 编译器和相关工具。</span><span class="sxs-lookup"><span data-stu-id="48ef6-129">The [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK includes the [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] and [!INCLUDE[csprcs](../includes/csprcs-md.md)] compilers and related tools.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="48ef6-130">默认情况下，[!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] 与 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 一起安装，但不安装 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK。</span><span class="sxs-lookup"><span data-stu-id="48ef6-130">By default, the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] is installed with [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], but the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK is not.</span></span> <span data-ttu-id="48ef6-131">除非 SDK 已安装在计算机上，并且 SDK 文档包含在联机丛书集中，否则本部分中指向 SDK 内容的链接将无效。</span><span class="sxs-lookup"><span data-stu-id="48ef6-131">Unless the SDK is installed on the computer and the SDK documentation is included in the Books Online collection, links to SDK content in this section will not work.</span></span> <span data-ttu-id="48ef6-132">安装 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK 后，可以按照[添加或删除 SQL Server 的产品文档](../index.yml)中的说明将 SDK 文档添加到联机丛书集和目录中。</span><span class="sxs-lookup"><span data-stu-id="48ef6-132">After you have installed the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] SDK, you can add the SDK documentation to the Books Online collection and table of contents by following the instructions in [Add or Remove Product Documentation for SQL Server](../index.yml).</span></span>  
  
 <span data-ttu-id="48ef6-133">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 脚本任务和脚本组件将 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] Tools for Applications (VSTA) 用作嵌入式脚本环境。</span><span class="sxs-lookup"><span data-stu-id="48ef6-133">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] Script task and Script component use [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] Tools for Applications (VSTA) as an embedded scripting environment.</span></span> <span data-ttu-id="48ef6-134">VSTA 支持 [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual Basic 和 [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual C#。</span><span class="sxs-lookup"><span data-stu-id="48ef6-134">VSTA supports [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../includes/msconame-md.md)] Visual C#.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="48ef6-135">[!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 应用程序编程接口与基于 COM 的脚本语言（如 VBScript）不兼容。</span><span class="sxs-lookup"><span data-stu-id="48ef6-135">The [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] application programming interfaces are incompatible with COM-based scripting languages such as VBScript.</span></span>  
  
## <a name="locating-assemblies"></a><span data-ttu-id="48ef6-136">定位程序集</span><span class="sxs-lookup"><span data-stu-id="48ef6-136">Locating Assemblies</span></span>  
 <span data-ttu-id="48ef6-137">在 [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)]中， [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 程序集已升级到 .NET 4.0。</span><span class="sxs-lookup"><span data-stu-id="48ef6-137">In [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="48ef6-138">位于 \<drive>:\Windows\Microsoft.NET\assembly 中的 .NET 4 存在单独的全局程序集缓存。</span><span class="sxs-lookup"><span data-stu-id="48ef6-138">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="48ef6-139">您可在此路径下找到所有 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 程序集，一般位于 GAC_MSIL 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="48ef6-139">You can find all of the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="48ef6-140">与之前版本的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 一样，核心 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 扩展性 .dll 文件也位于 \<drive>:\Program Files\Microsoft SQL Server\100\SDK\Assemblies 中。</span><span class="sxs-lookup"><span data-stu-id="48ef6-140">As in previous versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="commonly-used-assemblies"></a><span data-ttu-id="48ef6-141">常用程序集</span><span class="sxs-lookup"><span data-stu-id="48ef6-141">Commonly Used Assemblies</span></span>  
 <span data-ttu-id="48ef6-142">下表列出了使用 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 对 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] 进行编程时常用的程序集。</span><span class="sxs-lookup"><span data-stu-id="48ef6-142">The following table lists the assemblies that are frequently used when programming [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] using the [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)].</span></span>  
  
|<span data-ttu-id="48ef6-143">Assembly</span><span class="sxs-lookup"><span data-stu-id="48ef6-143">Assembly</span></span>|<span data-ttu-id="48ef6-144">说明</span><span class="sxs-lookup"><span data-stu-id="48ef6-144">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="48ef6-145">Microsoft.SqlServer.ManagedDTS.dll</span><span class="sxs-lookup"><span data-stu-id="48ef6-145">Microsoft.SqlServer.ManagedDTS.dll</span></span>|<span data-ttu-id="48ef6-146">包含托管运行时引擎。</span><span class="sxs-lookup"><span data-stu-id="48ef6-146">Contains the managed run-time engine.</span></span>|  
|<span data-ttu-id="48ef6-147">Microsoft.SqlServer.RuntimeWrapper.dll</span><span class="sxs-lookup"><span data-stu-id="48ef6-147">Microsoft.SqlServer.RuntimeWrapper.dll</span></span>|<span data-ttu-id="48ef6-148">包含用于本机运行时引擎的主互操作程序集 (PIA) 或包装。</span><span class="sxs-lookup"><span data-stu-id="48ef6-148">Contains the primary interop assembly (PIA), or wrapper, for the native run-time engine.</span></span>|  
|<span data-ttu-id="48ef6-149">Microsoft.SqlServer.PipelineHost.dll</span><span class="sxs-lookup"><span data-stu-id="48ef6-149">Microsoft.SqlServer.PipelineHost.dll</span></span>|<span data-ttu-id="48ef6-150">包含托管数据流引擎。</span><span class="sxs-lookup"><span data-stu-id="48ef6-150">Contains the managed data flow engine.</span></span>|  
|<span data-ttu-id="48ef6-151">Microsoft.SqlServer.PipelineWrapper.dll</span><span class="sxs-lookup"><span data-stu-id="48ef6-151">Microsoft.SqlServer.PipelineWrapper.dll</span></span>|<span data-ttu-id="48ef6-152">包含用于本机数据流引擎的主互操作程序集 (PIA) 或包装。</span><span class="sxs-lookup"><span data-stu-id="48ef6-152">Contains the primary interop assembly (PIA), or wrapper, for the native data flow engine.</span></span>|  

<span data-ttu-id="48ef6-153">![Integration Services 图标 (小型) ](media/dts-16.gif "集成服务图标（小）")  **随时保持最新 Integration Services**</span><span class="sxs-lookup"><span data-stu-id="48ef6-153">![Integration Services icon (small)](media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="48ef6-154">若要从 Microsoft 获得最新的下载内容、文章、示例和视频，以及从社区获得所选解决方案，请访问 MSDN 上的 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] 页：</span><span class="sxs-lookup"><span data-stu-id="48ef6-154">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="48ef6-155">访问 MSDN 上的 Integration Services 页</span><span class="sxs-lookup"><span data-stu-id="48ef6-155">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="48ef6-156">若要获得有关这些更新的自动通知，请订阅该页上提供的 RSS 源。</span><span class="sxs-lookup"><span data-stu-id="48ef6-156">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
  
