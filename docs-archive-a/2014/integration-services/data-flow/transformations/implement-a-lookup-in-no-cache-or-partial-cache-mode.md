---
title: 在不缓存模式或部分缓存模式下实现查找 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Lookup transformation
- match exactly [Integration Services]
- lookups [Integration Services]
- exact matches [Integration Services]
ms.assetid: 01b7fbca-5181-4d47-9f75-7f25af6b40d2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5c3958450d6371299972a69f5312a3c631c853aa
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589802"
---
# <a name="implement-a-lookup-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="3a4ab-102">在不缓存模式或部分缓存模式下实现查找</span><span class="sxs-lookup"><span data-stu-id="3a4ab-102">Implement a Lookup in No Cache or Partial Cache Mode</span></span>
  <span data-ttu-id="3a4ab-103">可以将查找转换配置为使用部分缓存模式或不缓存模式：</span><span class="sxs-lookup"><span data-stu-id="3a4ab-103">You can configure the Lookup transformation to use the partial cache or no cache mode:</span></span>  
  
-   <span data-ttu-id="3a4ab-104">部分缓存</span><span class="sxs-lookup"><span data-stu-id="3a4ab-104">Partial cache</span></span>  
  
     <span data-ttu-id="3a4ab-105">将在引用数据集中有匹配项的行存储在缓存中，也可以将在数据集中没有匹配项的行存储在缓存中。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-105">The rows with matching entries in the reference dataset and, optionally, the rows without matching entries in the dataset are stored in cache.</span></span> <span data-ttu-id="3a4ab-106">超出缓存的内存大小后，查找转换会自动从缓存中删除最不常使用的行。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-106">When the memory size of the cache is exceeded, the Lookup transformation automatically removes the least frequently used rows from the cache.</span></span>  
  
-   <span data-ttu-id="3a4ab-107">不缓存</span><span class="sxs-lookup"><span data-stu-id="3a4ab-107">No cache</span></span>  
  
     <span data-ttu-id="3a4ab-108">不向缓存中加载任何数据。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-108">No data is loaded into cache.</span></span>  
  
 <span data-ttu-id="3a4ab-109">不论选择部分缓存还是不缓存，均需要使用 OLE DB 连接管理器连接到引用数据集。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-109">Whether you select partial cache or no cache, you use an OLE DB connection manager to connect to the reference dataset.</span></span> <span data-ttu-id="3a4ab-110">引用数据集是在执行查找转换过程中使用表、视图或 SQL 查询生成的。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-110">The reference dataset is generated by using a table, view, or SQL query during the execution of the Lookup transformation</span></span>  
  
### <a name="to-implement-a-lookup-transformation-in-no-cache-or-partial-cache-mode"></a><span data-ttu-id="3a4ab-111">在不缓存模式或部分缓存模式下实现查找转换</span><span class="sxs-lookup"><span data-stu-id="3a4ab-111">To implement a Lookup transformation in no cache or partial cache mode</span></span>  
  
1.  <span data-ttu-id="3a4ab-112">在 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中，打开包含所需包的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 项目，再打开该包。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-112">In [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)], open the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] project that contains the package you want, and then open the package.</span></span>  
  
2.  <span data-ttu-id="3a4ab-113">在 **“数据流”** 选项卡上，添加查找转换。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-113">On the **Data Flow** tab, add a Lookup transformation.</span></span>  
  
3.  <span data-ttu-id="3a4ab-114">将连接线从源或前一转换拖到查找转换，从而将查找转换连接到数据流。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-114">Connect the Lookup transformation to the data flow by dragging a connector from a source or a previous transformation to the Lookup transformation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3a4ab-115">如果配置为使用无缓存模式的查找转换连接到包含空白日期字段的平面文件，该转换可能无效。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-115">A Lookup transformation that is configured to use the no cache mode might not validate if that transformation connects to a flat file that contains an empty date field.</span></span> <span data-ttu-id="3a4ab-116">转换是否有效取决于平面文件的连接管理器是否配置为保留 Null 值。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-116">Whether the transformation validates depends on whether the connection manager for the flat file has been configured to retain null values.</span></span> <span data-ttu-id="3a4ab-117">若要确保查找转换有效，请在 **“连接管理器”** 页上的 **“平面文件源编辑器”** 中选择 **“在数据流中保留源中的 Null 值”** 选项。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-117">To ensure that the Lookup transformation validates, in the **Flat File Source Editor**, on the **Connection Manager Page**, select the **Retain null values from the source as null values in the data flow** option.</span></span>  
  
4.  <span data-ttu-id="3a4ab-118">双击源或前一转换以配置组件。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-118">Double-click the source or previous transformation to configure the component.</span></span>  
  
5.  <span data-ttu-id="3a4ab-119">双击查找转换，然后在“查找转换编辑器”  中的“常规”  页上，选择“部分缓存”  或“不缓存”  。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-119">Double-click the Lookup transformation, and then in the **Lookup Transformation Editor**, on the **General** page, select **Partialcache** or **No cache**.</span></span>  
  
6.  <span data-ttu-id="3a4ab-120">请从 **“指定如何处理没有匹配项的行”** 列表中选择一个错误处理选项。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-120">For **Specify how to handle rows with no matching entries** list, select an error handling option from the list.</span></span>  
  
7.  <span data-ttu-id="3a4ab-121">在 **“连接”** 页上，从 **“OLE DB 连接管理器”** 列表中选择一个连接管理器，或单击 **“新建”** 创建一个新的连接管理器。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-121">On the **Connection** page, select a connection manager from the **OLE DB connection manager** list or click **New** to create a new connection manager.</span></span> <span data-ttu-id="3a4ab-122">有关详细信息，请参阅 [OLE DB Connection Manager](../../connection-manager/ole-db-connection-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-122">For more information, see [OLE DB Connection Manager](../../connection-manager/ole-db-connection-manager.md).</span></span>  
  
8.  <span data-ttu-id="3a4ab-123">执行以下步骤中的一个：</span><span class="sxs-lookup"><span data-stu-id="3a4ab-123">Do one of the following steps:</span></span>  
  
    -   <span data-ttu-id="3a4ab-124">单击 **“使用表或视图”** ，然后选择一个表或视图，或单击 **“新建”** 创建表或视图。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-124">Click **Use a table or a view**, and then either select a table or view, or click **New** to create a table or view.</span></span>  
  
    -   <span data-ttu-id="3a4ab-125">单击 **“使用 SQL 查询的结果”** ，然后在 **“SQL 命令”** 窗口中生成查询。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-125">Click **Use results of an SQL query**, and then build a query in the **SQL Command** window.</span></span>  
  
         <span data-ttu-id="3a4ab-126">-或-</span><span class="sxs-lookup"><span data-stu-id="3a4ab-126">-or-</span></span>  
  
         <span data-ttu-id="3a4ab-127">单击 **“生成查询”** ，使用 **“查询生成器”** 提供的图形工具生成一个查询。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-127">Click **Build Query** to build a query by using the graphical tools that the **Query Builder** provides.</span></span>  
  
         <span data-ttu-id="3a4ab-128">-或-</span><span class="sxs-lookup"><span data-stu-id="3a4ab-128">-or-</span></span>  
  
         <span data-ttu-id="3a4ab-129">单击 **“浏览”** 从文件中导入 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-129">Click **Browse** to import an SQL statement from a file.</span></span>  
  
     <span data-ttu-id="3a4ab-130">若要验证 SQL 查询，请单击 **“分析查询”** 。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-130">To validate the SQL query, click **Parse Query**.</span></span>  
  
     <span data-ttu-id="3a4ab-131">若要查看数据的示例，请单击 **“预览”** 。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-131">To view a sample of the data, click **Preview**.</span></span>  
  
9. <span data-ttu-id="3a4ab-132">单击 **“列”** 页，然后将至少一列从 **“可用输入列”** 列表中拖动到 **“可用查找列”** 列表中的列。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-132">Click the **Columns** page, and then drag at least one column from the **Available Input Columns** list to a column in the **Available Lookup Column** list.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3a4ab-133">查找转换自动映射具有相同名称和相同数据类型的列。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-133">The Lookup transformation automatically maps columns that have the same name and the same data type.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3a4ab-134">列必须含有要映射的匹配数据类型。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-134">Columns must have matching data types to be mapped.</span></span> <span data-ttu-id="3a4ab-135">有关详细信息，请参阅 [Integration Services 数据类型](../integration-services-data-types.md)。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-135">For more information, see [Integration Services Data Types](../integration-services-data-types.md).</span></span>  
  
10. <span data-ttu-id="3a4ab-136">执行以下步骤在输出中包括查找列：</span><span class="sxs-lookup"><span data-stu-id="3a4ab-136">Include lookup columns in the output by doing the following steps:</span></span>  
  
    1.  <span data-ttu-id="3a4ab-137">从 **“可用查找列”** 列表中，选择列。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-137">From the **Available Lookup Columns** list, select columns.</span></span>  
  
    2.  <span data-ttu-id="3a4ab-138">在 **“查找操作”** 列表中，指定查找列中的值是替换输入列中的值还是写入到新列。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-138">In **Lookup Operation** list, specify whether the values from the lookup columns replace values in the input column or are written to a new column.</span></span>  
  
11. <span data-ttu-id="3a4ab-139">如果在步骤 5 中选择了 **“部分缓存”** ，则在 **“高级”** 页上，设置以下缓存选项：</span><span class="sxs-lookup"><span data-stu-id="3a4ab-139">If you selected **Partial cache** in step 5, on the **Advanced** page, set the following cache options:</span></span>  
  
    -   <span data-ttu-id="3a4ab-140">从“缓存大小(32 位)”  列表中，为 32 位环境选择缓存大小。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-140">From the **Cache size (32-bit)** list, select the cache size for 32-bit environments.</span></span>  
  
    -   <span data-ttu-id="3a4ab-141">从“缓存大小(64 位)”  列表中，为 64 位环境选择缓存大小。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-141">From the **Cache size (64-bit)** list, select the cache size for 64-bit environments.</span></span>  
  
    -   <span data-ttu-id="3a4ab-142">若要缓存在引用中有匹配项的行，请选择 **“为没有匹配项的行启用缓存”** 。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-142">To cache the rows without matching entries in the reference, select **Enable cache for rows with no matching entries**.</span></span>  
  
    -   <span data-ttu-id="3a4ab-143">在 **“从缓存分配”** 列表中，选择用于存储没有匹配项的行的缓存百分比。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-143">From the **Allocation from cache** list, select the percentage of the cache to use to store the rows without matching entries.</span></span>  
  
12. <span data-ttu-id="3a4ab-144">若要修改生成引用数据集的 SQL 语句，请选择 **“修改 SQL 语句”** ，然后更改文本框中显示的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-144">To modify the SQL statement that generates the reference dataset, select **Modify the SQL statement**, and change the SQL statement displayed in the text box.</span></span>  
  
     <span data-ttu-id="3a4ab-145">如果语句中包含参数，请单击 **“参数”** 以将这些参数映射到输入列。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-145">If the statement includes parameters, click **Parameters** to map the parameters to input columns.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3a4ab-146">在此页上指定的可选 SQL 语句将覆盖并替换在 **“查找转换编辑器”** 的 **“高级”** 页上指定的表名。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-146">The optional SQL statement that you specify on this page overrides and replaces the table name that you specified on the **Connection** page of the **Lookup Transformation Editor**.</span></span>  
  
13. <span data-ttu-id="3a4ab-147">若要配置错误输出，请单击 **“错误输出”** 页，并设置错误处理选项。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-147">To configure the error output, click the **Error Output** page and set the error handling options.</span></span> <span data-ttu-id="3a4ab-148">有关详细信息，请参阅[查找转换编辑器（“错误输出”页）](../../lookup-transformation-editor-error-output-page.md)。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-148">For more information, see [Lookup Transformation Editor &#40;Error Output Page&#41;](../../lookup-transformation-editor-error-output-page.md).</span></span>  
  
14. <span data-ttu-id="3a4ab-149">单击 **“确定”** 以保存对查找转换的更改，然后运行包。</span><span class="sxs-lookup"><span data-stu-id="3a4ab-149">Click **OK** to save your changes to the Lookup transformation, and then run the package.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a4ab-150">另请参阅</span><span class="sxs-lookup"><span data-stu-id="3a4ab-150">See Also</span></span>  
 [<span data-ttu-id="3a4ab-151">Integration Services 转换</span><span class="sxs-lookup"><span data-stu-id="3a4ab-151">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
