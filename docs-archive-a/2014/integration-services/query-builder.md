---
title: 查询生成器 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688004"
---
# <a name="query-builder"></a><span data-ttu-id="df513-102">查询生成器</span><span class="sxs-lookup"><span data-stu-id="df513-102">Query Builder</span></span>
  <span data-ttu-id="df513-103">可以使用 **“查询生成器”** 对话框，创建在执行 SQL 任务、OLE DB 源和 OLE DB 目标以及查找转换中使用的查询。</span><span class="sxs-lookup"><span data-stu-id="df513-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="df513-104">可以使用查询生成器来执行下列任务：</span><span class="sxs-lookup"><span data-stu-id="df513-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="df513-105">**使用查询的图形表示形式或 SQL 命令** 查询生成器包括以图形方式显示查询的窗格和以 SQL 文本方式显示查询的窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="df513-106">您既可以在图形窗格中工作，也可以在文本窗格中工作。</span><span class="sxs-lookup"><span data-stu-id="df513-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="df513-107">查询生成器可以同步视图，使其始终保持为最新状态。</span><span class="sxs-lookup"><span data-stu-id="df513-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="df513-108">**联接相关表** 如果将多个表添加到查询中，查询生成器将自动确定这些表之间的关系，并构造相应的联接命令。</span><span class="sxs-lookup"><span data-stu-id="df513-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="df513-109">**查询或更新数据库** 可以使用查询生成器通过 Transact-SQL SELECT 语句来返回数据，还可使用它来创建查询以便更新、添加或删除数据库中的记录。</span><span class="sxs-lookup"><span data-stu-id="df513-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="df513-110">**立即查看和编辑结果** 您可以运行查询，在可滚动和编辑数据库中各记录的网格中对记录集进行操作。</span><span class="sxs-lookup"><span data-stu-id="df513-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="df513-111">\*\*\*\*“查询生成器”对话框中的图形工具使你可以使用拖放操作来构造查询。</span><span class="sxs-lookup"><span data-stu-id="df513-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="df513-112">默认情况下，“查询生成器”对话框将生成 SELECT 查询，但也可以生成 INSERT、UPDATE 或 DELETE 查询。</span><span class="sxs-lookup"><span data-stu-id="df513-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="df513-113">还可以在 **“查询生成器”** 对话框中分析和运行所有类型的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="df513-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="df513-114">有关包中 SQL 语句的详细信息，请参阅 [Integration Services (SSIS) 查询](integration-services-ssis-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="df513-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="df513-115">若要了解关于 Transact-SQL 语言及其语法的详细信息，请参阅 [Transact-SQL 引用（数据库引擎）](/sql/t-sql/language-reference)。</span><span class="sxs-lookup"><span data-stu-id="df513-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="df513-116">还可以在查询中使用变量，以便为输入参数提供值、捕获输出参数的值并存储返回代码。</span><span class="sxs-lookup"><span data-stu-id="df513-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="df513-117">若要了解包所使用的查询中使用变量的详细信息，请参阅[执行 SQL Task](control-flow/execute-sql-task.md)[OLE DB 源](data-flow/ole-db-source.md) 和 [Integration Services (SSIS) 查询](integration-services-ssis-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="df513-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="df513-118">若要了解有关在执行 SQL 任务中使用变量的详细信息，请参阅 [执行 SQL 任务中的参数和返回代码](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) 和 [执行 SQL 任务中的结果集](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)。</span><span class="sxs-lookup"><span data-stu-id="df513-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="df513-119">查找转换和模糊查找转换也可以使用带有参数和返回代码和变量。</span><span class="sxs-lookup"><span data-stu-id="df513-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="df513-120">有关 OLE DB 源的信息也适用于上述两种转换。</span><span class="sxs-lookup"><span data-stu-id="df513-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="df513-121">选项</span><span class="sxs-lookup"><span data-stu-id="df513-121">Options</span></span>  
 <span data-ttu-id="df513-122">**工具栏**</span><span class="sxs-lookup"><span data-stu-id="df513-122">**Toolbar**</span></span>  
 <span data-ttu-id="df513-123">使用工具栏可以管理数据集、选择要显示的窗格以及控制查询函数。</span><span class="sxs-lookup"><span data-stu-id="df513-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="df513-124">值</span><span class="sxs-lookup"><span data-stu-id="df513-124">Value</span></span>|<span data-ttu-id="df513-125">说明</span><span class="sxs-lookup"><span data-stu-id="df513-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="df513-126">**显示/隐藏关系图窗格**</span><span class="sxs-lookup"><span data-stu-id="df513-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="df513-127">显示或隐藏 "**关系图**" 窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="df513-128">**显示/隐藏网格窗格**</span><span class="sxs-lookup"><span data-stu-id="df513-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="df513-129">显示或隐藏 "**网格**" 窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="df513-130">**显示/隐藏 SQL 窗格**</span><span class="sxs-lookup"><span data-stu-id="df513-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="df513-131">显示或隐藏**SQL**窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="df513-132">**显示/隐藏结果窗格**</span><span class="sxs-lookup"><span data-stu-id="df513-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="df513-133">显示或隐藏 **“结果”** 窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="df513-134">**Run**</span><span class="sxs-lookup"><span data-stu-id="df513-134">**Run**</span></span>|<span data-ttu-id="df513-135">运行查询。</span><span class="sxs-lookup"><span data-stu-id="df513-135">Runs the query.</span></span> <span data-ttu-id="df513-136">结果将显示在结果窗格中。</span><span class="sxs-lookup"><span data-stu-id="df513-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="df513-137">**验证 SQL**</span><span class="sxs-lookup"><span data-stu-id="df513-137">**Verify SQL**</span></span>|<span data-ttu-id="df513-138">验证 SQL 语句是否有效。</span><span class="sxs-lookup"><span data-stu-id="df513-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="df513-139">**升序排序**</span><span class="sxs-lookup"><span data-stu-id="df513-139">**Sort Ascending**</span></span>|<span data-ttu-id="df513-140">依据网格窗格中的所选列对输出行按升序排序。</span><span class="sxs-lookup"><span data-stu-id="df513-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="df513-141">**降序排序**</span><span class="sxs-lookup"><span data-stu-id="df513-141">**Sort Descending**</span></span>|<span data-ttu-id="df513-142">依据网格窗格中的所选列对输出行按降序排序。</span><span class="sxs-lookup"><span data-stu-id="df513-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="df513-143">**删除筛选器**</span><span class="sxs-lookup"><span data-stu-id="df513-143">**Remove Filter**</span></span>|<span data-ttu-id="df513-144">在网格窗格中选择列名，再单击 **“删除筛选器”** 可以删除列的排序条件。</span><span class="sxs-lookup"><span data-stu-id="df513-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="df513-145">**使用 Group By**</span><span class="sxs-lookup"><span data-stu-id="df513-145">**Use Group By**</span></span>|<span data-ttu-id="df513-146">向查询中添加 GROUP BY 功能。</span><span class="sxs-lookup"><span data-stu-id="df513-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="df513-147">**添加表**</span><span class="sxs-lookup"><span data-stu-id="df513-147">**Add Table**</span></span>|<span data-ttu-id="df513-148">向查询中添加新表。</span><span class="sxs-lookup"><span data-stu-id="df513-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="df513-149">**查询定义**</span><span class="sxs-lookup"><span data-stu-id="df513-149">**Query Definition**</span></span>  
 <span data-ttu-id="df513-150">查询定义提供可用来定义和测试查询的工具栏和窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="df513-151">窗格</span><span class="sxs-lookup"><span data-stu-id="df513-151">Pane</span></span>|<span data-ttu-id="df513-152">说明</span><span class="sxs-lookup"><span data-stu-id="df513-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="df513-153">**关系图**窗格</span><span class="sxs-lookup"><span data-stu-id="df513-153">**Diagram** pane</span></span>|<span data-ttu-id="df513-154">在关系图中显示查询。</span><span class="sxs-lookup"><span data-stu-id="df513-154">Displays the query in a diagram.</span></span> <span data-ttu-id="df513-155">关系图可显示查询中包含的表以及这些表的联接方式。</span><span class="sxs-lookup"><span data-stu-id="df513-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="df513-156">选中或清除表中某列旁边的复选框，即可在查询输出中添加或删除该列。</span><span class="sxs-lookup"><span data-stu-id="df513-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="df513-157">当您向查询添加表时，查询生成器将根据表和表中的键在表之间创建联接。</span><span class="sxs-lookup"><span data-stu-id="df513-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="df513-158">若要添加联接，请将一个表中的字段拖到另一个表中的字段上。</span><span class="sxs-lookup"><span data-stu-id="df513-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="df513-159">若要管理联接，请右键单击该联接，再选择菜单选项。</span><span class="sxs-lookup"><span data-stu-id="df513-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="df513-160">右键单击 "**关系图**" 窗格以添加或删除表，选择所有表，并显示或隐藏窗格。</span><span class="sxs-lookup"><span data-stu-id="df513-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="df513-161">**网格**窗格</span><span class="sxs-lookup"><span data-stu-id="df513-161">**Grid** pane</span></span>|<span data-ttu-id="df513-162">在网格中显示查询。</span><span class="sxs-lookup"><span data-stu-id="df513-162">Displays the query in a grid.</span></span> <span data-ttu-id="df513-163">使用此窗格可以在查询中添加和删除列，以及更改每个列的设置。</span><span class="sxs-lookup"><span data-stu-id="df513-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="df513-164">**SQL**窗格</span><span class="sxs-lookup"><span data-stu-id="df513-164">**SQL** pane</span></span>|<span data-ttu-id="df513-165">以 SQL 文本的形式显示查询。</span><span class="sxs-lookup"><span data-stu-id="df513-165">Displays the query as SQL text.</span></span> <span data-ttu-id="df513-166">在 **“关系图”** 窗格和 **“网格”** 窗格中所做的更改将显示在此窗格中，在此窗格中所做的更改也将显示在 **“关系图”** 窗格和 **“网格”** 窗格中。</span><span class="sxs-lookup"><span data-stu-id="df513-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="df513-167">**“结果”** 窗格</span><span class="sxs-lookup"><span data-stu-id="df513-167">**Results** pane</span></span>|<span data-ttu-id="df513-168">在您单击工具栏上的 **“运行”** 时显示查询的结果。</span><span class="sxs-lookup"><span data-stu-id="df513-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="df513-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="df513-169">See Also</span></span>  
 <span data-ttu-id="df513-170">[执行 SQL 任务](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="df513-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="df513-171">[OLE DB 源](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="df513-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="df513-172">[OLE DB 目标](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="df513-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="df513-173">[查找转换](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="df513-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="df513-174">[Integration Services &#40;SSIS&#41; 查询](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="df513-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="df513-175">在 Integration Services 包中执行 MERGE</span><span class="sxs-lookup"><span data-stu-id="df513-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
