---
title: 升级 Integration Services 包 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services, migrating
- migrating packages [Integration Services]
ms.assetid: 68dbdf81-032c-4a73-99f6-41420e053980
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5a6ca4f80b25a8cc4628da4382c1aae971c74bf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586883"
---
# <a name="upgrade-integration-services-packages"></a><span data-ttu-id="9d226-102">升级 Integration Services 包</span><span class="sxs-lookup"><span data-stu-id="9d226-102">Upgrade Integration Services Packages</span></span>
  <span data-ttu-id="9d226-103">将或的实例升级 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 到的当前版本时 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ，现有的 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 包不会自动升级到当前版本使用的包格式 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9d226-103">When you upgrade an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your existing [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] packages are not automatically upgraded to the package format that the current release [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] uses.</span></span> <span data-ttu-id="9d226-104">您必须选择一种升级方法并手动升级包。</span><span class="sxs-lookup"><span data-stu-id="9d226-104">You will have to select an upgrade method and manually upgrade your packages.</span></span>  
  
 <span data-ttu-id="9d226-105">升级 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包时，会 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 将任何脚本任务和脚本组件中的脚本迁移到 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] (VSTA) 的应用程序的工具。</span><span class="sxs-lookup"><span data-stu-id="9d226-105">When you upgrade a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] migrates the scripts in any Script task and Script component to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA).</span></span> <span data-ttu-id="9d226-106">在中 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ，脚本任务或脚本组件中的脚本用于 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] (VSA) 的应用程序。</span><span class="sxs-lookup"><span data-stu-id="9d226-106">In [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the scripts in Script tasks or Script components used [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] for Applications (VSA).</span></span> <span data-ttu-id="9d226-107">有关在迁移之前可能需要进行的脚本更改以及脚本转换失败的详细信息，请参阅[将脚本迁移到 VSTA](../../sql-server/install/migrate-scripts-to-vsta.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-107">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>  
  
 <span data-ttu-id="9d226-108">有关在将项目转换为项目部署模型时升级包的信息，请参阅 [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-108">For information on upgrading packages when you convert a project to the project deployment model, see [Deploy Projects to Integration Services Server](../deploy-projects-to-integration-services-server.md).</span></span>  
  
## <a name="sql-server-2000-data-transformation-services-packages"></a><span data-ttu-id="9d226-109">SQL Server 2000 Data Transformation Services 包</span><span class="sxs-lookup"><span data-stu-id="9d226-109">SQL Server 2000 Data Transformation Services Packages</span></span>  
 <span data-ttu-id="9d226-110">当前版本的中不再支持迁移或运行数据转换服务 (DTS) 包 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9d226-110">Support for migrating or running Data Transformation Services (DTS) packages has been discontinued in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="9d226-111">不再提供以下 DTS 功能：</span><span class="sxs-lookup"><span data-stu-id="9d226-111">The following DTS functionality has been discontinued.</span></span>  
  
-   <span data-ttu-id="9d226-112">DTS 运行时</span><span class="sxs-lookup"><span data-stu-id="9d226-112">DTS runtime</span></span>  
  
-   <span data-ttu-id="9d226-113">DTS API</span><span class="sxs-lookup"><span data-stu-id="9d226-113">DTS API</span></span>  
  
-   <span data-ttu-id="9d226-114">用于将 DTS 包迁移到下一版本的 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="9d226-114">Package Migration Wizard for migrating DTS packages to the next version of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]</span></span>  
  
-   <span data-ttu-id="9d226-115">中对 DTS 包维护的支持 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span><span class="sxs-lookup"><span data-stu-id="9d226-115">Support for DTS package maintenance in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]</span></span>  
  
-   <span data-ttu-id="9d226-116">执行 DTS 2000 包任务</span><span class="sxs-lookup"><span data-stu-id="9d226-116">Execute DTS 2000 Package task</span></span>  
  
-   <span data-ttu-id="9d226-117">升级 DTS 包的顾问扫描。</span><span class="sxs-lookup"><span data-stu-id="9d226-117">Upgrade Advisor scan of DTS packages.</span></span>  
  
 <span data-ttu-id="9d226-118">以下选项可用于迁移 DTS 包。</span><span class="sxs-lookup"><span data-stu-id="9d226-118">The following options are available for migrating DTS packages.</span></span>  
  
-   <span data-ttu-id="9d226-119">将这些包迁移到 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 或 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)]，然后将这些包升级到 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="9d226-119">Migrate the packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], and then upgrade the packages to [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="9d226-120">有关将 DTS 包迁移到 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 和 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 的信息，请参阅[迁移 Data Transformation Services 包](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) 和[迁移 Data Transformation Services 包](https://go.microsoft.com/fwlink/?LinkId=251871) (2008)。</span><span class="sxs-lookup"><span data-stu-id="9d226-120">For information about migrating DTS packages to [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] and [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)], see [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251870) (2005) and [Migrating Data Transformation Services Packages](https://go.microsoft.com/fwlink/?LinkId=251871) (2008).</span></span>  
  
-   <span data-ttu-id="9d226-121">通过使用 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] 重新创建 DTS 包。</span><span class="sxs-lookup"><span data-stu-id="9d226-121">Recreate the DTS packages by using [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)].</span></span>  
  
     <span data-ttu-id="9d226-122">有关 [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)] 中新增功能的信息，请参阅[新增功能 (Integration Services)](../what-s-new-in-integration-services-in-sql-server-2016.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-122">For information about the new features in [!INCLUDE[ssISversion11](../../includes/ssisversion11-md.md)], see [What's New &#40;Integration Services&#41;](../what-s-new-in-integration-services-in-sql-server-2016.md).</span></span> <span data-ttu-id="9d226-123">有关 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 包的结构的概述，请参阅 [Integration Services (SSIS) 包](../integration-services-ssis-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-123">For an overview of the structure of [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [Integration Services &#40;SSIS&#41; Packages](../integration-services-ssis-packages.md).</span></span>  
  
## <a name="selecting-an-upgrade-method"></a><span data-ttu-id="9d226-124">选择升级方法</span><span class="sxs-lookup"><span data-stu-id="9d226-124">Selecting an Upgrade Method</span></span>  
 <span data-ttu-id="9d226-125">可以使用各种方法来升级 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 包。</span><span class="sxs-lookup"><span data-stu-id="9d226-125">You can use various methods to upgrade [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages.</span></span> <span data-ttu-id="9d226-126">对于某些方法，升级只是临时的。</span><span class="sxs-lookup"><span data-stu-id="9d226-126">For some of these methods, the upgrade is only temporary.</span></span> <span data-ttu-id="9d226-127">对于其他方法，升级将是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-127">For others, the upgrade is permanent.</span></span> <span data-ttu-id="9d226-128">下表描述了每种升级方法以及升级是临时的还是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-128">The following table describes each of these methods and whether the upgrade is temporary or permanent.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9d226-129">使用随当前版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 一起安装的 **dtexec** 实用工具 (dtexec.exe) 运行 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 包时，临时包升级将增加执行时间。</span><span class="sxs-lookup"><span data-stu-id="9d226-129">When you run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package using the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the temporary package upgrade increases the execution time.</span></span> <span data-ttu-id="9d226-130">包执行时间的增加比率将由包的大小决定。</span><span class="sxs-lookup"><span data-stu-id="9d226-130">The rate of increase in package execution time varies depending on the size of the package.</span></span> <span data-ttu-id="9d226-131">为了避免增加执行时间，建议您在运行包之前对包进行升级。</span><span class="sxs-lookup"><span data-stu-id="9d226-131">To avoid an increase in the execution time, it is recommended that you upgrade the package before running it.</span></span>  
  
|<span data-ttu-id="9d226-132">升级方法</span><span class="sxs-lookup"><span data-stu-id="9d226-132">Upgrade Method</span></span>|<span data-ttu-id="9d226-133">升级类型</span><span class="sxs-lookup"><span data-stu-id="9d226-133">Type of Upgrade</span></span>|  
|--------------------|---------------------|  
|<span data-ttu-id="9d226-134">使用随当前版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 安装的 **dtexec** 实用工具 (dtexec.exe) 来运行 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]包。</span><span class="sxs-lookup"><span data-stu-id="9d226-134">Use the **dtexec** utility (dtexec.exe) that is installed with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to run a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package.</span></span><br /><br /> <span data-ttu-id="9d226-135">有关详细信息，请参阅 [dtexec Utility](../packages/dtexec-utility.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-135">For more information, see [dtexec Utility](../packages/dtexec-utility.md).</span></span>|<span data-ttu-id="9d226-136">包升级是临时的。</span><span class="sxs-lookup"><span data-stu-id="9d226-136">The package upgrade is temporary.</span></span> <span data-ttu-id="9d226-137">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，脚本迁移是临时的。</span><span class="sxs-lookup"><span data-stu-id="9d226-137">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is temporary.</span></span><br /><br /> <span data-ttu-id="9d226-138">无法保存所做的更改。</span><span class="sxs-lookup"><span data-stu-id="9d226-138">The changes cannot be saved.</span></span>|  
|<span data-ttu-id="9d226-139">在 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 中打开 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 或 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 包文件。</span><span class="sxs-lookup"><span data-stu-id="9d226-139">Open a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package file in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="9d226-140">如果保存该包，则包升级是永久的；否则，如果不保存该包，则包升级是临时的。</span><span class="sxs-lookup"><span data-stu-id="9d226-140">The package upgrade is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span><br /><br /> <span data-ttu-id="9d226-141">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，如果保存该包，则包迁移是永久的；否则是临时的。</span><span class="sxs-lookup"><span data-stu-id="9d226-141">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent if you save the package; otherwise, it is temporary if you do not save the package.</span></span>|  
|<span data-ttu-id="9d226-142">将 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 或 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 包添加到 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 的现有项目中。</span><span class="sxs-lookup"><span data-stu-id="9d226-142">Add a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] package to an existing project in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span>|<span data-ttu-id="9d226-143">包升级是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-143">The package upgrade is permanent.</span></span> <span data-ttu-id="9d226-144">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，脚本迁移是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-144">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="9d226-145">在 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] 中打开 [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] 或 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 项目文件，然后使用 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 包升级向导升级项目中的多个包。</span><span class="sxs-lookup"><span data-stu-id="9d226-145">Open a [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] or [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] project file in [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)], and then use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade multiple packages in the project.</span></span><br /><br /> <span data-ttu-id="9d226-146">有关详细信息，请参阅 [使用 SSIS 包升级向导升级 Integration Services 包](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) 和 [SSIS 包升级向导的 F1 帮助](../ssis-package-upgrade-wizard-f1-help.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-146">For more information, see [Upgrade Integration Services Packages Using the SSIS Package Upgrade Wizard](upgrade-integration-services-packages-using-the-ssis-package-upgrade-wizard.md) and [SSIS Package Upgrade Wizard F1 Help](../ssis-package-upgrade-wizard-f1-help.md).</span></span>|<span data-ttu-id="9d226-147">包升级是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-147">The package upgrade is permanent.</span></span> <span data-ttu-id="9d226-148">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，脚本迁移是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-148">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
|<span data-ttu-id="9d226-149">使用随当前版本的 <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> 方法升级一个或多个 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 包。</span><span class="sxs-lookup"><span data-stu-id="9d226-149">Use the <xref:Microsoft.SqlServer.Dts.Runtime.Application.Upgrade%2A> method to upgrade one or more [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages.</span></span>|<span data-ttu-id="9d226-150">包升级是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-150">The package upgrade is permanent.</span></span> <span data-ttu-id="9d226-151">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，脚本迁移是永久的。</span><span class="sxs-lookup"><span data-stu-id="9d226-151">For a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] package, the script migration is permanent.</span></span>|  
  
## <a name="custom-applications-and-custom-components"></a><span data-ttu-id="9d226-152">自定义应用程序和自定义组件</span><span class="sxs-lookup"><span data-stu-id="9d226-152">Custom Applications and Custom Components</span></span>  
 [!INCLUDE[ssISversion2005](../../includes/ssisversion2005-md.md)] <span data-ttu-id="9d226-153">自定义组件将不与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]的当前版本一起使用。</span><span class="sxs-lookup"><span data-stu-id="9d226-153">custom components will not work with the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="9d226-154">可以使用当前版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 工具运行和管理包含 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssIS](../../includes/ssis-md.md)] 自定义组件的包。</span><span class="sxs-lookup"><span data-stu-id="9d226-154">You can use the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tools to run and manage packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)][!INCLUDE[ssIS](../../includes/ssis-md.md)] custom components.</span></span> <span data-ttu-id="9d226-155">我们已向下列文件添加了四个绑定限制规则以帮助将版本 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) 中的运行时程序集定向到版本 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="9d226-155">We added four binding redirection rules to the following files to help redirect the runtime assemblies from version 10.0.0.0 ([!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]) to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span>  
  
-   <span data-ttu-id="9d226-156">DTExec.exe.config</span><span class="sxs-lookup"><span data-stu-id="9d226-156">DTExec.exe.config</span></span>  
  
-   <span data-ttu-id="9d226-157">dtshost.exe.config</span><span class="sxs-lookup"><span data-stu-id="9d226-157">dtshost.exe.config</span></span>  
  
-   <span data-ttu-id="9d226-158">DTSWizard.exe.config</span><span class="sxs-lookup"><span data-stu-id="9d226-158">DTSWizard.exe.config</span></span>  
  
-   <span data-ttu-id="9d226-159">DTUtil.exe.config</span><span class="sxs-lookup"><span data-stu-id="9d226-159">DTUtil.exe.config</span></span>  
  
-   <span data-ttu-id="9d226-160">DTExecUI.exe.config</span><span class="sxs-lookup"><span data-stu-id="9d226-160">DTExecUI.exe.config</span></span>  
  
 <span data-ttu-id="9d226-161">若要使用 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 设计包含 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 和 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] 自定义组件的包，需要修改位于以下位置的 devenv.exe.config 文件 *\<drive>* ： \Program Files\Microsoft Visual Studio 10.0 \ common7\ide。</span><span class="sxs-lookup"><span data-stu-id="9d226-161">To use [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] to design packages that include [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] custom components, you need to modify the devenv.exe.config file that is located at *\<drive>*:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE.</span></span>  
  
 <span data-ttu-id="9d226-162">若要将这些包用于使用 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]的运行时生成的客户应用程序，则在可执行文件的 \*.exe.config 文件的配置部分中包含重定向规则。</span><span class="sxs-lookup"><span data-stu-id="9d226-162">To use these packages with customer applications that are built with the runtime for [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], include redirection rules in the configuration section of the \*.exe.config file for the executable.</span></span> <span data-ttu-id="9d226-163">这些规则会将运行时程序集重定向至版本 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="9d226-163">The rules redirect the runtime assemblies to version 11.0.0.0 ([!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]).</span></span> <span data-ttu-id="9d226-164">有关程序集版本重定向的详细信息，请参阅 [\<runtime> 的 \<assemblyBinding> 元素](https://msdn.microsoft.com/library/twy1dw1e.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d226-164">For more information about assembly version redirection, see [\<assemblyBinding> Element for \<runtime>](https://msdn.microsoft.com/library/twy1dw1e.aspx).</span></span>  
  
### <a name="locating-the-assemblies"></a><span data-ttu-id="9d226-165">定位程序集</span><span class="sxs-lookup"><span data-stu-id="9d226-165">Locating the Assemblies</span></span>  
 <span data-ttu-id="9d226-166">在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]中， [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 程序集已升级到 .NET 4.0。</span><span class="sxs-lookup"><span data-stu-id="9d226-166">In [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies were upgraded to .NET 4.0.</span></span> <span data-ttu-id="9d226-167">位于 \<drive>:\Windows\Microsoft.NET\assembly 中的 .NET 4 存在单独的全局程序集缓存。</span><span class="sxs-lookup"><span data-stu-id="9d226-167">There is a separate global assembly cache for .NET 4, located in *\<drive>*:\Windows\Microsoft.NET\assembly.</span></span> <span data-ttu-id="9d226-168">您可在此路径下找到所有 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 程序集，一般位于 GAC_MSIL 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="9d226-168">You can find all of the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] assemblies under this path, usually in the GAC_MSIL folder.</span></span>  
  
 <span data-ttu-id="9d226-169">与之前版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 一样，核心 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 扩展性 .dll 文件也位于 \<drive>:\Program Files\Microsoft SQL Server\100\SDK\Assemblies 中。</span><span class="sxs-lookup"><span data-stu-id="9d226-169">As in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the core [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] extensibility .dll files are also located at *\<drive>*:\Program Files\Microsoft SQL Server\100\SDK\Assemblies.</span></span>  
  
## <a name="understanding-sql-server-package-upgrade-results"></a><span data-ttu-id="9d226-170">了解 SQL Server 包升级结果</span><span class="sxs-lookup"><span data-stu-id="9d226-170">Understanding SQL Server Package Upgrade Results</span></span>  
 <span data-ttu-id="9d226-171">在包升级过程中，[!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 包中的大部分组件和功能都无缝地转换为其在当前版本的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 中的对应部分。</span><span class="sxs-lookup"><span data-stu-id="9d226-171">During the package upgrade process, most components and features in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages convert seamlessly to their counterparts in the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9d226-172">但是，有一些组件和功能，它们要么无法升级，要么升级的结果值得引起您的注意。</span><span class="sxs-lookup"><span data-stu-id="9d226-172">However, there are several components and features that either will not be upgraded or have upgrade results of which you should be aware.</span></span> <span data-ttu-id="9d226-173">下表确定了这些组件和功能。</span><span class="sxs-lookup"><span data-stu-id="9d226-173">The following table identifies these components and features.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9d226-174">若要确定哪些包具有该表中列出的问题，请运行升级顾问。</span><span class="sxs-lookup"><span data-stu-id="9d226-174">To identify which packages have the issues listed in this table, run Upgrade Advisor.</span></span> <span data-ttu-id="9d226-175">有关详细信息，请参阅 [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-175">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
|<span data-ttu-id="9d226-176">组件或功能</span><span class="sxs-lookup"><span data-stu-id="9d226-176">Component or Feature</span></span>|<span data-ttu-id="9d226-177">升级结果</span><span class="sxs-lookup"><span data-stu-id="9d226-177">Upgrade Results</span></span>|  
|--------------------------|---------------------|  
|<span data-ttu-id="9d226-178">连接字符串</span><span class="sxs-lookup"><span data-stu-id="9d226-178">Connection strings</span></span>|<span data-ttu-id="9d226-179">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 和 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 包，某些提供程序的名称已更改，而且需要在连接字符串中使用不同的值。</span><span class="sxs-lookup"><span data-stu-id="9d226-179">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] packages, the names of certain providers have changed and require different values in the connection strings.</span></span> <span data-ttu-id="9d226-180">若要更新连接字符串，请使用下列过程之一：</span><span class="sxs-lookup"><span data-stu-id="9d226-180">To update the connection strings, use one of the following procedures:</span></span><br /><br /> <span data-ttu-id="9d226-181">-使用 [!INCLUDE[ssIS](../../includes/ssis-md.md)] 包升级向导升级包，并选择 "**更新连接字符串以使用新的提供程序名称**" 选项。</span><span class="sxs-lookup"><span data-stu-id="9d226-181">-Use the [!INCLUDE[ssIS](../../includes/ssis-md.md)] Package Upgrade Wizard to upgrade the package, and select the **Update connection strings to use new provider names** option.</span></span><br /><br /> <span data-ttu-id="9d226-182">-在中，在 " [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 选项" 对话框的 "常规" 页上，选择 "**更新连接字符串以使用新的提供程序名称**" 选项。</span><span class="sxs-lookup"><span data-stu-id="9d226-182">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], on the General page of the Options dialog box, select the **Update connection strings to use new provider names** option.</span></span> <span data-ttu-id="9d226-183">有关此选项的详细信息，请参阅 "[常规" 页](../general-page-of-integration-services-designers-options.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-183">For more information about this option, see [General Page](../general-page-of-integration-services-designers-options.md).</span></span><br /><br /> <span data-ttu-id="9d226-184">-在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 中，打开该包并手动更改 ConnectionString 属性的文本。</span><span class="sxs-lookup"><span data-stu-id="9d226-184">-In [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], open the package and manually change the text of the ConnectionString property.</span></span><br /><br /> <span data-ttu-id="9d226-185">注意：在连接字符串存储于配置文件或数据源文件中，或表达式设置了 `ConnectionString` 属性时，不能使用上述过程更新连接字符串。</span><span class="sxs-lookup"><span data-stu-id="9d226-185">Note: You cannot use the previous procedures to update a connection string when the connection string is stored in either a configuration file or a data source file, or when an expression sets the `ConnectionString` property.</span></span> <span data-ttu-id="9d226-186">若要在这两种情况下更新连接字符串，必须手动更新文件或表达式。</span><span class="sxs-lookup"><span data-stu-id="9d226-186">To update the connection string in these cases, you must manually update the file or the expression.</span></span><br /><br /> <span data-ttu-id="9d226-187">有关数据源的详细信息，请参阅 [数据源](../connection-manager/data-sources.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-187">For more information about data sources, see [Data Sources](../connection-manager/data-sources.md).</span></span>|  
|<span data-ttu-id="9d226-188">查找转换</span><span class="sxs-lookup"><span data-stu-id="9d226-188">Lookup transformation</span></span>|<span data-ttu-id="9d226-189">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，升级过程会自动将查找转换升级到的当前版本 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9d226-189">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically upgrades the Lookup transformation to the current release of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="9d226-190">不过，此组件的当前版本有一些您可能想要利用的额外功能。</span><span class="sxs-lookup"><span data-stu-id="9d226-190">However, the current release of this component has some additional capabilities of which you might want to take advantage.</span></span><br /><br /> <span data-ttu-id="9d226-191">有关详细信息，请参阅 [Lookup Transformation](../data-flow/transformations/lookup-transformation.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-191">For more information, see [Lookup Transformation](../data-flow/transformations/lookup-transformation.md).</span></span>|  
|<span data-ttu-id="9d226-192">脚本任务和脚本组件</span><span class="sxs-lookup"><span data-stu-id="9d226-192">Script task and Script component</span></span>|<span data-ttu-id="9d226-193">对于 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] 包，升级过程会自动将脚本任务和脚本组件中的脚本从 VSA 迁移到 VSTA。</span><span class="sxs-lookup"><span data-stu-id="9d226-193">For [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] packages, the upgrade process automatically migrates scripts in the Script task and Script component from VSA to VSTA.</span></span><br /><br /> <span data-ttu-id="9d226-194">有关在迁移之前可能需要进行的脚本更改以及脚本转换失败的详细信息，请参阅[将脚本迁移到 VSTA](../../sql-server/install/migrate-scripts-to-vsta.md)。</span><span class="sxs-lookup"><span data-stu-id="9d226-194">For more information about changes that you might have to make to the scripts before migration and about script conversion failure, see [Migrate Scripts to VSTA](../../sql-server/install/migrate-scripts-to-vsta.md).</span></span>|  
  
### <a name="scripts-that-depend-on-adodbdll"></a><span data-ttu-id="9d226-195">依赖于 ADODB.dll 的脚本</span><span class="sxs-lookup"><span data-stu-id="9d226-195">Scripts that Depend on ADODB.dll</span></span>  
 <span data-ttu-id="9d226-196">在未安装 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 或 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] 的计算机上，可能不能升级或运行显式引用 ADODB.dll 的“脚本任务”和“脚本组件”脚本。</span><span class="sxs-lookup"><span data-stu-id="9d226-196">Script Task and Script Component scripts that explicitly reference ADODB.dll may not upgrade or run on machines without [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)] installed.</span></span> <span data-ttu-id="9d226-197">为了升级这些“脚本任务”或“脚本组件”脚本，建议你删除对 ADODB.dll 的依赖关系。</span><span class="sxs-lookup"><span data-stu-id="9d226-197">In order to upgrade these Script Task or Script Component scripts, it is recommended that you remove the dependency on ADODB.dll.</span></span>  <span data-ttu-id="9d226-198">Ado.Net 是建议用于托管代码（如 VB 和 C# 脚本）的替代项。</span><span class="sxs-lookup"><span data-stu-id="9d226-198">Ado.Net is the recommended alternative for managed code such as VB and C# scripts.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="9d226-199">外部资源</span><span class="sxs-lookup"><span data-stu-id="9d226-199">External Resources</span></span>  
  
-   <span data-ttu-id="9d226-200">msdn.microsoft.com 上的技术文章 [SSIS 顺利升级到 SQL Server 2012 的 5 个提示](https://go.microsoft.com/fwlink/?LinkId=235321)。</span><span class="sxs-lookup"><span data-stu-id="9d226-200">Technical article, [5 Tips for a Smooth SSIS Upgrade to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=235321), on msdn.microsoft.com.</span></span>  
  
-   <span data-ttu-id="9d226-201">blogs.msdn.com 上的博客文章： [使您的现有自定义 SSIS 扩展插件和应用程序在 Denali 下工作](https://go.microsoft.com/fwlink/?LinkId=238157)。</span><span class="sxs-lookup"><span data-stu-id="9d226-201">Blog entry, [Making your Existing Custom SSIS Extensions and Applications Work in Denali](https://go.microsoft.com/fwlink/?LinkId=238157), on blogs.msdn.com.</span></span>  
  
-   <span data-ttu-id="9d226-202">channel9.msdn.com 上的网络广播[将 SSIS 包升级到 SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674)。</span><span class="sxs-lookup"><span data-stu-id="9d226-202">Webcast, [Upgrading SSIS Packages to SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=258674), on channel9.msdn.com.</span></span>  
  
  
