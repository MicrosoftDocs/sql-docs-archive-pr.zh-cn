---
title: 使用脚本组件扩展数据流 | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- data flow task [Integration Services], components
- data flow [Integration Services], extending
- debugging [Integration Services], components
- code design mode [Integration Services]
- metadata [Integration Services]
- scripts [Integration Services], extending data flow
- data flow components [Integration Services], Script component
- components [Integration Services], data flow
- Script component [Integration Services], about Script component
- Script component [Integration Services]
- data flow [Integration Services], components
ms.assetid: 072bc4b8-363a-4131-87c3-240338e2fa5c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 30d2dadf9657ba4aac695d7de33ac535f7a7c062
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587911"
---
# <a name="extending-the-data-flow-with-the-script-component"></a><span data-ttu-id="92a4e-102">Extending the Data Flow with the Script Component</span><span class="sxs-lookup"><span data-stu-id="92a4e-102">Extending the Data Flow with the Script Component</span></span>
  <span data-ttu-id="92a4e-103">脚本组件通过以 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic 或 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] Visual C# 编写、在包运行时编译和执行的自定义代码来扩展 [!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[msCoName](../../../includes/msconame-md.md)] 包的数据流功能。</span><span class="sxs-lookup"><span data-stu-id="92a4e-103">The Script component extends the data flow capabilities of [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] packages with custom code written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# that is compiled and executed at package run time.</span></span> <span data-ttu-id="92a4e-104">当 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 包含的数据流源、转换或目标不能完全满足您的需求时，脚本组件可简化自定义数据流源、转换或目标的开发。</span><span class="sxs-lookup"><span data-stu-id="92a4e-104">The Script component simplifies the development of a custom data flow source, transformation, or destination when the sources, transformations, and destinations included with [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] do not fully satisfy your requirements.</span></span> <span data-ttu-id="92a4e-105">用预期输入和输出配置该组件后，它将为您编写所有必需的基础结构代码，这样您就可以只将注意力集中于自定义处理所需的代码。</span><span class="sxs-lookup"><span data-stu-id="92a4e-105">After you configure the component with the expected inputs and outputs, it writes all the required infrastructure code for you, letting you focus exclusively on the code that is required for your custom processing.</span></span>  
  
 <span data-ttu-id="92a4e-106">脚本组件通过 `ComponentWrapper` 和 `BufferWrapper` 项目项中自动生成的类来与包含包和数据流进行交互，这两个项目项分别是 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> 和 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="92a4e-106">A Script component interacts with the containing package and with the data flow through the autogenerated classes in the `ComponentWrapper` and `BufferWrapper` project items, which are instances of the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent> and the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> classes respectively.</span></span> <span data-ttu-id="92a4e-107">这些类使连接、变量和其他包项成为类型化对象，并管理输入和输出。</span><span class="sxs-lookup"><span data-stu-id="92a4e-107">These classes make connections, variables, and other package items available as typed objects, and manage inputs and outputs.</span></span> <span data-ttu-id="92a4e-108">脚本组件还可以使用 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 命名空间、[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 类库以及自定义程序集来实现自定义功能。</span><span class="sxs-lookup"><span data-stu-id="92a4e-108">The Script component can also use the [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] namespace and the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] class library, as well as custom assemblies, to implement custom functionality.</span></span>  
  
 <span data-ttu-id="92a4e-109">脚本组件及其生成的基础结构代码可以大大简化自定义数据流组件的开发过程。</span><span class="sxs-lookup"><span data-stu-id="92a4e-109">The Script component and the infrastructure code that it generates for you simplify significantly the process of developing a custom data flow component.</span></span> <span data-ttu-id="92a4e-110">但是，若要了解脚本组件的工作方式，你会发现阅读[开发自定义数据流组件](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md)一节是很有帮助的，从该节中可了解开发自定义数据流组件的步骤。</span><span class="sxs-lookup"><span data-stu-id="92a4e-110">However, to understand how the Script component works, you may find it useful to read the section [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md) to understand the steps that are involved in developing a custom data flow component.</span></span>  
  
 <span data-ttu-id="92a4e-111">如果您创建的是计划在多个包中重用的源、转换或目标，则应考虑开发自定义组件，而不是使用脚本组件。</span><span class="sxs-lookup"><span data-stu-id="92a4e-111">If you are creating a source, transformation, or destination that you plan to reuse in multiple packages, you should consider developing a custom component instead of using the Script component.</span></span> <span data-ttu-id="92a4e-112">有关详细信息，请参阅 [开发自定义数据流组件](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md)。</span><span class="sxs-lookup"><span data-stu-id="92a4e-112">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="92a4e-113">本节内容</span><span class="sxs-lookup"><span data-stu-id="92a4e-113">In This Section</span></span>  
 <span data-ttu-id="92a4e-114">下列主题提供有关脚本组件的详细信息。</span><span class="sxs-lookup"><span data-stu-id="92a4e-114">The following topics provide more information about the Script component.</span></span>  
  
 [<span data-ttu-id="92a4e-115">在脚本组件编辑器中配置脚本组件</span><span class="sxs-lookup"><span data-stu-id="92a4e-115">Configuring the Script Component in the Script Component Editor</span></span>](configuring-the-script-component-in-the-script-component-editor.md)  
 <span data-ttu-id="92a4e-116">在“脚本转换编辑器”中配置的属性会影响脚本组件代码的功能和性能  。</span><span class="sxs-lookup"><span data-stu-id="92a4e-116">Properties that you configure in the **Script Transformation Editor** affect the capabilities and the performance of Script component code.</span></span>  
  
 <span data-ttu-id="92a4e-117">[编码和调试脚本组件] (coding-and-debugging-the-script-component.md</span><span class="sxs-lookup"><span data-stu-id="92a4e-117">[Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md</span></span>  
 <span data-ttu-id="92a4e-118">可以使用 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) 开发环境来开发包含在脚本组件中的脚本。</span><span class="sxs-lookup"><span data-stu-id="92a4e-118">You use the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) development environment to develop the scripts contained in the Script component.</span></span>  
  
 [<span data-ttu-id="92a4e-119">了解脚本组件对象模型</span><span class="sxs-lookup"><span data-stu-id="92a4e-119">Understanding the Script Component Object Model</span></span>](understanding-the-script-component-object-model.md)  
 <span data-ttu-id="92a4e-120">新脚本组件项目包含三个带有多个类和自动生成的属性及方法的项目项。</span><span class="sxs-lookup"><span data-stu-id="92a4e-120">A new Script component project contains three project items with several classes and autogenerated properties and methods.</span></span>  
  
 [<span data-ttu-id="92a4e-121">在脚本组件中使用变量</span><span class="sxs-lookup"><span data-stu-id="92a4e-121">Using Variables in the Script Component</span></span>](using-variables-in-the-script-component.md)  
 <span data-ttu-id="92a4e-122">`ComponentWrapper` 项目项包含包变量的强类型取值函数属性。</span><span class="sxs-lookup"><span data-stu-id="92a4e-122">The `ComponentWrapper` project item contains strongly-typed accessor properties for package variables.</span></span>  
  
 [<span data-ttu-id="92a4e-123">在脚本组件中连接数据源</span><span class="sxs-lookup"><span data-stu-id="92a4e-123">Connecting to Data Sources in the Script Component</span></span>](connecting-to-data-sources-in-the-script-component.md)  
 <span data-ttu-id="92a4e-124">`ComponentWrapper` 项目项还包含在包中定义的连接的强类型取值函数属性。</span><span class="sxs-lookup"><span data-stu-id="92a4e-124">The `ComponentWrapper` project item also contains strongly-typed accessor properties for connections defined in the package.</span></span>  
  
 [<span data-ttu-id="92a4e-125">在脚本组件中引发事件</span><span class="sxs-lookup"><span data-stu-id="92a4e-125">Raising Events in the Script Component</span></span>](raising-events-in-the-script-component.md)  
 <span data-ttu-id="92a4e-126">您可以引发事件来提供问题和错误的通知。</span><span class="sxs-lookup"><span data-stu-id="92a4e-126">You can raise events to provide notification of problems and errors.</span></span>  
  
 [<span data-ttu-id="92a4e-127">脚本组件中的日志记录</span><span class="sxs-lookup"><span data-stu-id="92a4e-127">Logging in the Script Component</span></span>](logging-in-the-script-component.md)  
 <span data-ttu-id="92a4e-128">您可以向包中启用的日志提供程序记录信息。</span><span class="sxs-lookup"><span data-stu-id="92a4e-128">You can log information to log providers enabled on the package.</span></span>  
  
 [<span data-ttu-id="92a4e-129">开发特定类型的脚本组件</span><span class="sxs-lookup"><span data-stu-id="92a4e-129">Developing Specific Types of Script Components</span></span>](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)  
 <span data-ttu-id="92a4e-130">这些简单示例说明和演示如何使用脚本组件来开发数据流源、转换和目标。</span><span class="sxs-lookup"><span data-stu-id="92a4e-130">These simple examples explain and demonstrate how to use the Script component to develop data flow sources, transformations, and destinations.</span></span>  
  
 [<span data-ttu-id="92a4e-131">其他脚本组件示例</span><span class="sxs-lookup"><span data-stu-id="92a4e-131">Additional Script Component Examples</span></span>](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md)  
 <span data-ttu-id="92a4e-132">这些简单示例说明和演示脚本组件的一些可能的用法。</span><span class="sxs-lookup"><span data-stu-id="92a4e-132">These simple examples explain and demonstrate a few possible uses for the Script component.</span></span>  
  
<span data-ttu-id="92a4e-133">![Integration Services 图标 (小型) ](../../media/dts-16.gif "集成服务图标（小）")  **随时保持最新 Integration Services**</span><span class="sxs-lookup"><span data-stu-id="92a4e-133">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="92a4e-134">若要从 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 获得最新的下载内容、文章、示例和视频，以及从社区获得所选解决方案，请访问 MSDN 上的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 页：</span><span class="sxs-lookup"><span data-stu-id="92a4e-134">For the latest downloads, articles, samples, and videos from [!INCLUDE[msCoName](../../../includes/msconame-md.md)], as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="92a4e-135">访问 MSDN 上的 Integration Services 页</span><span class="sxs-lookup"><span data-stu-id="92a4e-135">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="92a4e-136">若要获得有关这些更新的自动通知，请订阅该页上提供的 RSS 源。</span><span class="sxs-lookup"><span data-stu-id="92a4e-136">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="92a4e-137">另请参阅</span><span class="sxs-lookup"><span data-stu-id="92a4e-137">See Also</span></span>  
 <span data-ttu-id="92a4e-138">[脚本组件](../../data-flow/transformations/script-component.md) </span><span class="sxs-lookup"><span data-stu-id="92a4e-138">[Script Component](../../data-flow/transformations/script-component.md) </span></span>  
 [<span data-ttu-id="92a4e-139">比较脚本任务和脚本组件</span><span class="sxs-lookup"><span data-stu-id="92a4e-139">Comparing the Script Task and the Script Component</span></span>](../comparing-the-script-task-and-the-script-component.md)  
  
  
