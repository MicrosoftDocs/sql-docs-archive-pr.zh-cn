---
title: 在脚本组件编辑器中配置脚本组件 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587915"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a><span data-ttu-id="7d120-102">在脚本组件编辑器中配置脚本组件</span><span class="sxs-lookup"><span data-stu-id="7d120-102">Configuring the Script Component in the Script Component Editor</span></span>
  <span data-ttu-id="7d120-103">在脚本组件中编写自定义代码之前，必须选择要创建的数据流组件的类型：源、转换或目标，然后在“脚本转换编辑器”中配置组件的元数据和属性  。</span><span class="sxs-lookup"><span data-stu-id="7d120-103">Before you write custom code in the Script component, you must select the type of data flow component that you want to create-source, transformation, or destination-and then configure the component's metadata and properties in the **Script Transformation Editor**.</span></span>

## <a name="selecting-the-type-of-component-to-create"></a><span data-ttu-id="7d120-104">选择要创建的组件的类型</span><span class="sxs-lookup"><span data-stu-id="7d120-104">Selecting the Type of Component to Create</span></span>
 <span data-ttu-id="7d120-105">向 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 设计器的“数据流”窗格添加脚本组件时，将显示“选择脚本组件类型”对话框  。</span><span class="sxs-lookup"><span data-stu-id="7d120-105">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears.</span></span> <span data-ttu-id="7d120-106">可将组件预配置为源、转换或目标。</span><span class="sxs-lookup"><span data-stu-id="7d120-106">You preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="7d120-107">进行此初始选择后，可以继续在“脚本转换编辑器”中配置组件  。</span><span class="sxs-lookup"><span data-stu-id="7d120-107">After you make this initial selection, you can continue to configure the component in the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="7d120-108">若要设置脚本组件的默认脚本语言，请使用“选项”对话框“常规”页的“脚本语言”选项    。</span><span class="sxs-lookup"><span data-stu-id="7d120-108">To set the default script language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="7d120-109">有关详细信息，请参阅 [General Page](../../general-page-of-integration-services-designers-options.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-109">For more information, see [General Page](../../general-page-of-integration-services-designers-options.md).</span></span>

## <a name="understanding-the-two-design-time-modes"></a><span data-ttu-id="7d120-110">了解两种设计时模式</span><span class="sxs-lookup"><span data-stu-id="7d120-110">Understanding the Two Design-Time Modes</span></span>
 <span data-ttu-id="7d120-111">在 [!INCLUDE[ssIS](../../../includes/ssis-md.md)] 设计器中，脚本组件具有两种模式：元数据设计模式和代码设计模式。</span><span class="sxs-lookup"><span data-stu-id="7d120-111">In [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata design mode and code design mode.</span></span>

 <span data-ttu-id="7d120-112">打开“脚本转换编辑器”时，组件进入元数据设计模式  。</span><span class="sxs-lookup"><span data-stu-id="7d120-112">When you open the **Script Transformation Editor**, the component enters metadata design mode.</span></span> <span data-ttu-id="7d120-113">在此模式下，可以选择输入列，并添加或配置输出和输出列，但不能编写代码。</span><span class="sxs-lookup"><span data-stu-id="7d120-113">In this mode, you can select input columns, and add or configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="7d120-114">配置完组件的元数据后，即可切换至代码设计模式编写脚本。</span><span class="sxs-lookup"><span data-stu-id="7d120-114">After you have configured the component's metadata, you can switch to code design mode to write the script.</span></span>

 <span data-ttu-id="7d120-115">单击“编辑脚本”切换到代码设计模式时，脚本组件会锁定元数据以防止其他更改，然后根据输入和输出的元数据自动生成基代码  。</span><span class="sxs-lookup"><span data-stu-id="7d120-115">When you switch to code design mode by clicking **Edit Script**, the Script component locks metadata to prevent additional changes, and then automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="7d120-116">完成自动生成代码后，即可输入您的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="7d120-116">After the autogenerated code is complete, you will be able to enter your custom code.</span></span> <span data-ttu-id="7d120-117">您的代码使用自动生成的基类来处理输入行、访问缓冲区和缓冲区中的列以及从包中检索连接管理器和变量，所有对象都作为强类型对象处理。</span><span class="sxs-lookup"><span data-stu-id="7d120-117">Your code uses the auto-generated base classes to process input rows, to access buffers and columns in the buffers, and to retrieve connection managers and variables from the package, all as strongly-typed objects.</span></span>

 <span data-ttu-id="7d120-118">在代码设计模式下输入完自定义代码后，可以切换回元数据设计模式。</span><span class="sxs-lookup"><span data-stu-id="7d120-118">After entering your custom code in code design mode, you can switch back to metadata design mode.</span></span> <span data-ttu-id="7d120-119">这不会删除您已输入的任何代码；但是，对元数据的后续更改会导致重新生成基类。</span><span class="sxs-lookup"><span data-stu-id="7d120-119">This does not delete any code that you have entered; however, subsequent changes to the metadata cause the base class to be regenerated.</span></span> <span data-ttu-id="7d120-120">然后，您的组件可能无法通过验证，因为自定义代码引用的对象可能已不存在或者已被修改。</span><span class="sxs-lookup"><span data-stu-id="7d120-120">Afterward, your component may fail validation because objects referenced by your custom code may no longer exist or may have been modified.</span></span> <span data-ttu-id="7d120-121">在这种情况下，必须手动修复代码，以便能够针对重新生成的基类进行成功编译。</span><span class="sxs-lookup"><span data-stu-id="7d120-121">In this case, you must fix your code manually so that it can be compiled successfully against the regenerated base class.</span></span>

## <a name="configuring-the-component-in-metadata-design-mode"></a><span data-ttu-id="7d120-122">在元数据设计模式下配置组件</span><span class="sxs-lookup"><span data-stu-id="7d120-122">Configuring the Component in Metadata Design Mode</span></span>
 <span data-ttu-id="7d120-123">在元数据设计模式下，可以选择输入列，添加和配置输出和输出列，但不能编写代码。</span><span class="sxs-lookup"><span data-stu-id="7d120-123">In metadata design mode, you can select input columns, and add and configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="7d120-124">配置完组件的元数据后，即可切换至代码设计模式编写脚本。</span><span class="sxs-lookup"><span data-stu-id="7d120-124">After you have configured the component's metadata, switch to code design mode to write the script.</span></span>

 <span data-ttu-id="7d120-125">在自定义编辑器中必须要配置的属性取决于脚本组件的用途。</span><span class="sxs-lookup"><span data-stu-id="7d120-125">The properties that you must configure in the custom editor depend on the usage of the Script component.</span></span> <span data-ttu-id="7d120-126">脚本组件可配置为源、转换或目标。</span><span class="sxs-lookup"><span data-stu-id="7d120-126">The Script component can be configured as a source, a transformation, or a destination.</span></span> <span data-ttu-id="7d120-127">根据其使用方式，该组件可以支持一个输入或多个输出，也可二者都支持。</span><span class="sxs-lookup"><span data-stu-id="7d120-127">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="7d120-128">要编写的自定义代码将处理输入及输出行和列。</span><span class="sxs-lookup"><span data-stu-id="7d120-128">The custom code that you will write processes the input and output rows and columns.</span></span>

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a><span data-ttu-id="7d120-129">脚本转换编辑器的“输入列”页</span><span class="sxs-lookup"><span data-stu-id="7d120-129">Inputs Columns Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="7d120-130">对于转换组件和目标组件，将显示“脚本转换编辑器”的“输入列”页；对于源组件则不显示该页   。</span><span class="sxs-lookup"><span data-stu-id="7d120-130">The **Input Columns** page of the **Script Transformation Editor** is displayed for transformations and destinations, but not for sources.</span></span> <span data-ttu-id="7d120-131">在此页中，可以选择希望用于自定义脚本的可用输入列，然后指定可对这些列进行只读还是读/写访问。</span><span class="sxs-lookup"><span data-stu-id="7d120-131">On this page, you select the available input columns that you want to make available to your custom script, and specify read-only or read/write access to them.</span></span>

 <span data-ttu-id="7d120-132">在将要基于此元数据生成的代码项目中，BufferWrapper 项目项包含每个输入的一个类，并且此类包含每个所选输入列的类型化取值函数属性。</span><span class="sxs-lookup"><span data-stu-id="7d120-132">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input, and this class contains typed accessor properties for each input column selected.</span></span> <span data-ttu-id="7d120-133">例如，如果从名为的输入中选择一个整数**CustomerID**列和一个字符串**CustomerName**列 `CustomerInput` ，则 BufferWrapper 项目项将包含一个 `CustomerInput` 派生自的类 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ，并且 `CustomerInput` 该类将公开一个名为**CustomerID**的整型属性和一个名为**CustomerName**的字符串属性。</span><span class="sxs-lookup"><span data-stu-id="7d120-133">For example, if you select an integer **CustomerID** column and a string **CustomerName** column from an input named `CustomerInput`, the BufferWrapper project item will contain a `CustomerInput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerInput` class will expose an integer property named **CustomerID** and a string property named **CustomerName**.</span></span> <span data-ttu-id="7d120-134">使用此约定可编写能够进行类型检查的代码，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d120-134">This convention makes it possible to write code with type-checking like the following:</span></span>

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 <span data-ttu-id="7d120-135">有关如何为特定类型的数据流组件配置输入列的详细信息，请参阅[开发特定类型的脚本组件](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)下的相应示例。</span><span class="sxs-lookup"><span data-stu-id="7d120-135">For more information about how to configure input columns for a specific type of data flow component, see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a><span data-ttu-id="7d120-136">脚本转换编辑器的“输入和输出”页</span><span class="sxs-lookup"><span data-stu-id="7d120-136">Inputs and Outputs Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="7d120-137">“脚本转换编辑器”的“输入和输出”页会为源、转换和目标显示   。</span><span class="sxs-lookup"><span data-stu-id="7d120-137">The **Input and Outputs** page of the **Script Transformation Editor** is displayed for sources, transformations, and destinations.</span></span> <span data-ttu-id="7d120-138">在此页中，可以添加、删除和配置要在自定义脚本中使用的输入、输出和输出列，但存在以下限制：</span><span class="sxs-lookup"><span data-stu-id="7d120-138">On this page, you add, remove, and configure inputs, outputs, and output columns that you want to use in your custom script, within the following limitations:</span></span>

-   <span data-ttu-id="7d120-139">用作源时，脚本组件没有输入，支持多个输出。</span><span class="sxs-lookup"><span data-stu-id="7d120-139">When used as a source, the Script component has no input and supports multiple outputs.</span></span>

-   <span data-ttu-id="7d120-140">用作转换时，脚本组件支持一个输入和多个输出。</span><span class="sxs-lookup"><span data-stu-id="7d120-140">When used as a transformation, the Script component supports one input and multiple outputs.</span></span>

-   <span data-ttu-id="7d120-141">用作目标时，脚本组件支持一个输入，没有输出。</span><span class="sxs-lookup"><span data-stu-id="7d120-141">When used as a destination, the Script component supports one input and has no outputs.</span></span>

 <span data-ttu-id="7d120-142">在将要基于此元数据生成的代码项目中，BufferWrapper 项目项包含每个输入和输出的一个类。</span><span class="sxs-lookup"><span data-stu-id="7d120-142">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input and output.</span></span> <span data-ttu-id="7d120-143">例如，如果创建一个名为的输出 `CustomerOutput` ，BufferWrapper 项目项将包含一个 `CustomerOutput` 派生自的类 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> ，并且 `CustomerOutput` 类将包含所创建的每个输出列的类型化取值函数属性。</span><span class="sxs-lookup"><span data-stu-id="7d120-143">For example, if you create an output named `CustomerOutput`, the BufferWrapper project item will contain a `CustomerOutput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerOutput` class will contain typed accessor properties for each output column created.</span></span>

 <span data-ttu-id="7d120-144">只能在“输入和输出”页中配置输出列  。</span><span class="sxs-lookup"><span data-stu-id="7d120-144">You can configure output columns only on the **Input and Outputs** page.</span></span> <span data-ttu-id="7d120-145">可在“输入列”页中选择转换和目标的输入列  。</span><span class="sxs-lookup"><span data-stu-id="7d120-145">You can select input columns for transformations and destinations on the **Input Columns** page.</span></span> <span data-ttu-id="7d120-146">在 BufferWrapper 项目项中创建的类型化取值函数属性对于输出列来说是只写的。</span><span class="sxs-lookup"><span data-stu-id="7d120-146">The typed accessor properties created for you in the BufferWrapper project item will be write-only for output columns.</span></span> <span data-ttu-id="7d120-147">输入列的取值函数属性将为只读还是读/写取决于在“输入列”页中为每列所选的使用类型  。</span><span class="sxs-lookup"><span data-stu-id="7d120-147">The accessor properties for input columns will be read-only or read/write depending on the usage type that you have selected for each column on the **Input Columns** page.</span></span>

 <span data-ttu-id="7d120-148">有关如何为特定类型的数据流组件配置输入和输出列的详细信息，请参阅[开发特定类型的脚本组件](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md)下的相应示例。</span><span class="sxs-lookup"><span data-stu-id="7d120-148">For more information about configuring inputs and outputs for a specific type of data flow component see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="7d120-149">虽然您无法在脚本组件中直接将输出配置为错误输出以便自动处理错误行，但必要时可通过创建附加输出并使用脚本将行定向到此输出来再现错误输出的功能。</span><span class="sxs-lookup"><span data-stu-id="7d120-149">Although you cannot directly configure an output as an error output in the Script component for automatic handling of error rows, you can reproduce the functionality of an error output by creating an additional output and using script to direct rows to this output when appropriate.</span></span> <span data-ttu-id="7d120-150">有关详细信息，请参阅[模拟脚本组件的错误输出](../../data-flow/transformations/script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-150">For more information, see [Simulating an Error Output for the Script Component](../../data-flow/transformations/script-component.md).</span></span>

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a><span data-ttu-id="7d120-151">输出的 ExclusionGroup 和 SynchronousInputID 属性</span><span class="sxs-lookup"><span data-stu-id="7d120-151">ExclusionGroup and SynchronousInputID Properties of Outputs</span></span>
 <span data-ttu-id="7d120-152">`ExclusionGroup` 属性仅在具有同步输出的转换中具有非零值，其中您的代码要执行筛选或分支跳转，并将每一行定向到共享同一非零 `ExclusionGroup` 值的输出之一。</span><span class="sxs-lookup"><span data-stu-id="7d120-152">The `ExclusionGroup` property has a non-zero value only in transformations with synchronous outputs, where your code performs filtering or branching and directs each row to one of the outputs that share the same non-zero `ExclusionGroup` value.</span></span> <span data-ttu-id="7d120-153">例如，转换可将行定向到默认输出或错误输出。</span><span class="sxs-lookup"><span data-stu-id="7d120-153">For example, the transformation can direct rows either to the default output or to an error output.</span></span> <span data-ttu-id="7d120-154">在此方案中，如果您创建附加输出，请确保将 `SynchronousInputID` 属性的值设置为与组件的输入 `ID` 相匹配的整数。</span><span class="sxs-lookup"><span data-stu-id="7d120-154">When you create additional outputs for this scenario, make sure to set the value of the `SynchronousInputID` property to the integer that matches the `ID` of the component's input.</span></span>

 <span data-ttu-id="7d120-155">`SynchronousInputID` 属性仅在具有同步输出的转换中具有非零值。</span><span class="sxs-lookup"><span data-stu-id="7d120-155">The `SynchronousInputID` property has a non-zero value only in transformations with synchronous outputs.</span></span> <span data-ttu-id="7d120-156">如果此属性的值为零，则意味着输出是异步的。</span><span class="sxs-lookup"><span data-stu-id="7d120-156">If the value of this property is zero, it means that the output is asynchronous.</span></span> <span data-ttu-id="7d120-157">对于同步输出，行将传递给所选一个或多个输出而不添加任何新行，此属性应包含组件的输入 `ID`。</span><span class="sxs-lookup"><span data-stu-id="7d120-157">For a synchronous output, where rows are passed through to the selected output or outputs without adding any new rows, this property should contain the `ID` of the component's input.</span></span>

> [!NOTE]
>  <span data-ttu-id="7d120-158">当 "**脚本转换编辑器**" 创建第一个输出时，该编辑器会将 `SynchronousInputID` 输出的属性设置为 `ID` 组件的输入的。</span><span class="sxs-lookup"><span data-stu-id="7d120-158">When the **Script Transformation Editor** creates the first output, the editor sets the `SynchronousInputID` property of the output to the `ID` of the component's input.</span></span> <span data-ttu-id="7d120-159">但是，当编辑器创建后续输出时，它会将那些输出的 `SynchronousInputID` 属性设置为零。</span><span class="sxs-lookup"><span data-stu-id="7d120-159">However, when the editor creates subsequent outputs, the editor sets the `SynchronousInputID` properties of those outputs to zero.</span></span>
> 
>  <span data-ttu-id="7d120-160">如果要创建具有同步输出的组件，则每个输出的 `SynchronousInputID` 属性必须设置为 `ID` 组件的输入的。</span><span class="sxs-lookup"><span data-stu-id="7d120-160">If you are creating a component with synchronous outputs, each output must have its `SynchronousInputID` property set to the `ID` of the component's input.</span></span> <span data-ttu-id="7d120-161">因此，编辑器在第一个输出之后创建的每个输出的 `SynchronousInputID` 值必须从零更改为组件的输入 `ID`。</span><span class="sxs-lookup"><span data-stu-id="7d120-161">Therefore, each output that the editor creates after the first output must have its `SynchronousInputID` value changed from zero to the `ID` of the component's input.</span></span>
> 
>  <span data-ttu-id="7d120-162">如果您创建的是具有异步输出的组件，则每个输出的 `SynchronousInputID` 属性必须设置为零。</span><span class="sxs-lookup"><span data-stu-id="7d120-162">If you are creating a component with asynchronous outputs, each output must have its `SynchronousInputID` property set to zero.</span></span> <span data-ttu-id="7d120-163">因此，第一个输出必须将其 `SynchronousInputID` 值从 `ID` 组件输入的更改为零。</span><span class="sxs-lookup"><span data-stu-id="7d120-163">Therefore, the first output must have its `SynchronousInputID` value changed from the `ID` of the component's input to zero.</span></span>

 <span data-ttu-id="7d120-164">有关将行定向到脚本组件中两个同步输出之一的示例，请参阅[使用脚本组件创建同步转换](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-164">For an example of directing rows to one of two synchronous outputs in the Script component, see [Creating a Synchronous Transformation with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span></span>

### <a name="object-names-in-generated-script"></a><span data-ttu-id="7d120-165">生成的脚本中的对象名称</span><span class="sxs-lookup"><span data-stu-id="7d120-165">Object Names in Generated Script</span></span>
 <span data-ttu-id="7d120-166">脚本组件会分析输入和输出的名称，还会分析输入和输出中的列的名称，并基于这些名称在 BufferWrapper 项目项中生成类和属性。</span><span class="sxs-lookup"><span data-stu-id="7d120-166">The Script component parses the names of inputs and outputs, and parse the names of columns in the inputs and outputs, and based on these names generates classes and properties in the BufferWrapper project item.</span></span> <span data-ttu-id="7d120-167">如果找到的名称包含不属于 Unicode 类别 `UppercaseLetter`、`LowercaseLetter`、`TitlecaseLetter`、`ModifierLetter`、`OtherLetter` 或 `DecimalDigitLetter` 的字符，则生成的名称中的无效字符将被删除。</span><span class="sxs-lookup"><span data-stu-id="7d120-167">If the found names include characters that do not belong to the Unicode categories `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter`, or `DecimalDigitLetter`, the invalid characters are dropped in the generated names.</span></span> <span data-ttu-id="7d120-168">例如，空格将被删除，因此名称为 FirstName 和 [First Name] 的两个输入列都会解释为具有列名 FirstName，从而产生不可预测的结果    。</span><span class="sxs-lookup"><span data-stu-id="7d120-168">For example, spaces are dropped, therefore two input columns that have the names **FirstName** and [**First Name**] are both interpreted as having the column name **FirstName**, with unpredictable results.</span></span> <span data-ttu-id="7d120-169">为了避免发生这种情况，脚本组件所使用的输入和输出的名称以及输入列和输出列的名称应仅包含本部分列出的 Unicode 类别中的字符。</span><span class="sxs-lookup"><span data-stu-id="7d120-169">To avoid this situation, the names of inputs and outputs and of input and output columns used by the Script component should contain only characters in the Unicode categories listed in this section.</span></span>

### <a name="script-page-of-the-script-transformation-editor"></a><span data-ttu-id="7d120-170">脚本转换编辑器的“脚本”页</span><span class="sxs-lookup"><span data-stu-id="7d120-170">Script Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="7d120-171">在“脚本任务编辑器”的“脚本”页中，可以为脚本任务指定唯一的名称和说明   。</span><span class="sxs-lookup"><span data-stu-id="7d120-171">On the **Script** page of the **Script Task Editor**, you assign a unique name and a description for the Script task.</span></span> <span data-ttu-id="7d120-172">还可以为以下属性赋值。</span><span class="sxs-lookup"><span data-stu-id="7d120-172">You can also assign values for the following properties.</span></span>

> [!NOTE]
>  <span data-ttu-id="7d120-173">在 [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] 和更高版本中，所有脚本都将预编译。</span><span class="sxs-lookup"><span data-stu-id="7d120-173">In [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions, all scripts are precompiled.</span></span> <span data-ttu-id="7d120-174">在早期版本中，通过设置任务的 `Precompile` 属性来指定是否对脚本进行预编译。</span><span class="sxs-lookup"><span data-stu-id="7d120-174">In previous versions, you specified whether scripts were precompiled by setting a `Precompile` property for the task.</span></span>

#### <a name="validateexternalmetadata-property"></a><span data-ttu-id="7d120-175">ValidateExternalMetadata 属性</span><span class="sxs-lookup"><span data-stu-id="7d120-175">ValidateExternalMetadata Property</span></span>
 <span data-ttu-id="7d120-176">`ValidateExternalMetadata` 属性的布尔值指定组件是应在设计时针对外部数据源执行验证，还是应推迟到运行时才验证。</span><span class="sxs-lookup"><span data-stu-id="7d120-176">The Boolean value of the `ValidateExternalMetadata` property specifies whether the component should perform validation against external data sources at design time, or whether it should postpone validation until run time.</span></span> <span data-ttu-id="7d120-177">默认情况下，此属性的值为 `True`；也就是说，在设计时和运行时都对外部元数据进行验证。</span><span class="sxs-lookup"><span data-stu-id="7d120-177">By default, the value of this property is `True`; that is, the external metadata is validated both at design time and at run time.</span></span> <span data-ttu-id="7d120-178">如果外部数据源在设计时不可用，可以将此属性的值设置为 `False`；例如，当包仅在运行时下载源或创建目标时。</span><span class="sxs-lookup"><span data-stu-id="7d120-178">You may want to set the value of this property to `False` when an external data source is not available at design time: for example, when the package downloads the source or creates the destination only at run time.</span></span>

#### <a name="readonlyvariables-and-readwritevariables-properties"></a><span data-ttu-id="7d120-179">ReadOnlyVariables 和 ReadWriteVariables 属性</span><span class="sxs-lookup"><span data-stu-id="7d120-179">ReadOnlyVariables and ReadWriteVariables Properties</span></span>
 <span data-ttu-id="7d120-180">可以输入以逗号分隔的现有变量列表作为这些属性的值，使这些变量在脚本组件代码中可用于只读或读/写访问。</span><span class="sxs-lookup"><span data-stu-id="7d120-180">You can enter comma-delimited lists of existing variables as the values of these properties to make the variables available for read-only or read/write access within the Script component code.</span></span> <span data-ttu-id="7d120-181">这些变量可在代码中通过自动生成的基类的 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> 和 <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> 属性来访问。</span><span class="sxs-lookup"><span data-stu-id="7d120-181">Variables are accessed in code through the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> and <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> properties of the autogenerated base class.</span></span> <span data-ttu-id="7d120-182">有关详细信息，请参阅[在脚本组件中使用变量](using-variables-in-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-182">For more information, see [Using Variables in the Script Component](using-variables-in-the-script-component.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="7d120-183">变量名称区分大小写。</span><span class="sxs-lookup"><span data-stu-id="7d120-183">Variable names are case-sensitive.</span></span>

#### <a name="scriptlanguage"></a><span data-ttu-id="7d120-184">ScriptLanguage</span><span class="sxs-lookup"><span data-stu-id="7d120-184">ScriptLanguage</span></span>
 <span data-ttu-id="7d120-185">您可以选择 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic 或 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# 作为脚本组件的编程语言。</span><span class="sxs-lookup"><span data-stu-id="7d120-185">You can select either [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# as the programming language for the Script component.</span></span>

#### <a name="edit-script-button"></a><span data-ttu-id="7d120-186">“编辑脚本”按钮</span><span class="sxs-lookup"><span data-stu-id="7d120-186">Edit Script Button</span></span>
 <span data-ttu-id="7d120-187">使用“编辑脚本”按钮可打开   Tools for Applications (VSTA) IDE，你可以在其中编写自定义脚本[!INCLUDE[msCoName](../../../includes/msconame-md.md)][!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="7d120-187">The **Edit Script** button opens the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE in which you write your custom script.</span></span> <span data-ttu-id="7d120-188">有关详细信息，请参阅[脚本组件的编码和调试](coding-and-debugging-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-188">For more information, see [Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md).</span></span>

### <a name="connection-managers-page-of-the-script-transformation-editor"></a><span data-ttu-id="7d120-189">脚本转换编辑器的“连接管理器”页</span><span class="sxs-lookup"><span data-stu-id="7d120-189">Connection Managers Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="7d120-190">在“脚本转换编辑器”的“连接管理器”页中，可以添加和删除要在自定义脚本中使用的连接管理器   。</span><span class="sxs-lookup"><span data-stu-id="7d120-190">On the **Connection Managers** page of the **Script Transformation Editor**, you add and remove connection managers that you want to use in your custom script.</span></span> <span data-ttu-id="7d120-191">通常，创建源或目标组件时需要引用连接管理器。</span><span class="sxs-lookup"><span data-stu-id="7d120-191">Normally you need to reference connection managers when you create a source or destination component.</span></span>

 <span data-ttu-id="7d120-192">在将要基于此元数据生成的代码项目中，`ComponentWrapper` 项目项包含一个 `Connections` 集合类，该类为每个所选连接管理器包含一个类型化取值函数属性。</span><span class="sxs-lookup"><span data-stu-id="7d120-192">In the code project that will be generated based on this metadata, the `ComponentWrapper` project item contains a `Connections` collection class that has a typed accessor property for each selected connection manager.</span></span> <span data-ttu-id="7d120-193">每个类型化取值函数属性的名称都与连接管理器本身的名称相同，该属性将返回对作为 <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100> 实例的连接管理器的引用。</span><span class="sxs-lookup"><span data-stu-id="7d120-193">Each typed accessor property has the same name as the connection manager itself and returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="7d120-194">例如，如果已在编辑器的“连接管理器”页中添加名为 `MyADONETConnection` 的连接管理器，则可在脚本中使用以下代码获取对该连接管理器的引用  ：</span><span class="sxs-lookup"><span data-stu-id="7d120-194">For example, if you have added a connection manager named `MyADONETConnection` on the **Connection Managers** page of the editor, you can obtain a reference to the connection manager in your script by using the following code:</span></span>

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 <span data-ttu-id="7d120-195">有关详细信息，请参阅[在脚本组件中连接数据源](connecting-to-data-sources-in-the-script-component.md)。</span><span class="sxs-lookup"><span data-stu-id="7d120-195">For more information, see [Connecting to Data Sources in the Script Component](connecting-to-data-sources-in-the-script-component.md).</span></span>

<span data-ttu-id="7d120-196">![Integration Services 图标 (小型) ](../../media/dts-16.gif "集成服务图标（小）")  **随时保持最新 Integration Services**</span><span class="sxs-lookup"><span data-stu-id="7d120-196">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="7d120-197">若要从 Microsoft 获得最新的下载内容、文章、示例和视频，以及从社区获得所选解决方案，请访问 MSDN 上的 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] 页：</span><span class="sxs-lookup"><span data-stu-id="7d120-197">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="7d120-198">访问 MSDN 上的 Integration Services 页</span><span class="sxs-lookup"><span data-stu-id="7d120-198">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="7d120-199">若要获得有关这些更新的自动通知，请订阅该页上提供的 RSS 源。</span><span class="sxs-lookup"><span data-stu-id="7d120-199">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="7d120-200">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7d120-200">See Also</span></span>
 [<span data-ttu-id="7d120-201">脚本组件的编码和调试</span><span class="sxs-lookup"><span data-stu-id="7d120-201">Coding and Debugging the Script Component</span></span>](coding-and-debugging-the-script-component.md)


