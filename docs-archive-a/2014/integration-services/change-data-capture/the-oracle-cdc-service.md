---
title: Oracle CDC 服务 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 47759ddc-358d-405b-acb9-189ada76ea6d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 20299b191cb0605008e3d9a724be32feec6df734
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588681"
---
# <a name="the-oracle-cdc-service"></a><span data-ttu-id="73744-102">Oracle CDC 服务</span><span class="sxs-lookup"><span data-stu-id="73744-102">The Oracle CDC Service</span></span>
  <span data-ttu-id="73744-103">Oracle CDC 服务是运行 xdbcdcsvc.exe 程序的一种 Windows 服务。</span><span class="sxs-lookup"><span data-stu-id="73744-103">The Oracle CDC Service is a Windows service running the program xdbcdcsvc.exe.</span></span> <span data-ttu-id="73744-104">Oracle CDC 服务可配置为在同一台计算机上运行多个 Windows 服务，每个服务都使用不同的 Windows 服务名称。</span><span class="sxs-lookup"><span data-stu-id="73744-104">The Oracle CDC Service can be configured to run multiple Windows services on the same computer, each one with a different Windows service name.</span></span> <span data-ttu-id="73744-105">在单个计算机上创建多个 Oracle CDC Windows 服务通常是为了在它们之间或在每个服务需要使用不同的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例时实现更好的隔离。</span><span class="sxs-lookup"><span data-stu-id="73744-105">Creating multiple Oracle CDC Windows services on a single computer is often done to achieve a better separation between them, or when each needs to work with a different [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="73744-106">Oracle CDC 服务是使用 Oracle CDC 服务配置控制台创建的，或者是通过内置于 xdbcdcsvc.exe 程序中的命令行接口定义的。</span><span class="sxs-lookup"><span data-stu-id="73744-106">An Oracle CDC Service is created using the Oracle CDC Service Configuration console or is defined through the command-line interface built into the xdbcdcsvc.exe program.</span></span> <span data-ttu-id="73744-107">在这两种情况下，创建的每个 Oracle CDC 服务都与单个实例相关联 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (可以使用**AlwaysOn**安装) 程序对该实例进行群集或镜像， (连接字符串和访问凭据) 是服务配置的一部分。</span><span class="sxs-lookup"><span data-stu-id="73744-107">In both cases, each Oracle CDC Service created is associated with a single [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance (which may be clustered or mirrored with **AlwaysOn** setup) and the connection information (connect string and access credentials) are part of the service configuration.</span></span>  
  
 <span data-ttu-id="73744-108">在某一 Oracle CDC 服务启动时，它将尝试连接到其关联的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例，获取它需要处理的 Oracle CDC 实例的列表，并且执行初始环境验证。</span><span class="sxs-lookup"><span data-stu-id="73744-108">When an Oracle CDC Service is started, it tries to connect to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance it is associated with, get the list of Oracle CDC instances it needs to handle, and performs an initial environment validation.</span></span> <span data-ttu-id="73744-109">服务启动期间出现的错误以及任何开始/停止信息始终写入 Windows 应用程序事件日志。</span><span class="sxs-lookup"><span data-stu-id="73744-109">Errors during the service startup and any start/stop information are always written to the Windows application event log.</span></span> <span data-ttu-id="73744-110">在建立与 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 的连接时，所有错误和信息消息都写入 **实例的 MSXDBCDC 数据库的** dbo.xdbcdc_trace [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 表中。</span><span class="sxs-lookup"><span data-stu-id="73744-110">When a connection to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is established, all errors and information messages are written to the **dbo.xdbcdc_trace** table in the MSXDBCDC database of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="73744-111">在启动期间执行的检查之一是验证没有具有相同名称的其他 Oracle CDC 服务当前正在工作。</span><span class="sxs-lookup"><span data-stu-id="73744-111">One of the checks made during startup is verification that no other Oracle CDC Service with the same name is currently working.</span></span> <span data-ttu-id="73744-112">如果具有相同名称的某一服务当前与其他计算机连接，则 Oracle CDC 服务将进入一个等待循环，并且等待其他服务断开连接，之后继续处理 Oracle CDC 工作。</span><span class="sxs-lookup"><span data-stu-id="73744-112">If a service with the same name is currently connected from a different computer, the Oracle CDC Service enters a wait loop, waiting for the other service to disconnect before proceeding to handle the Oracle CDC work.</span></span>  
  
 <span data-ttu-id="73744-113">在该 Oracle CDC 服务通过所有启动验证后，它将检查任何启用的 Oracle CDC 实例的 MSXDBCDC 数据库中的 **dbo.xdbcdc_databases** 表。</span><span class="sxs-lookup"><span data-stu-id="73744-113">When the Oracle CDC Service passes all the startup verifications, it checks the **dbo.xdbcdc_databases** table in the MSXDBCDC database for any enabled Oracle CDC Instances.</span></span> <span data-ttu-id="73744-114">对于每个已启用的 Oracle CDC 实例，该服务将启动一个子进程来处理该 Oracle CDC 实例。</span><span class="sxs-lookup"><span data-stu-id="73744-114">For every enabled Oracle CDC Instance, the service starts a sub-process to handle that Oracle CDC Instance.</span></span>  
  
 <span data-ttu-id="73744-115">在某一 Oracle CDC 实例启动时，它将访问与该 CDC 实例同名的 SQL Server CDC 数据库，并且从以前的运行中检索其状态。</span><span class="sxs-lookup"><span data-stu-id="73744-115">When an Oracle CDC Instance starts, it accesses the SQL Server CDC database with the same name as the CDC Instance and retrieves its state from the previous run.</span></span> <span data-ttu-id="73744-116">它还会验证一切都正常运行。</span><span class="sxs-lookup"><span data-stu-id="73744-116">It also verifies that everything is running properly.</span></span> <span data-ttu-id="73744-117">然后，它将恢复处理更改；读取 Oracle 事务日志并且写入对 CDC 数据库的更改。</span><span class="sxs-lookup"><span data-stu-id="73744-117">It then resumes processing changes; Reading the Oracle transaction logs and writing changes to the CDC database.</span></span>  
  
 <span data-ttu-id="73744-118">Oracle CDC 服务将定期监视 MSXDBCDC 数据库中的 **dbo.xdbcdc_tables** 表，以便确定是否存在对任何 Oracle CDC 实例配置的任何配置更改。</span><span class="sxs-lookup"><span data-stu-id="73744-118">The Oracle CDC Service periodically monitors the **dbo.xdbcdc_tables** table in the MSXDBCDC database to determine if there were any configuration changes to any of the Oracle CDC Instance configurations.</span></span> <span data-ttu-id="73744-119">如果找到了更改，Oracle CDC 服务会通知 Oracle CDC 实例它应该检查其配置是否有更改。</span><span class="sxs-lookup"><span data-stu-id="73744-119">If a change is found, the Oracle CDC Service notifies the Oracle CDC Instance that it should check its configuration for changes.</span></span> <span data-ttu-id="73744-120">大多数配置更改（例如添加和删除捕获实例）可在启用 Oracle CDC 实例时应用，其他更改则要求重新启动 Oracle CDC 实例。</span><span class="sxs-lookup"><span data-stu-id="73744-120">Most configuration changes, such as adding and removing capture instances can be applied while the Oracle CDC instance is enabled, others require the Oracle CDC Instance to be restarted.</span></span>  
  
 <span data-ttu-id="73744-121">当使用 Oracle CDC 设计器控制台时，会自动检测到更改。</span><span class="sxs-lookup"><span data-stu-id="73744-121">When using the Oracle CDC Designer console, changes are automatically detected.</span></span> <span data-ttu-id="73744-122">在使用 SQL 直接更新 Oracle CDC 配置时，应该为 Oracle CDC 服务调用以下过程以便通知配置更改：</span><span class="sxs-lookup"><span data-stu-id="73744-122">When updating the Oracle CDC configuration directly using SQL, the following procedure should be called for the Oracle CDC Service to notice the configuration change:</span></span>  
  
```  
DECLARE @dbname nvarchar(128) = 'HRcdc'  
EXECUTE [MSXDBCDC].[dbo].[xdbcdc_update_config_version] @dbname  
GO  
  
```  
  
 <span data-ttu-id="73744-123">Oracle CDC 实例进程在系统表 **cdc.xdbcdc_state** 中更新其状态，并且将错误信息写入 **cdc.xdbcdc_trace** 表。</span><span class="sxs-lookup"><span data-stu-id="73744-123">The Oracle CDC Instance process updates its status in the system table **cdc.xdbcdc_state** and writes error information to the **cdc.xdbcdc_trace** table.</span></span> <span data-ttu-id="73744-124">**xdbcdc_state** 表用于监视 Oracle CDC 实例的状态。</span><span class="sxs-lookup"><span data-stu-id="73744-124">The **xdbcdc_state** table is useful for monitoring the state of the Oracle CDC Instance.</span></span> <span data-ttu-id="73744-125">它提供最新的状态、不同的计数器（例如从 Oracle 读取的更改数、写入 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]的更改数、提交的写入事务的数目以及尚在传输中的事务的当前数目）和延迟指示。</span><span class="sxs-lookup"><span data-stu-id="73744-125">It provides up-to-date status, various counters (such as number of changes read from Oracle, number of changes written to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], number of committed transaction written and the current number of in-flight transactions) and latency indication.</span></span>  
  
 <span data-ttu-id="73744-126">Oracle CDC 实例配置保存在 **cdc.xdbcdc_config** 表中，该表是 Oracle CDC 设计器控制台使用的表。</span><span class="sxs-lookup"><span data-stu-id="73744-126">The Oracle CDC Instance configuration is saved in the **cdc.xdbcdc_config** table, which is the table that the Oracle CDC Designer console works with.</span></span> <span data-ttu-id="73744-127">因为在目标 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例和 CDC 数据库中找到了某一 Oracle CDC 实例的整个配置，所以，可以为该 Oracle CDC 实例创建 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 部署脚本。</span><span class="sxs-lookup"><span data-stu-id="73744-127">Because the entire configuration of an Oracle CDC Instance is found in the target [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance and CDC databases, it is possible to create [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] deployment scripts for an Oracle CDC Instance.</span></span> <span data-ttu-id="73744-128">这是使用 Oracle CDC 服务配置和 Oracle CDC 设计器控制台实现的。</span><span class="sxs-lookup"><span data-stu-id="73744-128">This is done using the Oracle CDC Service Configuration and Oracle CDC Designer consoles.</span></span>  
  
## <a name="security-considerations"></a><span data-ttu-id="73744-129">安全注意事项</span><span class="sxs-lookup"><span data-stu-id="73744-129">Security Considerations</span></span>  
 <span data-ttu-id="73744-130">下面介绍使用 Oracle CDC 服务时需遵守的安全要求。</span><span class="sxs-lookup"><span data-stu-id="73744-130">The following describes the security requirements necessary to work with the CDC Service for Oracle.</span></span>  
  
### <a name="protection-of-source-oracle-data"></a><span data-ttu-id="73744-131">源 Oracle 数据的保护</span><span class="sxs-lookup"><span data-stu-id="73744-131">Protection of Source Oracle Data</span></span>  
 <span data-ttu-id="73744-132">Oracle CDC 服务不要求对 Oracle 源数据的访问权限，并且通过确保日志挖掘凭据不对客户 Oracle 表提供 SELECT 权限，对 Oracle CDC 服务进行保护。</span><span class="sxs-lookup"><span data-stu-id="73744-132">The Oracle CDC service does not require access to Oracle source data and is protected by ensuring that the log-mining credentials do not give SELECT permission on customer Oracle tables.</span></span>  
  
### <a name="protection-of-source-oracle-change-data"></a><span data-ttu-id="73744-133">源 Oracle 更改数据的保护</span><span class="sxs-lookup"><span data-stu-id="73744-133">Protection of Source Oracle Change Data</span></span>  
 <span data-ttu-id="73744-134">向 Oracle CDC 服务提供日志挖掘凭据，允许该服务捕获对 Oracle 数据库中任何表进行的更改。</span><span class="sxs-lookup"><span data-stu-id="73744-134">The Oracle CDC service is provided with log-mining credentials that let the service capture changes made to any table in the Oracle database.</span></span> <span data-ttu-id="73744-135">更改数据不具有一般表所具有的粒度访问权限，因此，访问更改表将绕过内置的 Oracle 数据访问控制。</span><span class="sxs-lookup"><span data-stu-id="73744-135">Change data does not have the granular access permissions regular tables have, therefore accessing change data bypasses the built-in Oracle data access controls.</span></span>  
  
 <span data-ttu-id="73744-136">捕获的源 Oracle 表将在 CDC 数据库中具有含相同架构和表名称的空的镜像表。</span><span class="sxs-lookup"><span data-stu-id="73744-136">Captured source Oracle tables have empty mirror tables with the same schema and table name in CDC database.</span></span> <span data-ttu-id="73744-137">捕获的数据存储于 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 捕获实例中，并且提供与为从 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库捕获的更改相同的保护。</span><span class="sxs-lookup"><span data-stu-id="73744-137">The captured data is stored in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] capture instances and offer the same protection as is provided for changes captured from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="73744-138">若要获取对与捕获实例关联的更改数据的访问，必须为用户授予关联镜像表中的所有捕获列的选择访问权限。</span><span class="sxs-lookup"><span data-stu-id="73744-138">To gain access to the change data that is associated with a capture instance, the user must be granted select access to all the captured columns of the associated mirror table.</span></span> <span data-ttu-id="73744-139">此外，如果在创建捕获实例时指定了访问控制角色，调用者还必须是指定访问控制角色的成员。</span><span class="sxs-lookup"><span data-stu-id="73744-139">In addition, if a gating role is specified when the capture instance is created, the caller must also be a member of the specified gating role.</span></span> <span data-ttu-id="73744-140">所有数据库用户可通过公共角色访问用于访问元数据的其他常规变更数据捕获功能，但返回的元数据访问通常是使用基础源表的选择访问权限以及任何定义的访问控制角色成员身份控制的。</span><span class="sxs-lookup"><span data-stu-id="73744-140">Other general change data capture functions for accessing metadata is accessible to all database users through the public role, although access to the returned metadata is usually also gated by using select access to the underlying source tables, and by membership in any defined gating roles.</span></span>  
  
 <span data-ttu-id="73744-141">这意味着具有 **sysadmin** 固定服务器角色或 **db_owner** 固定数据库角色的用户对捕获的数据具有（默认的）完全访问权限，并且可通过访问控制角色或通过授予对捕获的列的选择访问权限授予进一步的访问权限。</span><span class="sxs-lookup"><span data-stu-id="73744-141">This means that users with the **sysadmin** fixed server role or the **db_owner** fixed database role have (by default) full access to the captured data, and further access can be granted either through gating roles or by granting select access to the captured columns.</span></span>  
  
### <a name="protection-of-source-oracle-log-mining-credentials"></a><span data-ttu-id="73744-142">源 Oracle 日志挖掘凭据的保护</span><span class="sxs-lookup"><span data-stu-id="73744-142">Protection of Source Oracle Log Mining Credentials</span></span>  
 <span data-ttu-id="73744-143">在 CDC 数据库的 cdc.xdbcdc_config 表中存储的 Oracle CDC 服务配置包含日志挖掘用户名及其关联的密码。</span><span class="sxs-lookup"><span data-stu-id="73744-143">The Oracle CDC service configuration, stored in the CDC database (in the cdc.xdbcdc_config table) includes the log mining user name and its associated password.</span></span>  
  
 <span data-ttu-id="73744-144">通过具有使用以下命令自动创建的固定名称 `xdbcdc_asym_key` 的非对称密钥，以加密方式存储日志挖掘密码：</span><span class="sxs-lookup"><span data-stu-id="73744-144">The log mining password is stored encrypted by means of an asymmetric key with the fixed name `xdbcdc_asym_key` that is automatically created with the following command:</span></span>  
  
```  
USE [<cdc-database-name>]  
CREATE ASYMMETRIC KEY xdbcdc_asym_key  
    WITH ALGORITHM = RSA_1024  
    ENCRYPTION BY PASSWORD = '<cdc-database-name><asym-key-password>'  
  
```  
  
 <span data-ttu-id="73744-145">如果使用不同的算法，则可以删除此密钥，并且可以创建具有相同名称且使用相同密码加密的新密钥。</span><span class="sxs-lookup"><span data-stu-id="73744-145">If a different algorithm is used, this key can be dropped and a new one by the same name and encrypted by the same password can be created.</span></span>  
  
 <span data-ttu-id="73744-146">非对称密钥密码是保存在路径 **HKLM\Software\Microsoft\XDBCDCSVC\\<service-name>** 下的注册表中的主密码。</span><span class="sxs-lookup"><span data-stu-id="73744-146">The asymmetric key password is the master password that is saved in the registry under the path **HKLM\Software\Microsoft\XDBCDCSVC\\<service-name>**.</span></span> <span data-ttu-id="73744-147">只有本地管理员和 Oracle CDC Windows 服务帐户才能访问该密钥。</span><span class="sxs-lookup"><span data-stu-id="73744-147">That key is accessible only to local administrators and to the Oracle CDC Windows service account.</span></span> <span data-ttu-id="73744-148">该密钥包含存储了非对称密钥密码的加密的二进制值 **AsymmetricKeyPassword** 。</span><span class="sxs-lookup"><span data-stu-id="73744-148">The key contains an encrypted binary value **AsymmetricKeyPassword** that stored the asymmetric key password.</span></span> <span data-ttu-id="73744-149">为了能够访问 Oracle 日志挖掘凭据，需要对此注册表项的访问权限。</span><span class="sxs-lookup"><span data-stu-id="73744-149">Access to this registry key is required to be able to access to the Oracle log mining credentials.</span></span>  
  
 <span data-ttu-id="73744-150">若要使用 ENCRYPTION BY PASSWORD 子句，该密码必须满足针对运行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例的计算机的 Windows 密码策略要求。</span><span class="sxs-lookup"><span data-stu-id="73744-150">To use the ENCRYPTION BY PASSWORD clause, the password must meet the Windows password policy requirements for the computer running the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="73744-151">这是通过根据该策略选择非对称密钥密码来实现的。</span><span class="sxs-lookup"><span data-stu-id="73744-151">This is done by selecting the asymmetric key password according to that policy.</span></span>  
  
 <span data-ttu-id="73744-152">如果丢失了该非对称密钥密码，则各 Oracle CDC 实例的日志挖掘凭据必须再次在 Oracle CDC 服务设计器中指定。</span><span class="sxs-lookup"><span data-stu-id="73744-152">If the asymmetric key password is lost, the log mining credentials for each of the Oracle CDC instances must be specified again in the Oracle CDC Service Designer.</span></span>  
  
 <span data-ttu-id="73744-153">在 CDC 服务检测到不具有此非对称密钥的 Oracle 实例 CDC 数据库时，或者在该密钥存在但密码不匹配时，将自动在 CDC 数据库中创建非对称密钥。</span><span class="sxs-lookup"><span data-stu-id="73744-153">The asymmetric key is automatically created in the CDC database when the CDC service detects an Oracle instance CDC database that does not have this asymmetric key or when the key exists but the password does not match.</span></span>  
  
### <a name="oracle-cdc-service-windows-service-account"></a><span data-ttu-id="73744-154">Oracle CDC 服务 Windows 服务帐户</span><span class="sxs-lookup"><span data-stu-id="73744-154">Oracle CDC Service Windows Service Account</span></span>  
 <span data-ttu-id="73744-155">用于 Oracle CDC Windows 服务的服务帐户不要求任何附加权限。</span><span class="sxs-lookup"><span data-stu-id="73744-155">The service account used with the Oracle CDC Windows service does not require any additional privileges.</span></span> <span data-ttu-id="73744-156">此帐户必须能够使用 Oracle Native Client API 和 SQL Server Native Client ODBC API。</span><span class="sxs-lookup"><span data-stu-id="73744-156">This account must be able to use both the Oracle Native Client API and the SQL Server Native Client ODBC API.</span></span> <span data-ttu-id="73744-157">它还需要能够访问注册表中的服务配置密钥（此 CDC 服务配置控制台为此设置 ACL）。</span><span class="sxs-lookup"><span data-stu-id="73744-157">It also needs to be able to access the service configuration key in the registry (this CDC Service Configuration console sets up the ACL for that).</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="73744-158">本节内容</span><span class="sxs-lookup"><span data-stu-id="73744-158">In This Section</span></span>  
  
-   [<span data-ttu-id="73744-159">高可用性支持</span><span class="sxs-lookup"><span data-stu-id="73744-159">High Availability Support</span></span>](high-availability-support.md)  
  
-   [<span data-ttu-id="73744-160">针对 CDC 服务的 SQL Server 连接所需权限</span><span class="sxs-lookup"><span data-stu-id="73744-160">SQL Server Connection Required Permissions for the CDC Service</span></span>](sql-server-connection-required-permissions-for-the-cdc-service.md)  
  
-   [<span data-ttu-id="73744-161">使用 Change Data Capture Service for Oracle by Attunity 的角色</span><span class="sxs-lookup"><span data-stu-id="73744-161">User Roles for Change Data Capture Service for Oracle by Attunity</span></span>](user-roles.md)  
  
-   [<span data-ttu-id="73744-162">使用 Oracle CDC 服务</span><span class="sxs-lookup"><span data-stu-id="73744-162">Working with the Oracle CDC Service</span></span>](the-oracle-cdc-service.md)  
  
## <a name="see-also"></a><span data-ttu-id="73744-163">另请参阅</span><span class="sxs-lookup"><span data-stu-id="73744-163">See Also</span></span>  
 <span data-ttu-id="73744-164">[如何管理本地 CDC 服务](how-to-manage-a-local-cdc-service.md) </span><span class="sxs-lookup"><span data-stu-id="73744-164">[How to Manage a Local CDC Service](how-to-manage-a-local-cdc-service.md) </span></span>  
 [<span data-ttu-id="73744-165">管理 Oracle CDC 服务</span><span class="sxs-lookup"><span data-stu-id="73744-165">Manage an Oracle CDC Service</span></span>](manage-an-oracle-cdc-service.md)  
  
  
