---
title: 选择网络协议 |Microsoft Docs
description: 比较和对比可用于连接到 SQL Server 数据库引擎的网络协议，如共享内存、TCP/IP 和命名管道。
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- shared memory [SQL Server]
- Named Pipes [SQL Server]
- TCP [SQL Server]
- network protocols [SQL Server], choosing
- protocols [SQL Server], choosing
- NWLink IPX/SPX [SQL Server]
- client configuration [SQL Server], protocols
- VIA
- Multiprotocol Net-Library [SQL Server]
- IPX/SPX [SQL Server]
- Banyan VINES
- protocols [SQL Server], client configuration
ms.assetid: 6565fb7d-b076-4447-be90-e10d0dec359a
author: rothja
ms.author: jroth
ms.openlocfilehash: 13cbfbcbef54759a16729692e4f5a649f387d059
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691454"
---
# <a name="choosing-a-network-protocol"></a><span data-ttu-id="30e35-103">选择网络协议</span><span class="sxs-lookup"><span data-stu-id="30e35-103">Choosing a Network Protocol</span></span>
  <span data-ttu-id="30e35-104">若要连接到 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] ，必须启用网络协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-104">To connect to [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] you must have a network protocol enabled.</span></span> [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="30e35-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]可以同时对多个协议的请求进行服务。</span><span class="sxs-lookup"><span data-stu-id="30e35-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can service requests on several protocols at the same time.</span></span> <span data-ttu-id="30e35-106">客户端用单个协议连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="30e35-106">Clients connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] with a single protocol.</span></span> <span data-ttu-id="30e35-107">如果客户端程序不知道 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 正在侦听哪个协议，可以配置客户端按顺序尝试多个协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-107">If the client program does not know which protocol [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is listening on, configure the client to sequentially try multiple protocols.</span></span> <span data-ttu-id="30e35-108">使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 配置管理器启用、禁用以及配置网络协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-108">Use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager to enable, disable, and configure network protocols.</span></span>  
  
## <a name="shared-memory"></a><span data-ttu-id="30e35-109">Shared Memory</span><span class="sxs-lookup"><span data-stu-id="30e35-109">Shared Memory</span></span>  
 <span data-ttu-id="30e35-110">Shared Memory 是可供使用的最简单协议，没有可配置的设置。</span><span class="sxs-lookup"><span data-stu-id="30e35-110">Shared memory is the simplest protocol to use and has no configurable settings.</span></span> <span data-ttu-id="30e35-111">由于使用 Shared Memory 协议的客户端仅可以连接到同一台计算机上运行的 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 实例，因此它对于大多数数据库活动而言是没用的。</span><span class="sxs-lookup"><span data-stu-id="30e35-111">Because clients using the shared memory protocol can only connect to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance running on the same computer, it is not useful for most database activity.</span></span> <span data-ttu-id="30e35-112">如果怀疑其他协议配置有误，请使用 Shared Memory 协议进行故障排除。</span><span class="sxs-lookup"><span data-stu-id="30e35-112">Use the shared memory protocol for troubleshooting when you suspect the other protocols are configured incorrectly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="30e35-113">使用 MDAC 2.8 或更早版本的客户端不能使用 Shared Memory 协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-113">Clients that use MDAC 2.8 or earlier cannot use shared memory protocol.</span></span> <span data-ttu-id="30e35-114">如果这些客户端尝试使用，将自动切换为 Named Pipes 协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-114">If these clients try this, they are automatically switched to the named pipes protocol.</span></span>  
  
## <a name="tcpip"></a><span data-ttu-id="30e35-115">TCP/IP</span><span class="sxs-lookup"><span data-stu-id="30e35-115">TCP/IP</span></span>  
 <span data-ttu-id="30e35-116">TCP/IP 是 Internet 上广泛使用的通用协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-116">TCP/IP is a common protocol widely used over the Internet.</span></span> <span data-ttu-id="30e35-117">它与互连网络中硬件结构和操作系统各异的计算机进行通信。</span><span class="sxs-lookup"><span data-stu-id="30e35-117">It communicates across interconnected networks of computers that have diverse hardware architectures and various operating systems.</span></span> <span data-ttu-id="30e35-118">TCP/IP 包括路由网络流量的标准，并能够提供高级安全功能。</span><span class="sxs-lookup"><span data-stu-id="30e35-118">TCP/IP includes standards for routing network traffic and offers advanced security features.</span></span> <span data-ttu-id="30e35-119">它是目前在商业中最常用的协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-119">It is the most popular protocol that is used in business today.</span></span> <span data-ttu-id="30e35-120">将计算机配置为使用 TCP/IP 可能会很复杂，但大多数联网的计算机已经配置正确。</span><span class="sxs-lookup"><span data-stu-id="30e35-120">Configuring your computer to use TCP/IP can be complex, but most networked computers are already correctly configured.</span></span> <span data-ttu-id="30e35-121">若要配置未在 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 配置管理器中出现的 TCP/IP 设置，请参阅 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 文档。</span><span class="sxs-lookup"><span data-stu-id="30e35-121">To configure the TCP/IP settings that are not exposed in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, see the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows documentation.</span></span>  
  
## <a name="named-pipes"></a><span data-ttu-id="30e35-122">命名管道</span><span class="sxs-lookup"><span data-stu-id="30e35-122">Named Pipes</span></span>  
 <span data-ttu-id="30e35-123">Named Pipes 是为局域网而开发的协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-123">Named Pipes is a protocol developed for local area networks.</span></span> <span data-ttu-id="30e35-124">内存的一部分被某个进程用来向另一个进程传递信息，因此一个进程的输出就是另一个进程的输入。</span><span class="sxs-lookup"><span data-stu-id="30e35-124">A part of memory is used by one process to pass information to another process, so that the output of one is the input of the other.</span></span> <span data-ttu-id="30e35-125">第二个进程可以是本地的（与第一个进程位于同一台计算机上），也可以是远程的（位于联网的计算机上）。</span><span class="sxs-lookup"><span data-stu-id="30e35-125">The second process can be local (on the same computer as the first) or remote (on a networked computer).</span></span>  
  
## <a name="named-pipes-vs-tcpip-sockets"></a><span data-ttu-id="30e35-126">Named Pipes 与TCP/IP 套接字</span><span class="sxs-lookup"><span data-stu-id="30e35-126">Named Pipes vs. TCP/IP Sockets</span></span>  
 <span data-ttu-id="30e35-127">在快速局域网 (LAN) 环境中，传输控制协议或 Internet 协议 (TCP/IP) 套接字客户端和 Named Pipes 客户端在性能方面不相上下。</span><span class="sxs-lookup"><span data-stu-id="30e35-127">In a fast local area network (LAN) environment, Transmission Control Protocol/Internet Protocol (TCP/IP) Sockets and Named Pipes clients are comparable with regard to performance.</span></span> <span data-ttu-id="30e35-128">但是，网络速度越慢[如在广域网 (WAN) 或拨号网络上]，TCP/IP 套接字客户端与 Named Pipes 客户端的性能差异越明显。</span><span class="sxs-lookup"><span data-stu-id="30e35-128">However, the performance difference between the TCP/IP Sockets and Named Pipes clients becomes apparent with slower networks, such as across wide area networks (WANs) or dial-up networks.</span></span> <span data-ttu-id="30e35-129">这是因为进程间通信 (IPC) 的机制在对等项间的通信方式不同。</span><span class="sxs-lookup"><span data-stu-id="30e35-129">This is because of the different ways the interprocess communication (IPC) mechanisms communicate between peers.</span></span>  
  
 <span data-ttu-id="30e35-130">对于 Named Pipes，通常网络通信交互性更强。</span><span class="sxs-lookup"><span data-stu-id="30e35-130">For named pipes, network communications are typically more interactive.</span></span> <span data-ttu-id="30e35-131">一个对等方直到另一个对等方使用读取命令请求数据时才发送数据。</span><span class="sxs-lookup"><span data-stu-id="30e35-131">A peer does not send data until another peer asks for it using a read command.</span></span> <span data-ttu-id="30e35-132">在开始读取数据前，网络读取一般包括一系列窥视 Named Pipes 的信息。</span><span class="sxs-lookup"><span data-stu-id="30e35-132">A network read typically involves a series of peek named pipes messages before it starts to read the data.</span></span> <span data-ttu-id="30e35-133">这在慢速网络中可能开销非常大，并会导致过多的网络流量，其他的网络客户端反过来也会受到影响。</span><span class="sxs-lookup"><span data-stu-id="30e35-133">These can be very costly in a slow network and cause excessive network traffic, which in turn affects other network clients.</span></span>  
  
 <span data-ttu-id="30e35-134">阐明所讨论的是本地管道还是网络管道也很重要。</span><span class="sxs-lookup"><span data-stu-id="30e35-134">It is also important to clarify if you are talking about local pipes or network pipes.</span></span> <span data-ttu-id="30e35-135">如果服务器应用程序在运行 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]实例的计算机的本地运行，则可以选择本地 Named Pipes 协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-135">If the server application is running locally on the computer that is running an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the local Named Pipes protocol is an option.</span></span> <span data-ttu-id="30e35-136">本地 Named Pipes 以内核模式运行且速度非常快。</span><span class="sxs-lookup"><span data-stu-id="30e35-136">Local named pipes runs in kernel mode and is very fast.</span></span>  
  
 <span data-ttu-id="30e35-137">对于 TCP/IP 套接字，数据传输的效率更高，开销也更少。</span><span class="sxs-lookup"><span data-stu-id="30e35-137">For TCP/IP Sockets, data transmissions are more streamlined and have less overhead.</span></span> <span data-ttu-id="30e35-138">数据传输还可以利用 TCP/IP 套接字性能增强机制的优点，例如窗口化、延迟确认等。</span><span class="sxs-lookup"><span data-stu-id="30e35-138">Data transmissions can also take advantage of TCP/IP Sockets performance enhancement mechanisms such as windowing, delayed acknowledgements, and so on.</span></span> <span data-ttu-id="30e35-139">这在慢速网络中可能非常有益。</span><span class="sxs-lookup"><span data-stu-id="30e35-139">This can be very helpful in a slow network.</span></span> <span data-ttu-id="30e35-140">对于应用程序的不同类型，这类性能差异可能非常大。</span><span class="sxs-lookup"><span data-stu-id="30e35-140">Depending on the type of applications, such performance differences can be significant.</span></span>  
  
 <span data-ttu-id="30e35-141">TCP/IP 套接字还支持积压队列。</span><span class="sxs-lookup"><span data-stu-id="30e35-141">TCP/IP Sockets also support a backlog queue.</span></span> <span data-ttu-id="30e35-142">试图连接到 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]时，与可能导致管道忙错误的 Named Pipes 相比，该队列可以带来有限的平稳效果。</span><span class="sxs-lookup"><span data-stu-id="30e35-142">This can provide a limited smoothing effect compared to named pipes that could lead to pipe-busy errors when you are trying to connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="30e35-143">通常，TCP/IP 在慢速 LAN、WAN 或拨号网络中效果较好。而当网络速度不成问题时，Named Pipes 则是更好的选择，因为其功能更强、更易于使用并具有更多的配置选项。</span><span class="sxs-lookup"><span data-stu-id="30e35-143">Generally, TCP/IP is preferred in a slow LAN, WAN, or dial-up network, whereas named pipes can be a better choice when network speed is not the issue, as it offers more functionality, ease of use, and configuration options.</span></span>  
  
## <a name="enabling-the-protocol"></a><span data-ttu-id="30e35-144">启用协议</span><span class="sxs-lookup"><span data-stu-id="30e35-144">Enabling the Protocol</span></span>  
 <span data-ttu-id="30e35-145">该协议必须在客户端和服务器上都启用才能正常工作。</span><span class="sxs-lookup"><span data-stu-id="30e35-145">The protocol must be enabled on both the client and server to work.</span></span> <span data-ttu-id="30e35-146">服务器可以同时监听所有已启用的协议的请求。</span><span class="sxs-lookup"><span data-stu-id="30e35-146">The server can listen for requests on all enabled protocols at the same time.</span></span> <span data-ttu-id="30e35-147">客户端计算机可以选取一个协议，或按照 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 配置管理器中列出的顺序尝试这些协议。</span><span class="sxs-lookup"><span data-stu-id="30e35-147">Client computers can pick one, or try the protocols in the order listed in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
 <span data-ttu-id="30e35-148">有关如何配置协议和连接到 [!INCLUDE[ssDE](../../includes/ssde-md.md)]的简短教程，请参阅 [教程：数据库引擎入门](../../relational-databases/tutorial-getting-started-with-the-database-engine.md)。</span><span class="sxs-lookup"><span data-stu-id="30e35-148">For a short tutorial about how to configure protocols and connect to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], see [Tutorial: Getting Started with the Database Engine](../../relational-databases/tutorial-getting-started-with-the-database-engine.md).</span></span>  
  
  
