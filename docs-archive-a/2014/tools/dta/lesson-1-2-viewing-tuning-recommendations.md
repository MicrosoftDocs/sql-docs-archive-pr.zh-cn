---
title: 查看优化建议 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- Database Engine [SQL Server], tutorials
ms.assetid: e4e690c9-434f-4b01-b4de-0b905323ddd6
author: stevestein
ms.author: sstein
ms.openlocfilehash: 6d938767d874edd8f14bdaa91c0cf52023478f53
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87690969"
---
# <a name="viewing-tuning-recommendations"></a><span data-ttu-id="e4d04-102">查看优化建议</span><span class="sxs-lookup"><span data-stu-id="e4d04-102">Viewing Tuning Recommendations</span></span>
  <span data-ttu-id="e4d04-103">此任务将用到[优化工作负荷](lesson-1-1-tuning-a-workload.md)中创建的优化会话。</span><span class="sxs-lookup"><span data-stu-id="e4d04-103">This task uses the tuning session that you created in [Tuning a Workload](lesson-1-1-tuning-a-workload.md).</span></span> <span data-ttu-id="e4d04-104">[!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)]使用 MyScript 脚本优化了数据库后 [!INCLUDE[tsql](../../includes/tsql-md.md)] ， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问将在 "**建议**" 选项卡上显示其结果。以下任务介绍了**Recommendations** [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问图形用户界面 (GUI) 的 "建议" 选项卡，并指导您浏览它提供的有关优化会话结果的信息。</span><span class="sxs-lookup"><span data-stu-id="e4d04-104">After you have tuned the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database by using the MyScript.sql [!INCLUDE[tsql](../../includes/tsql-md.md)] script, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor displays its results on the **Recommendations** tab. The following task introduces the **Recommendations** tab of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor graphical user interface (GUI) and guides you to explore the information it provides about the tuning session results.</span></span>  
  
### <a name="view-tuning-recommendations"></a><span data-ttu-id="e4d04-105">查看优化建议</span><span class="sxs-lookup"><span data-stu-id="e4d04-105">View tuning recommendations</span></span>  
  
1.  <span data-ttu-id="e4d04-106">启动 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问。</span><span class="sxs-lookup"><span data-stu-id="e4d04-106">Start [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor.</span></span> <span data-ttu-id="e4d04-107">请参阅 [启动数据库引擎优化顾问](../../relational-databases/performance/database-engine-tuning-advisor.md)。</span><span class="sxs-lookup"><span data-stu-id="e4d04-107">See [Launching Database Engine Tuning Advisor](../../relational-databases/performance/database-engine-tuning-advisor.md).</span></span> <span data-ttu-id="e4d04-108">请确保连接到在练习 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 优化工作负荷 [中使用的同一个](lesson-1-1-tuning-a-workload.md)实例。</span><span class="sxs-lookup"><span data-stu-id="e4d04-108">Make sure that you connect to the same [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance that you used in the practice [Tuning a Workload](lesson-1-1-tuning-a-workload.md).</span></span>  
  
2.  <span data-ttu-id="e4d04-109">在“会话监视器”\*\*\*\* 窗格中双击“MySession”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e4d04-109">Double-click **MySession** in the **Session Monitor** pane.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)]<span data-ttu-id="e4d04-110">优化顾问从上一个优化会话加载会话信息，并显示 "**建议**" 选项卡。请注意， [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问不会进行**分区建议**，因为您接受了所有优化选项默认值，并且没有在 "**优化选项**" 选项卡上选择**分区**。</span><span class="sxs-lookup"><span data-stu-id="e4d04-110">Tuning Advisor loads the session information from your previous tuning session and displays the **Recommendations** tab. Note that [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor made no **Partition Recommendations** because you accepted all the tuning option defaults and **No partitioning** was selected on the **Tuning Options** tab.</span></span>  
  
3.  <span data-ttu-id="e4d04-111">在“建议”\*\*\*\* 选项卡上，使用选项卡式页面底部的滚动条可以查看所有“索引建议”\*\*\*\* 列。</span><span class="sxs-lookup"><span data-stu-id="e4d04-111">On the **Recommendations** tab, use the scroll bar at the bottom of the tabbed page to view all of the **Index Recommendations** columns.</span></span> <span data-ttu-id="e4d04-112">每一行代表 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问建议删除或创建的一个数据库对象（索引或索引视图）。</span><span class="sxs-lookup"><span data-stu-id="e4d04-112">Each row represents a database object (indexes or indexed views) that [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor recommends be dropped or created.</span></span> <span data-ttu-id="e4d04-113">滚动到最右边的列，并单击“定义”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e4d04-113">Scroll to the right-most column and click a **Definition**.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)]<span data-ttu-id="e4d04-114">优化顾问将显示“SQL 脚本预览”窗口，从中可以查看创建或删除该行中的数据库对象的 [!INCLUDE[tsql](../../includes/tsql-md.md)] 脚本\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e4d04-114">Tuning Advisor displays a **SQL Script Preview** window where you can view the [!INCLUDE[tsql](../../includes/tsql-md.md)] script that creates or drops the database object on that row.</span></span> <span data-ttu-id="e4d04-115">单击“关闭”\*\*\*\* 按钮以关闭预览窗口。</span><span class="sxs-lookup"><span data-stu-id="e4d04-115">Click **Close** to close the preview window.</span></span>  
  
     <span data-ttu-id="e4d04-116">如果难以找到包含链接的“定义”\*\*\*\*，则请单击以清除选项卡式页面底部的“显示现有对象”\*\*\*\* 复选框，从而减少所显示的行数。</span><span class="sxs-lookup"><span data-stu-id="e4d04-116">If you are having difficulty locating a **Definition** that contains a link, click to clear the **Show existing objects** check box at the bottom of the tabbed page, which will decrease the number of rows displayed.</span></span> <span data-ttu-id="e4d04-117">如果清除此复选框，则 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问将仅显示已为其生成建议的对象。</span><span class="sxs-lookup"><span data-stu-id="e4d04-117">When you clear this checkbox, [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor shows you only the objects for which it has generated a recommendation.</span></span> <span data-ttu-id="e4d04-118">选中“显示现有对象”\*\*\*\* 复选框，可以查看 [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] 数据库中当前存在的所有数据库对象。</span><span class="sxs-lookup"><span data-stu-id="e4d04-118">Select the **Show existing objects** check box to view all the database objects that currently exist in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="e4d04-119">使用选项卡式页面右侧的滚动条可以查看所有对象。</span><span class="sxs-lookup"><span data-stu-id="e4d04-119">Use the scroll bar at the right side of the tabbed page to view all of the objects.</span></span>  
  
4.  <span data-ttu-id="e4d04-120">在“索引建议”\*\*\*\* 窗格中右键单击网格。</span><span class="sxs-lookup"><span data-stu-id="e4d04-120">Right-click the grid in the **Index Recommendations** pane.</span></span> <span data-ttu-id="e4d04-121">在右键单击后出现的菜单中，您可以选择或取消选择建议。</span><span class="sxs-lookup"><span data-stu-id="e4d04-121">This right-click menu enables you to select and deselect recommendations.</span></span> <span data-ttu-id="e4d04-122">您还可以使用此菜单更改网格文本的字体。</span><span class="sxs-lookup"><span data-stu-id="e4d04-122">It also enables you to change the font for the grid text.</span></span>  
  
5.  <span data-ttu-id="e4d04-123">单击“操作”\*\*\*\* 菜单中的“保存建议”\*\*\*\*，将所有建议保存到一个 [!INCLUDE[tsql](../../includes/tsql-md.md)] 脚本中。</span><span class="sxs-lookup"><span data-stu-id="e4d04-123">On the **Actions** menu, click **Save Recommendations** to save all of the recommendations into one [!INCLUDE[tsql](../../includes/tsql-md.md)] script.</span></span> <span data-ttu-id="e4d04-124">将脚本命名为 `MySessionRecommendations.sql`。</span><span class="sxs-lookup"><span data-stu-id="e4d04-124">Name the script `MySessionRecommendations.sql`.</span></span>  
  
     <span data-ttu-id="e4d04-125">在 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 的查询编辑器中打开 MySessionRecommendations.sql 脚本进行查看。</span><span class="sxs-lookup"><span data-stu-id="e4d04-125">Open the MySessionRecommendations.sql script in the Query Editor of [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] to view it.</span></span> <span data-ttu-id="e4d04-126">通过在查询编辑器中执行脚本，可将建议应用于 [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] 示例数据库。但现在不要执行该操作。</span><span class="sxs-lookup"><span data-stu-id="e4d04-126">You could apply the recommendations to the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] sample database by executing the script in the Query Editor, but do not do this.</span></span> <span data-ttu-id="e4d04-127">不运行该脚本，直接在查询编辑器中将其关闭。</span><span class="sxs-lookup"><span data-stu-id="e4d04-127">Close the script in Query Editor without running it.</span></span>  
  
     <span data-ttu-id="e4d04-128">另外，也可以通过单击[!INCLUDE[ssDE](../../includes/ssde-md.md)]优化顾问“操作”\*\*\*\* 菜单上的“应用建议”\*\*\*\* 选项来应用建议。但现在不要在本练习中应用这些建议。</span><span class="sxs-lookup"><span data-stu-id="e4d04-128">As an alternative, you could also apply the recommendations by clicking **Apply Recommendations** on the **Actions** menu of [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor, but do not apply these recommendations now in this practice.</span></span>  
  
6.  <span data-ttu-id="e4d04-129">如果“建议”\*\*\*\* 选项卡上存在多个建议，请清除“索引建议”\*\*\*\* 网格中列出数据库对象的某些行。</span><span class="sxs-lookup"><span data-stu-id="e4d04-129">If more than one recommendation exists on the **Recommendations** tab, clear some of the rows that list database objects in the **Index Recommendations** grid.</span></span>  
  
7.  <span data-ttu-id="e4d04-130">在 **“操作”** 菜单上，单击 **“评估建议”** 。</span><span class="sxs-lookup"><span data-stu-id="e4d04-130">On the **Actions** menu, click **Evaluate Recommendations**.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="e4d04-131">优化顾问将创建一个新的优化会话，从中可以评估 MySession 原有建议的子集。</span><span class="sxs-lookup"><span data-stu-id="e4d04-131">Tuning Advisor creates a new tuning session where you can evaluate a subset of the original recommendations from MySession.</span></span>  
  
8.  <span data-ttu-id="e4d04-132">键入 `EvaluateMySession` 新的**会话名称**，然后单击工具栏上的 "**开始分析**" 按钮。</span><span class="sxs-lookup"><span data-stu-id="e4d04-132">Type `EvaluateMySession` for your new **Session name**, and click the **Start Analysis** button on the toolbar.</span></span> <span data-ttu-id="e4d04-133">可以对新的优化会话重复步骤 2 和步骤 3 以查看其建议。</span><span class="sxs-lookup"><span data-stu-id="e4d04-133">You can repeat Steps 2 and 3 for this new tuning session to view its recommendations.</span></span>  
  
## <a name="summary"></a><span data-ttu-id="e4d04-134">摘要</span><span class="sxs-lookup"><span data-stu-id="e4d04-134">Summary</span></span>  
 <span data-ttu-id="e4d04-135">你已经查看了 MySession 优化会话的“建议”\*\*\*\* 选项卡的内容，并在新的 EvaluateMySession 优化会话中评估了其建议的子集。</span><span class="sxs-lookup"><span data-stu-id="e4d04-135">You have viewed the contents of the **Recommendations** tab for the MySession tuning session and evaluated a subset of its recommendations in the new EvaluateMySession tuning session.</span></span>  
  
 <span data-ttu-id="e4d04-136">如果在运行会话之后必须更改优化选项，则可能有必要评估优化建议的子集。</span><span class="sxs-lookup"><span data-stu-id="e4d04-136">Evaluating a subset of tuning recommendations may be necessary if you find you must change tuning options after you run a session.</span></span> <span data-ttu-id="e4d04-137">例如，如果在指定会话的优化选项时要求 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问考虑索引视图，但在生成了建议后又决定不使用索引视图。</span><span class="sxs-lookup"><span data-stu-id="e4d04-137">For example, if you ask [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor to consider indexed views when you specify tuning options for a session, but after the recommendation is generated you decide against using indexed views.</span></span> <span data-ttu-id="e4d04-138">然后，可以使用 "**操作**" 菜单上的 "**评估建议**" 选项让 [!INCLUDE[ssDE](../../includes/ssde-md.md)] 优化顾问在不考虑索引视图的情况下重新评估会话。</span><span class="sxs-lookup"><span data-stu-id="e4d04-138">You can then use the **Evaluate Recommendations** option on the **Actions** menu to have [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor re-evaluate the session without considering indexed views.</span></span> <span data-ttu-id="e4d04-139">使用“评估建议”\*\*\*\* 选项时，将假设将以前生成的建议应用于当前物理设计，以获得第二个优化会话的物理设计。</span><span class="sxs-lookup"><span data-stu-id="e4d04-139">When you use the **Evaluate Recommendations** option the previously generated recommendations are hypothetically applied to the current physical design to arrive at the physical design for the second tuning session.</span></span>  
  
 <span data-ttu-id="e4d04-140">在“报告”\*\*\*\* 选项卡中可以查看更多优化结果信息，这将在本课程的下一个任务中介绍。</span><span class="sxs-lookup"><span data-stu-id="e4d04-140">More tuning result information can be viewed in the **Reports** tab, which is described in the next task of this lesson.</span></span>  
  
## <a name="next-task-in-lesson"></a><span data-ttu-id="e4d04-141">课程中的下一个任务</span><span class="sxs-lookup"><span data-stu-id="e4d04-141">Next Task in Lesson</span></span>  
 [<span data-ttu-id="e4d04-142">查看优化报表</span><span class="sxs-lookup"><span data-stu-id="e4d04-142">Viewing Tuning Reports</span></span>](lesson-1-3-viewing-tuning-reports.md)  
  
  
