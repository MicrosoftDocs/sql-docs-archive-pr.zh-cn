---
title: 从客户端应用程序 (Analysis Services) 进行连接 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b1e0f1d4-0b87-4ad3-8172-f746fe2f16a2
author: minewiskan
ms.author: owend
ms.openlocfilehash: cb93d3a44345d750070a3dda60f82693fd61500b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689128"
---
# <a name="connect-from-client-applications-analysis-services"></a><span data-ttu-id="92aa9-102">从客户端应用程序进行连接 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="92aa9-102">Connect from client applications (Analysis Services)</span></span>
  <span data-ttu-id="92aa9-103">如果您不熟悉 Analysis Services，则在了解了本主题中的信息之后，您就可以通过常用工具和应用程序连接到现有的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="92aa9-103">If you are new to Analysis Services, use the information in this topic to connect to an existing instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] using common tools and applications.</span></span> <span data-ttu-id="92aa9-104">本主题还说明如何出于测试目的基于不同的用户标识进行连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-104">This topic also explains how to connect under different user identities for testing purposes.</span></span>  
  
-   [<span data-ttu-id="92aa9-105">使用 SQL Server Management Studio (SSMS) 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-105">Connect using SQL Server Management Studio (SSMS)</span></span>](#bkmk_SSMS)  
  
-   [<span data-ttu-id="92aa9-106">使用 Excel 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-106">Connect using Excel</span></span>](#bkmk_excel)  
  
-   [<span data-ttu-id="92aa9-107">使用 SQL Server Data Tools 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-107">Connect using SQL Server Data Tools</span></span>](#bkmk_SSDT)  
  
-   [<span data-ttu-id="92aa9-108">测试连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-108">Test connections</span></span>](#bkmk_tshoot)  
  
 <span data-ttu-id="92aa9-109">连接字符串参考文档单独提供。</span><span class="sxs-lookup"><span data-stu-id="92aa9-109">Connection string reference documentation is provided separately.</span></span> <span data-ttu-id="92aa9-110">有关详细信息，请参阅[连接字符串属性 (Analysis Services)](connection-string-properties-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-110">For more information, see [Connection String Properties &#40;Analysis Services&#41;](connection-string-properties-analysis-services.md).</span></span>  
  
 <span data-ttu-id="92aa9-111">成功的连接依赖于有效的端口配置和适当的用户权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-111">Successful connections depend on a valid port configuration and appropriate user permissions.</span></span> <span data-ttu-id="92aa9-112">要了解有关各项要求的详细信息，请单击以下链接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-112">Click the following links to learn more about each requirement.</span></span>  
  
-   [<span data-ttu-id="92aa9-113">配置 Windows 防火墙以允许 Analysis Services 访问</span><span class="sxs-lookup"><span data-stu-id="92aa9-113">Configure the Windows Firewall to Allow Analysis Services Access</span></span>](configure-the-windows-firewall-to-allow-analysis-services-access.md)  
  
-   [<span data-ttu-id="92aa9-114">授予对对象和操作的访问权限 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="92aa9-114">Authorizing access to objects and operations &#40;Analysis Services&#41;</span></span>](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)  
  
##  <a name="connect-using-sql-server-management-studio-ssms"></a><a name="bkmk_SSMS"></a> <span data-ttu-id="92aa9-115">使用 SQL Server Management Studio (SSMS) 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-115">Connect using SQL Server Management Studio (SSMS)</span></span>  
 <span data-ttu-id="92aa9-116">在 SSMS 中连接到 Analysis Services 时，能够以交互方式管理服务器实例和数据库。</span><span class="sxs-lookup"><span data-stu-id="92aa9-116">Connect to Analysis Services in SSMS to manage server instances and databases interactively.</span></span> <span data-ttu-id="92aa9-117">还可以运行 XMLA 或 MDX 查询以便执行管理任务或检索数据。</span><span class="sxs-lookup"><span data-stu-id="92aa9-117">You can also run XMLA or MDX queries to perform administrative tasks or retrieve data.</span></span> <span data-ttu-id="92aa9-118">与只在发出查询时才加载数据库的其他工具和应用程序相比，SSMS 会在您连接服务器时加载所有数据库，前提是您拥有查看数据库的权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-118">In contrast with other tools and applications that only load databases when a query is sent, SSMS loads all databases when you connect to the server, assuming you have permission to view the database.</span></span> <span data-ttu-id="92aa9-119">这意味着，如果您在服务器上保存有大量的表格数据库，所有这些数据库都会在您使用 SSMS 连接时加载至系统内存。</span><span class="sxs-lookup"><span data-stu-id="92aa9-119">This means that if you have numerous tabular databases on the server, all are loaded into system memory when you connect using SSMS.</span></span>  
  
 <span data-ttu-id="92aa9-120">您可以通过在特定用户标识下运行 SSMS、然后作为该用户连接到 Analysis Services，对权限进行测试。</span><span class="sxs-lookup"><span data-stu-id="92aa9-120">You can test permissions by running SSMS under a specific user identity and then connect to Analysis Services as that user.</span></span>  
  
 <span data-ttu-id="92aa9-121">按住 Shift 键并右键单击 **SQL Server Management Studio** 快捷方式，以便访问“以其他用户身份运行”\*\*\*\* 选项。</span><span class="sxs-lookup"><span data-stu-id="92aa9-121">Hold-down the Shift key and right-click the **SQL Server Management Studio** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="92aa9-122">启动 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="92aa9-122">Start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="92aa9-123">在 **“连接到服务器”** 对话框中，选择 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器类型。</span><span class="sxs-lookup"><span data-stu-id="92aa9-123">In the **Connect to Server** dialog box, select the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server type.</span></span>  
  
2.  <span data-ttu-id="92aa9-124">在“登录”选项卡中，通过键入运行服务器的计算机的名称来输入服务器名称。</span><span class="sxs-lookup"><span data-stu-id="92aa9-124">In the Login tab, enter the server name by typing the name of the computer on which the server is running.</span></span> <span data-ttu-id="92aa9-125">可以使用服务器的网络名称或完全限定域名指定服务器。</span><span class="sxs-lookup"><span data-stu-id="92aa9-125">You can specify the server using its network name or a fully-qualified domain name.</span></span>  
  
     <span data-ttu-id="92aa9-126">对于命名实例，必须以 servername\instance name 格式指定服务器名称。</span><span class="sxs-lookup"><span data-stu-id="92aa9-126">For a named instance, the server name must be specified in this format: servername\instance name.</span></span> <span data-ttu-id="92aa9-127">此命名约定的示例可以是网络名称为 ADV-SRV062 的服务器的 ADV-SRV062\Finance，其中，已将 Analysis Services 作为标题为 Finance 的命名实例安装。</span><span class="sxs-lookup"><span data-stu-id="92aa9-127">An example of this naming convention might be ADV-SRV062\Finance for a server that has a network name of ADV-SRV062, where Analysis Services was installed as a named instance entitled Finance.</span></span>  
  
     <span data-ttu-id="92aa9-128">对于部署在故障转移群集中的服务器，请使用 SSAS 群集的网络名称建立连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-128">For servers deployed in a failover cluster, connect using the network name of the SSAS cluster.</span></span> <span data-ttu-id="92aa9-129">此名称在 SQL Server 安装期间指定，名为 **“SQL Server 网络名称”**。</span><span class="sxs-lookup"><span data-stu-id="92aa9-129">This name is specified during SQL Server setup, as **SQL Server Network Name**.</span></span> <span data-ttu-id="92aa9-130">请注意，如果您将 SSAS 以命名实例形式安装到 Windows Server 故障转移群集 (WSFC) 上，则绝不要在连接上添加实例名称。</span><span class="sxs-lookup"><span data-stu-id="92aa9-130">Note that if you installed SSAS as a named instance onto a Windows Server Failover Cluster (WSFC), you never add the instance name on the connection.</span></span> <span data-ttu-id="92aa9-131">这一做法仅适用于 SSAS；相比之下，群集关系数据库引擎的命名实例包含实例名称。</span><span class="sxs-lookup"><span data-stu-id="92aa9-131">This practice is unique to SSAS; in contrast, a named instance of a clustered relational database engine does include the instance name.</span></span> <span data-ttu-id="92aa9-132">例如，如果您将 SSAS 和数据库引擎均安装为命名实例 (Contoso-Accounting)，SQL Server 网络名称为 SQL-CLU，则需使用“SQL-CLU”连接 SSAS，而使用“SQL-CLU\Contoso-Accounting”来连接数据库引擎。</span><span class="sxs-lookup"><span data-stu-id="92aa9-132">For example, if you installed both SSAS and the database engine as named instance (Contoso-Accounting) with a SQL Server Network Name of SQL-CLU, you would connect to SSAS using "SQL-CLU" and to the database engine as "SQL-CLU\Contoso-Accounting".</span></span> <span data-ttu-id="92aa9-133">有关更多信息和示例，请参阅 [如何安装群集 SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) 。</span><span class="sxs-lookup"><span data-stu-id="92aa9-133">See [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548) for more information and examples.</span></span>  
  
     <span data-ttu-id="92aa9-134">对于部署在网络负载平衡群集中的服务器，请使用 NLB 的虚拟服务器名称建立连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-134">For servers deployed in a network load balanced cluster, connect using the virtual server name of the NLB.</span></span>  
  
3.  <span data-ttu-id="92aa9-135">身份验证始终为 Windows 身份验证，并且用户标识始终为通过 Management Studio 进行连接的 Windows 用户。</span><span class="sxs-lookup"><span data-stu-id="92aa9-135">Authentication is always Windows authentication, and the user identity is always the Windows user who is connecting via Management Studio.</span></span>  
  
     <span data-ttu-id="92aa9-136">为了能成功连接，您必须拥有对服务器或服务器上的数据库的访问权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-136">In order for the connection to succeed, you must have permission to access the server or a database on the server.</span></span> <span data-ttu-id="92aa9-137">您想要在 Management Studio 中执行的大多数任务都要求管理权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-137">Most tasks that you want to perform in Management Studio require administrative permissions.</span></span> <span data-ttu-id="92aa9-138">请确保您用来进行连接的帐户是服务器管理员角色的成员。</span><span class="sxs-lookup"><span data-stu-id="92aa9-138">Ensure that the account you are connecting with is a member of the Server Administrator role.</span></span> <span data-ttu-id="92aa9-139">有关详细信息，请参阅[&#40;Analysis Services&#41;授予服务器管理员权限](grant-server-admin-rights-to-an-analysis-services-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-139">For more information, see [Grant Server Administrator Permissions &#40;Analysis Services&#41;](grant-server-admin-rights-to-an-analysis-services-instance.md).</span></span>  
  
4.  <span data-ttu-id="92aa9-140">单击 **“连接属性”** 以便指定特定数据库、设置超时值或加密选项。</span><span class="sxs-lookup"><span data-stu-id="92aa9-140">Click **Connection Properties** to specify a particular database, set timeout values, or encryption options.</span></span> <span data-ttu-id="92aa9-141">可选连接信息包含仅用于当前连接的连接属性。</span><span class="sxs-lookup"><span data-stu-id="92aa9-141">Optional connection information includes connection properties used for the current connection only.</span></span>  
  
5.  <span data-ttu-id="92aa9-142">单击 **“其他连接参数”** 选项卡以便设置在“连接到服务器”对话框中未提供的连接属性。</span><span class="sxs-lookup"><span data-stu-id="92aa9-142">Click **Additional Connection Parameters** tab to set connection properties not available in the Connect to Server dialog box.</span></span> <span data-ttu-id="92aa9-143">例如，您可以在文本框中键入 `Roles=Reader` 。</span><span class="sxs-lookup"><span data-stu-id="92aa9-143">For example, you might type `Roles=Reader` in the text box.</span></span>  
  
     <span data-ttu-id="92aa9-144">通过具有较少权限的角色进行连接使您可以测试该角色起作用时的数据库行为。</span><span class="sxs-lookup"><span data-stu-id="92aa9-144">Connecting through a role with less permission lets you test database behaviors when that role is in effect.</span></span>  
  
    ```  
    Provider=MSOLAP; Data Source=SERVERNAME; Initial Catalog=AdventureWorks2012; Roles=READER  
    ```  
  
##  <a name="connect-using-excel"></a><a name="bkmk_excel"></a><span data-ttu-id="92aa9-145">使用 Excel 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-145">Connect using Excel</span></span>  
 <span data-ttu-id="92aa9-146">Microsoft Excel 通常用于对业务数据进行分析。</span><span class="sxs-lookup"><span data-stu-id="92aa9-146">Microsoft Excel is often used for analyzing business data.</span></span> <span data-ttu-id="92aa9-147">作为 Excel 安装的一部分，Office 将安装 Analysis Services OLE DB 访问接口 (MSOLAP DLL)、ADOMD.NET 和其他数据访问接口，使您能够更轻松地使用网络服务器上的数据。</span><span class="sxs-lookup"><span data-stu-id="92aa9-147">As part of an Excel installation, Office installs the Analysis Services OLE DB provider (MSOLAP DLL), ADOMD.NET, and other data providers so that you can more readily use the data on your network servers.</span></span> <span data-ttu-id="92aa9-148">如果您使用的是较新版本的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 和较旧版本的 Excel，则很可能需要在连接 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]的每台工作站上安装较新的数据提供程序。</span><span class="sxs-lookup"><span data-stu-id="92aa9-148">If you are using a newer version of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] with an older version of Excel, you most likely need to install newer data providers on each workstation that connects to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="92aa9-149">有关详细信息，请参阅 [用于 Analysis Services 连接的数据提供程序](data-providers-used-for-analysis-services-connections.md) 。</span><span class="sxs-lookup"><span data-stu-id="92aa9-149">See [Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md) for more information.</span></span>  
  
 <span data-ttu-id="92aa9-150">在设置与 Analysis Services 多维数据集或表格模型数据库的连接时，Excel 会将连接信息保存到 .odc 文件中以供将来使用。</span><span class="sxs-lookup"><span data-stu-id="92aa9-150">When you set up a connection to an Analysis Services cube or tabular model database, Excel saves the connection information in .odc file for future use.</span></span> <span data-ttu-id="92aa9-151">该连接是在当前 Windows 用户的安全上下文中创建的。</span><span class="sxs-lookup"><span data-stu-id="92aa9-151">The connection is made in security context of the current Windows user.</span></span> <span data-ttu-id="92aa9-152">为了能成功连接，该用户帐户必须具有数据库的读取权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-152">The user account must have read permissions on the database in order for the connection to succeed.</span></span>  
  
 <span data-ttu-id="92aa9-153">在 Excel 工作簿中使用 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据时，查询请求期间将一直保持连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-153">When using [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data in an Excel workbook, connections are held for the duration of a query request.</span></span> <span data-ttu-id="92aa9-154">因此，从 Excel 监视查询工作负荷时，您很可能发现每个会话都存在大量持续时间很短的连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-154">This is why you are likely to see lots of connections for each session, held for very short periods of time, when monitoring a query workload from Excel.</span></span>  
  
 <span data-ttu-id="92aa9-155">您可以通过基于特定的用户标识启动 Excel 来测试权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-155">You can test permissions by starting Excel under a specific user identity.</span></span>  
  
 <span data-ttu-id="92aa9-156">按住 Shift 键并右键单击 **Excel** 快捷方式，以便访问“以其他用户身份运行”\*\*\*\* 选项。</span><span class="sxs-lookup"><span data-stu-id="92aa9-156">Hold-down the Shift key and right-click the **Excel** shortcut to access the **Run as different user** option.</span></span>  
  
1.  <span data-ttu-id="92aa9-157">在 Excel 的“数据”选项卡上，单击 **“自其他来源”**，然后单击 **“来自 Analysis Services”**。</span><span class="sxs-lookup"><span data-stu-id="92aa9-157">On the Data tab in Excel, click **From Other Sources**, and then click **From Analysis Services**.</span></span> <span data-ttu-id="92aa9-158">输入服务器名称，然后选择要查询的多维数据集或透视。</span><span class="sxs-lookup"><span data-stu-id="92aa9-158">Enter the server name, and then select a cube or perspective to query.</span></span>  
  
     <span data-ttu-id="92aa9-159">对于部署在负载平衡群集中的服务器，请使用分配给该群集的虚拟服务器名称。</span><span class="sxs-lookup"><span data-stu-id="92aa9-159">For servers deployed in a load-balanced cluster, use the virtual server name assigned to the cluster.</span></span>  
  
2.  <span data-ttu-id="92aa9-160">在 Excel 中设置连接时，可以在数据连接向导的最后一页上指定 Excel Services 的身份验证设置。</span><span class="sxs-lookup"><span data-stu-id="92aa9-160">When setting up a connection in Excel, on the last page of the Data Connection Wizard, you can specify authentication settings for Excel Services.</span></span> <span data-ttu-id="92aa9-161">这些设置用于设置应上载到包含 Excel Services 的 SharePoint 服务器的工作簿的属性。</span><span class="sxs-lookup"><span data-stu-id="92aa9-161">These settings are used to set properties on the workbook should you upload it to a SharePoint server that has Excel Services.</span></span> <span data-ttu-id="92aa9-162">数据刷新操作中会使用这些设置。</span><span class="sxs-lookup"><span data-stu-id="92aa9-162">The settings are used in data refresh operations.</span></span> <span data-ttu-id="92aa9-163">选项包括“Windows 身份验证”\*\*\*\*、“Secure Store Service”\*\*\*\*(SSS) 和“无”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="92aa9-163">Options include **Windows Authentication**, **Secure Store Service** (SSS), and **None**.</span></span>  
  
     <span data-ttu-id="92aa9-164">避免使用 **“无”**。</span><span class="sxs-lookup"><span data-stu-id="92aa9-164">Avoid using **None**.</span></span> <span data-ttu-id="92aa9-165">除非您连接到已配置 HTTP 访问的服务器，否则，Analysis Services 将不允许您在连接字符串上指定用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="92aa9-165">Analysis Services does not let you specify a user name and password on the connection string unless you are connecting to a server that has been configured for HTTP access.</span></span> <span data-ttu-id="92aa9-166">同样，除非您知道 SSS 目标应用程序 ID 将映射到一组拥有对 Analysis Services 数据库的用户访问权限的 Windows 用户凭据，否则不要使用 SSS。</span><span class="sxs-lookup"><span data-stu-id="92aa9-166">Similarly, do not use SSS unless you already know that the SSS target application ID is mapped to a set of Windows user credentials that have user access to the Analysis Services databases.</span></span> <span data-ttu-id="92aa9-167">在大多数方案中，对于来自 Excel 的 Analysis Services 连接，最佳选择是使用 Windows 身份验证的默认选项。</span><span class="sxs-lookup"><span data-stu-id="92aa9-167">For most scenarios, using the default option of Windows authentication is the best choice for an Analysis Services connection from Excel.</span></span>  
  
 <span data-ttu-id="92aa9-168">有关详细信息，请参阅 [连接到 SQL Server Analysis Services 或从其中导入数据](https://go.microsoft.com/fwlink/?linkID=215150)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-168">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
##  <a name="connect-using-sql-server-data-tools"></a><a name="bkmk_SSDT"></a><span data-ttu-id="92aa9-169">使用 SQL Server Data Tools 进行连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-169">Connect using SQL Server Data Tools</span></span>  
 <span data-ttu-id="92aa9-170">SQL Server Data Tools 用于生成 BI 解决方案，包括 Analysis Services 模型、Reporting Services 报表和 SSIS 包。</span><span class="sxs-lookup"><span data-stu-id="92aa9-170">SQL Server Data Tools is used for building BI solutions, including Analysis Services models, Reporting Services reports, and SSIS packages.</span></span> <span data-ttu-id="92aa9-171">在生成报表或包时，您可能需要指定与 Analysis Services 的连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-171">When building reports or packages, you might need to specify a connection to Analysis Services.</span></span>  
  
 <span data-ttu-id="92aa9-172">下面的链接说明如何从报表服务器项目或 Integration Services 项目连接到 Analysis Services：</span><span class="sxs-lookup"><span data-stu-id="92aa9-172">The following links explain how to connect to Analysis Services from a Report Server project or an Integration Services project:</span></span>  
  
-   [<span data-ttu-id="92aa9-173">针对 MDX 的 Analysis Services 连接类型 (SSRS)</span><span class="sxs-lookup"><span data-stu-id="92aa9-173">Analysis Services Connection Type for MDX &#40;SSRS&#41;</span></span>](../../reporting-services/report-data/analysis-services-connection-type-for-mdx-ssrs.md)  
  
-   [<span data-ttu-id="92aa9-174">Analysis Services 连接管理器</span><span class="sxs-lookup"><span data-stu-id="92aa9-174">Analysis Services Connection Manager</span></span>](../../integration-services/connection-manager/analysis-services-connection-manager.md)  
  
> [!NOTE]  
>  <span data-ttu-id="92aa9-175">在使用 SQL Server Data Tools 处理现有 Analysis Services 项目时，请记住您可以使用本地或版本控制项目脱机连接，或者在联机模式下进行连接以便在数据库正运行时更新 Analysis Services 对象。</span><span class="sxs-lookup"><span data-stu-id="92aa9-175">When using SQL Server Data Tools to work on an existing Analysis Services project, remember that you can connect offline using a local or version controlled project, or connect in online mode to update Analysis Services objects while the database is running.</span></span> <span data-ttu-id="92aa9-176">有关详细信息，请参阅 [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-176">For more information, see [Connect in Online Mode to an Analysis Services Database](../multidimensional-models/connect-in-online-mode-to-an-analysis-services-database.md).</span></span> <span data-ttu-id="92aa9-177">更常见的情况是，来自 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 的连接将处于项目模式下，这样一来，只有在您显式部署项目时才能将更改部署到数据库。</span><span class="sxs-lookup"><span data-stu-id="92aa9-177">More commonly, connections from [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] are in project mode, where changes are deployed to the database only when you explicitly deploy the project.</span></span>  
  
##  <a name="test-connections"></a><a name="bkmk_tshoot"></a><span data-ttu-id="92aa9-178">测试连接</span><span class="sxs-lookup"><span data-stu-id="92aa9-178">Test connections</span></span>  
 <span data-ttu-id="92aa9-179">您可以使用 SQL Server Profiler 来监视与 Analysis Services 的连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-179">You can use SQL Server Profiler to monitor connections to Analysis Services.</span></span> <span data-ttu-id="92aa9-180">Audit Login 和 Audit Logout 事件提供连接证据。</span><span class="sxs-lookup"><span data-stu-id="92aa9-180">The Audit Login and Audit Logout events provide evidence of a connection.</span></span> <span data-ttu-id="92aa9-181">标识列指示进行连接所基于的安全上下文。</span><span class="sxs-lookup"><span data-stu-id="92aa9-181">The identity column indicates the security context under which the connection is made.</span></span>  
  
1.  <span data-ttu-id="92aa9-182">在 Analysis Services 实例上启动 **SQL Server Profiler** ，然后开始一个新跟踪。</span><span class="sxs-lookup"><span data-stu-id="92aa9-182">Start **SQL Server Profiler** on the Analysis Services instance and then start a new trace.</span></span>  
  
2.  <span data-ttu-id="92aa9-183">在“事件选择”中，确认在“安全审核”部分中选中了 `Audit Login` 和 `Audit Logout`。</span><span class="sxs-lookup"><span data-stu-id="92aa9-183">In Events Selection, verify that `Audit Login` and `Audit Logout` are checked in the Security Audit section.</span></span>  
  
3.  <span data-ttu-id="92aa9-184">通过某一应用程序服务（例如 SharePoint 或 Reporting Services）从远程客户端计算机连接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="92aa9-184">Connect to Analysis Services via an application service (such as SharePoint or Reporting Services) from a remote client computer.</span></span> <span data-ttu-id="92aa9-185">Audit Login 事件将显示连接到 Analysis Services 的用户的标识。</span><span class="sxs-lookup"><span data-stu-id="92aa9-185">The Audit Login event will show the identity of the user connecting to Analysis Services.</span></span>  
  
 <span data-ttu-id="92aa9-186">连接错误常常源于不完整或无效的服务器配置。</span><span class="sxs-lookup"><span data-stu-id="92aa9-186">Connection errors are often traced to an incomplete or invalid server configuration.</span></span> <span data-ttu-id="92aa9-187">应始终首先检查服务器配置：</span><span class="sxs-lookup"><span data-stu-id="92aa9-187">Always check server configuration first:</span></span>  
  
-   <span data-ttu-id="92aa9-188">从远程计算机对服务器执行 Ping 操作以便确保它允许远程连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-188">Ping the server from a remote computer to ensure it allows remote connections.</span></span>  
  
-   <span data-ttu-id="92aa9-189">**服务器上的防火墙规则允许来自相同域中客户端的入站连接**</span><span class="sxs-lookup"><span data-stu-id="92aa9-189">**Firewall rules on the server allow inbound connections from clients in the same domain**</span></span>  
  
     <span data-ttu-id="92aa9-190">除 PowerPivot for SharePoint 之外，所有与远程服务器的连接都要求您将防火墙配置为允许访问 Analysis Services 正在侦听的端口。</span><span class="sxs-lookup"><span data-stu-id="92aa9-190">With the exception of PowerPivot for SharePoint, all connections to a remote server require that you have configured the firewall to allow access to the port that Analysis Services is listening on.</span></span> <span data-ttu-id="92aa9-191">如果您遇到连接错误，请验证端口是否可访问以及是否授予对相应数据库的用户权限。</span><span class="sxs-lookup"><span data-stu-id="92aa9-191">If you are getting connection errors, verify that the port is accessible and that user permissions are granted to the appropriate databases.</span></span>  
  
     <span data-ttu-id="92aa9-192">若要进行测试，请在远程计算机上使用 Excel 或 SSMS，并且指定 Analysis Services 实例使用的 IP 地址和端口。</span><span class="sxs-lookup"><span data-stu-id="92aa9-192">To test, use Excel or SSMS to on a remote computer, specifying the IP address and port used by the Analysis Services instance.</span></span> <span data-ttu-id="92aa9-193">如果您可以连接，则防火墙规则对实例是有效的并且实例允许远程连接。</span><span class="sxs-lookup"><span data-stu-id="92aa9-193">If you can connection, the firewall rules are valid for the instance and the instance allows remote connections.</span></span>  
  
     <span data-ttu-id="92aa9-194">此外，在使用 TCP/IP 作为连接协议时，请记住 Analysis Services 要求客户端连接源自相同的域或可信域。</span><span class="sxs-lookup"><span data-stu-id="92aa9-194">Also, when using TCP/IP for the connection protocol, remember that Analysis Services requires client connections originate from the same domain or a trusted domain.</span></span> <span data-ttu-id="92aa9-195">如果连接穿过了安全边界，您很可能需要配置 HTTP 访问。</span><span class="sxs-lookup"><span data-stu-id="92aa9-195">If connections flow across security boundaries, you will most likely need to configure HTTP access.</span></span> <span data-ttu-id="92aa9-196">有关详细信息，请参阅 [在 Internet Information Services (IIS) 8.0 上配置对 Analysis Services 的 HTTP 访问](configure-http-access-to-analysis-services-on-iis-8-0.md)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-196">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
-   <span data-ttu-id="92aa9-197">某些工具可以连接，而其他工具却不能？</span><span class="sxs-lookup"><span data-stu-id="92aa9-197">Can you connect using some tools but not others?</span></span> <span data-ttu-id="92aa9-198">该问题可能是客户端库的版本错误导致的。</span><span class="sxs-lookup"><span data-stu-id="92aa9-198">The problem might be the wrong version of a client library.</span></span> <span data-ttu-id="92aa9-199">您可以从 SQL Server 功能包下载页获取客户端库。</span><span class="sxs-lookup"><span data-stu-id="92aa9-199">You can get client libraries from the SQL Server Feature Pack download page.</span></span>  
  
 <span data-ttu-id="92aa9-200">可帮助您解决连接失败的资源包括以下资源：</span><span class="sxs-lookup"><span data-stu-id="92aa9-200">Resources that can help you resolve connection failures include the following:</span></span>  
  
 <span data-ttu-id="92aa9-201">[解决 SQL Server 2005 Analysis Services 连接方案中的常见连接问题](https://technet.microsoft.com/library/cc917670.aspx)。</span><span class="sxs-lookup"><span data-stu-id="92aa9-201">[Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://technet.microsoft.com/library/cc917670.aspx).</span></span> <span data-ttu-id="92aa9-202">本文档是几年前撰写的，但文中提及的信息和方法现在仍然适用。</span><span class="sxs-lookup"><span data-stu-id="92aa9-202">This document is a few years old, but the information and methodologies still apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="92aa9-203">另请参阅</span><span class="sxs-lookup"><span data-stu-id="92aa9-203">See Also</span></span>  
 <span data-ttu-id="92aa9-204">[连接到 Analysis Services](connect-to-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="92aa9-204">[Connect to Analysis Services](connect-to-analysis-services.md) </span></span>  
 <span data-ttu-id="92aa9-205">[Analysis Services 支持的身份验证方法](authentication-methodologies-supported-by-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="92aa9-205">[Authentication methodologies supported by Analysis Services](authentication-methodologies-supported-by-analysis-services.md) </span></span>  
 <span data-ttu-id="92aa9-206">[模拟 &#40;SSAS 表格&#41;](../tabular-models/impersonation-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="92aa9-206">[Impersonation &#40;SSAS Tabular&#41;](../tabular-models/impersonation-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="92aa9-207">创建数据源（SSAS 多维）</span><span class="sxs-lookup"><span data-stu-id="92aa9-207">Create a Data Source &#40;SSAS Multidimensional&#41;</span></span>](../multidimensional-models/create-a-data-source-ssas-multidimensional.md)  
  
  
