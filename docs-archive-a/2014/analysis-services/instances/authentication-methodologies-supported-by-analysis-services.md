---
title: Analysis Services 支持的身份验证方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b7aee903-d33a-4c20-86c2-aa013a50949f
author: minewiskan
ms.author: owend
ms.openlocfilehash: e3ce8dfc47b2c57fcc8ae336160ff81f87a8a157
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587095"
---
# <a name="authentication-methodologies-supported-by-analysis-services"></a><span data-ttu-id="8a0d0-102">Analysis Services 支持的身份验证方法</span><span class="sxs-lookup"><span data-stu-id="8a0d0-102">Authentication methodologies supported by Analysis Services</span></span>
  <span data-ttu-id="8a0d0-103">从客户端应用程序到 Analysis Services 实例的连接需要 Windows 身份验证（集成）。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-103">Connections from a client application to an Analysis Services instance require Windows authentication (integrated).</span></span> <span data-ttu-id="8a0d0-104">您可以使用以下任意方法提供 Windows 用户标识：</span><span class="sxs-lookup"><span data-stu-id="8a0d0-104">You can provide a Windows user identity using any of the following methods:</span></span>  
  
-   <span data-ttu-id="8a0d0-105">NTLM</span><span class="sxs-lookup"><span data-stu-id="8a0d0-105">NTLM</span></span>  
  
-   <span data-ttu-id="8a0d0-106">Kerberos（请参阅 [Kerberos 约束委派配置 Analysis Services](configure-analysis-services-for-kerberos-constrained-delegation.md)）</span><span class="sxs-lookup"><span data-stu-id="8a0d0-106">Kerberos (see [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md))</span></span>  
  
-   <span data-ttu-id="8a0d0-107">连接字符串上的 EffectiveUserName</span><span class="sxs-lookup"><span data-stu-id="8a0d0-107">EffectiveUserName on the connection string</span></span>  
  
-   <span data-ttu-id="8a0d0-108">基本或匿名（要求针对 HTTP 访问进行配置）</span><span class="sxs-lookup"><span data-stu-id="8a0d0-108">Basic or Anonymous (requires configuration for HTTP access)</span></span>  
  
-   <span data-ttu-id="8a0d0-109">已存储凭据</span><span class="sxs-lookup"><span data-stu-id="8a0d0-109">Stored credentials</span></span>  
  
 <span data-ttu-id="8a0d0-110">请注意，不支持声明身份验证。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-110">Notice that Claims authentication is not supported.</span></span> <span data-ttu-id="8a0d0-111">不能使用 Windows 声明令牌访问 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-111">You cannot use a Windows Claims token to access Analysis Services.</span></span> <span data-ttu-id="8a0d0-112">Analysis Services 客户端库仅使用 Windows 安全原则。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-112">The Analysis Services client libraries only work with Windows security principles.</span></span> <span data-ttu-id="8a0d0-113">如果您的 BI 解决方案包括声明标识，您需要为每个用户提供 Windows 标识影子帐户，或者使用存储凭据访问 Analysis Services 数据。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-113">If your BI solution includes claims identities, you will need Windows identity shadow accounts for each user, or use stored credentials to access Analysis Services data.</span></span>  
  
 <span data-ttu-id="8a0d0-114">有关 BI 和 Analysis Services 身份验证流的详细信息，请参阅 [Microsoft BI 身份验证和标识委托](https://go.microsoft.com/fwlink/?LinkID=286576)。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-114">For more information about BI and Analysis Services authentication flows, see [Microsoft BI Authentication and Identity Delegation](https://go.microsoft.com/fwlink/?LinkID=286576).</span></span>  
  
##  <a name="understanding-your-authentication-alternatives"></a><a name="bkmk_auth"></a><span data-ttu-id="8a0d0-115">了解身份验证备用方案</span><span class="sxs-lookup"><span data-stu-id="8a0d0-115">Understanding your authentication alternatives</span></span>  
 <span data-ttu-id="8a0d0-116">连接到 Analysis Services 数据库需要 Windows 用户或组标识和关联的权限。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-116">Connecting to an Analysis Services database requires a Windows user or group identity and associated permissions.</span></span> <span data-ttu-id="8a0d0-117">该标识可能是需要查看报表的任何人使用的常规用途登录名，但是更可能包含单个用户的标识。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-117">The identity might be a general purpose login used by anyone who needs to view a report, but a more likely scenario includes the identity of individual users.</span></span>  
  
 <span data-ttu-id="8a0d0-118">通常，表格或多维模型基于发出请求的用户将具有不同的数据访问级别（按对象或在数据本身内）。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-118">Often, a tabular or multidimensional model will have different levels of data access, by object or within the data itself, based on who is making the request.</span></span> <span data-ttu-id="8a0d0-119">为满足此要求，您可以使用 NTLM、Kerberos、EffectiveUserName 或基本身份验证。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-119">To meet this requirement, you can use NTLM, Kerberos, EffectiveUserName, or Basic authentication.</span></span> <span data-ttu-id="8a0d0-120">所有这些技术都提供了使用每个连接传递不同用户标识的方法。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-120">All of these techniques offer an approach for passing in different user identities with each connection.</span></span> <span data-ttu-id="8a0d0-121">但是，这些选项的大部分受单跃点的限制。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-121">However, most of these choices are subject to a single hop limitation.</span></span> <span data-ttu-id="8a0d0-122">只有具有委托的 Kerberos 允许原始用户标识跨多个计算机连接流到远程服务器上的后端数据存储区。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-122">Only Kerberos with delegation allows the original user identity to flow across multiple computer connections to a backend data store on a remote server.</span></span>  
  
 <span data-ttu-id="8a0d0-123">**NTLM**</span><span class="sxs-lookup"><span data-stu-id="8a0d0-123">**NTLM**</span></span>  
  
 <span data-ttu-id="8a0d0-124">对于指定 `SSPI=Negotiate`的连接，NTLM 是当 Kerberos 域控制器不可用时使用的备份身份验证子系统。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-124">For connections that specify `SSPI=Negotiate`, NTLM is the backup authentication subsystem used when a Kerberos domain controller is not available.</span></span> <span data-ttu-id="8a0d0-125">在 NTLM 下，只要请求是从客户端到服务器的直接连接，请求连接的用户具有对资源的权限且客户端和服务器计算机位于同一域中，则任何用户或客户端应用程序都可以访问服务器资源。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-125">Under NTLM, any user or client application can access a server resource as long as the request is a direct connection from a client to the server, the person requesting the connection has permission to the resource, and the client and server computers are in the same domain.</span></span>  
  
 <span data-ttu-id="8a0d0-126">在多层解决方案中，NLTM 的单个跃点限制可能是主要约束。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-126">In multi-tier solutions, the single hop restriction of NLTM can be a major constraint.</span></span> <span data-ttu-id="8a0d0-127">可以在恰好一台远程服务器上模拟发出请求的用户标识，但不能进一步传播。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-127">The user identity making the request can be impersonated on exactly one remote server, but travels no further.</span></span> <span data-ttu-id="8a0d0-128">如果当前操作要求在多台计算机上运行的服务，您需要配置 Kerberos 约束委派，以重用后端服务器上的安全令牌。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-128">If the current operation requires services running on multiple computers, you will need to configure Kerberos constrained delegation to reuse the security token on backend servers.</span></span> <span data-ttu-id="8a0d0-129">或者，您可以使用存储的凭据或基本身份验证来传入通过单跃点连接的新标识信息。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-129">Alternatively, you can use stored credentials or Basic authentication to pass in new identity information over a single hop connection.</span></span>  
  
 <span data-ttu-id="8a0d0-130">**Kerberos 身份验证和 Kerberos 约束委派**</span><span class="sxs-lookup"><span data-stu-id="8a0d0-130">**Kerberos Authentication and Kerberos Constrained Delegation**</span></span>  
  
 <span data-ttu-id="8a0d0-131">Kerberos 身份验证是 Active Directory 域中 Windows 集成安全性的基础。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-131">Kerberos authentication is the basis of Windows integrated security in Active Directory domains.</span></span> <span data-ttu-id="8a0d0-132">与 NTLM 一样，Kerberos 下的模拟受单跃点的限制，除非您启用委托。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-132">As with NTLM, impersonation under Kerberos is limited to a single hop unless you enable delegation.</span></span>  
  
 <span data-ttu-id="8a0d0-133">为了支持多跃点连接，Kerberos 提供约束委派和非约束委派，但是对于大多数方案，约束委派能更好保证安全性。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-133">To support multi-hop connections, Kerberos provides both constrained and unconstrained delegation, but for most scenarios, constrained delegation is considered a security best practice.</span></span> <span data-ttu-id="8a0d0-134">约束委派允许服务将用户标识的安全令牌传递给远程计算机上的指定下级服务。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-134">Constrained delegation allows a service to pass the security token of the user identity to a designated down-level service on a remote computer.</span></span> <span data-ttu-id="8a0d0-135">对于多层应用程序，通常要求将来自中间层应用程序服务器的用户标识委托给某个后端数据库（如 Analysis Services）。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-135">For multi-tier applications, delegating a user identity from a middle tier application server to a backend database such as Analysis Services is a common requirement.</span></span> <span data-ttu-id="8a0d0-136">例如，基于用户标识返回不同数据的表格或多维模型可能要求来自中间层服务的标识委托，以避免用户重新输入凭据或以其他方式获取安全凭据。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-136">For example, a tabular or multidimensional model that returns different data based on user identity would require identity delegation from a middle tier service to avoid having the user re-enter credentials, or getting security credentials some other way.</span></span>  
  
 <span data-ttu-id="8a0d0-137">约束委派需要在 Active Directory 中进行额外配置，其中请求的发送端和接收端上的服务均被显式授权用于委托。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-137">Constrained delegation requires additional configuration in Active Directory, where services on both the sending and receiving end of the request are explicitly authorized for delegation.</span></span> <span data-ttu-id="8a0d0-138">尽管之前存在配置成本，但是配置服务后，将在 Active Directory 中独立管理密码更新。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-138">Although there are configuration costs up front, once the service is configured, password updates are managed independently in Active Directory.</span></span> <span data-ttu-id="8a0d0-139">您不必在应用程序中更新存储的帐户信息，如果使用存储的凭据选项（后文将详细说明），则需要这样做。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-139">You do not need to update stored account information in applications, as you would if using the stored credentials option described further on.</span></span>  
  
 <span data-ttu-id="8a0d0-140">有关针对约束委派配置 Analysis Services 的详细信息，请参阅 [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-140">For more information about configuring Analysis Services for constrained delegation, see [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8a0d0-141">Windows Server 2012 支持跨域的约束委派。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-141">Windows Server 2012 supports constrained delegation across domains.</span></span> <span data-ttu-id="8a0d0-142">相反，在更低功能级别上的域（如 Windows Server 2008 或 2008 R2）中配置 Kerberos 约束委派要求客户端和服务器计算机是同一域的成员。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-142">In contrast, configuring Kerberos constrained delegation in domains at lower functional levels, such as Windows Server 2008 or 2008 R2, require both client and server computers to be members of the same domain.</span></span>  
  
 <span data-ttu-id="8a0d0-143">**EffectiveUserName**</span><span class="sxs-lookup"><span data-stu-id="8a0d0-143">**EffectiveUserName**</span></span>  
  
 <span data-ttu-id="8a0d0-144">EffectiveUserName 是用于将标识信息传递给 Analysis Services 的连接字符串属性。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-144">EffectiveUserName is a connection string property used for passing identity information to Analysis Services.</span></span> <span data-ttu-id="8a0d0-145">PowerPivot for SharePoint 使用它在使用日志中记录用户活动。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-145">PowerPivot for SharePoint uses it to record user activity in the usage logs.</span></span> <span data-ttu-id="8a0d0-146">Excel Services 和 PerformancePoint Services 可使用它检索 SharePoint 中的工作簿或仪表板使用的数据。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-146">Excel Services and PerformancePoint Services can use it to retrieve data used by workbooks or dashboards in SharePoint.</span></span> <span data-ttu-id="8a0d0-147">还可以在对 Analysis Services 实例执行操作的自定义应用程序或脚本中使用它。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-147">It can also be used in custom applications or scripts that perform operations on an Analysis Services instance.</span></span>  
  
 <span data-ttu-id="8a0d0-148">有关在 SharePoint 中使用 EffectiveUserName 的详细信息，请参阅 [在 SharePoint Server 2010 中使用 Analysis Services EffectiveUserName](https://go.microsoft.com/fwlink/?LinkId=311905)。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-148">For more information about using EffectiveUserName in SharePoint, see [Use Analysis Services EffectiveUserName in SharePoint Server 2010](https://go.microsoft.com/fwlink/?LinkId=311905).</span></span>  
  
 <span data-ttu-id="8a0d0-149">**基本身份验证和匿名用户**</span><span class="sxs-lookup"><span data-stu-id="8a0d0-149">**Basic Authentication and Anonymous User**</span></span>  
  
 <span data-ttu-id="8a0d0-150">基本身份验证还提供作为特定用户连接到后端服务器的第四种方法。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-150">Basic authentication provides yet a fourth alternative for connecting to a backend server as a specific user.</span></span> <span data-ttu-id="8a0d0-151">使用基本身份验证，在连接字符串上传递 Windows 用户名和密码，引入其他网络加密要求以确保在传输中保护敏感信息。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-151">Using Basic authentication, the Windows user name and password are passed on the connection string, introducing additional wire encryption requirements to ensure sensitive information is protected while in transit.</span></span> <span data-ttu-id="8a0d0-152">使用基本身份验证的重要优势是身份验证请求可以跨域边界。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-152">An important advantage to using Basic authentication is that the authentication request can cross domain boundaries.</span></span>  
  
 <span data-ttu-id="8a0d0-153">对于匿名身份验证，您可以将匿名用户标识设置为某一特定的 Windows 用户帐户（默认为 IUSR_GUEST）或者某一应用程序池标识。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-153">For Anonymous authentication, you can set the anonymous user identity to a specific Windows user account (IUSR_GUEST by default) or an application pool identity.</span></span> <span data-ttu-id="8a0d0-154">该匿名用户帐户将用于 Analysis Services 连接，并且必须对 Analysis Services 实例具有数据访问权限。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-154">The anonymous user account will be used on the Analysis Services connection, and must have data access permissions on the Analysis Services instance.</span></span> <span data-ttu-id="8a0d0-155">使用此方法时，在连接上只使用与匿名帐户关联的用户标识。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-155">When you use this approach, only the user identity associated with the Anonymous account is used on the connection.</span></span> <span data-ttu-id="8a0d0-156">如果您的应用程序要求额外标识管理，您需要选择其他方法或使用您提供的标识管理解决方案进行补充。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-156">If your application requires additional identity management, you will need to choose one of the other approaches, or supplement with an identity management solution that you provide.</span></span>  
  
 <span data-ttu-id="8a0d0-157">只有在针对 HTTP 访问配置 Analysis Services，使用 IIS 和 msmdpump.dll 建立连接后，基本身份验证和匿名用户才可用。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-157">Basic and Anonymous are available only when you configure Analysis Services for HTTP access, using IIS and the msmdpump.dll to establish the connection.</span></span> <span data-ttu-id="8a0d0-158">有关详细信息，请参阅 [在 Internet Information Services (IIS) 8.0 上配置对 Analysis Services 的 HTTP 访问](configure-http-access-to-analysis-services-on-iis-8-0.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-158">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="8a0d0-159">**存储的凭据**</span><span class="sxs-lookup"><span data-stu-id="8a0d0-159">**Stored Credentials**</span></span>  
  
 <span data-ttu-id="8a0d0-160">大多数中间层应用程序服务包括存储用户名和密码的功能以便以后从下级数据存储区检索数据，例如 Analysis Services 或 SQL Server 关系引擎。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-160">Most middle tier application services include functionality for storing a user name and password subsequently used to retrieve data from a down-level data store, such as Analysis Services or the SQL Server relational engine.</span></span> <span data-ttu-id="8a0d0-161">这样，存储的凭据就提供了检索数据的第五种方法。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-161">As such, stored credentials provide a fifth alternative for retrieving data.</span></span> <span data-ttu-id="8a0d0-162">此方法的不足之处在于引入了与保持用户名和密码最新关联的维护开销以及在连接上使用单个标识。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-162">Limitations with this approach include maintenance overhead associated with keeping user names and passwords up to date, and the use of a single identity on the connection.</span></span> <span data-ttu-id="8a0d0-163">如果您的解决方案需要原始调用方的标识，存储的凭据将无法满足要求。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-163">If your solution requires the identity of the original caller, then stored credentials would not be a viable alternative.</span></span>  
  
 <span data-ttu-id="8a0d0-164">有关存储的凭据的详细信息，请参阅[创建、修改和删除共享数据源 (SSRS)](../../reporting-services/report-data/create-modify-and-delete-shared-data-sources-ssrs.md) 和[将 Excel Services 与 SharePoint Server 2013 中的 Secure Store Service 一起使用](https://go.microsoft.com/fwlink/?LinkID=309869)。</span><span class="sxs-lookup"><span data-stu-id="8a0d0-164">For more information about stored credentials, see [Create, Modify, and Delete Shared Data Sources &#40;SSRS&#41;](../../reporting-services/report-data/create-modify-and-delete-shared-data-sources-ssrs.md) and [Use Excel Services with Secure Store Service in SharePoint Server 2013](https://go.microsoft.com/fwlink/?LinkID=309869).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8a0d0-165">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8a0d0-165">See Also</span></span>  
 <span data-ttu-id="8a0d0-166">[将模拟用于传输安全](https://go.microsoft.com/fwlink/?LinkId=311727) </span><span class="sxs-lookup"><span data-stu-id="8a0d0-166">[Using Impersonation with Transport Security](https://go.microsoft.com/fwlink/?LinkId=311727) </span></span>  
 <span data-ttu-id="8a0d0-167">[配置 HTTP 访问 Internet Information Services &#40;IIS 上的 Analysis Services&#41; 8。0](configure-http-access-to-analysis-services-on-iis-8-0.md) </span><span class="sxs-lookup"><span data-stu-id="8a0d0-167">[Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md) </span></span>  
 <span data-ttu-id="8a0d0-168">[为 Kerberos 约束委派配置 Analysis Services](configure-analysis-services-for-kerberos-constrained-delegation.md) </span><span class="sxs-lookup"><span data-stu-id="8a0d0-168">[Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md) </span></span>  
 <span data-ttu-id="8a0d0-169">[Analysis Services 实例的 SPN 注册](spn-registration-for-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="8a0d0-169">[SPN registration for an Analysis Services instance](spn-registration-for-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="8a0d0-170">连接到 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="8a0d0-170">Connect to Analysis Services</span></span>](connect-to-analysis-services.md)  
  
  
