---
title: " (Analysis Services) 的连接字符串属性 |Microsoft Docs"
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 29a00a41-5b0d-44b2-8a86-1b16fe507768
author: minewiskan
ms.author: owend
ms.openlocfilehash: 304525ae8a3ff5c910916352ff354cde8c354d44
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689117"
---
# <a name="connection-string-properties-analysis-services"></a><span data-ttu-id="5a8c5-102">连接字符串属性 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="5a8c5-102">Connection String Properties (Analysis Services)</span></span>
  <span data-ttu-id="5a8c5-103">本主题介绍的是连接字符串属性，您可能需要在某个设计器或管理工具中设置这些属性，也可能在连接到并查询 Analysis Services 数据的客户端应用程序所生成的连接字符串中看到这些属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-103">This topic documents the connection string properties you might set in one of the designer or administration tools, or see in connection strings built by client applications that connect to and query Analysis Services data.</span></span> <span data-ttu-id="5a8c5-104">因此，它仅涉及可用属性的一部分。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-104">As such, it covers just a subset of the available properties.</span></span> <span data-ttu-id="5a8c5-105">完整列表包含各种服务器和数据库属性，允许您为特定应用程序自定义连接，而不管实例或数据库在服务器上是如何配置的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-105">The complete list includes numerous server and database properties, allowing you to customize a connection for a specific application, independent of how the instance or database is configured on the server.</span></span>  
  
 <span data-ttu-id="5a8c5-106">在应用程序代码中生成自定义连接字符串的开发人员应查看 ADOMD.NET 客户端的 API 文档，以查看更详细的列表： <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A></span><span class="sxs-lookup"><span data-stu-id="5a8c5-106">Developers who build custom connection strings in application code should review the API documentation for ADOMD.NET client to view a more detailed list: <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A></span></span>  
  
 <span data-ttu-id="5a8c5-107">本主题中所述的属性由以下 Analysis Services 客户端库使用：ADOMD.NET、AMO 和 Analysis Services 的 OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-107">The properties described in this topic are used by the Analysis Services client libraries, ADOMD.NET, AMO, and the OLE DB provider for Analysis Services.</span></span> <span data-ttu-id="5a8c5-108">大多数连接字符串属性可用于所有这三种客户端库。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-108">The majority of connection string properties can be used with all three client libraries.</span></span> <span data-ttu-id="5a8c5-109">例外将专门进行说明。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-109">Exceptions are called out in the description.</span></span>  
  
 <span data-ttu-id="5a8c5-110">本主题包含下列部分：</span><span class="sxs-lookup"><span data-stu-id="5a8c5-110">This topic includes the following sections:</span></span>  
  
 [<span data-ttu-id="5a8c5-111">常用的连接参数</span><span class="sxs-lookup"><span data-stu-id="5a8c5-111">Connection parameters in common use</span></span>](#bkmk_common)  
  
 [<span data-ttu-id="5a8c5-112">身份验证和安全</span><span class="sxs-lookup"><span data-stu-id="5a8c5-112">Authentication and Security</span></span>](#bkmk_auth)  
  
 [<span data-ttu-id="5a8c5-113">特殊用途参数</span><span class="sxs-lookup"><span data-stu-id="5a8c5-113">Special-purpose parameters</span></span>](#bkmk_special)  
  
 [<span data-ttu-id="5a8c5-114">保留以供将来使用</span><span class="sxs-lookup"><span data-stu-id="5a8c5-114">Reserved for future use</span></span>](#bkmk_reserved)  
  
 [<span data-ttu-id="5a8c5-115">连接字符串示例</span><span class="sxs-lookup"><span data-stu-id="5a8c5-115">Example connection strings</span></span>](#bkmk_examples)  
  
 [<span data-ttu-id="5a8c5-116">Analysis Services 中使用的连接字符串格式</span><span class="sxs-lookup"><span data-stu-id="5a8c5-116">Connection string formats used in Analysis Services</span></span>](#bkmk_supportedstrings)  
  
 [<span data-ttu-id="5a8c5-117">加密连接字符串</span><span class="sxs-lookup"><span data-stu-id="5a8c5-117">Encrypting Connection Strings</span></span>](#bkmk_encrypt)  
  
> [!NOTE]  
>  <span data-ttu-id="5a8c5-118">设置属性时，如果您无意中两次设置同一属性，则在连接字符串中使用后设置的那个属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-118">When setting properties, if you inadvertently set the same property twice, the last one in the connection string is used.</span></span>  
  
 <span data-ttu-id="5a8c5-119">有关如何在现有 Microsoft 应用程序中指定 Analysis Services 连接的详细信息，请参阅[从客户端应用程序 &#40;Analysis Services&#41; 连接](connect-from-client-applications-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-119">For more information about how to specify an Analysis Services connection in existing Microsoft applications, see [Connect from client applications &#40;Analysis Services&#41;](connect-from-client-applications-analysis-services.md).</span></span>  
  
##  <a name="connection-parameters-in-common-use"></a><a name="bkmk_common"></a> <span data-ttu-id="5a8c5-120">常用的连接参数</span><span class="sxs-lookup"><span data-stu-id="5a8c5-120">Connection parameters in common use</span></span>  
 <span data-ttu-id="5a8c5-121">下表介绍在生成连接字符串时最常用的那些属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-121">The following table describes those properties most often used when building a connection string.</span></span>  
  
|<span data-ttu-id="5a8c5-122">属性</span><span class="sxs-lookup"><span data-stu-id="5a8c5-122">Property</span></span>|<span data-ttu-id="5a8c5-123">说明</span><span class="sxs-lookup"><span data-stu-id="5a8c5-123">Description</span></span>|<span data-ttu-id="5a8c5-124">示例</span><span class="sxs-lookup"><span data-stu-id="5a8c5-124">Example</span></span>|  
|--------------|-----------------|-------------|  
|<span data-ttu-id="5a8c5-125">`Data Source` 或 `DataSource`</span><span class="sxs-lookup"><span data-stu-id="5a8c5-125">`Data Source` or `DataSource`</span></span>|<span data-ttu-id="5a8c5-126">指定服务器实例。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-126">Specifies the server instance.</span></span> <span data-ttu-id="5a8c5-127">此属性对于所有连接都是必需的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-127">This property is required for all connections.</span></span> <span data-ttu-id="5a8c5-128">有效值包括服务器的网络名称或 IP 地址、local 或 localhost（对本地连接）、URL（如果针对 HTTP 或 HTTPS 访问配置了服务器）或本地多维数据集 (.cub) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-128">Valid values include the network name or IP address of the server, local or localhost for local connections, a URL if the server is configured for HTTP or HTTPS access, or the name of a local cube (.cub) file.</span></span>|<span data-ttu-id="5a8c5-129">对于默认实例和端口 (TCP 2383) 为`Data source=AW-SRV01` 。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-129">`Data source=AW-SRV01` for the default instance and port (TCP 2383).</span></span><br /><br /> <span data-ttu-id="5a8c5-130">对于命名实例 ($Finance) 和固定端口为`Data source=AW-SRV01$Finance:8081` 。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-130">`Data source=AW-SRV01$Finance:8081` for a named instance ($Finance) and fixed port.</span></span><br /><br /> <span data-ttu-id="5a8c5-131">对于采用默认实例和端口的完全限定的域名为`Data source=AW-SRV01.corp.Adventure-Works.com` 。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-131">`Data source=AW-SRV01.corp.Adventure-Works.com` for a fully qualified domain name, assuming the default instance and port.</span></span><br /><br /> <span data-ttu-id="5a8c5-132">对于服务器的 IP 地址为`Data source=172.16.254.1` ，它绕过 DNS 服务器查找，对于解决连接问题很有用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-132">`Data source=172.16.254.1` for an IP address of the server, bypassing DNS server lookup, useful for troubleshooting connection problems.</span></span>|  
|<span data-ttu-id="5a8c5-133">`Initial Catalog` 或 `Catalog`</span><span class="sxs-lookup"><span data-stu-id="5a8c5-133">`Initial Catalog` or `Catalog`</span></span>|<span data-ttu-id="5a8c5-134">指定要连接到的 Analysis Services 数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-134">Specifies the name of the Analysis Services database to connect to.</span></span> <span data-ttu-id="5a8c5-135">该数据库必须部署在 Analysis Services 上，并且您必须有权连接到它。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-135">The database must be deployed on Analysis Services, and you must have permission to connect to it.</span></span> <span data-ttu-id="5a8c5-136">此属性对于 AMO 连接是可选的，但是对于 ADOMD.NET 是必需的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-136">This property is optional for AMO connections, but required for ADOMD.NET.</span></span>|`Initial catalog=AdventureWorks2012`|  
|`Provider`|<span data-ttu-id="5a8c5-137">有效值包括 MSOLAP 或 MSOLAP。 \<version> ，其中 \<version> 为3、4或5。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-137">Valid values include MSOLAP or MSOLAP.\<version>, where \<version> is either 3, 4, or 5.</span></span> <span data-ttu-id="5a8c5-138">在文件系统上，数据访问接口名称对于 SQL Server 2012 版本为 msolap110.dll，对于 SQL Server 2008 和 2008 R2 为 msolap100.dll，对于 SQL Server 2005 为 msolap90.dll。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-138">On the file system, the data provider name is msolap110.dll for SQL Server 2012 version, msolap100.dll for SQL Server 2008 and 2008 R2, and msolap90.dll for SQL Server 2005.</span></span><br /><br /> <span data-ttu-id="5a8c5-139">当前版本为 MSOLAP.5。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-139">The current version is MSOLAP.5.</span></span> <span data-ttu-id="5a8c5-140">此属性是可选的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-140">This property is optional.</span></span> <span data-ttu-id="5a8c5-141">默认情况下，客户端库从注册表读取 OLE DB 访问接口的当前版本。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-141">By default, the client libraries read the current version of the OLE DB provider from the registry.</span></span> <span data-ttu-id="5a8c5-142">仅在需要特定版本的数据访问接口时才需要设置此属性，例如要连接到 SQL Server 2008 实例。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-142">You only need to set this property if you require a specific version of the data provider, for example to connect to a SQL Server 2008 instance.</span></span><br /><br /> <span data-ttu-id="5a8c5-143">数据访问接口对应于 SQL Server 的版本。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-143">Data providers correspond to versions of SQL Server.</span></span> <span data-ttu-id="5a8c5-144">如果您的组织使用当前和以前版本的 Analysis Services，很可能需要指定在手动创建的连接字符串上使用哪个访问接口。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-144">If your organization uses current and previous versions of Analysis Services, you will most likely need to specify which provider to use on connection strings that you create by hand.</span></span> <span data-ttu-id="5a8c5-145">您可能还需要在缺少所需版本的计算机上下载并安装特定版本的数据访问接口。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-145">You might also need to download and install specific versions of the data provider on computers that do not have the version you need.</span></span> <span data-ttu-id="5a8c5-146">可以从下载中心的“SQL Server 功能包”页上下载 OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-146">You can download the OLE DB provider from SQL Server Feature Pack pages on the download center.</span></span> <span data-ttu-id="5a8c5-147">转到 [Microsoft SQL Server 2012 功能包](https://go.microsoft.com/fwlink/?LinkId=296473) 以下载用于 SQL Server 2012 的 Analysis Services OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-147">Go to [Microsoft SQL Server 2012 Feature Pack](https://go.microsoft.com/fwlink/?LinkId=296473) to download the Analysis Services OLE DB provider for SQL Server 2012.</span></span><br /><br /> <span data-ttu-id="5a8c5-148">MSOLAP.4 已在 SQL Server 2008 和 SQL Server 2008 R2 中发布。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-148">MSOLAP.4 was released in both SQL Server 2008 and SQL Server 2008 R2.</span></span> <span data-ttu-id="5a8c5-149">2008 R2 版本支持 PowerPivot 工作簿，有时需要在 SharePoint 服务器上手动安装。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-149">The 2008 R2 version supports PowerPivot workbooks and sometimes needs to be installed manually on SharePoint servers.</span></span> <span data-ttu-id="5a8c5-150">要区分这些版本，您必须检查访问接口的文件属性中的内部版本号：转到 Program files\Microsoft Analysis Services\AS OLEDB\10。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-150">To distinguish between these versions, you must check the build number in the file properties of the provider: Go to Program files\Microsoft Analysis Services\AS OLEDB\10.</span></span> <span data-ttu-id="5a8c5-151">右键单击 msolap110.dll，然后选择“ **属性**”。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-151">Right-click msolap110.dll and select **Properties**.</span></span> <span data-ttu-id="5a8c5-152">单击“详细信息”。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-152">Click **Details**.</span></span> <span data-ttu-id="5a8c5-153">查看文件版本信息。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-153">View the file version information.</span></span> <span data-ttu-id="5a8c5-154">版本应包含10.50。\<buildnumber></span><span class="sxs-lookup"><span data-stu-id="5a8c5-154">The version should include 10.50.\<buildnumber></span></span> <span data-ttu-id="5a8c5-155">对于 SQL Server 2008 R2。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-155">for SQL Server 2008 R2.</span></span> <span data-ttu-id="5a8c5-156">有关详细信息，请参阅 [在 SharePoint 服务器上安装 Analysis Services OLE DB 提供程序](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) 和 [用于 Analysis Services 连接的数据提供程序](data-providers-used-for-analysis-services-connections.md)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-156">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) and [Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md).</span></span><br /><br /> <span data-ttu-id="5a8c5-157">MSOLAP SQL Server 2005 中发布。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-157">MSOLAP.3 was released in SQL Server 2005.</span></span><br /><br /> <span data-ttu-id="5a8c5-158">在 SQL Server 2008 中释放了 MSOLAP，并再次 SQL Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="5a8c5-158">MSOLAP.4 was released in SQL Server 2008 and again SQL Server 2008 R2</span></span><br /><br /> <span data-ttu-id="5a8c5-159">SQL Server 2012 中发布了 MSOLAP 5</span><span class="sxs-lookup"><span data-stu-id="5a8c5-159">MSOLAP.5 was released in SQL Server 2012</span></span>|<span data-ttu-id="5a8c5-160">`Provider=MSOLAP.3` 用于需要 SQL Server 2005 版本的 Analysis Services OLE DB 访问接口的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-160">`Provider=MSOLAP.3` is used for connections that require the SQL Server 2005 version of the OLE DB provider for Analysis Services.</span></span>|  
|`Cube`|<span data-ttu-id="5a8c5-161">多维数据集名称或透视名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-161">Cube name or perspective name.</span></span> <span data-ttu-id="5a8c5-162">一个数据库可以包含多个多维数据集和透视。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-162">A database can contain multiple cubes and perspectives.</span></span> <span data-ttu-id="5a8c5-163">可以使用多个目标时，在连接字符串上包括多维数据集或透视名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-163">When multiple targets are possible, include the cube or perspective name on the connection string.</span></span>|<span data-ttu-id="5a8c5-164">`Cube=SalesPerspective` 显示你可以使用 Cube 连接字符串属性指定多维数据集名称或透视名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-164">`Cube=SalesPerspective` shows that you can use the Cube connection string property to specify either the name of a cube or the name of a perspective.</span></span>|  
  
##  <a name="authentication-and-security"></a><a name="bkmk_auth"></a><span data-ttu-id="5a8c5-165">身份验证和安全</span><span class="sxs-lookup"><span data-stu-id="5a8c5-165">Authentication and Security</span></span>  
 <span data-ttu-id="5a8c5-166">本节介绍与身份验证和加密有关的连接字符串属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-166">This section includes connection string properties related to authentication and encryption.</span></span> <span data-ttu-id="5a8c5-167">Analysis Services 只使用 Windows 身份验证，但是您可以在连接字符串上设置属性以传递特定用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-167">Analysis Services uses Windows Authentication only, but you can set properties on the connection string to pass in a specific user name and password.</span></span>  
  
 <span data-ttu-id="5a8c5-168">按字母顺序列出属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-168">Properties are listed in alphabetical order.</span></span>  
  
|<span data-ttu-id="5a8c5-169">属性</span><span class="sxs-lookup"><span data-stu-id="5a8c5-169">Property</span></span>|<span data-ttu-id="5a8c5-170">说明</span><span class="sxs-lookup"><span data-stu-id="5a8c5-170">Description</span></span>|  
|--------------|-----------------|  
|`EffectiveUserName`|<span data-ttu-id="5a8c5-171">必须在服务器上模拟最终用户标识时使用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-171">Use when an end user identity must be impersonated on the server.</span></span> <span data-ttu-id="5a8c5-172">按“域\用户”格式指定帐户。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-172">Specify the account in a domain\user format.</span></span> <span data-ttu-id="5a8c5-173">要使用此属性，调用方在 Analysis Services 中必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-173">To use this property, the caller must have administrative permissions in Analysis Services.</span></span> <span data-ttu-id="5a8c5-174">有关在 SharePoint 的 Excel 工作簿中使用此属性的详细信息，请参阅 [在 SharePoint Server 2013 中使用 Analysis Services EffectiveUserName](https://go.microsoft.com/fwlink/?LinkId=311905)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-174">For more information about using this property in an Excel workbook from SharePoint, see [Use Analysis Services EffectiveUserName in SharePoint Server 2013](https://go.microsoft.com/fwlink/?LinkId=311905).</span></span> <span data-ttu-id="5a8c5-175">有关如何将此属性用于 Reporting Services 的说明，请参阅 [使用 EffectiveUserName 在 SSAS 中模拟](https://www.artisconsulting.com/blogs/greggalloway/2010/4/1/using-effectiveusername-to-impersonate-in-ssas)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-175">For an illustration of how this property is used with Reporting Services, see [Using EffectiveUserName To Impersonate in SSAS](https://www.artisconsulting.com/blogs/greggalloway/2010/4/1/using-effectiveusername-to-impersonate-in-ssas).</span></span><br /><br /> <span data-ttu-id="5a8c5-176">在 PowerPivot for SharePoint 安装中使用 `EffectiveUserName` 来捕获使用情况信息。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-176">`EffectiveUserName` is used in a PowerPivot for SharePoint installation to capture usage information.</span></span> <span data-ttu-id="5a8c5-177">将用户标识提供给服务器以便可以在日志文件中记录包含用户标识的事件或错误。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-177">The user identity is provided to the server so that events or errors that include user identity can be recorded in the log files.</span></span> <span data-ttu-id="5a8c5-178">在 PowerPivot 中，它不用于授权目的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-178">In the case of PowerPivot, it is not used for authorization purposes.</span></span>|  
|<span data-ttu-id="5a8c5-179">**Encrypt Password**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-179">**Encrypt Password**</span></span>|<span data-ttu-id="5a8c5-180">指定是否使用本地密码来加密本地多维数据集。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-180">Specifies whether a local password is to be used to encrypt local cubes.</span></span> <span data-ttu-id="5a8c5-181">有效值为 True 或 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-181">Valid values are True or False.</span></span> <span data-ttu-id="5a8c5-182">默认值为 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-182">The default is False.</span></span>|  
|`Encryption Password`|<span data-ttu-id="5a8c5-183">用于对加密的本地多维数据集进行解密的密码。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-183">The password used to decrypt an encrypted local cube.</span></span> <span data-ttu-id="5a8c5-184">默认值为空。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-184">Default value is empty.</span></span> <span data-ttu-id="5a8c5-185">此值必须由用户显式设置。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-185">This value must be explicitly set by the user.</span></span>|  
|`Impersonation Level`|<span data-ttu-id="5a8c5-186">指示模拟客户端时服务器可以使用的模拟级别。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-186">Indicates the level of impersonation that the server is allowed to use when impersonating the client.</span></span> <span data-ttu-id="5a8c5-187">有效值包括：</span><span class="sxs-lookup"><span data-stu-id="5a8c5-187">Valid values include:</span></span><br /><br /> <span data-ttu-id="5a8c5-188">**Anonymous**：客户端对于服务器是匿名的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-188">**Anonymous**: The client is anonymous to the server.</span></span> <span data-ttu-id="5a8c5-189">服务器进程无法获取有关客户端的信息，并且不能模拟客户端。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-189">The server process cannot obtain information about the client, nor can the client be impersonated.</span></span><br /><br /> <span data-ttu-id="5a8c5-190">**标识**：服务器进程可以获取客户端标识。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-190">**Identify**: The server process can get the client identity.</span></span> <span data-ttu-id="5a8c5-191">服务器可以模拟客户端标识进行授权，但不能作为客户端访问系统对象。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-191">The server can impersonate the client identity for authorization purposes but cannot access system objects as the client.</span></span><br /><br /> <span data-ttu-id="5a8c5-192">**模拟**：这是默认值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-192">**Impersonate**: This is the default value.</span></span> <span data-ttu-id="5a8c5-193">可以模拟客户端标识，但是仅在建立连接时，并非每次调用时都可以模拟。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-193">The client identity can be impersonated, but only when the connection is established, and not on every call.</span></span><br /><br /> <span data-ttu-id="5a8c5-194">**委托**：代表客户端操作时，服务器进程可以模拟客户端安全上下文。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-194">**Delegate**: The server process can impersonate the client security context while acting on behalf of the client.</span></span> <span data-ttu-id="5a8c5-195">代表客户端操作时，服务器进程还可以进行针对其他服务器的传出调用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-195">The server process can also make outgoing calls to other servers while acting on behalf of the client.</span></span>|  
|`Integrated Security`|<span data-ttu-id="5a8c5-196">调用方的 Windows 标识用于连接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-196">The Windows identity of the caller is used to connect to Analysis Services.</span></span> <span data-ttu-id="5a8c5-197">有效值为空、SSPI 和 BASIC。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-197">Valid values are blank, SSPI, and BASIC.</span></span><br /><br /> <span data-ttu-id="5a8c5-198">`Integrated Security`=`SSPI`是 TCP 连接的默认值，允许 NTLM、Kerberos 或匿名身份验证。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-198">`Integrated Security`=`SSPI` is the default value for TCP connections, allowing NTLM, Kerberos, or Anonymous authentication.</span></span> <span data-ttu-id="5a8c5-199">HTTP 连接的默认值为空。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-199">Blank is the default value for HTTP connections.</span></span><br /><br /> <span data-ttu-id="5a8c5-200">使用 `SSPI` 时，`ProtectionLevel` 必须设置为以下值之一：`Connect`、`PktIntegrity`、`PktPrivacy`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-200">When using `SSPI`, `ProtectionLevel` must be set to one of the following: `Connect`, `PktIntegrity`, `PktPrivacy`.</span></span>|  
|`Persist Encrypted`|<span data-ttu-id="5a8c5-201">当客户端应用程序需要数据源对象以加密形式保存敏感身份验证信息（如密码）时设置此属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-201">Set this property when the client application requires the data source object to persist sensitive authentication information, such as a password, in encrypted form.</span></span> <span data-ttu-id="5a8c5-202">默认情况下，不保存身份验证信息。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-202">By default, authentication information is not persisted.</span></span>|  
|`Persist Security Info`|<span data-ttu-id="5a8c5-203">有效值为 True 和 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-203">Valid values are True and False.</span></span> <span data-ttu-id="5a8c5-204">设置为 True 时，在建立连接后可以从连接获取安全信息（如以前在连接字符串上指定的用户标识或密码）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-204">When set to True, security information, such as the user identity or password previously specified on the connection string, can be obtained from the connection after the connection is made.</span></span> <span data-ttu-id="5a8c5-205">默认值为 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-205">The default value is False.</span></span>|  
|`ProtectionLevel`|<span data-ttu-id="5a8c5-206">确定连接上使用的安全级别。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-206">Determines the security level used on the connection.</span></span> <span data-ttu-id="5a8c5-207">有效值是：</span><span class="sxs-lookup"><span data-stu-id="5a8c5-207">Valid values are:</span></span><br /><br /> <span data-ttu-id="5a8c5-208">`None`.</span><span class="sxs-lookup"><span data-stu-id="5a8c5-208">`None`.</span></span> <span data-ttu-id="5a8c5-209">不进行身份验证的连接或匿名连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-209">Unauthenticated or anonymous connections.</span></span> <span data-ttu-id="5a8c5-210">不对发送到服务器的数据进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-210">Performs no authentication on data sent to the server.</span></span><br /><br /> <span data-ttu-id="5a8c5-211">`Connect`.</span><span class="sxs-lookup"><span data-stu-id="5a8c5-211">`Connect`.</span></span> <span data-ttu-id="5a8c5-212">进行身份验证的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-212">Authenticated connections.</span></span> <span data-ttu-id="5a8c5-213">仅当客户端与服务器建立关系时进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-213">Authenticates only when the client establishes a relationship with a server.</span></span><br /><br /> <span data-ttu-id="5a8c5-214">`PktIntegrity`.</span><span class="sxs-lookup"><span data-stu-id="5a8c5-214">`PktIntegrity`.</span></span> <span data-ttu-id="5a8c5-215">加密的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-215">Encrypted connections.</span></span> <span data-ttu-id="5a8c5-216">验证从客户端接收了所有数据并且数据在途中未更改。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-216">Verifies that all data is received from the client and that it has not been changed in transit.</span></span><br /><br /> <span data-ttu-id="5a8c5-217">`PktPrivacy`.</span><span class="sxs-lookup"><span data-stu-id="5a8c5-217">`PktPrivacy`.</span></span> <span data-ttu-id="5a8c5-218">签名的加密，仅对于 XMLA 支持。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-218">Signed encryption, supported only for XMLA.</span></span> <span data-ttu-id="5a8c5-219">验证从客户端接收了所有数据并且数据在途中未更改，通过加密来保护数据的隐私。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-219">Verifies that all data is received from the client, that it has not been changed in transit, and protects the privacy of the data by encrypting it.</span></span><br /><br /> <br /><br /> <span data-ttu-id="5a8c5-220">有关详细信息，请参阅 [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections)</span><span class="sxs-lookup"><span data-stu-id="5a8c5-220">For more information, see [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections)</span></span>|  
|`Roles`|<span data-ttu-id="5a8c5-221">指定逗号分隔的预定义的角色列表，以使用该角色具有的权限连接到服务器或数据库。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-221">Specify a comma-delimited list of predefined roles to connect to a server or database using permissions conveyed by that role.</span></span> <span data-ttu-id="5a8c5-222">如果忽略此属性，则使用所有角色且有效权限为所有角色的组合权限。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-222">If this property is omitted, all roles are used, and the effective permissions are the combination of all roles.</span></span> <span data-ttu-id="5a8c5-223">将属性设置为空值 (例如，在客户端连接 ) 的 role = "" 没有角色成员身份。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-223">Setting the property to an empty value (for example, Roles=' ') the client connection has no role membership.</span></span><br /><br /> <span data-ttu-id="5a8c5-224">管理员使用此属性通过角色具有的权限进行连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-224">An administrator using this property connects using the permissions conveyed by the role.</span></span> <span data-ttu-id="5a8c5-225">如果角色的权限不足，一些命令可能失败。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-225">Some commands might fail if the role does not provide sufficient permission.</span></span>|  
|`SSPI`|<span data-ttu-id="5a8c5-226">显式指定将 `Integrated Security` 设置为 `SSPI` 时要将哪个安全包用于客户端身份验证。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-226">Explicitly specifies which security package to use for client authentication when `Integrated Security` is set to `SSPI`.</span></span> <span data-ttu-id="5a8c5-227">SSPI 支持多个包，但是您可以使用此属性指定特定的包。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-227">SSPI supports multiple packages, but you can use this property to specify a particular package.</span></span> <span data-ttu-id="5a8c5-228">有效值为“协商”、Kerberos、NTLM 和“匿名用户”。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-228">Valid values are Negotiate, Kerberos, NTLM, and Anonymous User.</span></span> <span data-ttu-id="5a8c5-229">如果未设置此属性，则所有包可用于连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-229">If this property is not set, all packages will be available to the connection.</span></span>|  
|`Use Encryption for Data`|<span data-ttu-id="5a8c5-230">加密数据传输。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-230">Encrypts data transmissions.</span></span> <span data-ttu-id="5a8c5-231">有效值为 True 和 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-231">Value values are True and False.</span></span>|  
|<span data-ttu-id="5a8c5-232">`User ID`=...;`Password`=</span><span class="sxs-lookup"><span data-stu-id="5a8c5-232">`User ID`=...; `Password`=</span></span>|<span data-ttu-id="5a8c5-233">将 `User ID` 和 `Password` 一起使用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-233">`User ID` and `Password` are used together.</span></span> <span data-ttu-id="5a8c5-234">Analysis Services 模拟通过这些凭据指定的用户标识。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-234">Analysis Services impersonates the user identity specified through these credentials.</span></span> <span data-ttu-id="5a8c5-235">在 Analysis Services 连接上，仅当为 HTTP 访问配置了服务器并且您在 IIS 虚拟目录上指定了基本身份验证替代集成安全性时才在命令行上列出凭据。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-235">On an Analysis Services connection, putting credentials on the command line is used only when the server is configured for HTTP access, and you specified Basic authentication instead of integrated security on the IIS virtual directory.</span></span><br /><br /> <span data-ttu-id="5a8c5-236">用户名和密码必须是 Windows 标识（本地用户帐户或域用户帐户）的凭据。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-236">The user name and password must be the credentials of a Windows identity, either a local or a domain user account.</span></span> <span data-ttu-id="5a8c5-237">请注意 `User ID` 包含嵌入的空格。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-237">Notice that `User ID` has an embedded space.</span></span> <span data-ttu-id="5a8c5-238">此属性的其他别名包括 `UserName`（无空格）和 `UID`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-238">Other aliases for this property include `UserName` (no space), and `UID`.</span></span> <span data-ttu-id="5a8c5-239">`Password` 的别名为 `PWD`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-239">Alias for `Password` is `PWD`.</span></span>|  
  
##  <a name="special-purpose-parameters"></a><a name="bkmk_special"></a> <span data-ttu-id="5a8c5-240">特殊用途的参数</span><span class="sxs-lookup"><span data-stu-id="5a8c5-240">Special-purpose parameters</span></span>  
 <span data-ttu-id="5a8c5-241">本节介绍其余连接字符串参数。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-241">This section describes the remainder of the connection string parameters.</span></span> <span data-ttu-id="5a8c5-242">这些参数用于确保应用程序所需的特定连接行为。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-242">These are used to ensure specific connection behaviors required by an application.</span></span>  
  
 <span data-ttu-id="5a8c5-243">按字母顺序列出属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-243">Properties are listed in alphabetical order.</span></span>  
  
|<span data-ttu-id="5a8c5-244">属性</span><span class="sxs-lookup"><span data-stu-id="5a8c5-244">Property</span></span>|<span data-ttu-id="5a8c5-245">说明</span><span class="sxs-lookup"><span data-stu-id="5a8c5-245">Description</span></span>|  
|--------------|-----------------|  
|`Application Name`|<span data-ttu-id="5a8c5-246">设置与连接关联的应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-246">Sets the name of the application associated with the connection.</span></span> <span data-ttu-id="5a8c5-247">当监视跟踪事件，特别是您具有访问同一数据库的几个应用程序时，此值很有用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-247">This value can be useful when monitoring tracing events, especially when you have several applications accessing the same databases.</span></span> <span data-ttu-id="5a8c5-248">例如，将 Application Name = ' test ' 添加到连接字符串将导致 ' test ' 在 SQL Server Profiler 跟踪中出现，如以下屏幕截图所示：</span><span class="sxs-lookup"><span data-stu-id="5a8c5-248">For example, adding Application Name='test' to a connection string causes 'test' to appear in a SQL Server Profiler trace, as shown in the following screenshot:</span></span><br /><br /> <span data-ttu-id="5a8c5-249">![SSAS_AppNameExcample](../media/ssas-appnameexcample.gif "SSAS_AppNameExcample")</span><span class="sxs-lookup"><span data-stu-id="5a8c5-249">![SSAS_AppNameExcample](../media/ssas-appnameexcample.gif "SSAS_AppNameExcample")</span></span><br /><br /> <span data-ttu-id="5a8c5-250">此属性的别名包括 `sspropinitAppName`、`AppName`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-250">Aliases for this property include `sspropinitAppName`, `AppName`.</span></span> <span data-ttu-id="5a8c5-251">有关详细信息，请参阅 [连接到 SQL Server 时使用 Application Name 参数](https://www.connectionstrings.com/use-application-name-sql-server/)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-251">For more information, see [Use Application Name parameter when connecting to SQL Server](https://www.connectionstrings.com/use-application-name-sql-server/).</span></span>|  
|`AutoSyncPeriod`|<span data-ttu-id="5a8c5-252">设置客户端和服务器缓存同步的频率（毫秒）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-252">Sets the frequency (in milliseconds) of client and server cache synchronization.</span></span> <span data-ttu-id="5a8c5-253">ADOMD.NET 为具有最小内存开销的常用对象提供客户端缓存。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-253">ADOMD.NET provides client caching for frequently used objects that have minimal memory overhead.</span></span> <span data-ttu-id="5a8c5-254">这有助于减少到服务器的往返次数。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-254">This helps reduce the number of round trips to the server.</span></span> <span data-ttu-id="5a8c5-255">默认值为 10000 毫秒（或 10 秒钟）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-255">The default is 10000 milliseconds (or 10 seconds).</span></span> <span data-ttu-id="5a8c5-256">设置为 null 或 0 时，关闭自动同步功能。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-256">When set to null or 0, automatic synchronization is turned off.</span></span>|  
|`Character Encoding`|<span data-ttu-id="5a8c5-257">定义如何在请求中对字符编码。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-257">Defines how characters are encoded on the request.</span></span> <span data-ttu-id="5a8c5-258">有效值为 Default 或 UTF-8（它们是等效的）和 UTF-16。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-258">Valid values are Default or UTF-8 (these are equivalent), and UTF-16</span></span>|  
|`CompareCaseSensitiveStringFlags`|<span data-ttu-id="5a8c5-259">为指定的区域设置调整区分大小写的字符串比较。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-259">Adjusts case-sensitive string comparisons for a specified locale.</span></span> <span data-ttu-id="5a8c5-260">有关如何设置此属性的详细信息，请参阅 [CompareCaseSensitiveStringFlags 属性](https://msdn.microsoft.com/library/aa237459\(v=sql.80\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-260">For more information about setting this property, see [CompareCaseSensitiveStringFlags Property](https://msdn.microsoft.com/library/aa237459\(v=sql.80\).aspx).</span></span>|  
|`Compression Level`|<span data-ttu-id="5a8c5-261">如果 `TransportCompression` 为 XPRESS，您可以设置压缩级别以控制使用的压缩程度。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-261">If `TransportCompression` is XPRESS, you can set the compression level to control how much compression is used.</span></span> <span data-ttu-id="5a8c5-262">有效值为 0-9，其中 0 表示最小程度的压缩，9 表示最大程度的压缩。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-262">Valid values are 0 through 9, with 0 having least compression, and 9 having the most compression.</span></span> <span data-ttu-id="5a8c5-263">增大压缩程度将降低性能。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-263">Increased compression slows performance.</span></span> <span data-ttu-id="5a8c5-264">默认值为 0。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-264">The default value is 0.</span></span>|  
|`Connect Timeout`|<span data-ttu-id="5a8c5-265">确定客户端在超时前尝试连接所用的最长时间（以秒为单位）)  (。如果在此期间连接未成功，则客户端会退出尝试连接并生成错误。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-265">Determines the maximum amount of time (in seconds) the client attempts a connection before timing out. If a connection does not succeed within this period, the client quits trying to connect and generates an error.</span></span>|  
|`MDX Compatibility`|<span data-ttu-id="5a8c5-266">此属性的目的是确保发出 MDX 查询的应用程序具有一致的 MDX 行为集。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-266">The purpose of this property is to ensure a consistent set of MDX behaviors for applications that issue MDX queries.</span></span> <span data-ttu-id="5a8c5-267">Excel 使用 MDX 查询填充和计算连接到 Analysis Services 的数据透视表，它将此属性设置为 1 以确保在数据透视表中显示不规则层次结构中的占位符成员。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-267">Excel, which uses MDX queries to populate and calculate a PivotTable connected to Analysis Services, sets this property to 1, to ensure that placeholder members in ragged hierarchies are visible in a PivotTable.</span></span> <span data-ttu-id="5a8c5-268">有效值包括 0、1、2。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-268">Valid values include 0, 1, 2.</span></span><br /><br /> <span data-ttu-id="5a8c5-269">0 和 1 表示公开占位符成员；2 表示不公开这些成员。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-269">0 and 1 expose placeholder members; 2 does not.</span></span> <span data-ttu-id="5a8c5-270">如果它为空，则假定为 0。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-270">If this is empty, 0 is assumed.</span></span>|  
|`MDX Missing Member Mode=Error`|<span data-ttu-id="5a8c5-271">指示是否在 MDX 语句中忽略缺少的成员。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-271">Indicates whether missing members are ignored in MDX statements.</span></span> <span data-ttu-id="5a8c5-272">有效值为 Default、Error 和 Ignore。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-272">Valid values are Default, Error, and Ignore.</span></span> <span data-ttu-id="5a8c5-273">Default 使用服务器定义的值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-273">Default uses a server-defined value.</span></span> <span data-ttu-id="5a8c5-274">Error 在成员不存在时生成错误。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-274">Error generates an error when a member does not exist.</span></span> <span data-ttu-id="5a8c5-275">Ignore 指定应忽略缺失值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-275">Ignore specifies that missing values should be ignored.</span></span>|  
|`Optimize Response`|<span data-ttu-id="5a8c5-276">位掩码指示启用以下哪个查询响应优化。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-276">A bitmask indicating which of the following query response optimizations are enabled.</span></span><br /><br /> <span data-ttu-id="5a8c5-277">0x01：默认值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-277">0x01: Default.</span></span> <span data-ttu-id="5a8c5-278">使用 NormalTupleSet</span><span class="sxs-lookup"><span data-stu-id="5a8c5-278">Use the NormalTupleSet</span></span> <br /><span data-ttu-id="5a8c5-279">0x02：当切片器为空时使用</span><span class="sxs-lookup"><span data-stu-id="5a8c5-279">0x02: Use when slicers are empty</span></span>|  
|`Packet Size`|<span data-ttu-id="5a8c5-280">网络数据包大小（字节）为 512-32,767。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-280">A network packet size (in bytes) between 512 and 32,767.</span></span> <span data-ttu-id="5a8c5-281">默认网络数据包大小为 4096。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-281">The default network packet size is 4096.</span></span>|  
|`Protocol Format`|<span data-ttu-id="5a8c5-282">设置发送给服务器的 XML 格式。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-282">Sets the format of the XML sent to the server.</span></span> <span data-ttu-id="5a8c5-283">有效值为 Default、XML 或 Binary。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-283">Valid values are Default, XML, or Binary.</span></span> <span data-ttu-id="5a8c5-284">协议为 XMLA。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-284">The protocol is XMLA.</span></span> <span data-ttu-id="5a8c5-285">您可以指定以压缩格式（默认值）发送 XML、作为原始 XML 发送或以二进制格式发送。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-285">You can specify that the XML be sent in compressed form (this is the default), as raw XML, or in a binary format.</span></span> <span data-ttu-id="5a8c5-286">二进制格式对 XML 元素和属性编码，使得它们更小。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-286">Binary format encodes XML elements and attributes, making them smaller.</span></span> <span data-ttu-id="5a8c5-287">压缩是进一步减小请求和响应大小的专用格式。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-287">Compression is a proprietary format that further reduces the size of requests and responses.</span></span> <span data-ttu-id="5a8c5-288">压缩和二进制格式用于提高数据传输请求和响应的速度。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-288">Compression and binary formats are used to speed up data transfer requests and responses.</span></span><br /><br /> <span data-ttu-id="5a8c5-289">如果要使用二进制或压缩格式，您必须使用连接上的客户端库。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-289">You must use a client library on the connection if using binary or compressed format.</span></span> <span data-ttu-id="5a8c5-290">OLE DB 访问接口可以将请求和响应格式设置为二进制或压缩格式。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-290">OLE DB provider can format requests and responses in binary or compressed format.</span></span> <span data-ttu-id="5a8c5-291">AMO 和 ADOMD.NET 将请求格式设置为文本，但是接受二进制或压缩格式的响应。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-291">AMO and ADOMD.NET format the requests as Text, but accept responses in binary or compressed format.</span></span><br /><br /> <span data-ttu-id="5a8c5-292">此连接字符串属性与 `EnableBinaryXML` 和 `EnableCompression` 服务器配置设置等效。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-292">This connection string property is equivalent to the `EnableBinaryXML` and `EnableCompression` server configuration settings.</span></span>|  
|`Real Time Olap`|<span data-ttu-id="5a8c5-293">设置此属性以绕过缓存，导致所有分区主动侦听查询通知。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-293">Set this property to bypass caching, causing all partitions to actively listen for query notifications.</span></span> <span data-ttu-id="5a8c5-294">默认情况下，不设置此属性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-294">By default, this property is not set.</span></span>|  
|`Safety Options`|<span data-ttu-id="5a8c5-295">设置用户定义的函数和操作的安全级别。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-295">Sets the safety level for user-defined functions and actions.</span></span> <span data-ttu-id="5a8c5-296">有效值为 0、1、2。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-296">Valid values are 0, 1, 2.</span></span> <span data-ttu-id="5a8c5-297">在 Excel 连接中，此属性为 Safety Options=2。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-297">In an Excel connection this property is Safety Options=2.</span></span> <span data-ttu-id="5a8c5-298">有关此选项的详细信息可以在 <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-298">Details about this option can be found in <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A>.</span></span>|  
|`SQLQueryMode`|<span data-ttu-id="5a8c5-299">指定 SQL 查询是否包含计算。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-299">Specifies whether SQL queries include calculations.</span></span> <span data-ttu-id="5a8c5-300">有效值为 Data、Calculated、IncludeEmpty。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-300">Valid values are Data, Calculated, IncludeEmpty.</span></span> <span data-ttu-id="5a8c5-301">Data 表示不允许计算。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-301">Data means that no calculations are allowed.</span></span> <span data-ttu-id="5a8c5-302">Calculated 表示允许计算。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-302">Calculated allows calculations.</span></span> <span data-ttu-id="5a8c5-303">IncludeEmpty 表示允许计算并在查询结果中返回空行。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-303">IncludeEmpty allows calculations and empty rows to be returned in the query result.</span></span>|  
|`Timeout`|<span data-ttu-id="5a8c5-304">指定在生成错误前客户端库等待命令完成的最长时间（毫秒）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-304">Specifies how long (in milliseconds) the client library waits for a command to complete before generating an error.</span></span>|  
|`Transport Compression`|<span data-ttu-id="5a8c5-305">定义在通过 `Protocol Format` 属性指定压缩时如何压缩客户端和服务器通信。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-305">Defines how client and server communications are compressed, when compression is specified via the `Protocol Format` property.</span></span> <span data-ttu-id="5a8c5-306">有效值为 Default、None、Compressed 和 `gzip`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-306">Valid values are Default, None, Compressed and `gzip`.</span></span> <span data-ttu-id="5a8c5-307">Default 表示不压缩 TCP，或对 HTTP 使用 `gzip`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-307">Default is no compression for TCP, or `gzip` for HTTP.</span></span> <span data-ttu-id="5a8c5-308">None 指示不使用压缩。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-308">None indicates that no compression is used.</span></span> <span data-ttu-id="5a8c5-309">Compressed 使用 XPRESS 压缩（SQL Server 2008 和更高版本）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-309">Compressed uses XPRESS compression (SQL Server 2008 and later).</span></span> <span data-ttu-id="5a8c5-310">`gzip` 仅对于 HTTP 连接有效，其中 HTTP 请求包括 Accept-Encoding=gzip。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-310">`gzip` is only valid for HTTP connections, where the HTTP request includes Accept-Encoding=gzip.</span></span>|  
|`UseExistingFile`|<span data-ttu-id="5a8c5-311">连接到本地多维数据集时使用。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-311">Used when connecting to a local cube.</span></span> <span data-ttu-id="5a8c5-312">此属性指定是否覆盖本地多维数据集。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-312">This property specifies whether the local cube is overwritten.</span></span> <span data-ttu-id="5a8c5-313">有效值为 True 或 False。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-313">Valid values are True or False.</span></span> <span data-ttu-id="5a8c5-314">如果设置为 True，则多维数据集文件必须存在。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-314">If set to True, the cube file must exist.</span></span> <span data-ttu-id="5a8c5-315">现有文件将是连接目标。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-315">The existing file will be the target of the connection.</span></span> <span data-ttu-id="5a8c5-316">如果设置为 False，则覆盖多维数据集文件。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-316">If set to False, the cube file is overwritten.</span></span>|  
|`VisualMode`|<span data-ttu-id="5a8c5-317">设置此属性以控制在应用维度安全性时如何聚合成员。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-317">Set this property to control how members are aggregated when dimension security is applied.</span></span><br /><br /> <span data-ttu-id="5a8c5-318">对于允许每个人查看的多维数据集数据，聚合所有成员有意义，因为组成总计的所有值是可见的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-318">For cube data that everyone is allowed to see, aggregating all of the members makes sense because all of the values that contribute to the total are visible.</span></span> <span data-ttu-id="5a8c5-319">但是，如果您基于用户标识筛选或限制了维度，基于所有成员显示总计（将受限制的值和允许的值合并为一个总计）可能令人困惑，或导致显示的信息比应揭示的信息多。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-319">However, if you filter or restrict dimensions based on user identity, showing a total based on all the members (combining both restricted and allowed values into a single total) might be confusing or show more information than should be revealed.</span></span><br /><br /> <span data-ttu-id="5a8c5-320">要在应用维度安全性时指定如何聚合成员，您可以将此属性设置为 True 以仅在聚合中使用允许的值，或将其设置为 False 以将受限制的值从总计中排除。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-320">To specify how members are aggregated when dimension security is applied, you can set this property to True to use only allowed values in the aggregation, or False to exclude restricted values from the total.</span></span><br /><br /> <span data-ttu-id="5a8c5-321">在连接字符串上设置时，此值适用于多维数据集或透视级别。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-321">When set on the connection string, this value applies to the cube or perspective level.</span></span> <span data-ttu-id="5a8c5-322">在模型内，您可以在更精细的级别上控制可视总计。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-322">Within a model, you can control visual totals at a more granular level.</span></span><br /><br /> <span data-ttu-id="5a8c5-323">有效值为 0、1 和 2。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-323">Valid values are 0, 1, and 2.</span></span><br /><br /> <span data-ttu-id="5a8c5-324">0 是默认值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-324">0 is the default.</span></span> <span data-ttu-id="5a8c5-325">当前，默认行为与 2 等效，其中聚合包含未显示给用户的值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-325">Currently, the default behavior is equivalent to 2, where aggregations include values that are hidden from the user.</span></span><br /><br /> <span data-ttu-id="5a8c5-326">1 表示从总计中排除隐藏的值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-326">1 excludes hidden values from the total.</span></span> <span data-ttu-id="5a8c5-327">这对 Excel 为默认值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-327">This is the default for Excel.</span></span><br /><br /> <span data-ttu-id="5a8c5-328">2 表示在总计中包含隐藏的值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-328">2 includes hidden values in the total.</span></span> <span data-ttu-id="5a8c5-329">这是服务器上的默认值。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-329">This is the default value on the server.</span></span><br /><br /> <br /><br /> <span data-ttu-id="5a8c5-330">此属性的别名包括 `Visual Total` 或 `Default MDX Visual Mode`。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-330">Aliases for this property include `Visual Total` or `Default MDX Visual Mode`.</span></span>|  
  
##  <a name="reserved-for-future-use"></a><a name="bkmk_reserved"></a><span data-ttu-id="5a8c5-331">保留以供将来使用</span><span class="sxs-lookup"><span data-stu-id="5a8c5-331">Reserved for future use</span></span>  
 <span data-ttu-id="5a8c5-332">以下属性允许用于连接字符串，但是在当前版本的 Analysis Services 中无效。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-332">The following properties are allowed on a connection string, but are not operational in current releases of Analysis Services.</span></span>  
  
-   <span data-ttu-id="5a8c5-333">Authenticated User</span><span class="sxs-lookup"><span data-stu-id="5a8c5-333">Authenticated User</span></span>  
  
-   <span data-ttu-id="5a8c5-334">Cache Authentication</span><span class="sxs-lookup"><span data-stu-id="5a8c5-334">Cache Authentication</span></span>  
  
-   <span data-ttu-id="5a8c5-335">Cache Mode（已在早期版本中调查此属性的使用情况。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-335">Cache Mode (Use of this property was investigated in earlier releases.</span></span> <span data-ttu-id="5a8c5-336">尽管您可能找到推荐使用它的博客文章，但是应避免设置此属性，除非 Microsoft 支持人员要求您这样做）。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-336">Although you might find blog posts recommending its usage, you should avoid setting this property unless instructed by Microsoft Support).</span></span>  
  
-   <span data-ttu-id="5a8c5-337">缓存策略</span><span class="sxs-lookup"><span data-stu-id="5a8c5-337">Cache Policy</span></span>  
  
-   <span data-ttu-id="5a8c5-338">Cache Ratio</span><span class="sxs-lookup"><span data-stu-id="5a8c5-338">Cache Ratio</span></span>  
  
-   <span data-ttu-id="5a8c5-339">Cache Ratio2</span><span class="sxs-lookup"><span data-stu-id="5a8c5-339">Cache Ratio2</span></span>  
  
-   <span data-ttu-id="5a8c5-340">Dynamic Debug Limit</span><span class="sxs-lookup"><span data-stu-id="5a8c5-340">Dynamic Debug Limit</span></span>  
  
-   <span data-ttu-id="5a8c5-341">调试模式</span><span class="sxs-lookup"><span data-stu-id="5a8c5-341">Debug Mode</span></span>  
  
-   <span data-ttu-id="5a8c5-342">Mode</span><span class="sxs-lookup"><span data-stu-id="5a8c5-342">Mode</span></span>  
  
-   <span data-ttu-id="5a8c5-343">SQLCompatibility</span><span class="sxs-lookup"><span data-stu-id="5a8c5-343">SQLCompatibility</span></span>  
  
-   <span data-ttu-id="5a8c5-344">Use Formula Cache</span><span class="sxs-lookup"><span data-stu-id="5a8c5-344">Use Formula Cache</span></span>  
  
##  <a name="example-connection-strings"></a><a name="bkmk_examples"></a><span data-ttu-id="5a8c5-345">连接字符串示例</span><span class="sxs-lookup"><span data-stu-id="5a8c5-345">Example connection strings</span></span>  
 <span data-ttu-id="5a8c5-346">本部分介绍在常用应用程序中设置 Analysis Services 连接时最有可能使用的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-346">This section shows the connection string that you'll most likely use when setting up an Analysis Services connection in commonly used applications.</span></span>  
  
 <span data-ttu-id="5a8c5-347">**通用连接字符串**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-347">**Generic connection string**</span></span>  
  
 <span data-ttu-id="5a8c5-348">如果您正在从 Reporting Services 配置连接，可能使用类似这样的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-348">You might use a connection string like this one if you are configuring a connection from Reporting Services.</span></span>  
  
 `Data source=<servername>; initial catalog=<databasename>`  
  
 <span data-ttu-id="5a8c5-349">**Excel 中的连接字符串**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-349">**Connection string in Excel**</span></span>  
  
 <span data-ttu-id="5a8c5-350">Excel 中的默认 ADOMD.NET 连接字符串指定数据访问接口、服务器、数据库名称、Windows 集成安全性。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-350">The default ADOMD.NET connection string in Excel specifies the data provider, server, database name, Windows integrated security.</span></span> <span data-ttu-id="5a8c5-351">MDX 兼容级别始终设置为 1。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-351">The MDX Compatibility level is always set to 1.</span></span> <span data-ttu-id="5a8c5-352">尽管您可以针对当前会话更改该值，但 Excel 会在下次打开文件时将 MDX 兼容级别重置为 1。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-352">Although you can change the value for the current session, Excel will reset MDX Compatibility to1 when the file is next opened.</span></span>  
  
 `Provider=MSOLAP.5;Integrated Security=SSPI;Persist Security Info=True;Initial Catalog=Adventure Works DW 2008R2;Data Source=AW-SRV01;MDX Compatibility=1;Safety Options=2;MDX Missing Member Mode=Error`  
  
 <span data-ttu-id="5a8c5-353">有关详细信息，请参阅[Reporting Services 中的数据连接、数据源和连接字符串](../../reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md)和[SharePoint Server 2013 中 Excel Services 的数据身份验证](https://go.microsoft.com/fwlink/?LinkId=296350)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-353">For more information, see [Data Connections, Data Sources, and Connection Strings in Reporting Services](../../reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md) and [Data Authentication for Excel Services in SharePoint Server 2013](https://go.microsoft.com/fwlink/?LinkId=296350).</span></span>  
  
##  <a name="connection-string-formats-used-in-analysis-services"></a><a name="bkmk_supportedstrings"></a> <span data-ttu-id="5a8c5-354">Analysis Services 中使用的连接字符串格式</span><span class="sxs-lookup"><span data-stu-id="5a8c5-354">Connection string formats used in Analysis Services</span></span>  
 <span data-ttu-id="5a8c5-355">本节列出了 Analysis Services 支持的所有连接字符串格式。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-355">This section lists all of the connection string formats supported by Analysis Services.</span></span> <span data-ttu-id="5a8c5-356">除了与 PowerPivot 数据库的连接，您均可以在连接 Analysis Services 的应用程序中指定这些连接字符串。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-356">With the exception of connections to PowerPivot databases, you can specify these connections strings in applications that connect to Analysis Services.</span></span>  
  
 <span data-ttu-id="5a8c5-357">**与服务器的本机（或直接）连接**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-357">**Native (or direct) connections to the server**</span></span>  
  
 <span data-ttu-id="5a8c5-358">`Data Source=server[:port][\instance]`其中 "port" 和 "\instance" 是可选的。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-358">`Data Source=server[:port][\instance]` where "port" and "\instance" are optional.</span></span> <span data-ttu-id="5a8c5-359">例如，指定 "Data Source = server1" 将在名为 "server1" 的服务器上打开与默认实例 (和默认端口 2383) 的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-359">For example, specifying "Data Source=server1" opens a connection to the default instance (and default port 2383) on a server named "server1".</span></span>  
  
 <span data-ttu-id="5a8c5-360">"Data Source = server1： port1" 将打开到在 "server1" 上的端口 "port1" 上运行的 Analysis Services 实例的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-360">"Data Source=server1:port1" will open a connection to an Analysis Services instance running on port "port1" on "server1".</span></span>  
  
 <span data-ttu-id="5a8c5-361">"Data Source = server1\instance1" 将打开与 SQL Browser (在其默认端口 2382) 上的连接，解析命名实例 "instance1" 的端口，并打开与该 Analysis Services 端口的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-361">"Data Source=server1\instance1" will open a connection to SQL Browser (on its default port 2382), resolve the port for the named instance  "instance1", then open the connection to that Analysis Services port.</span></span>  
  
 <span data-ttu-id="5a8c5-362">"Data Source = server1： port1\instance1" 将打开与 "port1" 上 SQL Browser 的连接，解析 "instance1" 命名实例的端口，然后打开指向该 Analysis Services 端口的连接。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-362">"Data Source=server1:port1\instance1" will open a connection to SQL Browser on "port1", resolve the port for the "instance1" named instance, then open the connection to that Analysis Services port.</span></span>  
  
 <span data-ttu-id="5a8c5-363">**本地多维数据集连接（.cub 文件）**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-363">**Local cube connections (.cub files)**</span></span>  
  
 <span data-ttu-id="5a8c5-364">`Data Source=<path>`，例如 "Data Source = c:\temp\a.cub"</span><span class="sxs-lookup"><span data-stu-id="5a8c5-364">`Data Source=<path>`, for example "Data Source=c:\temp\a.cub"</span></span>  
  
 <span data-ttu-id="5a8c5-365">**与 msmdpump.dll 的 Http(s) 连接**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-365">**Http(s) connections to msmdpump.dll**</span></span>  
  
 <span data-ttu-id="5a8c5-366">`Data Source=<URL>`，其中，URL 是包含 msmdpump.dll 的虚拟 IIS 文件夹的 HTTP 或 HTTPS 地址。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-366">`Data Source=<URL>`, where the URL is the HTTP or HTTPS address to the virtual IIS folder that contains the msmdpump.dll.</span></span> <span data-ttu-id="5a8c5-367">有关详细信息，请参阅 [在 Internet Information Services (IIS) 8.0 上配置对 Analysis Services 的 HTTP 访问](configure-http-access-to-analysis-services-on-iis-8-0.md)。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-367">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="5a8c5-368">**与 PowerPivot 工作簿（.xlsx、.xlsb 或 .xlsm 文件）的 Http(s) 连接**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-368">**Http(s) connections to PowerPivot workbooks (.xlsx, .xlsb or .xlsm files)**</span></span>  
  
 <span data-ttu-id="5a8c5-369">`Data Source=<URL>`，其中，URL 是指向已发布到某一 SharePoint 库的 PowerPivot 工作簿的 SharePoint 路径。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-369">`Data Source=<URL>`, where the URL is the SharePoint path to a PowerPivot workbook that has been published to a SharePoint library.</span></span> <span data-ttu-id="5a8c5-370">例如，"Data Source = <http://localhost/Shared> Documents/Sales.xlsx"。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-370">For example, "Data Source=<http://localhost/Shared> Documents/Sales.xlsx".</span></span>  
  
 <span data-ttu-id="5a8c5-371">**与 BI 语义模型连接文件的 Http(s) 连接**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-371">**Http(s) connections to BI Semantic Model Connection files**</span></span>  
  
 <span data-ttu-id="5a8c5-372">`Data Source=<URL>` ，其中，URL 是指向 .bism 文件的 SharePoint 路径。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-372">`Data Source=<URL>` where the URL is the SharePoint path to the .bism file.</span></span> <span data-ttu-id="5a8c5-373">例如，"Data Source = <http://localhost/Shared> Documents/bism"。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-373">For example, "Data Source=<http://localhost/Shared> Documents/Sales.bism".</span></span>  
  
 <span data-ttu-id="5a8c5-374">**嵌入的 PowerPivot 连接**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-374">**Embedded PowerPivot connections**</span></span>  
  
 <span data-ttu-id="5a8c5-375">`Data Source=$Embedded$`，其中，$embedded$ 是一个引用工作薄内嵌入的 PowerPivot 数据模型的名字对象。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-375">`Data Source=$Embedded$` where $embedded$ is a moniker that refers to an embedded PowerPivot data model inside the workbook.</span></span> <span data-ttu-id="5a8c5-376">此连接字符串在内部创建并管理。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-376">This connection string is created and managed internally.</span></span> <span data-ttu-id="5a8c5-377">请不要修改它。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-377">Do not modify it.</span></span> <span data-ttu-id="5a8c5-378">嵌入的连接字符串由客户端工作站上的 PowerPivot for Excel 外接程序解析，或由 SharePoint 场中的 PowerPivot for SharePoint 实例解析。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-378">Embedded connection strings are resolved by the PowerPivot for Excel add-in on client workstations, or by PowerPivot for SharePoint instances in a SharePoint farm.</span></span>  
  
 <span data-ttu-id="5a8c5-379">**Analysis Services 存储过程中的本地服务器环境**</span><span class="sxs-lookup"><span data-stu-id="5a8c5-379">**Local server context in Analysis Services stored procedures**</span></span>  
  
 <span data-ttu-id="5a8c5-380">`Data Source=*`，其中，\* 解析为本地实例。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-380">`Data Source=*`, where \* resolves to the local instance.</span></span>  
  
##  <a name="encrypting-connection-strings"></a><a name="bkmk_encrypt"></a> <span data-ttu-id="5a8c5-381">加密连接字符串</span><span class="sxs-lookup"><span data-stu-id="5a8c5-381">Encrypting Connection Strings</span></span>  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a8c5-382">对它所使用的连接字符串进行加密和存储以连接到它的每个数据源。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-382">encrypts and stores the connection strings it uses to connect to each of its data sources.</span></span> <span data-ttu-id="5a8c5-383">如果与数据源的连接需要用户名和密码，则可以让 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 将名称和密码与连接字符串存储在一起，也可以在每次需要连接到数据源时再提示您输入名称和密码。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-383">If the connection to a data source requires a user name and password, you can have [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] store the name and password with the connection string, or prompt you for the name and password each time a connection to the data source is required.</span></span> <span data-ttu-id="5a8c5-384">如果让 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 提示您输入用户信息，则不必存储和加密此信息。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-384">Having [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] prompt you for user information means that this information does not have to be stored and encrypted.</span></span> <span data-ttu-id="5a8c5-385">但是，如果将此信息存储在连接字符串中，则需要对此信息加密并加以保护。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-385">However, if you store this information in the connection string, this information does need to be encrypted and secured.</span></span>  
  
 <span data-ttu-id="5a8c5-386">若要对连接字符串信息进行加密和保护， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 使用数据保护 API。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-386">To encrypt and secure the connection string information, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] uses the Data Protection API.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a8c5-387">使用一个单独的加密密钥对每个 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据库的连接字符串信息进行加密。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-387">uses a separate encryption key to encrypt connection string information for each [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a8c5-388">在你创建数据库时创建此密钥，并基于 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 启动帐户对该连接字符串信息进行加密。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-388">creates this key when you create a database, and encrypts connection string information based on the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] startup account.</span></span> <span data-ttu-id="5a8c5-389">当 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 启动时，将读取、解密并存储每个数据库的加密密钥。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-389">When [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] starts, the encrypted key for each database is read, decrypted, and stored.</span></span> <span data-ttu-id="5a8c5-390">当[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 需要连接某个数据源时， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 会使用适当的解密密钥对该数据源的连接字符串信息解密。</span><span class="sxs-lookup"><span data-stu-id="5a8c5-390">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] then uses the appropriate decrypted key to decrypt the data source connection string information when [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] needs to connect to a data source.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5a8c5-391">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5a8c5-391">See Also</span></span>  
 <span data-ttu-id="5a8c5-392">[配置 HTTP 访问 Internet Information Services &#40;IIS 上的 Analysis Services&#41; 8。0](configure-http-access-to-analysis-services-on-iis-8-0.md) </span><span class="sxs-lookup"><span data-stu-id="5a8c5-392">[Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md) </span></span>  
 <span data-ttu-id="5a8c5-393">[为 Kerberos 约束委派配置 Analysis Services](configure-analysis-services-for-kerberos-constrained-delegation.md) </span><span class="sxs-lookup"><span data-stu-id="5a8c5-393">[Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md) </span></span>  
 <span data-ttu-id="5a8c5-394">[用于 Analysis Services 连接的数据提供程序](data-providers-used-for-analysis-services-connections.md) </span><span class="sxs-lookup"><span data-stu-id="5a8c5-394">[Data providers used for Analysis Services connections](data-providers-used-for-analysis-services-connections.md) </span></span>  
 [<span data-ttu-id="5a8c5-395">连接到 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5a8c5-395">Connect to Analysis Services</span></span>](connect-to-analysis-services.md)  
  
  
