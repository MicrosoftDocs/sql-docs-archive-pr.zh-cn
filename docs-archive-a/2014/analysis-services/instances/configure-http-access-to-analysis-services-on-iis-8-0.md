---
title: 配置 HTTP 访问 Internet Information Services (IIS 上的 Analysis Services) 8.0 |Microsoft Docs
ms.custom: ''
ms.date: 06/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: cf2e2c84-0a69-4cdd-90a1-fb4021936513
author: minewiskan
ms.author: owend
ms.openlocfilehash: 00fc6fcdf059bb26602e20d4c7fc8fb46edcfb9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689138"
---
# <a name="configure-http-access-to-analysis-services-on-internet-information-services-iis-80"></a><span data-ttu-id="7436c-102">在 Internet Information Services (IIS) 8.0 上配置对 Analysis Services 的 HTTP 访问</span><span class="sxs-lookup"><span data-stu-id="7436c-102">Configure HTTP Access to Analysis Services on Internet Information Services (IIS) 8.0</span></span>
  <span data-ttu-id="7436c-103">此文章介绍了如何设置用于访问 Analysis Services 实例的 HTTP 端点。</span><span class="sxs-lookup"><span data-stu-id="7436c-103">This article explains how to set up an HTTP endpoint for accessing an Analysis Services instance.</span></span> <span data-ttu-id="7436c-104">你可以通过配置 MSMDPUMP.dll（一种在 Internet Information Services (IIS) 中运行的 ISAPI 扩展，可以在客户端应用程序和 Analysis Services 服务器之间抽送数据）实现对 HTTP 的访问。</span><span class="sxs-lookup"><span data-stu-id="7436c-104">You can enable HTTP access by configuring MSMDPUMP.dll, an ISAPI extension that runs in Internet Information Services (IIS) and pumps data to and from client applications and an Analysis Services server.</span></span> <span data-ttu-id="7436c-105">在您的 BI 解决方案需要以下功能时，此方法可替代用于连接到 Analysis Services 的方法：</span><span class="sxs-lookup"><span data-stu-id="7436c-105">This approach provides an alternative means for connecting to Analysis Services when your BI solution calls for the following capabilities:</span></span>  
  
-   <span data-ttu-id="7436c-106">客户端访问通过 Internet 或 extranet 连接进行，并且对可以启用的端口有限制。</span><span class="sxs-lookup"><span data-stu-id="7436c-106">Client access is over Internet or extranet connections, with restrictions on which ports can be enabled.</span></span>  
  
-   <span data-ttu-id="7436c-107">客户端连接来自同一网络中的不可信域。</span><span class="sxs-lookup"><span data-stu-id="7436c-107">Client connections are from non-trusted domains in the same network.</span></span>  
  
-   <span data-ttu-id="7436c-108">客户端应用程序在允许 HTTP 但不允许 TCP/IP 连接的网络环境下运行。</span><span class="sxs-lookup"><span data-stu-id="7436c-108">Client application runs in a network environment that allows HTTP but not TCP/IP connections.</span></span>  
  
-   <span data-ttu-id="7436c-109">客户端应用程序无法使用 Analysis Services 客户端库（例如，在 UNIX 服务器上运行的 Java 应用程序）。</span><span class="sxs-lookup"><span data-stu-id="7436c-109">Client applications cannot use the Analysis Services client libraries (for example, a Java application running on a UNIX server).</span></span> <span data-ttu-id="7436c-110">如果无法将 Analysis Services 客户端库用于数据访问，则可以使用 SOAP 和 XML/A 通过直接 HTTP 连接来连接到 Analysis Services 实例。</span><span class="sxs-lookup"><span data-stu-id="7436c-110">If you cannot use the Analysis Services client libraries for data access, you can use SOAP and XML/A over a direct HTTP connection to an Analysis Services instance.</span></span>  
  
-   <span data-ttu-id="7436c-111">要求并非 Windows 集成安全性的身份验证方法。</span><span class="sxs-lookup"><span data-stu-id="7436c-111">Authentication methods other than Windows integrated security are required.</span></span> <span data-ttu-id="7436c-112">具体而言，在配置以 HTTP 方式访问 Analysis Services 时可使用匿名连接和基本身份验证。</span><span class="sxs-lookup"><span data-stu-id="7436c-112">Specifically, you can use Anonymous connections and Basic authentication when configuring Analysis Services for HTTP access.</span></span> <span data-ttu-id="7436c-113">不支持摘要式、窗体和 ASP.NET 身份验证。</span><span class="sxs-lookup"><span data-stu-id="7436c-113">Digest, Forms, and ASP.NET authentication are not supported.</span></span> <span data-ttu-id="7436c-114">要求进行基本身份验证是用于启用 HTTP 访问的主要原因之一。</span><span class="sxs-lookup"><span data-stu-id="7436c-114">A requirement of Basic authentication is one of the primary reasons for enabling HTTP access.</span></span> <span data-ttu-id="7436c-115">有关详细信息，请参阅 [Microsoft BI 身份验证和身份委托](https://go.microsoft.com/fwlink/?LinkId=286576)。</span><span class="sxs-lookup"><span data-stu-id="7436c-115">To learn more, see [Microsoft BI Authentication and Identity Delegation](https://go.microsoft.com/fwlink/?LinkId=286576).</span></span>  
  
 <span data-ttu-id="7436c-116">你可以为任何 Analysis Services 支持的版本（运行表格模式或多维模式）配置 HTTP 访问权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-116">You can configure HTTP access for any supported version or edition of Analysis Services, running either tabular mode or multidimensional mode.</span></span> <span data-ttu-id="7436c-117">本地多维数据集是个例外。</span><span class="sxs-lookup"><span data-stu-id="7436c-117">Local cubes are an exception.</span></span> <span data-ttu-id="7436c-118">你不能通过 HTTP 端点连接到本地多维数据集。</span><span class="sxs-lookup"><span data-stu-id="7436c-118">You cannot connect to a local cube via an HTTP endpoint.</span></span>  
  
 <span data-ttu-id="7436c-119">设置 HTTP 访问权限需要在安装后进行。</span><span class="sxs-lookup"><span data-stu-id="7436c-119">Setting up HTTP access is a post-installation task.</span></span> <span data-ttu-id="7436c-120">必须先安装 analysis Services 然后才能为其配置 HTTP 访问权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-120">Analysis Services must be installed before you can configure it for HTTP access.</span></span> <span data-ttu-id="7436c-121">作为 Analysis Services 管理员，你需要向 Windows 帐户授权，然后才能进行 HTTP 访问。</span><span class="sxs-lookup"><span data-stu-id="7436c-121">As the Analysis Services administrator, you will need to grant permissions to Windows accounts before HTTP access is possible.</span></span> <span data-ttu-id="7436c-122">此外，最佳做法是首先验证你的安装，确保它完全可操作，然后才能进一步配置服务器。</span><span class="sxs-lookup"><span data-stu-id="7436c-122">Additionally, it is a best practice to validate your installation first, ensuring that it is fully operational before configuring the server any further.</span></span> <span data-ttu-id="7436c-123">配置 HTTP 访问权限后，你可以通过 TCP/IP 使用 HTTP 端点和服务器的常规网络名称。</span><span class="sxs-lookup"><span data-stu-id="7436c-123">After HTTP access is configured, you can use both the HTTP endpoint and the regular network name of the server over TCP/IP.</span></span> <span data-ttu-id="7436c-124">设置 HTTP 访问权限不会使数据访问的其他方法无效。</span><span class="sxs-lookup"><span data-stu-id="7436c-124">Setting up HTTP access does not invalidate other approaches for data access.</span></span>  
  
 <span data-ttu-id="7436c-125">当你使用 MSMDPUMP 配置进行操作时，请记住可考虑两种连接：客户端到 IIS 和 IIS 到 SSAS。</span><span class="sxs-lookup"><span data-stu-id="7436c-125">As you move forward with MSMDPUMP configuration, remember there are two connections to consider: client-to-IIS, IIS-to-SSAS.</span></span> <span data-ttu-id="7436c-126">本文将针对 IIS 到 SSAS 进行说明。</span><span class="sxs-lookup"><span data-stu-id="7436c-126">The instructions in this article are about IIS-to-SSAS.</span></span> <span data-ttu-id="7436c-127">你的客户端应用程序可能需要进行其他配置才能连接到 IIS。</span><span class="sxs-lookup"><span data-stu-id="7436c-127">Your client application might require additional configuration before it can connect to IIS.</span></span> <span data-ttu-id="7436c-128">有关是否使用 SSL，或如何配置绑定等问题的决定不在本文所述范围之内。</span><span class="sxs-lookup"><span data-stu-id="7436c-128">Decisions such as whether to use SSL, or how to configure bindings, are out of scope for this article.</span></span> <span data-ttu-id="7436c-129">有关 IIS 的详细信息，请参阅 [Web 服务器 (IIS)](https://technet.microsoft.com/library/hh831725.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="7436c-129">See [Web Server (IIS)](https://technet.microsoft.com/library/hh831725.aspx) for more information about IIS.</span></span>  
  
 <span data-ttu-id="7436c-130">本主题包含下列部分：</span><span class="sxs-lookup"><span data-stu-id="7436c-130">This topic includes the following sections:</span></span>  
  
-   [<span data-ttu-id="7436c-131">概述</span><span class="sxs-lookup"><span data-stu-id="7436c-131">Overview</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="7436c-132">先决条件</span><span class="sxs-lookup"><span data-stu-id="7436c-132">Prerequisites</span></span>](#bkmk_prereq)  
  
-   [<span data-ttu-id="7436c-133">将 MSMDPUMP.dll 复制到 Web 服务器上的某个文件夹</span><span class="sxs-lookup"><span data-stu-id="7436c-133">Copy the MSMDPUMP.dll to a folder on the Web server</span></span>](#bkmk_copy)  
  
-   [<span data-ttu-id="7436c-134">在 IIS 中创建应用程序池和虚拟目录</span><span class="sxs-lookup"><span data-stu-id="7436c-134">Create an application pool and virtual directory in IIS</span></span>](#bkmk_appPool)  
  
-   [<span data-ttu-id="7436c-135">配置 IIS 身份验证和添加扩展插件</span><span class="sxs-lookup"><span data-stu-id="7436c-135">Configure IIS authentication and add the extension</span></span>](#bkmk_auth)  
  
-   [<span data-ttu-id="7436c-136">编辑 MSMDPUMP.INI 文件以便设置目标服务器</span><span class="sxs-lookup"><span data-stu-id="7436c-136">Edit the MSMDPUMP.INI file to set the target server</span></span>](#bkmk_edit)  
  
-   [<span data-ttu-id="7436c-137">测试您的配置</span><span class="sxs-lookup"><span data-stu-id="7436c-137">Test your configuration</span></span>](#bkmk_test)  
  
##  <a name="overview"></a><a name="bkmk_overview"></a> <span data-ttu-id="7436c-138">概述</span><span class="sxs-lookup"><span data-stu-id="7436c-138">Overview</span></span>  
 <span data-ttu-id="7436c-139">MSMDPUMP 是一个 ISAPI 扩展，可加载到 IIS 以及向本地或远程 Analysis Services 实例提供重定向。</span><span class="sxs-lookup"><span data-stu-id="7436c-139">MSMDPUMP is an ISAPI extension that loads into IIS and provides redirection to a local or remote Analysis Services instance.</span></span> <span data-ttu-id="7436c-140">配置此 ISAPI 扩展后，即创建 Analysis Services 实例的 HTTP 端点。</span><span class="sxs-lookup"><span data-stu-id="7436c-140">By configuring this ISAPI extension, you create an HTTP endpoint to an Analysis Services instance.</span></span>  
  
 <span data-ttu-id="7436c-141">必须为每个 HTTP 端点都创建并配置一个虚拟目录。</span><span class="sxs-lookup"><span data-stu-id="7436c-141">You must create and configure one virtual directory for each HTTP endpoint.</span></span> <span data-ttu-id="7436c-142">对于要连接到的每个 Analysis Services 实例，每个端点都将需要自身的一组 MSMDPUMP 文件。</span><span class="sxs-lookup"><span data-stu-id="7436c-142">Each endpoint will need its own set of MSMDPUMP files, for each Analysis Services instance you want to connect to.</span></span> <span data-ttu-id="7436c-143">这组文件中有一个配置文件指定用于每个 HTTP 端点的 Analysis Services 实例的名称。</span><span class="sxs-lookup"><span data-stu-id="7436c-143">A configuration file in this file set specifies the name of the Analysis Services instance used for each HTTP endpoint.</span></span>  
  
 <span data-ttu-id="7436c-144">在 IIS 上，MSMDPUMP 使用 Analysis Services OLE DB 访问接口通过 TCP/IP 连接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-144">On IIS, MSMDPUMP connects to Analysis Services using the Analysis Services OLE DB provider over TCP/IP.</span></span> <span data-ttu-id="7436c-145">尽管客户端请求可能来源于域信任之外，但 Analysis Services 和 IIS 都必须位于同一域中或位于可信域中，以便成功实现本机连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-145">Although client requests can originate outside of domain trust, both Analysis Services and IIS must be in the same domain or in trusted domains in order for the native connection to succeed.</span></span>  
  
 <span data-ttu-id="7436c-146">在 MSMDPUMP 连接到 Analysis Services 时，它基于 Windows 用户标识来这样做。</span><span class="sxs-lookup"><span data-stu-id="7436c-146">When MSMDPUMP connects to Analysis Services, it does so under a Windows user identity.</span></span> <span data-ttu-id="7436c-147">如果您为匿名连接配置了虚拟目录，则该帐户将是匿名帐户或 Windows 用户帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-147">This account will either be the Anonymous account if you configured the virtual directory for anonymous connections, or a Windows user account.</span></span> <span data-ttu-id="7436c-148">此帐户必须对 Analysis Services 服务器和数据库具有适当的数据访问权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-148">The account must have the appropriate data access rights on the Analysis Services server and database.</span></span>  
  
 <span data-ttu-id="7436c-149">![显示组件与组件之间的连接的关系图](../media/ssas.gif "显示组件与组件之间的连接的关系图")</span><span class="sxs-lookup"><span data-stu-id="7436c-149">![Diagram showing connections between components](../media/ssas.gif "Diagram showing connections between components")</span></span>  
  
 <span data-ttu-id="7436c-150">下表列出您为不同情形启用 HTTP 访问时需要注意的其他事项。</span><span class="sxs-lookup"><span data-stu-id="7436c-150">The following table lists additional considerations when you enable HTTP access for different scenarios.</span></span>  
  
|<span data-ttu-id="7436c-151">方案</span><span class="sxs-lookup"><span data-stu-id="7436c-151">Scenario</span></span>|<span data-ttu-id="7436c-152">配置</span><span class="sxs-lookup"><span data-stu-id="7436c-152">Configuration</span></span>|  
|--------------|-------------------|  
|<span data-ttu-id="7436c-153">IIS 和 Analysis Services 位于同一台计算机上</span><span class="sxs-lookup"><span data-stu-id="7436c-153">IIS and Analysis Services on the same computer</span></span>|<span data-ttu-id="7436c-154">这是最简单的配置，因为它允许您使用默认配置（其中，服务器名称为 localhost）、本地 Analysis Services OLE DB 访问接口以及与 NTLM 的 Windows 集成安全性。</span><span class="sxs-lookup"><span data-stu-id="7436c-154">This is the simplest configuration because it allows you to use the default configuration (where the server name is localhost), the local Analysis Services OLE DB provider, and Windows integrated security with NTLM.</span></span> <span data-ttu-id="7436c-155">假定客户端也在同一域中，用户意识不到身份验证的存在，并且您不需要做其他工作。</span><span class="sxs-lookup"><span data-stu-id="7436c-155">Assuming that the client is also in the same domain, authentication is transparent to the user, with no additional work on your part.</span></span>|  
|<span data-ttu-id="7436c-156">IIS 和 Analysis Services 位于不同计算机上</span><span class="sxs-lookup"><span data-stu-id="7436c-156">IIS and Analysis Services on different computers</span></span>|<span data-ttu-id="7436c-157">对于此拓扑，您必须将 Analysis Services OLE DB 访问接口安装在 Web 服务器上。</span><span class="sxs-lookup"><span data-stu-id="7436c-157">For this topology, you must install the Analysis Services OLE DB provider on the web server.</span></span> <span data-ttu-id="7436c-158">您还必须编辑 msmdpump.ini 文件，以便指定 Analysis Services 实例在远程计算机上的位置。</span><span class="sxs-lookup"><span data-stu-id="7436c-158">You must also edit the msmdpump.ini file to specify the location of Analysis Services instance on the remote computer.</span></span><br /><br /> <span data-ttu-id="7436c-159">此拓扑添加了双跃点身份验证步骤，其中，凭据必须从客户端流到 Web 服务器，然后流到后端 Analysis Services 服务器上。</span><span class="sxs-lookup"><span data-stu-id="7436c-159">This topology adds a double-hop authentication step, where credentials must flow from the client to the web server, and on to the backend Analysis Services server.</span></span> <span data-ttu-id="7436c-160">如果您在使用 Windows 凭据和 NTLM，系统将会显示错误消息，因为 NTLM 不允许将客户端凭据委托给第二个服务器。</span><span class="sxs-lookup"><span data-stu-id="7436c-160">If you are using Windows credentials and NTLM, you will get an error because NTLM does not allow delegation of client credentials to a second server.</span></span> <span data-ttu-id="7436c-161">最常见的解决方案是将基本身份验证用于安全套接字层 (SSL)，但是，这就要求用户在访问 MSMDPUMP 虚拟目录时提供用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="7436c-161">The most common solution is to use Basic authentication with Secure Sockets Layer (SSL), but this will require users to provide a user name and password when accessing the MSMDPUMP virtual directory.</span></span> <span data-ttu-id="7436c-162">一个更为直接的方法可能是启用 Kerberos 并且配置 Analysis Services 约束委派，以便用户能够以透明的方式访问 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-162">A more straightforward approach might be to enable Kerberos and configure Analysis Services constrained delegation so that users can access Analysis Services in a transparent manner.</span></span> <span data-ttu-id="7436c-163">有关详细信息，请参阅 [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md) 。</span><span class="sxs-lookup"><span data-stu-id="7436c-163">See [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md) for details.</span></span><br /><br /> <span data-ttu-id="7436c-164">考虑要在 Windows 防火墙中取消阻止的端口。</span><span class="sxs-lookup"><span data-stu-id="7436c-164">Consider which ports to unblock in Windows Firewall.</span></span> <span data-ttu-id="7436c-165">您将需要取消阻止这两台服务器上的端口，以便允许访问 IIS 上的 Web 应用程序以及远程服务器上的 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-165">You will need to unblock ports on both servers to allow access to the web application on IIS, and to Analysis Services on a remote server.</span></span>|  
|<span data-ttu-id="7436c-166">客户端连接来自不可信域或 extranet 连接</span><span class="sxs-lookup"><span data-stu-id="7436c-166">Client connections are from a non-trusted domain or an extranet connection</span></span>|<span data-ttu-id="7436c-167">来自不可信域的客户端连接对身份验证带来进一步的限制。</span><span class="sxs-lookup"><span data-stu-id="7436c-167">Client connections from a non-trusted domain introduce further restrictions on authentication.</span></span> <span data-ttu-id="7436c-168">默认情况下，Analysis Services 使用 Windows 集成身份验证，这要求用户与服务器处于同一域中。</span><span class="sxs-lookup"><span data-stu-id="7436c-168">By default, Analysis Services uses Windows integrated authentication, which requires users to be on the same domain as the server.</span></span> <span data-ttu-id="7436c-169">如果您具有从域的外部连接到 IIS 的 Extranet 用户，则在服务器配置为使用默认设置时，这些用户将会收到连接错误。</span><span class="sxs-lookup"><span data-stu-id="7436c-169">If you have Extranet users who connect to IIS from outside the domain, those users will get a connection error if the server is configured to use the default settings.</span></span><br /><br /> <span data-ttu-id="7436c-170">解决方法包括让 Extranet 用户使用域凭据通过 VPN 进行连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-170">Workarounds include having Extranet users connect through a VPN using domain credentials.</span></span> <span data-ttu-id="7436c-171">但是，一个更好的方法可能是在您的 IIS 网站上启用基本身份验证和 SSL。</span><span class="sxs-lookup"><span data-stu-id="7436c-171">However, a better approach might be to enable Basic authentication and SSL on your IIS web site.</span></span>|  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a><span data-ttu-id="7436c-172">先决条件</span><span class="sxs-lookup"><span data-stu-id="7436c-172">Prerequisites</span></span>  
 <span data-ttu-id="7436c-173">本文中的说明是假定已配置 IIS 并且已安装 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-173">The instructions in this article assume IIS is already configured and that Analysis Services is already installed.</span></span> <span data-ttu-id="7436c-174">Windows Server 2012 附带 IIS 8.x 作为服务器角色，你可以在系统上启用它。</span><span class="sxs-lookup"><span data-stu-id="7436c-174">Windows Server 2012 ships with IIS 8.x as a server role that you can enable on the system.</span></span>  
  
 <span data-ttu-id="7436c-175">**IIS 8.0 中的额外配置**</span><span class="sxs-lookup"><span data-stu-id="7436c-175">**Extra configuration in IIS 8.0**</span></span>  
  
 <span data-ttu-id="7436c-176">IIS 8.0 的默认配置缺少 HTTP 访问 Analysis Services 所必需的组件。</span><span class="sxs-lookup"><span data-stu-id="7436c-176">The default configuration of IIS 8.0 is missing components that are necessary for HTTP access to Analysis Services.</span></span> <span data-ttu-id="7436c-177">位于“ **Web 服务器 (IIS)** ”角色的“ **安全性** ”和“ **应用程序开发** ”功能区的这些组件包括：</span><span class="sxs-lookup"><span data-stu-id="7436c-177">These components, found in the **Security** and **Application Development** feature areas of the **Web Server (IIS)** role, include the following:</span></span>  
  
-   <span data-ttu-id="7436c-178">**安全**  | **Windows 身份验证**、**基本身份验证**和数据访问方案所需的任何其他安全功能。</span><span class="sxs-lookup"><span data-stu-id="7436c-178">**Security** | **Windows Authentication**, or **Basic Authentication**, and any other security features required for your data access scenario.</span></span>  
  
-   <span data-ttu-id="7436c-179">**应用程序开发**  | **CGI**</span><span class="sxs-lookup"><span data-stu-id="7436c-179">**Application Development** | **CGI**</span></span>  
  
-   <span data-ttu-id="7436c-180">**应用程序开发**  | **ISAPI 扩展**</span><span class="sxs-lookup"><span data-stu-id="7436c-180">**Application Development** | **ISAPI Extensions**</span></span>  
  
 <span data-ttu-id="7436c-181">若要验证或添加这些组件，请使用**服务器管理器**  |  **管理**"  |  **添加角色和功能**"。</span><span class="sxs-lookup"><span data-stu-id="7436c-181">To verify or add these components, use **Server Manager** | **Manage** | **Add Roles and Features**.</span></span> <span data-ttu-id="7436c-182">逐步执行向导直至到达 **“服务器角色”**。</span><span class="sxs-lookup"><span data-stu-id="7436c-182">Step through the wizard until you get to **Server Roles**.</span></span> <span data-ttu-id="7436c-183">向下滚动以查找“ **Web 服务器 (IIS)**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-183">Scroll down to find **Web Server (IIS)**.</span></span>  
  
1.  <span data-ttu-id="7436c-184">打开**Web 服务器**  |  **安全**，然后选择身份验证方法。</span><span class="sxs-lookup"><span data-stu-id="7436c-184">Open **Web Server** | **Security** and choose the authentication methods.</span></span>  
  
2.  <span data-ttu-id="7436c-185">打开**Web 服务器**  |  **应用程序开发**，然后选择**CGI**和**ISAPI 扩展**。</span><span class="sxs-lookup"><span data-stu-id="7436c-185">Open **Web Server** | **Application Development** and choose **CGI** and **ISAPI Extensions**.</span></span>  
  
     <span data-ttu-id="7436c-186">![添加 Web 服务器角色的功能页](../media/ssas-httpaccess-isapicgi.png "添加 Web 服务器角色的功能页")</span><span class="sxs-lookup"><span data-stu-id="7436c-186">![Add features page for Web server role](../media/ssas-httpaccess-isapicgi.png "Add features page for Web server role")</span></span>  
  
 <span data-ttu-id="7436c-187">**当 IIS 位于远程服务器上**</span><span class="sxs-lookup"><span data-stu-id="7436c-187">**When IIS is on a remote server**</span></span>  
  
 <span data-ttu-id="7436c-188">IIS 和 Analysis Services 之间的远程连接要求在运行 IIS 的 Windows 服务器上安装 Analysis Services OLE DB 提供程序 (MSOLAP)。</span><span class="sxs-lookup"><span data-stu-id="7436c-188">A remote connection between IIS and Analysis Services requires that you install the Analysis Services OLE DB provider (MSOLAP) on the Windows server running IIS.</span></span>  
  
1.  <span data-ttu-id="7436c-189">转到 [SQL Server 2014 功能包](https://www.microsoft.com/download/details.aspx?id=42295)的下载页</span><span class="sxs-lookup"><span data-stu-id="7436c-189">Go to the download page for [SQL Server 2014 Feature Pack](https://www.microsoft.com/download/details.aspx?id=42295)</span></span>  
  
2.  <span data-ttu-id="7436c-190">单击红色“下载”按钮。</span><span class="sxs-lookup"><span data-stu-id="7436c-190">Click the red Download button.</span></span>  
  
3.  <span data-ttu-id="7436c-191">向下滚动找到 ENU\x64\SQL_AS_OLEDB.msi</span><span class="sxs-lookup"><span data-stu-id="7436c-191">Scroll down to find ENU\x64\SQL_AS_OLEDB.msi</span></span>  
  
4.  <span data-ttu-id="7436c-192">按照向导中的说明完成安装。</span><span class="sxs-lookup"><span data-stu-id="7436c-192">Follow the instructions in the wizard to complete the installation.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7436c-193">请记住，为了允许与远程 Analysis Services 服务器的客户端连接，需取消阻止 Windows 防火墙中的端口。</span><span class="sxs-lookup"><span data-stu-id="7436c-193">Remember to unblock the ports in Windows Firewall to allow client connections to a remote Analysis Services server.</span></span> <span data-ttu-id="7436c-194">有关详细信息，请参阅 [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="7436c-194">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
##  <a name="step-1-copy-the-msmdpump-files-to-a-folder-on-the-web-server"></a><a name="bkmk_copy"></a> <span data-ttu-id="7436c-195">第 1 步：将 MSMDPUMP 文件复制到 Web 服务器上的某个文件夹</span><span class="sxs-lookup"><span data-stu-id="7436c-195">Step 1: Copy the MSMDPUMP files to a folder on the Web server</span></span>  
 <span data-ttu-id="7436c-196">所创建的每个 HTTP 端点均必须有其自身的一组 MSMDPUMP 文件。</span><span class="sxs-lookup"><span data-stu-id="7436c-196">Each HTTP endpoint that you create must have its own set of MSMDPUMP files.</span></span> <span data-ttu-id="7436c-197">在此步骤中，从 Analysis Services 程序文件夹中将 MSMDPUMP 可执行文件、配置文件和资源文件复制到新的虚拟目录文件夹，你将在运行 IIS 的计算机的文件系统上创建此虚拟目录文件夹。</span><span class="sxs-lookup"><span data-stu-id="7436c-197">In this step, you copy the MSMDPUMP executable, configuration file, and resource folder from the Analysis Services program folders to a new virtual directory folder that you will create on the file system of the computer running IIS.</span></span>  
  
 <span data-ttu-id="7436c-198">必须为 NTFS 文件系统格式化该驱动器。</span><span class="sxs-lookup"><span data-stu-id="7436c-198">The drive must be formatted for the NTFS file system.</span></span> <span data-ttu-id="7436c-199">指向您创建的文件夹的路径不得包含任何空格。</span><span class="sxs-lookup"><span data-stu-id="7436c-199">The path to the folder that you create must not contain any spaces.</span></span>  
  
1.  <span data-ttu-id="7436c-200">复制以下文件，该文件位于 \<drive> ： \Program Files\Microsoft SQL Server \\<instance \> \OLAP\bin\isapi： MSMDPUMP.DLL、MSMDPUMP.INI 和 Resources 文件夹。</span><span class="sxs-lookup"><span data-stu-id="7436c-200">Copy the following files, found at \<drive>:\Program Files\Microsoft SQL Server\\<instance\>\OLAP\bin\isapi: MSMDPUMP.DLL, MSMDPUMP.INI, and a Resources folder.</span></span>  
  
     <span data-ttu-id="7436c-201">![显示要复制的文件的文件资源管理器](../media/ssas-httpaccess-msmdpumpfilecopy.PNG "显示要复制的文件的文件资源管理器")</span><span class="sxs-lookup"><span data-stu-id="7436c-201">![File Explorer showing files to copy](../media/ssas-httpaccess-msmdpumpfilecopy.PNG "File Explorer showing files to copy")</span></span>  
  
2.  <span data-ttu-id="7436c-202">在 web 服务器上，创建一个新文件夹： \<drive> ： \Inetpub\wwwroot \\ **OLAP**</span><span class="sxs-lookup"><span data-stu-id="7436c-202">On the web server, create a new folder: \<drive>:\inetpub\wwwroot\\**OLAP**</span></span>  
  
3.  <span data-ttu-id="7436c-203">将先前复制的文件粘贴到这个新文件夹。</span><span class="sxs-lookup"><span data-stu-id="7436c-203">Paste the files that you previously copied into this new folder.</span></span>  
  
4.  <span data-ttu-id="7436c-204">确认 Web 服务器上的 \inetpub\wwwroot\OLAP 文件夹含有以下各项：MSMDPUMP.DLL、MSMDPUMP.INI 和 Resources 文件夹。</span><span class="sxs-lookup"><span data-stu-id="7436c-204">Verify that the \inetpub\wwwroot\OLAP folder on your web server contains the following: MSMDPUMP.DLL, MSMDPUMP.INI, and a Resources folder.</span></span> <span data-ttu-id="7436c-205">文件夹结构应类似于此：</span><span class="sxs-lookup"><span data-stu-id="7436c-205">Your folder structure should look like this:</span></span>  
  
    -   <span data-ttu-id="7436c-206">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.dll</span><span class="sxs-lookup"><span data-stu-id="7436c-206">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.dll</span></span>  
  
    -   <span data-ttu-id="7436c-207">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.ini</span><span class="sxs-lookup"><span data-stu-id="7436c-207">\<drive>:\inetpub\wwwroot\OLAP\MSMDPUMP.ini</span></span>  
  
    -   <span data-ttu-id="7436c-208">\<drive>:\inetpub\wwwroot\OLAP\Resources</span><span class="sxs-lookup"><span data-stu-id="7436c-208">\<drive>:\inetpub\wwwroot\OLAP\Resources</span></span>  
  
##  <a name="step-2-create-an-application-pool-and-virtual-directory-in-iis"></a><a name="bkmk_appPool"></a> <span data-ttu-id="7436c-209">第 2 步：在 IIS 中创建应用程序池和虚拟目录</span><span class="sxs-lookup"><span data-stu-id="7436c-209">Step 2: Create an application pool and virtual directory in IIS</span></span>  
 <span data-ttu-id="7436c-210">接下来，创建应用程序池和抽取端点。</span><span class="sxs-lookup"><span data-stu-id="7436c-210">Next, create an application pool and an endpoint to the pump.</span></span>  
  
#### <a name="create-an-application-pool"></a><span data-ttu-id="7436c-211">创建应用程序池</span><span class="sxs-lookup"><span data-stu-id="7436c-211">Create an application pool</span></span>  
  
1.  <span data-ttu-id="7436c-212">启动 IIS 管理器。</span><span class="sxs-lookup"><span data-stu-id="7436c-212">Start IIS Manager.</span></span>  
  
2.  <span data-ttu-id="7436c-213">打开服务器文件夹，右键单击“ **应用程序池** ”，然后单击“ **添加应用程序池**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-213">Open the server folder, right-click **Application Pools** and then click **Add Application Pool**.</span></span> <span data-ttu-id="7436c-214">使用 .NET Framework 创建一个名为 **OLAP**的应用程序池，并且将托管的管道模式设置为“典型” \*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7436c-214">Create an application pool named **OLAP**, using the .NET Framework, with Managed pipeline mode set to **Classic**.</span></span>  
  
     <span data-ttu-id="7436c-215">![“添加应用程序池”对话框的屏幕快照](../media/ssas-httpaccess.PNG "“添加应用程序池”对话框的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-215">![Screenshot of Add Application Pool dialog](../media/ssas-httpaccess.PNG "Screenshot of Add Application Pool dialog")</span></span>  
  
3.  <span data-ttu-id="7436c-216">默认情况下，IIS 将使用 **“ApplicationPoolIdentity”** 作为安全标识创建应用程序池，这是实现对 Analysis Services 的 HTTP 访问的有效选择。</span><span class="sxs-lookup"><span data-stu-id="7436c-216">By default, IIS creates application pools using **ApplicationPoolIdentity** as the security identity, which is a valid choice for HTTP access to Analysis Services.</span></span> <span data-ttu-id="7436c-217">如果你因为特定原因需要更改标识，右键单击“ **OLAP**”，然后选择“ **高级设置**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-217">If you have specific reasons for changing the identity, right-click **OLAP**, and then select **Advanced Settings**.</span></span> <span data-ttu-id="7436c-218">选择 **“ApplicationPoolIdentity”**。</span><span class="sxs-lookup"><span data-stu-id="7436c-218">Select **ApplicationPoolIdentity**.</span></span> <span data-ttu-id="7436c-219">单击此属性的“ **更改** ”按钮，以便用你要使用的自定义帐户替换该内置帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-219">Click the **Change** button for this property to replace the built-in account with the custom account you want to use.</span></span>  
  
     <span data-ttu-id="7436c-220">![“高级设置”属性页的屏幕快照](../media/ssas-httpaccess-advsettings.PNG "“高级设置”属性页的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-220">![Screenshot of Advanced Settings property page](../media/ssas-httpaccess-advsettings.PNG "Screenshot of Advanced Settings property page")</span></span>  
  
4.  <span data-ttu-id="7436c-221">默认情况下，在 64 位操作系统上，IIS 将“ **启用 32 位应用程序** ”属性设置为 **false**。</span><span class="sxs-lookup"><span data-stu-id="7436c-221">By default, on a 64-bit operating system, IIS sets the **Enable 32-bit Applications** property to **false**.</span></span> <span data-ttu-id="7436c-222">如果您从 Analysis Services 的 64 位安装中复制了 msmdpump.dll，则这是针对 64 位 IIS 服务器上 MSMDPUMP 扩展插件的正确设置。</span><span class="sxs-lookup"><span data-stu-id="7436c-222">If you copied msmdpump.dll from a 64-bit installation of Analysis Services, this is the correct setting for the MSMDPUMP extension on a 64-bit IIS server.</span></span> <span data-ttu-id="7436c-223">如果你从 32 位安装中复制了 MSMDPUMP 二进制文件，则将其设置 **true**。</span><span class="sxs-lookup"><span data-stu-id="7436c-223">If you copied the MSMDPUMP binaries from a 32-bit installation, set it to **true**.</span></span> <span data-ttu-id="7436c-224">立即检查 **“高级设置”** 中的此属性，确保其设置正确。</span><span class="sxs-lookup"><span data-stu-id="7436c-224">Check this property now in **Advanced Settings** to ensure it is set correctly.</span></span>  
  
#### <a name="create-an-application"></a><span data-ttu-id="7436c-225">创建应用程序</span><span class="sxs-lookup"><span data-stu-id="7436c-225">Create an application</span></span>  
  
1.  <span data-ttu-id="7436c-226">在 IIS 管理器中，打开 **“站点”**，然后打开 **“默认网站”**。</span><span class="sxs-lookup"><span data-stu-id="7436c-226">In IIS Manager, open **Sites**, open **Default Web Site**.</span></span> <span data-ttu-id="7436c-227">将显示名为 **Olap**的文件夹。</span><span class="sxs-lookup"><span data-stu-id="7436c-227">You should see a folder named **Olap**.</span></span> <span data-ttu-id="7436c-228">这是你在 \inetpub\wwwroot 路径下创建的 OLAP 文件夹的引用。</span><span class="sxs-lookup"><span data-stu-id="7436c-228">This is a reference to the OLAP folder you created under \inetpub\wwwroot.</span></span>  
  
     <span data-ttu-id="7436c-229">![默认网站下的 OLAP 文件夹](../media/ssas-httpaccess-convertfolderbefore.png "默认网站下的 OLAP 文件夹")</span><span class="sxs-lookup"><span data-stu-id="7436c-229">![OLAP folder under default web site](../media/ssas-httpaccess-convertfolderbefore.png "OLAP folder under default web site")</span></span>  
  
2.  <span data-ttu-id="7436c-230">右键单击该文件夹，然后选择“ **转换为应用程序**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-230">Right-click the folder and choose **Convert to Application**.</span></span>  
  
3.  <span data-ttu-id="7436c-231">在“添加应用程序”中，输入 **OLAP** 作为别名。</span><span class="sxs-lookup"><span data-stu-id="7436c-231">In Add Application, enter **OLAP** for the alias.</span></span> <span data-ttu-id="7436c-232">单击 **“选择”** 以选择 OLAP 应用程序池。</span><span class="sxs-lookup"><span data-stu-id="7436c-232">Click **Select** to choose the OLAP application pool.</span></span> <span data-ttu-id="7436c-233">应将物理路径设置为 C:\inetpub\wwwroot\OLAP</span><span class="sxs-lookup"><span data-stu-id="7436c-233">Physical Path should be set to C:\inetpub\wwwroot\OLAP</span></span>  
  
     <span data-ttu-id="7436c-234">![“添加应用程序”对话框](../media/ssas-httpaccess-convertedapp.png "“添加应用程序”对话框")</span><span class="sxs-lookup"><span data-stu-id="7436c-234">![Add Application dialog box](../media/ssas-httpaccess-convertedapp.png "Add Application dialog box")</span></span>  
  
4.  <span data-ttu-id="7436c-235">单击“确定”  。</span><span class="sxs-lookup"><span data-stu-id="7436c-235">Click **OK**.</span></span> <span data-ttu-id="7436c-236">刷新网站，请注意默认网站下 OLAP 文件夹现在是一个应用程序。</span><span class="sxs-lookup"><span data-stu-id="7436c-236">Refresh the web site and notice that the OLAP folder is now an application under the default web site.</span></span> <span data-ttu-id="7436c-237">MSMDPUMP 文件的虚拟路径现已创建。</span><span class="sxs-lookup"><span data-stu-id="7436c-237">The virtual path to the MSMDPUMP file is now established.</span></span>  
  
     <span data-ttu-id="7436c-238">![应用程序转换后的 OLAP 文件夹](../media/ssas-httpaccess-convertfolderafter.png "应用程序转换后的 OLAP 文件夹")</span><span class="sxs-lookup"><span data-stu-id="7436c-238">![OLAP folder after app conversion](../media/ssas-httpaccess-convertfolderafter.png "OLAP folder after app conversion")</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7436c-239">这些说明的先前版本包括用于创建虚拟目录的步骤。</span><span class="sxs-lookup"><span data-stu-id="7436c-239">Previous versions of these instructions included steps for creating a virtual directory.</span></span> <span data-ttu-id="7436c-240">这些步骤已不需要。</span><span class="sxs-lookup"><span data-stu-id="7436c-240">That step is no longer necessary.</span></span>  
  
##  <a name="step-3-configure-iis-authentication-and-add-the-extension"></a><a name="bkmk_auth"></a> <span data-ttu-id="7436c-241">第 3 步：配置 IIS 身份验证和添加扩展</span><span class="sxs-lookup"><span data-stu-id="7436c-241">Step 3: Configure IIS authentication and add the extension</span></span>  
 <span data-ttu-id="7436c-242">在这一步中，进一步配置刚刚创建的 SSAS 虚拟目录。</span><span class="sxs-lookup"><span data-stu-id="7436c-242">In this step, you further configure the SSAS virtual directory you just created.</span></span> <span data-ttu-id="7436c-243">您将指定一个身份验证方法，然后添加脚本映射。</span><span class="sxs-lookup"><span data-stu-id="7436c-243">You will specify an authentication method and then add a script map.</span></span> <span data-ttu-id="7436c-244">Analysis Services 在 HTTP 上支持的身份验证方法包括：</span><span class="sxs-lookup"><span data-stu-id="7436c-244">Supported authentication methods for Analysis Services over HTTP include:</span></span>  
  
-   <span data-ttu-id="7436c-245">Windows 身份验证（Kerberos 或 NTLM）</span><span class="sxs-lookup"><span data-stu-id="7436c-245">Windows authentication (Kerberos or NTLM)</span></span>  
  
-   <span data-ttu-id="7436c-246">基本身份验证</span><span class="sxs-lookup"><span data-stu-id="7436c-246">Basic authentication</span></span>  
  
-   <span data-ttu-id="7436c-247">匿名身份验证</span><span class="sxs-lookup"><span data-stu-id="7436c-247">Anonymous authentication</span></span>  
  
 <span data-ttu-id="7436c-248">**Windows 身份验证** 被认为是最安全的身份验证方式，它利用现有使用 Active Directory 的网络基础结构。</span><span class="sxs-lookup"><span data-stu-id="7436c-248">**Windows authentication** is considered the most secure, and leverages existing infrastructure for networks that use Active Directory.</span></span> <span data-ttu-id="7436c-249">若要有效地使用 Windows 身份验证，所有浏览器、客户端应用程序和服务器应用程序均必须支持它。</span><span class="sxs-lookup"><span data-stu-id="7436c-249">To use Windows authentication effectively, all browsers, client applications, and server applications must support it.</span></span> <span data-ttu-id="7436c-250">这是最安全的模式，建议您使用，但它要求 IIS 可访问 Windows 域控制器，而后者需要能够验证请求连接的用户的身份。</span><span class="sxs-lookup"><span data-stu-id="7436c-250">This is the most secure and recommended mode, but it requires that IIS be able to access a Windows domain controller that can authenticate the identity of the user requesting a connection.</span></span>  
  
 <span data-ttu-id="7436c-251">如果拓扑中将 Analysis Services 和 IIS 置于不同的计算机上，则必须解决在需要将用户标识委托给远程计算机上的另一个服务时引发的双跃点问题，而通常是通过允许 Analysis Services 进行 Kerberos 约束委派实现这一点。</span><span class="sxs-lookup"><span data-stu-id="7436c-251">For topologies that put Analysis Services and IIS on different computers, you will need to address double-hop issues that arise when a user identity needs to be delegated to a second service on a remote machine, typically by enabling Analysis Services for Kerberos constrained delegation.</span></span> <span data-ttu-id="7436c-252">有关详细信息，请参阅 [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md)。</span><span class="sxs-lookup"><span data-stu-id="7436c-252">For more information, see [Configure Analysis Services for Kerberos constrained delegation](configure-analysis-services-for-kerberos-constrained-delegation.md).</span></span>  
  
 <span data-ttu-id="7436c-253">当你具有 Windows 身份时，将使用**基本身份验证** ，但由于用户连接来自不可信的域，因此禁止使用委托或模拟的连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-253">**Basic authentication** is used when you have Windows identities, but user connections are from non-trusted domains, prohibiting the use of delegated or impersonated connections.</span></span> <span data-ttu-id="7436c-254">通过基本身份验证，可在连接字符串中指定用户标识和密码。</span><span class="sxs-lookup"><span data-stu-id="7436c-254">Basic authentication lets you specify a user identity and password on a connection string.</span></span> <span data-ttu-id="7436c-255">不使用当前用户的安全上下文，而是使用连接字符串中的凭据连接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-255">Instead of using the security context of the current user, credentials on the connection string are used to connect to Analysis Services.</span></span> <span data-ttu-id="7436c-256">由于 Analysis Services 仅支持 Windows 身份验证，因此传递给它的任何凭据都必须是某个 Windows 用户或组，而后者必须是从中托管 Analysis Services 的域的成员。</span><span class="sxs-lookup"><span data-stu-id="7436c-256">Because Analysis Services supports only Windows authentication, any credentials passed to it must be a Windows user or group that is a member of the domain in which Analysis Services is hosted.</span></span>  
  
 <span data-ttu-id="7436c-257">初始测试期间经常使用**匿名身份验证** ，因为其易于配置，有助于快速验证与 Analysis Services 的 HTTP 连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-257">**Anonymous authentication** is often used during initial testing because its ease of configuration helps you to quickly validate HTTP connectivity to Analysis Services.</span></span> <span data-ttu-id="7436c-258">只需几步，即可分配唯一用户帐户作为标识，向该帐户授予 Analysis Services 中的权限，使用该帐户验证客户端应用程序中的数据访问，然后在测试完毕后禁用匿名身份验证。</span><span class="sxs-lookup"><span data-stu-id="7436c-258">In just a few steps, you can assign a unique user account as the identity, grant that account permissions in Analysis Services, use the account to verify data access in a client application, and then disable Anonymous authentication when testing is complete.</span></span>  
  
 <span data-ttu-id="7436c-259">如果用户没有 Windows 用户帐户，也可在生产环境中使用匿名身份验证，但要遵守在主机系统上锁定权限的最佳做法，如本文中所注： [启用匿名身份验证 (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="7436c-259">You can also use Anonymous authentication in a production environment if your users do not have Windows user accounts, but follow best practices by locking down permissions on the host system, as called out in this article: [Enable Anonymous Authentication (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx).</span></span> <span data-ttu-id="7436c-260">务必对虚拟目录（而不要对父级网站）设置身份验证以进一步降低帐户访问权限的级别。</span><span class="sxs-lookup"><span data-stu-id="7436c-260">Be sure that authentication is set on the virtual directory, and not on the parent web site, to further reduce the level of account access.</span></span>  
  
 <span data-ttu-id="7436c-261">启用匿名后，将允许任何连接到该 HTTP 端点的用户以匿名用户的身份进行连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-261">When Anonymous is enabled, any user connection to the HTTP endpoint is allowed to connect as the anonymous user.</span></span> <span data-ttu-id="7436c-262">您将无法审核单个用户连接，也无法使用用户标识从模型中选择数据。</span><span class="sxs-lookup"><span data-stu-id="7436c-262">You won't be able to audit individual user connections, nor use the user identity to select data from a model.</span></span> <span data-ttu-id="7436c-263">如您所见，使用匿名会影响从模型设计到数据刷新和访问权限的所有情况。</span><span class="sxs-lookup"><span data-stu-id="7436c-263">As you can see, using Anonymous impacts everything from model design, to data refresh and access.</span></span> <span data-ttu-id="7436c-264">但是，如果用户没有 Windows 用户登录名可用，则也许只能使用匿名帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-264">However, if users do not have a Windows user login to start with, using the Anonymous account might be your only option.</span></span>  
  
#### <a name="set-the-authentication-type-and-add-a-script-map"></a><span data-ttu-id="7436c-265">设置身份验证类型并添加脚本映射</span><span class="sxs-lookup"><span data-stu-id="7436c-265">Set the authentication type and add a script map</span></span>  
  
1.  <span data-ttu-id="7436c-266">在 IIS 管理器中，打开 **“站点”**，打开 **“默认网站”**，然后选择 **OLAP** 虚拟目录。</span><span class="sxs-lookup"><span data-stu-id="7436c-266">In IIS Manager, open **Sites**, open **Default Web Site**, and then select the **OLAP** virtual directory.</span></span>  
  
2.  <span data-ttu-id="7436c-267">在主页的 IIS 部分中双击“ **身份验证** ”。</span><span class="sxs-lookup"><span data-stu-id="7436c-267">Double-click **Authentication** in the IIS section of the main page.</span></span>  
  
     <span data-ttu-id="7436c-268">![IIS 管理器主页的屏幕快照](../media/ssas-httpaccess-iis.png "IIS 管理器主页的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-268">![Screenshot of IIS Manager main page](../media/ssas-httpaccess-iis.png "Screenshot of IIS Manager main page")</span></span>  
  
3.  <span data-ttu-id="7436c-269">如果您使用的是 Windows 集成安全性，请启用 **“Windows 身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="7436c-269">Enable **Windows Authentication** if you are using Windows integrated security.</span></span>  
  
     <span data-ttu-id="7436c-270">![“Vdir 身份验证”设置的屏幕快照](../media/ssas-httpaccess-iisauth.png "“Vdir 身份验证”设置的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-270">![Screenshot of Vdir Authentication settings](../media/ssas-httpaccess-iisauth.png "Screenshot of Vdir Authentication settings")</span></span>  
  
4.  <span data-ttu-id="7436c-271">或者，如果您的客户端和服务器应用程序处于不同的域中，则启用 **“基本身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="7436c-271">Alternatively, enable **Basic Authentication** if your client and server applications are in different domains.</span></span> <span data-ttu-id="7436c-272">此模式要求用户输入用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="7436c-272">This mode requires the user to enter a user name and password.</span></span> <span data-ttu-id="7436c-273">该用户名和密码通过 HTTP 连接传输到 IIS。</span><span class="sxs-lookup"><span data-stu-id="7436c-273">The user name and password are transmitted over the HTTP connection to IIS.</span></span> <span data-ttu-id="7436c-274">IIS 在连接到 MSMDPUMP 时将尝试使用所提供的凭据模拟用户的身份，但不会将凭据委托给 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-274">IIS will try to impersonate the user using the provided credentials when connecting to MSMDPUMP, but the credentials will not be delegated to Analysis Services.</span></span> <span data-ttu-id="7436c-275">而是需要由您在连接时传递有效的用户名和密码，如本文中的第 6 步所述。</span><span class="sxs-lookup"><span data-stu-id="7436c-275">Instead, you will need to pass a valid user name and password on a connection, as described in Step 6 in this document.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7436c-276">请注意，构建密码将传输到的系统的任何人都必须设法确保通信渠道的安全。</span><span class="sxs-lookup"><span data-stu-id="7436c-276">Please note that it is imperative for anyone building a system where the password is transmitted to have ways of securing the communication channel.</span></span> <span data-ttu-id="7436c-277">IIS 提供多种工具来帮助您确保通信渠道的安全。</span><span class="sxs-lookup"><span data-stu-id="7436c-277">IIS provides a set of tools that help you secure the channel.</span></span> <span data-ttu-id="7436c-278">有关详细信息，请参阅[如何在 IIS 7 上设置 SSL](https://go.microsoft.com/fwlink/?LinkId=207562)。</span><span class="sxs-lookup"><span data-stu-id="7436c-278">For more information, see [How to Set Up SSL on IIS 7](https://go.microsoft.com/fwlink/?LinkId=207562).</span></span>  
  
5.  <span data-ttu-id="7436c-279">如果使用的是 Windows 或基本身份验证，则禁用 **“匿名身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="7436c-279">Disable **Anonymous Authentication** if you are using Windows or Basic authentication.</span></span> <span data-ttu-id="7436c-280">启用匿名身份验证后，IIS 将始终首先使用该方法，即使启用了其他身份验证方法也是如此。</span><span class="sxs-lookup"><span data-stu-id="7436c-280">When Anonymous authentication is enabled, IIS will always use it first, even if other authentication methods are enabled.</span></span>  
  
     <span data-ttu-id="7436c-281">在匿名身份验证下，抽取操作 (msmdpump.dll) 以您为匿名用户建立的用户帐户身份运行。</span><span class="sxs-lookup"><span data-stu-id="7436c-281">Under Anonymous authentication, the pump (msmdpump.dll) runs as the user account you established for anonymous user.</span></span> <span data-ttu-id="7436c-282">连接到 IIS 的用户与连接到 Analysis Services 的用户之间没有区别。</span><span class="sxs-lookup"><span data-stu-id="7436c-282">There is no distinction between the user connecting to IIS and the user connecting to Analysis Services.</span></span> <span data-ttu-id="7436c-283">默认情况下，IIS 使用 IUSR 帐户，但可将其改为某个具有网络权限的域用户帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-283">By default, IIS uses the IUSR account, but you can change it to a domain user account that has network permissions.</span></span> <span data-ttu-id="7436c-284">如果 IIS 和 Analysis Services 在不同的计算机上，则需要此功能。</span><span class="sxs-lookup"><span data-stu-id="7436c-284">You'll need this capability if IIS and Analysis Services are on different computers.</span></span>  
  
     <span data-ttu-id="7436c-285">有关如何为匿名身份验证配置凭据的说明，请参阅 [匿名身份验证](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication)。</span><span class="sxs-lookup"><span data-stu-id="7436c-285">For instructions on how to configure credentials for Anonymous authentication, see [Anonymous Authentication](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7436c-286">匿名身份验证最常用于极端受控的环境中，其中通过文件系统中的访问控制列表向用户授予访问权限或拒绝用户访问。</span><span class="sxs-lookup"><span data-stu-id="7436c-286">Anonymous authentication is most likely found in an extremely controlled environment, where users are given or denied access by way of access control lists in the file system.</span></span> <span data-ttu-id="7436c-287">有关最佳做法，请参阅 [启用匿名身份验证 (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="7436c-287">For best practices, see [Enable Anonymous Authentication (IIS 7)](https://technet.microsoft.com/library/cc731244\(v=ws.10\).aspx).</span></span>  
  
6.  <span data-ttu-id="7436c-288">单击 **OLAP** 虚拟目录以便打开主页。</span><span class="sxs-lookup"><span data-stu-id="7436c-288">Click the **OLAP** virtual directory to open the main page.</span></span> <span data-ttu-id="7436c-289">双击“ **处理程序映射**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-289">Double-click **Handler Mappings**.</span></span>  
  
     <span data-ttu-id="7436c-290">![功能页中的处理程序映射图标](../media/ssas-httpaccess-handlermapping.png "功能页中的处理程序映射图标")</span><span class="sxs-lookup"><span data-stu-id="7436c-290">![Handler mapping icon in feature page](../media/ssas-httpaccess-handlermapping.png "Handler mapping icon in feature page")</span></span>  
  
7.  <span data-ttu-id="7436c-291">右键单击该页上的任何地方，然后选择“ **添加脚本映射**”。</span><span class="sxs-lookup"><span data-stu-id="7436c-291">Right-click anywhere on the page and then select **Add Script Map**.</span></span> <span data-ttu-id="7436c-292">在 "添加脚本映射" 对话框中，将\*\* \* .dll**指定为请求路径，将 c:\inetpub\wwwroot\OLAP\msmdpump.dll 指定为可执行文件，并键入**OLAP\*\*作为名称。</span><span class="sxs-lookup"><span data-stu-id="7436c-292">In the Add Script Map dialog box, specify **\*.dll** as the request path, specify c:\inetpub\wwwroot\OLAP\msmdpump.dll as the executable, and type **OLAP** as the name.</span></span> <span data-ttu-id="7436c-293">保持所有默认限制与此脚本映射相关联。</span><span class="sxs-lookup"><span data-stu-id="7436c-293">Keep all of the default restrictions associated with this script map.</span></span>  
  
     <span data-ttu-id="7436c-294">![“添加脚本映射”对话框的屏幕快照](../media/ssas-httpaccess-addscript.png "“添加脚本映射”对话框的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-294">![Screenshot of Add Script Map dialog box](../media/ssas-httpaccess-addscript.png "Screenshot of Add Script Map dialog box")</span></span>  
  
8.  <span data-ttu-id="7436c-295">在提示是否允许 ISAPI 扩展插件时，单击 **“是”**。</span><span class="sxs-lookup"><span data-stu-id="7436c-295">When prompted to allow the ISAPI extension, click **Yes**.</span></span>  
  
     <span data-ttu-id="7436c-296">![确认添加 ISAPI 扩展插件的屏幕快照](../media/ssas-httpaccess-isapiprompt.png "确认添加 ISAPI 扩展插件的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="7436c-296">![Screenshot of confirmation to add ISAPI extension](../media/ssas-httpaccess-isapiprompt.png "Screenshot of confirmation to add ISAPI extension")</span></span>  
  
##  <a name="step-4-edit-the-msmdpumpini-file-to-set-the-target-server"></a><a name="bkmk_edit"></a> <span data-ttu-id="7436c-297">第 4 步：编辑 MSMDPUMP.INI 文件以设置目标服务器</span><span class="sxs-lookup"><span data-stu-id="7436c-297">Step 4: Edit the MSMDPUMP.INI file to set the target server</span></span>  
 <span data-ttu-id="7436c-298">MSMDPUMP.INI 文件指定 MSMDPUMP.DLL 所连接的 Analysis Services 实例。</span><span class="sxs-lookup"><span data-stu-id="7436c-298">The MSMDPUMP.INI file specifies the Analysis Services instance that MSMDPUMP.DLL connects to.</span></span> <span data-ttu-id="7436c-299">此实例可以是本地或远程实例，并可作为默认实例或命名实例安装。</span><span class="sxs-lookup"><span data-stu-id="7436c-299">This instance can be local or remote, installed as the default or as a named instance.</span></span>  
  
 <span data-ttu-id="7436c-300">打开位于 C:\inetpub\wwwroot\OLAP 文件夹中的 msmdpump.ini 文件，查看该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="7436c-300">Open the msmdpump.ini file located in folder C:\inetpub\wwwroot\OLAP and take a look at the contents of this file.</span></span> <span data-ttu-id="7436c-301">该消息应类似于：</span><span class="sxs-lookup"><span data-stu-id="7436c-301">It should look like the following:</span></span>  
  
```  
<ConfigurationSettings>  
<ServerName>localhost</ServerName>  
<SessionTimeout>3600</SessionTimeout>  
<ConnectionPoolSize>100</ConnectionPoolSize>  
</ConfigurationSettings>  
  
```  
  
 <span data-ttu-id="7436c-302">如果您为其配置 HTTP 访问的 Analysis Services 实例位于本地计算机上并且作为默认实例安装，则无需更改该设置。</span><span class="sxs-lookup"><span data-stu-id="7436c-302">If the Analysis Services instance for which you are configuring HTTP access is located on the local computer and installed as a default instance, there is no reason to change this setting.</span></span> <span data-ttu-id="7436c-303">否则，必须指定服务器名称 (例如 \<ServerName> s r v-SRV01 \</ServerName>) 。</span><span class="sxs-lookup"><span data-stu-id="7436c-303">Otherwise, you must specify the server name (for example, \<ServerName>ADWRKS-SRV01\</ServerName>).</span></span> <span data-ttu-id="7436c-304">对于作为命名实例安装的服务器，请确保将实例名称追加 (例如 \<ServerName> ADWRKS-SRV01\Tabular \</ServerName>) 。</span><span class="sxs-lookup"><span data-stu-id="7436c-304">For a server that is installed as a named instance, be sure to append the instance name (for example, \<ServerName>ADWRKS-SRV01\Tabular\</ServerName>).</span></span>  
  
 <span data-ttu-id="7436c-305">默认情况下，Analysis Services 侦听 TCP/IP 端口 2383。</span><span class="sxs-lookup"><span data-stu-id="7436c-305">By default, Analysis Services listens on TCP/IP port 2383.</span></span> <span data-ttu-id="7436c-306">如果将 Analysis Services 作为默认实例安装，则无需在中指定任何端口， \<ServerName> 因为 Analysis Services 知道如何自动侦听端口2383。</span><span class="sxs-lookup"><span data-stu-id="7436c-306">If you installed Analysis Services as the default instance, you do not need to specify any port in \<ServerName> because Analysis Services knows how to listen on port 2383 automatically.</span></span> <span data-ttu-id="7436c-307">但是，您确实需要在 Windows 防火墙中允许与该端口的入站连接。</span><span class="sxs-lookup"><span data-stu-id="7436c-307">However, you do need to allow inbound connections to that port in Windows Firewall.</span></span> <span data-ttu-id="7436c-308">有关详细信息，请参阅 [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="7436c-308">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
 <span data-ttu-id="7436c-309">如果已将 Analysis Services 的命名实例或默认实例配置为侦听固定端口，则必须将端口号添加到服务器名称 (例如， \<ServerName> SRV01： 55555 \</ServerName>) ，并且必须允许 Windows 防火墙中的入站连接到该端口。</span><span class="sxs-lookup"><span data-stu-id="7436c-309">If you configured a named or default instance of Analysis Services to listen on a fixed port, you must add the port number to the server name (for example, \<ServerName>AW-SRV01:55555\</ServerName>) and you must allow inbound connections in Windows Firewall to that port.</span></span>  
  
## <a name="step-5-grant-data-access-permissions"></a><span data-ttu-id="7436c-310">第 5 步：授予数据访问权限</span><span class="sxs-lookup"><span data-stu-id="7436c-310">Step 5: Grant data access permissions</span></span>  
 <span data-ttu-id="7436c-311">如上所述，你需要向 Analysis Services 实例授权。</span><span class="sxs-lookup"><span data-stu-id="7436c-311">As previously noted, you will need to grant permissions on the Analysis Services instance.</span></span> <span data-ttu-id="7436c-312">每个数据库对象都将具有提供给定级别权限（读或读/写）的角色，而每个角色都将具有由 Windows 用户标识组成的成员。</span><span class="sxs-lookup"><span data-stu-id="7436c-312">Each database object will have roles that provide a given level of permissions (read or read/write), and each role will have members consisting of Windows user identities.</span></span>  
  
 <span data-ttu-id="7436c-313">若要设置权限，可使用 SQL Server Management Studio。</span><span class="sxs-lookup"><span data-stu-id="7436c-313">To set permissions, you can use SQL Server Management Studio.</span></span> <span data-ttu-id="7436c-314">在 "**数据库**  |  **角色**" 文件夹下，您可以创建角色、指定数据库权限、向 Windows 用户或组帐户分配成员身份，然后授予对特定对象的读或写权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-314">Under the **Database** | **Roles** folder, you can create roles, specify database permissions, assign membership to Windows user or group accounts, and then grant read or write permissions on specific objects.</span></span> <span data-ttu-id="7436c-315">通常，使用但不更新模型数据的客户端连接只需对多维数据集的 **“读取”** 权限即可。</span><span class="sxs-lookup"><span data-stu-id="7436c-315">Typically, **Read** permissions on a cube are sufficient for client connections that use, but do not update, model data.</span></span>  
  
 <span data-ttu-id="7436c-316">角色分配根据配置身份验证的方式而异。</span><span class="sxs-lookup"><span data-stu-id="7436c-316">Role assignment varies depending on how you configured authentication.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="7436c-317">匿名</span><span class="sxs-lookup"><span data-stu-id="7436c-317">Anonymous</span></span>|<span data-ttu-id="7436c-318">向成员身份列表添加在 IIS 的 **“编辑匿名身份验证凭据”** 中指定的帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-318">Add to the Membership list the account specified in **Edit Anonymous Authentication Credentials** in IIS.</span></span> <span data-ttu-id="7436c-319">有关详细信息，请参阅 [匿名身份验证](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication)。</span><span class="sxs-lookup"><span data-stu-id="7436c-319">For more information, see [Anonymous Authentication](http://www.iis.net/configreference/system.webserver/security/authentication/anonymousauthentication),</span></span>|  
|<span data-ttu-id="7436c-320">Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="7436c-320">Windows authentication</span></span>|<span data-ttu-id="7436c-321">向成员身份列表添加通过模拟或委托请求 Analysis Services 数据的 Windows 用户或组帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-321">Add to the Membership list the Windows user or group accounts requesting Analysis Services data via impersonation or delegation.</span></span><br /><br /> <span data-ttu-id="7436c-322">假设使用 Kerberos 约束的委派，唯一需要权限的帐户是请求访问的 Windows 用户和组帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-322">Assuming Kerberos constrained delegation is used, the only accounts that need permissions are the Windows user and group accounts requesting access.</span></span> <span data-ttu-id="7436c-323">应用程序池标识不需要任何权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-323">No permissions are necessary for the application pool identity.</span></span>|  
|<span data-ttu-id="7436c-324">基本身份验证</span><span class="sxs-lookup"><span data-stu-id="7436c-324">Basic authentication</span></span>|<span data-ttu-id="7436c-325">向成员身份列表添加将在连接字符串中传递的 Windows 用户或组帐户。</span><span class="sxs-lookup"><span data-stu-id="7436c-325">Add to the Membership list the Windows user or group accounts that will be passed on the connection string.</span></span><br /><br /> <span data-ttu-id="7436c-326">此外，如果通过连接字符串上的 `EffectiveUserName` 传递凭据，则应用程序池标识必须具有 Analysis Services 实例上的管理员权限。</span><span class="sxs-lookup"><span data-stu-id="7436c-326">In addition, if you are passing credentials via `EffectiveUserName` on the connection string, then the application pool identity must have administrator rights on the Analysis Services instance.</span></span> <span data-ttu-id="7436c-327">在 SSMS 中，右键单击实例 &#124;**属性**"&#124;**安全**&#124;"**添加**"。</span><span class="sxs-lookup"><span data-stu-id="7436c-327">In SSMS, right-click the instance &#124; **Properties** &#124; **Security** &#124; **Add**.</span></span> <span data-ttu-id="7436c-328">输入应用程序池标识。</span><span class="sxs-lookup"><span data-stu-id="7436c-328">Enter the application pool identity.</span></span> <span data-ttu-id="7436c-329">如果使用内置的默认标识，则该帐户将指定为**IIS AppPool\DefaultAppPool**。</span><span class="sxs-lookup"><span data-stu-id="7436c-329">If you used the built-in default identity, the account is specified as **IIS AppPool\DefaultAppPool**.</span></span><br /><br /> ![](../media/ssas-httpaccess-iisapppoolidentity.png)|  
  
 <span data-ttu-id="7436c-330">有关设置权限的详细信息，请参阅 [授予对对象和操作的访问权限&#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="7436c-330">For more information about setting permissions, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
##  <a name="step-6-test-your-configuration"></a><a name="bkmk_test"></a><span data-ttu-id="7436c-331">步骤6：测试您的配置</span><span class="sxs-lookup"><span data-stu-id="7436c-331">Step 6: Test your configuration</span></span>  
 <span data-ttu-id="7436c-332">针对 MSMDPUMP 的连接字符串语法是指向 MSMDPUMP.dll 文件的 URL。</span><span class="sxs-lookup"><span data-stu-id="7436c-332">The connection string syntax for MSMDPUMP is the URL to the MSMDPUMP.dll file.</span></span>  
  
 <span data-ttu-id="7436c-333">如果 web 应用程序正在侦听固定端口，请将端口号附加到服务器名称或 IP 地址，例如 `http://my-web-srv01:8080/OLAP/msmdpump.dll` 或 `http://123.456.789.012:8080/OLAP/msmdpump.dll` 。</span><span class="sxs-lookup"><span data-stu-id="7436c-333">If the web application is listening on a fixed port, append the port number to the server name or IP address, for example, `http://my-web-srv01:8080/OLAP/msmdpump.dll` or `http://123.456.789.012:8080/OLAP/msmdpump.dll`.</span></span>  
  
 <span data-ttu-id="7436c-334">若要快速测试连接，你可以使用 Microsoft Excel 或 SQL Server Management Studio 打开连接</span><span class="sxs-lookup"><span data-stu-id="7436c-334">To quickly test the connection, you can open a connection using Microsoft Excel or SQL Server Management Studio</span></span>  
  
 <span data-ttu-id="7436c-335">**使用 SQL Server Management Studio 测试连接**</span><span class="sxs-lookup"><span data-stu-id="7436c-335">**Test connections using SQL Server Management Studio**</span></span>  
  
1.  <span data-ttu-id="7436c-336">在 Management Studio 的“连接到服务器”对话框中，选择 **Analysis Services** 作为服务器类型。</span><span class="sxs-lookup"><span data-stu-id="7436c-336">In Management Studio, in the Connect to Server dialog box, select **Analysis Services** as the server type.</span></span> <span data-ttu-id="7436c-337">在“服务器名称”中，输入 msmdpump 扩展的 HTTP 地址： `http://my-web-srv01/OLAP/msmdpump.dll`。</span><span class="sxs-lookup"><span data-stu-id="7436c-337">In Server name, enter the HTTP address of the msmdpump extension: `http://my-web-srv01/OLAP/msmdpump.dll`.</span></span>  
  
     <span data-ttu-id="7436c-338">对象资源管理器将显示 HTTP 连接：</span><span class="sxs-lookup"><span data-stu-id="7436c-338">Object Explorer displays the HTTP connection:</span></span>  
  
     <span data-ttu-id="7436c-339">![显示到 SSAS 的 http 连接的对象资源管理器](../media/ssas-httpaccess-ssms.PNG "显示到 SSAS 的 http 连接的对象资源管理器")</span><span class="sxs-lookup"><span data-stu-id="7436c-339">![Object Explorer showing http connection to SSAS](../media/ssas-httpaccess-ssms.PNG "Object Explorer showing http connection to SSAS")</span></span>  
  
2.  <span data-ttu-id="7436c-340">身份验证必须为 Windows 身份验证，并且使用 Management Studio 的人员必须是 Analysis Services 管理员。</span><span class="sxs-lookup"><span data-stu-id="7436c-340">Authentication must be Windows authentication, and the person using Management Studio must be an Analysis Services administrator.</span></span> <span data-ttu-id="7436c-341">管理员可以授予进一步权限以允许其他用户的访问。</span><span class="sxs-lookup"><span data-stu-id="7436c-341">An administrator can grant further permissions to enable access by other users.</span></span>  
  
 <span data-ttu-id="7436c-342">**使用 Excel 测试连接**</span><span class="sxs-lookup"><span data-stu-id="7436c-342">**Test connections using Excel**</span></span>  
  
1.  <span data-ttu-id="7436c-343">在 Excel 的“数据”选项卡上的“获取外部数据”中，单击 **“从其他源”**，然后选择 **“从 Analysis Services”** 以启动数据连接向导。</span><span class="sxs-lookup"><span data-stu-id="7436c-343">On the Data tab in Excel, in Get External Data, click **From Other Sources**, and then choose **From Analysis Services** to start the Data Connection wizard.</span></span>  
  
2.  <span data-ttu-id="7436c-344">在“服务器名称”中，输入 msmdpump 扩展的 HTTP 地址： `http://my-web-srv01/OLAP/msmdpump.dll`。</span><span class="sxs-lookup"><span data-stu-id="7436c-344">In Server name, enter the HTTP address of the msmdpump extension: `http://my-web-srv01/OLAP/msmdpump.dll`.</span></span>  
  
3.  <span data-ttu-id="7436c-345">对于登录凭据，如果使用的是 Windows 集成安全性、NTLM 或匿名用户，则选择 **“使用 Windows 验证”** 。</span><span class="sxs-lookup"><span data-stu-id="7436c-345">For Log on credentials, choose **Use Windows Authentication** if you are using Windows integrated security or NTLM, or Anonymous user.</span></span>  
  
     <span data-ttu-id="7436c-346">对于基本身份验证，选择 **“使用下列用户名和密码”**，然后指定用于登录的凭据。</span><span class="sxs-lookup"><span data-stu-id="7436c-346">For Basic authentication, choose **Use the following User Name and Password**, and then specify the credentials used to sign on.</span></span> <span data-ttu-id="7436c-347">随后将在连接字符串中将所提供的凭据传递给 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="7436c-347">The credentials you provide will be passed on the connection string to Analysis Services.</span></span>  
  
 <span data-ttu-id="7436c-348">**使用 AMO 测试连接**</span><span class="sxs-lookup"><span data-stu-id="7436c-348">**Test connections using AMO**</span></span>  
  
 <span data-ttu-id="7436c-349">可使用 AMO 以编程方式测试 HTTP 访问，将服务器名称替换为端点 URL。</span><span class="sxs-lookup"><span data-stu-id="7436c-349">You can test HTTP access programmatically using AMO, substituting the URL of the endpoint for the server name.</span></span> <span data-ttu-id="7436c-350">有关详细信息，请参阅 [论坛帖子（如何跨域/林和防火墙边界通过 HTTPS 同步 SSAS 2008 R2 数据库）](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/c4249d55-914d-4c81-9980-44d0b8df9c3e)。</span><span class="sxs-lookup"><span data-stu-id="7436c-350">For details, see [Forum Post (How to sync SSAS 2008 R2 databases via HTTPS across domain/forest and firewall boundaries)](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/c4249d55-914d-4c81-9980-44d0b8df9c3e).</span></span>  
  
 <span data-ttu-id="7436c-351">下面是连接字符串的一个示例，其中说明使用基本身份验证进行 HTTP(S) 访问的语法：</span><span class="sxs-lookup"><span data-stu-id="7436c-351">An example connection string illustrating the syntax for HTTP(S) access using Basic authentication:</span></span>  
  
 `Data Source=https://<servername>/olap/msmdpump.dll; Initial Catalog=AdventureWorksDW2012; Integrated Security=Basic; User ID=XXXX; Password=XXXXX;`  
  
 <span data-ttu-id="7436c-352">有关以编程方式设置连接的详细信息，请参阅 [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections)。</span><span class="sxs-lookup"><span data-stu-id="7436c-352">For more information about setting up the connection programmatically, see [Establishing Secure Connections in ADOMD.NET](https://docs.microsoft.com/analysis-services/adomd/multidimensional-models-adomd-net-client/connections-in-adomd-net-establishing-secure-connections).</span></span>  
  
 <span data-ttu-id="7436c-353">作为最后一步，务必通过使用在将从其发起连接的网络环境中运行的客户端计算机，继续进行更严格的测试。</span><span class="sxs-lookup"><span data-stu-id="7436c-353">As a final step, be sure to follow-up with more rigorous testing by using a client computer that runs in the network environment from which the connections will originate.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7436c-354">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7436c-354">See Also</span></span>  
 <span data-ttu-id="7436c-355">[论坛帖子 (使用 msmdpump 和基本身份验证进行 http 访问) ](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/79d2f225-df35-46da-aa22-d06e98f7d658) </span><span class="sxs-lookup"><span data-stu-id="7436c-355">[Forum post (http access using msmdpump and basic authentication)](https://social.msdn.microsoft.com/Forums/en/sqlanalysisservices/thread/79d2f225-df35-46da-aa22-d06e98f7d658) </span></span>  
 <span data-ttu-id="7436c-356">[将 Windows 防火墙配置为允许 Analysis Services 访问](configure-the-windows-firewall-to-allow-analysis-services-access.md) </span><span class="sxs-lookup"><span data-stu-id="7436c-356">[Configure the Windows Firewall to Allow Analysis Services Access](configure-the-windows-firewall-to-allow-analysis-services-access.md) </span></span>  
 <span data-ttu-id="7436c-357">[授权对对象和操作的访问 &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="7436c-357">[Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md) </span></span>  
 <span data-ttu-id="7436c-358">[IIS 身份验证方法](https://go.microsoft.com/fwlink/?LinkdID=208461) </span><span class="sxs-lookup"><span data-stu-id="7436c-358">[IIS Authentication Methods](https://go.microsoft.com/fwlink/?LinkdID=208461) </span></span>  
 [<span data-ttu-id="7436c-359">如何在 IIS 7 上设置 SSL</span><span class="sxs-lookup"><span data-stu-id="7436c-359">How to Set Up SSL on IIS 7</span></span>](https://go.microsoft.com/fwlink/?LinkId=207562)  
  
