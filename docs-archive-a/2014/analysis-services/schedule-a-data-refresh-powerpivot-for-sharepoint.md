---
title: 计划数据刷新 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9d6078cf59c27c15ead8f22047ba9add20757be7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579115"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="701a6-102">计划数据刷新 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="701a6-102">Schedule a Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="701a6-103">您可以计划数据刷新，以便自动获取对您发布到 SharePoint 站点的 Excel 工作簿内的 PowerPivot 数据的更新。</span><span class="sxs-lookup"><span data-stu-id="701a6-103">You can schedule data refresh to get automatic updates to PowerPivot data inside an Excel workbook that you published to a SharePoint site.</span></span>  
  
 <span data-ttu-id="701a6-104">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="701a6-104">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="701a6-105">**本主题内容：**</span><span class="sxs-lookup"><span data-stu-id="701a6-105">**In this topic:**</span></span>  
  
 [<span data-ttu-id="701a6-106">先决条件</span><span class="sxs-lookup"><span data-stu-id="701a6-106">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="701a6-107">数据刷新概述</span><span class="sxs-lookup"><span data-stu-id="701a6-107">Data Refresh Overview</span></span>](#intro)  
  
 [<span data-ttu-id="701a6-108">启用并计划数据刷新</span><span class="sxs-lookup"><span data-stu-id="701a6-108">Enable and schedule data refresh</span></span>](#drenablesched)  
  
 [<span data-ttu-id="701a6-109">验证数据刷新</span><span class="sxs-lookup"><span data-stu-id="701a6-109">Verify Data Refresh</span></span>](#drverify)  
  
> [!NOTE]  
>  <span data-ttu-id="701a6-110">PowerPivot 数据刷新由 SharePoint 场中的 Analysis Services 服务器实例执行。</span><span class="sxs-lookup"><span data-stu-id="701a6-110">PowerPivot data refresh is performed by Analysis Services server instances in the SharePoint farm.</span></span> <span data-ttu-id="701a6-111">它与 Excel Services 中提供的数据刷新功能无关。</span><span class="sxs-lookup"><span data-stu-id="701a6-111">It is not related to the data refresh feature that is provided in Excel Services.</span></span> <span data-ttu-id="701a6-112">PowePivot 计划数据刷新功能不会刷新非 PowerPivot 数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-112">The PowePivot Schedule data refresh feature will not refresh non PowerPivot data.</span></span>  
  
##  <a name="prerequisites"></a><a name="prereq"></a><span data-ttu-id="701a6-113">先决条件</span><span class="sxs-lookup"><span data-stu-id="701a6-113">Prerequisites</span></span>  
 <span data-ttu-id="701a6-114">若要创建数据刷新计划，您必须对工作簿具有“参与讨论”或更高级别的权限。</span><span class="sxs-lookup"><span data-stu-id="701a6-114">You must have Contribute level of permission or greater on the workbook to create a data refresh schedule.</span></span>  
  
 <span data-ttu-id="701a6-115">在数据刷新过程中访问的外部数据必须可用，并且您在计划中指定的凭据必须具有访问这些数据源的权限。</span><span class="sxs-lookup"><span data-stu-id="701a6-115">External data sources that are accessed during data refresh must be available and the credentials you specify in the schedule must have permission to access those data sources.</span></span> <span data-ttu-id="701a6-116">计划的数据刷新要求可通过网络连接访问的数据源位置（例如，从网络文件共享而非工作站上的本地文件夹）。</span><span class="sxs-lookup"><span data-stu-id="701a6-116">Scheduled data refresh requires a data source location that is accessible over a network connection (for example, from a network file share rather than a local folder on your workstation).</span></span>  
  
 <span data-ttu-id="701a6-117">该数据源不能是 Office 文档或 Access 数据库。</span><span class="sxs-lookup"><span data-stu-id="701a6-117">The data source cannot be an Office document or Access database.</span></span> <span data-ttu-id="701a6-118">Office 不支持在服务器环境中使用 Office 数据连接组件。</span><span class="sxs-lookup"><span data-stu-id="701a6-118">Office does not support the use of the Office data connectivity components in a server environment.</span></span> <span data-ttu-id="701a6-119">如果您的工作簿包含来自这些数据源的数据，则请确保从您的数据刷新计划的数据源列表中删除这些资源。</span><span class="sxs-lookup"><span data-stu-id="701a6-119">If your workbook contains data from these sources, be sure to remove those sources from the data source list in your data refresh schedule.</span></span>  
  
 <span data-ttu-id="701a6-120">工作簿必须是 [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="701a6-120">The workbook must be a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version.</span></span> <span data-ttu-id="701a6-121">如果您使用的是在早期版本的 PowerPivot for Excel 中创建的工作簿，则除非您将数据库升级到最新版本，否则计划数据刷新将不会工作。</span><span class="sxs-lookup"><span data-stu-id="701a6-121">If you use workbooks that were created in the previous release of PowerPivot for Excel, schedule data refresh will not work unless you upgrade the database to the most recent version.</span></span>  
  
 <span data-ttu-id="701a6-122">在刷新操作完成时，必须签入工作簿。</span><span class="sxs-lookup"><span data-stu-id="701a6-122">The workbook must be checked in at the time the refresh operation is finished.</span></span> <span data-ttu-id="701a6-123">在数据刷新结束（而非刷新开始）时，如果保存文件，针对工作簿的锁定将施加于该文件上。</span><span class="sxs-lookup"><span data-stu-id="701a6-123">A lock on the workbook is placed on the file at the end of data refresh, when the file is saved, rather than when refresh starts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="701a6-124">正在刷新数据时，服务器不会锁定工作簿。</span><span class="sxs-lookup"><span data-stu-id="701a6-124">The server does not lock the workbook while the data refresh is in progress.</span></span> <span data-ttu-id="701a6-125">但是，出于签入更新的文件的目的，在数据刷新结束时服务器将会锁定该文件。</span><span class="sxs-lookup"><span data-stu-id="701a6-125">However, it does lock the file at the end of data refresh for the purpose of checking in the updated file.</span></span> <span data-ttu-id="701a6-126">此时，如果该文件已签出给其他用户，则会引发刷新后的数据。同样，如果签入该文件，但该文件明显不同于在数据刷新开始时服务器检索的副本，则刷新的数据将被丢弃。</span><span class="sxs-lookup"><span data-stu-id="701a6-126">If at this time, the file is checked out to another user, the refreshed data will be thrown out. Similarly, if the file is checked in, but it is significantly different from the copy retrieved by the server at the start of data refresh, the refreshed data will be discarded.</span></span>  
  
##  <a name="data-refresh-overview"></a><a name="intro"></a><span data-ttu-id="701a6-127">数据刷新概述</span><span class="sxs-lookup"><span data-stu-id="701a6-127">Data Refresh Overview</span></span>  
 <span data-ttu-id="701a6-128">Excel 工作簿中的 PowerPivot 可源于多种不同的外部数据源，包括您从远程服务器或网络文件共享中访问的外部数据库或数据文件。</span><span class="sxs-lookup"><span data-stu-id="701a6-128">PowerPivot data in an Excel workbook can originate from multiple external data sources, including external databases or data files that you access from remote servers or network file shares.</span></span> <span data-ttu-id="701a6-129">对于包含从连接的数据源或外部数据源导入的数据的 PowerPivot 工作簿，您可以配置数据刷新以便计划自动导入这些原始数据源中更新的数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-129">For PowerPivot workbooks that contain imported data from connected or external data sources, you can configure data refresh to schedule an automatic import of updated data from those original sources.</span></span>  
  
 <span data-ttu-id="701a6-130">外部数据源是通过您在使用 PowerPivot 客户端应用程序将原始数据导入到工作簿时指定的嵌入连接字符串、URL 或 UNC 路径来访问的。</span><span class="sxs-lookup"><span data-stu-id="701a6-130">An external data source is accessed through an embedded connection string, URL, or UNC path that you specified when you imported the original data into the workbook using the PowerPivot client application.</span></span> <span data-ttu-id="701a6-131">在后续的数据刷新操作中将重复使用在 PowerPivot 工作簿中存储的原始连接信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-131">Original connection information that is stored in the PowerPivot workbook is reused for subsequent data refresh operations.</span></span> <span data-ttu-id="701a6-132">尽管您可以覆盖用于连接数据源的凭据，但您无法覆盖用于进行数据刷新的连接字符串；而只使用现有连接信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-132">Although you can overwrite credentials used to connect to data sources, you cannot overwrite connection strings for data refresh purposes; only existing connection information is used.</span></span>  
  
 <span data-ttu-id="701a6-133">对于每个工作簿，只有一个数据刷新计划页，并且将在该页上指定所有计划信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-133">There is only one data refresh schedule page for each workbook, and all schedule information is specified on that page.</span></span> <span data-ttu-id="701a6-134">通常，编写该工作簿的人员将定义该计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-134">Typically, the person who authored the workbook defines the schedule.</span></span>  
  
 <span data-ttu-id="701a6-135">作为计划所有者，您将执行以下任务：</span><span class="sxs-lookup"><span data-stu-id="701a6-135">As the schedule owner, you perform the following tasks:</span></span>  
  
-   <span data-ttu-id="701a6-136">定义默认计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-136">Define the default schedule.</span></span> <span data-ttu-id="701a6-137">这是在数据源级别未定义计划的情况下使用的计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-137">This is the schedule that is used if there are no scheduled defined at the data source level.</span></span>  
  
-   <span data-ttu-id="701a6-138">指定用于运行数据刷新的凭据</span><span class="sxs-lookup"><span data-stu-id="701a6-138">Specify the credentials used to run data refresh</span></span>  
  
-   <span data-ttu-id="701a6-139">选择要在数据刷新操作中包括的数据源。</span><span class="sxs-lookup"><span data-stu-id="701a6-139">Choose which data sources to include in the refresh operation.</span></span>  
  
-   <span data-ttu-id="701a6-140">或者，您可以为数据刷新过程中查询的每个数据源指定内联的单独计划和凭据。</span><span class="sxs-lookup"><span data-stu-id="701a6-140">Optionally, specify in-line, individual schedules and credentials for each data source that is queried during data refresh.</span></span> <span data-ttu-id="701a6-141">每个数据源都可以独立进行刷新。</span><span class="sxs-lookup"><span data-stu-id="701a6-141">Each data source can be refreshed independently.</span></span> <span data-ttu-id="701a6-142">如果您为每个数据源都创建了自定义计划，则忽略默认计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-142">If you create custom schedules for every data source, the default schedule is ignored.</span></span>  
  
 <span data-ttu-id="701a6-143">通过为单独数据源创建细粒度的计划，您可以使刷新计划适应外部数据源中的变动。</span><span class="sxs-lookup"><span data-stu-id="701a6-143">Creating granular schedules for individual data sources enables you to match the refresh schedule to fluctuations in the external data sources.</span></span> <span data-ttu-id="701a6-144">例如，如果外部数据源包含一整天生成的事务数据，则可以为该数据源创建单独的数据刷新计划，以便在每天夜里获取其更新的信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-144">For example, if an external data source contains transactional data that is generated throughout the day, you can create an individual data refresh schedule for that data source to get its updated information nightly.</span></span>  
  
##  <a name="enable-and-schedule-data-refresh"></a><a name="drenablesched"></a><span data-ttu-id="701a6-145">启用并计划数据刷新</span><span class="sxs-lookup"><span data-stu-id="701a6-145">Enable and schedule data refresh</span></span>  
 <span data-ttu-id="701a6-146">使用下面的说明可为发布到 SharePoint 库的 Excel 工作簿中的 PowerPivot 数据计划数据刷新。</span><span class="sxs-lookup"><span data-stu-id="701a6-146">Use the following instructions to schedule data refresh for PowerPivot data in an Excel workbook that is published to a SharePoint library.</span></span>  
  
1.  <span data-ttu-id="701a6-147">在包含该工作簿的库中，选择该工作簿，然后单击向下箭头以显示命令列表。</span><span class="sxs-lookup"><span data-stu-id="701a6-147">In the library that contains the workbook, select the workbook and then click the down arrow to display a list of commands.</span></span>  
  
2.  <span data-ttu-id="701a6-148">单击 **“管理 PowerPivot 数据刷新”**。</span><span class="sxs-lookup"><span data-stu-id="701a6-148">Click **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="701a6-149">如果已定义数据刷新计划，则您将看到“查看数据刷新历史记录”页。</span><span class="sxs-lookup"><span data-stu-id="701a6-149">If a data refresh schedule is already defined, you will see the View Data Refresh history page instead.</span></span> <span data-ttu-id="701a6-150">您可以单击 **“配置数据刷新”** 以打开计划定义页。</span><span class="sxs-lookup"><span data-stu-id="701a6-150">You can click **Configure data refresh** to open the schedule definition page.</span></span>  
  
3.  <span data-ttu-id="701a6-151">在计划定义页中，选中 **“启用”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="701a6-151">In the schedule definition page, select the **Enable** checkbox.</span></span>  
  
4.  <span data-ttu-id="701a6-152">在“计划详细信息”中，指定计划的类型并指定其详细信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-152">In Schedule Details, specify the type of schedule and specify its details.</span></span> <span data-ttu-id="701a6-153">此步骤将创建默认计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-153">This step creates the default schedule.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="701a6-154">请确保选中 **“也尽快刷新”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="701a6-154">Be sure to select the **Also refresh as soon as possible** checkbox.</span></span> <span data-ttu-id="701a6-155">这样一来，您便能确认可对此工作簿进行数据刷新。</span><span class="sxs-lookup"><span data-stu-id="701a6-155">Doing so lets you verify that data refresh is operational for this workbook.</span></span> <span data-ttu-id="701a6-156">请注意，数据刷新将在您保存计划后的 1 分钟内启动。</span><span class="sxs-lookup"><span data-stu-id="701a6-156">Note that after you save schedule, it can take up to a minute for data refresh to start.</span></span>  
  
5.  <span data-ttu-id="701a6-157">在“最早开始时间”中，选择下列选项之一：</span><span class="sxs-lookup"><span data-stu-id="701a6-157">In Earliest Start Time, choose one of the following:</span></span>  
  
    1.  <span data-ttu-id="701a6-158">**“在工作时间后”** 指定非工作时间的处理期间，在这个期间中，数据库服务器更可能收集到整个工作日所产生的最新数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-158">**After business hours** specifies an off-hours processing period when database servers are more likely to have current data that was generated throughout the business day.</span></span>  
  
    2.  <span data-ttu-id="701a6-159">**“特定的最早开始时间”** 是您希望将数据刷新请求添加到处理队列的当日最早时分。</span><span class="sxs-lookup"><span data-stu-id="701a6-159">**Specific earliest start time** is the hour and minutes of the earliest time of day the data refresh request is added to a process queue.</span></span> <span data-ttu-id="701a6-160">您可以按 15 分钟的间隔指定分钟。</span><span class="sxs-lookup"><span data-stu-id="701a6-160">You can specify minutes in 15-minute intervals.</span></span> <span data-ttu-id="701a6-161">这些设置会应用于当前日期和以后的日期</span><span class="sxs-lookup"><span data-stu-id="701a6-161">The setting applies to the current day as well as future dates.</span></span> <span data-ttu-id="701a6-162">例如，如果您指定值为早上 6:30，</span><span class="sxs-lookup"><span data-stu-id="701a6-162">For example, if you specify a value of 6:30 A.M.</span></span> <span data-ttu-id="701a6-163">而当前时间为下午 4:30，则刷新请求将会添加到当天的队列中，因为下午 4:30</span><span class="sxs-lookup"><span data-stu-id="701a6-163">and the current time is 4:30 P.M., the refresh request will be added to the queue in the current day because 4:30 P.M.</span></span> <span data-ttu-id="701a6-164">晚于早上 6:30。</span><span class="sxs-lookup"><span data-stu-id="701a6-164">is after 6:30 A.M.</span></span>  
  
     <span data-ttu-id="701a6-165">最早开始时间定义何时将请求添加到处理队列。</span><span class="sxs-lookup"><span data-stu-id="701a6-165">Earliest start time defines when a request is added to the process queue.</span></span> <span data-ttu-id="701a6-166">在服务器有足够的资源开始处理数据时将发生实际处理。</span><span class="sxs-lookup"><span data-stu-id="701a6-166">Actual processing occurs when the server has adequate resources to begin data processing.</span></span> <span data-ttu-id="701a6-167">处理完成后，实际的处理时间将记录在数据刷新历史记录中。</span><span class="sxs-lookup"><span data-stu-id="701a6-167">Actual processing time will be recorded in data refresh history after processing is complete.</span></span>  
  
6.  <span data-ttu-id="701a6-168">选中 **“也尽快刷新”** 复选框可以在服务器只要能够处理时就尽快运行数据刷新。</span><span class="sxs-lookup"><span data-stu-id="701a6-168">Select the checkbox **Also refresh as soon as possible** to run data refresh as soon as the server can process it.</span></span> <span data-ttu-id="701a6-169">成功的数据刷新作业结果确认数据源是可见的并且正确设置了权限和服务器配置。</span><span class="sxs-lookup"><span data-stu-id="701a6-169">A successful outcome of a data refresh job verifies that the data sources are available and that permissions and server configuration are set correctly.</span></span>  
  
7.  <span data-ttu-id="701a6-170">在“电子邮件通知”中，输入应该在发生处理错误时接到通知的人员的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="701a6-170">In E-mail notifications, enter the e-mail address of the person who should be notified in the event of a processing error.</span></span>  
  
8.  <span data-ttu-id="701a6-171">在“凭据”中，指定用于运行数据刷新作业的帐户。</span><span class="sxs-lookup"><span data-stu-id="701a6-171">In Credentials, specify an account used to run the data refresh job.</span></span> <span data-ttu-id="701a6-172">该帐户对于该工作簿必须具有“参与讨论”权限，以便可以打开该工作簿来刷新其数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-172">The account must have Contribute permissions on the workbook so that it can open the workbook to refresh its data.</span></span> <span data-ttu-id="701a6-173">该帐户必须是 Windows 域用户帐户。</span><span class="sxs-lookup"><span data-stu-id="701a6-173">It must be a Windows domain user account.</span></span> <span data-ttu-id="701a6-174">在许多情况下，该帐户还必须对在数据刷新过程中使用的外部数据源具有读取权限。</span><span class="sxs-lookup"><span data-stu-id="701a6-174">In many cases, this account must also have read permissions on the external data sources used during data refresh.</span></span> <span data-ttu-id="701a6-175">具体来说，如果您最初使用“使用 Windows 身份验证”选项导入了数据，则将生成连接字符串以便使用当前用户的 Windows 凭据。</span><span class="sxs-lookup"><span data-stu-id="701a6-175">Specifically, if you originally imported the data using the Use Windows Authentication option, then the connection string is built to use the Windows credentials of the current user.</span></span> <span data-ttu-id="701a6-176">如果当前用户是数据刷新帐户，则该帐户必须对外部数据源具有读取权限，这样数据刷新才能成功完成。</span><span class="sxs-lookup"><span data-stu-id="701a6-176">If the current user is the data refresh account, that account must have read permissions on the external data source in order for data refresh to succeed.</span></span> <span data-ttu-id="701a6-177">选择下列选项之一：</span><span class="sxs-lookup"><span data-stu-id="701a6-177">Choose one of the following options:</span></span>  
  
    1.  <span data-ttu-id="701a6-178">选择 **“使用管理员配置的数据刷新帐户”** 以使用 PowerPivot 无人参与的数据刷新帐户处理数据刷新操作。</span><span class="sxs-lookup"><span data-stu-id="701a6-178">Choose **Use the data refresh account configured by the administrator** to process the data refresh operation using the PowerPivot unattended data refresh account.</span></span>  
  
    2.  <span data-ttu-id="701a6-179">如果您希望输入用户名和密码，则选择 **“使用以下 Windows 用户凭据进行连接”** 。</span><span class="sxs-lookup"><span data-stu-id="701a6-179">Choose **Connect using the following Windows user credentials** if you want to enter a user name and password.</span></span> <span data-ttu-id="701a6-180">以 domain\user 格式输入帐户信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-180">Enter the account information in domain\user format.</span></span>  
  
    3.  <span data-ttu-id="701a6-181">如果您知道包含您希望使用的以前存储的凭据的目标应用程序的 ID，则选择 **“使用在 Secure Store Service 中保存的凭据进行连接”** 。</span><span class="sxs-lookup"><span data-stu-id="701a6-181">Choose **Connect using the credentials saved in Secure Store Service** if you know the ID of a target application that contains previously stored credentials you want to use.</span></span>  
  
     <span data-ttu-id="701a6-182">有关这些选项的详细信息，请参阅为[Powerpivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)并[配置 Powerpivot 无人参与的数据刷新帐户 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="701a6-182">For more information about these options, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
9. <span data-ttu-id="701a6-183">如果您希望数据刷新重新查询所有原始数据源，则在“数据源”中选中 **“所有数据源”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="701a6-183">In Data Sources, select the **All data sources** checkbox if you want data refresh to re-query all of the original data sources.</span></span>  
  
     <span data-ttu-id="701a6-184">如果您选中此选项，则提供 PowerPivot 数据的任何外部数据源将自动包括在刷新中，即使随着您添加或删除向工作簿提供数据的数据源，数据源列表发生变化时也是如此。</span><span class="sxs-lookup"><span data-stu-id="701a6-184">If you select this option, any external data source that provides PowerPivot data is automatically included in the refresh, even if the list of data sources changes over time as you add or remove data sources that provide data to the workbook.</span></span>  
  
     <span data-ttu-id="701a6-185">如果您想要手动选择要包括的数据源，则取消选中 **“所有数据源”** 复选框。</span><span class="sxs-lookup"><span data-stu-id="701a6-185">Clear the **All data sources** checkbox if you want to manually select which data sources to include.</span></span> <span data-ttu-id="701a6-186">如果您以后通过添加新的数据源修改该工作簿，请务必在计划中更新数据源列表。</span><span class="sxs-lookup"><span data-stu-id="701a6-186">If you later modify the workbook by adding a new data source, be sure to update the data source list in the schedule.</span></span> <span data-ttu-id="701a6-187">否则，较新的数据源将不会包括在刷新操作中。</span><span class="sxs-lookup"><span data-stu-id="701a6-187">Otherwise, newer data sources will not be included in the refresh operation.</span></span>  
  
     <span data-ttu-id="701a6-188">当您打开工作簿的“管理 PowerPivot 数据刷新”页时，您可以从中进行选择的数据源列表是从 PowerPivot 工作簿中检索的。</span><span class="sxs-lookup"><span data-stu-id="701a6-188">The list of data sources that you can choose from is retrieved from the PowerPivot workbook when you open the Manage PowerPivot Data Refresh page for the workbook.</span></span>  
  
     <span data-ttu-id="701a6-189">请务必仅选择满足以下条件的那些数据源：</span><span class="sxs-lookup"><span data-stu-id="701a6-189">Be sure to select only those data sources that meet the following criteria:</span></span>  
  
    -   <span data-ttu-id="701a6-190">该数据源必须在发生数据刷新时可用，并且还必须在规定的位置上可用。</span><span class="sxs-lookup"><span data-stu-id="701a6-190">The data source must be available at the time that data refresh occurs and at the stated location.</span></span> <span data-ttu-id="701a6-191">如果原始数据源处于创作此工作簿的人员的本地磁盘驱动器上，则必须或者从数据刷新操作中排除该数据源，或者确定一种方法来将该数据源发布到可通过网络连接访问的位置。</span><span class="sxs-lookup"><span data-stu-id="701a6-191">If the original data source is on a local disk drive of the person who authored the workbook, you must either exclude that data source from the data refresh operation, or find a way to publish that data source to a location that is accessible through a network connection.</span></span> <span data-ttu-id="701a6-192">如果您将某一数据源移到某个网络位置，请确保在 [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] 中打开工作簿并更新数据源连接信息。</span><span class="sxs-lookup"><span data-stu-id="701a6-192">If you move a data source to a network location, be sure to open the workbook in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] and update the data source connection information.</span></span> <span data-ttu-id="701a6-193">这是重新建立 PowerPivot 工作簿中存储的连接信息所必需的。</span><span class="sxs-lookup"><span data-stu-id="701a6-193">This is necessary to re-establish the connection information that is stored in the PowerPivot workbook.</span></span>  
  
    -   <span data-ttu-id="701a6-194">必须使用嵌入在 PowerPivot 工作簿中或在计划中指定的凭据信息来访问数据源。</span><span class="sxs-lookup"><span data-stu-id="701a6-194">The data source must be accessed using the credential information that is embedded in the PowerPivot workbook or that is specified in the schedule.</span></span> <span data-ttu-id="701a6-195">当您使用 PowerPivot for Excel 导入数据时，嵌入的凭据信息存储于 PowerPivot 工作簿中。</span><span class="sxs-lookup"><span data-stu-id="701a6-195">Embedded credential information is stored in the PowerPivot workbook when you import data using PowerPivot for Excel.</span></span> <span data-ttu-id="701a6-196">嵌入的凭据信息通常是 SSPI=IntegratedSecurity 或 SSPI=TrustedConnection，这意味着使用当前用户的凭据来连接到数据源。</span><span class="sxs-lookup"><span data-stu-id="701a6-196">Embedded credential information is often SSPI=IntegratedSecurity or SSPI=TrustedConnection, which means use the credentials of the current user to connect to the data source.</span></span> <span data-ttu-id="701a6-197">如果您想要覆盖数据刷新计划中的凭据信息，则可以指定预定义的存储凭据。</span><span class="sxs-lookup"><span data-stu-id="701a6-197">If you want to override the credential information in your data refresh schedule, you can specify predefined, stored credentials.</span></span> <span data-ttu-id="701a6-198">有关详细信息，请参阅为[PowerPivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="701a6-198">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
    -   <span data-ttu-id="701a6-199">数据刷新必须对您指定的所有数据源均成功。</span><span class="sxs-lookup"><span data-stu-id="701a6-199">Data refresh must succeed for all of the data sources that you specify.</span></span> <span data-ttu-id="701a6-200">否则，刷新的数据将被放弃，只会留下上次保存的工作簿版本。</span><span class="sxs-lookup"><span data-stu-id="701a6-200">Otherwise, the refreshed data is discarded, leaving you with the last saved version of the workbook.</span></span> <span data-ttu-id="701a6-201">因此，请排除您不确定的任何数据源。</span><span class="sxs-lookup"><span data-stu-id="701a6-201">Exclude any data sources that you are not sure about.</span></span>  
  
    -   <span data-ttu-id="701a6-202">数据刷新不得使工作簿中的其他数据失效。</span><span class="sxs-lookup"><span data-stu-id="701a6-202">Data refresh must not invalidate other data in your workbook.</span></span> <span data-ttu-id="701a6-203">在您刷新您的一部分数据时，请务必了解在较新的数据与不是来自同一时间段的静态数据进行聚合后工作簿是否仍有效。</span><span class="sxs-lookup"><span data-stu-id="701a6-203">When you refresh a subset of your data, it is important that you understand whether the workbook is still valid once newer data is aggregated with static data that is not from the same time period.</span></span> <span data-ttu-id="701a6-204">作为工作簿作者，您要知道您的数据依赖关系，并确保数据刷新适合于工作簿本身。</span><span class="sxs-lookup"><span data-stu-id="701a6-204">As a workbook author, it is up to you to know your data dependencies and ensure that data refresh is appropriate for the workbook itself.</span></span>  
  
10. <span data-ttu-id="701a6-205">或者，您可以为特定数据源定义单独的计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-205">Optionally, you can define individual schedules for specific data sources.</span></span> <span data-ttu-id="701a6-206">如果您具有原始数据源，而它们本身将根据计划进行更新，则定义单独的计划将十分有用。</span><span class="sxs-lookup"><span data-stu-id="701a6-206">This is useful if you have original data sources that are themselves updated on a schedule.</span></span> <span data-ttu-id="701a6-207">例如，如果 PowerPivot 数据源使用的数据来自每个星期一的 02:00 点刷新的数据市场，则可以为该数据市场定义一个内联计划，以便在每个星期一的 04:00 点检索其刷新的数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-207">For example, if a PowerPivot data source uses data from a data mart that is refreshed every Monday at 02:00 hours, you can define an inline schedule for the data mart to retrieve its refreshed data every Monday at 04:00 hours.</span></span>  
  
11. <span data-ttu-id="701a6-208">单击 **“确定”** 保存您的计划。</span><span class="sxs-lookup"><span data-stu-id="701a6-208">Click **OK** to save your schedule.</span></span>  
  
##  <a name="verify-data-refresh"></a><a name="drverify"></a><span data-ttu-id="701a6-209">验证数据刷新</span><span class="sxs-lookup"><span data-stu-id="701a6-209">Verify Data Refresh</span></span>  
 <span data-ttu-id="701a6-210">验证数据刷新的最佳方式是立即执行数据刷新，然后查看历史记录页以便确定刷新是否成功完成。</span><span class="sxs-lookup"><span data-stu-id="701a6-210">The best way to verify data refresh is to execute data refresh right away and then review the history page to see whether it completed successfully.</span></span> <span data-ttu-id="701a6-211">对您的计划选中 **“也尽快刷新”** 复选框将提供数据刷新可正常运行的验证。</span><span class="sxs-lookup"><span data-stu-id="701a6-211">Selecting the **Also refresh as soon as possible** checkbox on your schedule will provide the verification that data refresh is operational.</span></span>  
  
 <span data-ttu-id="701a6-212">您可以在工作簿的“数据刷新历史记录”页中查看数据刷新操作的当前和过去的记录。</span><span class="sxs-lookup"><span data-stu-id="701a6-212">You can view the current and past record of data refresh operations in the Data Refresh History page for the workbook.</span></span> <span data-ttu-id="701a6-213">仅在已为工作簿计划了数据刷新后此页才出现。</span><span class="sxs-lookup"><span data-stu-id="701a6-213">This page only appears if data refresh has been scheduled for a workbook.</span></span> <span data-ttu-id="701a6-214">如果没有数据刷新计划，将改为出现计划定义页。</span><span class="sxs-lookup"><span data-stu-id="701a6-214">If there is no data refresh schedule, the schedule definition page appears instead.</span></span>  
  
 <span data-ttu-id="701a6-215">您必须具有“参与讨论”权限或更高权限，才能查看数据刷新历史记录。</span><span class="sxs-lookup"><span data-stu-id="701a6-215">You must have Contribute permissions or greater to view data refresh history.</span></span>  
  
1.  <span data-ttu-id="701a6-216">在 SharePoint 站点上，打开包含 PowerPivot 工作簿的库。</span><span class="sxs-lookup"><span data-stu-id="701a6-216">On a SharePoint site, open the library that contains a PowerPivot workbook.</span></span>  
  
     <span data-ttu-id="701a6-217">没有可视的指示器用于标识 SharePoint 库中的哪些工作簿包含 PowerPivot 数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-217">There is no visual indicator that identifies which workbooks in a SharePoint library contain PowerPivot data.</span></span> <span data-ttu-id="701a6-218">您必须预先知道哪些工作簿包含可刷新的 PowerPivot 数据。</span><span class="sxs-lookup"><span data-stu-id="701a6-218">You must know in advance which workbooks contain refreshable PowerPivot data.</span></span>  
  
2.  <span data-ttu-id="701a6-219">选择文档，然后单击显示在右侧的向下箭头。</span><span class="sxs-lookup"><span data-stu-id="701a6-219">Select the document, and then click the down arrow that appears to the right.</span></span>  
  
3.  <span data-ttu-id="701a6-220">选择 **“管理 PowerPivot 数据刷新”**。</span><span class="sxs-lookup"><span data-stu-id="701a6-220">Select **Manage PowerPivot Data Refresh**.</span></span>  
  
 <span data-ttu-id="701a6-221">此时将出现历史记录页，其中显示当前 Excel 工作簿中 PowerPivot 数据的所有刷新活动的完整记录，包括最近数据刷新操作的状态。</span><span class="sxs-lookup"><span data-stu-id="701a6-221">The history page appears, showing a complete record for all refresh activity for PowerPivot data in the current Excel workbook, including the status of the most recent data refresh operation.</span></span>  
  
 <span data-ttu-id="701a6-222">在某些情况下，您可能会看到实际处理时间不同于您指定的时间。</span><span class="sxs-lookup"><span data-stu-id="701a6-222">In some cases, you might see actual processing times that differ from the time you specified.</span></span> <span data-ttu-id="701a6-223">如果服务器上的处理负荷繁重，将发生此情况。</span><span class="sxs-lookup"><span data-stu-id="701a6-223">This will occur if there is a heavy processing load on the server.</span></span> <span data-ttu-id="701a6-224">在负荷繁重的情况下， [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] 服务实例将等待，直到释放了足够的系统资源后才开始数据刷新。</span><span class="sxs-lookup"><span data-stu-id="701a6-224">Under heavy load, the [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] service instance will wait until enough system resources are free before it begins a data refresh.</span></span>  
  
 <span data-ttu-id="701a6-225">在刷新操作完成时，必须签入工作簿。</span><span class="sxs-lookup"><span data-stu-id="701a6-225">The workbook must be checked in when the refresh operation is finished.</span></span> <span data-ttu-id="701a6-226">此时，将用刷新后的数据保存工作簿。</span><span class="sxs-lookup"><span data-stu-id="701a6-226">The workbook will be saved with the refreshed data at that time.</span></span> <span data-ttu-id="701a6-227">如果该文件已签出，则数据刷新将跳到下一计划时间。</span><span class="sxs-lookup"><span data-stu-id="701a6-227">If the file is checked out, data refresh is skipped until the next scheduled time.</span></span>  
  
 <span data-ttu-id="701a6-228">如果您看到意外的状态消息（例如，刷新操作失败或被取消），则可以通过检查权限和服务器可用性来调查该问题。</span><span class="sxs-lookup"><span data-stu-id="701a6-228">If you see a status message that is unexpected (for example, a refresh operation failed or was cancelled), you can investigate the problem by checking permissions and server availability.</span></span>  
  
 <span data-ttu-id="701a6-229">查看 TechNet WIKI 上的 PowerPivot 数据刷新故障排除页，帮助解决数据刷新问题。</span><span class="sxs-lookup"><span data-stu-id="701a6-229">Review the PowerPivot data refresh troubleshooting page on the TechNet WIKI for help on resolving data refresh problems.</span></span> <span data-ttu-id="701a6-230">有关详细信息，请参阅 [解决 PowerPivot 数据刷新问题](https://go.microsoft.com/fwlink/?LinkId=251594)。</span><span class="sxs-lookup"><span data-stu-id="701a6-230">For more information see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkId=251594).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="701a6-231">SharePoint 管理员可通过在管理中心查看 PowerPivot 管理面板中的合并数据刷新报告来帮助您排除数据刷新问题。</span><span class="sxs-lookup"><span data-stu-id="701a6-231">SharePoint administrators can help you troubleshoot data refresh problems by viewing the consolidated data refresh reports in the PowerPivot Management Dashboard in Central Administration.</span></span> <span data-ttu-id="701a6-232">有关详细信息，请参阅 [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md)。</span><span class="sxs-lookup"><span data-stu-id="701a6-232">For more information, see [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="701a6-233">另请参阅</span><span class="sxs-lookup"><span data-stu-id="701a6-233">See Also</span></span>  
 <span data-ttu-id="701a6-234">[通过 SharePoint 2010 进行 PowerPivot 数据刷新](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="701a6-234">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="701a6-235">[查看数据刷新历史记录 &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="701a6-235">[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="701a6-236">为 PowerPivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="701a6-236">Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;</span></span>](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
