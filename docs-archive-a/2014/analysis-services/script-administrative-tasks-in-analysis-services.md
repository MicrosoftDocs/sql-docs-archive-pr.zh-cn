---
title: Analysis Services 中的脚本管理任务Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- automatic Analysis Services administration
- administering Analysis Services
ms.assetid: 106415df-81ff-4ec3-b2e1-ca66324f4cab
author: minewiskan
ms.author: owend
ms.openlocfilehash: 660f0d52d4057a9bdb9e2a0af0ed268d64a7747a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579104"
---
# <a name="script-administrative-tasks-in-analysis-services"></a><span data-ttu-id="f9435-102">在 Analysis Services 中编写管理任务脚本</span><span class="sxs-lookup"><span data-stu-id="f9435-102">Script Administrative Tasks in Analysis Services</span></span>
  <span data-ttu-id="f9435-103">您可以通过编写或生成可手动执行或通过 SQL Server 代理来计划的脚本自动执行 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 管理任务。</span><span class="sxs-lookup"><span data-stu-id="f9435-103">You can automate [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] administrative tasks by writing or generating scripts that can be executed manually or scheduled through SQL Server Agent.</span></span> <span data-ttu-id="f9435-104">下表总结了可供您使用的脚本编写选项，并提供指向更多信息的链接。</span><span class="sxs-lookup"><span data-stu-id="f9435-104">The following table summarizes the scripting options available to you and provides links to more information.</span></span>  
  
 <span data-ttu-id="f9435-105">下面所列的所有方法都支持脚本保存到文件中，然后作为独立操作执行。</span><span class="sxs-lookup"><span data-stu-id="f9435-105">All of the methodologies listed below support scripts that can be saved to a file and executed as an independent operation.</span></span> <span data-ttu-id="f9435-106">由于在表格模型和 PowerPivot 工作簿中使用的数据分析表达式 (DAX) 语言不符合条件，所以未包含在下面的列表中。</span><span class="sxs-lookup"><span data-stu-id="f9435-106">Because the Data Analysis Expression (DAX) language used for tabular models and PowerPivot workbooks does not meet the criteria, it is not included in the following list.</span></span>  
  
|<span data-ttu-id="f9435-107">方法</span><span class="sxs-lookup"><span data-stu-id="f9435-107">Methodology</span></span>|<span data-ttu-id="f9435-108">文件格式</span><span class="sxs-lookup"><span data-stu-id="f9435-108">File format</span></span>|<span data-ttu-id="f9435-109">说明</span><span class="sxs-lookup"><span data-stu-id="f9435-109">Description</span></span>|<span data-ttu-id="f9435-110">链接</span><span class="sxs-lookup"><span data-stu-id="f9435-110">Links</span></span>|  
|-----------------|-----------------|-----------------|-----------|  
|<span data-ttu-id="f9435-111">PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9435-111">PowerShell</span></span>|<span data-ttu-id="f9435-112">.ps1</span><span class="sxs-lookup"><span data-stu-id="f9435-112">.ps1</span></span>|<span data-ttu-id="f9435-113">Analysis Services 通过一个新的访问接口（从命令行添加对象导航）以及新增的用于管理任务（如备份、还原、处理和角色管理）的 cmdlet 来支持 SQL Server PowerShell 脚本环境。</span><span class="sxs-lookup"><span data-stu-id="f9435-113">Analysis Services supports the SQL Server PowerShell scripting environment through a new provider that adds object navigation from the command line, as well as new cmdlets for administrative tasks such as backup, restore, processing, and role management.</span></span><br /><br /> <span data-ttu-id="f9435-114">此外，SQL Server PowerPivot (SQLPS) 访问接口还包括一个通用的 cmdlet `Invoke-ASCmd`，它支持您从 PowerShell 会话内部运行 XMLA、MDX 或 DMX 脚本文件。</span><span class="sxs-lookup"><span data-stu-id="f9435-114">Additionally, the SQL Server PowerPivot (SQLPS) provider includes a general purpose cmdlet, `Invoke-ASCmd`, which lets you run XMLA, MDX, or DMX script files from within a PowerShell session.</span></span><br /><br /> <span data-ttu-id="f9435-115">多维模型和表格模型均支持 Analysis Services PowerShell 脚本，但从 SharePoint 访问的 PowerPivot 工作簿却不支持该脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-115">Analysis Services PowerShell scripting is supported for both multidimensional and tabular models, but not for PowerPivot workbooks accessed from SharePoint.</span></span>|[<span data-ttu-id="f9435-116">Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="f9435-116">Analysis Services PowerShell</span></span>](analysis-services-powershell.md)<br /><br /> [<span data-ttu-id="f9435-117">Windows PowerShell 生存指南</span><span class="sxs-lookup"><span data-stu-id="f9435-117">Windows PowerShell Survival Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=233747)|  
|<span data-ttu-id="f9435-118">ASSL 或 XMLA 脚本</span><span class="sxs-lookup"><span data-stu-id="f9435-118">ASSL or XMLA Script</span></span>|<span data-ttu-id="f9435-119">.xmla</span><span class="sxs-lookup"><span data-stu-id="f9435-119">.xmla</span></span>|<span data-ttu-id="f9435-120">Analysis Services 脚本语言 (ASSL) 是对 XMLA 的扩展，该语言提供针对在表格或多维模式中运行的 Analysis Services 实例上的对象和操作的数据访问。</span><span class="sxs-lookup"><span data-stu-id="f9435-120">Analysis Services Scripting Language (ASSL) is an extension to XMLA that provides data access to objects and operations on an Analysis Services instance that runs in tabular or multidimensional mode.</span></span> <span data-ttu-id="f9435-121">ASSL 包括数据定义和命令语言支持，支持以 XML 格式完整表示 Analysis Services 对象和操作。</span><span class="sxs-lookup"><span data-stu-id="f9435-121">ASSL includes data definition and command language support, enabling the complete expression of Analysis Services objects and operations in an XML format.</span></span> <span data-ttu-id="f9435-122">使用 ASSL 提供的对象和命令的脚本另存为 .xmla 文件。</span><span class="sxs-lookup"><span data-stu-id="f9435-122">Scripts that use the objects and commands provided by ASSL are saved as .xmla files.</span></span> <span data-ttu-id="f9435-123">在 Analysis Services 的上下文内，通常将 ASSL 视为 XMLA 脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-123">Within the context of Analysis Services, it is common practice to refer to ASSL as XMLA script.</span></span> <span data-ttu-id="f9435-124">当您具有以下要求时，请选择这种方法：</span><span class="sxs-lookup"><span data-stu-id="f9435-124">Choose this approach when your requirements include the following:</span></span><br /><br /> <span data-ttu-id="f9435-125">您的脚本直接在服务器上创建对象，或执行数据定义和操作任务（例如，重新创建和处理数据库）。</span><span class="sxs-lookup"><span data-stu-id="f9435-125">Your script creates objects directly on a server, or performs both data definition and operational tasks (for example, recreating and processing database).</span></span><br /><br /> <span data-ttu-id="f9435-126">您需要在多种工具和技术中最大程度地重复使用脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-126">You require maximum script reuse across multiple tools and technologies.</span></span> <span data-ttu-id="f9435-127">可以在 SQL Server 代理中将 XMLA 脚本添加到 Analysis Services 命令任务，在 SSIS 包或 PowerShell 脚本中引用 XMLA 脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-127">XMLA scripts can be added to Analysis Services command tasks in SQL Server Agent, referenced in SSIS packages, or referenced in PowerShell script.</span></span><br /><br /> <span data-ttu-id="f9435-128">必须以无人参与的模式运行该脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-128">The script must run unattended.</span></span> <span data-ttu-id="f9435-129">可以使用 SQL Server 代理调度包含 XMLA 脚本的作业或包含 XMLA 的 SSIS 包。</span><span class="sxs-lookup"><span data-stu-id="f9435-129">You can use SQL Server Agent to schedule a job that contains XMLA script or an SSIS package that contains XMLA.</span></span><br /><br /> <span data-ttu-id="f9435-130">您的应用程序要求使用 XMLA。</span><span class="sxs-lookup"><span data-stu-id="f9435-130">You have application requirements for using XMLA.</span></span> <span data-ttu-id="f9435-131">XMLA 是一个不需要托管代码环境的接口。</span><span class="sxs-lookup"><span data-stu-id="f9435-131">XMLA is an interface that does not require a managed code environment.</span></span> <span data-ttu-id="f9435-132">您可以在不使用 .NET Framework 的应用程序中执行 XMLA 脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-132">You can execute XMLA script in an application that does not use the .NET Framework.</span></span>|[<span data-ttu-id="f9435-133">在 Management Studio 中创建 Analysis Services 脚本</span><span class="sxs-lookup"><span data-stu-id="f9435-133">Create Analysis Services Scripts in Management Studio</span></span>](instances/create-analysis-services-scripts-in-management-studio.md)<br /><br /> [<span data-ttu-id="f9435-134">Use Analysis Services Templates in SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="f9435-134">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="f9435-135">使用 SQL Server 代理来计划 SSAS 管理任务</span><span class="sxs-lookup"><span data-stu-id="f9435-135">Schedule SSAS Administrative Tasks with SQL Server Agent</span></span>](instances/schedule-ssas-administrative-tasks-with-sql-server-agent.md)<br /><br /> [<span data-ttu-id="f9435-136">使用 Analysis Services 脚本语言 (ASSL) 开发</span><span class="sxs-lookup"><span data-stu-id="f9435-136">Developing with Analysis Services Scripting Language &#40;ASSL&#41;</span></span>](multidimensional-models/scripting-language-assl/developing-with-analysis-services-scripting-language-assl.md)<br /><br /> [<span data-ttu-id="f9435-137">Invoke-ASCmd cmdlet</span><span class="sxs-lookup"><span data-stu-id="f9435-137">Invoke-ASCmd cmdlet</span></span>](/powershell/module/sqlserver/invoke-ascmd)|  
|||<span data-ttu-id="f9435-138">若要创建 XMLA 脚本，您可以在 Management Studio 中使用脚本生成器。</span><span class="sxs-lookup"><span data-stu-id="f9435-138">To create XMLA script, you can use the script generator in Management Studio.</span></span> <span data-ttu-id="f9435-139">在对象级别，右键单击某个对象可生成创建、更改或删除对象的脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-139">At the object level, right-click an object to generate script that creates, alters, or deletes an object.</span></span> <span data-ttu-id="f9435-140">在命令级别，例如在执行处理、备份或还原、聚合设计或执行另一个命令时，您可以使用相应对话框中的脚本功能，通过选择将脚本放入新的窗口、文件或剪贴板等选项来生成脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-140">At the command level, such as for processing, backup or restore, aggregation design, or another command, you can generate script using the Script feature in the dialog box, choosing options that place the script in a new window, file, or clipboard.</span></span> <span data-ttu-id="f9435-141">您也可以在文本或代码编辑器中手动编写 XMLA 脚本，或使用模板资源管理器中的模板编写 XMLA 脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-141">You can also write XMLA script manually in a text or code editor, or use a template in Template Explorer.</span></span> <span data-ttu-id="f9435-142">若要运行该脚本，请使用以下方法之一：</span><span class="sxs-lookup"><span data-stu-id="f9435-142">To run the script, use one of these approaches:</span></span><br /><br /> <span data-ttu-id="f9435-143">使用 Management Studio 直接在 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 实例上创建或修改对象。</span><span class="sxs-lookup"><span data-stu-id="f9435-143">Use Management Studio to directly create or modify objects on an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span><br /><br /> <span data-ttu-id="f9435-144">使用 SQL Server 代理调度包括 Analysis Services 命令任务的作业。</span><span class="sxs-lookup"><span data-stu-id="f9435-144">Use SQL Server Agent to schedule a job that includes an Analysis Services command task.</span></span><br /><br /> <span data-ttu-id="f9435-145">使用 Invoke-ASCmd cmdlet 在 PowerShell 会话中运行该脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-145">Use the Invoke-ASCmd cmdlet to run the script in a PowerShell session.</span></span>||  
|<span data-ttu-id="f9435-146">MDX 脚本</span><span class="sxs-lookup"><span data-stu-id="f9435-146">MDX Script</span></span>|<span data-ttu-id="f9435-147">.mdx</span><span class="sxs-lookup"><span data-stu-id="f9435-147">.mdx</span></span>|<span data-ttu-id="f9435-148">多维表达式 (MDX) 语言是一种用于分析数据源的业界标准查询语言，它同样也是 XMLA 规范的一部分。</span><span class="sxs-lookup"><span data-stu-id="f9435-148">Multidimensional Expression (MDX) language is an industry standard query language for analytical data sources that is also part of the XMLA specification.</span></span><br /><br /> <span data-ttu-id="f9435-149">您可以创建用来查询数据或系统信息的独立 MDX 脚本文件。</span><span class="sxs-lookup"><span data-stu-id="f9435-149">You can create a standalone MDX script file that queries data or system information.</span></span> <span data-ttu-id="f9435-150">例如，可以通过 MDX Select 语句来访问公开与本地服务器操作和服务器运行状况有关的信息的动态管理视图 (DMV)。</span><span class="sxs-lookup"><span data-stu-id="f9435-150">For example, Dynamic Management Views (DMV) that expose information about local server operations and server health are accessed via the MDX Select statement.</span></span><br /><br /> <span data-ttu-id="f9435-151">MDX 脚本可在多维和表格模式的服务器上运行。</span><span class="sxs-lookup"><span data-stu-id="f9435-151">MDX script will run on both multidimensional and tabular mode servers.</span></span> <span data-ttu-id="f9435-152">您可以使用 `Invoke-ASCmd` 从 SQL Server Management Studio 或 PowerShell 会话以交互方式运行该脚本。</span><span class="sxs-lookup"><span data-stu-id="f9435-152">You can run the script interactively from SQL Server Management Studio, or from a PowerShell session using `Invoke-ASCmd`.</span></span>|[<span data-ttu-id="f9435-153">MDX 脚本编写基础知识 (Analysis Services)</span><span class="sxs-lookup"><span data-stu-id="f9435-153">MDX Scripting Fundamentals &#40;Analysis Services&#41;</span></span>](multidimensional-models/mdx/mdx-scripting-fundamentals-analysis-services.md)<br /><br /> [<span data-ttu-id="f9435-154">使用动态管理视图 (DMV) 监视 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="f9435-154">Use Dynamic Management Views &#40;DMVs&#41; to Monitor Analysis Services</span></span>](instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)<br /><br /> [<span data-ttu-id="f9435-155">Use Analysis Services Templates in SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="f9435-155">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|<span data-ttu-id="f9435-156">DMX 脚本</span><span class="sxs-lookup"><span data-stu-id="f9435-156">DMX Script</span></span>|<span data-ttu-id="f9435-157">.dmx</span><span class="sxs-lookup"><span data-stu-id="f9435-157">.dmx</span></span>|<span data-ttu-id="f9435-158">数据挖掘扩展插件 (DMX) 是用于数据挖掘模型的数据定义、数据操作和数据查询语言。</span><span class="sxs-lookup"><span data-stu-id="f9435-158">Data Mining Extensions (DMX) is a data definition, data manipulation, and data query language for data mining models.</span></span> <span data-ttu-id="f9435-159">您可以借助模板来入门。</span><span class="sxs-lookup"><span data-stu-id="f9435-159">You can use a template as a way to get started.</span></span>|[<span data-ttu-id="f9435-160">在 SQL Server Management Studio 中创建一个 DMX 查询</span><span class="sxs-lookup"><span data-stu-id="f9435-160">Create a DMX Query in SQL Server Management Studio</span></span>](data-mining/create-a-dmx-query-in-sql-server-management-studio.md)<br /><br /> [<span data-ttu-id="f9435-161">Use Analysis Services Templates in SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="f9435-161">Use Analysis Services Templates in SQL Server Management Studio</span></span>](instances/use-analysis-services-templates-in-sql-server-management-studio.md)|  
|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="f9435-162">包</span><span class="sxs-lookup"><span data-stu-id="f9435-162">packages</span></span>|<span data-ttu-id="f9435-163">.dtsx</span><span class="sxs-lookup"><span data-stu-id="f9435-163">.dtsx</span></span>|[!INCLUDE[ssIS](../includes/ssis-md.md)] <span data-ttu-id="f9435-164">提供的任务和数据流可用于创建、修改、删除和处理 Analysis Services 对象（包括数据挖掘模型）。</span><span class="sxs-lookup"><span data-stu-id="f9435-164">provides tasks and data flows that create, modify, delete, and process Analysis Services objects, including data mining models.</span></span> <span data-ttu-id="f9435-165">可以使用 SQL Server 代理调度要运行的包。</span><span class="sxs-lookup"><span data-stu-id="f9435-165">You can schedule a package to run using SQL Server Agent.</span></span>|[<span data-ttu-id="f9435-166">Analysis Services 执行 DDL 任务</span><span class="sxs-lookup"><span data-stu-id="f9435-166">Analysis Services Execute DDL Task</span></span>](../integration-services/control-flow/analysis-services-execute-ddl-task.md)<br /><br /> [<span data-ttu-id="f9435-167">Analysis Services 处理任务</span><span class="sxs-lookup"><span data-stu-id="f9435-167">Analysis Services Processing Task</span></span>](../integration-services/control-flow/analysis-services-processing-task.md)<br /><br /> [<span data-ttu-id="f9435-168">数据挖掘查询任务</span><span class="sxs-lookup"><span data-stu-id="f9435-168">Data Mining Query Task</span></span>](../integration-services/control-flow/data-mining-query-task.md)<br /><br /> [<span data-ttu-id="f9435-169">数据挖掘模型定型目标</span><span class="sxs-lookup"><span data-stu-id="f9435-169">Data Mining Model Training Destination</span></span>](../integration-services/data-flow/data-mining-model-training-destination.md)<br /><br /> [<span data-ttu-id="f9435-170">维度处理目标</span><span class="sxs-lookup"><span data-stu-id="f9435-170">Dimension Processing Destination</span></span>](../integration-services/data-flow/dimension-processing-destination.md)<br /><br /> [<span data-ttu-id="f9435-171">分区处理目标</span><span class="sxs-lookup"><span data-stu-id="f9435-171">Partition Processing Destination</span></span>](../integration-services/data-flow/partition-processing-destination.md)|  
|<span data-ttu-id="f9435-172">分析管理对象</span><span class="sxs-lookup"><span data-stu-id="f9435-172">Analysis Management Objects</span></span>||<span data-ttu-id="f9435-173">分析管理对象 (AMO) 是一种托管接口，编程人员可用它来开发自动执行管理操作的自定义应用程序。</span><span class="sxs-lookup"><span data-stu-id="f9435-173">Analysis Management Objects (AMO) is managed interface that programmers can use to develop custom applications that automate administrative operations.</span></span> <span data-ttu-id="f9435-174">使用 AMO，您可以开发运行您提供的 XMLA、MDX 或 DMX 脚本的自定义应用程序。</span><span class="sxs-lookup"><span data-stu-id="f9435-174">Using AMO, you can develop a custom application that runs XMLA, MDX, or DMX scripts that you provide.</span></span>|[<span data-ttu-id="f9435-175">利用 AMO 对管理任务进行编程</span><span class="sxs-lookup"><span data-stu-id="f9435-175">Programming Administrative Tasks with AMO</span></span>](https://docs.microsoft.com/bi-reference/amo/programming-administrative-tasks-with-amo)|  
  
## <a name="see-also"></a><span data-ttu-id="f9435-176">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f9435-176">See Also</span></span>  
 <span data-ttu-id="f9435-177">[Analysis Services 脚本语言 &#40;ASSL&#41; 参考](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span><span class="sxs-lookup"><span data-stu-id="f9435-177">[Analysis Services Scripting Language &#40;ASSL&#41; Reference](https://docs.microsoft.com/bi-reference/assl/analysis-services-scripting-language-assl-for-xmla) </span></span>  
 <span data-ttu-id="f9435-178">[利用分析管理对象 &#40;AMO 进行开发&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span><span class="sxs-lookup"><span data-stu-id="f9435-178">[Developing with Analysis Management Objects &#40;AMO&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) </span></span>  
 [<span data-ttu-id="f9435-179">多维模型对象处理</span><span class="sxs-lookup"><span data-stu-id="f9435-179">Multidimensional Model Object Processing</span></span>](multidimensional-models/processing-a-multidimensional-model-analysis-services.md)  
  
  
