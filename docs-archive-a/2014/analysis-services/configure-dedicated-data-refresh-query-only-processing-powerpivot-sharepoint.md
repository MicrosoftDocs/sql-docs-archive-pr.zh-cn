---
title: 配置专用数据刷新或仅限查询的处理 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 5e027605-1086-4941-bb01-f315df8f829b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 6aa98f16a8a607f5f65f15bc921d0cc42ae1cd1c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579243"
---
# <a name="configure-dedicated-data-refresh-or-query-only-processing-powerpivot-for-sharepoint"></a><span data-ttu-id="67de6-102">配置专用数据刷新或仅限查询的处理 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="67de6-102">Configure Dedicated Data Refresh or Query-Only Processing (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="67de6-103">在 SharePoint 集成模式下，可以将 Analysis Services 服务器实例配置为支持特定类型的处理请求，如数据刷新或仅限查询的处理。</span><span class="sxs-lookup"><span data-stu-id="67de6-103">In SharePoint integrated mode, an Analysis Services server instance can be configured to support a specific type of processing request, such as data refresh or query-only processing.</span></span> <span data-ttu-id="67de6-104">默认情况下，支持这两种类型的负载请求。</span><span class="sxs-lookup"><span data-stu-id="67de6-104">By default, both types of load requests are enabled.</span></span> <span data-ttu-id="67de6-105">您可以关闭任一类型，以创建专用查询引擎或数据刷新服务器。</span><span class="sxs-lookup"><span data-stu-id="67de6-105">You can turn off either type to create a dedicated query engine or data refresh server.</span></span>  
  
 <span data-ttu-id="67de6-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="67de6-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="67de6-107">在此版本中，没有相应的配置设置可用来将内存或 CPU 使用率限制为数据刷新作业或按需查询。</span><span class="sxs-lookup"><span data-stu-id="67de6-107">In this release, there are no configuration settings for limiting memory or CPU usage for either data refresh jobs or on-demand queries.</span></span> <span data-ttu-id="67de6-108">[!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)]实例将使用所有可用资源来运行它正在管理的查询和数据刷新作业。</span><span class="sxs-lookup"><span data-stu-id="67de6-108">An [!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)] instance will use all of the resources that are available to run the queries and data refresh jobs it is managing.</span></span>  
  
 <span data-ttu-id="67de6-109">本主题包含以下各节：</span><span class="sxs-lookup"><span data-stu-id="67de6-109">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="67de6-110">配置处理模式</span><span class="sxs-lookup"><span data-stu-id="67de6-110">Configure a processing mode</span></span>](#config)  
  
 [<span data-ttu-id="67de6-111">更改可并行运行的数据刷新作业的数目</span><span class="sxs-lookup"><span data-stu-id="67de6-111">Change the number of data refresh jobs that can run in parallel</span></span>](#change)  
  
##  <a name="configure-a-processing-mode"></a><a name="config"></a><span data-ttu-id="67de6-112">配置处理模式</span><span class="sxs-lookup"><span data-stu-id="67de6-112">Configure a Processing Mode</span></span>  
  
1.  <span data-ttu-id="67de6-113">在管理中心的 "系统设置" 中，单击 "**管理服务器上的服务**"。</span><span class="sxs-lookup"><span data-stu-id="67de6-113">In Central Administration, in System Settings, click **Manage services on server**.</span></span>  
  
2.  <span data-ttu-id="67de6-114">在本页顶部的“服务器”中，单击下箭头，然后单击 **“更改服务器”**。</span><span class="sxs-lookup"><span data-stu-id="67de6-114">At the top of the page, in Server, click the down arrow, and then click **Change Server**.</span></span>  
  
3.  <span data-ttu-id="67de6-115">选择具有您要配置的 Analysis Services 服务器实例的 SharePoint 服务器。</span><span class="sxs-lookup"><span data-stu-id="67de6-115">Select the SharePoint server that has the Analysis Services server instance that you want to configure.</span></span>  
  
4.  <span data-ttu-id="67de6-116">单击 **SQL Server Analysis Services**。</span><span class="sxs-lookup"><span data-stu-id="67de6-116">Click **SQL Server Analysis Services**.</span></span>  
  
5.  <span data-ttu-id="67de6-117">在“服务实例使用情况”中，执行以下操作之一：</span><span class="sxs-lookup"><span data-stu-id="67de6-117">In Service Instance Usage, do one of the following:</span></span>  
  
    1.  <span data-ttu-id="67de6-118">清除 "**启用加载只读数据库**" 复选框，以关闭在用户打开包含 PowerPivot 数据的工作簿时进行的按需查询处理。</span><span class="sxs-lookup"><span data-stu-id="67de6-118">Clear the checkbox for **Enable loading of read-only databases** to turn off on-demand query processing that occurs whenever a user opens a workbook that contains PowerPivot data.</span></span>  
  
    2.  <span data-ttu-id="67de6-119">清除 "启用为**刷新加载数据库**" 复选框，关闭计划的数据刷新。</span><span class="sxs-lookup"><span data-stu-id="67de6-119">Clear the checkbox for **Enable loading of databases for refresh** to turn off scheduled data refresh.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="67de6-120">关闭数据刷新并不会从 SharePoint 站点中删除数据刷新选项。</span><span class="sxs-lookup"><span data-stu-id="67de6-120">Turning off data refresh does not remove data refresh options from SharePoint sites.</span></span> <span data-ttu-id="67de6-121">拥有 PowerPivot 工作簿的用户仍可以创建数据刷新计划，但该服务器上不会发生数据刷新。</span><span class="sxs-lookup"><span data-stu-id="67de6-121">Users who own PowerPivot workbooks can still create schedules for data refresh, but data refresh will not occur on that server.</span></span>  
  
6.  <span data-ttu-id="67de6-122">对于数据刷新操作，您还可以选择更改并发刷新作业数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-122">Optionally, for data refresh operations, you can change the number of concurrent refresh jobs.</span></span> <span data-ttu-id="67de6-123">如果服务器配置为仅进行数据刷新或如果服务器上有其他处理器，则建议增加并发作业数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-123">Increasing the number of concurrent jobs is recommended if the server is configured for data refresh only, or if there are additional processors on the server.</span></span> <span data-ttu-id="67de6-124">如果您要释放系统资源以进行更多的按需查询，则可以减少并发作业数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-124">You might decrease the number of concurrent jobs if you want to free up system resources for more on-demand queries.</span></span>  
  
7.  <span data-ttu-id="67de6-125">保存所做更改。</span><span class="sxs-lookup"><span data-stu-id="67de6-125">Save your changes.</span></span> <span data-ttu-id="67de6-126">在发生处理事件之前，服务器将不验证您的条目。</span><span class="sxs-lookup"><span data-stu-id="67de6-126">The server will not validate your entries until a processing event occurs.</span></span> <span data-ttu-id="67de6-127">如果您输入的并发作业数目无效，则在处理下一个请求时，系统将检测到并记录此错误。</span><span class="sxs-lookup"><span data-stu-id="67de6-127">If you enter an invalid number for concurrent jobs, the error will be detected and logged when the next request is processed.</span></span>  
  
##  <a name="change-the-number-of-data-refresh-jobs-that-can-run-in-parallel"></a><a name="change"></a><span data-ttu-id="67de6-128">更改可并行运行的数据刷新作业数</span><span class="sxs-lookup"><span data-stu-id="67de6-128">Change the number of data refresh jobs that can run in parallel</span></span>  
 <span data-ttu-id="67de6-129">数据刷新作业是一项计划的任务，它添加到由 PowerPivot 服务应用程序维护和监视的处理队列中。</span><span class="sxs-lookup"><span data-stu-id="67de6-129">A data refresh job is a scheduled task that is added to a processing queue that is maintained and monitored by a PowerPivot service application.</span></span> <span data-ttu-id="67de6-130">作业由 PowerPivot 工作簿中一个或多个数据源的计划信息组成。</span><span class="sxs-lookup"><span data-stu-id="67de6-130">A job consists of schedule information for one or more data sources in a PowerPivot workbook.</span></span> <span data-ttu-id="67de6-131">将为每个定义的计划创建一个单独的作业。</span><span class="sxs-lookup"><span data-stu-id="67de6-131">A separate job is created for each schedule that is defined.</span></span> <span data-ttu-id="67de6-132">如果工作簿所有者为所有数据源定义了一个计划，则将只为整个数据刷新操作创建一个作业。</span><span class="sxs-lookup"><span data-stu-id="67de6-132">If a workbook owner defines one schedule for all data sources, only one job will be created for the entire data refresh operation.</span></span> <span data-ttu-id="67de6-133">如果工作簿所有者为外部数据源创建单独的计划，则将创建和运行多个作业，以完成该工作簿的完全数据刷新。</span><span class="sxs-lookup"><span data-stu-id="67de6-133">If a workbook owner creates individual schedules for external data sources, multiple jobs will be created and run to complete a full data refresh for that workbook.</span></span>  
  
 <span data-ttu-id="67de6-134">如果系统有能力支持额外负载，则可以增加可同时运行的数据刷新作业数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-134">You can increase the number of data refresh jobs that can run at the same time if your system has the capacity to support the extra load.</span></span>  
  
|<span data-ttu-id="67de6-135">设置</span><span class="sxs-lookup"><span data-stu-id="67de6-135">Setting</span></span>|<span data-ttu-id="67de6-136">有效值</span><span class="sxs-lookup"><span data-stu-id="67de6-136">Valid values</span></span>|<span data-ttu-id="67de6-137">说明</span><span class="sxs-lookup"><span data-stu-id="67de6-137">Description</span></span>|  
|-------------|------------------|-----------------|  
|<span data-ttu-id="67de6-138">默认值</span><span class="sxs-lookup"><span data-stu-id="67de6-138">Default value</span></span>|<span data-ttu-id="67de6-139">基于 RAM 进行计算。</span><span class="sxs-lookup"><span data-stu-id="67de6-139">Calculated based on RAM.</span></span>|<span data-ttu-id="67de6-140">默认值基于可用内存量除以 4 GB 后的结果。</span><span class="sxs-lookup"><span data-stu-id="67de6-140">The default value is based on the amount of available memory divided by 4 gigabytes.</span></span> <span data-ttu-id="67de6-141">默认值由公式计算得出，以便可以根据系统的容量调整设置。</span><span class="sxs-lookup"><span data-stu-id="67de6-141">The default is calculated by a formula so that the settings can be adjusted depending on the capabilities of the system.</span></span><br /><br /> <span data-ttu-id="67de6-142">注意：根据实际 PowerPivot 数据源的大采样的 RAM 使用情况，选择 4 gb 除数。</span><span class="sxs-lookup"><span data-stu-id="67de6-142">Note: The 4 gigabyte divisor was selected based on RAM usage for a large sampling of actual PowerPivot data sources.</span></span> <span data-ttu-id="67de6-143">而不依据 PowerPivot 物理或逻辑体系结构。</span><span class="sxs-lookup"><span data-stu-id="67de6-143">It is not based on PowerPivot physical or logical architecture.</span></span>|  
|<span data-ttu-id="67de6-144">最大值</span><span class="sxs-lookup"><span data-stu-id="67de6-144">Maximum value</span></span>|<span data-ttu-id="67de6-145">基于 CPU 数量进行计算。</span><span class="sxs-lookup"><span data-stu-id="67de6-145">Calculated based on number of CPUs.</span></span>|<span data-ttu-id="67de6-146">您可以指定的最大并发作业数目基于计算机上的处理器数量。</span><span class="sxs-lookup"><span data-stu-id="67de6-146">The maximum number of concurrent jobs that you can specify is based on the number of processors on the computer.</span></span> <span data-ttu-id="67de6-147">例如，在 4 插槽四核计算机上，您可以并行运行的最大作业数目为 16。</span><span class="sxs-lookup"><span data-stu-id="67de6-147">For example, on a 4-socket quad-core computer, the maximum number of jobs that you can run concurrently is 16.</span></span>|  
  
#### <a name="increasing-the-default-value-to-a-higher-value"></a><span data-ttu-id="67de6-148">提高默认值</span><span class="sxs-lookup"><span data-stu-id="67de6-148">Increasing the default value to a higher value</span></span>  
 <span data-ttu-id="67de6-149">下图显示 RAM 和 CPU 的不同组合，以及基于系统特性计算出的默认值和最大值。</span><span class="sxs-lookup"><span data-stu-id="67de6-149">The following chart shows different combinations of RAM and CPU, and the resulting default and maximum values that are calculated based on system characteristics.</span></span> <span data-ttu-id="67de6-150">请记住，可同时运行的数据刷新作业数的计算默认值是基于系统内存的，而计算的最大值是基于 CPU 的。</span><span class="sxs-lookup"><span data-stu-id="67de6-150">Recall that the calculated default value for the number of data refresh jobs that can run concurrently is based on system memory, while the calculated maximum value is based on CPUs.</span></span> <span data-ttu-id="67de6-151">最后一列指示您是否可以增加并行数据刷新作业的最大数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-151">The last column indicates whether you can increase the maximum number of concurrent data refresh jobs.</span></span>  
  
|<span data-ttu-id="67de6-152">实际 RAM（以 GB 为单位）</span><span class="sxs-lookup"><span data-stu-id="67de6-152">Actual RAM (in gigabytes)</span></span>|<span data-ttu-id="67de6-153">计算的默认值</span><span class="sxs-lookup"><span data-stu-id="67de6-153">Calculated Default value</span></span>|<span data-ttu-id="67de6-154">CPU 实际数量</span><span class="sxs-lookup"><span data-stu-id="67de6-154">Actual Number CPUs</span></span>|<span data-ttu-id="67de6-155">计算的最大值</span><span class="sxs-lookup"><span data-stu-id="67de6-155">Calculated Maximum value</span></span>|<span data-ttu-id="67de6-156">是否增加并发作业数目？</span><span class="sxs-lookup"><span data-stu-id="67de6-156">Increase concurrent jobs?</span></span>|  
|---------------------------------|------------------------------|------------------------|------------------------------|-------------------------------|  
|<span data-ttu-id="67de6-157">4</span><span class="sxs-lookup"><span data-stu-id="67de6-157">4</span></span>|<span data-ttu-id="67de6-158">1</span><span class="sxs-lookup"><span data-stu-id="67de6-158">1</span></span>|<span data-ttu-id="67de6-159">1</span><span class="sxs-lookup"><span data-stu-id="67de6-159">1</span></span>|<span data-ttu-id="67de6-160">1</span><span class="sxs-lookup"><span data-stu-id="67de6-160">1</span></span>|<span data-ttu-id="67de6-161">否。</span><span class="sxs-lookup"><span data-stu-id="67de6-161">No.</span></span> <span data-ttu-id="67de6-162">默认值和最大值相同。</span><span class="sxs-lookup"><span data-stu-id="67de6-162">Default and maximum are the same.</span></span>|  
|<span data-ttu-id="67de6-163">4</span><span class="sxs-lookup"><span data-stu-id="67de6-163">4</span></span>|<span data-ttu-id="67de6-164">1</span><span class="sxs-lookup"><span data-stu-id="67de6-164">1</span></span>|<span data-ttu-id="67de6-165">4</span><span class="sxs-lookup"><span data-stu-id="67de6-165">4</span></span>|<span data-ttu-id="67de6-166">4</span><span class="sxs-lookup"><span data-stu-id="67de6-166">4</span></span>|<span data-ttu-id="67de6-167">是的。</span><span class="sxs-lookup"><span data-stu-id="67de6-167">Yes.</span></span> <span data-ttu-id="67de6-168">您可以将并发作业数目增加到 2、3 或 4。</span><span class="sxs-lookup"><span data-stu-id="67de6-168">You can increase the number of concurrent jobs to 2, 3, or 4.</span></span>|  
|<span data-ttu-id="67de6-169">8</span><span class="sxs-lookup"><span data-stu-id="67de6-169">8</span></span>|<span data-ttu-id="67de6-170">2</span><span class="sxs-lookup"><span data-stu-id="67de6-170">2</span></span>|<span data-ttu-id="67de6-171">4</span><span class="sxs-lookup"><span data-stu-id="67de6-171">4</span></span>|<span data-ttu-id="67de6-172">4</span><span class="sxs-lookup"><span data-stu-id="67de6-172">4</span></span>|<span data-ttu-id="67de6-173">是的。</span><span class="sxs-lookup"><span data-stu-id="67de6-173">Yes.</span></span> <span data-ttu-id="67de6-174">您可以将并发作业数目增加到 3 或 4。</span><span class="sxs-lookup"><span data-stu-id="67de6-174">You can increase the number of concurrent jobs to 3 or 4.</span></span>|  
|<span data-ttu-id="67de6-175">16</span><span class="sxs-lookup"><span data-stu-id="67de6-175">16</span></span>|<span data-ttu-id="67de6-176">4</span><span class="sxs-lookup"><span data-stu-id="67de6-176">4</span></span>|<span data-ttu-id="67de6-177">4</span><span class="sxs-lookup"><span data-stu-id="67de6-177">4</span></span>|<span data-ttu-id="67de6-178">4</span><span class="sxs-lookup"><span data-stu-id="67de6-178">4</span></span>|<span data-ttu-id="67de6-179">否。</span><span class="sxs-lookup"><span data-stu-id="67de6-179">No.</span></span> <span data-ttu-id="67de6-180">默认值和最大值相同。</span><span class="sxs-lookup"><span data-stu-id="67de6-180">Default and maximum are the same.</span></span>|  
|<span data-ttu-id="67de6-181">32</span><span class="sxs-lookup"><span data-stu-id="67de6-181">32</span></span>|<span data-ttu-id="67de6-182">使用计算默认值的公式，默认值将是 8。</span><span class="sxs-lookup"><span data-stu-id="67de6-182">Using the formula that calculates the default value, the default would be 8.</span></span> <span data-ttu-id="67de6-183">因为该默认值高于允许的最大值，所以，计算出的默认值在此情况下不使用。</span><span class="sxs-lookup"><span data-stu-id="67de6-183">Because the default is higher than the maximum allowed, the calculated default is not used in this case.</span></span>|<span data-ttu-id="67de6-184">4</span><span class="sxs-lookup"><span data-stu-id="67de6-184">4</span></span>|<span data-ttu-id="67de6-185">4</span><span class="sxs-lookup"><span data-stu-id="67de6-185">4</span></span>|<span data-ttu-id="67de6-186">否。</span><span class="sxs-lookup"><span data-stu-id="67de6-186">No.</span></span> <span data-ttu-id="67de6-187">虽然 RAM 较大可能指示默认 8 个并发作业，但具有 4 个处理器的计算机最多仅支持 4 个并发作业。</span><span class="sxs-lookup"><span data-stu-id="67de6-187">Although the large RAM would indicate a default of 8 concurrent jobs, a computer that has 4 processors will only support a maximum of 4 concurrent jobs.</span></span>|  
|<span data-ttu-id="67de6-188">32</span><span class="sxs-lookup"><span data-stu-id="67de6-188">32</span></span>|<span data-ttu-id="67de6-189">8</span><span class="sxs-lookup"><span data-stu-id="67de6-189">8</span></span>|<span data-ttu-id="67de6-190">8</span><span class="sxs-lookup"><span data-stu-id="67de6-190">8</span></span>|<span data-ttu-id="67de6-191">8</span><span class="sxs-lookup"><span data-stu-id="67de6-191">8</span></span>|<span data-ttu-id="67de6-192">否。</span><span class="sxs-lookup"><span data-stu-id="67de6-192">No.</span></span>|  
|<span data-ttu-id="67de6-193">32</span><span class="sxs-lookup"><span data-stu-id="67de6-193">32</span></span>|<span data-ttu-id="67de6-194">8</span><span class="sxs-lookup"><span data-stu-id="67de6-194">8</span></span>|<span data-ttu-id="67de6-195">16</span><span class="sxs-lookup"><span data-stu-id="67de6-195">16</span></span>|<span data-ttu-id="67de6-196">16</span><span class="sxs-lookup"><span data-stu-id="67de6-196">16</span></span>|<span data-ttu-id="67de6-197">是的。</span><span class="sxs-lookup"><span data-stu-id="67de6-197">Yes.</span></span>|  
|<span data-ttu-id="67de6-198">64</span><span class="sxs-lookup"><span data-stu-id="67de6-198">64</span></span>|<span data-ttu-id="67de6-199">16</span><span class="sxs-lookup"><span data-stu-id="67de6-199">16</span></span>|<span data-ttu-id="67de6-200">16</span><span class="sxs-lookup"><span data-stu-id="67de6-200">16</span></span>|<span data-ttu-id="67de6-201">16</span><span class="sxs-lookup"><span data-stu-id="67de6-201">16</span></span>|<span data-ttu-id="67de6-202">否。</span><span class="sxs-lookup"><span data-stu-id="67de6-202">No.</span></span>|  
  
 <span data-ttu-id="67de6-203">因为无法提前知道多个作业是否能够同时成功运行，所以，您只应在分析了内存使用量随时间的变化趋势，并确定服务器内存通常处于利用不足状态时，才增加并发作业的数目。</span><span class="sxs-lookup"><span data-stu-id="67de6-203">Because there is no way to know in advance whether multiple jobs can run successfully at the same time, you should only increase the number of concurrent jobs after you have analyzed memory consumption over time and determined that server memory is generally underutilized.</span></span>  
  
 <span data-ttu-id="67de6-204">每个数据刷新作业都具有不同的负载特征，具体取决于所刷新的数据源的数量和大小。</span><span class="sxs-lookup"><span data-stu-id="67de6-204">Each data refresh job will have different load characteristics depending on the number and size of the data sources that are being refreshed.</span></span> <span data-ttu-id="67de6-205">具有单个数据源且行数较少的工作簿与具有大量数据源和大量行集的工作簿相比，前者的处理负载要轻得多。</span><span class="sxs-lookup"><span data-stu-id="67de6-205">Workbooks that have a single data source with a smaller number of rows have a far lighter processing load than a workbook that has numerous data sources and very large row sets.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="67de6-206">另请参阅</span><span class="sxs-lookup"><span data-stu-id="67de6-206">See Also</span></span>  
 [<span data-ttu-id="67de6-207">使用 SharePoint 2010 进行 PowerPivot 数据刷新</span><span class="sxs-lookup"><span data-stu-id="67de6-207">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
