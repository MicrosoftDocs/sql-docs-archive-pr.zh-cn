---
title: " (SSAS) 连接到表格模型数据库 |Microsoft Docs"
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 983d0c8a-77da-4c6e-8638-283bcb14f143
author: minewiskan
ms.author: owend
ms.openlocfilehash: be41cc3ab493d126d12ba0cab572d484ee3348d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580417"
---
# <a name="connect-to-a-tabular-model-database-ssas"></a><span data-ttu-id="e7b70-102">连接到表格模型数据库 (SSAS)</span><span class="sxs-lookup"><span data-stu-id="e7b70-102">Connect to a Tabular Model Database (SSAS)</span></span>
  <span data-ttu-id="e7b70-103">在您生成表格模型并且将其部署到某一 Analysis Services 表格模式服务器后，需要设置权限以使其可供客户端应用程序使用。</span><span class="sxs-lookup"><span data-stu-id="e7b70-103">After you build a tabular model and deploy it to an Analysis Services tabular mode server, you need to set permissions that make it available to client applications.</span></span> <span data-ttu-id="e7b70-104">本主题介绍了如何设置权限以及如何从客户端应用程序连接到数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-104">This topic explains how to permissions and how to connect to a database from client applications.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e7b70-105">默认情况下，在您配置防火墙之前，与 Analysis Services 的远程连接将不可用。</span><span class="sxs-lookup"><span data-stu-id="e7b70-105">By default, remote connections to Analysis Services are not available until you configure the firewall.</span></span> <span data-ttu-id="e7b70-106">如果您在为客户端连接配置命名实例或默认实例，则请确保您打开了适当的端口。</span><span class="sxs-lookup"><span data-stu-id="e7b70-106">Be sure that you have opened the appropriate port if you are configuring a named or default instance for client connections.</span></span> <span data-ttu-id="e7b70-107">有关详细信息，请参阅 [Configure the Windows Firewall to Allow Analysis Services Access](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-107">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
 <span data-ttu-id="e7b70-108">本主题包含以下各节：</span><span class="sxs-lookup"><span data-stu-id="e7b70-108">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="e7b70-109">针对数据库的用户权限</span><span class="sxs-lookup"><span data-stu-id="e7b70-109">User permissions on the database</span></span>](#bkmk_userpermissions)  
  
 [<span data-ttu-id="e7b70-110">服务器上的管理权限</span><span class="sxs-lookup"><span data-stu-id="e7b70-110">Administrative permissions on the server</span></span>](#bkmk_admin)  
  
 [<span data-ttu-id="e7b70-111">从 Excel 或 SharePoint 进行连接</span><span class="sxs-lookup"><span data-stu-id="e7b70-111">Connecting from Excel or SharePoint</span></span>](#bkmk_excelconn)  
  
 [<span data-ttu-id="e7b70-112">排查连接问题</span><span class="sxs-lookup"><span data-stu-id="e7b70-112">Troubleshooting Connection Problems</span></span>](#bkmk_Tshoot)  
  
##  <a name="user-permissions-on-the-database"></a><a name="bkmk_userpermissions"></a><span data-ttu-id="e7b70-113">用户对数据库的权限</span><span class="sxs-lookup"><span data-stu-id="e7b70-113">User permissions on the database</span></span>  
 <span data-ttu-id="e7b70-114">连接到表格数据库的用户必须在指定读取访问权限的数据库角色中具有成员身份。</span><span class="sxs-lookup"><span data-stu-id="e7b70-114">Users who connect to tabular databases must have membership in a database role that specifies Read access.</span></span>  
  
 <span data-ttu-id="e7b70-115">在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中创作模型时或使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]创作模型时（对于已部署的模型）会定义角色（有时会定义角色成员身份）。</span><span class="sxs-lookup"><span data-stu-id="e7b70-115">Roles, and sometimes role membership, are defined when a model is authored in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], or for deployed models, by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="e7b70-116">有关在 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 中使用角色管理器创建角色的详细信息，请参阅[创建和管理角色（SSAS 表格）](roles-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-116">For more information about creating roles by using Role Manager in [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)], see [Create and Manage Roles &#40;SSAS Tabular&#41;](roles-ssas-tabular.md).</span></span> <span data-ttu-id="e7b70-117">有关为已部署的模型创建和管理角色的详细信息，请参阅[表格模型角色（SSAS 表格）](tabular-model-roles-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-117">For more information about creating and managing roles for a deployed model, see [Tabular Model Roles &#40;SSAS Tabular&#41;](tabular-model-roles-ssas-tabular.md).</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="e7b70-118">在 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] 中通过角色管理器使用已定义的角色重新部署表格模型项目，将覆盖已部署的表格模型中定义的角色。</span><span class="sxs-lookup"><span data-stu-id="e7b70-118">Re-deploying a tabular model project with roles defined by using Role Manager in [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)] will overwrite roles defined in a deployed tabular model.</span></span>  
  
##  <a name="administrative-permissions-on-the-server"></a><a name="bkmk_admin"></a> <span data-ttu-id="e7b70-119">针对服务器的管理权限</span><span class="sxs-lookup"><span data-stu-id="e7b70-119">Administrative permissions on the server</span></span>  
 <span data-ttu-id="e7b70-120">对于使用 SharePoint 来承载 Excel 工作簿或 Reporting Services 报表的组织，需要附加的配置以使表格模型数据可供 SharePoint 用户使用。</span><span class="sxs-lookup"><span data-stu-id="e7b70-120">For organizations that use SharePoint for hosting Excel workbooks or Reporting Services reports, additional configuration is required to make tabular model data available to SharePoint users.</span></span> <span data-ttu-id="e7b70-121">如果您未在使用 SharePoint，则跳过本节。</span><span class="sxs-lookup"><span data-stu-id="e7b70-121">If you are not using SharePoint, skip this section.</span></span>  
  
 <span data-ttu-id="e7b70-122">查看包含表格数据的 Excel 工作簿或 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 报表要求用于运行 Excel Services 或 Reporting Services 的帐户对 Analysis Services 实例具有管理员权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-122">Viewing Excel workbooks or [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports that contain tabular data requires that the account used to run Excel Services or Reporting Services has administrator permissions on the Analysis Services instance.</span></span> <span data-ttu-id="e7b70-123">需要管理权限，以便这些服务为 Analysis Services 实例所信任。</span><span class="sxs-lookup"><span data-stu-id="e7b70-123">Administrative permissions are required so that these services are trusted by the Analysis Services instance.</span></span>  
  
#### <a name="grant-administrative-access-on-the-server"></a><span data-ttu-id="e7b70-124">授予针对服务器的管理权限</span><span class="sxs-lookup"><span data-stu-id="e7b70-124">Grant administrative access on the server</span></span>  
  
1.  <span data-ttu-id="e7b70-125">在“管理中心”中，打开“配置服务帐户”页。</span><span class="sxs-lookup"><span data-stu-id="e7b70-125">In Central Administration, open the Configure service accounts page.</span></span>  
  
2.  <span data-ttu-id="e7b70-126">选择 Excel Services 使用的服务应用程序池。</span><span class="sxs-lookup"><span data-stu-id="e7b70-126">Select the service application pool used by Excel Services.</span></span> <span data-ttu-id="e7b70-127">它可以**服务应用程序池-SharePoint Web 服务系统**或自定义应用程序池。</span><span class="sxs-lookup"><span data-stu-id="e7b70-127">It might **Service Application Pool - SharePoint Web Services System** or a custom application pool.</span></span> <span data-ttu-id="e7b70-128">由 Excel Services 使用的托管帐户将出现在该页上。</span><span class="sxs-lookup"><span data-stu-id="e7b70-128">The managed account used by Excel Services will appear on the page.</span></span>  
  
     <span data-ttu-id="e7b70-129">对于包括 SharePoint 模式下 Reporting Services 的 SharePoint 场，还要获取 Reporting Services 服务应用程序的帐户信息。</span><span class="sxs-lookup"><span data-stu-id="e7b70-129">For SharePoint farms that include Reporting Services in SharePoint mode, get the account information for the Reporting Services service application as well.</span></span>  
  
     <span data-ttu-id="e7b70-130">在以下步骤中，您要将这些帐户添加到 Analysis Services 实例上的服务器角色中。</span><span class="sxs-lookup"><span data-stu-id="e7b70-130">In the following steps, you will add these accounts to the Server role on the Analysis Services instance.</span></span>  
  
3.  <span data-ttu-id="e7b70-131">在 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 中，连接到 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例，再右键单击该服务器实例，然后选择“属性”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e7b70-131">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], connect to the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], right-click the server instance, and select **Properties**.</span></span> <span data-ttu-id="e7b70-132">在对象资源管理器中，右键单击“角色”\*\*\*\*，然后选择“新建角色”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e7b70-132">In Object Explorer, right-click **Roles** and select **New Role**.</span></span>  
  
4.  <span data-ttu-id="e7b70-133">在“Analysis Services 属性”页中，选择 **“安全性”**。</span><span class="sxs-lookup"><span data-stu-id="e7b70-133">In the Analysis Services Properties page, click **Security**.</span></span>  
  
5.  <span data-ttu-id="e7b70-134">单击 **“添加”**，然后输入 Excel Services 使用的帐户，后跟 Reporting Services 使用的帐户。</span><span class="sxs-lookup"><span data-stu-id="e7b70-134">Click **Add**, and then enter the account used by Excel Services, followed by the account used by Reporting Services.</span></span>  
  
##  <a name="connecting-from-excel-or-sharepoint"></a><a name="bkmk_excelconn"></a><span data-ttu-id="e7b70-135">从 Excel 或 SharePoint 进行连接</span><span class="sxs-lookup"><span data-stu-id="e7b70-135">Connecting from Excel or SharePoint</span></span>  
 <span data-ttu-id="e7b70-136">提供对 Analysis Services 数据库的访问权限的客户端库可用于连接到在表格模式服务器上运行的模型数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-136">Client libraries that provide access to Analysis Services databases can be used to connect to model databases that run on a tabular mode server.</span></span> <span data-ttu-id="e7b70-137">库包括 Analysis Services OLE DB 访问接口、ADOMD.NET 和 AMO。</span><span class="sxs-lookup"><span data-stu-id="e7b70-137">Libraries include the Analysis Services OLE DB provider, ADOMD.NET, and AMO.</span></span>  
  
 <span data-ttu-id="e7b70-138">Excel 使用 OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="e7b70-138">Excel uses the OLE DB provider.</span></span> <span data-ttu-id="e7b70-139">如果您具有来自 SQL Server 2008 R2 的 MSOLAP.4（文件名 msolap100.dll，版本 10.50.1600.1），或者具有随 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 版的 PowerPivot for Excel 一起安装的 MSOLAP.5（文件名 msolap110.dll），则您具有将连接到表格数据库的版本。</span><span class="sxs-lookup"><span data-stu-id="e7b70-139">If you have either MSOLAP.4 from SQL Server 2008 R2 (file name msolap100.dll, version 10.50.1600.1), or MSOLAP.5 (filename msolap110.dll) that is installed with the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] version of PowerPivot for Excel, you have a version that will connect to tabular databases.</span></span>  
  
 <span data-ttu-id="e7b70-140">从以下方法中进行选择以便从 Excel 连接到模型数据库：</span><span class="sxs-lookup"><span data-stu-id="e7b70-140">Choose from the following approaches to connect to model databases from Excel:</span></span>  
  
-   <span data-ttu-id="e7b70-141">从 Excel 内创建一个数据连接，并且使用在下一节中提供的说明。</span><span class="sxs-lookup"><span data-stu-id="e7b70-141">Create a data connection from within Excel, using the instructions provided in the next section.</span></span>  
  
-   <span data-ttu-id="e7b70-142">在 SharePoint 中创建一个 BI 语义模型连接 (.bism) 文件，该文件提供重定向到在 Analysis Services 表格模式服务器上运行的数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-142">Create a BI semantic model connection (.bism) file in SharePoint that provides redirection to a database running on an Analysis Services tabular mode server.</span></span> <span data-ttu-id="e7b70-143">BI 语义模型连接文件提供一个右键单击命令，该命令通过使用您在连接中指定的模型数据库启动 Excel。</span><span class="sxs-lookup"><span data-stu-id="e7b70-143">A BI semantic model connection file provides a right-click command that launches Excel using the model database that you specified in the connection.</span></span> <span data-ttu-id="e7b70-144">如果安装了 Reporting Services，则该命令还将启动 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="e7b70-144">It will also launch [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] if Reporting Services is installed.</span></span> <span data-ttu-id="e7b70-145">有关创建和使用 BI 语义模型连接文件的详细信息，请参阅 [创建与表格模型数据库的 BI 语义模型连接](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-145">For more information about creating and using BI semantic model connection files, see [Create a BI Semantic Model Connection to a Tabular Model Database](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
-   <span data-ttu-id="e7b70-146">创建将表格数据库引用为数据源的 Reporting Services 共享数据源。</span><span class="sxs-lookup"><span data-stu-id="e7b70-146">Create a Reporting Services shared data source that references a tabular database as the data source.</span></span> <span data-ttu-id="e7b70-147">您可以在 SharePoint 中创建共享数据源，并使用该数据源启动 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="e7b70-147">You can create the shared data source in SharePoint and use it to launch [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)].</span></span>  
  
#### <a name="connect-from-excel"></a><span data-ttu-id="e7b70-148">从 Excel 进行连接</span><span class="sxs-lookup"><span data-stu-id="e7b70-148">Connect from Excel</span></span>  
  
1.  <span data-ttu-id="e7b70-149">在 Excel 中的 **“数据”** 选项卡上的 **“获取外部数据”** 中，单击 **“自其他来源”**。</span><span class="sxs-lookup"><span data-stu-id="e7b70-149">In Excel, on the **Data** tab, in **Get External Data**, click **From Other Sources**.</span></span>  
  
2.  <span data-ttu-id="e7b70-150">选择 **“从 Analysis Services”**。</span><span class="sxs-lookup"><span data-stu-id="e7b70-150">Select **From Analysis Services**.</span></span>  
  
3.  <span data-ttu-id="e7b70-151">在 **“服务器名称”** 中，指定将承载数据库的 Analysis Services 实例。</span><span class="sxs-lookup"><span data-stu-id="e7b70-151">In **Server Name**, specify the Analysis Services instance that hosts the database.</span></span> <span data-ttu-id="e7b70-152">服务器名称通常是运行服务器软件的计算机的名称。</span><span class="sxs-lookup"><span data-stu-id="e7b70-152">The server name is often the name of the computer that runs the server software.</span></span> <span data-ttu-id="e7b70-153">如果服务器作为命名实例安装，则必须按以下格式指定名称： \<servername> \\<instancename \> 。</span><span class="sxs-lookup"><span data-stu-id="e7b70-153">If the server was installed as a named instance, you must specify the name in this format: \<servername>\\<instancename\>.</span></span>  
  
     <span data-ttu-id="e7b70-154">必须为独立的表格部署配置服务器实例，并且该服务器实例必须具有允许访问的入站规则。</span><span class="sxs-lookup"><span data-stu-id="e7b70-154">The server instance must be configured for standalone tabular deployment and the server instance must have an inbound rule that allows access to it.</span></span> <span data-ttu-id="e7b70-155">有关详细信息，请参阅 [确定 Analysis Services 实例的服务器模式](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) 和 [将 Windows 防火墙配置为允许 Analysis Services 访问](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-155">For more information, see [Determine the Server Mode of an Analysis Services Instance](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) and [Configure the Windows Firewall to Allow Analysis Services Access](../instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
4.  <span data-ttu-id="e7b70-156">对于登录凭据，如果您对数据库具有读取权限，则选择 **“使用 Windows 身份验证”** 。</span><span class="sxs-lookup"><span data-stu-id="e7b70-156">For log on credentials, choose **Use Windows Authentication** if you have read permissions to the database.</span></span> <span data-ttu-id="e7b70-157">否则，请选择 **“使用以下用户名和密码”**，然后输入具有数据库权限的 Windows 帐户的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="e7b70-157">Otherwise, choose **Use the Following User Name and Password**, and enter the username and password of a Windows account that has database permissions.</span></span> <span data-ttu-id="e7b70-158">单击“下一步”。</span><span class="sxs-lookup"><span data-stu-id="e7b70-158">Click **Next**.</span></span>  
  
5.  <span data-ttu-id="e7b70-159">选择数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-159">Select the database.</span></span> <span data-ttu-id="e7b70-160">有效选择将为该数据库显示单个 **“模型”** 多维数据集。</span><span class="sxs-lookup"><span data-stu-id="e7b70-160">A valid selection will show a single **Model** cube for the database.</span></span> <span data-ttu-id="e7b70-161">单击“下一步”，然后单击“完成”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e7b70-161">Click **Next** and then click **Finish**.</span></span>  
  
 <span data-ttu-id="e7b70-162">在建立连接后，您可以使用数据来创建数据透视表或数据透视图。</span><span class="sxs-lookup"><span data-stu-id="e7b70-162">After the connection is established, you can use the data to create a PivotTable or PivotChart.</span></span> <span data-ttu-id="e7b70-163">有关详细信息，请参阅本主题后面的 [在 Excel 中分析（SSAS 表格）](analyze-in-excel-ssas-tabular.md)中的“角色管理器”对话框定义角色的表格模型作者。</span><span class="sxs-lookup"><span data-stu-id="e7b70-163">For more information, see [Analyze in Excel &#40;SSAS Tabular&#41;](analyze-in-excel-ssas-tabular.md).</span></span>  
  
##  <a name="connect-from-sharepoint"></a><a name="bkmk_sharepoint"></a> <span data-ttu-id="e7b70-164">从 SharePoint 进行连接</span><span class="sxs-lookup"><span data-stu-id="e7b70-164">Connect from SharePoint</span></span>  
 <span data-ttu-id="e7b70-165">如果使用的是 PowerPivot for SharePoint，则可在 SharePoint 中创建一个 BI 语义模型连接文件，通过该文件，可重定向到在 Analysis Services 表格模式服务器上运行的数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-165">If you are using PowerPivot for SharePoint, you can create a BI semantic model connection file in SharePoint that provides redirection to a database running on an Analysis Services tabular mode server.</span></span> <span data-ttu-id="e7b70-166">BI 语义模型连接提供指向数据库的 HTTP 端点。</span><span class="sxs-lookup"><span data-stu-id="e7b70-166">A BI semantic model connection provides an HTTP endpoint to a database.</span></span> <span data-ttu-id="e7b70-167">对于经常要使用 SharePoint 站点上的文档的知识工作者，该连接还简化了表格模型访问。</span><span class="sxs-lookup"><span data-stu-id="e7b70-167">It also simplifies tabular model access for knowledge workers who routinely use documents on a SharePoint site.</span></span> <span data-ttu-id="e7b70-168">知识工作者只需要知道 BI 语义模型连接文件的位置或其 URL 就可以访问表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="e7b70-168">Knowledge workers only need to know the location of the BI semantic model connection file or its URL to access tabular model databases.</span></span> <span data-ttu-id="e7b70-169">与服务器位置或数据库名称有关的详细信息封装在 BI 语义模型连接中。</span><span class="sxs-lookup"><span data-stu-id="e7b70-169">Details about server location or database name are encapsulated in the BI semantic model connection.</span></span> <span data-ttu-id="e7b70-170">有关创建和使用 BI 语义模型连接文件的详细信息，请参阅[POWERPIVOT BI 语义模型连接 &#40; bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md)并[创建与表格模型数据库的 BI 语义模型连接](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)。</span><span class="sxs-lookup"><span data-stu-id="e7b70-170">For more information about creating and using BI semantic model connection files, see [PowerPivot BI Semantic Model Connection &#40;.bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md) and   [Create a BI Semantic Model Connection to a Tabular Model Database](../power-pivot-sharepoint/create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
##  <a name="troubleshooting-connection-problems"></a><a name="bkmk_Tshoot"></a><span data-ttu-id="e7b70-171">排查连接问题</span><span class="sxs-lookup"><span data-stu-id="e7b70-171">Troubleshooting Connection Problems</span></span>  
 <span data-ttu-id="e7b70-172">本节介绍在连接到表格模型数据库时发生的问题的原因和解决方法步骤。</span><span class="sxs-lookup"><span data-stu-id="e7b70-172">This section provides cause and resolution steps for problems that occur while connecting to a tabular model database.</span></span>  
  
 <span data-ttu-id="e7b70-173">**数据连接向导不能从指定的数据源获取数据库列表。**</span><span class="sxs-lookup"><span data-stu-id="e7b70-173">**The Data Connection Wizard cannot obtain a list of databases from the specified data source.**</span></span>  
  
 <span data-ttu-id="e7b70-174">在导入数据时，如果您尝试使用该向导连接到远程 Analysis Services 服务器上的表格模型数据库，而您不具有足够的权限，则会发生此 Microsoft Excel 错误。</span><span class="sxs-lookup"><span data-stu-id="e7b70-174">When importing data, this Microsoft Excel error occurs when you try to use the Wizard to connect to a tabular model database on a remote Analysis Services server, and you do not have sufficient permissions.</span></span> <span data-ttu-id="e7b70-175">若要纠正此错误，您必须对数据库具有用户访问权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-175">To resolve this error, you must have user access rights on the database.</span></span> <span data-ttu-id="e7b70-176">请参考在本文前面部分中提供的说明，授予用户对数据的访问权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-176">Refer to the instructions provided earlier in this topic for granting user access to data.</span></span>  
  
 <span data-ttu-id="e7b70-177">**尝试建立与外部数据源的连接时出错。以下连接无法刷新： \<model name> 沙盒**</span><span class="sxs-lookup"><span data-stu-id="e7b70-177">**An error occurred during an attempt to establish a connection to the external data source. The following connections failed to refresh: \<model name> Sandbox**</span></span>  
  
 <span data-ttu-id="e7b70-178">在 SharePoint 上，当您尝试在使用模型数据的数据透视表中进行数据交互（例如筛选数据）时，将会发生此 Microsoft Excel 错误。</span><span class="sxs-lookup"><span data-stu-id="e7b70-178">On SharePoint, this Microsoft Excel error occurs when you attempt data interaction, such as filtering data, in a PivotTable that uses model data.</span></span> <span data-ttu-id="e7b70-179">发生此错误的原因是您对远程 Analysis Services 服务器没有足够的权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-179">The error occurs because you do not have sufficient permissions on the remote Analysis Services server.</span></span> <span data-ttu-id="e7b70-180">若要纠正此错误，您必须对数据库具有用户访问权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-180">To resolve this error, you must have user access rights on the database.</span></span> <span data-ttu-id="e7b70-181">请参考在本文前面部分中提供的说明，授予用户对数据的访问权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-181">Refer to the instructions provided earlier in this topic for granting user access to data.</span></span>  
  
 <span data-ttu-id="e7b70-182">**尝试执行此操作时出错。请重新加载工作簿，然后再次尝试执行此操作。**</span><span class="sxs-lookup"><span data-stu-id="e7b70-182">**An error occurred while attempting to perform this operation. Reload the workbook, and then try to perform this operation again.**</span></span>  
  
 <span data-ttu-id="e7b70-183">在 SharePoint 上，当您尝试在使用模型数据的数据透视表中进行数据交互（例如筛选数据）时，将会发生此 Microsoft Excel 错误。</span><span class="sxs-lookup"><span data-stu-id="e7b70-183">On SharePoint, this Microsoft Excel error occurs when you attempt data interaction, such as filtering data, in a PivotTable that uses model data.</span></span> <span data-ttu-id="e7b70-184">发生此错误的原因是部署了模型数据的 Analysis Services 实例不信任 Excel Services。</span><span class="sxs-lookup"><span data-stu-id="e7b70-184">The error occurs because Excel Services is not trusted by the Analysis Services instance on which the model data is deployed.</span></span> <span data-ttu-id="e7b70-185">若要纠正此错误，请对 Analysis Services 实例授予 Excel Services 管理权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-185">To resolve this error, grant Excel Services administrative permission on the Analysis Services instance.</span></span> <span data-ttu-id="e7b70-186">请参考在本文前面部分中提供的说明，授予管理员权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-186">Refer to the instructions provided earlier in this topic for granting administrator permissions.</span></span> <span data-ttu-id="e7b70-187">如果此错误仍存在，请回收 Excel Services 应用程序池。</span><span class="sxs-lookup"><span data-stu-id="e7b70-187">If the error persists, recycle the Excel Services application pool.</span></span>  
  
 <span data-ttu-id="e7b70-188">**在尝试与在工作簿中使用的外部数据源建立连接的过程中出现错误。**</span><span class="sxs-lookup"><span data-stu-id="e7b70-188">**An error occurred during an attempt to establish a connection to the external data source used in the workbook**</span></span>  
  
 <span data-ttu-id="e7b70-189">在 SharePoint 上，当您尝试在使用模型数据的数据透视表中进行数据交互（例如筛选数据）时，将会发生此 Microsoft Excel 错误。</span><span class="sxs-lookup"><span data-stu-id="e7b70-189">On SharePoint, this Microsoft Excel error occurs when you attempt data interaction, such as filtering data, in a PivotTable that uses model data.</span></span> <span data-ttu-id="e7b70-190">发生此错误的原因是该用户对工作簿没有足够的 SharePoint 权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-190">The error occurs because the user does not have sufficient SharePoint permissions on the workbook.</span></span> <span data-ttu-id="e7b70-191">该用户必须具有 **“读取”** 权限或更高权限。</span><span class="sxs-lookup"><span data-stu-id="e7b70-191">The user must have **Read** permissions or above.</span></span> <span data-ttu-id="e7b70-192">“仅查看”\*\*\*\* 权限对于数据访问是不够的。</span><span class="sxs-lookup"><span data-stu-id="e7b70-192">**View-Only** permissions are not sufficient for data access.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e7b70-193">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e7b70-193">See Also</span></span>  
 [<span data-ttu-id="e7b70-194">表格模型解决方案部署（SSAS 表格）</span><span class="sxs-lookup"><span data-stu-id="e7b70-194">Tabular Model Solution Deployment &#40;SSAS Tabular&#41;</span></span>](tabular-model-solution-deployment-ssas-tabular.md)  
  
  
