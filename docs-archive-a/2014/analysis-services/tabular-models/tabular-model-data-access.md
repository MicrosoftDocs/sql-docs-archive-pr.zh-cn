---
title: 表格模型数据访问 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 6ae74a8b-0025-450d-94a5-4e601831d420
author: minewiskan
ms.author: owend
ms.openlocfilehash: e9d7c336c549513ff6bd7cc3a2b409ec8776e581
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692549"
---
# <a name="tabular-model-data-access"></a><span data-ttu-id="e44fc-102">表格模型数据访问</span><span class="sxs-lookup"><span data-stu-id="e44fc-102">Tabular Model Data Access</span></span>
  <span data-ttu-id="e44fc-103">Analysis Services 中的表格模型数据库可由用于检索多维模型中的数据或元数据的大多数相同的客户端、接口和语言访问。</span><span class="sxs-lookup"><span data-stu-id="e44fc-103">Tabular model databases in Analysis Services can be accessed by most of the same clients, interfaces, and languages that you use to retrieve data or metadata from a multidimensional model.</span></span> <span data-ttu-id="e44fc-104">有关详细信息，请参阅[多维模型数据访问（Analysis Services - 多维数据）](../multidimensional-models/mdx/multidimensional-model-data-access-analysis-services-multidimensional-data.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-104">For more information, see [Multidimensional Model Data Access &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models/mdx/multidimensional-model-data-access-analysis-services-multidimensional-data.md).</span></span>  
  
 <span data-ttu-id="e44fc-105">本主题介绍适用于表格模型的客户端、查询语言和编程接口。</span><span class="sxs-lookup"><span data-stu-id="e44fc-105">This topic describes the clients, query languages, and programmatic interfaces that work with tabular models.</span></span>  
  
## <a name="clients"></a><span data-ttu-id="e44fc-106">客户端</span><span class="sxs-lookup"><span data-stu-id="e44fc-106">Clients</span></span>  
 <span data-ttu-id="e44fc-107">以下 Microsoft 客户端应用程序支持本机连接到 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="e44fc-107">The following Microsoft client applications support native connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model databases.</span></span>  
  
### <a name="excel"></a><span data-ttu-id="e44fc-108">Excel</span><span class="sxs-lookup"><span data-stu-id="e44fc-108">Excel</span></span>  
 <span data-ttu-id="e44fc-109">您可以从 Excel 连接表格模型数据库，使用 Excel 中的数据可视化和分析功能来处理数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-109">You can connect to tabular model databases from Excel, using the data visualization and analysis capabilities in Excel to work with your data.</span></span> <span data-ttu-id="e44fc-110">若要访问数据，您需要定义 Analysis Services 数据连接，指定以表格服务器模式运行的服务器，然后选择要使用的数据库。</span><span class="sxs-lookup"><span data-stu-id="e44fc-110">To access the data, you define an Analysis Services data connection, specify a server that runs in tabular server mode, and then choose the database you want to use.</span></span> <span data-ttu-id="e44fc-111">有关详细信息，请参阅 [连接到 SQL Server Analysis Services 或从其中导入数据](https://go.microsoft.com/fwlink/?linkID=215150)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-111">For more information, see [Connect to or import data from SQL Server Analysis Services](https://go.microsoft.com/fwlink/?linkID=215150).</span></span>  
  
 <span data-ttu-id="e44fc-112">Excel 也是推荐用于在 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]中浏览表格模型的应用程序。</span><span class="sxs-lookup"><span data-stu-id="e44fc-112">Excel is also the recommended application for browsing tabular models in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="e44fc-113">该工具包括一个 **“在 Excel 中分析”** 选项，可用来启动新的 Excel 实例，创建 Excel 工作簿并打开从该工作簿到模型工作区数据库的数据连接。</span><span class="sxs-lookup"><span data-stu-id="e44fc-113">The tool includes an **Analyze in Excel** option that starts a new instance of Excel, creates an Excel workbook, and opens a data connection from the workbook to the model workspace database.</span></span> <span data-ttu-id="e44fc-114">在 Excel 中浏览表格模型数据时，要注意 Excel 使用 Excel PivotTable 客户端对该模型发出查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-114">When browsing tabular model data in Excel, be aware that Excel issues queries against the model using the Excel PivotTable client.</span></span> <span data-ttu-id="e44fc-115">相应地，Excel 工作簿中的操作会生成将发送到工作区数据库的 MDX 查询而非 DAX 查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-115">Accordingly, operations within the Excel workbook result in MDX queries being sent to the workspace database, not DAX queries.</span></span> <span data-ttu-id="e44fc-116">如果您在使用 SQL Profiler 或其他监视工具来监视查询，则应能在事件探查器跟踪中看到 MDX 而不是 DAX。</span><span class="sxs-lookup"><span data-stu-id="e44fc-116">If you are using SQL Profiler or another monitoring tool to monitor queries, you can expect to see MDX and not DAX in the profiler trace.</span></span> <span data-ttu-id="e44fc-117">有关“在 Excel 中分析”功能的详细信息，请参阅[在 Excel 中分析（SSAS 表格）](analyze-in-excel-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-117">For more information about the Analyze in Excel feature, see [Analyze in Excel &#40;SSAS Tabular&#41;](analyze-in-excel-ssas-tabular.md).</span></span>  
  
### <a name="power-view"></a><span data-ttu-id="e44fc-118">Power View</span><span class="sxs-lookup"><span data-stu-id="e44fc-118">Power View</span></span>  
 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] <span data-ttu-id="e44fc-119">是一个在 SharePoint 2010 环境中运行的 Reporting Services 报表客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="e44fc-119">is a Reporting Services reporting client application that runs in a SharePoint 2010 environment.</span></span> <span data-ttu-id="e44fc-120">它将数据浏览、查询设计和演示布局融合为集成的特别报表体验。</span><span class="sxs-lookup"><span data-stu-id="e44fc-120">It combines data exploration, query design, and presentation layout into an integrated ad-hoc reporting experience.</span></span> [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] <span data-ttu-id="e44fc-121">可以将表格模型用作数据源，无论该模型是承载于在表格模式下运行的 Analysis Services 实例中，还是使用 DirectQuery 模式从关系数据存储区中检索到的。</span><span class="sxs-lookup"><span data-stu-id="e44fc-121">can use tabular models as data sources, regardless of whether the model is hosted on an instance of Analysis Services running in tabular mode, or retrieved from a relational data store by using DirectQuery mode.</span></span> <span data-ttu-id="e44fc-122">若要在 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)]中连接到表格模型，您必须创建包含服务器位置和数据库名称的连接文件。</span><span class="sxs-lookup"><span data-stu-id="e44fc-122">To connect to a tabular model in [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)], you must create a connection file that contains the server location and database name.</span></span> <span data-ttu-id="e44fc-123">您可以在 SharePoint 中创建 Reporting Services 共享数据源或 BI 语义模型连接文件。</span><span class="sxs-lookup"><span data-stu-id="e44fc-123">You can create a Reporting Services shared data source or a BI semantic model connection file in SharePoint.</span></span> <span data-ttu-id="e44fc-124">有关 BI 语义模型连接的详细信息，请参阅[POWERPIVOT BI 语义模型连接 &#40; bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-124">For more information about BI semantic model connections, see [PowerPivot BI Semantic Model Connection &#40;.bism&#41;](../power-pivot-sharepoint/power-pivot-bi-semantic-model-connection-bism.md).</span></span>  
  
 <span data-ttu-id="e44fc-125">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 客户端通过向指定的数据源发送请求来确定指定模型的结构，这将返回一个架构，客户端可使用此架构来创建针对作为数据源的模型的查询并执行基于数据的操作。</span><span class="sxs-lookup"><span data-stu-id="e44fc-125">The [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client determines the structure of the specified model by sending a request to the specified data source, which returns a schema that can be used by the client to create queries against the model as a data source and perform operations based on the data.</span></span> <span data-ttu-id="e44fc-126">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 用户界面中用于筛选数据、执行计算或聚合以及显示关联数据的后续操作由客户端控制且不能以编程方式来执行这些操作。</span><span class="sxs-lookup"><span data-stu-id="e44fc-126">Subsequent operations in the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] user interface to filter data, perform calculations or aggregations, and display associated data are controlled by the client and cannot be programmatically manipulated.</span></span>  
  
 <span data-ttu-id="e44fc-127">[!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 客户端向模型发送的查询会作为 DAX 语句发出，您可以在模型上设置跟踪来进行监视。</span><span class="sxs-lookup"><span data-stu-id="e44fc-127">The queries that are sent by the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client to the model are issued as DAX statements, which you can monitor by setting a trace on the model.</span></span>  <span data-ttu-id="e44fc-128">客户端还向服务器发出了有关初始架构定义的请求，该定义将根据概念性架构定义语言 (CSDL) 呈现。</span><span class="sxs-lookup"><span data-stu-id="e44fc-128">The client also issues a request to the server for the initial schema definition, which is presented according to the Conceptual Schema Definition Language (CSDL).</span></span> <span data-ttu-id="e44fc-129">有关详细信息，请参阅 [用于商业智能的 CSDL 批注 (CSDLBI)](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)</span><span class="sxs-lookup"><span data-stu-id="e44fc-129">For more information, see [CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)</span></span>  
  
### <a name="sql-server-management-studio"></a><span data-ttu-id="e44fc-130">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="e44fc-130">SQL Server Management Studio</span></span>  
 <span data-ttu-id="e44fc-131">可以使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 管理承载表格模型的实例并查询这些实例中的元数据和数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-131">You can use [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] to manage instances that host tabular models, and to query the metadata and data in them.</span></span> <span data-ttu-id="e44fc-132">可以处理模型或模型中的对象、创建和管理分区以及设置用于管理数据访问的安全性。</span><span class="sxs-lookup"><span data-stu-id="e44fc-132">You can process models or the objects in a model, create and manage partitions, and set security that can be used for managing data access.</span></span> <span data-ttu-id="e44fc-133">有关详细信息，请参阅下列主题：</span><span class="sxs-lookup"><span data-stu-id="e44fc-133">For more information, see the following topics:</span></span>  
  
-   [<span data-ttu-id="e44fc-134">确定 Analysis Services 实例的服务器模式</span><span class="sxs-lookup"><span data-stu-id="e44fc-134">Determine the Server Mode of an Analysis Services Instance</span></span>](../instances/determine-the-server-mode-of-an-analysis-services-instance.md)  
  
-   [<span data-ttu-id="e44fc-135">连接到 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e44fc-135">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
-   [<span data-ttu-id="e44fc-136">监视 Analysis Services 实例</span><span class="sxs-lookup"><span data-stu-id="e44fc-136">Monitor an Analysis Services Instance</span></span>](../instances/monitor-an-analysis-services-instance.md)  
  
 <span data-ttu-id="e44fc-137">可以在 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 中同时使用 MDX 查询窗口和 XMLA 查询窗口来从表格模型数据库检索数据和元数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-137">You can use both the MDX and XMLA query windows in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] to retrieve data and metadata from a tabular model database.</span></span> <span data-ttu-id="e44fc-138">但是，请注意下列限制：</span><span class="sxs-lookup"><span data-stu-id="e44fc-138">However, note the following restrictions:</span></span>  
  
-   <span data-ttu-id="e44fc-139">已在 DirectQuery 模式下部署的模型不支持使用 MDX 和 DMX 的语句；因此，如果您需要创建针对 DirectQuery 模式下的表格模型的查询，则应改用 **“XMLA 查询”** 窗口。</span><span class="sxs-lookup"><span data-stu-id="e44fc-139">Statements using MDX and DMX are not supported for models that have been deployed in DirectQuery mode; therefore, if you need to create a query against a tabular model in DirectQuery mode, you should use an **XMLA Query** window instead.</span></span>  
  
-   <span data-ttu-id="e44fc-140">打开 **“查询”** 窗口后，无法更改 XMLA 查询窗口的数据库上下文。</span><span class="sxs-lookup"><span data-stu-id="e44fc-140">You cannot change the database context of the XMLA Query window after you have opened the **Query** window.</span></span> <span data-ttu-id="e44fc-141">因此，如果您需要向其他数据库或其他实例发送查询，则必须使用 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 打开该数据库或实例，并在该上下文中打开新的 **“XMLA 查询”** 窗口。</span><span class="sxs-lookup"><span data-stu-id="e44fc-141">Therefore, if you need to send a query to a different database or to a different instance, you must open that database or instance using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and open a new **XMLA Query** window within that context.</span></span>  
  
 <span data-ttu-id="e44fc-142">可以创建针对 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 表格模型的跟踪，就像对多维解决方案执行此操作一样。</span><span class="sxs-lookup"><span data-stu-id="e44fc-142">You can create traces against an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model as you would on a multidimensional solution.</span></span> <span data-ttu-id="e44fc-143">在此版本中， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 提供了许多新事件，可用于跟踪内存使用率、查询和处理操作以及文件使用率。</span><span class="sxs-lookup"><span data-stu-id="e44fc-143">In this release, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] provides many new events that can be used to track memory usage, query and processing operations, and file usage.</span></span> <span data-ttu-id="e44fc-144">有关详细信息，请参阅 [Analysis Services 跟踪事件](https://docs.microsoft.com/bi-reference/trace-events/analysis-services-trace-events)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-144">For more information, see [Analysis Services Trace Events](https://docs.microsoft.com/bi-reference/trace-events/analysis-services-trace-events).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e44fc-145">如果对表格模型数据库进行跟踪，则可能会显示一些归类为 DMX 查询的事件。</span><span class="sxs-lookup"><span data-stu-id="e44fc-145">If you put a trace on a tabular model database, you might see some events that are categorized as DMX queries.</span></span> <span data-ttu-id="e44fc-146">但是，表格模型数据不支持数据挖掘，并且数据库上执行的 DMX 查询仅适用于模型元数据的 SELECT 语句。</span><span class="sxs-lookup"><span data-stu-id="e44fc-146">However, data mining is not supported on tabular model data, and the DMX queries executed on the database are limited to SELECT statements on the model metadata.</span></span> <span data-ttu-id="e44fc-147">这些事件仅归类为 DMX，因为 MDX 使用的是相同的分析器框架。</span><span class="sxs-lookup"><span data-stu-id="e44fc-147">The events are categorized as DMX only because the same parser framework is used for MDX.</span></span>  
  
## <a name="query-languages"></a><span data-ttu-id="e44fc-148">查询语言</span><span class="sxs-lookup"><span data-stu-id="e44fc-148">Query Languages</span></span>  
 <span data-ttu-id="e44fc-149">Analysis Services 表格模型支持为访问多维模型而提供的大多数相同的查询语言。</span><span class="sxs-lookup"><span data-stu-id="e44fc-149">Analysis Services tabular models support most of the same query languages that are provided for access to multidimensional models.</span></span> <span data-ttu-id="e44fc-150">已在 DirectQuery 模式下部署的表格模型属于例外情况，该模型不从 Analysis Services 数据存储检索数据，而是直接从 SQL Server 数据源检索数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-150">The exception is tabular models that have been deployed in DirectQuery mode, which do not retrieve data from an Analysis Services data store, but retrieve data directly from a SQL Server data source.</span></span> <span data-ttu-id="e44fc-151">无法使用 MDX 查询这些模型，但必须使用支持从 DAX 表达式到 Transact-SQL 语句的转换的客户端，如 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 客户端。</span><span class="sxs-lookup"><span data-stu-id="e44fc-151">You cannot query these models using MDX, but must use a client that supports conversion of DAX expressions to Transact-SQL statements, such as the [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] client.</span></span>  
  
### <a name="dax"></a><span data-ttu-id="e44fc-152">DAX</span><span class="sxs-lookup"><span data-stu-id="e44fc-152">DAX</span></span>  
 <span data-ttu-id="e44fc-153">可以使用 DAX 在所有类型的表格模型中创建表达式和公式，无论该模型是作为已启用 PowerPivot 的 Excel 工作簿存储在 SharePoint 中，还是存储在 Analysis Services 实例中。</span><span class="sxs-lookup"><span data-stu-id="e44fc-153">You can use DAX for creating expressions and formulas in all kinds of tabular models, regardless of whether the model is stored on SharePoint as a PowerPivot-enabled Excel workbook, or on an instance of Analysis Services.</span></span>  
  
 <span data-ttu-id="e44fc-154">此外，您可以在 XMLA EXECUTE 命令语句的上下文中使用 DAX 表达式来向已在 DirectQuery 模式下部署的表格模型发送查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-154">Additionally, you can use DAX expressions within the context of an XMLA EXECUTE command statement to send queries to a tabular model that has been deployed in DirectQuery mode.</span></span>  
  
 <span data-ttu-id="e44fc-155">有关使用 DAX 的表格模型查询的示例，请参阅 [DAX 查询语法参考] (/dax/dax-syntax-reference</span><span class="sxs-lookup"><span data-stu-id="e44fc-155">For examples of queries on a tabular model using DAX, see [DAX Query Syntax Reference](/dax/dax-syntax-reference</span></span>
  
### <a name="mdx"></a><span data-ttu-id="e44fc-156">MDX</span><span class="sxs-lookup"><span data-stu-id="e44fc-156">MDX</span></span>  
 <span data-ttu-id="e44fc-157">可以使用 MDX 创建针对将内存中缓存用作首选查询方法的表格模型（即，尚未在 DirectQuery 模式下部署的模型）的查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-157">You can use MDX to create queries against tabular models that use the in-memory cache as the preferred query method (that is, models that have not been deployed in DirectQuery mode).</span></span> <span data-ttu-id="e44fc-158">虽然 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 等客户端会使用 DAX 来创建聚合并将模型作为数据源进行查询，但如果熟悉 MDX，则可在 MDX 中快速创建示例查询，请参阅 [在 MDX 中生成度量值](../multidimensional-models/mdx/mdx-building-measures.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-158">Although clients such as [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] use DAX both for creating aggregations and for querying the model as a data source, if you are familiar with MDX it can be a shortcut to create sample queries in MDX, see [Building Measures in MDX](../multidimensional-models/mdx/mdx-building-measures.md).</span></span>  
  
### <a name="csdl"></a><span data-ttu-id="e44fc-159">CSDL</span><span class="sxs-lookup"><span data-stu-id="e44fc-159">CSDL</span></span>  
 <span data-ttu-id="e44fc-160">虽然概念性架构定义语言本身并不是查询语言，但可使用它检索有关模型和模型元数据的信息，然后可使用这些信息来创建报告或创建针对模型的查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-160">The Conceptual Schema Definition Language is not a query language, per se, but it can be used to retrieve information about the model and model metadata, that can later be used to create reports or create queries against the model.</span></span>  
  
 <span data-ttu-id="e44fc-161">有关如何在表格模型中使用 CSDL 的信息，请参阅 [用于商业智能的 CSDL 批注 (CSDLBI)](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-161">For information about how CSDL is used in tabular models, see [CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi).</span></span>  
  
## <a name="programmatic-interfaces"></a><span data-ttu-id="e44fc-162">编程接口</span><span class="sxs-lookup"><span data-stu-id="e44fc-162">Programmatic Interfaces</span></span>  
 <span data-ttu-id="e44fc-163">用于与 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 表格模型进行交互的主要接口为架构行集、XMLA 以及由 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 和 [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)]提供的查询客户端和查询工具。</span><span class="sxs-lookup"><span data-stu-id="e44fc-163">The principal interfaces that are used for interacting with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular models are the schema rowsets, XMLA, and the query clients and query tools provided by [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and [!INCLUDE[ssBIDevStudio](../../includes/ssbidevstudio-md.md)].</span></span>  
  
### <a name="data-and-metadata"></a><span data-ttu-id="e44fc-164">数据和元数据</span><span class="sxs-lookup"><span data-stu-id="e44fc-164">Data and Metadata</span></span>  
 <span data-ttu-id="e44fc-165">可以使用 ADOMD.NET 从托管应用程序中的表格模型检索数据和元数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-165">You can retrieve data and metadata from tabular models in managed applications using ADOMD.NET.</span></span> <span data-ttu-id="e44fc-166">有关创建和修改表格模型中的对象的应用程序示例，请参阅下列资源：</span><span class="sxs-lookup"><span data-stu-id="e44fc-166">For examples of applications that create and modify objects in a tabular model, see the following resources:</span></span>  
  
-   <span data-ttu-id="e44fc-167">Codeplex 上的表格模型 AMO 示例</span><span class="sxs-lookup"><span data-stu-id="e44fc-167">Tabular Model AMO Sample on Codeplex</span></span>  
  
-   [<span data-ttu-id="e44fc-168">使用动态管理视图 (DMV) 监视 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e44fc-168">Use Dynamic Management Views &#40;DMVs&#41; to Monitor Analysis Services</span></span>](../instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md)  
  
 <span data-ttu-id="e44fc-169">可以在非托管客户端应用程序中使用 Analysis Services 9.0 OLE DB 访问接口以支持对表格模型的 OLE DB 访问。</span><span class="sxs-lookup"><span data-stu-id="e44fc-169">You can use the Analysis Services 9.0 OLE DB provider in unmanaged client applications to support OLE DB access to tabular models.</span></span> <span data-ttu-id="e44fc-170">启用表格模型访问需要更新版本的 Analysis Services OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="e44fc-170">An updated version of the Analysis Services OLE DB provider is required to enable tabular model access.</span></span> <span data-ttu-id="e44fc-171">有关用于表格模型的提供程序的详细信息，请参阅 [在 SharePoint 服务器上安装 Analysis Services OLE DB 提供程序](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) 。</span><span class="sxs-lookup"><span data-stu-id="e44fc-171">For more information about providers used with tabular models, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md) .</span></span>  
  
 <span data-ttu-id="e44fc-172">还可以直接从 Analysis Services 实例以基于 XML 的格式检索数据。</span><span class="sxs-lookup"><span data-stu-id="e44fc-172">You can also retrieve data directly from an Analysis Services instance in an XML-based format.</span></span> <span data-ttu-id="e44fc-173">可以使用 DISCOVER_CSDL_METADATA 行集来检索表格模型的架构，也可以将 EXECUTE 或 DISCOVER 命令与现有 ASSL 元素、对象或属性一起使用。</span><span class="sxs-lookup"><span data-stu-id="e44fc-173">You can retrieve the schema of the tabular model by using the DISCOVER_CSDL_METADATA rowset, or you can use an EXECUTE or DISCOVER command with existing ASSL elements, objects, or properties.</span></span> <span data-ttu-id="e44fc-174">有关详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="e44fc-174">For more information, see the following resources:</span></span>  
  
-   [<span data-ttu-id="e44fc-175">用于商业智能的 CSDL 批注 (CSDLBI)</span><span class="sxs-lookup"><span data-stu-id="e44fc-175">CSDL Annotations for Business Intelligence &#40;CSDLBI&#41;</span></span>](/analysis-services/csdlbi/csdl-annotations-for-business-intelligence-csdlbi)  
  
### <a name="manipulate-analysis-services-objects"></a><span data-ttu-id="e44fc-176">操作 Analysis Services 对象</span><span class="sxs-lookup"><span data-stu-id="e44fc-176">Manipulate Analysis Services Objects</span></span>  
 <span data-ttu-id="e44fc-177">可以使用 XMLA 命令或使用 AMO 来创建、修改、删除和处理表格模型及其对象（包括表、列、透视、度量值和分区）。</span><span class="sxs-lookup"><span data-stu-id="e44fc-177">You can create, modify, delete, and process tabular models and objects in them, including tables, columns, perspectives, measures, and partitions, using XMLA commands, or by using AMO.</span></span> <span data-ttu-id="e44fc-178">已同时更新 AMO 和 XMLA 以支持表格模型中用于增强报告和建模的其他属性。</span><span class="sxs-lookup"><span data-stu-id="e44fc-178">Both AMO and XMLA have been updated to support additional properties that are used in tabular models for enhanced reporting and modeling.</span></span>  
  
 <span data-ttu-id="e44fc-179">有关如何使用 AMO 和 XMLA 为表格对象编写脚本的示例，请参阅下列资源：</span><span class="sxs-lookup"><span data-stu-id="e44fc-179">For examples of how tabular objects can be scripted using AMO and XMLA, see the following resources:</span></span>  
  
-   <span data-ttu-id="e44fc-180">Codeplex 上的表格模型 AMO 示例</span><span class="sxs-lookup"><span data-stu-id="e44fc-180">Tabular Model AMO Sample on Codeplex</span></span>  
  
-   <span data-ttu-id="e44fc-181">CodePlex 上的 AdventureWorks 示例</span><span class="sxs-lookup"><span data-stu-id="e44fc-181">AdventureWorks Samples on CodePlex</span></span>  
  
 <span data-ttu-id="e44fc-182">可以使用 PowerShell 管理和监视 Analysis Services 实例以及创建和监视用于表格模型访问的安全性。</span><span class="sxs-lookup"><span data-stu-id="e44fc-182">You can use PowerShell to manage and monitor instances of Analysis Services, as well as for creating and monitoring security used for tabular model access.</span></span> <span data-ttu-id="e44fc-183">有关详细信息，请参阅[Analysis Services PowerShell](../analysis-services-powershell.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-183">For more information, see [Analysis Services PowerShell](../analysis-services-powershell.md).</span></span>  
  
### <a name="schema-rowsets"></a><span data-ttu-id="e44fc-184">架构行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-184">Schema Rowsets</span></span>  
 <span data-ttu-id="e44fc-185">客户端应用程序可使用架构行集来检查表格模型的元数据并从 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器中检索支持和监视信息。</span><span class="sxs-lookup"><span data-stu-id="e44fc-185">Client applications can use the schema rowsets to examine the metadata of tabular models and to retrieve support and monitoring information from the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server.</span></span> <span data-ttu-id="e44fc-186">此版本的 SQL Server 中不仅添加了新的架构行集，并且现有架构行集得到了扩展以支持与表格模型相关的功能并增强 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]中的监视与性能分析。</span><span class="sxs-lookup"><span data-stu-id="e44fc-186">In this release of SQL Server new schema rowsets have been added and existing schema rowsets extended to support features related to tabular models and to enhance monitoring and performance analysis across [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   [<span data-ttu-id="e44fc-187">DISCOVER_CALC_DEPENDENCY 行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-187">DISCOVER_CALC_DEPENDENCY Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-calc-dependency-rowset)  
  
     <span data-ttu-id="e44fc-188">用于跟踪表格模型中列和参考之间的依赖关系的新架构行集。</span><span class="sxs-lookup"><span data-stu-id="e44fc-188">New schema rowset for tracking dependencies among the columns and references in a tabular model</span></span>  
  
-   [<span data-ttu-id="e44fc-189">DISCOVER_CSDL_METADATA 行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-189">DISCOVER_CSDL_METADATA Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-csdl-metadata-rowset)  
  
     <span data-ttu-id="e44fc-190">用于获取表格模型的 CSDL 表示形式的新架构行集。</span><span class="sxs-lookup"><span data-stu-id="e44fc-190">New schema rowset for obtaining the CSDL representation of a tabular model</span></span>  
  
-   [<span data-ttu-id="e44fc-191">DISCOVER_XEVENT_TRACE_DEFINITION 行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-191">DISCOVER_XEVENT_TRACE_DEFINITION Rowset</span></span>](../dev-guide/discover-xevent-trace-definition-rowset.md)  
  
     <span data-ttu-id="e44fc-192">用于监视 SQL Server 扩展事件的新架构行集。</span><span class="sxs-lookup"><span data-stu-id="e44fc-192">New schema rowset for monitoring SQL Server Extended Events.</span></span> <span data-ttu-id="e44fc-193">有关详细信息，请参阅[Use SQL Server Extended Events &#40;XEvents&#41; 来监视 Analysis Services](../instances/monitor-analysis-services-with-sql-server-extended-events.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-193">For more information, see [Use SQL Server Extended Events &#40;XEvents&#41; to Monitor Analysis Services](../instances/monitor-analysis-services-with-sql-server-extended-events.md).</span></span>  
  
-   [<span data-ttu-id="e44fc-194">DISCOVER_TRACES 行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-194">DISCOVER_TRACES Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-traces-rowset)  
  
     <span data-ttu-id="e44fc-195">可使用新 `Type` 列按类别筛选跟踪。</span><span class="sxs-lookup"><span data-stu-id="e44fc-195">New `Type` column lets you filter traces by category.</span></span> <span data-ttu-id="e44fc-196">有关详细信息，请参阅[为重播创建事件探查器跟踪 (Analysis Services)](../instances/create-profiler-traces-for-replay-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-196">For more information, see [Create Profiler Traces for Replay &#40;Analysis Services&#41;](../instances/create-profiler-traces-for-replay-analysis-services.md).</span></span>  
  
-   [<span data-ttu-id="e44fc-197">MDSCHEMA_HIERARCHIES 行集</span><span class="sxs-lookup"><span data-stu-id="e44fc-197">MDSCHEMA_HIERARCHIES Rowset</span></span>](https://docs.microsoft.com/bi-reference/schema-rowsets/ole-db-olap/mdschema-hierarchies-rowset)  
  
     <span data-ttu-id="e44fc-198">新 `STRUCTURE_TYPE` 枚举支持在表格模型中创建的用户定义的层次结构的标识。</span><span class="sxs-lookup"><span data-stu-id="e44fc-198">New `STRUCTURE_TYPE` enumeration supports identification of user-defined hierarchies created in tabular models.</span></span> <span data-ttu-id="e44fc-199">有关详细信息，请参阅[层次结构（SSAS 表格）](hierarchies-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="e44fc-199">For more information, see [Hierarchies &#40;SSAS Tabular&#41;](hierarchies-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="e44fc-200">此版本中不包含针对 OLE DB for Data Mining 架构行集的更新。</span><span class="sxs-lookup"><span data-stu-id="e44fc-200">There are no updates to the OLE DB for Data Mining schema rowsets in this release.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e44fc-201">您无法在已在 DirectQuery 模式下部署的数据库中使用 MDX 或 DMX 查询；因此，如果您需要对使用架构行集的 DirectQuery 模型执行查询，则您应使用 XMLA 而非关联的 DMV。</span><span class="sxs-lookup"><span data-stu-id="e44fc-201">You cannot use MDX or DMX queries in a database that has been deployed in DirectQuery mode; therefore, if you need to execute a query against a DirectQuery model using the schema rowsets, you should use XMLA, and not the associated DMV.</span></span> <span data-ttu-id="e44fc-202">对于将服务器的结果作为一个整体返回的 DMV（例如，SELECT \* from $system.DBSCHEMA_CATALOGS 或 DISCOVER_TRACES），您可以对在缓存模式下部署的数据库内容执行查询。</span><span class="sxs-lookup"><span data-stu-id="e44fc-202">For DMVs that return results for the server as a whole, such as SELECT \* from $system.DBSCHEMA_CATALOGS or DISCOVER_TRACES, you can execute the query in the content of a database that is deployed in a cached mode.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e44fc-203">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e44fc-203">See Also</span></span>  
 <span data-ttu-id="e44fc-204">[&#40;SSAS 连接到表格模型数据库&#41;](connect-to-a-tabular-model-database-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="e44fc-204">[Connect to a Tabular Model Database &#40;SSAS&#41;](connect-to-a-tabular-model-database-ssas.md) </span></span>  
 <span data-ttu-id="e44fc-205">[PowerPivot 数据访问](../power-pivot-sharepoint/power-pivot-data-access.md) </span><span class="sxs-lookup"><span data-stu-id="e44fc-205">[PowerPivot Data Access](../power-pivot-sharepoint/power-pivot-data-access.md) </span></span>  
 [<span data-ttu-id="e44fc-206">连接到 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="e44fc-206">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
