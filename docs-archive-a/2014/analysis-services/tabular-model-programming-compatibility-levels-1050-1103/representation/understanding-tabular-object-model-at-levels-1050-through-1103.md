---
title: 了解表格对象模型 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
ms.assetid: 6077b7e8-cb3e-4480-a5de-bb602cf9d69a
author: minewiskan
ms.author: owend
ms.openlocfilehash: ed120bedfd236dcb55780982f0f611368147f813
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87576987"
---
# <a name="understanding-the-tabular-object-model"></a><span data-ttu-id="492a9-102">了解表格对象模型</span><span class="sxs-lookup"><span data-stu-id="492a9-102">Understanding the Tabular Object Model</span></span>
  <span data-ttu-id="492a9-103">表格模型是表、关系、层次结构、透视、度量值和关键绩效的逻辑表示形式。</span><span class="sxs-lookup"><span data-stu-id="492a9-103">A tabular model is a logical representation of tables, relationships, hierarchies, perspectives, measures, and Key Performance.</span></span> <span data-ttu-id="492a9-104">本节介绍使用 AMO 的内部实现。</span><span class="sxs-lookup"><span data-stu-id="492a9-104">This section introduces the internal implementation using AMO.</span></span> <span data-ttu-id="492a9-105">如果以前未使用过 AMO，请参阅[使用分析管理对象 &#40;&#41;AMO 进行开发](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo)。</span><span class="sxs-lookup"><span data-stu-id="492a9-105">See [Developing with Analysis Management Objects &#40;AMO&#41;](https://docs.microsoft.com/bi-reference/amo/developing-with-analysis-management-objects-amo) if you haven't used AMO before.</span></span>  
  
 <span data-ttu-id="492a9-106">此处的方法是自上而下的，表格模型中的所有相关对象逻辑上映射到 AMO 对象，并说明所需的交互或工作流。</span><span class="sxs-lookup"><span data-stu-id="492a9-106">The approach here is top-down, all relevant objects in the tabular model are logically mapped to AMO objects, and the required interaction or workflow explained.</span></span> <span data-ttu-id="492a9-107">可从 Codeplex 获取使用 AMO 创建表格模型的源代码示例“AMO 到表格”。</span><span class="sxs-lookup"><span data-stu-id="492a9-107">A source code sample to create a tabular model using AMO,  AMO to Tabular, is available from Codeplex.</span></span> <span data-ttu-id="492a9-108">请注意，示例中的代码仅作为对此处所述逻辑概念的支持提供，不应用于生产环境中。</span><span class="sxs-lookup"><span data-stu-id="492a9-108">An important note about the code in the sample: it is provided only to support to the logical concepts explained here and should not be used in a production environment.</span></span> <span data-ttu-id="492a9-109">不提供对示例的支持或保修。</span><span class="sxs-lookup"><span data-stu-id="492a9-109">The sample is provided without support or warranty.</span></span>  
  
## <a name="database-representation"></a><span data-ttu-id="492a9-110">数据库表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-110">Database Representation</span></span>  
 <span data-ttu-id="492a9-111">数据库为表格模型提供容器对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-111">A database provides the container object for the tabular model.</span></span> <span data-ttu-id="492a9-112">表格模型中的所有对象包含在数据库中。</span><span class="sxs-lookup"><span data-stu-id="492a9-112">All objects in a tabular model are contained in the database.</span></span> <span data-ttu-id="492a9-113">就 AMO 对象而言，数据库表示形式与 <xref:Microsoft.AnalysisServices.Database> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-113">In terms of AMO objects, a database representation has a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.Database>, and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-114">请注意，这并不意味着 AMO 数据库对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-114">It is important to note that this doesn't mean that all contained objects in the AMO database object can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-115">有关如何创建和操作数据库表示形式的详细说明，请参阅[数据库表示形式&#40;表格&#41;](database-representation-tabular.md) 。</span><span class="sxs-lookup"><span data-stu-id="492a9-115">See [Database Representation&#40;Tabular&#41;](database-representation-tabular.md) for a detailed explanation on how to create and manipulate the database representation.</span></span>  
  
## <a name="connection-representation"></a><span data-ttu-id="492a9-116">连接表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-116">Connection Representation</span></span>  
 <span data-ttu-id="492a9-117">连接是指在要包含在表格模型解决方案中的数据与模型之间建立关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-117">A connection establishes the relationship between the data to be included in a tabular model solution and the model itself.</span></span> <span data-ttu-id="492a9-118">就 AMO 对象而言，连接与 <xref:Microsoft.AnalysisServices.DataSource> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-118">In terms of AMO objects, a connection has a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.DataSource>, and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-119">请注意，这并不意味着 AMO 数据源对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-119">It is important to note that this doesn't mean that all contained objects in the AMO datasource object can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-120">有关如何创建和操作数据源表示形式的详细说明，请参阅[连接表示 &#40;表格&#41;](connection-representation-tabular.md) 。</span><span class="sxs-lookup"><span data-stu-id="492a9-120">See [Connection Representation &#40;Tabular&#41;](connection-representation-tabular.md) for a detailed explanation on how to create and manipulate the data source representation.</span></span>  
  
## <a name="table-representation"></a><span data-ttu-id="492a9-121">表的表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-121">Table Representation</span></span>  
 <span data-ttu-id="492a9-122">表是包含数据库中的数据的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-122">Tables are database objects that contain the data in the database.</span></span> <span data-ttu-id="492a9-123">就 AMO 对象而言，表具有一对多映射关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-123">In terms of AMO objects, a table has a one-to-many mapping relationship.</span></span> <span data-ttu-id="492a9-124">通过使用以下 AMO 对象来表示表：<xref:Microsoft.AnalysisServices.DataSourceView>、<xref:Microsoft.AnalysisServices.Dimension>、<xref:Microsoft.AnalysisServices.Cube>、<xref:Microsoft.AnalysisServices.CubeDimension>、<xref:Microsoft.AnalysisServices.MeasureGroup> 和 <xref:Microsoft.AnalysisServices.Partition> 是主要的必需对象；但是，请注意，这并不意味着前面提到的 AMO 对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-124">A table is represented by the usage of the following AMO objects: <xref:Microsoft.AnalysisServices.DataSourceView>, <xref:Microsoft.AnalysisServices.Dimension>, <xref:Microsoft.AnalysisServices.Cube>, <xref:Microsoft.AnalysisServices.CubeDimension>, <xref:Microsoft.AnalysisServices.MeasureGroup> and <xref:Microsoft.AnalysisServices.Partition> are the main required objects; however, it is important to note that this doesn't mean that all contained objects in the previously mentioned AMO objects can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-125">有关如何创建和操作表表示形式的详细说明，请参阅 table [&#41;&#40;表格表示形式](tables-representation-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-125">See [Tables Representation &#40;Tabular&#41;](tables-representation-tabular.md) for a detailed explanation on how to create and manipulate the table representation.</span></span>  
  
### <a name="calculated-column-representation"></a><span data-ttu-id="492a9-126">计算列表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-126">Calculated Column Representation</span></span>  
 <span data-ttu-id="492a9-127">计算列是用于在表中生成列的计算表达式，其中，将为表中的每个行计算并存储一个新值。</span><span class="sxs-lookup"><span data-stu-id="492a9-127">Calculated columns are evaluated expressions that generate a column in a table, where a new value is calculated and stored for each row in the table.</span></span> <span data-ttu-id="492a9-128">就 AMO 对象而言，计算列具有一对多映射关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-128">In terms of AMO objects a calculated column has a one-to-many mapping relationship.</span></span> <span data-ttu-id="492a9-129">通过使用以下 AMO 对象来表示计算列：<xref:Microsoft.AnalysisServices.Dimension> 和 <xref:Microsoft.AnalysisServices.MeasureGroup> 是主要的必需对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-129">A calculated column is represented by the usage of the following AMO objects: <xref:Microsoft.AnalysisServices.Dimension> and <xref:Microsoft.AnalysisServices.MeasureGroup> are the main required objects.</span></span> <span data-ttu-id="492a9-130">请注意，这并不意味着前面提到的 AMO 对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-130">It is important to note that this doesn't mean that all contained objects in the previously mentioned AMO objects can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-131">有关如何创建和操作计算列表示形式的详细说明，请参阅[&#40;表格&#41;的计算列表示形式](tables-calculated-column-representation.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-131">See [Calculated Column Representation &#40;Tabular&#41;](tables-calculated-column-representation.md) for a detailed explanation on how to create and manipulate the calculated column representation.</span></span>  
  
### <a name="calculated-measure-representation"></a><span data-ttu-id="492a9-132">计算度量值表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-132">Calculated Measure Representation</span></span>  
 <span data-ttu-id="492a9-133">计算度量值是在部署模型后根据请求计算的存储表达式。</span><span class="sxs-lookup"><span data-stu-id="492a9-133">Calculated Measures are stored expressions that are evaluated upon request once the model is deployed.</span></span> <span data-ttu-id="492a9-134">就 AMO 对象而言，计算度量值具有一对多映射关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-134">In terms of AMO objects, a calculated measure has a one-to-many mapping relationship.</span></span> <span data-ttu-id="492a9-135">通过使用以下 AMO 对象来表示计算列：<xref:Microsoft.AnalysisServices.MdxScript.Commands%2A> 和 <xref:Microsoft.AnalysisServices.MdxScript.CalculationProperties%2A> 是主要的必需对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-135">A calculated column is represented by the usage of the following AMO objects: <xref:Microsoft.AnalysisServices.MdxScript.Commands%2A> and <xref:Microsoft.AnalysisServices.MdxScript.CalculationProperties%2A> are the main required objects.</span></span> <span data-ttu-id="492a9-136">请注意，这并不意味着前面提到的 AMO 对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-136">It is important to note that this doesn't mean that all contained objects in the previously mentioned AMO objects can be used when modeling.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="492a9-137"><xref:Microsoft.AnalysisServices.Measure> 对象与表格模型中的计算度量值无关，在表格模型中不支持这些对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-137">The <xref:Microsoft.AnalysisServices.Measure> objects have no relationship with the calculated measures in tabular models, and are not supported in tabular models.</span></span>  
  
 <span data-ttu-id="492a9-138">有关如何创建和操作计算度量值表示形式的详细说明，请参阅[&#40;表格&#41;的计算度量值表示形式](tables-calculated-measure-representation.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-138">See [Calculated Measure Representation &#40;Tabular&#41;](tables-calculated-measure-representation.md) for a detailed explanation on how to create and manipulate the calculated measure representation.</span></span>  
  
### <a name="hierarchy-representation"></a><span data-ttu-id="492a9-139">层次结构表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-139">Hierarchy Representation</span></span>  
 <span data-ttu-id="492a9-140">层次结构是一种机制，它为最终用户提供了更丰富的浅化和深化体验。</span><span class="sxs-lookup"><span data-stu-id="492a9-140">Hierarchies are a mechanism to provide a richer drill-up and drill-down experience to the end user.</span></span> <span data-ttu-id="492a9-141">就 AMO 对象而言，层次结构表示形式与 <xref:Microsoft.AnalysisServices.Hierarchy> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-141">In terms of AMO objects, a hierarchy representation has a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.Hierarchy>, and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-142">请注意，这并不意味着 AMO 数据库对象中的所有包含对象可在执行表格建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-142">It is important to note that this doesn't mean that all contained objects in the AMO database object can be used when doing tabular modeling.</span></span>  
  
 <span data-ttu-id="492a9-143">有关如何创建和操作层次结构表示形式的详细说明，请参阅[&#40;表格&#41;的层次结构表示形式](tables-hierarchy-representation.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-143">See [Hierarchy Representation &#40;Tabular&#41;](tables-hierarchy-representation.md) for a detailed explanation on how to create and manipulate the hierarchy representation.</span></span>  
  
### <a name="key-performance-indicator--kpi--representation"></a><span data-ttu-id="492a9-144">关键绩效指标-KPI 表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-144">Key Performance Indicator -KPI- Representation</span></span>  
 <span data-ttu-id="492a9-145">KPI 用于根据目标值度量基础度量值定义的值的性能。</span><span class="sxs-lookup"><span data-stu-id="492a9-145">A KPI is used to gauge performance of a value, defined by a Base measure, against a Target value.</span></span> <span data-ttu-id="492a9-146">就 AMO 对象而言，KPI 表示形式具有一对多映射关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-146">In terms of AMO objects, a KPI representation has a one-to-many mapping relationship.</span></span> <span data-ttu-id="492a9-147">通过使用以下 AMO 对象来表示 KPI：<xref:Microsoft.AnalysisServices.MdxScript.Commands%2A> 和 <xref:Microsoft.AnalysisServices.MdxScript.CalculationProperties%2A> 是主要的必需对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-147">A KPI is represented by the usage of the following AMO objects: <xref:Microsoft.AnalysisServices.MdxScript.Commands%2A>and <xref:Microsoft.AnalysisServices.MdxScript.CalculationProperties%2A> are the main required objects.</span></span>  <span data-ttu-id="492a9-148">请注意，这并不意味着前面提到的 AMO 对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-148">It is important to note that this doesn't mean that all contained objects in the previously mentioned AMO objects can be used when modeling.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="492a9-149">此外，很重要的一点区别是：<xref:Microsoft.AnalysisServices.Kpi> 对象与表格模型中的 KPI 无关。</span><span class="sxs-lookup"><span data-stu-id="492a9-149">Also, important distinction, the <xref:Microsoft.AnalysisServices.Kpi> objects have no relationship with the KPIs in tabular models.</span></span> <span data-ttu-id="492a9-150">而且，在表格模型中也不支持这些对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-150">And, they are not supported in tabular models.</span></span>  
  
 <span data-ttu-id="492a9-151">有关如何创建和操作 KPI 表示形式的详细说明，请参阅[&#40;表格&#41;的关键绩效指标表示形式](tables-key-performance-indicator-representation.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-151">See [Key Performance Indicator Representation &#40;Tabular&#41;](tables-key-performance-indicator-representation.md) for a detailed explanation on how to create and manipulate the KPI representation.</span></span>  
  
### <a name="partition-representation"></a><span data-ttu-id="492a9-152">分区表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-152">Partition Representation</span></span>  
 <span data-ttu-id="492a9-153">为便于操作，可以将一个表划分为不同的行子集，而将这些行子集组合在一起可形成表。</span><span class="sxs-lookup"><span data-stu-id="492a9-153">For operational purposes, a table can be divided in different subsets of rows that when combined together form the table.</span></span> <span data-ttu-id="492a9-154">其中的每个子集都是表的一个分区。</span><span class="sxs-lookup"><span data-stu-id="492a9-154">Each of those subsets is a partition of the table.</span></span> <span data-ttu-id="492a9-155">就 AMO 对象而言，分区表示形式与 <xref:Microsoft.AnalysisServices.Partition> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-155">In terms of AMO objects, a partition representation has a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.Partition> and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-156">请注意，这并不意味着 AMO 数据库对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-156">It is important to note that this doesn't mean that all contained objects in the AMO database object can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-157">有关如何创建和操作分区表示形式的详细说明，请参阅[&#40;表格&#41;的分区表示形式](tables-partition-representation.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-157">See [Partition Representation &#40;Tabular&#41;](tables-partition-representation.md) for a detailed explanation on how to create and manipulate the partition representation.</span></span>  
  
## <a name="relationship-representation"></a><span data-ttu-id="492a9-158">关系表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-158">Relationship Representation</span></span>  
 <span data-ttu-id="492a9-159">关系是两个数据表之间的联系。</span><span class="sxs-lookup"><span data-stu-id="492a9-159">A relationship is a connection between two tables of data.</span></span> <span data-ttu-id="492a9-160">该关系确立两个表中的数据应该如何相关。</span><span class="sxs-lookup"><span data-stu-id="492a9-160">The relationship establishes how the data in the two tables should be correlated.</span></span>  
  
 <span data-ttu-id="492a9-161">在表格模型中，两个表之间可以定义多重关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-161">In tabular models, multiple relationships can be defined between two tables.</span></span> <span data-ttu-id="492a9-162">定义两个表之间的多个关系时，只有一个关系可被定义为默认活动关系。</span><span class="sxs-lookup"><span data-stu-id="492a9-162">When multiple relationships between two tables are defined, only one can be defined as the default Active relationship.</span></span> <span data-ttu-id="492a9-163">所有其他关系处于不活动状态。</span><span class="sxs-lookup"><span data-stu-id="492a9-163">All other relationships are Inactive.</span></span>  
  
 <span data-ttu-id="492a9-164">就 AMO 对象而言，所有不活动关系与 <xref:Microsoft.AnalysisServices.Relationship> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-164">In terms of AMO objects, all inactive relationships have a representation of a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.Relationship>, and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-165">对于活动关系，存在其他要求，且需要到 <xref:Microsoft.AnalysisServices.ReferenceMeasureGroupDimension> 的映射。</span><span class="sxs-lookup"><span data-stu-id="492a9-165">For the active relationship, other requirements exist and a mapping to the <xref:Microsoft.AnalysisServices.ReferenceMeasureGroupDimension> is also required.</span></span> <span data-ttu-id="492a9-166">请注意，这并不意味着 AMO 关系或 referenceMeasureGroupDimension 对象中的所有包含对象可在建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-166">It is important to note that this doesn't mean that all contained objects in the AMO relationship or referenceMeasureGroupDimension object can be used when modeling.</span></span>  
  
 <span data-ttu-id="492a9-167">有关如何创建和操作关系表示形式的详细说明，请参阅[&#40;表格&#41;的关系表示形式](relationship-representation-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="492a9-167">See [Relationship Representation &#40;Tabular&#41;](relationship-representation-tabular.md) for a detailed explanation on how to create and manipulate the relationship representation.</span></span>  
  
## <a name="perspective-representation"></a><span data-ttu-id="492a9-168">透视表示形式</span><span class="sxs-lookup"><span data-stu-id="492a9-168">Perspective Representation</span></span>  
 <span data-ttu-id="492a9-169">透视是用于简化或聚焦模式的机制。</span><span class="sxs-lookup"><span data-stu-id="492a9-169">A perspective is a mechanism to simplify or focus the mode.</span></span> <span data-ttu-id="492a9-170">就 AMO 对象而言，关系表示形式与 <xref:Microsoft.AnalysisServices.Perspective> 之间存在一对一映射关系，并且不需要任何其他主要 AMO 对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-170">In terms of AMO objects, a relationship representation has a one-to-one mapping relationship with <xref:Microsoft.AnalysisServices.Perspective> and no other main AMO objects are required.</span></span> <span data-ttu-id="492a9-171">请注意，这并不意味着 AMO 透视对象中的所有包含对象可在执行表格建模时使用。</span><span class="sxs-lookup"><span data-stu-id="492a9-171">It is important to note that this doesn't mean that all contained objects in the AMO perspective ob0ject can be used when doing tabular modeling.</span></span>  
  
 <span data-ttu-id="492a9-172">有关如何创建和操作透视表示形式的详细说明，请参阅[透视表示形式 &#40;表格&#41;](perspective-representation-tabular.md) 。</span><span class="sxs-lookup"><span data-stu-id="492a9-172">See [Perspective Representation &#40;Tabular&#41;](perspective-representation-tabular.md) for a detailed explanation on how to create and manipulate the perspective representation.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="492a9-173">透视并不是一种安全机制；用户仍可通过其他接口访问透视外部的对象。</span><span class="sxs-lookup"><span data-stu-id="492a9-173">Perspectives are not a security mechanism; objects outside the perspective can still be accessed by the user through other interfaces.</span></span>  
  
  
