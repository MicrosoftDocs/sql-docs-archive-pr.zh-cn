---
title: " (SSAS Analysis Services 中合并分区-多维) |Microsoft Docs"
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- partitions [Analysis Services], merging
- merging partitions [Analysis Services]
ms.assetid: b3857b9b-de43-4911-989d-d14da0196f89
author: minewiskan
ms.author: owend
ms.openlocfilehash: 42820a202c4da58e21dfd55756b7bb03522ea879
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693135"
---
# <a name="merge-partitions-in-analysis-services-ssas---multidimensional"></a><span data-ttu-id="93aee-102">在 Analysis Services 中合并分区（SSAS - 多维）</span><span class="sxs-lookup"><span data-stu-id="93aee-102">Merge Partitions in Analysis Services (SSAS - Multidimensional)</span></span>
  <span data-ttu-id="93aee-103">您可以将现有 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据库中的分区进行合并，以整合来自相同度量值组的多个分区的事实数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-103">You can merge partitions in an existing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database to consolidate fact data from multiple partitions of the same measure group.</span></span>  
  
 [<span data-ttu-id="93aee-104">常见方案</span><span class="sxs-lookup"><span data-stu-id="93aee-104">Common scenarios</span></span>](#bkmk_Scenario)  
  
 [<span data-ttu-id="93aee-105">要求</span><span class="sxs-lookup"><span data-stu-id="93aee-105">Requirements</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="93aee-106">在合并分区后更新分区源</span><span class="sxs-lookup"><span data-stu-id="93aee-106">Update the Partition Source after merging partitions</span></span>](#bkmk_Where)  
  
 [<span data-ttu-id="93aee-107">按事实数据表或命名查询分段的分区的特殊注意事项</span><span class="sxs-lookup"><span data-stu-id="93aee-107">Special considerations for partitions segmented by fact table or named query</span></span>](#bkmk_fact)  
  
 [<span data-ttu-id="93aee-108">如何使用 SSMS 合并分区</span><span class="sxs-lookup"><span data-stu-id="93aee-108">How to merge partitions using SSMS</span></span>](#bkmk_partitionSSMS)  
  
 [<span data-ttu-id="93aee-109">如何使用 XMLA 合并分区</span><span class="sxs-lookup"><span data-stu-id="93aee-109">How to merge partitions using XMLA</span></span>](#bkmk_partitionsXMLA)  
  
##  <a name="common-scenarios"></a><a name="bkmk_Scenario"></a><span data-ttu-id="93aee-110">常见方案</span><span class="sxs-lookup"><span data-stu-id="93aee-110">Common scenarios</span></span>  
 <span data-ttu-id="93aee-111">分区应用的唯一最常见配置涉及到跨时间维度分离数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-111">The single most common configuration for partition use involves the separation of data across the dimension of time.</span></span> <span data-ttu-id="93aee-112">与每个分区关联的时间的粒度因特定于项目的业务需求而有所不同。</span><span class="sxs-lookup"><span data-stu-id="93aee-112">The granularity of time associated with each partition varies depending on the business requirements specific to the project.</span></span> <span data-ttu-id="93aee-113">例如，可能用年数进行分段，而最近一年用月数除，并为活动月单独加上一个分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-113">For example, segmentation might be by years, with the most recent year divided by months, plus a separate partition for the active month.</span></span> <span data-ttu-id="93aee-114">活动月分区定期取用新数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-114">The active month partition regularly takes on new data.</span></span>  
  
 <span data-ttu-id="93aee-115">活动月份完成后，该分区被重新合并到截至到当前日期的分区中的月，该过程继续进行。</span><span class="sxs-lookup"><span data-stu-id="93aee-115">When the active month is completed, that partition is merged back into the months in the year-to-date partition and the process continues.</span></span> <span data-ttu-id="93aee-116">到年末时，就会形成一个完整的新的年分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-116">At the end of the year, a whole new year partition has been formed.</span></span>  
  
 <span data-ttu-id="93aee-117">正如这种情况所示，合并分区可能成为定期执行的一项例行任务，这可以为整合与组织历史数据提供一种渐进的方法。</span><span class="sxs-lookup"><span data-stu-id="93aee-117">As this scenario demonstrates, merging partitions can become a routine task performed on a regular basis, providing a progressive approach for consolidating and organizing historical data.</span></span>  
  
##  <a name="requirements"></a><a name="bkmk_prereq"></a> <span data-ttu-id="93aee-118">要求</span><span class="sxs-lookup"><span data-stu-id="93aee-118">Requirements</span></span>  
 <span data-ttu-id="93aee-119">只有符合下列所有条件的分区才能合并：</span><span class="sxs-lookup"><span data-stu-id="93aee-119">Partitions can be merged only if they meet all of the following criteria:</span></span>  
  
-   <span data-ttu-id="93aee-120">分区具有相同的度量值组。</span><span class="sxs-lookup"><span data-stu-id="93aee-120">They have the same measure group.</span></span>  
  
-   <span data-ttu-id="93aee-121">分区具有相同的结构。</span><span class="sxs-lookup"><span data-stu-id="93aee-121">They have the same structure.</span></span>  
  
-   <span data-ttu-id="93aee-122">分区必须处于已处理状态。</span><span class="sxs-lookup"><span data-stu-id="93aee-122">They must be in a processed state.</span></span>  
  
-   <span data-ttu-id="93aee-123">分区具有相同的存储模式。</span><span class="sxs-lookup"><span data-stu-id="93aee-123">They have the same storage modes.</span></span>  
  
-   <span data-ttu-id="93aee-124">分区包含相同的聚合设计。</span><span class="sxs-lookup"><span data-stu-id="93aee-124">They contain identical aggregation designs.</span></span>  
  
-   <span data-ttu-id="93aee-125">分区共享相同的字符串存储兼容级别（仅适用于已分区的非重复计数度量值组）。</span><span class="sxs-lookup"><span data-stu-id="93aee-125">They share the same string store compatibility level (applies to partitioned distinct count measure groups only).</span></span>  
  
 <span data-ttu-id="93aee-126">如果目标分区为空（即它具有聚合设计，但是没有聚合），则合并时将删除源分区的聚合。</span><span class="sxs-lookup"><span data-stu-id="93aee-126">If the target partition is empty (that is, it has an aggregation design but no aggregations), merge will drop the aggregations for the source partitions.</span></span> <span data-ttu-id="93aee-127">您必须对分区运行“处理索引”、“处理全部”或“处理默认值”才能生成聚合。</span><span class="sxs-lookup"><span data-stu-id="93aee-127">You must run Process Index, Process Full, or Process Default on the partition to build the aggregations.</span></span>  
  
 <span data-ttu-id="93aee-128">远程分区只能与使用同一个 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]远程实例定义的其他远程分区进行合并。</span><span class="sxs-lookup"><span data-stu-id="93aee-128">Remote partitions can be merged only with other remote partitions that are defined with the same remote instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="93aee-129">如果您在结合使用本地和远程分区，则也可以创建包括组合数据的新分区，删除不再使用的分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-129">If you are using a combination of local and remote partitions, an alternative approach is to create new partitions that include the combined data, deleting the partitions you no longer use.</span></span>  
  
 <span data-ttu-id="93aee-130">若要创建一个准备在将来进行合并的分区，在分区向导中创建该分区时，您可以选择从另一个多维数据集分区复制聚合设计。</span><span class="sxs-lookup"><span data-stu-id="93aee-130">To create a partition that is a candidate for future merging, when you create the partition in the Partition Wizard, you can choose to copy the aggregation design from another of the cube's partitions.</span></span> <span data-ttu-id="93aee-131">这将确保这些分区具有相同的聚合设计。</span><span class="sxs-lookup"><span data-stu-id="93aee-131">This ensures that these partitions have the same aggregation design.</span></span> <span data-ttu-id="93aee-132">当这些分区进行合并时，源分区的聚合和目标分区的聚合将组合到一起。</span><span class="sxs-lookup"><span data-stu-id="93aee-132">When they are merged, the aggregations of the source partition are combined with the aggregations in the target partition.</span></span>  
  
##  <a name="update-the-partition-source-after-merging-partitions"></a><a name="bkmk_Where"></a><span data-ttu-id="93aee-133">合并分区后更新分区源</span><span class="sxs-lookup"><span data-stu-id="93aee-133">Update the Partition Source after merging partitions</span></span>  
 <span data-ttu-id="93aee-134">分区通过查询（如用于处理数据的 SQL 查询 WHERE 子句）或通过表或为分区提供数据的命名查询进行分段。</span><span class="sxs-lookup"><span data-stu-id="93aee-134">Partitions are segmented by query, such as the WHERE clause of a SQL query used to process the data, or by a table or named query that provides data to the partition.</span></span> <span data-ttu-id="93aee-135">分区的 `Source` 属性指示分区是绑定到查询还是表。</span><span class="sxs-lookup"><span data-stu-id="93aee-135">The `Source` property on the partition indicates whether the partition is bound to a query or a table.</span></span>  
  
 <span data-ttu-id="93aee-136">当您合并分区时，将整合分区的内容，但是不会更新 `Source` 属性以反映分区的范围变大。</span><span class="sxs-lookup"><span data-stu-id="93aee-136">When you merge partitions, the contents of the partitions are consolidated, but the `Source` property is not updated to reflect the additional scope of the partition.</span></span> <span data-ttu-id="93aee-137">这就意味着，如果您以后重新处理一个保留初始 `Source` 的分区，则您将从该分区获得不正确的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-137">This means if you subsequently reprocess a partition that retains its original `Source`, you will get incorrect data from that partition.</span></span> <span data-ttu-id="93aee-138">该分区将错误地在父项级别聚合数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-138">The partition will erroneously aggregate data at the parent level.</span></span> <span data-ttu-id="93aee-139">下面的示例对这种行为进行了演示。</span><span class="sxs-lookup"><span data-stu-id="93aee-139">The following example illustrates this behavior.</span></span>  
  
 <span data-ttu-id="93aee-140">**问题**</span><span class="sxs-lookup"><span data-stu-id="93aee-140">**The Problem**</span></span>  
  
 <span data-ttu-id="93aee-141">假设您有一个多维数据集包含有关三种软饮料产品的信息。</span><span class="sxs-lookup"><span data-stu-id="93aee-141">Suppose you have a cube containing information about three soft drink products.</span></span> <span data-ttu-id="93aee-142">该多维数据集有三个使用相同事实数据表的分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-142">It has three partitions that use the same fact table.</span></span> <span data-ttu-id="93aee-143">这些分区按产品进行分段。</span><span class="sxs-lookup"><span data-stu-id="93aee-143">These partitions are segmented by product.</span></span> <span data-ttu-id="93aee-144">第 1 分区包含有关 [ColaFull] 的数据，第 2 分区包含有关 [ColaDecaf] 的数据，第 3 分区包含有关 [ColaDiet] 的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-144">Partition 1 contains data about [ColaFull], Partition 2 contains data about [ColaDecaf], and Partition 3 contains data about [ColaDiet].</span></span> <span data-ttu-id="93aee-145">如果第 3 分区合并到第 2 分区中，则所得分区（第 2 分区）中的数据将是正确的，并且多维数据集的数据也将是准确的。</span><span class="sxs-lookup"><span data-stu-id="93aee-145">If Partition 3 is merged into Partition 2, the data in the resulting partition (Partition 2) is correct and the cube data is accurate.</span></span> <span data-ttu-id="93aee-146">但是，当处理第 2 分区时，其内容可能由处于产品级别的成员的父级所决定。</span><span class="sxs-lookup"><span data-stu-id="93aee-146">However, when Partition 2 is processed, its content may be determined by the parent of the members at the product level.</span></span> <span data-ttu-id="93aee-147">此父级 [SoftDrinks] 还包含第 1 分区中的产品 [ColaFull]。</span><span class="sxs-lookup"><span data-stu-id="93aee-147">This parent, [SoftDrinks], also includes [ColaFull], the product in Partition 1.</span></span> <span data-ttu-id="93aee-148">在处理第 2 分区时，将会加载所有软饮料的数据，包括 [ColaFull]。</span><span class="sxs-lookup"><span data-stu-id="93aee-148">Processing Partition 2 loads the partition with data for all soft drinks, including [ColaFull].</span></span> <span data-ttu-id="93aee-149">于是多维数据集就包含了有关 [ColaFull] 的重复数据，并返回给最终用户不正确的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-149">The cube then contains duplicate data for [ColaFull] and returns incorrect data to end users.</span></span>  
  
 <span data-ttu-id="93aee-150">**解决方案**</span><span class="sxs-lookup"><span data-stu-id="93aee-150">**The Solution**</span></span>  
  
 <span data-ttu-id="93aee-151">解决方案是通过调整 WHERE 子句或命名查询，或手动合并来自底层事实数据表的数据来更新 `Source` 属性，以确保以后的处理能考虑到分区的范围扩大而正确进行。</span><span class="sxs-lookup"><span data-stu-id="93aee-151">The solution is to update the `Source` property, adjusting either the WHERE clause or named query, or manually merging data from the underlying fact tables, to ensure that subsequent processing is accurate given the expanded scope of the partition.</span></span>  
  
 <span data-ttu-id="93aee-152">在此示例中，将第 3 分区合并到第 2 分区后，可以在所得的第 2 分区中提供一个筛选（例如 ("Product" = 'ColaDecaf' OR "Product" = 'ColaDiet')），用以指定：只从事实数据表中提取有关 [ColaDecaf] 和 [ColaDiet] 的数据，并排除有关 [ColaFull] 的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-152">In this example, after merging Partition 3 into Partition 2, you can provide a filter such as ("Product" = 'ColaDecaf' OR "Product" = 'ColaDiet') in the resulting Partition 2 to specify that only data about [ColaDecaf] and [ColaDiet] be extracted from the fact table, and the data pertaining to [ColaFull] be excluded.</span></span> <span data-ttu-id="93aee-153">作为替代方法，也可以在创建第 2 分区和第 3 分区时为它们指定筛选，而在合并进程中这些筛选将组合。</span><span class="sxs-lookup"><span data-stu-id="93aee-153">Alternatively, you can specify filters for Partition 2 and Partition 3 when they are created, and these filters will be combined during the merger process.</span></span> <span data-ttu-id="93aee-154">不论哪种情况，处理完分区之后，多维数据集都将不包含重复数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-154">In either case, after the partition is processed the cube does not contain duplicate data.</span></span>  
  
 <span data-ttu-id="93aee-155">**结论**</span><span class="sxs-lookup"><span data-stu-id="93aee-155">**The Conclusion**</span></span>  
  
 <span data-ttu-id="93aee-156">合并分区后，请始终检查 `Source` 以验证筛选器适合于合并后的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-156">After you merge partitions, always check the `Source` to verify the filter is correct for the merged data.</span></span> <span data-ttu-id="93aee-157">如果您从一个包含第一、二、三季度的历史数据的分区开始，现在要合并第四季度的数据，则必须调整筛选器，以包含第四季度数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-157">If you started with a partition that included historical data for Q1, Q2, and Q3, and you now merge Q4, you must adjust the filter to include Q4.</span></span> <span data-ttu-id="93aee-158">否则，以后处理该分区时将导致错误的结果。</span><span class="sxs-lookup"><span data-stu-id="93aee-158">Otherwise, subsequent processing of the partition will yield erroneous results.</span></span> <span data-ttu-id="93aee-159">这对第四季度将是不正确的。</span><span class="sxs-lookup"><span data-stu-id="93aee-159">It will not be correct for Q4.</span></span>  
  
##  <a name="special-considerations-for-partitions-segmented-by-fact-table-or-named-query"></a><a name="bkmk_fact"></a><span data-ttu-id="93aee-160">按事实数据表或命名查询分段的分区的特殊注意事项</span><span class="sxs-lookup"><span data-stu-id="93aee-160">Special considerations for partitions segmented by fact table or named query</span></span>  
 <span data-ttu-id="93aee-161">除了查询之外，分区也可以按表或命名查询分段。</span><span class="sxs-lookup"><span data-stu-id="93aee-161">In addition to queries, partitions can also be segmented by table or named query.</span></span> <span data-ttu-id="93aee-162">如果源分区和目标分区使用同一数据源或数据源视图中的同一事实数据表，则在合并分区后 `Source` 属性有效。</span><span class="sxs-lookup"><span data-stu-id="93aee-162">If the source partition and target partition use the same fact table in a data source or data source view, the `Source` property is valid after merging partitions.</span></span> <span data-ttu-id="93aee-163">它指定适合于所得分区的事实数据表数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-163">It specifies the fact table data that is appropriate to the resulting partition.</span></span> <span data-ttu-id="93aee-164">因为所得分区所需的事实数据就在事实数据表中，所以无需对 `Source` 属性进行任何修改。</span><span class="sxs-lookup"><span data-stu-id="93aee-164">Because the facts that are required for the resulting partition are present in the fact table, no modification to the `Source` property is necessary.</span></span>  
  
 <span data-ttu-id="93aee-165">对于使用来自多个事实数据表或命名查询的数据的分区，需要执行其他工作。</span><span class="sxs-lookup"><span data-stu-id="93aee-165">Partitions using data from multiple fact tables or named queries require additional work.</span></span> <span data-ttu-id="93aee-166">您必须手动将来自源分区的事实数据表的事实数据合并到目标分区的事实数据表中。</span><span class="sxs-lookup"><span data-stu-id="93aee-166">You must manually merge the facts from the fact table of the source partition into the fact table of the target partition.</span></span>  
  
 <span data-ttu-id="93aee-167">或者，您还可以将合并后分区的源指定为一个返回两个不同的事实数据表的内容的命名查询。</span><span class="sxs-lookup"><span data-stu-id="93aee-167">Alternatively, you can change the source for the merged partition to a named query that returns the contents of two separate fact tables.</span></span> <span data-ttu-id="93aee-168">如果不执行此手动步骤，事实数据表所包含的信息就不会完整。</span><span class="sxs-lookup"><span data-stu-id="93aee-168">If this manual step is not performed, the fact table does not contain complete information.</span></span>  
  
 <span data-ttu-id="93aee-169">同样，从命名查询获取分段数据的分区也需要更新。</span><span class="sxs-lookup"><span data-stu-id="93aee-169">For the same reason, partitions obtaining segmented data from named queries also require updating.</span></span> <span data-ttu-id="93aee-170">合并后的分区现在必须具有返回之前从不同命名查询获得的合并结果集的命名查询。</span><span class="sxs-lookup"><span data-stu-id="93aee-170">The combined partition must now have a named query that returns the combined result set that was previously obtained from the separate named queries.</span></span>  
  
## <a name="partition-storage-considerations-molap"></a><span data-ttu-id="93aee-171">分区存储注意事项：MOLAP</span><span class="sxs-lookup"><span data-stu-id="93aee-171">Partition storage considerations: MOLAP</span></span>  
 <span data-ttu-id="93aee-172">合并 MOLAP 分区时，存储在分区的多维结构中的事实数据也将合并。</span><span class="sxs-lookup"><span data-stu-id="93aee-172">When MOLAP partitions are merged, the facts stored in the multidimensional structures of the partitions are also merged.</span></span> <span data-ttu-id="93aee-173">这将生成一个内部完整而一致的分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-173">This results in an internally complete and consistent partition.</span></span> <span data-ttu-id="93aee-174">然而，存储在 MOLAP 分区中的事实数据是事实数据表中事实数据的副本。</span><span class="sxs-lookup"><span data-stu-id="93aee-174">However, the facts stored in MOLAP partitions are copies of facts in the fact table.</span></span> <span data-ttu-id="93aee-175">在随后处理分区时，系统将删除多维结构中的事实数据（仅适用于完全和刷新），而且将从由分区的数据源和筛选器所指定的事实数据表复制数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-175">When the partition is subsequently processed, the facts in the multidimensional structure are deleted (only for full and refresh) and data is copied from the fact table as specified by the data source and filter for the partition.</span></span> <span data-ttu-id="93aee-176">如果源分区所使用的事实数据表与目标分区所使用的不同，则必须手动合并源分区的事实数据表和目标分区的事实数据表，以确保对所得分区进行处理时能有一套完整的数据集。</span><span class="sxs-lookup"><span data-stu-id="93aee-176">If the source partition uses a different fact table from the target partition, the fact table of the source partition must be manually merged with the fact table of the target partition to ensure that a complete set of data is available when the resulting partition is processed.</span></span> <span data-ttu-id="93aee-177">如果两个分区基于不同的命名查询，则同样需要执行这一操作。</span><span class="sxs-lookup"><span data-stu-id="93aee-177">This applies as well if the two partitions were based on different named queries.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="93aee-178">在经过处理之前，带有不完整事实数据表的已合并 MOLAP 分区包含事实数据表数据的一个内部合并副本，而且此分区可以正常运行。</span><span class="sxs-lookup"><span data-stu-id="93aee-178">A merged MOLAP partition with an incomplete fact table contains an internally merged copy of fact table data and operates correctly until it is processed.</span></span>  
  
## <a name="partition-storage-considerations-holap-and-rolap-partitions"></a><span data-ttu-id="93aee-179">分区存储注意事项：HOLAP 和 ROLAP 分区</span><span class="sxs-lookup"><span data-stu-id="93aee-179">Partition storage considerations: HOLAP and ROLAP Partitions</span></span>  
 <span data-ttu-id="93aee-180">合并具有不同事实数据表的 HOLAP 或 ROLAP 分区时，不会自动合并事实数据表。</span><span class="sxs-lookup"><span data-stu-id="93aee-180">When HOLAP or ROLAP partitions that have different fact tables are merged, the fact tables are not automatically merged.</span></span> <span data-ttu-id="93aee-181">除非手动合并事实数据表，否则只有与目标分区关联的事实数据表才可用于所得分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-181">Unless the fact tables are manually merged, only the fact table associated with the target partition is available to the resulting partition.</span></span> <span data-ttu-id="93aee-182">与源分区关联的事实数据无法用于在所得分区中深化数据，并且处理分区时聚合不会从不可用的表中汇总数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-182">Facts associated with the source partition are not available for drilldown in the resulting partition, and when the partition is processed, aggregations do not summarize data from the unavailable table.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="93aee-183">带有不完整事实数据表的已合并 HOLAP 或 ROLAP 分区包含精确的聚合，但包含的事实数据不完整。</span><span class="sxs-lookup"><span data-stu-id="93aee-183">A merged HOLAP or ROLAP partition with an incomplete fact table contains accurate aggregations, but incomplete facts.</span></span> <span data-ttu-id="93aee-184">引用缺少的事实数据的查询将返回错误数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-184">Queries that refer to missing facts return incorrect data.</span></span> <span data-ttu-id="93aee-185">处理该分区时，只通过可用的事实数据计算聚合。</span><span class="sxs-lookup"><span data-stu-id="93aee-185">When the partition is processed, aggregations are computed only from available facts.</span></span>  
  
 <span data-ttu-id="93aee-186">除非用户试图深化到不可用的表中的事实数据，或执行一个要求从不可用的表中得到事实数据的查询，否则您可能不会注意到缺少某些表，不会注意到这些表还不可用。</span><span class="sxs-lookup"><span data-stu-id="93aee-186">The absence of unavailable facts might not be noticed unless a user attempts to drill down to a fact in the unavailable table or executes a query that requires a fact from the unavailable table.</span></span> <span data-ttu-id="93aee-187">因为聚合在合并进程中将组合，所以其结果只基于聚合的查询会返回准确数据，而其他查询则可能返回不准确的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-187">Because aggregations are combined during the merge process, queries whose results are based only on aggregations return accurate data, whereas other queries may return inaccurate data.</span></span> <span data-ttu-id="93aee-188">即使在所得分区的处理完成后，您可能也不会注意到不可用的事实数据表中缺少的数据（尤其是这些数据只代表组合数据的一小部分时）。</span><span class="sxs-lookup"><span data-stu-id="93aee-188">Even after the resulting partition is processed, the missing data from the unavailable fact table may not be noticed, especially if it represents only a small portion of the combined data.</span></span>  
  
 <span data-ttu-id="93aee-189">事实数据表的合并可在分区合并之前或之后进行。</span><span class="sxs-lookup"><span data-stu-id="93aee-189">Fact tables can be merged before or after merging the partitions.</span></span> <span data-ttu-id="93aee-190">但是，在这两项操作都完成之前，聚合不能准确地表示基础事实数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-190">However, the aggregations will not accurately represent the underlying facts until both operations have been completed.</span></span> <span data-ttu-id="93aee-191">如果要对访问不同事实数据表的 HOLAP 或 ROLAP 分区进行合并，建议您在用户未连接到包含这些分区的多维数据集时进行。</span><span class="sxs-lookup"><span data-stu-id="93aee-191">It is recommended that you merge HOLAP or ROLAP partitions that access different fact tables when users are not connected to the cube that contains these partitions.</span></span>  
  
##  <a name="how-to-merge-partitions-using-ssms"></a><a name="bkmk_partitionSSMS"></a><span data-ttu-id="93aee-192">如何使用 SSMS 合并分区</span><span class="sxs-lookup"><span data-stu-id="93aee-192">How to merge partitions using SSMS</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="93aee-193">合并分区之前，首先复制数据筛选信息（通常是基于 SQL 查询进行筛选的 WHERE 子句）。</span><span class="sxs-lookup"><span data-stu-id="93aee-193">Before merging partitions, first copy the data filter information (often, the WHERE clause for filters based on SQL queries).</span></span> <span data-ttu-id="93aee-194">以后，合并完成后，您应该更新包含累积事实数据的分区的“分区源”属性。</span><span class="sxs-lookup"><span data-stu-id="93aee-194">Later, after the merge is completed, you should update the Partition Source property of the partition containing the accumulated fact data.</span></span>  
  
1.  <span data-ttu-id="93aee-195">在对象资源管理器中，展开包含要合并分区的多维数据集的“度量值组”\*\*\*\* 节点，展开“分区”\*\*\*\*，右键单击要被合并或要合并到的分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-195">In Object Explorer, expand the **Measure Groups** node of the cube containing the partitions that you want to merge, expand **Partitions**, right-click the partition that is the target or destination of the merge operation.</span></span> <span data-ttu-id="93aee-196">例如，如果您要将每个季度的事实数据移到存储年度事实数据的分区，请选择包含年度事实数据的分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-196">For example, if you are moving quarterly fact data to a partition that stores annual fact data, select the partition that contains the annual fact data.</span></span>  
  
2.  <span data-ttu-id="93aee-197">单击 "**合并分区**" 打开 "**合并 \<partition name> 分区**" 对话框。</span><span class="sxs-lookup"><span data-stu-id="93aee-197">Click **Merge Partitions** to open the **Merge Partition \<partition name>** dialog box.</span></span>  
  
3.  <span data-ttu-id="93aee-198">在 **“源分区”** 下，选中要与目标分区合并的每个源分区旁边的复选框，然后单击 **“确定”**。</span><span class="sxs-lookup"><span data-stu-id="93aee-198">Under **Source Partitions**, select the check box next to each source partition that you want to merge with the target partition, and click **OK**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="93aee-199">源分区合并到目标分区后，将立即删除源分区。</span><span class="sxs-lookup"><span data-stu-id="93aee-199">Source partitions are immediately deleted after the source is merged into the target partition.</span></span> <span data-ttu-id="93aee-200">合并完成后，刷新“分区”文件夹以更新其内容。</span><span class="sxs-lookup"><span data-stu-id="93aee-200">Refresh the Partitions folder to update its contents after the merge is completed.</span></span>  
  
4.  <span data-ttu-id="93aee-201">右键单击包含累积数据的分区，然后选择“属性”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="93aee-201">Right-click the partition containing the accumulated data and select **Properties**.</span></span>  
  
5.  <span data-ttu-id="93aee-202">打开 `Source` 属性，并修改 WHERE 子句，使之包括您刚合并的分区数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-202">Open the `Source` property and modify the WHERE clause so that it includes the partition data you just merged.</span></span> <span data-ttu-id="93aee-203">请记住， `Source` 属性不会自动更新。</span><span class="sxs-lookup"><span data-stu-id="93aee-203">Recall that the `Source` property is not updated automatically.</span></span> <span data-ttu-id="93aee-204">如果在不首先更新的情况下重新处理 `Source` ，则可能不会获得所有预期的数据。</span><span class="sxs-lookup"><span data-stu-id="93aee-204">If you reprocess without first updating the `Source`, you might not get all of the expected data.</span></span>  
  
##  <a name="how-to-merge-partitions-using-xmla"></a><a name="bkmk_partitionsXMLA"></a> <span data-ttu-id="93aee-205">如何使用 XMLA 合并分区</span><span class="sxs-lookup"><span data-stu-id="93aee-205">How to merge partitions using XMLA</span></span>  
 <span data-ttu-id="93aee-206">有关信息，请参阅此主题[合并分区 (XMLA)](../multidimensional-models-scripting-language-assl-xmla/merging-partitions-xmla.md)。</span><span class="sxs-lookup"><span data-stu-id="93aee-206">See this topic for information, [Merging Partitions &#40;XMLA&#41;](../multidimensional-models-scripting-language-assl-xmla/merging-partitions-xmla.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="93aee-207">另请参阅</span><span class="sxs-lookup"><span data-stu-id="93aee-207">See Also</span></span>  
 <span data-ttu-id="93aee-208">[处理 Analysis Services 对象](processing-analysis-services-objects.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-208">[Processing Analysis Services Objects](processing-analysis-services-objects.md) </span></span>  
 <span data-ttu-id="93aee-209">[Analysis Services 多维数据 &#40;分区&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-209">[Partitions &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models-olap-logical-cube-objects/partitions-analysis-services-multidimensional-data.md) </span></span>  
 <span data-ttu-id="93aee-210">[创建和管理本地分区 &#40;Analysis Services&#41;](create-and-manage-a-local-partition-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-210">[Create and Manage a Local Partition &#40;Analysis Services&#41;](create-and-manage-a-local-partition-analysis-services.md) </span></span>  
 <span data-ttu-id="93aee-211">[创建和管理远程分区 &#40;Analysis Services&#41;](create-and-manage-a-remote-partition-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-211">[Create and Manage a Remote Partition &#40;Analysis Services&#41;](create-and-manage-a-remote-partition-analysis-services.md) </span></span>  
 <span data-ttu-id="93aee-212">[设置分区写回](set-partition-writeback.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-212">[Set Partition Writeback](set-partition-writeback.md) </span></span>  
 <span data-ttu-id="93aee-213">[启用写入的分区](../multidimensional-models-olap-logical-cube-objects/partitions-write-enabled-partitions.md) </span><span class="sxs-lookup"><span data-stu-id="93aee-213">[Write-Enabled Partitions](../multidimensional-models-olap-logical-cube-objects/partitions-write-enabled-partitions.md) </span></span>  
 [<span data-ttu-id="93aee-214">配置维度和分区的字符串存储</span><span class="sxs-lookup"><span data-stu-id="93aee-214">Configure String Storage for Dimensions and Partitions</span></span>](configure-string-storage-for-dimensions-and-partitions.md)  
  
  
