---
title: 查询中的嵌套 select 语句 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 9e361798-688e-4b11-9eef-31fc793e8ba4
author: minewiskan
ms.author: owend
ms.openlocfilehash: 41471645e3443d59294f980eba35fbf9074d7728
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691957"
---
# <a name="subselects-in-queries"></a><span data-ttu-id="97f18-102">查询中的嵌套 select 语句</span><span class="sxs-lookup"><span data-stu-id="97f18-102">Subselects in Queries</span></span>
  <span data-ttu-id="97f18-103">嵌套 select 语句表达式是嵌套的 SELECT 表达式，用于限制从其计算更外部的外部 SELECT 的多维数据集的空间。</span><span class="sxs-lookup"><span data-stu-id="97f18-103">Subselect expressions are nested SELECT expressions that are used to restrict the space of the cube from where the outer external SELECT is being evaluated.</span></span> <span data-ttu-id="97f18-104">嵌套 select 语句可用于定义要对其执行所有计算的新空间。</span><span class="sxs-lookup"><span data-stu-id="97f18-104">Subselects allow you to define a new space over which all calculations are evaluated.</span></span>  
  
## <a name="subselects-by-example"></a><span data-ttu-id="97f18-105">嵌套 select 语句示例</span><span class="sxs-lookup"><span data-stu-id="97f18-105">Subselects by example</span></span>  
 <span data-ttu-id="97f18-106">让我们从一个示例开始，了解嵌套 select 语句如何帮助生成我们想要显示的结果。</span><span class="sxs-lookup"><span data-stu-id="97f18-106">Let's begin with an example of how subselects can help to produce the results we want to show.</span></span> <span data-ttu-id="97f18-107">假定要求您生成一个表，该表显示前 10 种产品在几年中的销售行为。</span><span class="sxs-lookup"><span data-stu-id="97f18-107">Assume that you are requested to produce a table that shows the sales behavior, over years, for the top 10 products.</span></span>  
  
 <span data-ttu-id="97f18-108">结果应该如下表所示：</span><span class="sxs-lookup"><span data-stu-id="97f18-108">The result should look like the following table:</span></span>  
  
|||||  
|-|-|-|-|  
||<span data-ttu-id="97f18-109">Sum of Years</span><span class="sxs-lookup"><span data-stu-id="97f18-109">Sum of Years</span></span>|<span data-ttu-id="97f18-110">Year 1</span><span class="sxs-lookup"><span data-stu-id="97f18-110">Year 1</span></span>|<span data-ttu-id="97f18-111">...</span><span class="sxs-lookup"><span data-stu-id="97f18-111">...</span></span>|  
|<span data-ttu-id="97f18-112">Sum of Top 10 Products</span><span class="sxs-lookup"><span data-stu-id="97f18-112">Sum of Top 10 Products</span></span>||||  
|<span data-ttu-id="97f18-113">Product A</span><span class="sxs-lookup"><span data-stu-id="97f18-113">Product A</span></span>||||  
|<span data-ttu-id="97f18-114">...</span><span class="sxs-lookup"><span data-stu-id="97f18-114">...</span></span>||||  
  
 <span data-ttu-id="97f18-115">可以编写以下 MDX 表达式以获得类似上面的结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-115">To do something like the above one could write the following MDX expression:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , TOPCOUNT( [Product].[Product].MEMBERS  
               , 10  
               , [Measures].[Sales Amount]  
               ) ON 1  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="97f18-116">该查询返回以下结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-116">That returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-117">All Periods</span><span class="sxs-lookup"><span data-stu-id="97f18-117">All Periods</span></span>|<span data-ttu-id="97f18-118">CY 2005</span><span class="sxs-lookup"><span data-stu-id="97f18-118">CY 2005</span></span>|<span data-ttu-id="97f18-119">CY 2006</span><span class="sxs-lookup"><span data-stu-id="97f18-119">CY 20062</span></span>|<span data-ttu-id="97f18-120">CY 2007</span><span class="sxs-lookup"><span data-stu-id="97f18-120">CY 2007</span></span>|<span data-ttu-id="97f18-121">CY 2008</span><span class="sxs-lookup"><span data-stu-id="97f18-121">CY 2008</span></span>|  
|<span data-ttu-id="97f18-122">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-122">All Products</span></span>|<span data-ttu-id="97f18-123">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-123">$80,450,596.98</span></span>|<span data-ttu-id="97f18-124">$8,065,435.31</span><span class="sxs-lookup"><span data-stu-id="97f18-124">$8,065,435.31</span></span>|<span data-ttu-id="97f18-125">$24,144,429.65</span><span class="sxs-lookup"><span data-stu-id="97f18-125">$24,144,429.65</span></span>|<span data-ttu-id="97f18-126">$32,202,669.43</span><span class="sxs-lookup"><span data-stu-id="97f18-126">$32,202,669.43</span></span>|<span data-ttu-id="97f18-127">$16,038,062.60</span><span class="sxs-lookup"><span data-stu-id="97f18-127">$16,038,062.60</span></span>|  
|<span data-ttu-id="97f18-128">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-128">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-129">$1,634,647.94</span><span class="sxs-lookup"><span data-stu-id="97f18-129">$1,634,647.94</span></span>|<span data-ttu-id="97f18-130">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-130">(null)</span></span>|<span data-ttu-id="97f18-131">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-131">(null)</span></span>|<span data-ttu-id="97f18-132">$894,207.97</span><span class="sxs-lookup"><span data-stu-id="97f18-132">$894,207.97</span></span>|<span data-ttu-id="97f18-133">$740,439.97</span><span class="sxs-lookup"><span data-stu-id="97f18-133">$740,439.97</span></span>|  
|<span data-ttu-id="97f18-134">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-134">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-135">$1,285,524.65</span><span class="sxs-lookup"><span data-stu-id="97f18-135">$1,285,524.65</span></span>|<span data-ttu-id="97f18-136">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-136">(null)</span></span>|<span data-ttu-id="97f18-137">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-137">(null)</span></span>|<span data-ttu-id="97f18-138">$722,137.65</span><span class="sxs-lookup"><span data-stu-id="97f18-138">$722,137.65</span></span>|<span data-ttu-id="97f18-139">$563,387.00</span><span class="sxs-lookup"><span data-stu-id="97f18-139">$563,387.00</span></span>|  
|<span data-ttu-id="97f18-140">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-140">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-141">$1,181,945.82</span><span class="sxs-lookup"><span data-stu-id="97f18-141">$1,181,945.82</span></span>|<span data-ttu-id="97f18-142">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-142">(null)</span></span>|<span data-ttu-id="97f18-143">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-143">(null)</span></span>|<span data-ttu-id="97f18-144">$634,600.78</span><span class="sxs-lookup"><span data-stu-id="97f18-144">$634,600.78</span></span>|<span data-ttu-id="97f18-145">$547,345.03</span><span class="sxs-lookup"><span data-stu-id="97f18-145">$547,345.03</span></span>|  
|<span data-ttu-id="97f18-146">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-146">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-147">$995,927.43</span><span class="sxs-lookup"><span data-stu-id="97f18-147">$995,927.43</span></span>|<span data-ttu-id="97f18-148">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-148">(null)</span></span>|<span data-ttu-id="97f18-149">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-149">(null)</span></span>|<span data-ttu-id="97f18-150">$514,995.76</span><span class="sxs-lookup"><span data-stu-id="97f18-150">$514,995.76</span></span>|<span data-ttu-id="97f18-151">$480,931.68</span><span class="sxs-lookup"><span data-stu-id="97f18-151">$480,931.68</span></span>|  
|<span data-ttu-id="97f18-152">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-152">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="97f18-153">$1,005,111.77</span><span class="sxs-lookup"><span data-stu-id="97f18-153">$1,005,111.77</span></span>|<span data-ttu-id="97f18-154">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-154">(null)</span></span>|<span data-ttu-id="97f18-155">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-155">(null)</span></span>|<span data-ttu-id="97f18-156">$529,543.29</span><span class="sxs-lookup"><span data-stu-id="97f18-156">$529,543.29</span></span>|<span data-ttu-id="97f18-157">$475,568.49</span><span class="sxs-lookup"><span data-stu-id="97f18-157">$475,568.49</span></span>|  
|<span data-ttu-id="97f18-158">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-158">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="97f18-159">$975,932.56</span><span class="sxs-lookup"><span data-stu-id="97f18-159">$975,932.56</span></span>|<span data-ttu-id="97f18-160">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-160">(null)</span></span>|<span data-ttu-id="97f18-161">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-161">(null)</span></span>|<span data-ttu-id="97f18-162">$526,759.30</span><span class="sxs-lookup"><span data-stu-id="97f18-162">$526,759.30</span></span>|<span data-ttu-id="97f18-163">$449,173.26</span><span class="sxs-lookup"><span data-stu-id="97f18-163">$449,173.26</span></span>|  
|<span data-ttu-id="97f18-164">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="97f18-164">Road-150 Red, 56</span></span>|<span data-ttu-id="97f18-165">$792,228.98</span><span class="sxs-lookup"><span data-stu-id="97f18-165">$792,228.98</span></span>|<span data-ttu-id="97f18-166">$382,159.24</span><span class="sxs-lookup"><span data-stu-id="97f18-166">$382,159.24</span></span>|<span data-ttu-id="97f18-167">$410,069.74</span><span class="sxs-lookup"><span data-stu-id="97f18-167">$410,069.74</span></span>|<span data-ttu-id="97f18-168">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-168">(null)</span></span>|<span data-ttu-id="97f18-169">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-169">(null)</span></span>|  
|<span data-ttu-id="97f18-170">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-170">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-171">$1,471,078.72</span><span class="sxs-lookup"><span data-stu-id="97f18-171">$1,471,078.72</span></span>|<span data-ttu-id="97f18-172">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-172">(null)</span></span>|<span data-ttu-id="97f18-173">$789,958.49</span><span class="sxs-lookup"><span data-stu-id="97f18-173">$789,958.49</span></span>|<span data-ttu-id="97f18-174">$681,120.23</span><span class="sxs-lookup"><span data-stu-id="97f18-174">$681,120.23</span></span>|<span data-ttu-id="97f18-175">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-175">(null)</span></span>|  
|<span data-ttu-id="97f18-176">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="97f18-176">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="97f18-177">$1,380,253.88</span><span class="sxs-lookup"><span data-stu-id="97f18-177">$1,380,253.88</span></span>|<span data-ttu-id="97f18-178">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-178">(null)</span></span>|<span data-ttu-id="97f18-179">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-179">(null)</span></span>|<span data-ttu-id="97f18-180">$744,988.37</span><span class="sxs-lookup"><span data-stu-id="97f18-180">$744,988.37</span></span>|<span data-ttu-id="97f18-181">$635,265.50</span><span class="sxs-lookup"><span data-stu-id="97f18-181">$635,265.50</span></span>|  
  
 <span data-ttu-id="97f18-182">上面的结果与我们所期望的结果非常接近；只是该查询返回 9 种而不是 10 种产品，并且 All Products 合计返回的是所有产品的总额，而没有返回前 9 种产品（在这个例子中）的总额。</span><span class="sxs-lookup"><span data-stu-id="97f18-182">Which is very close to what we are looking for; except that the query returned 9 not 10 products and the All Products total reflects the sum of all products not the sum of the returned Top 9 (in this case).</span></span> <span data-ttu-id="97f18-183">下面的 MDX 查询将尝试解决上面的结果中遗留的问题：</span><span class="sxs-lookup"><span data-stu-id="97f18-183">Another attempt to solve the problem is presented in the following MDX query:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , TOPCOUNT( [Product].[Product].CHILDREN, 10, [Measures].[Sales Amount]) ON 1  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="97f18-184">该查询返回以下结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-184">That returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-185">All Periods</span><span class="sxs-lookup"><span data-stu-id="97f18-185">All Periods</span></span>|<span data-ttu-id="97f18-186">CY 2005</span><span class="sxs-lookup"><span data-stu-id="97f18-186">CY 2005</span></span>|<span data-ttu-id="97f18-187">CY 2006</span><span class="sxs-lookup"><span data-stu-id="97f18-187">CY 2006</span></span>|<span data-ttu-id="97f18-188">CY 2007</span><span class="sxs-lookup"><span data-stu-id="97f18-188">CY 2007</span></span>|<span data-ttu-id="97f18-189">CY 2008</span><span class="sxs-lookup"><span data-stu-id="97f18-189">CY 2008</span></span>|  
|<span data-ttu-id="97f18-190">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-190">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-191">$1,634,647.94</span><span class="sxs-lookup"><span data-stu-id="97f18-191">$1,634,647.94</span></span>|<span data-ttu-id="97f18-192">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-192">(null)</span></span>|<span data-ttu-id="97f18-193">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-193">(null)</span></span>|<span data-ttu-id="97f18-194">$894,207.97</span><span class="sxs-lookup"><span data-stu-id="97f18-194">$894,207.97</span></span>|<span data-ttu-id="97f18-195">$740,439.97</span><span class="sxs-lookup"><span data-stu-id="97f18-195">$740,439.97</span></span>|  
|<span data-ttu-id="97f18-196">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-196">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-197">$1,285,524.65</span><span class="sxs-lookup"><span data-stu-id="97f18-197">$1,285,524.65</span></span>|<span data-ttu-id="97f18-198">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-198">(null)</span></span>|<span data-ttu-id="97f18-199">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-199">(null)</span></span>|<span data-ttu-id="97f18-200">$722,137.65</span><span class="sxs-lookup"><span data-stu-id="97f18-200">$722,137.65</span></span>|<span data-ttu-id="97f18-201">$563,387.00</span><span class="sxs-lookup"><span data-stu-id="97f18-201">$563,387.00</span></span>|  
|<span data-ttu-id="97f18-202">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-202">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-203">$1,181,945.82</span><span class="sxs-lookup"><span data-stu-id="97f18-203">$1,181,945.82</span></span>|<span data-ttu-id="97f18-204">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-204">(null)</span></span>|<span data-ttu-id="97f18-205">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-205">(null)</span></span>|<span data-ttu-id="97f18-206">$634,600.78</span><span class="sxs-lookup"><span data-stu-id="97f18-206">$634,600.78</span></span>|<span data-ttu-id="97f18-207">$547,345.03</span><span class="sxs-lookup"><span data-stu-id="97f18-207">$547,345.03</span></span>|  
|<span data-ttu-id="97f18-208">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-208">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-209">$995,927.43</span><span class="sxs-lookup"><span data-stu-id="97f18-209">$995,927.43</span></span>|<span data-ttu-id="97f18-210">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-210">(null)</span></span>|<span data-ttu-id="97f18-211">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-211">(null)</span></span>|<span data-ttu-id="97f18-212">$514,995.76</span><span class="sxs-lookup"><span data-stu-id="97f18-212">$514,995.76</span></span>|<span data-ttu-id="97f18-213">$480,931.68</span><span class="sxs-lookup"><span data-stu-id="97f18-213">$480,931.68</span></span>|  
|<span data-ttu-id="97f18-214">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-214">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="97f18-215">$1,005,111.77</span><span class="sxs-lookup"><span data-stu-id="97f18-215">$1,005,111.77</span></span>|<span data-ttu-id="97f18-216">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-216">(null)</span></span>|<span data-ttu-id="97f18-217">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-217">(null)</span></span>|<span data-ttu-id="97f18-218">$529,543.29</span><span class="sxs-lookup"><span data-stu-id="97f18-218">$529,543.29</span></span>|<span data-ttu-id="97f18-219">$475,568.49</span><span class="sxs-lookup"><span data-stu-id="97f18-219">$475,568.49</span></span>|  
|<span data-ttu-id="97f18-220">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-220">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="97f18-221">$975,932.56</span><span class="sxs-lookup"><span data-stu-id="97f18-221">$975,932.56</span></span>|<span data-ttu-id="97f18-222">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-222">(null)</span></span>|<span data-ttu-id="97f18-223">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-223">(null)</span></span>|<span data-ttu-id="97f18-224">$526,759.30</span><span class="sxs-lookup"><span data-stu-id="97f18-224">$526,759.30</span></span>|<span data-ttu-id="97f18-225">$449,173.26</span><span class="sxs-lookup"><span data-stu-id="97f18-225">$449,173.26</span></span>|  
|<span data-ttu-id="97f18-226">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="97f18-226">Road-150 Red, 56</span></span>|<span data-ttu-id="97f18-227">$792,228.98</span><span class="sxs-lookup"><span data-stu-id="97f18-227">$792,228.98</span></span>|<span data-ttu-id="97f18-228">$382,159.24</span><span class="sxs-lookup"><span data-stu-id="97f18-228">$382,159.24</span></span>|<span data-ttu-id="97f18-229">$410,069.74</span><span class="sxs-lookup"><span data-stu-id="97f18-229">$410,069.74</span></span>|<span data-ttu-id="97f18-230">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-230">(null)</span></span>|<span data-ttu-id="97f18-231">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-231">(null)</span></span>|  
|<span data-ttu-id="97f18-232">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-232">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-233">$1,471,078.72</span><span class="sxs-lookup"><span data-stu-id="97f18-233">$1,471,078.72</span></span>|<span data-ttu-id="97f18-234">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-234">(null)</span></span>|<span data-ttu-id="97f18-235">$789,958.49</span><span class="sxs-lookup"><span data-stu-id="97f18-235">$789,958.49</span></span>|<span data-ttu-id="97f18-236">$681,120.23</span><span class="sxs-lookup"><span data-stu-id="97f18-236">$681,120.23</span></span>|<span data-ttu-id="97f18-237">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-237">(null)</span></span>|  
|<span data-ttu-id="97f18-238">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="97f18-238">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="97f18-239">$1,380,253.88</span><span class="sxs-lookup"><span data-stu-id="97f18-239">$1,380,253.88</span></span>|<span data-ttu-id="97f18-240">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-240">(null)</span></span>|<span data-ttu-id="97f18-241">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-241">(null)</span></span>|<span data-ttu-id="97f18-242">$744,988.37</span><span class="sxs-lookup"><span data-stu-id="97f18-242">$744,988.37</span></span>|<span data-ttu-id="97f18-243">$635,265.50</span><span class="sxs-lookup"><span data-stu-id="97f18-243">$635,265.50</span></span>|  
|<span data-ttu-id="97f18-244">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="97f18-244">Road-150 Red, 62</span></span>|<span data-ttu-id="97f18-245">$566,797.97</span><span class="sxs-lookup"><span data-stu-id="97f18-245">$566,797.97</span></span>|<span data-ttu-id="97f18-246">$234,018.86</span><span class="sxs-lookup"><span data-stu-id="97f18-246">$234,018.86</span></span>|<span data-ttu-id="97f18-247">$332,779.11</span><span class="sxs-lookup"><span data-stu-id="97f18-247">$332,779.11</span></span>|<span data-ttu-id="97f18-248">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-248">(null)</span></span>|<span data-ttu-id="97f18-249">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-249">(null)</span></span>|  
  
 <span data-ttu-id="97f18-250">上面的结果非常接近于期望的结果，只是缺少产品的总额。</span><span class="sxs-lookup"><span data-stu-id="97f18-250">That was very close to the desired result because it only missed the sum of the products.</span></span> <span data-ttu-id="97f18-251">此时，您可以开始微调上面的 MDX 表达式以便添加缺失的行；但是，这个任务执行起来显得相当麻烦。</span><span class="sxs-lookup"><span data-stu-id="97f18-251">At this point one can start tweaking the above MDX expression to add the missing line; however, that task could prove to be a cumbersome one.</span></span>  
  
 <span data-ttu-id="97f18-252">解决该问题的另一个方法是开始考虑重新定义对其解析 MDX 表达式的多维数据集空间。</span><span class="sxs-lookup"><span data-stu-id="97f18-252">Another approach to solve the problem, would be to start thinking in terms of redefining the cube space over which the MDX expression is resolved.</span></span> <span data-ttu-id="97f18-253">如果这个“新的”多维数据集只包含来自前 10 种产品的数据该怎么办？</span><span class="sxs-lookup"><span data-stu-id="97f18-253">What if the 'new' cube contains only data from the Top 10 products?</span></span> <span data-ttu-id="97f18-254">这样，该多维数据集将所有成员调整为仅是前 10 种产品，并且一个简单的查询现在就可以满足我们的需要。</span><span class="sxs-lookup"><span data-stu-id="97f18-254">That cube then will have the All member adjusted to the Top 10 products only and now a simple query would resolve our needs.</span></span>  
  
 <span data-ttu-id="97f18-255">下面的 MDX 表达式使用一个嵌套 select 语句，将多维数据集空间重新定义为前 10 种产品并且生成期望的结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-255">The following MDX expression uses a subselect statement to redefine the cube space to the Top 10 products and produce the desired results:</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN  
                       , 10  
                       , [Measures].[Sales Amount]  
                       ) ON 0  
          FROM [Adventure Works]  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="97f18-256">上面的表达式返回以下结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-256">The above expression returns the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-257">All Periods</span><span class="sxs-lookup"><span data-stu-id="97f18-257">All Periods</span></span>|<span data-ttu-id="97f18-258">CY 2005</span><span class="sxs-lookup"><span data-stu-id="97f18-258">CY 2005</span></span>|<span data-ttu-id="97f18-259">CY 2006</span><span class="sxs-lookup"><span data-stu-id="97f18-259">CY 2006</span></span>|<span data-ttu-id="97f18-260">CY 2007</span><span class="sxs-lookup"><span data-stu-id="97f18-260">CY 2007</span></span>|<span data-ttu-id="97f18-261">CY 2008</span><span class="sxs-lookup"><span data-stu-id="97f18-261">CY 2008</span></span>|  
|<span data-ttu-id="97f18-262">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-262">All Products</span></span>|<span data-ttu-id="97f18-263">$19,997,183.30</span><span class="sxs-lookup"><span data-stu-id="97f18-263">$19,997,183.30</span></span>|<span data-ttu-id="97f18-264">$1,696,815.63</span><span class="sxs-lookup"><span data-stu-id="97f18-264">$1,696,815.63</span></span>|<span data-ttu-id="97f18-265">$2,816,611.28</span><span class="sxs-lookup"><span data-stu-id="97f18-265">$2,816,611.28</span></span>|<span data-ttu-id="97f18-266">$7,930,797.72</span><span class="sxs-lookup"><span data-stu-id="97f18-266">$7,930,797.72</span></span>|<span data-ttu-id="97f18-267">$7,552,958.66</span><span class="sxs-lookup"><span data-stu-id="97f18-267">$7,552,958.66</span></span>|  
|<span data-ttu-id="97f18-268">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-268">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-269">$2,160,981.60</span><span class="sxs-lookup"><span data-stu-id="97f18-269">$2,160,981.60</span></span>|<span data-ttu-id="97f18-270">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-270">(null)</span></span>|<span data-ttu-id="97f18-271">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-271">(null)</span></span>|<span data-ttu-id="97f18-272">$1,024,359.10</span><span class="sxs-lookup"><span data-stu-id="97f18-272">$1,024,359.10</span></span>|<span data-ttu-id="97f18-273">$1,136,622.49</span><span class="sxs-lookup"><span data-stu-id="97f18-273">$1,136,622.49</span></span>|  
|<span data-ttu-id="97f18-274">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-274">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="97f18-275">$1,914,547.85</span><span class="sxs-lookup"><span data-stu-id="97f18-275">$1,914,547.85</span></span>|<span data-ttu-id="97f18-276">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-276">(null)</span></span>|<span data-ttu-id="97f18-277">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-277">(null)</span></span>|<span data-ttu-id="97f18-278">$903,061.68</span><span class="sxs-lookup"><span data-stu-id="97f18-278">$903,061.68</span></span>|<span data-ttu-id="97f18-279">$1,011,486.18</span><span class="sxs-lookup"><span data-stu-id="97f18-279">$1,011,486.18</span></span>|  
|<span data-ttu-id="97f18-280">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-280">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="97f18-281">$1,906,248.55</span><span class="sxs-lookup"><span data-stu-id="97f18-281">$1,906,248.55</span></span>|<span data-ttu-id="97f18-282">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-282">(null)</span></span>|<span data-ttu-id="97f18-283">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-283">(null)</span></span>|<span data-ttu-id="97f18-284">$877,077.79</span><span class="sxs-lookup"><span data-stu-id="97f18-284">$877,077.79</span></span>|<span data-ttu-id="97f18-285">$1,029,170.76</span><span class="sxs-lookup"><span data-stu-id="97f18-285">$1,029,170.76</span></span>|  
|<span data-ttu-id="97f18-286">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-286">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-287">$1,811,229.02</span><span class="sxs-lookup"><span data-stu-id="97f18-287">$1,811,229.02</span></span>|<span data-ttu-id="97f18-288">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-288">(null)</span></span>|<span data-ttu-id="97f18-289">$896,511.60</span><span class="sxs-lookup"><span data-stu-id="97f18-289">$896,511.60</span></span>|<span data-ttu-id="97f18-290">$914,717.43</span><span class="sxs-lookup"><span data-stu-id="97f18-290">$914,717.43</span></span>|<span data-ttu-id="97f18-291">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-291">(null)</span></span>|  
|<span data-ttu-id="97f18-292">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-292">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-293">$2,589,363.78</span><span class="sxs-lookup"><span data-stu-id="97f18-293">$2,589,363.78</span></span>|<span data-ttu-id="97f18-294">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-294">(null)</span></span>|<span data-ttu-id="97f18-295">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-295">(null)</span></span>|<span data-ttu-id="97f18-296">$1,261,406.37</span><span class="sxs-lookup"><span data-stu-id="97f18-296">$1,261,406.37</span></span>|<span data-ttu-id="97f18-297">$1,327,957.41</span><span class="sxs-lookup"><span data-stu-id="97f18-297">$1,327,957.41</span></span>|  
|<span data-ttu-id="97f18-298">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-298">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-299">$2,265,485.38</span><span class="sxs-lookup"><span data-stu-id="97f18-299">$2,265,485.38</span></span>|<span data-ttu-id="97f18-300">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-300">(null)</span></span>|<span data-ttu-id="97f18-301">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-301">(null)</span></span>|<span data-ttu-id="97f18-302">$1,126,055.89</span><span class="sxs-lookup"><span data-stu-id="97f18-302">$1,126,055.89</span></span>|<span data-ttu-id="97f18-303">$1,139,429.49</span><span class="sxs-lookup"><span data-stu-id="97f18-303">$1,139,429.49</span></span>|  
|<span data-ttu-id="97f18-304">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-304">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-305">$1,957,528.24</span><span class="sxs-lookup"><span data-stu-id="97f18-305">$1,957,528.24</span></span>|<span data-ttu-id="97f18-306">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-306">(null)</span></span>|<span data-ttu-id="97f18-307">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-307">(null)</span></span>|<span data-ttu-id="97f18-308">$946,453.88</span><span class="sxs-lookup"><span data-stu-id="97f18-308">$946,453.88</span></span>|<span data-ttu-id="97f18-309">$1,011,074.37</span><span class="sxs-lookup"><span data-stu-id="97f18-309">$1,011,074.37</span></span>|  
|<span data-ttu-id="97f18-310">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="97f18-310">Road-150 Red, 62</span></span>|<span data-ttu-id="97f18-311">$1,769,096.69</span><span class="sxs-lookup"><span data-stu-id="97f18-311">$1,769,096.69</span></span>|<span data-ttu-id="97f18-312">$828,011.68</span><span class="sxs-lookup"><span data-stu-id="97f18-312">$828,011.68</span></span>|<span data-ttu-id="97f18-313">$941,085.01</span><span class="sxs-lookup"><span data-stu-id="97f18-313">$941,085.01</span></span>|<span data-ttu-id="97f18-314">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-314">(null)</span></span>|<span data-ttu-id="97f18-315">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-315">(null)</span></span>|  
|<span data-ttu-id="97f18-316">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="97f18-316">Road-150 Red, 56</span></span>|<span data-ttu-id="97f18-317">$1,847,818.63</span><span class="sxs-lookup"><span data-stu-id="97f18-317">$1,847,818.63</span></span>|<span data-ttu-id="97f18-318">$868,803.96</span><span class="sxs-lookup"><span data-stu-id="97f18-318">$868,803.96</span></span>|<span data-ttu-id="97f18-319">$979,014.67</span><span class="sxs-lookup"><span data-stu-id="97f18-319">$979,014.67</span></span>|<span data-ttu-id="97f18-320">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-320">(null)</span></span>|<span data-ttu-id="97f18-321">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-321">(null)</span></span>|  
|<span data-ttu-id="97f18-322">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="97f18-322">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="97f18-323">$1,774,883.56</span><span class="sxs-lookup"><span data-stu-id="97f18-323">$1,774,883.56</span></span>|<span data-ttu-id="97f18-324">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-324">(null)</span></span>|<span data-ttu-id="97f18-325">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-325">(null)</span></span>|<span data-ttu-id="97f18-326">$877,665.59</span><span class="sxs-lookup"><span data-stu-id="97f18-326">$877,665.59</span></span>|<span data-ttu-id="97f18-327">$897,217.96</span><span class="sxs-lookup"><span data-stu-id="97f18-327">$897,217.96</span></span>|  
  
 <span data-ttu-id="97f18-328">上面的结果正是我们所期望的结果。</span><span class="sxs-lookup"><span data-stu-id="97f18-328">The results above are exactly what we were looking for.</span></span>  
  
 <span data-ttu-id="97f18-329">让我们回顾一下嵌套 select 语句为我们确切做了哪些工作。</span><span class="sxs-lookup"><span data-stu-id="97f18-329">Let's review what exactly did the subselect do for us.</span></span> <span data-ttu-id="97f18-330">该嵌套 select 语句返回了一个新的多维数据集，该多维数据集包含属于产品的所有其他维度；但在产品维度中，它将筛选与我们感兴趣的前 10 种产品匹配的所有成员。</span><span class="sxs-lookup"><span data-stu-id="97f18-330">The subselect returned for us a new cube that contained all other dimensions from product as they are; but, in the product dimension it filtered all members to match the top 10 products that we were interested in.</span></span> <span data-ttu-id="97f18-331">这就像我们删除了未满足前 10 条件的所有数据并且重新生成了多维数据集。</span><span class="sxs-lookup"><span data-stu-id="97f18-331">It was as if we had removed all data that did not meet the Top 10 criteria and had rebuilt the cube.</span></span> <span data-ttu-id="97f18-332">在此示例中要理解的另一个重要概念就是对该多维数据集中所有其他维度的所有成员计算了前 10 种产品；这是因为在嵌套 select 语句中没有施加任何其他筛选限制。</span><span class="sxs-lookup"><span data-stu-id="97f18-332">The other important concept to understand in this example is the fact that the Top 10 products were calculated over the All member of all the other dimensions in the cube; the former is true because no other filtering restrictions were imposed in the subselect.</span></span>  
  
 <span data-ttu-id="97f18-333">嵌套 select 语句可以根据需要十分复杂；下面的示例将说明如何生成一个与上述表类似的表，但筛选 Sales Territory 维度上的 France 以及 Sales Channel 维度上的 Internet。</span><span class="sxs-lookup"><span data-stu-id="97f18-333">Subselects can be as complex as one would like; the following example will illustrate how to produce a similar table as the mentioned above but filtered on France on the Sales Territory dimension and on Internet for the Sales Channel dimension.</span></span>  
  
```  
SELECT [Date].[Calendar Year].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN  
                       , 10  
                       , [Measures].[Sales Amount]  
                       ) ON 0  
             , [Sales Territory].[Sales Territory].[Region].[France] on 1  
             ,  [Sales Channel].[Sales Channel].[Internet] on 2  
          FROM [Adventure Works]  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="97f18-334">生成以下结果：</span><span class="sxs-lookup"><span data-stu-id="97f18-334">Produced the following results:</span></span>  
  
|||||||  
|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-335">All Periods</span><span class="sxs-lookup"><span data-stu-id="97f18-335">All Periods</span></span>|<span data-ttu-id="97f18-336">CY 2005</span><span class="sxs-lookup"><span data-stu-id="97f18-336">CY 2005</span></span>|<span data-ttu-id="97f18-337">CY 2006</span><span class="sxs-lookup"><span data-stu-id="97f18-337">CY 2006</span></span>|<span data-ttu-id="97f18-338">CY 2007</span><span class="sxs-lookup"><span data-stu-id="97f18-338">CY 2007</span></span>|<span data-ttu-id="97f18-339">CY 2008</span><span class="sxs-lookup"><span data-stu-id="97f18-339">CY 2008</span></span>|  
|<span data-ttu-id="97f18-340">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-340">All Products</span></span>|<span data-ttu-id="97f18-341">$748,682.49</span><span class="sxs-lookup"><span data-stu-id="97f18-341">$748,682.49</span></span>|<span data-ttu-id="97f18-342">$32,204.43</span><span class="sxs-lookup"><span data-stu-id="97f18-342">$32,204.43</span></span>|<span data-ttu-id="97f18-343">$73,125.18</span><span class="sxs-lookup"><span data-stu-id="97f18-343">$73,125.18</span></span>|<span data-ttu-id="97f18-344">$269,506.56</span><span class="sxs-lookup"><span data-stu-id="97f18-344">$269,506.56</span></span>|<span data-ttu-id="97f18-345">$373,846.32</span><span class="sxs-lookup"><span data-stu-id="97f18-345">$373,846.32</span></span>|  
|<span data-ttu-id="97f18-346">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-346">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-347">$90,479.61</span><span class="sxs-lookup"><span data-stu-id="97f18-347">$90,479.61</span></span>|<span data-ttu-id="97f18-348">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-348">(null)</span></span>|<span data-ttu-id="97f18-349">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-349">(null)</span></span>|<span data-ttu-id="97f18-350">$41,759.82</span><span class="sxs-lookup"><span data-stu-id="97f18-350">$41,759.82</span></span>|<span data-ttu-id="97f18-351">$48,719.79</span><span class="sxs-lookup"><span data-stu-id="97f18-351">$48,719.79</span></span>|  
|<span data-ttu-id="97f18-352">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-352">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="97f18-353">$97,439.58</span><span class="sxs-lookup"><span data-stu-id="97f18-353">$97,439.58</span></span>|<span data-ttu-id="97f18-354">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-354">(null)</span></span>|<span data-ttu-id="97f18-355">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-355">(null)</span></span>|<span data-ttu-id="97f18-356">$39,439.83</span><span class="sxs-lookup"><span data-stu-id="97f18-356">$39,439.83</span></span>|<span data-ttu-id="97f18-357">$57,999.75</span><span class="sxs-lookup"><span data-stu-id="97f18-357">$57,999.75</span></span>|  
|<span data-ttu-id="97f18-358">Mountain-200 Silver, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-358">Mountain-200 Silver, 46</span></span>|<span data-ttu-id="97f18-359">$102,079.56</span><span class="sxs-lookup"><span data-stu-id="97f18-359">$102,079.56</span></span>|<span data-ttu-id="97f18-360">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-360">(null)</span></span>|<span data-ttu-id="97f18-361">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-361">(null)</span></span>|<span data-ttu-id="97f18-362">$27,839.88</span><span class="sxs-lookup"><span data-stu-id="97f18-362">$27,839.88</span></span>|<span data-ttu-id="97f18-363">$74,239.68</span><span class="sxs-lookup"><span data-stu-id="97f18-363">$74,239.68</span></span>|  
|<span data-ttu-id="97f18-364">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-364">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-365">$26,638.28</span><span class="sxs-lookup"><span data-stu-id="97f18-365">$26,638.28</span></span>|<span data-ttu-id="97f18-366">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-366">(null)</span></span>|<span data-ttu-id="97f18-367">$12,294.59</span><span class="sxs-lookup"><span data-stu-id="97f18-367">$12,294.59</span></span>|<span data-ttu-id="97f18-368">$14,343.69</span><span class="sxs-lookup"><span data-stu-id="97f18-368">$14,343.69</span></span>|<span data-ttu-id="97f18-369">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-369">(null)</span></span>|  
|<span data-ttu-id="97f18-370">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-370">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-371">$96,389.58</span><span class="sxs-lookup"><span data-stu-id="97f18-371">$96,389.58</span></span>|<span data-ttu-id="97f18-372">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-372">(null)</span></span>|<span data-ttu-id="97f18-373">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-373">(null)</span></span>|<span data-ttu-id="97f18-374">$41,309.82</span><span class="sxs-lookup"><span data-stu-id="97f18-374">$41,309.82</span></span>|<span data-ttu-id="97f18-375">$55,079.76</span><span class="sxs-lookup"><span data-stu-id="97f18-375">$55,079.76</span></span>|  
|<span data-ttu-id="97f18-376">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-376">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-377">$80,324.65</span><span class="sxs-lookup"><span data-stu-id="97f18-377">$80,324.65</span></span>|<span data-ttu-id="97f18-378">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-378">(null)</span></span>|<span data-ttu-id="97f18-379">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-379">(null)</span></span>|<span data-ttu-id="97f18-380">$43,604.81</span><span class="sxs-lookup"><span data-stu-id="97f18-380">$43,604.81</span></span>|<span data-ttu-id="97f18-381">$36,719.84</span><span class="sxs-lookup"><span data-stu-id="97f18-381">$36,719.84</span></span>|  
|<span data-ttu-id="97f18-382">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-382">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-383">$107,864.53</span><span class="sxs-lookup"><span data-stu-id="97f18-383">$107,864.53</span></span>|<span data-ttu-id="97f18-384">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-384">(null)</span></span>|<span data-ttu-id="97f18-385">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-385">(null)</span></span>|<span data-ttu-id="97f18-386">$45,899.80</span><span class="sxs-lookup"><span data-stu-id="97f18-386">$45,899.80</span></span>|<span data-ttu-id="97f18-387">$61,964.73</span><span class="sxs-lookup"><span data-stu-id="97f18-387">$61,964.73</span></span>|  
|<span data-ttu-id="97f18-388">Road-150 Red, 62</span><span class="sxs-lookup"><span data-stu-id="97f18-388">Road-150 Red, 62</span></span>|<span data-ttu-id="97f18-389">$46,517.51</span><span class="sxs-lookup"><span data-stu-id="97f18-389">$46,517.51</span></span>|<span data-ttu-id="97f18-390">$14,313.08</span><span class="sxs-lookup"><span data-stu-id="97f18-390">$14,313.08</span></span>|<span data-ttu-id="97f18-391">$32,204.43</span><span class="sxs-lookup"><span data-stu-id="97f18-391">$32,204.43</span></span>|<span data-ttu-id="97f18-392">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-392">(null)</span></span>|<span data-ttu-id="97f18-393">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-393">(null)</span></span>|  
|<span data-ttu-id="97f18-394">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="97f18-394">Road-150 Red, 56</span></span>|<span data-ttu-id="97f18-395">$46,517.51</span><span class="sxs-lookup"><span data-stu-id="97f18-395">$46,517.51</span></span>|<span data-ttu-id="97f18-396">$17,891.35</span><span class="sxs-lookup"><span data-stu-id="97f18-396">$17,891.35</span></span>|<span data-ttu-id="97f18-397">$28,626.16</span><span class="sxs-lookup"><span data-stu-id="97f18-397">$28,626.16</span></span>|<span data-ttu-id="97f18-398">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-398">(null)</span></span>|<span data-ttu-id="97f18-399">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-399">(null)</span></span>|  
|<span data-ttu-id="97f18-400">Road-350-W Yellow, 48</span><span class="sxs-lookup"><span data-stu-id="97f18-400">Road-350-W Yellow, 48</span></span>|<span data-ttu-id="97f18-401">$54,431.68</span><span class="sxs-lookup"><span data-stu-id="97f18-401">$54,431.68</span></span>|<span data-ttu-id="97f18-402">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-402">(null)</span></span>|<span data-ttu-id="97f18-403">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-403">(null)</span></span>|<span data-ttu-id="97f18-404">$15,308.91</span><span class="sxs-lookup"><span data-stu-id="97f18-404">$15,308.91</span></span>|<span data-ttu-id="97f18-405">$39,122.77</span><span class="sxs-lookup"><span data-stu-id="97f18-405">$39,122.77</span></span>|  
  
 <span data-ttu-id="97f18-406">上面的结果是在 France 通过 Internet 渠道销售的前 10 种产品。</span><span class="sxs-lookup"><span data-stu-id="97f18-406">The above results are the Top 10 products sold in France through the Internet channel.</span></span>  
  
## <a name="subselect-statement"></a><span data-ttu-id="97f18-407">嵌套 select 语句</span><span class="sxs-lookup"><span data-stu-id="97f18-407">Subselect statement</span></span>  
 <span data-ttu-id="97f18-408">该嵌套 select 语句的 BNF 是：</span><span class="sxs-lookup"><span data-stu-id="97f18-408">The BNF for the Subselect is:</span></span>  
  
```  
[WITH [<calc-clause> ...]]  
SELECT [<axis-spec> [, <axis-spec> ...]]  
FROM [<identifier> | (< sub-select-statement >)]  
[WHERE <slicer>]  
[[CELL] PROPERTIES <cellprop> [, <cellprop> ...]]  
  
< sub-select-statement > :=  
   SELECT [<axis-spec> [, <axis-spec> ...]]  
   FROM [<identifier> | (< sub-select-statement >)]  
   [WHERE <slicer>]  
  
```  
  
 <span data-ttu-id="97f18-409">该嵌套 select 语句是另一个 Select 语句，其中，轴规范和切片器规范筛选对其计算外部选择的多维数据集的空间。</span><span class="sxs-lookup"><span data-stu-id="97f18-409">The subselect is another Select statement where the axis specifications and the slicer specification filter the space of the cube over which the outer select is evaluated.</span></span>  
  
 <span data-ttu-id="97f18-410">在轴或切片器子句之一中指定了某一成员后，该成员及其祖先和后代将包括在该嵌套 select 语句的子多维数据集空间中；轴或切片器子句中所有未提及的同级成员及其后代将从子空间中筛选出来。</span><span class="sxs-lookup"><span data-stu-id="97f18-410">When a member is specified in one of the axis or slicer clause then that member with its ascendants and descendants are included in the sub cube space for the subselect; all non mentioned sibling members, in the axis or slicer clause, and their descendants are filtered from the subspace.</span></span> <span data-ttu-id="97f18-411">这样，外部选择的空间已限制为轴子句或切片器子句中的现有成员，且具有上述祖先和后代。</span><span class="sxs-lookup"><span data-stu-id="97f18-411">This way, the space of the outer select has been limited to the existing members in the axis clause or slicer clause, with their ascendants and descendants as mentioned before.</span></span>  
  
 <span data-ttu-id="97f18-412">因为轴或切片器子句中所有未提及的维度的所有成员都属于该 select 语句的空间；所以，这些维度上所有成员的所有后代也是嵌套 select 语句空间的一部分。</span><span class="sxs-lookup"><span data-stu-id="97f18-412">Because the All member of all non mentioned dimensions in axis or slicer clauses belongs to the space of the select; then, all descendants to the All member on those dimensions are, also, part of the subselect space.</span></span>  
  
 <span data-ttu-id="97f18-413">子多维数据集空间中所有维度的所有成员将重新计算，以便反映新空间约束的影响。</span><span class="sxs-lookup"><span data-stu-id="97f18-413">The All member, in all dimensions, in the subcube space, is re-evaluated to reflect the impact of the constrains of the new space.</span></span>  
  
 <span data-ttu-id="97f18-414">下面的示例将说明上述内容；第一个 MDX 表达式将显示多维数据集中未筛选的值；第二个 MDX 将说明在嵌套 select 语句子句中进行筛选的影响：</span><span class="sxs-lookup"><span data-stu-id="97f18-414">The following example will show what has been said above; the first MDX expression helps to display the unfiltered values in the cube, the second MDX illustrates the effect of filtering in the Subselect clause:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,  {[Measures].[Internet Sales Amount], [Measures].[Reseller Sales Amount]} ON 0  
  FROM [Adventure Works]  
```  
  
 <span data-ttu-id="97f18-415">返回以下值：</span><span class="sxs-lookup"><span data-stu-id="97f18-415">Returns the following values:</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="97f18-416">Internet Sales Amount</span><span class="sxs-lookup"><span data-stu-id="97f18-416">Internet Sales Amount</span></span>|<span data-ttu-id="97f18-417">Reseller Sales Amount</span><span class="sxs-lookup"><span data-stu-id="97f18-417">Reseller Sales Amount</span></span>|  
|<span data-ttu-id="97f18-418">All Customers</span><span class="sxs-lookup"><span data-stu-id="97f18-418">All Customers</span></span>|<span data-ttu-id="97f18-419">$29,358,677.22</span><span class="sxs-lookup"><span data-stu-id="97f18-419">$29,358,677.22</span></span>|<span data-ttu-id="97f18-420">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-420">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-421">美国</span><span class="sxs-lookup"><span data-stu-id="97f18-421">United States</span></span>|<span data-ttu-id="97f18-422">$9,389,789.51</span><span class="sxs-lookup"><span data-stu-id="97f18-422">$9,389,789.51</span></span>|<span data-ttu-id="97f18-423">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-423">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-424">Oregon</span><span class="sxs-lookup"><span data-stu-id="97f18-424">Oregon</span></span>|<span data-ttu-id="97f18-425">$1,170,991.54</span><span class="sxs-lookup"><span data-stu-id="97f18-425">$1,170,991.54</span></span>|<span data-ttu-id="97f18-426">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-426">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-427">Portland</span><span class="sxs-lookup"><span data-stu-id="97f18-427">Portland</span></span>|<span data-ttu-id="97f18-428">$110,649.54</span><span class="sxs-lookup"><span data-stu-id="97f18-428">$110,649.54</span></span>|<span data-ttu-id="97f18-429">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-429">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-430">Washington</span><span class="sxs-lookup"><span data-stu-id="97f18-430">Washington</span></span>|<span data-ttu-id="97f18-431">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-431">$2,467,248.34</span></span>|<span data-ttu-id="97f18-432">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-432">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-433">西雅图</span><span class="sxs-lookup"><span data-stu-id="97f18-433">Seattle</span></span>|<span data-ttu-id="97f18-434">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="97f18-434">$75,164.86</span></span>|<span data-ttu-id="97f18-435">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-435">$80,450,596.98</span></span>|  
  
 <span data-ttu-id="97f18-436">在上面的示例中，Seattle 是 Washington 的子级，Portland 是 Oregon 的子级，Oregon 和 Washington 是 United States 的子级，United States 是 [Customer Geography].[All Customers] 的子级。</span><span class="sxs-lookup"><span data-stu-id="97f18-436">In the above example Seattle is a child of Washington, Portland is a child of Oregon, Oregon and Washington are children of United States and United States is a child of [Customer Geography].[All Customers].</span></span> <span data-ttu-id="97f18-437">此示例中所有显示的成员都具有涉及父聚合值的其他同级；例如，Spokane、Tacoma 和 Everett 是 Seattle 的同级城市，并且它们都涉及 Washington Internet Sales Amount。</span><span class="sxs-lookup"><span data-stu-id="97f18-437">All of the shown members in this example have other siblings that contribute to the parent aggregate value; i.e. Spokane, Tacoma and Everett are sibling cities of Seattle and they all contribute to Washington Internet Sales Amount.</span></span> <span data-ttu-id="97f18-438">Reseller Sales Amount 值独立于 Customer Geography 属性；因此，所有值将显示在结果中。</span><span class="sxs-lookup"><span data-stu-id="97f18-438">Reseller Sales Amount value is independent of Customer Geography attribute; hence the All value is displayed in the results.</span></span> <span data-ttu-id="97f18-439">下一个 MDX 表达式将说明嵌套 select 语句子句的筛选影响：</span><span class="sxs-lookup"><span data-stu-id="97f18-439">The next MDX expression illustrates the filtering effect of the subselect clause:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,  {[Measures].[Internet Sales Amount], [Measures].[Reseller Sales Amount]} ON 0  
  FROM ( SELECT [Customer].[State-Province].&[WA]&[US] ON 0  
           FROM [Adventure Works]  
        )  
```  
  
 <span data-ttu-id="97f18-440">返回以下值：</span><span class="sxs-lookup"><span data-stu-id="97f18-440">Returns the following values:</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="97f18-441">Internet Sales Amount</span><span class="sxs-lookup"><span data-stu-id="97f18-441">Internet Sales Amount</span></span>|<span data-ttu-id="97f18-442">Reseller Sales Amount</span><span class="sxs-lookup"><span data-stu-id="97f18-442">Reseller Sales Amount</span></span>|  
|<span data-ttu-id="97f18-443">All Customers</span><span class="sxs-lookup"><span data-stu-id="97f18-443">All Customers</span></span>|<span data-ttu-id="97f18-444">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-444">$2,467,248.34</span></span>|<span data-ttu-id="97f18-445">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-445">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-446">美国</span><span class="sxs-lookup"><span data-stu-id="97f18-446">United States</span></span>|<span data-ttu-id="97f18-447">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-447">$2,467,248.34</span></span>|<span data-ttu-id="97f18-448">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-448">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-449">Washington</span><span class="sxs-lookup"><span data-stu-id="97f18-449">Washington</span></span>|<span data-ttu-id="97f18-450">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-450">$2,467,248.34</span></span>|<span data-ttu-id="97f18-451">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-451">$80,450,596.98</span></span>|  
|<span data-ttu-id="97f18-452">西雅图</span><span class="sxs-lookup"><span data-stu-id="97f18-452">Seattle</span></span>|<span data-ttu-id="97f18-453">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="97f18-453">$75,164.86</span></span>|<span data-ttu-id="97f18-454">$80,450,596.98</span><span class="sxs-lookup"><span data-stu-id="97f18-454">$80,450,596.98</span></span>|  
  
 <span data-ttu-id="97f18-455">上面的结果显示，只有 Washington State 的祖先和后代是计算外部选择语句的子空间的一部分；Oregon 和 Portland 已从子多维数据集中删除，因为在提及 Washington 时在嵌套 select 语句中未提及 Oregon 以及所有其他同级的州。</span><span class="sxs-lookup"><span data-stu-id="97f18-455">The results above show that only ascendants and descendants of Washington State are part of the subspace where the outer select statement was evaluated; Oregon and Portland have been removed from the subcube because Oregon and all the other sibling states were not mentioned in the subselect when Washington was mentioned.</span></span>  
  
 <span data-ttu-id="97f18-456">已对所有成员进行调整以便反映对 Washington 的筛选；不仅在 [Customer Geography] 维度中进行了调整，而且在与 [Customer Geography] 相交的所有其他维度中也进行调整。</span><span class="sxs-lookup"><span data-stu-id="97f18-456">The All member was adjusted to reflect the filtering on Washington; not only was adjusted in the [Customer Geography] dimension but in all other dimensions that crossed with [Customer Geography].</span></span> <span data-ttu-id="97f18-457">不与 [Customer Geography] 相交的所有维度将在子多维数据集中保持不更改。</span><span class="sxs-lookup"><span data-stu-id="97f18-457">All dimensions that do not cross with [Customer Geography] remain in the subcube unaltered.</span></span>  
  
 <span data-ttu-id="97f18-458">下面的两个 MDX 语句说明如何调整其他维度中的所有成员以便满足嵌套 select 语句的筛选效果。</span><span class="sxs-lookup"><span data-stu-id="97f18-458">The following two MDX statements illustrate how the All member in other dimensions is adjusted to meet the filtering effect of the subselect.</span></span> <span data-ttu-id="97f18-459">第一个查询显示未更改的结果，第二个查询显示筛选的影响：</span><span class="sxs-lookup"><span data-stu-id="97f18-459">The first query displays the unaltered results and the second shows the impact of the filtering:</span></span>  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,   [Product].[Product Line].MEMBERS ON 0  
  FROM [Adventure Works]  
 WHERE [Measures].[Internet Sales Amount]  
```  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-460">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-460">All Products</span></span>|<span data-ttu-id="97f18-461">Accessory</span><span class="sxs-lookup"><span data-stu-id="97f18-461">Accessory</span></span>|<span data-ttu-id="97f18-462">组件</span><span class="sxs-lookup"><span data-stu-id="97f18-462">Components</span></span>|<span data-ttu-id="97f18-463">Mountain</span><span class="sxs-lookup"><span data-stu-id="97f18-463">Mountain</span></span>|<span data-ttu-id="97f18-464">道路</span><span class="sxs-lookup"><span data-stu-id="97f18-464">Road</span></span>|<span data-ttu-id="97f18-465">Touring</span><span class="sxs-lookup"><span data-stu-id="97f18-465">Touring</span></span>|  
|<span data-ttu-id="97f18-466">All Customers</span><span class="sxs-lookup"><span data-stu-id="97f18-466">All Customers</span></span>|<span data-ttu-id="97f18-467">$29,358,677.22</span><span class="sxs-lookup"><span data-stu-id="97f18-467">$29,358,677.22</span></span>|<span data-ttu-id="97f18-468">$604,053.30</span><span class="sxs-lookup"><span data-stu-id="97f18-468">$604,053.30</span></span>|<span data-ttu-id="97f18-469">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-469">(null)</span></span>|<span data-ttu-id="97f18-470">$10,251,183.52</span><span class="sxs-lookup"><span data-stu-id="97f18-470">$10,251,183.52</span></span>|<span data-ttu-id="97f18-471">$14,624,108.58</span><span class="sxs-lookup"><span data-stu-id="97f18-471">$14,624,108.58</span></span>|<span data-ttu-id="97f18-472">$3,879,331.82</span><span class="sxs-lookup"><span data-stu-id="97f18-472">$3,879,331.82</span></span>|  
|<span data-ttu-id="97f18-473">美国</span><span class="sxs-lookup"><span data-stu-id="97f18-473">United States</span></span>|<span data-ttu-id="97f18-474">$9,389,789.51</span><span class="sxs-lookup"><span data-stu-id="97f18-474">$9,389,789.51</span></span>|<span data-ttu-id="97f18-475">$217,168.79</span><span class="sxs-lookup"><span data-stu-id="97f18-475">$217,168.79</span></span>|<span data-ttu-id="97f18-476">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-476">(null)</span></span>|<span data-ttu-id="97f18-477">$3,547,956.78</span><span class="sxs-lookup"><span data-stu-id="97f18-477">$3,547,956.78</span></span>|<span data-ttu-id="97f18-478">$4,322,438.41</span><span class="sxs-lookup"><span data-stu-id="97f18-478">$4,322,438.41</span></span>|<span data-ttu-id="97f18-479">$1,302,225.54</span><span class="sxs-lookup"><span data-stu-id="97f18-479">$1,302,225.54</span></span>|  
|<span data-ttu-id="97f18-480">Oregon</span><span class="sxs-lookup"><span data-stu-id="97f18-480">Oregon</span></span>|<span data-ttu-id="97f18-481">$1,170,991.54</span><span class="sxs-lookup"><span data-stu-id="97f18-481">$1,170,991.54</span></span>|<span data-ttu-id="97f18-482">$30,513.17</span><span class="sxs-lookup"><span data-stu-id="97f18-482">$30,513.17</span></span>|<span data-ttu-id="97f18-483">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-483">(null)</span></span>|<span data-ttu-id="97f18-484">$443,607.98</span><span class="sxs-lookup"><span data-stu-id="97f18-484">$443,607.98</span></span>|<span data-ttu-id="97f18-485">$565,372.10</span><span class="sxs-lookup"><span data-stu-id="97f18-485">$565,372.10</span></span>|<span data-ttu-id="97f18-486">$131,498.29</span><span class="sxs-lookup"><span data-stu-id="97f18-486">$131,498.29</span></span>|  
|<span data-ttu-id="97f18-487">Portland</span><span class="sxs-lookup"><span data-stu-id="97f18-487">Portland</span></span>|<span data-ttu-id="97f18-488">$110,649.54</span><span class="sxs-lookup"><span data-stu-id="97f18-488">$110,649.54</span></span>|<span data-ttu-id="97f18-489">$2,834.17</span><span class="sxs-lookup"><span data-stu-id="97f18-489">$2,834.17</span></span>|<span data-ttu-id="97f18-490">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-490">(null)</span></span>|<span data-ttu-id="97f18-491">$47,099.91</span><span class="sxs-lookup"><span data-stu-id="97f18-491">$47,099.91</span></span>|<span data-ttu-id="97f18-492">$53,917.17</span><span class="sxs-lookup"><span data-stu-id="97f18-492">$53,917.17</span></span>|<span data-ttu-id="97f18-493">$6,798.29</span><span class="sxs-lookup"><span data-stu-id="97f18-493">$6,798.29</span></span>|  
|<span data-ttu-id="97f18-494">Washington</span><span class="sxs-lookup"><span data-stu-id="97f18-494">Washington</span></span>|<span data-ttu-id="97f18-495">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-495">$2,467,248.34</span></span>|<span data-ttu-id="97f18-496">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="97f18-496">$62,662.92</span></span>|<span data-ttu-id="97f18-497">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-497">(null)</span></span>|<span data-ttu-id="97f18-498">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="97f18-498">$945,219.38</span></span>|<span data-ttu-id="97f18-499">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="97f18-499">$1,155,880.07</span></span>|<span data-ttu-id="97f18-500">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="97f18-500">$303,485.97</span></span>|  
|<span data-ttu-id="97f18-501">西雅图</span><span class="sxs-lookup"><span data-stu-id="97f18-501">Seattle</span></span>|<span data-ttu-id="97f18-502">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="97f18-502">$75,164.86</span></span>|<span data-ttu-id="97f18-503">$2,695.74</span><span class="sxs-lookup"><span data-stu-id="97f18-503">$2,695.74</span></span>|<span data-ttu-id="97f18-504">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-504">(null)</span></span>|<span data-ttu-id="97f18-505">$19,914.53</span><span class="sxs-lookup"><span data-stu-id="97f18-505">$19,914.53</span></span>|<span data-ttu-id="97f18-506">$44,820.06</span><span class="sxs-lookup"><span data-stu-id="97f18-506">$44,820.06</span></span>|<span data-ttu-id="97f18-507">$7,734.54</span><span class="sxs-lookup"><span data-stu-id="97f18-507">$7,734.54</span></span>|  
  
```  
SELECT { [Customer].[Customer Geography].[All Customers]  
       , [Customer].[Customer Geography].[Country].&[United States]  
       , [Customer].[Customer Geography].[State-Province].&[OR]&[US]  
       , [Customer].[Customer Geography].[City].&[Portland]&[OR]  
       , [Customer].[Customer Geography].[State-Province].&[WA]&[US]  
       , [Customer].[Customer Geography].[City].&[Seattle]&[WA]  
       } ON 1  
     ,   [Product].[Product Line].MEMBERS ON 0  
  FROM ( SELECT [Customer].[State-Province].&[WA]&[US] ON 0  
           FROM [Adventure Works]  
        )  
 WHERE [Measures].[Internet Sales Amount]  
```  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-508">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-508">All Products</span></span>|<span data-ttu-id="97f18-509">Accessory</span><span class="sxs-lookup"><span data-stu-id="97f18-509">Accessory</span></span>|<span data-ttu-id="97f18-510">组件</span><span class="sxs-lookup"><span data-stu-id="97f18-510">Components</span></span>|<span data-ttu-id="97f18-511">Mountain</span><span class="sxs-lookup"><span data-stu-id="97f18-511">Mountain</span></span>|<span data-ttu-id="97f18-512">道路</span><span class="sxs-lookup"><span data-stu-id="97f18-512">Road</span></span>|<span data-ttu-id="97f18-513">Touring</span><span class="sxs-lookup"><span data-stu-id="97f18-513">Touring</span></span>|  
|<span data-ttu-id="97f18-514">All Customers</span><span class="sxs-lookup"><span data-stu-id="97f18-514">All Customers</span></span>|<span data-ttu-id="97f18-515">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-515">$2,467,248.34</span></span>|<span data-ttu-id="97f18-516">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="97f18-516">$62,662.92</span></span>|<span data-ttu-id="97f18-517">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-517">(null)</span></span>|<span data-ttu-id="97f18-518">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="97f18-518">$945,219.38</span></span>|<span data-ttu-id="97f18-519">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="97f18-519">$1,155,880.07</span></span>|<span data-ttu-id="97f18-520">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="97f18-520">$303,485.97</span></span>|  
|<span data-ttu-id="97f18-521">美国</span><span class="sxs-lookup"><span data-stu-id="97f18-521">United States</span></span>|<span data-ttu-id="97f18-522">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-522">$2,467,248.34</span></span>|<span data-ttu-id="97f18-523">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="97f18-523">$62,662.92</span></span>|<span data-ttu-id="97f18-524">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-524">(null)</span></span>|<span data-ttu-id="97f18-525">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="97f18-525">$945,219.38</span></span>|<span data-ttu-id="97f18-526">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="97f18-526">$1,155,880.07</span></span>|<span data-ttu-id="97f18-527">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="97f18-527">$303,485.97</span></span>|  
|<span data-ttu-id="97f18-528">Washington</span><span class="sxs-lookup"><span data-stu-id="97f18-528">Washington</span></span>|<span data-ttu-id="97f18-529">$2,467,248.34</span><span class="sxs-lookup"><span data-stu-id="97f18-529">$2,467,248.34</span></span>|<span data-ttu-id="97f18-530">$62,662.92</span><span class="sxs-lookup"><span data-stu-id="97f18-530">$62,662.92</span></span>|<span data-ttu-id="97f18-531">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-531">(null)</span></span>|<span data-ttu-id="97f18-532">$945,219.38</span><span class="sxs-lookup"><span data-stu-id="97f18-532">$945,219.38</span></span>|<span data-ttu-id="97f18-533">$1,155,880.07</span><span class="sxs-lookup"><span data-stu-id="97f18-533">$1,155,880.07</span></span>|<span data-ttu-id="97f18-534">$303,485.97</span><span class="sxs-lookup"><span data-stu-id="97f18-534">$303,485.97</span></span>|  
|<span data-ttu-id="97f18-535">西雅图</span><span class="sxs-lookup"><span data-stu-id="97f18-535">Seattle</span></span>|<span data-ttu-id="97f18-536">$75,164.86</span><span class="sxs-lookup"><span data-stu-id="97f18-536">$75,164.86</span></span>|<span data-ttu-id="97f18-537">$2,695.74</span><span class="sxs-lookup"><span data-stu-id="97f18-537">$2,695.74</span></span>|<span data-ttu-id="97f18-538">(null)</span><span class="sxs-lookup"><span data-stu-id="97f18-538">(null)</span></span>|<span data-ttu-id="97f18-539">$19,914.53</span><span class="sxs-lookup"><span data-stu-id="97f18-539">$19,914.53</span></span>|<span data-ttu-id="97f18-540">$44,820.06</span><span class="sxs-lookup"><span data-stu-id="97f18-540">$44,820.06</span></span>|<span data-ttu-id="97f18-541">$7,734.54</span><span class="sxs-lookup"><span data-stu-id="97f18-541">$7,734.54</span></span>|  
  
 <span data-ttu-id="97f18-542">上面的结果显示，All Products 值已调整为预期的仅是来自 Washington State 的值。</span><span class="sxs-lookup"><span data-stu-id="97f18-542">The above results show that All Products values have been adjusted to only values from Washington State, as expected.</span></span>  
  
 <span data-ttu-id="97f18-543">对于嵌套 select 语句可以嵌套的深度没有限制，除非可用内存不支持。</span><span class="sxs-lookup"><span data-stu-id="97f18-543">Subselects can be nested with no limit to how deep you can nest subselects, except available memory.</span></span> <span data-ttu-id="97f18-544">最内部的嵌套 select 语句定义应用筛选的起始子空间并且向上传递到下一外部选择语句。</span><span class="sxs-lookup"><span data-stu-id="97f18-544">The inner most subselect defines the starting subspace over which filtering is applied and passed onto the next outer select.</span></span> <span data-ttu-id="97f18-545">要注意的一个重要事项是，嵌套并非可交换操作；因此，所设置的嵌套的顺序可能会产生不同的结果。</span><span class="sxs-lookup"><span data-stu-id="97f18-545">An important thing to notice is the fact that nesting is not a commutative operation; so the order in which the nesting is set my produce different results.</span></span> <span data-ttu-id="97f18-546">下面的示例显示选择某一嵌套顺序时的差异。</span><span class="sxs-lookup"><span data-stu-id="97f18-546">The following examples should show the difference when choosing a nesting order.</span></span>  
  
```  
SELECT [Sales Territory].[Sales Territory Region].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN, 5, [Measures].[Sales Amount]) ON 0  
          FROM (SELECT TOPCOUNT( [Sales Territory].[Sales Territory Region].CHILDREN, 5, [Measures].[Sales Amount]) on 0  
                  FROM [Adventure Works]  
               )  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="97f18-547">返回以下结果。</span><span class="sxs-lookup"><span data-stu-id="97f18-547">Returned the following results.</span></span>  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-548">All Sales Territories</span><span class="sxs-lookup"><span data-stu-id="97f18-548">All Sales Territories</span></span>|<span data-ttu-id="97f18-549">澳大利亚</span><span class="sxs-lookup"><span data-stu-id="97f18-549">Australia</span></span>|<span data-ttu-id="97f18-550">加拿大</span><span class="sxs-lookup"><span data-stu-id="97f18-550">Canada</span></span>|<span data-ttu-id="97f18-551">Central</span><span class="sxs-lookup"><span data-stu-id="97f18-551">Central</span></span>|<span data-ttu-id="97f18-552">Northwest</span><span class="sxs-lookup"><span data-stu-id="97f18-552">Northwest</span></span>|<span data-ttu-id="97f18-553">Southwest</span><span class="sxs-lookup"><span data-stu-id="97f18-553">Southwest</span></span>|  
|<span data-ttu-id="97f18-554">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-554">All Products</span></span>|<span data-ttu-id="97f18-555">$7,591,495.49</span><span class="sxs-lookup"><span data-stu-id="97f18-555">$7,591,495.49</span></span>|<span data-ttu-id="97f18-556">$1,281,059.99</span><span class="sxs-lookup"><span data-stu-id="97f18-556">$1,281,059.99</span></span>|<span data-ttu-id="97f18-557">$1,547,298.12</span><span class="sxs-lookup"><span data-stu-id="97f18-557">$1,547,298.12</span></span>|<span data-ttu-id="97f18-558">$600,205.79</span><span class="sxs-lookup"><span data-stu-id="97f18-558">$600,205.79</span></span>|<span data-ttu-id="97f18-559">$1,924,763.50</span><span class="sxs-lookup"><span data-stu-id="97f18-559">$1,924,763.50</span></span>|<span data-ttu-id="97f18-560">$2,238,168.08</span><span class="sxs-lookup"><span data-stu-id="97f18-560">$2,238,168.08</span></span>|  
|<span data-ttu-id="97f18-561">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-561">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-562">$1,449,576.15</span><span class="sxs-lookup"><span data-stu-id="97f18-562">$1,449,576.15</span></span>|<span data-ttu-id="97f18-563">$248,702.93</span><span class="sxs-lookup"><span data-stu-id="97f18-563">$248,702.93</span></span>|<span data-ttu-id="97f18-564">$275,052.45</span><span class="sxs-lookup"><span data-stu-id="97f18-564">$275,052.45</span></span>|<span data-ttu-id="97f18-565">$141,103.65</span><span class="sxs-lookup"><span data-stu-id="97f18-565">$141,103.65</span></span>|<span data-ttu-id="97f18-566">$349,487.01</span><span class="sxs-lookup"><span data-stu-id="97f18-566">$349,487.01</span></span>|<span data-ttu-id="97f18-567">$435,230.12</span><span class="sxs-lookup"><span data-stu-id="97f18-567">$435,230.12</span></span>|  
|<span data-ttu-id="97f18-568">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-568">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-569">$1,722,896.50</span><span class="sxs-lookup"><span data-stu-id="97f18-569">$1,722,896.50</span></span>|<span data-ttu-id="97f18-570">$218,024.05</span><span class="sxs-lookup"><span data-stu-id="97f18-570">$218,024.05</span></span>|<span data-ttu-id="97f18-571">$418,726.43</span><span class="sxs-lookup"><span data-stu-id="97f18-571">$418,726.43</span></span>|<span data-ttu-id="97f18-572">$123,929.46</span><span class="sxs-lookup"><span data-stu-id="97f18-572">$123,929.46</span></span>|<span data-ttu-id="97f18-573">$486,694.63</span><span class="sxs-lookup"><span data-stu-id="97f18-573">$486,694.63</span></span>|<span data-ttu-id="97f18-574">$475,521.93</span><span class="sxs-lookup"><span data-stu-id="97f18-574">$475,521.93</span></span>|  
|<span data-ttu-id="97f18-575">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-575">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-576">$1,573,655.14</span><span class="sxs-lookup"><span data-stu-id="97f18-576">$1,573,655.14</span></span>|<span data-ttu-id="97f18-577">$239,137.96</span><span class="sxs-lookup"><span data-stu-id="97f18-577">$239,137.96</span></span>|<span data-ttu-id="97f18-578">$319,921.61</span><span class="sxs-lookup"><span data-stu-id="97f18-578">$319,921.61</span></span>|<span data-ttu-id="97f18-579">$130,102.75</span><span class="sxs-lookup"><span data-stu-id="97f18-579">$130,102.75</span></span>|<span data-ttu-id="97f18-580">$420,445.84</span><span class="sxs-lookup"><span data-stu-id="97f18-580">$420,445.84</span></span>|<span data-ttu-id="97f18-581">$464,046.98</span><span class="sxs-lookup"><span data-stu-id="97f18-581">$464,046.98</span></span>|  
|<span data-ttu-id="97f18-582">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-582">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-583">$1,420,500.58</span><span class="sxs-lookup"><span data-stu-id="97f18-583">$1,420,500.58</span></span>|<span data-ttu-id="97f18-584">$192,320.16</span><span class="sxs-lookup"><span data-stu-id="97f18-584">$192,320.16</span></span>|<span data-ttu-id="97f18-585">$230,875.99</span><span class="sxs-lookup"><span data-stu-id="97f18-585">$230,875.99</span></span>|<span data-ttu-id="97f18-586">$117,044.49</span><span class="sxs-lookup"><span data-stu-id="97f18-586">$117,044.49</span></span>|<span data-ttu-id="97f18-587">$424,813.66</span><span class="sxs-lookup"><span data-stu-id="97f18-587">$424,813.66</span></span>|<span data-ttu-id="97f18-588">$455,446.27</span><span class="sxs-lookup"><span data-stu-id="97f18-588">$455,446.27</span></span>|  
|<span data-ttu-id="97f18-589">Road-150 Red, 56</span><span class="sxs-lookup"><span data-stu-id="97f18-589">Road-150 Red, 56</span></span>|<span data-ttu-id="97f18-590">$1,424,867.11</span><span class="sxs-lookup"><span data-stu-id="97f18-590">$1,424,867.11</span></span>|<span data-ttu-id="97f18-591">$382,874.89</span><span class="sxs-lookup"><span data-stu-id="97f18-591">$382,874.89</span></span>|<span data-ttu-id="97f18-592">$302,721.64</span><span class="sxs-lookup"><span data-stu-id="97f18-592">$302,721.64</span></span>|<span data-ttu-id="97f18-593">$88,025.44</span><span class="sxs-lookup"><span data-stu-id="97f18-593">$88,025.44</span></span>|<span data-ttu-id="97f18-594">$243,322.36</span><span class="sxs-lookup"><span data-stu-id="97f18-594">$243,322.36</span></span>|<span data-ttu-id="97f18-595">$407,922.78</span><span class="sxs-lookup"><span data-stu-id="97f18-595">$407,922.78</span></span>|  
  
```  
SELECT [Sales Territory].[Sales Territory Region].MEMBERS on 0  
     , [Product].[Product].MEMBERS on 1  
  FROM (SELECT TOPCOUNT( [Sales Territory].[Sales Territory Region].CHILDREN, 5, [Measures].[Sales Amount]) ON 0  
          FROM (SELECT TOPCOUNT( [Product].[Product].CHILDREN, 5, [Measures].[Sales Amount]) on 0  
                  FROM [Adventure Works]  
               )  
        )  
 WHERE [Measures].[Sales Amount]  
```  
  
 <span data-ttu-id="97f18-596">返回以下结果。</span><span class="sxs-lookup"><span data-stu-id="97f18-596">Returned the following results.</span></span>  
  
||||||||  
|-|-|-|-|-|-|-|  
||<span data-ttu-id="97f18-597">All Sales Territories</span><span class="sxs-lookup"><span data-stu-id="97f18-597">All Sales Territories</span></span>|<span data-ttu-id="97f18-598">澳大利亚</span><span class="sxs-lookup"><span data-stu-id="97f18-598">Australia</span></span>|<span data-ttu-id="97f18-599">加拿大</span><span class="sxs-lookup"><span data-stu-id="97f18-599">Canada</span></span>|<span data-ttu-id="97f18-600">Northwest</span><span class="sxs-lookup"><span data-stu-id="97f18-600">Northwest</span></span>|<span data-ttu-id="97f18-601">Southwest</span><span class="sxs-lookup"><span data-stu-id="97f18-601">Southwest</span></span>|<span data-ttu-id="97f18-602">英国</span><span class="sxs-lookup"><span data-stu-id="97f18-602">United Kingdom</span></span>|  
|<span data-ttu-id="97f18-603">All Products</span><span class="sxs-lookup"><span data-stu-id="97f18-603">All Products</span></span>|<span data-ttu-id="97f18-604">$7,938,218.56</span><span class="sxs-lookup"><span data-stu-id="97f18-604">$7,938,218.56</span></span>|<span data-ttu-id="97f18-605">$1,096,312.24</span><span class="sxs-lookup"><span data-stu-id="97f18-605">$1,096,312.24</span></span>|<span data-ttu-id="97f18-606">$1,474,255.49</span><span class="sxs-lookup"><span data-stu-id="97f18-606">$1,474,255.49</span></span>|<span data-ttu-id="97f18-607">$2,042,674.72</span><span class="sxs-lookup"><span data-stu-id="97f18-607">$2,042,674.72</span></span>|<span data-ttu-id="97f18-608">$2,238,099.55</span><span class="sxs-lookup"><span data-stu-id="97f18-608">$2,238,099.55</span></span>|<span data-ttu-id="97f18-609">$1,086,876.56</span><span class="sxs-lookup"><span data-stu-id="97f18-609">$1,086,876.56</span></span>|  
|<span data-ttu-id="97f18-610">Mountain-200 Silver, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-610">Mountain-200 Silver, 38</span></span>|<span data-ttu-id="97f18-611">$1,520,958.53</span><span class="sxs-lookup"><span data-stu-id="97f18-611">$1,520,958.53</span></span>|<span data-ttu-id="97f18-612">$248,702.93</span><span class="sxs-lookup"><span data-stu-id="97f18-612">$248,702.93</span></span>|<span data-ttu-id="97f18-613">$275,052.45</span><span class="sxs-lookup"><span data-stu-id="97f18-613">$275,052.45</span></span>|<span data-ttu-id="97f18-614">$349,487.01</span><span class="sxs-lookup"><span data-stu-id="97f18-614">$349,487.01</span></span>|<span data-ttu-id="97f18-615">$435,230.12</span><span class="sxs-lookup"><span data-stu-id="97f18-615">$435,230.12</span></span>|<span data-ttu-id="97f18-616">$212,486.03</span><span class="sxs-lookup"><span data-stu-id="97f18-616">$212,486.03</span></span>|  
|<span data-ttu-id="97f18-617">Mountain-200 Silver, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-617">Mountain-200 Silver, 42</span></span>|<span data-ttu-id="97f18-618">$1,392,237.14</span><span class="sxs-lookup"><span data-stu-id="97f18-618">$1,392,237.14</span></span>|<span data-ttu-id="97f18-619">$198,127.15</span><span class="sxs-lookup"><span data-stu-id="97f18-619">$198,127.15</span></span>|<span data-ttu-id="97f18-620">$229,679.01</span><span class="sxs-lookup"><span data-stu-id="97f18-620">$229,679.01</span></span>|<span data-ttu-id="97f18-621">$361,233.58</span><span class="sxs-lookup"><span data-stu-id="97f18-621">$361,233.58</span></span>|<span data-ttu-id="97f18-622">$407,854.24</span><span class="sxs-lookup"><span data-stu-id="97f18-622">$407,854.24</span></span>|<span data-ttu-id="97f18-623">$195,343.16</span><span class="sxs-lookup"><span data-stu-id="97f18-623">$195,343.16</span></span>|  
|<span data-ttu-id="97f18-624">Mountain-200 Black, 38</span><span class="sxs-lookup"><span data-stu-id="97f18-624">Mountain-200 Black, 38</span></span>|<span data-ttu-id="97f18-625">$1,861,703.23</span><span class="sxs-lookup"><span data-stu-id="97f18-625">$1,861,703.23</span></span>|<span data-ttu-id="97f18-626">$218,024.05</span><span class="sxs-lookup"><span data-stu-id="97f18-626">$218,024.05</span></span>|<span data-ttu-id="97f18-627">$418,726.43</span><span class="sxs-lookup"><span data-stu-id="97f18-627">$418,726.43</span></span>|<span data-ttu-id="97f18-628">$486,694.63</span><span class="sxs-lookup"><span data-stu-id="97f18-628">$486,694.63</span></span>|<span data-ttu-id="97f18-629">$475,521.93</span><span class="sxs-lookup"><span data-stu-id="97f18-629">$475,521.93</span></span>|<span data-ttu-id="97f18-630">$262,736.19</span><span class="sxs-lookup"><span data-stu-id="97f18-630">$262,736.19</span></span>|  
|<span data-ttu-id="97f18-631">Mountain-200 Black, 42</span><span class="sxs-lookup"><span data-stu-id="97f18-631">Mountain-200 Black, 42</span></span>|<span data-ttu-id="97f18-632">$1,702,427.25</span><span class="sxs-lookup"><span data-stu-id="97f18-632">$1,702,427.25</span></span>|<span data-ttu-id="97f18-633">$239,137.96</span><span class="sxs-lookup"><span data-stu-id="97f18-633">$239,137.96</span></span>|<span data-ttu-id="97f18-634">$319,921.61</span><span class="sxs-lookup"><span data-stu-id="97f18-634">$319,921.61</span></span>|<span data-ttu-id="97f18-635">$420,445.84</span><span class="sxs-lookup"><span data-stu-id="97f18-635">$420,445.84</span></span>|<span data-ttu-id="97f18-636">$464,046.98</span><span class="sxs-lookup"><span data-stu-id="97f18-636">$464,046.98</span></span>|<span data-ttu-id="97f18-637">$258,874.87</span><span class="sxs-lookup"><span data-stu-id="97f18-637">$258,874.87</span></span>|  
|<span data-ttu-id="97f18-638">Mountain-200 Black, 46</span><span class="sxs-lookup"><span data-stu-id="97f18-638">Mountain-200 Black, 46</span></span>|<span data-ttu-id="97f18-639">$1,460,892.41</span><span class="sxs-lookup"><span data-stu-id="97f18-639">$1,460,892.41</span></span>|<span data-ttu-id="97f18-640">$192,320.16</span><span class="sxs-lookup"><span data-stu-id="97f18-640">$192,320.16</span></span>|<span data-ttu-id="97f18-641">$230,875.99</span><span class="sxs-lookup"><span data-stu-id="97f18-641">$230,875.99</span></span>|<span data-ttu-id="97f18-642">$424,813.66</span><span class="sxs-lookup"><span data-stu-id="97f18-642">$424,813.66</span></span>|<span data-ttu-id="97f18-643">$455,446.27</span><span class="sxs-lookup"><span data-stu-id="97f18-643">$455,446.27</span></span>|<span data-ttu-id="97f18-644">$157,436.31</span><span class="sxs-lookup"><span data-stu-id="97f18-644">$157,436.31</span></span>|  
  
 <span data-ttu-id="97f18-645">正如您所看到的，在这两个结果集之间存在差异。</span><span class="sxs-lookup"><span data-stu-id="97f18-645">As you can see there are differences in the results between both sets.</span></span> <span data-ttu-id="97f18-646">第一个查询指明在前 5 个销售区域中哪些产品的销量最高；第二个查询指明对于前 5 种销售产品哪些区域的销量最高。</span><span class="sxs-lookup"><span data-stu-id="97f18-646">The first query answered the question of which are the best selling products in the top 5 selling regions, the second query answered the question of where are the largest sales of the top 5 selling products.</span></span>  
  
### <a name="remarks"></a><span data-ttu-id="97f18-647">备注</span><span class="sxs-lookup"><span data-stu-id="97f18-647">Remarks</span></span>  
 <span data-ttu-id="97f18-648">嵌套 select 语句具有以下限制：</span><span class="sxs-lookup"><span data-stu-id="97f18-648">Subselects have the following restrictions and limitations:</span></span>  
  
-   <span data-ttu-id="97f18-649">WHERE 子句不筛选子空间。</span><span class="sxs-lookup"><span data-stu-id="97f18-649">The WHERE clause does not filter the subspace.</span></span>  
  
-   <span data-ttu-id="97f18-650">WHERE 子句仅更改子多维数据集中的默认成员。</span><span class="sxs-lookup"><span data-stu-id="97f18-650">The WHERE clause changes the default member in the sub cube only.</span></span>  
  
-   <span data-ttu-id="97f18-651">轴子句中不允许 NON EMPTY 子句；请改用 [NonEmpty (MDX)](/sql/mdx/nonempty-mdx) 函数表达式。</span><span class="sxs-lookup"><span data-stu-id="97f18-651">The NON EMPTY clause is not allowed in an axis clause; use a [NonEmpty &#40;MDX&#41;](/sql/mdx/nonempty-mdx) function expression instead.</span></span>  
  
-   <span data-ttu-id="97f18-652">轴子句中不允许 HAVING 子句；请改用 [Filter (MDX)](/sql/mdx/filter-mdx) 函数表达式。</span><span class="sxs-lookup"><span data-stu-id="97f18-652">The HAVING clause is not allowed in an axis clause; use a [Filter &#40;MDX&#41;](/sql/mdx/filter-mdx) function expression instead.</span></span>  
  
-   <span data-ttu-id="97f18-653">默认情况下，嵌套 select 语句中不允许使用计算成员;但是，可以按会话更改此限制，方法是在 `SubQueries` <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A> 支持的 `DBPROP_MSMD_SUBQUERIES` [xmla 属性 &#40;xmla&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/propertylist-element-supported-xmla-properties)中，通过将值分配给或属性中的连接字符串属性。</span><span class="sxs-lookup"><span data-stu-id="97f18-653">By default calculated members are not allowed in subselects; however, this restriction can be changed, in a per session basis, by assigning a value to the `SubQueries` connection string property in <xref:Microsoft.AnalysisServices.AdomdClient.AdomdConnection.ConnectionString%2A> or `DBPROP_MSMD_SUBQUERIES` property in [Supported XMLA Properties &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/propertylist-element-supported-xmla-properties).</span></span> <span data-ttu-id="97f18-654">有关计算成员行为的详细说明，请参阅[嵌套 select 语句和子多维数据中的计算成员](calculated-members-in-subselects-and-subcubes.md)，具体取决于或的值 `SubQueries` `DBPROP_MSMD_SUBQUERIES` 。</span><span class="sxs-lookup"><span data-stu-id="97f18-654">See [Calculated Members in Subselects and Subcubes](calculated-members-in-subselects-and-subcubes.md) for a detailed explanation of the behavior of calculated members depending on the values of `SubQueries` or `DBPROP_MSMD_SUBQUERIES`.</span></span>  
  
  
