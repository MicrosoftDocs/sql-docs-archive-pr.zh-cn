---
title: Analysis Services 开发的客户端体系结构要求 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- local mining models [Analysis Services]
- Analysis Services, architecture
- providers [Analysis Services]
- data pumps [Analysis Services]
- client architecture [Analysis Services]
- local cubes [Analysis Services]
ms.assetid: 03a8eb6b-159f-4a0a-afbe-06a2424b6090
author: minewiskan
ms.author: owend
ms.openlocfilehash: d1dae97cc76eb09ce0ac4ef9d61d571a6d10c1bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589291"
---
# <a name="client-architecture-requirements-for-analysis-services-development"></a><span data-ttu-id="5a7ec-102">Analysis Services 开发的客户端体系结构要求</span><span class="sxs-lookup"><span data-stu-id="5a7ec-102">Client Architecture Requirements for Analysis Services Development</span></span>
  [!INCLUDE[msCoName](../../../includes/msconame-md.md)]<span data-ttu-id="5a7ec-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 支持瘦客户端体系结构。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] supports a thin-client architecture.</span></span> <span data-ttu-id="5a7ec-104">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]计算引擎是完全基于服务器的，因此在服务器上解析了所有查询。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-104">The [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] calculation engine is entirely server-based, so all queries are resolved on the server.</span></span> <span data-ttu-id="5a7ec-105">因此，每个查询只需在客户端和服务器之间进行一次来回行程，从而使得性能可以随着查询复杂性的增加而伸缩。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-105">As a result, only a single round trip between the client and the server is required for each query, resulting in scalable performance as queries increase in complexity.</span></span>

 <span data-ttu-id="5a7ec-106">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 的本机协议为 XML for Analysis (XML/A)。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-106">The native protocol for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] is XML for Analysis (XML/A).</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a7ec-107">为客户端应用程序提供了数个数据访问接口，但是所有这些组件都使用 XML for Analysis 与 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 实例进行通信。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-107">provides several data access interfaces for client applications, but all of these components communicate with an instance of [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] using XML for Analysis.</span></span>

 <span data-ttu-id="5a7ec-108">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 提供了数个不同的访问接口，以支持不同的编程语言。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-108">Several different providers are provided with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] to support different programming languages.</span></span> <span data-ttu-id="5a7ec-109">访问接口借助 Internet 信息服务 (IIS)，并通过 TCP/IP 或 HTTP 发送和接收 SOAP 数据包中的 XML for Analysis 来与 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 服务器进行通信。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-109">A provider communicates with an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server by sending and receiving XML for Analysis in SOAP packets over TCP/IP or over HTTP through Internet Information Services (IIS).</span></span> <span data-ttu-id="5a7ec-110">HTTP 连接使用由 IIS 实例化的 COM 对象（称为数据抽取），该对象充当 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 数据的管道。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-110">An HTTP connection uses a COM object instantiated by IIS, called a data pump, which acts as a conduit for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] data.</span></span> <span data-ttu-id="5a7ec-111">数据抽取既不会以任何方式检查包含在 HTTP 流中的基础数据，也不会检查可用于数据库本身中任何代码的任何基础数据结构。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-111">The data pump does not examine the underlying data contained in the HTTP stream in any way, nor are any of the underlying data structures available to any of the code in the data library itself.</span></span>

 <span data-ttu-id="5a7ec-112">![Analysis Services 的逻辑客户端体系结构](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Analysis Services 的逻辑客户端体系结构")</span><span class="sxs-lookup"><span data-stu-id="5a7ec-112">![Logical client architecture for Analysis Services](../../../analysis-services/dev-guide/media/as-clientarch9.gif "Logical client architecture for Analysis Services")</span></span>

 <span data-ttu-id="5a7ec-113">Win32 客户端应用程序可使用 OLE DB for OLAP 接口或用于组件对象模型 (COM) 自动化语言（如 Microsoft Visual Basic®）的 Microsoft® ActiveX® 数据对象 (ADO) 对象模型连接到 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 服务器。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-113">Win32 client applications can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using OLE DB for OLAP interfaces or the Microsoft® ActiveX® Data Objects (ADO) object model for Component Object Model (COM) automation languages, such as Microsoft Visual Basic®.</span></span> <span data-ttu-id="5a7ec-114">以 .NET 语言编码的应用程序可以使用 ADOMD.NET 连接到 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 服务器。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-114">Applications coded with .NET languages can connect to an [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] server using ADOMD.NET.</span></span>

 <span data-ttu-id="5a7ec-115">现有的应用程序只需使用一个 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 访问接口便可在不进行修改的情况下与 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 进行通信。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-115">Existing applications can communicate with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without modification simply by using one of the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] providers.</span></span>

|<span data-ttu-id="5a7ec-116">编程语言</span><span class="sxs-lookup"><span data-stu-id="5a7ec-116">Programming Language</span></span>|<span data-ttu-id="5a7ec-117">数据访问接口</span><span class="sxs-lookup"><span data-stu-id="5a7ec-117">Data Access Interface</span></span>|
|--------------------------|---------------------------|
|<span data-ttu-id="5a7ec-118">C++</span><span class="sxs-lookup"><span data-stu-id="5a7ec-118">C++</span></span>|<span data-ttu-id="5a7ec-119">OLE DB for OLAP</span><span class="sxs-lookup"><span data-stu-id="5a7ec-119">OLE DB for OLAP</span></span>|
|<span data-ttu-id="5a7ec-120">Visual Basic 6</span><span class="sxs-lookup"><span data-stu-id="5a7ec-120">Visual Basic 6</span></span>|<span data-ttu-id="5a7ec-121">ADO MD</span><span class="sxs-lookup"><span data-stu-id="5a7ec-121">ADO MD</span></span>|
|<span data-ttu-id="5a7ec-122">.NET 语言</span><span class="sxs-lookup"><span data-stu-id="5a7ec-122">.NET languages</span></span>|<span data-ttu-id="5a7ec-123">ADO MD.NET</span><span class="sxs-lookup"><span data-stu-id="5a7ec-123">ADO MD.NET</span></span>|
|<span data-ttu-id="5a7ec-124">支持 SOAP 的任何语言</span><span class="sxs-lookup"><span data-stu-id="5a7ec-124">Any language that supports SOAP</span></span>|<span data-ttu-id="5a7ec-125">XML for Analysis</span><span class="sxs-lookup"><span data-stu-id="5a7ec-125">XML for Analysis</span></span>|

 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a7ec-126">的 Web 体系结构具有完全可伸缩的中间层，可方便小型和大型组织进行部署。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-126">has a Web architecture with a fully scalable middle tier for deployment by both small and large organizations.</span></span> [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="5a7ec-127">为 Web 服务提供了广泛的中间层支持。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-127">provides broad middle tier support for Web services.</span></span> <span data-ttu-id="5a7ec-128">OLE DB for OLAP 和 ADO MD 支持 ASP 应用程序，ADOMD.NET 支持 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-128">ASP applications are supported by OLE DB for OLAP and ADO MD, ASP.NET applications are supported by ADOMD.NET.</span></span> <span data-ttu-id="5a7ec-129">中间层（如下图中所示）可进行伸缩以供众多并发用户使用。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-129">The middle tier, illustrated in the following figure, is scalable to many concurrent users.</span></span>

 <span data-ttu-id="5a7ec-130">![中间层体系结构的逻辑关系图](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "中间层体系结构的逻辑关系图")</span><span class="sxs-lookup"><span data-stu-id="5a7ec-130">![Logical diagram for middle-tier architecture](../../../analysis-services/dev-guide/media/as-midtierarch9.gif "Logical diagram for middle-tier architecture")</span></span>

 <span data-ttu-id="5a7ec-131">客户端应用程序和中间层应用程序都可以不通过访问接口而直接与 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 进行通信。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-131">Both client and middle tier applications can communicate directly with [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] without using a provider.</span></span> <span data-ttu-id="5a7ec-132">客户端应用程序和中间层应用程序可以通过 TCP/IP、HTTP 或 HTTPS 使用 SOAP 数据包发送 XML for Analysis。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-132">Client and middle tier applications may send XML for Analysis in SOAP packets over TCP/IP, HTTP, or HTTPS.</span></span> <span data-ttu-id="5a7ec-133">客户端可以使用任何支持 SOAP 的语言进行编码。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-133">The client may be coded using any language that supports SOAP.</span></span> <span data-ttu-id="5a7ec-134">在这种情况下，尽管也可对使用 TCP/IP 与服务器建立的直接连接进行编码，但通信可由 Internet Information Services (IIS) 使用 HTTP 以最轻松的方式进行管理。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-134">Communication in this case is most easily managed by Internet Information Services (IIS) using HTTP, although a direct connection to the server using TCP/IP may also be coded.</span></span> <span data-ttu-id="5a7ec-135">这是最不可能实现的 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 客户端解决方案。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-135">This is the thinnest possible client solution for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)].</span></span>

## <a name="analysis-services-in-tabular-or-sharepoint-mode"></a><span data-ttu-id="5a7ec-136">表格或 SharePoint 模式下的 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="5a7ec-136">Analysis Services in Tabular or SharePoint Mode</span></span>
 <span data-ttu-id="5a7ec-137">在 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 中，对于已发布到 SharePoint 站点的表格数据库和 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 工作簿，可在 xVelocity 内存中分析引擎 (VertiPaq) 模式下启动服务器。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-137">In [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], the server can be started in xVelocity in-memory analytics engine (VertiPaq) mode for tabular databases and for [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbooks that have been published to a SharePoint site.</span></span>

 [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] <span data-ttu-id="5a7ec-138">和 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] 是支持创建和查询分别使用 SharePoint 或表格模式的内存中数据库的唯一客户端环境。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-138">and [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)] are the only client environments that are supported for creating and querying in-memory databases that use SharePoint or Tabular mode, respectively.</span></span> <span data-ttu-id="5a7ec-139">使用 Excel 和工具创建的嵌入 PowerPivot 数据库 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 包含在 excel 工作簿中，并作为 excel .xlsx 文件的一部分保存。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-139">The embedded PowerPivot database that you create by using the Excel and [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] tools is contained within the Excel workbook, and is saved as part of the Excel .xlsx file.</span></span>

 <span data-ttu-id="5a7ec-140">但是，如果您将多维数据集数据导入到某一 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 工作簿中，则该工作簿可以使用在传统多维数据集中存储的数据。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-140">However, a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook can use data that is stored in a traditional cube if you import the cube data into the workbook.</span></span> <span data-ttu-id="5a7ec-141">如果其他 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 工作簿已发布到某一 SharePoint 站点，您还可以从该工作簿中导入数据。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-141">You can also import data from another [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook if it has been published to a SharePoint site.</span></span>

> [!NOTE]
>  <span data-ttu-id="5a7ec-142">当您使用某一多维数据集作为 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] 工作簿的数据源时，您从该多维数据集获取的数据将定义为 MDX 查询；但是，该数据将作为平展的快照导入。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-142">When you use a cube as a data source for a [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] workbook, the data that you get from the cube is defined as an MDX query; however, the data is imported as a flattened snapshot.</span></span> <span data-ttu-id="5a7ec-143">您不能以交互方式使用数据或刷新来自多维数据集的数据。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-143">You cannot interactively work with the data or refresh the data from the cube.</span></span>

### <a name="interfaces-for-powerpivot-client"></a><span data-ttu-id="5a7ec-144">PowerPivot 客户端的接口</span><span class="sxs-lookup"><span data-stu-id="5a7ec-144">Interfaces for PowerPivot Client</span></span>
 [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]<span data-ttu-id="5a7ec-145">使用用于 Analysis Services 的已建立接口和语言，与 xVelocity 内存中分析引擎进行交互， (VertiPaq) 存储引擎。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-145">interacts with the xVelocity in-memory analytics engine (VertiPaq) storage engine within the workbook by using the established interfaces and languages for Analysis Services: AMO and ADOMD.NET, and MDX and XMLA.</span></span> <span data-ttu-id="5a7ec-146">在该外接程序内，通过使用与 Excel、数据分析表达式 (DAX) 类似的公式语言定义度量值。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-146">Within the add-in, measures are defined by using a formula language similar to Excel, Data Analysis Expressions (DAX).</span></span> <span data-ttu-id="5a7ec-147">DAX 表达式嵌入在发送到进程内服务器的 XMLA 消息内。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-147">DAX expressions are embedded within the XMLA messages that are sent to the in-process server.</span></span>

### <a name="providers"></a><span data-ttu-id="5a7ec-148">提供程序</span><span class="sxs-lookup"><span data-stu-id="5a7ec-148">Providers</span></span>
 <span data-ttu-id="5a7ec-149">[!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)]和 Excel 之间的通信使用 MSOLAP OLEDB 访问接口 (版本 11.0) 。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-149">Communications between [!INCLUDE[ssGemini](../../../includes/ssgemini-md.md)] and Excel use the MSOLAP OLEDB provider (version 11.0).</span></span> <span data-ttu-id="5a7ec-150">在 MSOLAP 访问接口内，有四个可用于在客户端和服务器之间发送消息的不同的模块或传输。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-150">Within the MSOLAP provider, there are four different modules, or transports, that can be used for sending messages between the client and server.</span></span>

 <span data-ttu-id="5a7ec-151">**TCP/IP**用于正常的客户端-服务器连接。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-151">**TCP/IP** Used for normal client-server connections.</span></span>

 <span data-ttu-id="5a7ec-152">**HTTP**用于通过 SSAS 数据抽取服务的 HTTP 连接，或通过调用 SharePoint PowerPivot Web Service (WS) 组件。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-152">**HTTP** Used for HTTP connections via the SSAS data pump service, or by a call to the SharePoint PowerPivot Web Service (WS) component.</span></span>

 <span data-ttu-id="5a7ec-153">**INPROC**用于与进程内引擎的连接。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-153">**INPROC** Used for connections to the in-process engine.</span></span>

 <span data-ttu-id="5a7ec-154">**通道**保留此项以便与 SharePoint 场中的 PowerPivot 系统服务进行通信。</span><span class="sxs-lookup"><span data-stu-id="5a7ec-154">**CHANNEL** Reserved for communications with the PowerPivot System Service in the SharePoint farm.</span></span>

## <a name="see-also"></a><span data-ttu-id="5a7ec-155">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5a7ec-155">See Also</span></span>
 [<span data-ttu-id="5a7ec-156">OLAP 引擎服务器组件</span><span class="sxs-lookup"><span data-stu-id="5a7ec-156">OLAP Engine Server Components</span></span>](olap-engine-server-components.md)


