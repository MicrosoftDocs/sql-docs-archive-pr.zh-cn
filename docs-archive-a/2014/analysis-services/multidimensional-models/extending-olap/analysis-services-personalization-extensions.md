---
title: Analysis Services 个性化设置扩展 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- personalization extensions [Multidimensional Databases]
ms.assetid: 0f144059-24e0-40c0-bde4-d48c75e46598
author: minewiskan
ms.author: owend
ms.openlocfilehash: 0cd36cb2882659bff902d9830af0c5acefd98444
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591607"
---
# <a name="analysis-services-personalization-extensions"></a><span data-ttu-id="b305e-102">Analysis Services 个性化设置扩展</span><span class="sxs-lookup"><span data-stu-id="b305e-102">Analysis Services Personalization Extensions</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="b305e-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]个性化设置扩展是实现插件体系结构的理念的基础。</span><span class="sxs-lookup"><span data-stu-id="b305e-103">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are the foundation of the idea of implementing a plug-in architecture.</span></span> <span data-ttu-id="b305e-104">在插件体系结构中，您可以动态地开发新的多维数据集对象和功能，并可以与其他开发人员方便地共享。</span><span class="sxs-lookup"><span data-stu-id="b305e-104">In a plug-in architecture, you can develop new cube objects and functionality dynamically and share them easily with other developers.</span></span> <span data-ttu-id="b305e-105">因此， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 个性化设置扩展提供了可实现以下目的的功能：</span><span class="sxs-lookup"><span data-stu-id="b305e-105">As such, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions provide the functionality that makes it possible to achieve the following:</span></span>  
  
-   <span data-ttu-id="b305e-106">**动态设计和部署**设计和部署 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 个性化设置扩展后，用户可以在下一个用户会话开始时访问对象和功能。</span><span class="sxs-lookup"><span data-stu-id="b305e-106">**Dynamic design and deployment** Immediately after you design and deploy [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users have access to the objects and functionality at the start of the next user session.</span></span>  
  
-   <span data-ttu-id="b305e-107">**接口独立性**无论你用来创建 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 个性化设置扩展的接口如何，用户都可以使用任何接口访问对象和功能。</span><span class="sxs-lookup"><span data-stu-id="b305e-107">**Interface independence** Regardless of the interface that you use to create the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions, users can use any interface to access the objects and functionality.</span></span>  
  
-   <span data-ttu-id="b305e-108">**会话上下文** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]个性化设置扩展不是现有基础结构中的永久对象，不需要重新处理多维数据集。</span><span class="sxs-lookup"><span data-stu-id="b305e-108">**Session context** [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions are not permanent objects in the existing infrastructure and do not require the cube to be reprocessed.</span></span> <span data-ttu-id="b305e-109">在用户连接到数据库时，它们将公开并为该用户创建，并在整个用户会话期间保持可用。</span><span class="sxs-lookup"><span data-stu-id="b305e-109">They become exposed and created for the user at the time that the user connects to the database, and remain available for the length of that user session.</span></span>  
  
-   <span data-ttu-id="b305e-110">**快速分发**[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]与其他软件开发人员共享个性化设置扩展，无需深入了解如何查找此扩展功能的详细规范。</span><span class="sxs-lookup"><span data-stu-id="b305e-110">**Rapid distribution** Share [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions with other software developers without having to go into detailed specifications about where or how to find this extended functionality.</span></span>  
  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="b305e-111">个性化设置扩展具有多种用途。</span><span class="sxs-lookup"><span data-stu-id="b305e-111">personalization extensions have many uses.</span></span> <span data-ttu-id="b305e-112">例如，您的公司的销售涉及到多种货币。</span><span class="sxs-lookup"><span data-stu-id="b305e-112">For example, your company has sales that involve different currencies.</span></span> <span data-ttu-id="b305e-113">您可创建一个计算成员，以本地货币返回访问此多维数据集的人员的总销售额。</span><span class="sxs-lookup"><span data-stu-id="b305e-113">You create a calculated member that returns the consolidated sales in the local currency of the person who is accessing the cube.</span></span> <span data-ttu-id="b305e-114">首先要此成员创建为个性化设置扩展。</span><span class="sxs-lookup"><span data-stu-id="b305e-114">You create this member as a personalization extension.</span></span> <span data-ttu-id="b305e-115">然后，将此计算成员与一组用户共享。</span><span class="sxs-lookup"><span data-stu-id="b305e-115">You then share this calculated member to a group of users.</span></span> <span data-ttu-id="b305e-116">共享后，这些用户一连接到服务器就可以立即访问该计算成员。</span><span class="sxs-lookup"><span data-stu-id="b305e-116">Once shared, those users have immediate access to the calculated member as soon as they connect to the server.</span></span> <span data-ttu-id="b305e-117">即使用户使用的接口不是用于创建该计算成员的接口，也可以访问该计算成员。</span><span class="sxs-lookup"><span data-stu-id="b305e-117">They have access even if they are not using the same interface as the one that was used to create the calculated member.</span></span>  
  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)]<span data-ttu-id="b305e-118">个性化设置扩展是对现有托管程序集体系结构的简单、精致的修改，并在整个 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] [microsoft.analysisservices.sharepoint.integration.dll AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120))对象模型、多维表达式 (MDX) 语法和架构行集中公开。</span><span class="sxs-lookup"><span data-stu-id="b305e-118">personalization extensions are a simple and elegant modification to the existing managed assembly architecture and are exposed throughout the [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model, Multidimensional Expressions (MDX) syntax, and schema rowsets.</span></span>  
  
## <a name="logical-architecture"></a><span data-ttu-id="b305e-119">逻辑体系结构</span><span class="sxs-lookup"><span data-stu-id="b305e-119">Logical Architecture</span></span>  
 <span data-ttu-id="b305e-120">[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 个性化设置扩展的体系结构以托管程序集体系结构以及以下四个基本元素为基础：</span><span class="sxs-lookup"><span data-stu-id="b305e-120">The architecture for [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions is based on the managed assembly architecture and the following four basic elements:</span></span>  
  
 <span data-ttu-id="b305e-121">[PlugInAttribute] 自定义属性</span><span class="sxs-lookup"><span data-stu-id="b305e-121">The [PlugInAttribute] custom attribute</span></span>  
 <span data-ttu-id="b305e-122">启动服务时， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 将加载所需的程序集，并确定哪些类具有[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))自定义属性。</span><span class="sxs-lookup"><span data-stu-id="b305e-122">When starting the service, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] loads the required assemblies and determines which classes have the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b305e-123">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 将定义自定义属性作为描述代码及影响运行时行为的方式。</span><span class="sxs-lookup"><span data-stu-id="b305e-123">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] defines custom attributes as a way to describe your code and affect run-time behavior.</span></span> <span data-ttu-id="b305e-124">有关详细信息，请参阅 MSDN 上的开发人员指南中的 "[属性概述](https://go.microsoft.com/fwlink/?LinkId=82929)" 主题 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="b305e-124">For more information, see the topic, "[Attributes Overview](https://go.microsoft.com/fwlink/?LinkId=82929)," in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Developer's Guide on MSDN.</span></span>  
  
 <span data-ttu-id="b305e-125">对于包含[microsoft.analysisservices.sharepoint.integration.dll. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))自定义属性的所有类，将 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 调用其默认构造函数。</span><span class="sxs-lookup"><span data-stu-id="b305e-125">For all classes with the [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)) custom attribute, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] invokes their default constructors.</span></span> <span data-ttu-id="b305e-126">在启动时调用所有构造函数会提供一个共用位置，从该位置可不受任何用户活动干扰地生成新对象。</span><span class="sxs-lookup"><span data-stu-id="b305e-126">Invoking all the constructors at startup provides a common location from which to build new objects and that is independent of any user activity.</span></span>  
  
 <span data-ttu-id="b305e-127">除了生成有关创作和管理个性化设置扩展的小型信息缓存外，类构造函数通常还会订阅 SessionOpened 和[microsoft.analysisservices.sharepoint.integration.dll](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))事件。 [microsoft.analysisservices.sharepoint.integration.dll](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) . AdomdServer 事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-127">In addition to building a small cache of information about authoring and managing personalization extensions, the class constructor typically subscribes to the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) and [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) events.</span></span> <span data-ttu-id="b305e-128">未能订阅这些事件可能会导致将类错误地标记为由公共语言运行时 (CLR) 垃圾收集器进行清理。</span><span class="sxs-lookup"><span data-stu-id="b305e-128">Failing to subscribe to these events may cause the class to be inappropriately marked for cleanup by the common language runtime (CLR) garbage collector.</span></span>  
  
 <span data-ttu-id="b305e-129">会话上下文</span><span class="sxs-lookup"><span data-stu-id="b305e-129">Session context</span></span>  
 <span data-ttu-id="b305e-130">对于基于个性化设置扩展的那些对象，[!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 会在客户端会话期间创建执行环境，并在此环境中动态地生成大多数对象。</span><span class="sxs-lookup"><span data-stu-id="b305e-130">For those objects that are based on personalization extensions, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates an execution environment during the client session and dynamically builds most of those objects in this environment.</span></span> <span data-ttu-id="b305e-131">与其他任何 CLR 程序集一样，此执行环境还可以访问其他函数和存储过程。</span><span class="sxs-lookup"><span data-stu-id="b305e-131">Like any other CLR assembly, this execution environment also has access to other functions and stored procedures.</span></span> <span data-ttu-id="b305e-132">用户会话结束时， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 将删除动态创建的对象并关闭执行环境。</span><span class="sxs-lookup"><span data-stu-id="b305e-132">When the user session ends, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] removes the dynamically created objects and closes the execution environment.</span></span>  
  
 <span data-ttu-id="b305e-133">事件</span><span class="sxs-lookup"><span data-stu-id="b305e-133">Events</span></span>  
 <span data-ttu-id="b305e-134">对象创建是由会话事件 `On-Cube-OpenedCubeOpened` 和 `On-Cube-ClosingCubeClosing` 触发的。</span><span class="sxs-lookup"><span data-stu-id="b305e-134">Object creation is triggered by the session events `On-Cube-OpenedCubeOpened` and `On-Cube-ClosingCubeClosing`.</span></span>  
  
 <span data-ttu-id="b305e-135">客户端与服务器之间的通信是通过特定事件发生的。</span><span class="sxs-lookup"><span data-stu-id="b305e-135">Communication between the client and the server occurs through specific events.</span></span> <span data-ttu-id="b305e-136">这些事件使客户端了解会导致生成客户端对象的情况。</span><span class="sxs-lookup"><span data-stu-id="b305e-136">These events make the client aware of the situations that lead to the client's objects being built.</span></span> <span data-ttu-id="b305e-137">客户端环境是使用两种事件动态创建的：会话事件和多维数据集事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-137">The client's environment is dynamically created using two sets of events: session events and cube events.</span></span>  
  
 <span data-ttu-id="b305e-138">会话事件与服务器对象关联。</span><span class="sxs-lookup"><span data-stu-id="b305e-138">Session events are associated with the server object.</span></span> <span data-ttu-id="b305e-139">当客户端登录到服务器时，将 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 创建一个会话并触发[Microsoft.analysisservices.sharepoint.integration.dll. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-139">When a client logs on to a server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] creates a session and triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span> <span data-ttu-id="b305e-140">当客户端在服务器上结束会话时， [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 将触发[Microsoft.analysisservices.sharepoint.integration.dll. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-140">When a client ends the session on the server, [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] triggers the [Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="b305e-141">多维数据集事件与连接对象关联。</span><span class="sxs-lookup"><span data-stu-id="b305e-141">Cube events are associated with the connection object.</span></span> <span data-ttu-id="b305e-142">连接到多维数据集会触发[microsoft.analysisservices.sharepoint.integration.dll. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-142">Connecting to a cube triggers the [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120)) event.</span></span> <span data-ttu-id="b305e-143">关闭多维数据集的连接或通过更改为不同的多维数据集，就会触发[microsoft.analysisservices.sharepoint.integration.dll. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))事件。</span><span class="sxs-lookup"><span data-stu-id="b305e-143">Closing the connection to a cube, by either closing the cube or by changing to a different cube, triggers a [Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120)) event.</span></span>  
  
 <span data-ttu-id="b305e-144">可跟踪性和错误处理</span><span class="sxs-lookup"><span data-stu-id="b305e-144">Traceability and error handling</span></span>  
 <span data-ttu-id="b305e-145">使用 [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)] 可跟踪所有活动。</span><span class="sxs-lookup"><span data-stu-id="b305e-145">All activity is traceable by using [!INCLUDE[ssSqlProfiler](../../../includes/sssqlprofiler-md.md)].</span></span> <span data-ttu-id="b305e-146">未处理的错误会报告给 Windows 事件日志。</span><span class="sxs-lookup"><span data-stu-id="b305e-146">Unhandled errors are reported to the Windows event log.</span></span>  
  
 <span data-ttu-id="b305e-147">所有对象的创作和管理都是独立于此体系结构，是对象的开发人员的唯一责任。</span><span class="sxs-lookup"><span data-stu-id="b305e-147">All object authoring and management is independent of this architecture and is the sole responsibility of the developers of the objects.</span></span>  
  
## <a name="infrastructure-foundations"></a><span data-ttu-id="b305e-148">基础结构基础</span><span class="sxs-lookup"><span data-stu-id="b305e-148">Infrastructure Foundations</span></span>  
 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] <span data-ttu-id="b305e-149">个性化设置扩展基于现有组件。</span><span class="sxs-lookup"><span data-stu-id="b305e-149">personalization extensions are based on existing components.</span></span> <span data-ttu-id="b305e-150">下面简要列出了提供个性化设置扩展功能的增强功能和改进功能。</span><span class="sxs-lookup"><span data-stu-id="b305e-150">The following is a summary of enhancements and improvements that provide the personalization extensions functionality.</span></span>  
  
### <a name="assemblies"></a><span data-ttu-id="b305e-151">程序集</span><span class="sxs-lookup"><span data-stu-id="b305e-151">Assemblies</span></span>  
 <span data-ttu-id="b305e-152">自定义特性[microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120))可添加到自定义程序集以标识 [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] 个性化设置扩展类。</span><span class="sxs-lookup"><span data-stu-id="b305e-152">The custom attribute, [Microsoft.AnalysisServices.AdomdServer.PlugInAttribute](/previous-versions/sql/sql-server-2014/bb678014(v=sql.120)), can be added to your custom assemblies to identify [!INCLUDE[ssASnoversion](../../../includes/ssasnoversion-md.md)] personalization extensions classes.</span></span>  
  
### <a name="changes-to-the-adomdserver-object-model"></a><span data-ttu-id="b305e-153">对 AdomdServer 对象模型的更改</span><span class="sxs-lookup"><span data-stu-id="b305e-153">Changes to the AdomdServer Object Model</span></span>  
 <span data-ttu-id="b305e-154">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120))对象模型中的以下对象已增强或已添加到模型中。</span><span class="sxs-lookup"><span data-stu-id="b305e-154">The following objects in the [Microsoft.AnalysisServices.AdomdServer](/previous-versions/sql/sql-server-2014/ms131779(v=sql.120)) object model have been enhanced or added to the model.</span></span>  
  
#### <a name="new-adomdconnection-class"></a><span data-ttu-id="b305e-155">新增 AdomdConnection 类</span><span class="sxs-lookup"><span data-stu-id="b305e-155">New AdomdConnection Class</span></span>  
 <span data-ttu-id="b305e-156">[AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120))类是新增的，并通过属性和事件公开了多个个性化设置扩展。</span><span class="sxs-lookup"><span data-stu-id="b305e-156">The [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) class is new and exposes several personalization extensions through both properties and events.</span></span>  
  
 <span data-ttu-id="b305e-157">**属性**</span><span class="sxs-lookup"><span data-stu-id="b305e-157">**Properties**</span></span>  
  
-   <span data-ttu-id="b305e-158">[AdomdConnection \*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120))，表示当前连接的会话 Id 的只读字符串值。 microsoft.analysisservices.sharepoint.integration.dll \*。</span><span class="sxs-lookup"><span data-stu-id="b305e-158">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.SessionID\*](/previous-versions/sql/sql-server-2014/bb678099(v=sql.120)), a read-only string value representing the session Id of the current connection.</span></span>  
  
-   <span data-ttu-id="b305e-159">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. AdomdConnection. ClientCulture \*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120))，对与当前会话关联的客户端区域性的只读引用。</span><span class="sxs-lookup"><span data-stu-id="b305e-159">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.ClientCulture\*](/previous-versions/sql/sql-server-2014/bb677433(v=sql.120)), a read-only reference to the client culture associated with current session.</span></span>  
  
-   <span data-ttu-id="b305e-160">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. AdomdConnection \*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120))，表示当前用户的标识接口的只读引用。</span><span class="sxs-lookup"><span data-stu-id="b305e-160">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.User\*](/previous-versions/sql/sql-server-2014/bb630315(v=sql.120)), a read-only reference to the identity interface representing the current user.</span></span>  
  
 <span data-ttu-id="b305e-161">**事件**</span><span class="sxs-lookup"><span data-stu-id="b305e-161">**Events**</span></span>  
  
-   <span data-ttu-id="b305e-162">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. AdomdConnection. CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="b305e-162">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeOpened](/previous-versions/sql/sql-server-2014/bb630581(v=sql.120))</span></span>  
  
-   <span data-ttu-id="b305e-163">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. AdomdConnection. CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="b305e-163">[Microsoft.AnalysisServices.AdomdServer.AdomdConnection.CubeClosing](/previous-versions/sql/sql-server-2014/bb630371(v=sql.120))</span></span>  
  
#### <a name="new-properties-in-the-context-class"></a><span data-ttu-id="b305e-164">上下文类中的新增属性</span><span class="sxs-lookup"><span data-stu-id="b305e-164">New Properties in the Context class</span></span>  
 <span data-ttu-id="b305e-165">[Microsoft.analysisservices.sharepoint.integration.dll](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120))类有两个新属性：</span><span class="sxs-lookup"><span data-stu-id="b305e-165">The [Microsoft.AnalysisServices.AdomdServer.Context](/previous-versions/sql/sql-server-2014/ms143353(v=sql.120)) class has two new properties:</span></span>  
  
-   <span data-ttu-id="b305e-166">[Microsoft.analysisservices.sharepoint.integration.dll \*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120))，它是对新服务器对象的只读引用。</span><span class="sxs-lookup"><span data-stu-id="b305e-166">[Microsoft.AnalysisServices.AdomdServer.Context.Server\*](/previous-versions/sql/sql-server-2014/bb678098(v=sql.120)), a read-only reference to the new server object.</span></span>  
  
-   <span data-ttu-id="b305e-167">CurrentConnection \*，它是对新[microsoft.analysisservices.sharepoint.integration.dll](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) AdomdServer 对象的只读引用。 [microsoft.analysisservices.sharepoint.integration.dll. AdomdServer](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120))。</span><span class="sxs-lookup"><span data-stu-id="b305e-167">[Microsoft.AnalysisServices.AdomdServer.Context.CurrentConnection\*](/previous-versions/sql/sql-server-2014/bb630975(v=sql.120)), a read-only reference to the new [Microsoft.AnalysisServices.AdomdServer.AdomdConnection](/previous-versions/sql/sql-server-2014/bb678193(v=sql.120)) object.</span></span>  
  
#### <a name="new-server-class"></a><span data-ttu-id="b305e-168">新增服务器类</span><span class="sxs-lookup"><span data-stu-id="b305e-168">New Server class</span></span>  
 <span data-ttu-id="b305e-169">[Microsoft.analysisservices.sharepoint.integration.dll](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120))类是新类，并通过类属性和事件公开多个个性化设置扩展。</span><span class="sxs-lookup"><span data-stu-id="b305e-169">The [Microsoft.AnalysisServices.AdomdServer.Server](/previous-versions/sql/sql-server-2014/bb677955(v=sql.120)) class is new and exposes several personalization extensions through both class properties and events.</span></span>  
  
 <span data-ttu-id="b305e-170">**属性**</span><span class="sxs-lookup"><span data-stu-id="b305e-170">**Properties**</span></span>  
  
-   <span data-ttu-id="b305e-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name \*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120))，表示服务器名称的只读字符串值。</span><span class="sxs-lookup"><span data-stu-id="b305e-171">[Microsoft.AnalysisServices.AdomdServer.Server.Name\*](/previous-versions/sql/sql-server-2014/bb677694(v=sql.120)), a read-only string value representing the server name.</span></span>  
  
-   <span data-ttu-id="b305e-172">[Microsoft.analysisservices.sharepoint.integration.dll \*](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120))，它是对与服务器关联的全局区域性的只读引用。</span><span class="sxs-lookup"><span data-stu-id="b305e-172">[Microsoft.AnalysisServices.AdomdServer.Server.Culture\*](/previous-versions/sql/sql-server-2014/bb677437(v=sql.120)), A read-only reference to the global culture associated with the server.</span></span>  
  
 <span data-ttu-id="b305e-173">**事件**</span><span class="sxs-lookup"><span data-stu-id="b305e-173">**Events**</span></span>  
  
-   <span data-ttu-id="b305e-174">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="b305e-174">[Microsoft.AnalysisServices.AdomdServer.Server.SessionOpened](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
-   <span data-ttu-id="b305e-175">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span><span class="sxs-lookup"><span data-stu-id="b305e-175">[Microsoft.AnalysisServices.AdomdServer.Server.SessionClosing](/previous-versions/sql/sql-server-2014/bb630427(v=sql.120))</span></span>  
  
#### <a name="adomdcommand-class"></a><span data-ttu-id="b305e-176">AdomdCommand 类</span><span class="sxs-lookup"><span data-stu-id="b305e-176">AdomdCommand class</span></span>  
 <span data-ttu-id="b305e-177">[Microsoft.analysisservices.sharepoint.integration.dll. AdomdServer. AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120))类现在支持以下 MDX 命令：</span><span class="sxs-lookup"><span data-stu-id="b305e-177">The [Microsoft.AnalysisServices.AdomdServer.AdomdCommand](/previous-versions/sql/sql-server-2014/ms143286(v=sql.120)) class now supports of the following MDX commands:</span></span>  
  
-   [<span data-ttu-id="b305e-178">CREATE MEMBER 语句 (MDX)</span><span class="sxs-lookup"><span data-stu-id="b305e-178">CREATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-member)  
  
-   [<span data-ttu-id="b305e-179">&#40;MDX&#41;更新成员语句</span><span class="sxs-lookup"><span data-stu-id="b305e-179">UPDATE MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-update-member)  
  
-   [<span data-ttu-id="b305e-180">DROP MEMBER 语句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="b305e-180">DROP MEMBER Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-member)  
  
-   [<span data-ttu-id="b305e-181">CREATE SET 语句 (MDX)</span><span class="sxs-lookup"><span data-stu-id="b305e-181">CREATE SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-set)  
  
-   [<span data-ttu-id="b305e-182">DROP SET 语句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="b305e-182">DROP SET Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-set)  
  
-   [<span data-ttu-id="b305e-183">&#40;MDX 创建 KPI 语句&#41;</span><span class="sxs-lookup"><span data-stu-id="b305e-183">CREATE KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-kpi)  
  
-   [<span data-ttu-id="b305e-184">DROP KPI 语句 &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="b305e-184">DROP KPI Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-drop-kpi)  
  
### <a name="mdx-extensions-and-enhancements"></a><span data-ttu-id="b305e-185">MDX 扩展和增强功能</span><span class="sxs-lookup"><span data-stu-id="b305e-185">MDX extensions and enhancements</span></span>  
 <span data-ttu-id="b305e-186">通过 `caption` 属性、`display_folder` 属性和 `associated_measure_group` 属性对 CREATE MEMBER 命令进行了增强。</span><span class="sxs-lookup"><span data-stu-id="b305e-186">The CREATE MEMBER command is enhanced with the `caption` property, the `display_folder` property, and the `associated_measure_group` property.</span></span>  
  
 <span data-ttu-id="b305e-187">添加 UPDATE MEMBER 命令是为了在求解计算丢失优先顺序时需要更新的情况下避免重新创建成员。</span><span class="sxs-lookup"><span data-stu-id="b305e-187">The UPDATE MEMBER command is added to avoid member re-creation when an update is needed with the consequent loss of precedence in solving calculations.</span></span> <span data-ttu-id="b305e-188">更新无法更改计算成员的作用域，无法将计算成员移动到其他父级，也无法定义其他 `solveorder`。</span><span class="sxs-lookup"><span data-stu-id="b305e-188">Updates cannot change the scope of the calculated member, move the calculated member to a different parent, or define a different `solveorder`.</span></span>  
  
 <span data-ttu-id="b305e-189">通过 `caption` 属性、`display_folder` 属性和新 `STATIC | DYNAMIC` 关键字对 CREATE SET 命令进行了增强。</span><span class="sxs-lookup"><span data-stu-id="b305e-189">The CREATE SET command is enhanced with the `caption` property, the `display_folder` property, and the new `STATIC | DYNAMIC` keyword.</span></span> <span data-ttu-id="b305e-190">*静态*意味着仅在创建时计算设置。</span><span class="sxs-lookup"><span data-stu-id="b305e-190">*Static* means that set is evaluated only at creation time.</span></span> <span data-ttu-id="b305e-191">*动态*意味着每次在查询中使用该集时都会计算该集。</span><span class="sxs-lookup"><span data-stu-id="b305e-191">*Dynamic* means that the set is evaluated every time that the set is used in a query.</span></span> <span data-ttu-id="b305e-192">如果省略关键字，默认值则为 `STATIC`。</span><span class="sxs-lookup"><span data-stu-id="b305e-192">The default value is `STATIC` if a keyword is omitted.</span></span>  
  
 <span data-ttu-id="b305e-193">在 MDX 语法中增加了 CREATE KPI 和 DROP KPI 命令。</span><span class="sxs-lookup"><span data-stu-id="b305e-193">CREATE KPI and DROP KPI commands are added to the MDX syntax.</span></span> <span data-ttu-id="b305e-194">可以从任意 MDX 脚本动态创建 KPI。</span><span class="sxs-lookup"><span data-stu-id="b305e-194">KPIs can be created dynamically from any MDX script.</span></span>  
  
### <a name="schema-rowsets-extensions"></a><span data-ttu-id="b305e-195">架构行集扩展</span><span class="sxs-lookup"><span data-stu-id="b305e-195">Schema Rowsets extensions</span></span>  
 <span data-ttu-id="b305e-196">在 MDSCHEMA_MEMBERS*作用域*添加。</span><span class="sxs-lookup"><span data-stu-id="b305e-196">On MDSCHEMA_MEMBERS *scope* column is added.</span></span> <span data-ttu-id="b305e-197">作用域值如下：MDMEMBER_SCOPE_GLOBAL=1、MDMEMBER_SCOPE_SESSION=2。</span><span class="sxs-lookup"><span data-stu-id="b305e-197">Scope values are as follows: MDMEMBER_SCOPE_GLOBAL=1, MDMEMBER_SCOPE_SESSION=2.</span></span>  
  
 <span data-ttu-id="b305e-198">在 MDSCHEMA_SETS 添加*set_evaluation_context*列。</span><span class="sxs-lookup"><span data-stu-id="b305e-198">On MDSCHEMA_SETS *set_evaluation_context* column is added.</span></span> <span data-ttu-id="b305e-199">将计算上下文值设置为：MDSET_RESOLUTION_STATIC = 1、MDSET_RESOLUTION_DYNAMIC = 2。</span><span class="sxs-lookup"><span data-stu-id="b305e-199">Set evaluation context values are as follows: MDSET_RESOLUTION_STATIC = 1, MDSET_RESOLUTION_DYNAMIC = 2.</span></span>  
  
 <span data-ttu-id="b305e-200">在 MDSCHEMA_KPIS 上，增加了作用域列。</span><span class="sxs-lookup"><span data-stu-id="b305e-200">On MDSCHEMA_KPIS scope column is added.</span></span> <span data-ttu-id="b305e-201">作用域值如下：MDKPI_SCOPE_GLOBAL=1、MDKPI_SCOPE_SESSION=2。</span><span class="sxs-lookup"><span data-stu-id="b305e-201">Scope values are as follows: MDKPI_SCOPE_GLOBAL=1, MDKPI_SCOPE_SESSION=2.</span></span>  
  
  
