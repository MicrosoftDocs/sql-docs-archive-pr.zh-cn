---
title: 关系查询设计器 (SSAS) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.bidtoolset.relquerydesginer.f1
ms.assetid: 9399b1d1-1ad2-44df-bd11-bef60fbf01ec
author: minewiskan
ms.author: owend
ms.openlocfilehash: 79765f589dcc649bdb2d12bd9dda0d4c955ae916
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87577004"
---
# <a name="relational-query-designer-ssas"></a><span data-ttu-id="4ee6f-102">关系查询设计器 (SSAS)</span><span class="sxs-lookup"><span data-stu-id="4ee6f-102">Relational Query Designer (SSAS)</span></span>
  <span data-ttu-id="4ee6f-103">关系查询设计器可帮助您创建一个查询，该查询指定要从 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 和 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssSDSfull](../includes/sssdsfull-md.md)] 关系数据库以及 [!INCLUDE[msCoName](../includes/msconame-md.md)] 中检索的数据 [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-103">The relational query designer helps you create a query that specifies the data to retrieve from [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] and [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssSDSfull](../includes/sssdsfull-md.md)] relational databases and [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)].</span></span> <span data-ttu-id="4ee6f-104">使用图形查询设计器可以浏览元数据、以交互方式生成查询，还可以查看查询结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-104">Use the graphical query designer to explore the metadata, interactively build the query, and view the results of your query.</span></span>  <span data-ttu-id="4ee6f-105">使用基于文本的查询设计器可以查看图形查询设计器生成的查询，也可以修改查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-105">Use the text-based query designer to view the query that was built by the graphical query designer or to modify a query.</span></span> <span data-ttu-id="4ee6f-106">您还可以从文件或报表中导入现有的查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-106">You can also import an existing query from a file or report.</span></span>  
  
 <span data-ttu-id="4ee6f-107">如果您愿意，也可以使用基于文本的编辑器以 SQL 语言形式编写查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-107">If you prefer, you can write the query in the SQL language by using the text-based editor.</span></span> <span data-ttu-id="4ee6f-108">若要切换到基于文本的查询设计器，请在工具栏中单击“编辑为文本”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-108">To switch to the text-based query designer, in the toolbar, click **Edit As Text**.</span></span> <span data-ttu-id="4ee6f-109">在基于文本的查询设计器中编辑查询之后，就不能再使用图形查询设计器了。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-109">After you edit a query in the text-based query designer, you can no longer use the graphical query designer.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4ee6f-110">若要为数据源类型 Oracle、OLE DB、ODBC 和 Teradata 指定查询，必须使用基于文本的查询设计器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-110">To specify a query for data source types Oracle, OLE DB, ODBC, and Teradata, you must use the text-based query designer.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="4ee6f-111">用户创建和运行查询时访问数据源。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-111">Users access data sources when they create and run queries.</span></span> <span data-ttu-id="4ee6f-112">您应授予对数据源的最小权限（如只读权限）。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-112">You should grant minimal permissions on the data sources, such as read-only permissions.</span></span>  
>   
>  <span data-ttu-id="4ee6f-113">在执行查询时，当前用户的凭据（而非在“模拟信息”页中指定的凭据）用于连接到数据源并提取数据。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-113">The credentials of the current user, not the credentials specified in the Impersonation Information page, are used to connect to the data source when a query is executed.</span></span>  
  
## <a name="graphical-query-designer"></a><span data-ttu-id="4ee6f-114">图形查询设计器</span><span class="sxs-lookup"><span data-stu-id="4ee6f-114">Graphical Query Designer</span></span>  
 <span data-ttu-id="4ee6f-115">在图形查询设计器中，您可以浏览数据库表和视图，还可以交互式生成 SQL SELECT 语句，以便指定要从中检索数据集数据的数据库表和列。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-115">In the graphical query designer you can explorer the database tables and views, interactively build the SQL SELECT statement that specifies the database tables and columns from which to retrieve data for a dataset.</span></span> <span data-ttu-id="4ee6f-116">您可以选择要包括在数据集中的字段，或者指定限制数据集中数据的筛选器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-116">You choose the fields to include in the dataset and optionally, specify filters that limit the data in the dataset.</span></span> <span data-ttu-id="4ee6f-117">可以指定将筛选器作为参数并在运行时提供筛选器的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-117">You can specify that filters are used as parameters and provide the value of the filter at run-time.</span></span> <span data-ttu-id="4ee6f-118">如果选择多个表，则查询设计器描述两个表的数据集之间的关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-118">If you choose multiple tables, the query designer describes the relationship between sets of two tables.</span></span>  
  
 <span data-ttu-id="4ee6f-119">图形查询设计器分为三个区域。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-119">The graphical query designer is divided into three areas.</span></span> <span data-ttu-id="4ee6f-120">根据查询是使用表/视图还是存储过程/表值函数，查询设计器的布局有所不同。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-120">Depending on whether the query uses tables/views or stored procedures/table-valued functions the layout of the query designer changes.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] <span data-ttu-id="4ee6f-121">不支持存储过程或表值函数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-121">does not support stored procedures or table-valued functions.</span></span>  
  
 <span data-ttu-id="4ee6f-122">下图显示了用于表或视图的图形查询设计器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-122">The following figure shows the graphical query designer when it is used with tables or views.</span></span>  
  
 <span data-ttu-id="4ee6f-123">![用于查询的图形设计器](media/rsqd-relational-graphical.gif "用于查询的图形设计器")</span><span class="sxs-lookup"><span data-stu-id="4ee6f-123">![Graphical designer for queries](media/rsqd-relational-graphical.gif "Graphical designer for queries")</span></span>  
  
 <span data-ttu-id="4ee6f-124">下图显示了用于存储过程或表值函数的图形查询设计器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-124">The following figure shows the graphical query designer when it is used with stored procedures or table-valued functions.</span></span>  
  
 <span data-ttu-id="4ee6f-125">![图形查询设计器中的存储过程](media/rs-relational-graphical-sp.gif "图形查询设计器中的存储过程")</span><span class="sxs-lookup"><span data-stu-id="4ee6f-125">![Stored procedure in graphical query designer](media/rs-relational-graphical-sp.gif "Stored procedure in graphical query designer")</span></span>  
  
 <span data-ttu-id="4ee6f-126">下表介绍了每个窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-126">The following table describes the function of each pane.</span></span>  
  
|<span data-ttu-id="4ee6f-127">窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-127">Pane</span></span>|<span data-ttu-id="4ee6f-128">函数</span><span class="sxs-lookup"><span data-stu-id="4ee6f-128">Function</span></span>|  
|----------|--------------|  
|[<span data-ttu-id="4ee6f-129">数据库视图</span><span class="sxs-lookup"><span data-stu-id="4ee6f-129">Database view</span></span>](#DatabaseView)|<span data-ttu-id="4ee6f-130">显示按数据库架构组织的表、视图、存储过程和表值函数的层次结构视图。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-130">Displays a hierarchical view of tables, views, stored procedures, and table-valued functions that are organized by database schema.</span></span>|  
|[<span data-ttu-id="4ee6f-131">所选字段</span><span class="sxs-lookup"><span data-stu-id="4ee6f-131">Selected fields</span></span>](#SelectedFields)|<span data-ttu-id="4ee6f-132">在“数据库视图”窗格中显示选定项中的数据库字段名称列表。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-132">Displays the list of database field names from the selected items in the Database view pane.</span></span> <span data-ttu-id="4ee6f-133">这些字段将成为数据集的字段集合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-133">These fields become the field collection for the dataset.</span></span>|  
|[<span data-ttu-id="4ee6f-134">函数参数</span><span class="sxs-lookup"><span data-stu-id="4ee6f-134">Function parameters</span></span>](#FunctionParameters)|<span data-ttu-id="4ee6f-135">在“数据库视图”窗格中显示存储过程或表值函数的输入参数列表。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-135">Displays the list of input parameters for stored procedures or table-valued functions in the Database view pane.</span></span>|  
|[<span data-ttu-id="4ee6f-136">关系</span><span class="sxs-lookup"><span data-stu-id="4ee6f-136">Relationships</span></span>](#Relationships)|<span data-ttu-id="4ee6f-137">在“数据库视图”窗格中显示通过表或视图中的选定字段推断出的关系或您手动创建的关系的列表。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-137">Displays a list of relationships that are inferred from selected fields for tables or views in the Database view pane or the relationships that you created manually.</span></span>|  
|[<span data-ttu-id="4ee6f-138">应用的筛选器</span><span class="sxs-lookup"><span data-stu-id="4ee6f-138">Applied filters</span></span>](#AppliedFilters)|<span data-ttu-id="4ee6f-139">在“数据库视图”中显示表或视图的字段列表和筛选条件。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-139">Displays a list of fields and filter criteria for tables or views in the Database view.</span></span>|  
|[<span data-ttu-id="4ee6f-140">查询结果</span><span class="sxs-lookup"><span data-stu-id="4ee6f-140">Query results</span></span>](#QueryResults)|<span data-ttu-id="4ee6f-141">显示自动生成的查询的结果集示例数据。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-141">Displays sample data for the result set for the automatically generated query.</span></span>|  
  
###  <a name="database-view-pane"></a><a name="DatabaseView"></a> <span data-ttu-id="4ee6f-142">“数据库视图”窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-142">Database View Pane</span></span>  
 <span data-ttu-id="4ee6f-143">“数据库视图”窗格显示您有权查看的数据库对象的元数据，该元数据取决于数据源连接和凭据。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-143">The Database View pane displays the metadata for database objects that you have the permissions to view, which is determined by the data source connection and credentials.</span></span> <span data-ttu-id="4ee6f-144">层次结构视图显示按数据库架构组织的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-144">The hierarchical view displays database objects organized by database schema.</span></span> <span data-ttu-id="4ee6f-145">展开每个架构的节点可查看表、视图、存储过程及表值函数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-145">Expand the node for each schema to view tables, views, stored procedures, and table-valued functions.</span></span> <span data-ttu-id="4ee6f-146">展开表或视图可显示列。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-146">Expand a table or view to display the columns.</span></span>  
  
###  <a name="selected-fields-pane"></a><a name="SelectedFields"></a> <span data-ttu-id="4ee6f-147">“所选字段”窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-147">Selected Fields Pane</span></span>  
 <span data-ttu-id="4ee6f-148">“所选字段”窗格显示数据集中的字段以及要包括在查询中的分组和聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-148">The Selected Fields pane displays the fields in the dataset and the groups and aggregates to include in the query.</span></span>  
  
 <span data-ttu-id="4ee6f-149">显示下列选项：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-149">The following options are displayed:</span></span>  
  
-   <span data-ttu-id="4ee6f-150">**所选字段** ：显示为表或视图选择的数据库字段，或者为存储过程或表值函数选择的输入参数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-150">**Selected fields** Displays the database fields that you select for tables or views or the input parameters for stored procedures or table-valued functions.</span></span> <span data-ttu-id="4ee6f-151">此窗格中显示的字段将成为数据集的字段集合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-151">The fields that are displayed in this pane become the field collection for the dataset.</span></span>  
  
     <span data-ttu-id="4ee6f-152">使用“报表数据”窗格可查看数据集的字段集合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-152">Use the Report Data pane to view the field collection for a dataset.</span></span>  
  
-   <span data-ttu-id="4ee6f-153">**分组和聚合** ：在查询中切换是否使用分组和聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-153">**Group and Aggregate** Toggles the use of grouping and aggregates in the query.</span></span> <span data-ttu-id="4ee6f-154">如果您在添加分组和聚合后禁用分组和聚合功能，则将删除所添加的分组和聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-154">If you turn off the grouping and aggregate feature after you added grouping and aggregates, they are removed.</span></span> <span data-ttu-id="4ee6f-155">文本“(无)”表示没有使用任何分组和聚合\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-155">The text, **(none)**, indicates no grouping and aggregates are used.</span></span> <span data-ttu-id="4ee6f-156">如果您再次启用分组和聚合功能，则将还原之前的分组和聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-156">If you turn the grouping and aggregate feature on again, the previous grouping and aggregates are restored.</span></span>  
  
-   <span data-ttu-id="4ee6f-157">**删除字段** ：删除所选的字段。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-157">**Delete Field** Deletes the selected field.</span></span>  
  
#### <a name="group-and-aggregate"></a><span data-ttu-id="4ee6f-158">分组和聚合</span><span class="sxs-lookup"><span data-stu-id="4ee6f-158">Group and Aggregate</span></span>  
 <span data-ttu-id="4ee6f-159">查询包含大表的数据库时可能会返回很多数据行，这些数据行由于数量过多以至于没有什么用处，另外，由于要传输大量的数据，这也会对网络的性能造成影响。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-159">Queries to databases with a large table might return a number of data rows that is too large to be useful and has a performance impact on the network that transports the vast amount of data.</span></span> <span data-ttu-id="4ee6f-160">为了限制数据行的数量，查询可以包含对数据库服务器中的数据进行汇总的 SQL 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-160">To limit the number of data rows, the query can include SQL aggregates that summarize the data on the database server.</span></span>  
  
 <span data-ttu-id="4ee6f-161">聚合功能可对数据进行汇总，并且数据也会进行分组，以支持传递汇总数据的聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-161">Aggregates provide summaries of data and the data is grouped to support the aggregate that deliver the summary data.</span></span> <span data-ttu-id="4ee6f-162">在查询中使用聚合时，查询返回的其他字段将自动进行分组，并且查询包括 SQL GROUP BY 子句。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-162">When you use an aggregate in the query, the other fields returned by the query are automatically grouped and the query includes the SQL GROUP BY clause.</span></span> <span data-ttu-id="4ee6f-163">可以通过仅在 **“分组和聚合”** 列表中使用 **“分组依据”** 选项来汇总数据，而不必添加聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-163">You can summarize data without adding an aggregate by using only the **Grouped by** option in the **Group and Aggregate** list.</span></span> <span data-ttu-id="4ee6f-164">许多聚合都包括使用 DISTINCT 关键字的版本。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-164">Many of the aggregates include a version that uses the DISTINCT keyword.</span></span> <span data-ttu-id="4ee6f-165">包括 DISTINCT 可消除重复的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-165">Including DISTINCT eliminates duplicate values.</span></span>  
  
 [!INCLUDE[msCoName](../includes/msconame-md.md)]<span data-ttu-id="4ee6f-166">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]使用 [!INCLUDE[tsql](../includes/tsql-md.md)] 和 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] 使用 [!INCLUDE[DWsql](../includes/dwsql-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-166">[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] uses [!INCLUDE[tsql](../includes/tsql-md.md)] and [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] uses [!INCLUDE[DWsql](../includes/dwsql-md.md)].</span></span> <span data-ttu-id="4ee6f-167">SQL 语言的这两种分支都支持查询设计器提供的子句、关键字和聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-167">Both dialects of the SQL language support the clause, keyword, and aggregates that the query designer provides.</span></span>  
  
 <span data-ttu-id="4ee6f-168">有关 [!INCLUDE[tsql](../includes/tsql-md.md)] 的详细信息，请参阅 msdn.microsoft.com 上 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [联机丛书](https://go.microsoft.com/fwlink/?LinkId=141687)中的 [Transact-SQL 引用（数据库引擎）](/sql/t-sql/language-reference)。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-168">For more information about [!INCLUDE[tsql](../includes/tsql-md.md)], see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference)in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [Books Online](https://go.microsoft.com/fwlink/?LinkId=141687) on msdn.microsoft.com.</span></span>  
  
 <span data-ttu-id="4ee6f-169">下表列出各种聚合并提供其简要说明。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-169">The following table list the aggregates and provides brief descriptions of them.</span></span>  
  
|<span data-ttu-id="4ee6f-170">聚合</span><span class="sxs-lookup"><span data-stu-id="4ee6f-170">Aggregate</span></span>|<span data-ttu-id="4ee6f-171">说明</span><span class="sxs-lookup"><span data-stu-id="4ee6f-171">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="4ee6f-172">平均值</span><span class="sxs-lookup"><span data-stu-id="4ee6f-172">Avg</span></span>|<span data-ttu-id="4ee6f-173">返回组中各值的平均值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-173">Return the average of the values in a group.</span></span> <span data-ttu-id="4ee6f-174">实现 SQL AVG 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-174">Implements the SQL AVG aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-175">计数</span><span class="sxs-lookup"><span data-stu-id="4ee6f-175">Count</span></span>|<span data-ttu-id="4ee6f-176">返回组中项数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-176">Return the number of items in a group.</span></span> <span data-ttu-id="4ee6f-177">实现 SQL COUNT 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-177">Implements is the SQL COUNT aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-178">Count Big</span><span class="sxs-lookup"><span data-stu-id="4ee6f-178">Count Big</span></span>|<span data-ttu-id="4ee6f-179">返回组中的项数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-179">Returns the number of items in a group.</span></span> <span data-ttu-id="4ee6f-180">这是 SQL COUNT_BIG 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-180">It is the SQL COUNT_BIG aggregate.</span></span> <span data-ttu-id="4ee6f-181">COUNT 和 COUNT_BIG 之间的区别是 COUNT_BIG 始终返回一个 `bigint` 数据类型的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-181">The difference between COUNT and COUNT_BIG is that COUNT_BIG always returns a `bigint` data type value.</span></span>|  
|<span data-ttu-id="4ee6f-182">最小值</span><span class="sxs-lookup"><span data-stu-id="4ee6f-182">Min</span></span>|<span data-ttu-id="4ee6f-183">返回组中的最小值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-183">Returns the minimum value in a group.</span></span> <span data-ttu-id="4ee6f-184">实现 SQL MIN 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-184">Implements is the SQL MIN aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-185">最大值</span><span class="sxs-lookup"><span data-stu-id="4ee6f-185">Max</span></span>|<span data-ttu-id="4ee6f-186">返回组中的最大值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-186">Returns the maximum value in a group.</span></span> <span data-ttu-id="4ee6f-187">实现 SQL MAX 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-187">Implements is the SQL MAX aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-188">StDev</span><span class="sxs-lookup"><span data-stu-id="4ee6f-188">StDev</span></span>|<span data-ttu-id="4ee6f-189">返回组中所有值的统计标准偏差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-189">Returns the statistical standard deviation of all values in a group.</span></span> <span data-ttu-id="4ee6f-190">实现 SQL STDEV 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-190">Implements the SQL STDEV aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-191">StDevP</span><span class="sxs-lookup"><span data-stu-id="4ee6f-191">StDevP</span></span>|<span data-ttu-id="4ee6f-192">返回指定组中所有值的总体标准偏差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-192">Returns the statistical standard deviation for the population of the all values in a group specified expression.</span></span> <span data-ttu-id="4ee6f-193">实现 SQL STDEVP 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-193">Implements the SQL STDEVP aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-194">Sum</span><span class="sxs-lookup"><span data-stu-id="4ee6f-194">Sum</span></span>|<span data-ttu-id="4ee6f-195">返回组中所有值的总和。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-195">Returns the sum of all the values in the group.</span></span> <span data-ttu-id="4ee6f-196">实现 SQL SUM 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-196">Implements the SQL SUM aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-197">Var</span><span class="sxs-lookup"><span data-stu-id="4ee6f-197">Var</span></span>|<span data-ttu-id="4ee6f-198">返回组中所有值的方差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-198">Returns the statistical variance of all values in the group.</span></span> <span data-ttu-id="4ee6f-199">实现 SQL VAR 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-199">Implements the SQL VAR aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-200">VarP</span><span class="sxs-lookup"><span data-stu-id="4ee6f-200">VarP</span></span>|<span data-ttu-id="4ee6f-201">返回组中所有值的总体方差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-201">Returns the statistical variance for the population for all values in the group.</span></span> <span data-ttu-id="4ee6f-202">实现 SQL VARP 聚合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-202">Implements the SQL VARP aggregate.</span></span>|  
|<span data-ttu-id="4ee6f-203">Avg Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-203">Avg Distinct</span></span>|<span data-ttu-id="4ee6f-204">返回唯一项的均值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-204">Returns unique averages.</span></span> <span data-ttu-id="4ee6f-205">实现 AVG 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-205">Implements a combination of the AVG aggregation and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-206">Count Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-206">Count Distinct</span></span>|<span data-ttu-id="4ee6f-207">返回唯一项的计数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-207">Returns unique counts.</span></span> <span data-ttu-id="4ee6f-208">实现 COUNT 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-208">Implements a combination of the COUNT aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-209">Count Big Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-209">Count Big Distinct</span></span>|<span data-ttu-id="4ee6f-210">返回组中唯一项的计数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-210">Return unique count of items in a group.</span></span> <span data-ttu-id="4ee6f-211">实现 COUNT_BIG 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-211">Implements a combination of the COUNT_BIG aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-212">StDev Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-212">StDev Distinct</span></span>|<span data-ttu-id="4ee6f-213">返回唯一项的标准偏差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-213">Returns unique statistical standard deviations.</span></span> <span data-ttu-id="4ee6f-214">实现 STDEV 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-214">Implements a combination of the STDEV aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-215">StDevP Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-215">StDevP Distinct</span></span>|<span data-ttu-id="4ee6f-216">返回唯一项的标准偏差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-216">Returns unique statistical standard deviations.</span></span> <span data-ttu-id="4ee6f-217">实现 STDEVP 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-217">Implements combination of the STDEVP aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-218">Sum Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-218">Sum Distinct</span></span>|<span data-ttu-id="4ee6f-219">返回唯一项的总和。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-219">Returns unique sums.</span></span> <span data-ttu-id="4ee6f-220">实现 SUM 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-220">Implements a combination of the SUM aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-221">Var Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-221">Var Distinct</span></span>|<span data-ttu-id="4ee6f-222">返回唯一项的方差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-222">Returns unique statistical variances.</span></span> <span data-ttu-id="4ee6f-223">实现 VAR 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-223">Implements a combination of the VAR aggregate and the DISTINCT keyword.</span></span>|  
|<span data-ttu-id="4ee6f-224">VarP Distinct</span><span class="sxs-lookup"><span data-stu-id="4ee6f-224">VarP Distinct</span></span>|<span data-ttu-id="4ee6f-225">返回唯一项的方差。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-225">Returns unique statistical variances.</span></span> <span data-ttu-id="4ee6f-226">实现 VARP 聚合和 DISTINCT 关键字的组合。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-226">Implements combination of the VARP aggregate and the DISTINCT keyword.</span></span>|  
  
###  <a name="function-parameters-pane"></a><a name="FunctionParameters"></a> <span data-ttu-id="4ee6f-227">“函数参数”窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-227">Function Parameters Pane</span></span>  
 <span data-ttu-id="4ee6f-228">“函数参数”窗格显示存储过程或表值函数的参数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-228">The Function Parameters pane displays the parameters for a stored procedure or table-valued function.</span></span> <span data-ttu-id="4ee6f-229">以下列会显示：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-229">The following columns are displayed:</span></span>  
  
-   <span data-ttu-id="4ee6f-230">**参数名称** ：显示由存储过程或表值函数定义的参数名称。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-230">**Parameter Name** Displays the name of the parameter that is defined by the stored procedure or table-valued function.</span></span>  
  
-   <span data-ttu-id="4ee6f-231">**值** 在查询运行以检索在设计时在“查询结果”窗格中显示的数据时用于查询参数的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-231">**Value** A value to use for the parameter when the query runs to retrieve data to display in the Query Results pane at design time.</span></span> <span data-ttu-id="4ee6f-232">在运行时不使用此值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-232">This value is not used at run time.</span></span>  
  
###  <a name="relationships-pane"></a><a name="Relationships"></a><span data-ttu-id="4ee6f-233">关系窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-233">Relationships Pane</span></span>  
 <span data-ttu-id="4ee6f-234">“关系”窗格显示联接关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-234">The Relationships pane displays the join relationships.</span></span> <span data-ttu-id="4ee6f-235">可以根据从数据库元数据检索的外键关系自动检测到关系，也可以手动创建关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-235">The relationships can be detected automatically from the foreign key relationships that are retrieved from the database metadata or you can create them manually.</span></span>  
  
 <span data-ttu-id="4ee6f-236">显示下列选项：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-236">The following options are displayed:</span></span>  
  
-   <span data-ttu-id="4ee6f-237">**自动检测** ：切换可自动在表之间创建关系的自动检测功能。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-237">**Auto Detect** Toggles the auto-detect feature that automatically creates relationships between tables.</span></span> <span data-ttu-id="4ee6f-238">如果启用自动检测，则查询设计器将根据表中的外键创建关系；否则，您必须手动创建关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-238">If auto detect is turned on, the query designer creates relationships from foreign keys in tables; otherwise, you must create the relationships manually.</span></span> <span data-ttu-id="4ee6f-239">当您在 **“数据库视图”** 窗格中选择表时，自动检测将尝试自动创建关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-239">When you select tables in the **Database view** pane, auto detect automatically attempts to create relationships.</span></span> <span data-ttu-id="4ee6f-240">如果您在手动创建联接后启用自动检测，则这些联接将被丢弃。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-240">If you turn on auto detect after you have manually created joins, those joins will be discarded.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="4ee6f-241">与 [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] 一起使用时，由于不会提供创建联接所需的元数据，因此无法自动检测到关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-241">When using with [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)] the metadata needed to create joins is not provided and relationships cannot be detected automatically.</span></span> <span data-ttu-id="4ee6f-242">如果您的查询从 [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)]中检索数据，则必须手动创建所有表联接。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-242">If your query retrieves data from [!INCLUDE[ssDWfull](../includes/ssdwfull-md.md)], all table joins must be created manually.</span></span>  
  
-   <span data-ttu-id="4ee6f-243">**添加关系** ：向 **“关系”** 列表中添加关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-243">**Add Relationship** Adds a relationship to the **Relationship** list.</span></span>  
  
     <span data-ttu-id="4ee6f-244">如果启用自动检测，则查询中使用的列所在的表将会自动添加到 **“关系”** 列表。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-244">If auto detect is turned on, the tables from which columns are used in the query are automatically added to the **Relationship** list.</span></span> <span data-ttu-id="4ee6f-245">当自动检测确定两个表相关时，会将其中一个表添加到 **“左表”** 列，并将另一个表添加到 **“右表”** 列，并在这两个表之间创建内部联接。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-245">When auto detect identifies that two tables are related, one table is added to the **Left Table** column, the other the **Right Table** column, and an inner join is created between them.</span></span> <span data-ttu-id="4ee6f-246">每个关系都会在查询中生成一个 JOIN 子句。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-246">Each relationship generates a JOIN clause in the query.</span></span> <span data-ttu-id="4ee6f-247">如果各表不相关，则所有表都将列在 **“左表”** 列，并且 **“联接类型”** 列指示对应表与其他表无关。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-247">If the tables are not related, all of them are listed in **Left Table** column and the **Join Type** column indicates the tables are not related to other tables.</span></span> <span data-ttu-id="4ee6f-248">如果启用自动检测，则无法在自动检测已确定无关的表之间手动添加关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-248">When auto detect is turned on, you cannot manually add relationships between tables that auto detect determines are unrelated.</span></span>  
  
     <span data-ttu-id="4ee6f-249">如果禁用自动检测，则可以添加和更改表之间的关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-249">If auto detect is turned off, you can add and change relationships between tables.</span></span> <span data-ttu-id="4ee6f-250">单击 **“编辑字段”** 可指定要用于联接两个表的字段。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-250">Click **Edit Fields** to specify the fields to use to join the two tables.</span></span>  
  
     <span data-ttu-id="4ee6f-251">关系在 **“关系”** 列表中显示的顺序即是将在查询中执行联接的顺序。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-251">The order in which the relationships appear in the **Relationship** list is the order in which the joins will be performed in the query.</span></span> <span data-ttu-id="4ee6f-252">您可以通过在列表中上下移动关系来更改关系的顺序。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-252">You can change the order of relationships by moving them up and down in the list.</span></span>  
  
     <span data-ttu-id="4ee6f-253">当在查询中使用多个关系时，除第一个关系以外的所有关系中都必须有一个表被前一个关系引用。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-253">When using multiple relationships in a query, one of the tables in each relationship, except the first one, must be referenced in a proceeding relationships.</span></span>  
  
     <span data-ttu-id="4ee6f-254">如果某个关系中的两个表都被前一个关系引用，则该关系将不生成单独的联接子句，而是将联接条件添加到为上一个关系生成的联接子句中。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-254">If both tables in a relationship are referenced by a preceding relationship then the relationship does not generate a separate join clause; instead a join condition is added to the join clause generated for the preceding relationship.</span></span> <span data-ttu-id="4ee6f-255">联接类型可从引用相同表的上一个关系中推断出来。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-255">The join type is inferred by the preceding relationship that referenced the same tables.</span></span>  
  
-   <span data-ttu-id="4ee6f-256">**编辑字段** ：打开 **“编辑相关字段”** 对话框，您可以在其中添加和修改表之间的关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-256">**Edit Fields** Opens the **Edit Related Fields** dialog box in which you add and modify relationships between tables.</span></span> <span data-ttu-id="4ee6f-257">在左表和右表中选择要联接的字段。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-257">You chose the fields in the right and left tables to join.</span></span> <span data-ttu-id="4ee6f-258">可以将左表和右表中的多个字段联接起来，以便在一个关系中指定多个联接条件。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-258">You can join multiple fields from the left table and right table to specify multiple join conditions in a relationship.</span></span> <span data-ttu-id="4ee6f-259">联接左表和右表的两个字段的名称不必相同。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-259">The two fields that join the left and right tables do not need to have the same name.</span></span> <span data-ttu-id="4ee6f-260">联接字段的数据类型必须兼容。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-260">The data type of the joined fields must have compatible data types.</span></span>  
  
-   <span data-ttu-id="4ee6f-261">**删除关系**  删除所选的关系。\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="4ee6f-261">**Delete Relationship**  Deletes the selected relationship **.**</span></span>  
  
-   <span data-ttu-id="4ee6f-262">**上移** 和 **下移** ：在 **“关系”** 列表中向上或向下移动关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-262">**Move Up** and **Move Down** Moves relationships up or down the **Relationship** list.</span></span> <span data-ttu-id="4ee6f-263">关系在查询中的放置顺序会影响到查询结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-263">The sequence in which relationships are placed in the query can impact the query results.</span></span> <span data-ttu-id="4ee6f-264">关系将按其在 **“关系”** 列表中的显示顺序添加到查询中。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-264">The relationships are added to the query in the order they appear in the **Relationship** list.</span></span>  
  
 <span data-ttu-id="4ee6f-265">以下列会显示：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-265">The following columns are displayed:</span></span>  
  
-   <span data-ttu-id="4ee6f-266">**左表** ：显示联接关系中第一个表的名称。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-266">**Left Table** Displays the name of the first table that is part of a join relationship.</span></span>  
  
-   <span data-ttu-id="4ee6f-267">**联接类型** ：显示自动生成的查询中所使用的 SQL JOIN 语句的类型。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-267">**Join Type** Displays the type of SQL JOIN statement that is used in the automatically generated query.</span></span> <span data-ttu-id="4ee6f-268">默认情况下，如果检测到外键约束，将会使用 INNER JOIN。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-268">By default, if a foreign key constraint is detected, INNER JOIN is used.</span></span> <span data-ttu-id="4ee6f-269">其他联接类型可以为 LEFT JOIN 或 RIGHT JOIN。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-269">Other joins types can be LEFT JOIN or RIGHT JOIN.</span></span> <span data-ttu-id="4ee6f-270">如果不应用所有这些联接类型，则 **“联接类型”** 列将显示 **“无关”**。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-270">If none of these join types apply, the **Join Type** column displays **Unrelated**.</span></span> <span data-ttu-id="4ee6f-271">不会为无关表创建 CROSS JOIN 联接；相反，您必须通过联接左表和右表中的列来手动创建关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-271">No CROSS JOIN joins are created for unrelated tables; instead, you must manually create relationships by joining columns in the left and right tables.</span></span> <span data-ttu-id="4ee6f-272">有关 JOIN 的类型的详细信息，请参阅 msdn.microsoft.com 上的 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [联机丛书](https://go.microsoft.com/fwlink/?LinkId=141687) 中的“JOIN Fundamentals”（JOIN 基础知识）。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-272">For more information about types of JOINs, see "JOIN Fundamentals" in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] [Books Online](https://go.microsoft.com/fwlink/?LinkId=141687) on msdn.microsoft.com..</span></span>  
  
-   <span data-ttu-id="4ee6f-273">**右表** ：显示联接关系中第二个表的名称。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-273">**Right Table** Displays the name of the second table in the join relationship.</span></span>  
  
-   <span data-ttu-id="4ee6f-274">**联接字段** ：列出联接字段对，如果某个关系具有多个联接条件，则各个联接字段对用逗号 (,) 分隔。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-274">**Join Fields** Lists the pairs of joined fields, if a relationship has multiple join conditions the pairs of joined fields are separated by commas (,).</span></span>  
  
###  <a name="applied-filters-pane"></a><a name="AppliedFilters"></a> <span data-ttu-id="4ee6f-275">“应用的筛选器”窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-275">Applied Filters Pane</span></span>  
 <span data-ttu-id="4ee6f-276">“应用的筛选器”窗格显示用于限定在运行时检索的数据行数的条件。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-276">The Applied Filters pane displays the criteria that are used to limit the number of rows of data that are retrieved at run time.</span></span> <span data-ttu-id="4ee6f-277">此窗格中指定的条件用于生成 SQL WHERE 子句。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-277">Criteria specified in this pane are used to generate an SQL WHERE clause.</span></span> <span data-ttu-id="4ee6f-278">如果选择了参数选项，则会自动创建参数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-278">When you select the parameter option, a parameter is automatically created.</span></span>  
  
 <span data-ttu-id="4ee6f-279">以下列会显示：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-279">The following columns are displayed:</span></span>  
  
-   <span data-ttu-id="4ee6f-280">**字段名称** ：显示应用该条件的字段的名称。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-280">**Field Name** Displays the name of the field to apply the criteria to.</span></span>  
  
-   <span data-ttu-id="4ee6f-281">**运算符** ：显示要在筛选表达式中使用的运算。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-281">**Operator** Displays the operation to use to in the filter expression.</span></span>  
  
-   <span data-ttu-id="4ee6f-282">**值** ：显示要在筛选表达式中使用的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-282">**Value** Displays the value to use in the filter expression.</span></span>  
  
-   <span data-ttu-id="4ee6f-283">**参数** ：显示用于为查询添加查询参数的选项。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-283">**Parameter** Displays the option to add a query parameter to the query.</span></span>  
  
###  <a name="query-results-pane"></a><a name="QueryResults"></a> <span data-ttu-id="4ee6f-284">“查询结果”窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-284">Query Results Pane</span></span>  
 <span data-ttu-id="4ee6f-285">“查询结果”窗格显示由其他窗格中的选项指定并且自动生成的查询的结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-285">The Query results pane displays the results for the automatically generated query that is specified by selections in the other panes.</span></span> <span data-ttu-id="4ee6f-286">结果集中的列是您在“所选字段”窗格中指定的字段，行数据受限于您在“应用的筛选器”窗格中指定的筛选器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-286">The columns in the result set are the fields that you specify in the Selected Fields pane and the row data is limited by the filters that you specify in the Applied Filters pane.</span></span>  
  
 <span data-ttu-id="4ee6f-287">此数据表示在运行查询时数据源中的值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-287">This data represents values from the data source at the time that you run the query.</span></span>  
  
 <span data-ttu-id="4ee6f-288">结果集中的排序顺序取决于从数据源检索数据的顺序。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-288">Sort order in the result set is determined by the order the data is retrieved from the data source.</span></span> <span data-ttu-id="4ee6f-289">可以通过直接修改查询文本来更改排序顺序。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-289">Sort order can be changed by modifying the query text directly.</span></span> <span data-ttu-id="4ee6f-290">有关在查询中使用 GROUP BY 子句的详细信息，请参阅 [SQL Server 联机丛书](https://go.microsoft.com/fwlink/?linkid=98335)中的“GROUP BY (Transact-SQL)”。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-290">For more information about using the GROUP BY clause in a query, see "GROUP BY (Transact-SQL)" in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=98335).</span></span>  
  
### <a name="graphical-query-designer-toolbar"></a><span data-ttu-id="4ee6f-291">图形查询设计器工具栏</span><span class="sxs-lookup"><span data-stu-id="4ee6f-291">Graphical Query Designer Toolbar</span></span>  
 <span data-ttu-id="4ee6f-292">图形查询设计器工具栏提供了以下按钮，帮助您指定或查看查询结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-292">The graphical query designer toolbar provides the following buttons to help you specify or view the results of a query.</span></span>  
  
|<span data-ttu-id="4ee6f-293">Button</span><span class="sxs-lookup"><span data-stu-id="4ee6f-293">Button</span></span>|<span data-ttu-id="4ee6f-294">描述</span><span class="sxs-lookup"><span data-stu-id="4ee6f-294">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="4ee6f-295">**编辑为文本**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-295">**Edit As Text**</span></span>|<span data-ttu-id="4ee6f-296">切换到基于文本的查询设计器，可查看自动生成的查询，也可以修改查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-296">Toggle to the text-based query designer to view the automatically generated query or to modify the query.</span></span>|  
|<span data-ttu-id="4ee6f-297">**导入**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-297">**Import**</span></span>|<span data-ttu-id="4ee6f-298">从文件或报表中导入现有的查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-298">Import an existing query from a file or report.</span></span> <span data-ttu-id="4ee6f-299">支持 .sql 和 .rdl 文件类型。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-299">File types .sql and .rdl are supported.</span></span>|  
|<span data-ttu-id="4ee6f-300">**运行查询**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-300">**Run Query**</span></span>|<span data-ttu-id="4ee6f-301">运行查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-301">Run the query.</span></span> <span data-ttu-id="4ee6f-302">“查询结果”窗格显示结果集。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-302">The Query results pane displays the result set.</span></span>|  
  
## <a name="understanding-automatically-generated-queries"></a><span data-ttu-id="4ee6f-303">了解自动生成的查询</span><span class="sxs-lookup"><span data-stu-id="4ee6f-303">Understanding Automatically Generated Queries</span></span>  
 <span data-ttu-id="4ee6f-304">当您在“数据库视图”窗格中选择表和列或存储过程及视图时，查询设计器将从数据库架构中检索主键与外键的基本关系。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-304">When you select tables and columns or stored procedures and views in the Database View pane, the query designer retrieves the underlying primary key and foreign key relationships from the database schema.</span></span> <span data-ttu-id="4ee6f-305">通过分析这些关系，查询设计器会检测到两个表之间的关系并将联接添加到查询中。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-305">By analyzing these relationships, the query designer detects relationships between two tables and adds joins to the query.</span></span> <span data-ttu-id="4ee6f-306">然后，您即可通过添加分组和聚合、添加或更改关系并添加筛选器来修改查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-306">You can then modify the query by adding groups and aggregates, adding or changing relationships, and adding filters.</span></span> <span data-ttu-id="4ee6f-307">若要查看显示要从中检索数据的列、表之间的联接以及任何分组或聚合的查询文本，请单击 **“编辑为文本”**。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-307">To view the query text that shows the columns from which to retrieve data, the joins between tables, and any groups or aggregates, click **Edit As Text**.</span></span>  
  
## <a name="text-based-query-designer"></a><span data-ttu-id="4ee6f-308">基于文本的查询设计器</span><span class="sxs-lookup"><span data-stu-id="4ee6f-308">Text-based Query Designer</span></span>  
 <span data-ttu-id="4ee6f-309">基于文本的查询设计器可以用数据源支持的查询语言来指定查询，还可以运行查询并在设计时查看结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-309">The text-based query designer provides a way to specific a query by using the query language supported by the data source, run the query, and view the results at design time.</span></span> <span data-ttu-id="4ee6f-310">您可以指定多个 SQL 语句，为自定义数据处理扩展指定查询或命令语法，还可以指定作为表达式指定的查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-310">You can specify multiple SQL statements, query or command syntax for custom data processing extensions, and queries that are specified as expressions.</span></span>  
  
 <span data-ttu-id="4ee6f-311">由于基于文本的查询设计器不预处理查询，它可以包含任何种类的查询语法。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-311">Because the text-based query designer does not preprocess the query, it can accommodate any kind of query syntax.</span></span> <span data-ttu-id="4ee6f-312">它是很多数据源类型的默认查询设计器工具。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-312">It is the default query designer tool for many data source types.</span></span>  
  
 <span data-ttu-id="4ee6f-313">基于文本的查询设计器将显示工具栏和以下两个窗格：</span><span class="sxs-lookup"><span data-stu-id="4ee6f-313">The text-based query designer displays a toolbar and the following two panes:</span></span>  
  
-   <span data-ttu-id="4ee6f-314">**查询** ：根据查询类型的不同，显示查询文本、表名或存储过程名称。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-314">**Query** Shows the query text, table name, or stored procedure name depending on the query type.</span></span> <span data-ttu-id="4ee6f-315">并非所有查询类型都适用于所有数据源类型。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-315">Not all query types are available for all data source types.</span></span> <span data-ttu-id="4ee6f-316">例如，只有数据源类型 OLE DB 支持表名。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-316">For example, table name is supported only for the data source type OLE DB.</span></span>  
  
-   <span data-ttu-id="4ee6f-317">**结果** ：在设计时，显示查询的运行结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-317">**Result** Shows the results of running the query at design time.</span></span>  
  
### <a name="text-based-query-designer-toolbar"></a><span data-ttu-id="4ee6f-318">基于文本的查询设计器工具栏</span><span class="sxs-lookup"><span data-stu-id="4ee6f-318">Text-based Query Designer Toolbar</span></span>  
 <span data-ttu-id="4ee6f-319">基于文本的查询设计器为所有命令类型都提供一个单一工具栏。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-319">The text-based query designer provides a single toolbar for all the command types.</span></span> <span data-ttu-id="4ee6f-320">下表列出了该工具栏中的每个按钮及其功能。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-320">The following table lists each button on the toolbar and its function.</span></span>  
  
|<span data-ttu-id="4ee6f-321">Button</span><span class="sxs-lookup"><span data-stu-id="4ee6f-321">Button</span></span>|<span data-ttu-id="4ee6f-322">描述</span><span class="sxs-lookup"><span data-stu-id="4ee6f-322">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="4ee6f-323">**编辑为文本**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-323">**Edit As Text**</span></span>|<span data-ttu-id="4ee6f-324">在基于文本的查询设计器和图形查询设计器之间切换。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-324">Toggle between the text-based query designer and the graphical query designer.</span></span> <span data-ttu-id="4ee6f-325">并非所有的数据源类型都支持图形查询设计器。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-325">Not all data source types support graphical query designers.</span></span>|  
|<span data-ttu-id="4ee6f-326">**导入**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-326">**Import**</span></span>|<span data-ttu-id="4ee6f-327">从文件或报表中导入现有的查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-327">Import an existing query from a file or report.</span></span> <span data-ttu-id="4ee6f-328">仅支持 .sql 和 .rdl 文件类型。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-328">Only file types sql and rdl are supported.</span></span>|  
|<span data-ttu-id="4ee6f-329">![运行查询](media/rsqdicon-run.gif "运行查询")</span><span class="sxs-lookup"><span data-stu-id="4ee6f-329">![Run the query](media/rsqdicon-run.gif "Run the query")</span></span>|<span data-ttu-id="4ee6f-330">运行查询并在“结果”窗格中显示结果集。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-330">Run the query and display the result set in the Result pane.</span></span>|  
|<span data-ttu-id="4ee6f-331">**命令类型**</span><span class="sxs-lookup"><span data-stu-id="4ee6f-331">**Command Type**</span></span>|<span data-ttu-id="4ee6f-332">选择 **Text**、 **StoredProcedure**或 **TableDirect**。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-332">Select **Text**, **StoredProcedure**, or **TableDirect**.</span></span> <span data-ttu-id="4ee6f-333">如果存储过程带有参数，则单击工具栏上的 **“运行”** 时，将出现 **“定义查询参数”** 对话框，您可以根据需要填入值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-333">If a stored procedure has parameters, the **Define Query Parameters** dialog box appears when you click **Run** on the toolbar, and you can fill in values as needed.</span></span><br /><br /> <span data-ttu-id="4ee6f-334">请注意，如果存储过程返回多个结果集，则仅使用第一个结果集填充数据集。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-334">Note that if a stored procedure returns more than one result set, only the first result set is used to populate the dataset.</span></span> <span data-ttu-id="4ee6f-335">另请注意，</span><span class="sxs-lookup"><span data-stu-id="4ee6f-335">Note also that</span></span> <br />                      <span data-ttu-id="4ee6f-336">**TableDirect**仅适用于数据源类型 OLE DB。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-336">**TableDirect** is available only for the data source type OLE DB.</span></span>|  
  
#### <a name="command-type-text"></a><span data-ttu-id="4ee6f-337">命令类型 Text</span><span class="sxs-lookup"><span data-stu-id="4ee6f-337">Command Type Text</span></span>  
 <span data-ttu-id="4ee6f-338">创建 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 数据集时，默认情况下，关系查询设计器将会打开。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-338">When you create a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] dataset, the relational query designer opens by default.</span></span> <span data-ttu-id="4ee6f-339">若要切换为基于文本的查询设计器，请单击工具栏上的“编辑为文本”切换按钮。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-339">To switch to the text-based query designer, click the **Edit As Text** toggle button on the toolbar.</span></span> <span data-ttu-id="4ee6f-340">基于文本的查询设计器将显示两个窗格：“查询”窗格和“结果”窗格。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-340">The text-based query designer presents two panes: the Query pane and the Result pane.</span></span> <span data-ttu-id="4ee6f-341">下图标出了每个窗格。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-341">The following figure labels each pane.</span></span>  
  
 <span data-ttu-id="4ee6f-342">![用于关系数据查询的通用查询设计器](media/rsqd-dsaw-sql-generic.gif "用于关系数据查询的通用查询设计器")</span><span class="sxs-lookup"><span data-stu-id="4ee6f-342">![Generic query designer, for relational data query](media/rsqd-dsaw-sql-generic.gif "Generic query designer, for relational data query")</span></span>  
  
 <span data-ttu-id="4ee6f-343">下表介绍了每个窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-343">The following table describes the function of each pane.</span></span>  
  
|<span data-ttu-id="4ee6f-344">窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-344">Pane</span></span>|<span data-ttu-id="4ee6f-345">函数</span><span class="sxs-lookup"><span data-stu-id="4ee6f-345">Function</span></span>|  
|----------|--------------|  
|<span data-ttu-id="4ee6f-346">查询</span><span class="sxs-lookup"><span data-stu-id="4ee6f-346">Query</span></span>|<span data-ttu-id="4ee6f-347">显示 SQL 查询文本。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-347">Displays the SQL query text.</span></span> <span data-ttu-id="4ee6f-348">使用此窗格可以编写或编辑 SQL 查询。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-348">Use this pane to write or edit a SQL query.</span></span>|  
|<span data-ttu-id="4ee6f-349">结果</span><span class="sxs-lookup"><span data-stu-id="4ee6f-349">Result</span></span>|<span data-ttu-id="4ee6f-350">显示查询的结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-350">Displays the results of the query.</span></span> <span data-ttu-id="4ee6f-351">若要运行查询，请右键单击任意窗格，然后单击“运行”，或者单击工具栏中的“运行”按钮 。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-351">To run the query, right-click in any pane and click **Run**, or click the **Run** button on the toolbar.</span></span>|  
  
#### <a name="example"></a><span data-ttu-id="4ee6f-352">示例</span><span class="sxs-lookup"><span data-stu-id="4ee6f-352">Example</span></span>  
 <span data-ttu-id="4ee6f-353">以下查询将从名为 `ContactType` 的表中返回名字列表。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-353">The following query returns the list of names from a table named `ContactType`.</span></span>  
  
```sql  
SELECT Name FROM ContactType  
```  
  
 <span data-ttu-id="4ee6f-354">单击工具栏上的 **“运行”** 时，将运行 **“查询”** 窗格中的命令，并在 **“结果”** 窗格中显示结果（即名字列表）。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-354">When you click **Run** on the toolbar, the command in the **Query** pane runs and the results, a list of names, are displayed in the **Result** pane.</span></span>  
  
#### <a name="command-type-storedprocedure"></a><span data-ttu-id="4ee6f-355">命令类型 StoredProcedure</span><span class="sxs-lookup"><span data-stu-id="4ee6f-355">Command Type StoredProcedure</span></span>  
 <span data-ttu-id="4ee6f-356">选择“Command typeStoredProcedure”时，基于文本的查询设计器将显示两个窗格：“查询”窗格和“结果”窗格。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-356">When you select **Command typeStoredProcedure**, the text-based query designer presents two panes: the Query pane and the Result pane.</span></span> <span data-ttu-id="4ee6f-357">在“查询”窗格中输入存储过程的名称，然后单击工具栏中的 **“运行”** 按钮。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-357">Enter the stored procedure name in the Query pane and click **Run** on the toolbar.</span></span> <span data-ttu-id="4ee6f-358">如果存储过程使用参数，将打开 **“定义查询参数”** 对话框。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-358">If the stored procedures uses parameters, the **Define Query Parameters** dialog box opens.</span></span> <span data-ttu-id="4ee6f-359">输入存储过程的参数值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-359">Enter the parameter values for the stored procedure.</span></span>  
  
 <span data-ttu-id="4ee6f-360">下图显示运行存储过程时的“查询”和“结果”窗格。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-360">The following figure shows the Query and Results panes when you run a stored procedure.</span></span> <span data-ttu-id="4ee6f-361">在此示例中，输入参数为常量。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-361">In this case, the input parameters are constants.</span></span>  
  
 <span data-ttu-id="4ee6f-362">![基于文本的查询设计器中的存储过程](media/rs-relational-text-sp.gif "基于文本的查询设计器中的存储过程")</span><span class="sxs-lookup"><span data-stu-id="4ee6f-362">![Stored procedure in text-based query designer](media/rs-relational-text-sp.gif "Stored procedure in text-based query designer")</span></span>  
  
 <span data-ttu-id="4ee6f-363">下表介绍了每个窗格的功能。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-363">The following table describes the function of each pane.</span></span>  
  
|<span data-ttu-id="4ee6f-364">窗格</span><span class="sxs-lookup"><span data-stu-id="4ee6f-364">Pane</span></span>|<span data-ttu-id="4ee6f-365">函数</span><span class="sxs-lookup"><span data-stu-id="4ee6f-365">Function</span></span>|  
|----------|--------------|  
|<span data-ttu-id="4ee6f-366">查询</span><span class="sxs-lookup"><span data-stu-id="4ee6f-366">Query</span></span>|<span data-ttu-id="4ee6f-367">显示存储过程的名称和所有输入参数。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-367">Displays the name of the stored procedure and any input parameters.</span></span>|  
|<span data-ttu-id="4ee6f-368">结果</span><span class="sxs-lookup"><span data-stu-id="4ee6f-368">Result</span></span>|<span data-ttu-id="4ee6f-369">显示查询的结果。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-369">Displays the results of the query.</span></span> <span data-ttu-id="4ee6f-370">若要运行查询，请右键单击任意窗格，然后单击“运行”，或者单击工具栏中的“运行”按钮 。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-370">To run the query, right-click in any pane and click **Run**, or click the **Run** button on the toolbar.</span></span>|  
  
#### <a name="example"></a><span data-ttu-id="4ee6f-371">示例</span><span class="sxs-lookup"><span data-stu-id="4ee6f-371">Example</span></span>  
 <span data-ttu-id="4ee6f-372">以下查询将调用名为 `uspGetWhereUsedProductID` 的存储过程。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-372">The following query calls the a stored procedure named `uspGetWhereUsedProductID`.</span></span> <span data-ttu-id="4ee6f-373">该存储过程具有输入参数时，您在运行查询时必须提供参数值。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-373">When the stored procedure has input parameters you must provide parameter values when you run the query.</span></span>  
  
```sql  
uspGetWhereUsedProductID  
```  
  
 <span data-ttu-id="4ee6f-374">单击“运行”( **!** ) 按钮。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-374">Click the **Run** (**!**) button.</span></span> <span data-ttu-id="4ee6f-375">下表提供了在 `uspGetWhereUsedProductID` "**定义查询参数**" 对话框中提供值的参数示例。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-375">The following table provides an example of `uspGetWhereUsedProductID` parameters for which you provide values in the **Define Query Parameter** dialog box.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="4ee6f-376">*\@StartProductID*</span><span class="sxs-lookup"><span data-stu-id="4ee6f-376">*\@StartProductID*</span></span>|<span data-ttu-id="4ee6f-377">820</span><span class="sxs-lookup"><span data-stu-id="4ee6f-377">820</span></span>|  
|<span data-ttu-id="4ee6f-378">*\@CheckDate*</span><span class="sxs-lookup"><span data-stu-id="4ee6f-378">*\@CheckDate*</span></span>|<span data-ttu-id="4ee6f-379">20010115</span><span class="sxs-lookup"><span data-stu-id="4ee6f-379">20010115</span></span>|  
  
#### <a name="command-type-tabledirect"></a><span data-ttu-id="4ee6f-380">命令类型 TableDirect</span><span class="sxs-lookup"><span data-stu-id="4ee6f-380">Command Type TableDirect</span></span>  
 <span data-ttu-id="4ee6f-381">选择“Command typeTableDirect”时，基于文本的查询设计器将显示两个窗格：“查询”窗格和“结果”窗格。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-381">When you select **Command typeTableDirect**, the text-based query designer presents two panes: the Query pane and the Result pane.</span></span> <span data-ttu-id="4ee6f-382">如果输入一个表并单击 **“运行”** 按钮，则将返回该表的所有列。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-382">When you enter a table and click the **Run** button, all the columns for that table are returned.</span></span>  
  
#### <a name="example"></a><span data-ttu-id="4ee6f-383">示例</span><span class="sxs-lookup"><span data-stu-id="4ee6f-383">Example</span></span>  
 <span data-ttu-id="4ee6f-384">对于数据源类型 OLE DB，以下数据集查询将为 `ContactType` 表中所有联系人类型返回结果集。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-384">For a data source type OLE DB, the following dataset query returns a result set for all contact types in the `ContactType` table.</span></span>  
  
 `ContactType`  
  
 <span data-ttu-id="4ee6f-385">输入表名 `ContactType` 时，它等同于创建 SQL 语句 `SELECT * FROM ContactType`。</span><span class="sxs-lookup"><span data-stu-id="4ee6f-385">When you enter the table name `ContactType`, it is the equivalent of creating the SQL statement `SELECT * FROM ContactType`.</span></span>  
  
  
