---
title: DirectQuery 部署方案 (SSAS 表格) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 2aaf5cb8-294b-4031-94b3-fe605d7fc4c7
author: minewiskan
ms.author: owend
ms.openlocfilehash: 2c90d90b40686b5953e26853ed9f53dcfd157f0f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87590983"
---
# <a name="directquery-deployment-scenarios-ssas-tabular"></a><span data-ttu-id="9eebc-102">DirectQuery 部署方案（SSAS 表格）</span><span class="sxs-lookup"><span data-stu-id="9eebc-102">DirectQuery Deployment Scenarios (SSAS Tabular)</span></span>
  <span data-ttu-id="9eebc-103">本主题提供 DirectQuery 模型的设计和部署过程的演练。</span><span class="sxs-lookup"><span data-stu-id="9eebc-103">This topic provides a walkthrough of the design and deployment process for DirectQuery models.</span></span> <span data-ttu-id="9eebc-104">您可以将 DirectQuery 配置为只使用关系数据（仅限 DirectQuery），也可以将模型配置为在仅使用缓存数据或仅使用关系数据之间进行切换（混合模式）。</span><span class="sxs-lookup"><span data-stu-id="9eebc-104">You can configure DirectQuery to use relational data only (DirectQuery only), or you can configure the model to switch between using cached data only or relational data only (hybrid mode).</span></span> <span data-ttu-id="9eebc-105">本主题说明了两种模式的实现过程，并根据模式和安全配置描述有关查询结果的可能的差异。</span><span class="sxs-lookup"><span data-stu-id="9eebc-105">This topic explains the implementation process for both modes, and describes possible differences in query results depending on the mode and the security configuration.</span></span>  
  
 [<span data-ttu-id="9eebc-106">设计和部署步骤</span><span class="sxs-lookup"><span data-stu-id="9eebc-106">Design and Deployment Steps</span></span>](#bkmk_DQProcedure)  
  
 [<span data-ttu-id="9eebc-107">比较 DirectQuery 配置</span><span class="sxs-lookup"><span data-stu-id="9eebc-107">Comparing DirectQuery Configurations</span></span>](#bkmk_Configurations)  
  
##  <a name="design-and-deployment-steps"></a><a name="bkmk_DQProcedure"></a><span data-ttu-id="9eebc-108">设计和部署步骤</span><span class="sxs-lookup"><span data-stu-id="9eebc-108">Design and Deployment Steps</span></span>  
 <span data-ttu-id="9eebc-109">**步骤1。创建解决方案**</span><span class="sxs-lookup"><span data-stu-id="9eebc-109">**Step 1. Create the solution**</span></span>  
  
 <span data-ttu-id="9eebc-110">不论您使用哪种模式，都必须查看描述有关可用于 DirectQuery 模型的数据的限制信息。</span><span class="sxs-lookup"><span data-stu-id="9eebc-110">Regardless of which mode you will use, you must review the information that describes limitations on the data that can be used in DirectQuery models.</span></span> <span data-ttu-id="9eebc-111">例如，所有用于模型和报表的数据必须来自单个 SQL Server 数据库。</span><span class="sxs-lookup"><span data-stu-id="9eebc-111">For example, all the data used in your model and reports must come from a single SQL Server database.</span></span> <span data-ttu-id="9eebc-112">有关详细信息，请参阅 [DirectQuery 模式（SSAS 表格）](tabular-models/directquery-mode-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="9eebc-112">For more information, see [DirectQuery Mode &#40;SSAS Tabular&#41;](tabular-models/directquery-mode-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="9eebc-113">也可以查看对度量值和计算列的限制，并确定您要使用的公式是否与 DirectQuery 模式兼容。</span><span class="sxs-lookup"><span data-stu-id="9eebc-113">Also, review the limitations on measures and calculated columns, and determine whether the formulas you intend to use are compatible with DirectQuery mode.</span></span> <span data-ttu-id="9eebc-114">您可能需要删除或修改以下元素：</span><span class="sxs-lookup"><span data-stu-id="9eebc-114">You might need to remove or modify the following elements:</span></span>  
  
-   <span data-ttu-id="9eebc-115">不支持计算列。</span><span class="sxs-lookup"><span data-stu-id="9eebc-115">Calculated columns are not supported.</span></span>  
  
-   <span data-ttu-id="9eebc-116">不能使用复制粘贴的数据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-116">Copy-pasted data cannot be used.</span></span> <span data-ttu-id="9eebc-117">如果您导入 PowerPivot 模型来开始您的解决方案，请确保在导入该解决方案之前删除链接表，因为该数据无法删除且将阻止 DirectQuery 验证。</span><span class="sxs-lookup"><span data-stu-id="9eebc-117">If you import a PowerPivot model to jumpstart your solution, be sure to delete linked tables before importing the solution, as this data cannot be deleted and will block DirectQuery validation.</span></span>  
  
 <span data-ttu-id="9eebc-118">**步骤2。在模型设计器中启用 DirectQuery 模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-118">**Step 2. Enable DirectQuery mode in the model designer**</span></span>  
  
 <span data-ttu-id="9eebc-119">默认情况下，DirectQuery 将被禁用。</span><span class="sxs-lookup"><span data-stu-id="9eebc-119">By default, DirectQuery is disabled.</span></span> <span data-ttu-id="9eebc-120">因此，您必须配置设计环境以便支持 DirectQuery 模式。</span><span class="sxs-lookup"><span data-stu-id="9eebc-120">Therefore, you must configure the design environment to support DirectQuery mode.</span></span>  
  
 <span data-ttu-id="9eebc-121">在解决方案资源管理器中右键单击 " **model.bim** " 节点，并将属性 " **DirectQuery 模式**" 设置为 `On` 。</span><span class="sxs-lookup"><span data-stu-id="9eebc-121">Right-click the **Model.bim** node in Solution Explorer and set the property, **DirectQuery Mode**, to `On`.</span></span>  
  
 <span data-ttu-id="9eebc-122">您可以随时启用 DirectQuery；但是，为了确保您不会创建与 DirectQuery 模式不兼容的列或公式，我们建议您从一开始就启用 DirectQuery 模式。</span><span class="sxs-lookup"><span data-stu-id="9eebc-122">You can turn on DirectQuery at any time; however, to ensure that you do not create columns or formulas that are incompatible with DirectQuery mode, we recommend that you enable DirectQuery mode right from the beginning.</span></span>  
  
 <span data-ttu-id="9eebc-123">最初，甚至始终在内存中创建 DirectQuery 模型。</span><span class="sxs-lookup"><span data-stu-id="9eebc-123">Initially, even DirectQuery models are always created in memory.</span></span> <span data-ttu-id="9eebc-124">工作区数据库的默认查询模式也设置为 **“DirectQuery 以及内存中”**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-124">The default query mode for the workspace database is also set to **DirectQuery with In-Memory**.</span></span> <span data-ttu-id="9eebc-125">使用此混合工作模式，您可以在对照 DirectQuery 要求验证模型的同时，继续使用导入数据的缓存，以便在模型设计过程中提高性能。</span><span class="sxs-lookup"><span data-stu-id="9eebc-125">This hybrid working mode lets you use the cache of imported data for improved performance during the model design process, while validating the model against DirectQuery requirements.</span></span>  
  
 <span data-ttu-id="9eebc-126">**步骤3。解决验证错误**</span><span class="sxs-lookup"><span data-stu-id="9eebc-126">**Step 3. Resolve validation errors**</span></span>  
  
 <span data-ttu-id="9eebc-127">如果您在启用 DirectQuery 时或在添加新的数据或公式时遇到验证错误，则打开 Visual Studio 的 **“错误列表”**，然后执行所需操作。</span><span class="sxs-lookup"><span data-stu-id="9eebc-127">If you get validation errors when you turn DirectQuery on, or when you add new data or formulas, open the Visual Studio **Error List**, and then take the required actions.</span></span>  
  
-   <span data-ttu-id="9eebc-128">根据错误消息中的说明，更改针对 DirectQuery 模式的所有所需的属性设置。</span><span class="sxs-lookup"><span data-stu-id="9eebc-128">Change any required property settings for DirectQuery mode, as described in the error messages.</span></span>  
  
-   <span data-ttu-id="9eebc-129">删除计算列。</span><span class="sxs-lookup"><span data-stu-id="9eebc-129">Remove calculated columns.</span></span> <span data-ttu-id="9eebc-130">如果需要特定度量值的计算列，则始终可以通过使用 "表导入向导" 中提供的 "[关系查询设计器 &#40;SSAS&#41;](relational-query-designer-ssas.md)来创建列。</span><span class="sxs-lookup"><span data-stu-id="9eebc-130">If you require a calculated column for a particular measure, you can always create the column by using the [Relational Query Designer &#40;SSAS&#41;](relational-query-designer-ssas.md) provided in the Table Import wizard.</span></span>  
  
-   <span data-ttu-id="9eebc-131">修改或删除与 DirectQuery 模式不兼容的公式。</span><span class="sxs-lookup"><span data-stu-id="9eebc-131">Modify or remove formulas that are incompatible with DirectQuery mode.</span></span> <span data-ttu-id="9eebc-132">如果您需要特定函数来进行计算，可考虑采用可通过使用 Transact-SQL 来提供等效值的方法。</span><span class="sxs-lookup"><span data-stu-id="9eebc-132">If you require a particular function for a calculation, consider ways that you could provide an equivalent by using Transact-SQL.</span></span>  
  
-   <span data-ttu-id="9eebc-133">根据需要添加数据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-133">Add data as needed.</span></span>  <span data-ttu-id="9eebc-134">如果您的模型之前使用复制粘贴数据或来自 SQL Server 之外的访问接口的数据，您可以在现有连接内创建新的视图和派生列，或者使用分布式查询。</span><span class="sxs-lookup"><span data-stu-id="9eebc-134">If your model previously used copy-paste data or data from providers other than SQL Server, you can create new views and derived columns within the existing connection, or use distributed queries.</span></span>  <span data-ttu-id="9eebc-135">DirectQuery 模型中使用的所有数据必须可通过单个 SQL Server 数据源进行访问。</span><span class="sxs-lookup"><span data-stu-id="9eebc-135">All data used in a DirectQuery model must be accessible via a single SQL Server data source.</span></span>  
  
 <span data-ttu-id="9eebc-136">**步骤4。设置用于响应模型查询的首选方法**</span><span class="sxs-lookup"><span data-stu-id="9eebc-136">**Step 4. Set the preferred method for answering queries on the model**</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-137">**仅限 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-137">**DirectQuery only**</span></span>|<span data-ttu-id="9eebc-138">将属性设置为 **DirectQuery**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-138">Set the property to **DirectQuery**.</span></span>|  
|<span data-ttu-id="9eebc-139">**混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-139">**Hybrid mode**</span></span>|<span data-ttu-id="9eebc-140">将属性设置为 **“内存中以及 DirectQuery”** 或 **“DirectQuery 以及内存中”**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-140">Set the property to **In-Memory With DirectQuery** or **DirectQuery With In-Memory**.</span></span><br /><br /> <span data-ttu-id="9eebc-141">稍后您可以更改此值以使用不同的首选项。</span><span class="sxs-lookup"><span data-stu-id="9eebc-141">You can change this value later to use a different preference.</span></span><br /><br /> <span data-ttu-id="9eebc-142">请注意，客户端可能覆盖连接字符串中的首选方法。</span><span class="sxs-lookup"><span data-stu-id="9eebc-142">Note that clients can override the preferred method in the connection string.</span></span>|  
  
 <span data-ttu-id="9eebc-143">**步骤5。指定 DirectQuery 分区**</span><span class="sxs-lookup"><span data-stu-id="9eebc-143">**Step 5. Specify the DirectQuery partition**</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-144">**仅限 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-144">**DirectQuery only**</span></span>|<span data-ttu-id="9eebc-145">可选。</span><span class="sxs-lookup"><span data-stu-id="9eebc-145">Optional.</span></span> <span data-ttu-id="9eebc-146">仅 DirectQuery 模型无需分区。</span><span class="sxs-lookup"><span data-stu-id="9eebc-146">A DirectQuery only model has no need for a partition.</span></span><br /><br /> <span data-ttu-id="9eebc-147">但是，如果您在设计阶段在模型中创建了分区，请注意仅有一个分区可用作数据源。</span><span class="sxs-lookup"><span data-stu-id="9eebc-147">However, if you created partitions in the model during the design phase, remember that only one partition can be used as the data source.</span></span> <span data-ttu-id="9eebc-148">默认情况下，创建的第一个分区将用作 DirectQuery 分区。</span><span class="sxs-lookup"><span data-stu-id="9eebc-148">By default the first partition you created will be used as the DirectQuery partition.</span></span><br /><br /> <span data-ttu-id="9eebc-149">若要确保模型所需的所有数据可以从 DirectQuery 分区中获取，请选择一个 DirectQuery 分区，并编辑 SQL 语句以获得整个数据集。</span><span class="sxs-lookup"><span data-stu-id="9eebc-149">To ensure that all the data required by the model is available from the DirectQuery partition, choose a DirectQuery partition and edit the SQL statement to get the entire data set.</span></span>|  
|<span data-ttu-id="9eebc-150">**混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-150">**Hybrid mode**</span></span>|<span data-ttu-id="9eebc-151">如果您的模型中的任意表包含多个分区，您必须选择单个分区作为“DirectQuery 分区” \*\*。</span><span class="sxs-lookup"><span data-stu-id="9eebc-151">If any table in your model has multiple partitions, you must choose a single partition as the *DirectQuery partition*.</span></span> <span data-ttu-id="9eebc-152">如果您没有指派分区，则默认情况下，创建的第一个分区将用作 DirectQuery 分区。</span><span class="sxs-lookup"><span data-stu-id="9eebc-152">If you do not assign a partition, by default, the first partition that was created will be used as the DirectQuery partition.</span></span><br /><br /> <span data-ttu-id="9eebc-153">设置除 DirectQuery 以外的所有分区的处理选项。</span><span class="sxs-lookup"><span data-stu-id="9eebc-153">Set processing options on all partitions except the DirectQuery.</span></span> <span data-ttu-id="9eebc-154">通常，始终不处理 DirectQuery 分区，因为数据是通过关系源传递的。</span><span class="sxs-lookup"><span data-stu-id="9eebc-154">Typically the DirectQuery partition is never processed, because the data is passed through from the relational source.</span></span><br /><br /> <span data-ttu-id="9eebc-155">有关详细信息，请参阅[&#40;SSAS 表格&#41;的分区和 DirectQuery 模式](tabular-models/define-partitions-in-directquery-models-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="9eebc-155">For more information, see [Partitions and DirectQuery Mode &#40;SSAS Tabular&#41;](tabular-models/define-partitions-in-directquery-models-ssas-tabular.md).</span></span>|  
  
 <span data-ttu-id="9eebc-156">**步骤6。配置模拟**</span><span class="sxs-lookup"><span data-stu-id="9eebc-156">**Step 6. Configure impersonation**</span></span>  
  
 <span data-ttu-id="9eebc-157">仅 DirectQuery 模型支持模拟。</span><span class="sxs-lookup"><span data-stu-id="9eebc-157">Impersonation is supported only for DirectQuery models.</span></span> <span data-ttu-id="9eebc-158">模拟选项（ **“模拟设置”**）定义在查看来自指定的 SQL Server 数据源的数据时使用的凭据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-158">The impersonation option, **Impersonation Settings**, defines the credentials that are used when viewing data from the specified SQL Server data source.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-159">**仅限 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-159">**DirectQuery only**</span></span>|<span data-ttu-id="9eebc-160">对于  **“模拟设置”** 属性，请指定将用于连接到 SQL Server 数据源的帐户。</span><span class="sxs-lookup"><span data-stu-id="9eebc-160">For the  **Impersonation Settings** property, specify the account that will be used to connect to the SQL Server data source.</span></span><br /><br /> <span data-ttu-id="9eebc-161">如果您使用值 **ImpersonateCurrentUser**，则承载该模型的 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 实例会将模型的当前用户的凭据传递到 SQL Server 数据库。</span><span class="sxs-lookup"><span data-stu-id="9eebc-161">If you use the value, **ImpersonateCurrentUser**, the instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] that hosts the model will pass the credentials of the current user of the model to the SQL Server database.</span></span>|  
|<span data-ttu-id="9eebc-162">**混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-162">**Hybrid mode**</span></span>|<span data-ttu-id="9eebc-163">对于 **“模拟设置”** 属性，请指定将用于访问 SQL Server 数据源中的数据的帐户。</span><span class="sxs-lookup"><span data-stu-id="9eebc-163">For the **Impersonation Settings** property, specify the account that will be used to access the data in the SQL Server data source.</span></span><br /><br /> <span data-ttu-id="9eebc-164">此设置并不影响用于处理模型使用的缓存的凭据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-164">This setting does not affect the credentials that are used to process the cache used by the model.</span></span>|  
  
 <span data-ttu-id="9eebc-165">**步骤7。部署模型**</span><span class="sxs-lookup"><span data-stu-id="9eebc-165">**Step 7. Deploy the model**</span></span>  
  
 <span data-ttu-id="9eebc-166">准备好部署模型时，请打开 Visual Studio 的 "**项目**" 菜单，然后选择 "**属性**"。</span><span class="sxs-lookup"><span data-stu-id="9eebc-166">When you are ready to deploy the model, open the **Project** menu of Visual Studio, and select **Properties**.</span></span> <span data-ttu-id="9eebc-167">将 **QueryMode** 属性设置为如下表所示的值之一：</span><span class="sxs-lookup"><span data-stu-id="9eebc-167">Set the **QueryMode** property to one of the values described in the following table:</span></span>  
  
 <span data-ttu-id="9eebc-168">有关详细信息，请参阅[&#40;SSAS 表格&#41;中 SQL Server Data Tools 部署](tabular-models/deploy-from-sql-server-data-tools-ssas-tabular.md)。</span><span class="sxs-lookup"><span data-stu-id="9eebc-168">For more information, see [Deploy From SQL Server Data Tools &#40;SSAS Tabular&#41;](tabular-models/deploy-from-sql-server-data-tools-ssas-tabular.md).</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-169">**仅限 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-169">**DirectQuery only**</span></span>|<span data-ttu-id="9eebc-170">**DirectQueryOnly**</span><span class="sxs-lookup"><span data-stu-id="9eebc-170">**DirectQueryOnly**</span></span><br /><br /> <span data-ttu-id="9eebc-171">因为您仅指定了直接查询，所以，模型元数据将部署到服务器，但不对模型进行处理。</span><span class="sxs-lookup"><span data-stu-id="9eebc-171">Because you have specified Direct Query only, the metadata of the model is deployed to the server, but the model is not processed.</span></span><br /><br /> <span data-ttu-id="9eebc-172">请注意，将不自动删除工作区数据库使用的缓存。</span><span class="sxs-lookup"><span data-stu-id="9eebc-172">Note that the cache that was used by the workspace database is not automatically deleted.</span></span> <span data-ttu-id="9eebc-173">如果您想要确保用户无法看到缓存数据，则最好清除设计时缓存。</span><span class="sxs-lookup"><span data-stu-id="9eebc-173">If you want to ensure that users are not able to see the cached data, you might wish to clear the design-time cache.</span></span> <span data-ttu-id="9eebc-174">有关详细信息，请参阅[清除 Analysis Services 缓存](instances/clear-the-analysis-services-caches.md)。</span><span class="sxs-lookup"><span data-stu-id="9eebc-174">For more information, see [Clear the Analysis Services Caches](instances/clear-the-analysis-services-caches.md).</span></span>|  
|<span data-ttu-id="9eebc-175">**混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-175">**Hybrid mode**</span></span>|<span data-ttu-id="9eebc-176">**“DirectQuery 以及内存中”**</span><span class="sxs-lookup"><span data-stu-id="9eebc-176">**DirectQuery with In-Memory**</span></span><br /><br /> <span data-ttu-id="9eebc-177">**内存中的 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-177">**In-Memory with DirectQuery**</span></span><br /><br /> <span data-ttu-id="9eebc-178">这两个值都允许您根据需要使用缓存或关系数据源。</span><span class="sxs-lookup"><span data-stu-id="9eebc-178">Both of these values allow you to use either the cache or the relational data source as necessary.</span></span> <span data-ttu-id="9eebc-179">其顺序将定义在响应针对模型的查询时默认使用哪一数据源。</span><span class="sxs-lookup"><span data-stu-id="9eebc-179">The order defines which data source is used by default when answering queries against the model.</span></span><br /><br /> <span data-ttu-id="9eebc-180">在混合模式中，必须在将模型元数据部署到服务器的同时处理缓存。</span><span class="sxs-lookup"><span data-stu-id="9eebc-180">In a hybrid mode, the cache must be processed at the same time that the model metadata is deployed to the server.</span></span><br /><br /> <span data-ttu-id="9eebc-181">您可以在部署后更改此设置。</span><span class="sxs-lookup"><span data-stu-id="9eebc-181">You can change this setting after deployment.</span></span>|  
  
 <span data-ttu-id="9eebc-182">**步骤8。验证部署的模型**</span><span class="sxs-lookup"><span data-stu-id="9eebc-182">**Step 8. Verify deployed model**</span></span>  
  
 <span data-ttu-id="9eebc-183">在 [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)]中，打开部署了该模型的 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="9eebc-183">In [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], open the instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] where you deployed the model.</span></span> <span data-ttu-id="9eebc-184">右键单击数据库名称并选择 **“属性”**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-184">Right-click the name of the database and select **Properties**.</span></span>  
  
-   <span data-ttu-id="9eebc-185">当您在定义部署属性时，设置属性 **DirectQueryMode**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-185">The property, **DirectQueryMode**, was set when you defined the deployment properties.</span></span>  
  
-   <span data-ttu-id="9eebc-186">当您在定义用户模拟选项时，设置属性 **“数据源模拟信息”**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-186">The property, **Data Source Impersonation Info**, was set when you defined the user impersonation options.</span></span> <span data-ttu-id="9eebc-187">有关详细信息，请参阅[设置模拟选项（SSAS - 多维）](multidimensional-models/set-impersonation-options-ssas-multidimensional.md)。</span><span class="sxs-lookup"><span data-stu-id="9eebc-187">For more information, see [Set Impersonation Options &#40;SSAS - Multidimensional&#41;](multidimensional-models/set-impersonation-options-ssas-multidimensional.md).</span></span>  
  
-   <span data-ttu-id="9eebc-188">在部署了模型后，您可以随时更改这些属性。</span><span class="sxs-lookup"><span data-stu-id="9eebc-188">You can change these properties any time after the model has been deployed.</span></span>  
  
##  <a name="comparing-directquery-options"></a><a name="bkmk_Configurations"></a><span data-ttu-id="9eebc-189">比较 DirectQuery 选项</span><span class="sxs-lookup"><span data-stu-id="9eebc-189">Comparing DirectQuery Options</span></span>  
 <span data-ttu-id="9eebc-190">**仅限 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-190">**DirectQuery Only**</span></span>  
 <span data-ttu-id="9eebc-191">在您想要确保单个数据源时，或者您的数据太大以致内存中容纳不下时，此选项是首选选项。</span><span class="sxs-lookup"><span data-stu-id="9eebc-191">This option is preferred when you want to guarantee a single source of data, or when your data is too large to fit in memory.</span></span> <span data-ttu-id="9eebc-192">如果您在设计时使用非常大的关系数据源，则可以通过使用数据的某个子集创建模型。</span><span class="sxs-lookup"><span data-stu-id="9eebc-192">If you are working with a very large relational data source, during design time you can create the model by using some subset of the data.</span></span> <span data-ttu-id="9eebc-193">当您在仅 DirectQuery 模式下部署模型时，可以编辑数据源定义以包含所有所需数据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-193">When you deploy the model in DirectQuery only mode, you can edit the data source definition to include all the required data.</span></span>  
  
 <span data-ttu-id="9eebc-194">如果您想要使用关系数据源提供的安全性来控制用户对数据的访问，此选项也是首选选项。</span><span class="sxs-lookup"><span data-stu-id="9eebc-194">This option is also preferred if you want to use the security provided by the relational data source to control user access to data.</span></span> <span data-ttu-id="9eebc-195">通过缓存的表格模型，您还可以使用 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] 角色控制数据访问，但还必须确保缓存中存储的数据的安全。</span><span class="sxs-lookup"><span data-stu-id="9eebc-195">With cached tabular models, you can also use [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] roles to control data access, but the data stored in the cache must also be secured.</span></span> <span data-ttu-id="9eebc-196">如果您的安全上下文要求数据应该永远不缓存，则您应该始终使用此选项。</span><span class="sxs-lookup"><span data-stu-id="9eebc-196">You should always use this option if your security context requires that data should never be cached.</span></span>  
  
 <span data-ttu-id="9eebc-197">下表描述了有关仅 DirectQuery 模式的可能的部署结果：</span><span class="sxs-lookup"><span data-stu-id="9eebc-197">The following table describes the possible deployment outcomes for DirectQuery only mode:</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-198">**无缓存的 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-198">**DirectQuery with no cache**</span></span>|<span data-ttu-id="9eebc-199">不向缓存中加载任何数据。</span><span class="sxs-lookup"><span data-stu-id="9eebc-199">No data is loaded into the cache.</span></span> <span data-ttu-id="9eebc-200">永远不能处理模型。</span><span class="sxs-lookup"><span data-stu-id="9eebc-200">The model can never be processed.</span></span><br /><br /> <span data-ttu-id="9eebc-201">只能通过使用支持 DAX 查询的客户端对模型进行查询。</span><span class="sxs-lookup"><span data-stu-id="9eebc-201">The model can only be queried by using clients that support DAX queries.</span></span> <span data-ttu-id="9eebc-202">查询结果始终从原始数据源返回。</span><span class="sxs-lookup"><span data-stu-id="9eebc-202">Query results are always returned from the original data source.</span></span><br /><br /> <span data-ttu-id="9eebc-203">**DirectQueryMode** = `On`</span><span class="sxs-lookup"><span data-stu-id="9eebc-203">**DirectQueryMode** = `On`</span></span><br /><br /> <span data-ttu-id="9eebc-204">**QueryMode**  = **DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-204">**QueryMode** = **DirectQuery**</span></span>|  
|<span data-ttu-id="9eebc-205">**DirectQuery 并且查询仅针对缓存**</span><span class="sxs-lookup"><span data-stu-id="9eebc-205">**DirectQuery with queries against cache only**</span></span>|<span data-ttu-id="9eebc-206">部署失败。</span><span class="sxs-lookup"><span data-stu-id="9eebc-206">Deployment fails.</span></span> <span data-ttu-id="9eebc-207">此配置不受支持。</span><span class="sxs-lookup"><span data-stu-id="9eebc-207">This configuration is not supported.</span></span><br /><br /> <span data-ttu-id="9eebc-208">**DirectQueryMode** = `On`</span><span class="sxs-lookup"><span data-stu-id="9eebc-208">**DirectQueryMode** = `On`</span></span><br /><br /> <span data-ttu-id="9eebc-209">**QueryMode**  = **内存中**</span><span class="sxs-lookup"><span data-stu-id="9eebc-209">**QueryMode** = **In-Memory**</span></span>|  
  
 <span data-ttu-id="9eebc-210">**混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-210">**Hybrid mode**</span></span>  
 <span data-ttu-id="9eebc-211">在混合模式中部署您的模型具有许多好处：您可以根据需要从 SQL Server 数据源获取最新数据，但通过保留缓存，您能够使用内存中的数据以便在设计报表或测试模型时提高速度。</span><span class="sxs-lookup"><span data-stu-id="9eebc-211">Deploying your model in a hybrid mode has many advantages: you can get up-to-date data from the SQL Server data source if needed, but preserving the cache gives you the ability to work with data in memory for faster performance while designing reports or testing the model.</span></span>  
  
 <span data-ttu-id="9eebc-212">如果您的模型非常大，DirectQuery 混合模式也很有用。</span><span class="sxs-lookup"><span data-stu-id="9eebc-212">A DirectQuery hybrid mode is also useful if your model is very large.</span></span> <span data-ttu-id="9eebc-213">您可以在正在进行处理时将模型切换到 DirectQuery 模式，而不是让用户获取陈旧数据或在处理缓存时让模型不可用。</span><span class="sxs-lookup"><span data-stu-id="9eebc-213">Rather than have users get stale data or have the model be unavailable while the cache is processed, you can switch the model to DirectQuery mode while processing is in progress.</span></span> <span data-ttu-id="9eebc-214">用户可能会体验到速度稍慢的性能，但将能够直接从关系存储区获取数据，这确保结果是最新的。</span><span class="sxs-lookup"><span data-stu-id="9eebc-214">Users might experience slightly slower performance but they would be able to get data directly from the relational store, ensuring that results were up-to-date.</span></span>  
  
 <span data-ttu-id="9eebc-215">下表比较 DirectQuery 选项的每种组合的部署结果。</span><span class="sxs-lookup"><span data-stu-id="9eebc-215">The following table compares the deployment outcome in each of the combinations of DirectQuery options.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9eebc-216">**缓存为首选的混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-216">**Hybrid mode with cache preferred**</span></span>|<span data-ttu-id="9eebc-217">可以处理模型，并且可以将数据加载到缓存中。</span><span class="sxs-lookup"><span data-stu-id="9eebc-217">The model can be processed and data can be loaded into the cache.</span></span> <span data-ttu-id="9eebc-218">默认情况下，查询使用缓存。</span><span class="sxs-lookup"><span data-stu-id="9eebc-218">Queries use the cache by default.</span></span>  <span data-ttu-id="9eebc-219">如果某一客户端想要使用 DirectQuery 源，则一个参数必须插入到连接字符串中。</span><span class="sxs-lookup"><span data-stu-id="9eebc-219">If a client wants to use the DirectQuery source, a parameter must be inserted in the connection string.</span></span><br /><br /> <span data-ttu-id="9eebc-220">**DirectQueryMode** = `On`</span><span class="sxs-lookup"><span data-stu-id="9eebc-220">**DirectQueryMode** = `On`</span></span><br /><br /> <span data-ttu-id="9eebc-221">**QueryMode**  = **内存中的 DirectQuery**</span><span class="sxs-lookup"><span data-stu-id="9eebc-221">**QueryMode** = **In-Memory with DirectQuery**</span></span>|  
|<span data-ttu-id="9eebc-222">**DirectQuery 为首选的混合模式**</span><span class="sxs-lookup"><span data-stu-id="9eebc-222">**Hybrid mode with DirectQuery preferred**</span></span>|<span data-ttu-id="9eebc-223">对模型进行处理，并且可以将数据加载到缓存中。</span><span class="sxs-lookup"><span data-stu-id="9eebc-223">The model is processed and data can be loaded into the cache.</span></span> <span data-ttu-id="9eebc-224">但是，查询在默认情况下使用 DirectQuery。</span><span class="sxs-lookup"><span data-stu-id="9eebc-224">However, queries use DirectQuery by default.</span></span> <span data-ttu-id="9eebc-225">如果某一客户端想要使用缓存数据，则一个参数必须插入到连接字符串中。</span><span class="sxs-lookup"><span data-stu-id="9eebc-225">If a client wants to use the cached data, a parameter must be inserted in the connection string.</span></span> <span data-ttu-id="9eebc-226">如果对模型中的表进行了分区，则缓存的主分区也设置为 **“内存中以及 DirectQuery”**。</span><span class="sxs-lookup"><span data-stu-id="9eebc-226">If the tables in the model are partitioned, the principal partition of the cache is also set to **In-Memory with DirectQuery**.</span></span><br /><br /> <span data-ttu-id="9eebc-227">**DirectQueryMode** = `On`</span><span class="sxs-lookup"><span data-stu-id="9eebc-227">**DirectQueryMode** = `On`</span></span><br /><br /> <span data-ttu-id="9eebc-228">**QueryMode**  = **DirectQuery 以及内存中**</span><span class="sxs-lookup"><span data-stu-id="9eebc-228">**QueryMode** = **DirectQuery with In-Memory**</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9eebc-229">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9eebc-229">See Also</span></span>  
 <span data-ttu-id="9eebc-230">[DirectQuery 模式 &#40;SSAS 表格&#41;](tabular-models/directquery-mode-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="9eebc-230">[DirectQuery Mode &#40;SSAS Tabular&#41;](tabular-models/directquery-mode-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="9eebc-231">表格模型数据访问</span><span class="sxs-lookup"><span data-stu-id="9eebc-231">Tabular Model Data Access</span></span>](tabular-models/tabular-model-data-access.md)  
  
  
