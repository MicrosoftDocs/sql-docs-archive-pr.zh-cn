---
title: 分区 (Analysis Services 多维数据) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- storage [Analysis Services], partitions
- incremental updates [Analysis Services]
- data sources [Analysis Services], partitions
- data storage [Analysis Services]
- aggregations [Analysis Services], partitions
- OLAP objects [Analysis Services], partitions
- storing data [Analysis Services], partitions
- partitions [Analysis Services], about partitions
- cubes [Analysis Services], partitions
- partitions [Analysis Services]
- remote partitions [Analysis Services]
- measure groups [Analysis Services], partitions
ms.assetid: cd10ad00-468c-4d49-9f8d-873494d04b4f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 86057c14655b3fd2f0322387beb16a4a94717b68
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591620"
---
# <a name="partitions-analysis-services---multidimensional-data"></a><span data-ttu-id="79212-102">分区（Analysis Services - 多维数据）</span><span class="sxs-lookup"><span data-stu-id="79212-102">Partitions (Analysis Services - Multidimensional Data)</span></span>
  <span data-ttu-id="79212-103">分区是一部分度量值组数据的容器。</span><span class="sxs-lookup"><span data-stu-id="79212-103">A partition is a container for a portion of the measure group data.</span></span> <span data-ttu-id="79212-104">从 MDX 查询是看不到分区的，任何查询反映的均是度量值组的全部内容，这与为度量值组定义的分区数量无关。</span><span class="sxs-lookup"><span data-stu-id="79212-104">Partitions are not seen from MDX queries; all queries reflect the whole content of the measure group, regardless of how many partitions are defined for the measure group.</span></span> <span data-ttu-id="79212-105">分区的数据内容由分区的查询绑定和切片表达式定义。</span><span class="sxs-lookup"><span data-stu-id="79212-105">The data content of a partition is defined by the query bindings of the partition, and by the slicing expression.</span></span>  
  
 <span data-ttu-id="79212-106">简单 <xref:Microsoft.AnalysisServices.Partition> 对象由基本信息、切片定义、聚合设计等组成。</span><span class="sxs-lookup"><span data-stu-id="79212-106">A simple <xref:Microsoft.AnalysisServices.Partition> object is composed of: basic information, slicing definition, aggregation design, and others.</span></span> <span data-ttu-id="79212-107">基本信息包括分区的名称、存储模式和处理模式等。</span><span class="sxs-lookup"><span data-stu-id="79212-107">Basic information includes the name of the partition, the storage mode, the processing mode, and others.</span></span> <span data-ttu-id="79212-108">切片定义是指定元组或集的 MDX 表达式。</span><span class="sxs-lookup"><span data-stu-id="79212-108">The slicing definition is an MDX expression specifying a tuple or a set.</span></span> <span data-ttu-id="79212-109">切片定义具有的限制与 StrToSet MDX 函数相同。</span><span class="sxs-lookup"><span data-stu-id="79212-109">The slicing definition has the same restrictions as the StrToSet MDX function.</span></span> <span data-ttu-id="79212-110">借助 CONSTRAINED 参数，切片定义可使用多维数据集中的维度、层次结构、级别和成员名称、键、唯一名称或其他命名对象，但不能使用 MDX 函数。</span><span class="sxs-lookup"><span data-stu-id="79212-110">Together with the CONSTRAINED parameter, the slicing definition can use dimension, hierarchy, level and member names, keys, unique names, or other named objects in the cube, but cannot use MDX functions.</span></span> <span data-ttu-id="79212-111">聚合设计是可由多个分区共享的聚合定义的集合。</span><span class="sxs-lookup"><span data-stu-id="79212-111">The aggregation design is a collection of aggregation definitions that can be shared across multiple partitions.</span></span> <span data-ttu-id="79212-112">默认聚合设计取自父多维数据集的聚合设计。</span><span class="sxs-lookup"><span data-stu-id="79212-112">The default is taken from the parent cube's aggregation design.</span></span>  
  
 <span data-ttu-id="79212-113">使用分区 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 来管理和存储多维数据集中的度量值组的数据和聚合。</span><span class="sxs-lookup"><span data-stu-id="79212-113">Partitions are used by [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] to manage and store data and aggregations for a measure group in a cube.</span></span> <span data-ttu-id="79212-114">每个度量值组至少有一个分区；该分区在定义度量值组时创建。</span><span class="sxs-lookup"><span data-stu-id="79212-114">Every measure group has at least one partition; this partition is created when the measure group is defined.</span></span> <span data-ttu-id="79212-115">为度量值组创建新分区时，该新分区将添加到此度量值组已有的分区集合中。</span><span class="sxs-lookup"><span data-stu-id="79212-115">When you create a new partition for a measure group, the new partition is added to the set of partitions that already exist for the measure group.</span></span> <span data-ttu-id="79212-116">度量值组反映了其所有分区中所包含的组合数据。</span><span class="sxs-lookup"><span data-stu-id="79212-116">The measure group reflects the combined data that is contained in all its partitions.</span></span> <span data-ttu-id="79212-117">这意味着必须确保度量值组中某分区的数据不同于此度量值组中任何其他分区的数据，从而确保未在度量值组中多次反映此数据。</span><span class="sxs-lookup"><span data-stu-id="79212-117">This means that you must ensure that the data for a partition in a measure group is exclusive of the data for any other partition in the measure group to ensure that data is not reflected in the measure group more than once.</span></span> <span data-ttu-id="79212-118">度量值组的原始分区基于多维数据集的数据源视图中的单个事实数据表。</span><span class="sxs-lookup"><span data-stu-id="79212-118">The original partition for a measure group is based on a single fact table in the data source view of the cube.</span></span> <span data-ttu-id="79212-119">当度量值组有多个分区时，每个分区可以引用数据源视图中的或者多维数据集的基本关系数据源中的不同表。</span><span class="sxs-lookup"><span data-stu-id="79212-119">When there are multiple partitions for a measure group, each partition can reference a different table in either the data source view or in the underlying relational data source for the cube.</span></span> <span data-ttu-id="79212-120">如果将每个分区限制到表中的不同行，则度量值组中的多个分区可以引用同一个表。</span><span class="sxs-lookup"><span data-stu-id="79212-120">More than one partition in a measure group can reference the same table, if each partition is restricted to different rows in the table.</span></span>  
  
 <span data-ttu-id="79212-121">分区是用来管理多维数据集（尤其是大型多维数据集）的强大而灵活的工具。</span><span class="sxs-lookup"><span data-stu-id="79212-121">Partitions are a powerful and flexible means of managing cubes, especially large cubes.</span></span> <span data-ttu-id="79212-122">例如，某个包含销售信息的多维数据集可以包含存储过去每一年数据的分区和存储当年每一季度数据的分区。</span><span class="sxs-lookup"><span data-stu-id="79212-122">For example, a cube that contains sales information can contain a partition for the data of each past year and also partitions for each quarter of the current year.</span></span> <span data-ttu-id="79212-123">将当前信息添加到多维数据集时，只需处理当前季度分区；如果处理的数据量越少，则会通过缩短处理时间来提高处理性能。</span><span class="sxs-lookup"><span data-stu-id="79212-123">Only the current quarter partition needs to be processed when current information is added to the cube; processing a smaller amount of data will improve processing performance by decreasing processing time.</span></span> <span data-ttu-id="79212-124">在年末，这四个针对季度的分区可以合并成一个单独的针对全年的分区，并为新一年的第一季度创建新分区。</span><span class="sxs-lookup"><span data-stu-id="79212-124">At the end of the year the four quarterly partitions can be merged into a single partition for the year and a new partition created for the first quarter of the new year.</span></span> <span data-ttu-id="79212-125">此外，该新分区的创建过程可以作为数据仓库加载和多维数据集处理过程的一部分自动执行。</span><span class="sxs-lookup"><span data-stu-id="79212-125">Further, this new partition creation process can be automated as part of your data warehouse loading and cube processing procedures.</span></span>  
  
 <span data-ttu-id="79212-126">分区对多维数据集的业务用户不可见。</span><span class="sxs-lookup"><span data-stu-id="79212-126">Partitions are not visible to business users of the cube.</span></span> <span data-ttu-id="79212-127">但是，管理员可以配置、添加或删除分区。</span><span class="sxs-lookup"><span data-stu-id="79212-127">However, administrators can configure, add, or drop partitions.</span></span> <span data-ttu-id="79212-128">每个分区都存储在一组单独的文件中。</span><span class="sxs-lookup"><span data-stu-id="79212-128">Each partition is stored in a separate set of files.</span></span> <span data-ttu-id="79212-129">每个分区的聚合数据都可以存储在定义该分区的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例中，也可以存储在其他 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例中，或者存储在用于提供分区的源数据的数据源中。</span><span class="sxs-lookup"><span data-stu-id="79212-129">The aggregate data of each partition can be stored on the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] where the partition is defined, on another instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], or in the data source that is used to supply the partition's source data.</span></span> <span data-ttu-id="79212-130">分区允许多维数据集的源数据和聚合数据分布在多个硬盘驱动器和多个服务器计算机中。</span><span class="sxs-lookup"><span data-stu-id="79212-130">Partitions allow the source data and aggregate data of a cube to be distributed across multiple hard drives and among multiple server computers.</span></span> <span data-ttu-id="79212-131">对于中型到大型的多维数据集而言，分区可以极大地提高查询性能、负载性能和多维数据集的易维护性。</span><span class="sxs-lookup"><span data-stu-id="79212-131">For a cube of moderate to large size, partitions can greatly improve query performance, load performance, and ease of cube maintenance.</span></span> <span data-ttu-id="79212-132">有关远程分区的详细信息，请参阅 [远程分区](partitions-remote-partitions.md)。</span><span class="sxs-lookup"><span data-stu-id="79212-132">For more information about remote partitions, see [Remote Partitions](partitions-remote-partitions.md).</span></span>  
  
 <span data-ttu-id="79212-133">可以在独立于度量值组中其他分区的情况下，对每个分区的存储模式进行配置。</span><span class="sxs-lookup"><span data-stu-id="79212-133">The storage mode of each partition can be configured independently of other partitions in the measure group.</span></span> <span data-ttu-id="79212-134">可以使用源数据位置、存储模式、主动缓存和聚合设计的选项的任意组合来存储分区。</span><span class="sxs-lookup"><span data-stu-id="79212-134">Partitions can be stored by using any combination of options for source data location, storage mode, proactive caching, and aggregation design.</span></span> <span data-ttu-id="79212-135">在设计分区时，您可以使用实时 OLAP 和主动缓存的选项来平衡查询速度以避免发生滞后。</span><span class="sxs-lookup"><span data-stu-id="79212-135">Options for real-time OLAP and proactive caching let you balance query speed against latency when you design a partition.</span></span> <span data-ttu-id="79212-136">存储选项还可以应用于相关的维度以及度量值组中的事实。</span><span class="sxs-lookup"><span data-stu-id="79212-136">Storage options can also be applied to related dimensions and to facts in a measure group.</span></span> <span data-ttu-id="79212-137">这种灵活性使您能够按照需要设计多维数据集的存储策略。</span><span class="sxs-lookup"><span data-stu-id="79212-137">This flexibility lets you design cube storage strategies appropriate to your needs.</span></span> <span data-ttu-id="79212-138">有关详细信息，请参阅[分区存储模式和处理](partitions-partition-storage-modes-and-processing.md)、[聚合和聚合设计](aggregations-and-aggregation-designs.md)以及[主动缓存 &#40;分区&#41;](partitions-proactive-caching.md)。</span><span class="sxs-lookup"><span data-stu-id="79212-138">For more information, see [Partition Storage Modes and Processing](partitions-partition-storage-modes-and-processing.md), [Aggregations and Aggregation Designs](aggregations-and-aggregation-designs.md) and [Proactive Caching &#40;Partitions&#41;](partitions-proactive-caching.md).</span></span>  
  
## <a name="partition-structure"></a><span data-ttu-id="79212-139">分区结构</span><span class="sxs-lookup"><span data-stu-id="79212-139">Partition Structure</span></span>  
 <span data-ttu-id="79212-140">分区的结构必须与其度量值组的结构匹配，这意味着还必须在分区中定义用于定义度量值组的度量值以及所有相关维度。</span><span class="sxs-lookup"><span data-stu-id="79212-140">The structure of a partition must match the structure of its measure group, which means that the measures that define the measure group must also be defined in the partition, along with all related dimensions.</span></span> <span data-ttu-id="79212-141">因此，创建分区时，它将自动继承为度量值组定义的同一组度量值和相关维度。</span><span class="sxs-lookup"><span data-stu-id="79212-141">Therefore, when a partition is created, it automatically inherits the same set of measures and related dimensions that were defined for the measure group.</span></span>  
  
 <span data-ttu-id="79212-142">但是，度量值组中的每个分区可以有不同的事实数据表，并且这些事实数据表可以来自不同的数据源。</span><span class="sxs-lookup"><span data-stu-id="79212-142">However, each partition in a measure group can have a different fact table, and these fact tables can be from different data sources.</span></span> <span data-ttu-id="79212-143">当度量值组中的不同分区有不同的事实数据表时，这些表必须非常相似以维护度量值组的结构，这意味着处理查询会针对所有分区的所有事实数据表返回相同的列和数据类型。</span><span class="sxs-lookup"><span data-stu-id="79212-143">When different partitions in a measure group have different fact tables, the tables must be sufficiently similar to maintain the structure of the measure group, which means that the processing query returns the same columns and same data types for all fact tables for all partitions.</span></span>  
  
 <span data-ttu-id="79212-144">如果不同分区的事实数据表来自不同的数据源，则任何相关维度的源表和任何中间事实数据表还必须包含在所有数据源中，并且它们在所有数据库中的结构必须相同。</span><span class="sxs-lookup"><span data-stu-id="79212-144">When fact tables for different partitions are from different data sources, the source tables for any related dimensions, and also any intermediate fact tables, must also be present in all data sources and must have the same structure in all the databases.</span></span> <span data-ttu-id="79212-145">而且，在定义与度量值组相关的多维数据集维度的属性时，需要使用的所有维度表列都必须包含在所有数据源中。</span><span class="sxs-lookup"><span data-stu-id="79212-145">Also, all dimension table columns that are used to define attributes for cube dimensions related to the measure group must be present in all of the data sources.</span></span> <span data-ttu-id="79212-146">如果分区源表与度量值组的源表有相同的结构，则不需要定义分区的源表和相关维度表之间的所有联接。</span><span class="sxs-lookup"><span data-stu-id="79212-146">There is no need to define all the joins between the source table of a partition and a related dimension table if the partition source table has the identical structure as the source table for the measure group.</span></span>  
  
 <span data-ttu-id="79212-147">有些事实数据表可能会包含未用于定义度量值组中度量值的列，但有些则不会包含。</span><span class="sxs-lookup"><span data-stu-id="79212-147">Columns that are not used to define measures in the measure group can be present in some fact tables but absent in others.</span></span> <span data-ttu-id="79212-148">同样，有些数据库可能会包含未用于定义相关维度表中属性的列，但有些则不会包含。</span><span class="sxs-lookup"><span data-stu-id="79212-148">Similarly, columns that are not used to define attributes in related dimension tables can be present in some databases but absent in others.</span></span> <span data-ttu-id="79212-149">某些数据库可能会包含未用于事实数据表或相关维度表的表，而其他数据库则不包含。</span><span class="sxs-lookup"><span data-stu-id="79212-149">Tables that are not used for either fact tables or related dimension tables can be present in some databases but absent in others.</span></span>  
  
## <a name="data-sources-and-partition-storage"></a><span data-ttu-id="79212-150">数据源和分区存储</span><span class="sxs-lookup"><span data-stu-id="79212-150">Data Sources and Partition Storage</span></span>  
 <span data-ttu-id="79212-151">分区基于数据源中的表或视图，或者基于数据源视图中的表或命名查询。</span><span class="sxs-lookup"><span data-stu-id="79212-151">A partition is based either on a table or view in a data source, or on a table or named query in a data source view.</span></span> <span data-ttu-id="79212-152">分区数据的存储位置是由数据源绑定定义的。</span><span class="sxs-lookup"><span data-stu-id="79212-152">The location where partition data is stored is defined by the data source binding.</span></span> <span data-ttu-id="79212-153">通常，可以对度量值组进行水平或垂直分区：</span><span class="sxs-lookup"><span data-stu-id="79212-153">Typically, you can partition a measure group horizontally or vertically:</span></span>  
  
-   <span data-ttu-id="79212-154">在水平分区的度量值组中，其中的每个分区都基于一个单独的表。</span><span class="sxs-lookup"><span data-stu-id="79212-154">In a horizontally partitioned measure group, each partition in a measure group is based on a separate table.</span></span> <span data-ttu-id="79212-155">此分区类型适用于数据被分隔为多个表的情况。</span><span class="sxs-lookup"><span data-stu-id="79212-155">This kind of partitioning is appropriate when data is separated into multiple tables.</span></span> <span data-ttu-id="79212-156">例如，在某些关系数据库中，对每个月的数据都使用一个单独的表。</span><span class="sxs-lookup"><span data-stu-id="79212-156">For example, some relational databases have a separate table for each month's data.</span></span>  
  
-   <span data-ttu-id="79212-157">在垂直分区的度量值组中，度量值组基于单个表，并且每个分区基于筛选该分区数据的源系统查询。</span><span class="sxs-lookup"><span data-stu-id="79212-157">In a vertically partitioned measure group, a measure group is based on a single table, and each partition is based on a source system query that filters the data for the partition.</span></span> <span data-ttu-id="79212-158">例如，如果一个表中包含几个月的数据，则通过应用 Transact-SQL WHERE 子句以返回每个分区的每个月的数据，仍可以按月份对度量值组进行分区。</span><span class="sxs-lookup"><span data-stu-id="79212-158">For example, if a single table contains several months data, the measure group could still be partitioned by month by applying a Transact-SQL WHERE clause that returns a separate month's data for each partition.</span></span>  
  
 <span data-ttu-id="79212-159">每个分区都有存储设置，用来确定分区的数据和聚合是存储在本地 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例中，还是存储在使用其他 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例的远程分区中。</span><span class="sxs-lookup"><span data-stu-id="79212-159">Each partition has storage settings that determine whether the data and aggregations for the partition are stored in the local instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or in a remote partition using another instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="79212-160">存储设置还可以指定存储模式，并指定是否使用主动缓存来控制分区的滞后时间。</span><span class="sxs-lookup"><span data-stu-id="79212-160">The storage settings can also specify the storage mode and whether proactive caching is used to control latency for a partition.</span></span> <span data-ttu-id="79212-161">有关详细信息，请参阅[分区存储模式和处理](partitions-partition-storage-modes-and-processing.md)、[主动缓存 &#40;分区&#41;](partitions-proactive-caching.md)和[远程分区](partitions-remote-partitions.md)。</span><span class="sxs-lookup"><span data-stu-id="79212-161">For more information, see [Partition Storage Modes and Processing](partitions-partition-storage-modes-and-processing.md), [Proactive Caching &#40;Partitions&#41;](partitions-proactive-caching.md), and [Remote Partitions](partitions-remote-partitions.md).</span></span>  
  
## <a name="incremental-updates"></a><span data-ttu-id="79212-162">增量更新</span><span class="sxs-lookup"><span data-stu-id="79212-162">Incremental Updates</span></span>  
 <span data-ttu-id="79212-163">在多分区的度量值组中创建和管理分区时，必须十分谨慎，以确保多维数据集数据的准确性。</span><span class="sxs-lookup"><span data-stu-id="79212-163">When you create and manage partitions in multiple-partition measure groups, you must take special precautions to guarantee that cube data is accurate.</span></span> <span data-ttu-id="79212-164">虽然对于单分区的度量值组通常不需要特别谨慎，但在对这些分区进行增量更新时则需要十分小心。</span><span class="sxs-lookup"><span data-stu-id="79212-164">Although these precautions do not usually apply to single-partition measure groups, they do apply when you incrementally update partitions.</span></span> <span data-ttu-id="79212-165">对分区进行增量更新时，将创建与源分区具有相同结构的新临时分区。</span><span class="sxs-lookup"><span data-stu-id="79212-165">When you incrementally update a partition, a new temporary partition is created that has a structure identical to that of the source partition.</span></span> <span data-ttu-id="79212-166">临时分区在被处理后将与源分区合并。</span><span class="sxs-lookup"><span data-stu-id="79212-166">The temporary partition is processed and then merged with the source partition.</span></span> <span data-ttu-id="79212-167">因此，必须确保填充临时分区的处理查询不会复制现有分区中的任何已有数据。</span><span class="sxs-lookup"><span data-stu-id="79212-167">Therefore, you must ensure that the processing query that populates the temporary partition does not duplicate any data already present in an existing partition.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="79212-168">另请参阅</span><span class="sxs-lookup"><span data-stu-id="79212-168">See Also</span></span>  
 <span data-ttu-id="79212-169">[配置度量值属性](../multidimensional-models/configure-measure-properties.md) </span><span class="sxs-lookup"><span data-stu-id="79212-169">[Configure Measure Properties](../multidimensional-models/configure-measure-properties.md) </span></span>  
 [<span data-ttu-id="79212-170">多维模型中的多维数据集</span><span class="sxs-lookup"><span data-stu-id="79212-170">Cubes in Multidimensional Models</span></span>](../multidimensional-models/cubes-in-multidimensional-models.md)  
  
  
