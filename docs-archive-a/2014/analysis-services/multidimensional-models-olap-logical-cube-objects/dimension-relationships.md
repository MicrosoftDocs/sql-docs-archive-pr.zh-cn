---
title: 维度关系 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- relationships [Analysis Services]
- member groups [Analysis Services]
- regular dimensions [Analysis Services]
- many-to-many relationships [Analysis Services]
- cubes [Analysis Services], relationships
- reference dimensions
- dimensions [Analysis Services], relationships
- fact dimensions [Analysis Services]
- relationships [Analysis Services], dimensions
ms.assetid: de54c059-cb0f-4f66-bd70-8605af05ec4f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 2334c1a97bb4172fff70550dbece5376eb1cb9d7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692603"
---
# <a name="dimension-relationships"></a><span data-ttu-id="f87a9-102">维度关系</span><span class="sxs-lookup"><span data-stu-id="f87a9-102">Dimension Relationships</span></span>
  <span data-ttu-id="f87a9-103">维度用法定义了多维数据集维度与多维数据集中的度量值组之间的关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-103">Dimension usage defines the relationships between a cube dimension and the measure groups in a cube.</span></span> <span data-ttu-id="f87a9-104">多维数据集维度是在特定多维数据集中使用的数据库维度的实例。</span><span class="sxs-lookup"><span data-stu-id="f87a9-104">A cube dimension is an instance of a database dimension that is used in a specific cube.</span></span> <span data-ttu-id="f87a9-105">多维数据集可以（并且通常）具有与度量值组不直接相关的多维数据集维度，但是这些维度可以通过另一个维度或度量值组与某度量值组间接相关。</span><span class="sxs-lookup"><span data-stu-id="f87a9-105">A cube can, and frequently does, have cube dimensions that are not directly related to a measure group, but which might be indirectly related to the measure group through another dimension or measure group.</span></span> <span data-ttu-id="f87a9-106">向多维数据集添加数据库维度或度量值组时，将 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 尝试通过检查多维数据集的数据源视图中的维度表和事实数据表之间的关系，并检查维度中各属性之间的关系，从而确定维度的使用情况。</span><span class="sxs-lookup"><span data-stu-id="f87a9-106">When you add a database dimension or measure group to a cube, [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tries to determine dimension usage by examining relationships between the dimension tables and fact tables in the cube's data source view, and by examining the relationships between attributes in dimensions.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="f87a9-107">可自动为其所检测到的关系设置维度用法设置。</span><span class="sxs-lookup"><span data-stu-id="f87a9-107">automatically sets the dimension usage settings for the relationships that it can detect.</span></span>  
  
 <span data-ttu-id="f87a9-108">维度与度量值组之间的关系包括参与该关系的维度和事实数据表以及一个指定特定度量值组中维度粒度的粒度属性。</span><span class="sxs-lookup"><span data-stu-id="f87a9-108">A relationship between a dimension and a measure group consists of the dimension and fact tables participating in the relationship and a granularity attribute that specifies the granularity of the dimension in the particular measure group.</span></span>  
  
## <a name="regular-dimension-relationships"></a><span data-ttu-id="f87a9-109">常规维度关系</span><span class="sxs-lookup"><span data-stu-id="f87a9-109">Regular Dimension Relationships</span></span>  
 <span data-ttu-id="f87a9-110">当维度的键列与事实数据表直接联接时，多维数据集维度与度量值组之间便会存在常规维度关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-110">A regular dimension relationship between a cube dimension and a measure group exists when the key column for the dimension is joined directly to the fact table.</span></span> <span data-ttu-id="f87a9-111">此直接关系基于基础关系数据库中的主键-外键关系，但也可能基于数据源视图中定义的逻辑关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-111">This direct relationship is based on a primary key-foreign key relationship in the underlying relational database, but might also be based on a logical relationship that is defined in the data source view.</span></span> <span data-ttu-id="f87a9-112">常规维度关系表示传统星型架构设计中维度表与事实数据表之间的关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-112">A regular dimension relationship represents the relationship between dimension tables and a fact table in a traditional star schema design.</span></span> <span data-ttu-id="f87a9-113">有关常规关系的详细信息，请参阅[定义常规关系和常规关系属性](../multidimensional-models/define-a-regular-relationship-and-regular-relationship-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="f87a9-113">For more information about regular relationships, see [Define a Regular Relationship and Regular Relationship Properties](../multidimensional-models/define-a-regular-relationship-and-regular-relationship-properties.md).</span></span>  
  
## <a name="reference-dimension-relationships"></a><span data-ttu-id="f87a9-114">引用维度关系</span><span class="sxs-lookup"><span data-stu-id="f87a9-114">Reference Dimension Relationships</span></span>  
 <span data-ttu-id="f87a9-115">当多维数据集维度的键列通过其他维度表中的键与事实数据表间接联接时，该维度与度量值组之间便会存在引用维度关系，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="f87a9-115">A reference dimension relationship between a cube dimension and a measure group exists when the key column for the dimension is joined indirectly to the fact table through a key in another dimension table, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="f87a9-116">![逻辑关系图，引用维度关系](../../analysis-services/dev-guide/media/as-refdimension1.gif "逻辑关系图，引用维度关系")</span><span class="sxs-lookup"><span data-stu-id="f87a9-116">![Logical diagram, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdimension1.gif "Logical diagram, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="f87a9-117">引用维度关系表示雪花型架构设计中的维度表与事实数据表之间的关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-117">A reference dimension relationship represents the relationship between dimension tables and a fact table in a snowflake schema design.</span></span> <span data-ttu-id="f87a9-118">当雪花型架构中的各维度表进行连接时，可以使用多个表中的列定义一个维度，也可以根据单独的维度表定义单独的维度，然后使用引用维度关系设置定义这些维度之间的链接。</span><span class="sxs-lookup"><span data-stu-id="f87a9-118">When dimension tables are connected in a snowflake schema, you can define a single dimension using columns from multiple tables, or you can define separate dimensions based on the separate dimension tables and then define a link between them using the reference dimension relationship setting.</span></span> <span data-ttu-id="f87a9-119">下图在雪花型架构中显示一个名为**InternetSales**的事实数据表，以及两个称为**Customer**和**Geography**的维度表。</span><span class="sxs-lookup"><span data-stu-id="f87a9-119">The following figure shows one fact table named **InternetSales**, and two dimension tables called **Customer** and **Geography**, in a snowflake schema.</span></span>  
  
 <span data-ttu-id="f87a9-120">![逻辑架构，引用维度关系](../../analysis-services/dev-guide/media/as-refdim-schema1.gif "逻辑架构，引用维度关系")</span><span class="sxs-lookup"><span data-stu-id="f87a9-120">![Logical schema, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdim-schema1.gif "Logical schema, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="f87a9-121">您可以创建一个维度，其中包含**Customer**表作为维度主表和作为相关表包含的**Geography**表。</span><span class="sxs-lookup"><span data-stu-id="f87a9-121">You can create a dimension with the **Customer** table as the dimension main table and the **Geography** table included as a related table.</span></span> <span data-ttu-id="f87a9-122">然后在维度与 InternetSales 度量值组之间定义常规关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-122">A regular relationship is then defined between the dimension and the InternetSales measure group.</span></span>  
  
 <span data-ttu-id="f87a9-123">另外，您还可以创建两个与 InternetSales 度量值组相关的维度：基于**Customer**表的维度，以及基于**Geography**表的维度。</span><span class="sxs-lookup"><span data-stu-id="f87a9-123">Alternatively, you can create two dimensions related to the InternetSales measure group: a dimension based on the **Customer** table, and a dimension based on the **Geography** table.</span></span> <span data-ttu-id="f87a9-124">然后通过使用“客户”维度的引用维度关系将“地域”维度与“Internet 销售”度量值组进行关联。</span><span class="sxs-lookup"><span data-stu-id="f87a9-124">You can then relate the Geography dimension to the InternetSales measure group using a reference dimension relationship using the Customer dimension.</span></span> <span data-ttu-id="f87a9-125">在这种情况下，当按“地域”维度创建 InternetSales 度量值组中事实数据的维度时，也就是按客户和地域创建这些数据的维度。</span><span class="sxs-lookup"><span data-stu-id="f87a9-125">In this case, when the facts in the InternetSales measure group are dimensioned by the Geography dimension, the facts are dimensioned by customer and by geography.</span></span> <span data-ttu-id="f87a9-126">如果多维数据集还包含一个名为“分销商销售额”的度量值组，则可能无法按“地域”创建“分销商销售额”度量值组中事实数据的维度，因为“分销商销售额”与“地域”之间没有任何关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-126">If the cube contained a second measure group named Reseller Sales, you would be unable to dimension the facts in the Reseller Sales measure group by Geography because no relationship would exist between Reseller Sales and Geography.</span></span>  
  
 <span data-ttu-id="f87a9-127">对于可相互链接的引用维度的数量没有限制，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="f87a9-127">There is no limit to the number of reference dimensions that can be chained together, as shown in the following illustration.</span></span>  
  
 <span data-ttu-id="f87a9-128">![逻辑关系图，引用维度关系](../../analysis-services/dev-guide/media/as-refdimension2.gif "逻辑关系图，引用维度关系")</span><span class="sxs-lookup"><span data-stu-id="f87a9-128">![Logical diagram, referenced dimension relationship](../../analysis-services/dev-guide/media/as-refdimension2.gif "Logical diagram, referenced dimension relationship")</span></span>  
  
 <span data-ttu-id="f87a9-129">有关引用关系的详细信息，请参阅[定义引用的关系和引用的关系属性](../multidimensional-models/define-a-referenced-relationship-and-referenced-relationship-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="f87a9-129">For more information about referenced relationships, see [Define a Referenced Relationship and Referenced Relationship Properties](../multidimensional-models/define-a-referenced-relationship-and-referenced-relationship-properties.md).</span></span>  
  
## <a name="fact-dimension-relationships"></a><span data-ttu-id="f87a9-130">事实维度关系</span><span class="sxs-lookup"><span data-stu-id="f87a9-130">Fact Dimension Relationships</span></span>  
 <span data-ttu-id="f87a9-131">事实维度（通常称为退化维度）是通过事实数据表而非维度表中的属性列构造的标准维度。</span><span class="sxs-lookup"><span data-stu-id="f87a9-131">Fact dimensions, frequently referred to as degenerate dimensions, are standard dimensions that are constructed from attribute columns in fact tables instead of from attribute columns in dimension tables.</span></span> <span data-ttu-id="f87a9-132">有用的维度数据有时存储在事实数据表中以减少重复。</span><span class="sxs-lookup"><span data-stu-id="f87a9-132">Useful dimensional data is sometimes stored in a fact table to reduce duplication.</span></span> <span data-ttu-id="f87a9-133">例如，下面的关系图显示了示例数据库中的**FactResellerSales**事实数据表 [!INCLUDE[ssAWDWsp](../../includes/ssawdwsp-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f87a9-133">For example, the following diagram displays the **FactResellerSales** fact table, from the [!INCLUDE[ssAWDWsp](../../includes/ssawdwsp-md.md)] sample database.</span></span>  
  
 <span data-ttu-id="f87a9-134">![事实数据表中的列可支持维度](../../analysis-services/dev-guide/media/as-factdim.gif "事实数据表中的列可支持维度")</span><span class="sxs-lookup"><span data-stu-id="f87a9-134">![Columns in fact table can support dimensions](../../analysis-services/dev-guide/media/as-factdim.gif "Columns in fact table can support dimensions")</span></span>  
  
 <span data-ttu-id="f87a9-135">该表不仅包含分销商所发出订单的每一行的属性信息，而且还包含有关订单本身的属性信息。</span><span class="sxs-lookup"><span data-stu-id="f87a9-135">The table contains attribute information not only for each line of an order issued by a reseller, but about the order itself.</span></span> <span data-ttu-id="f87a9-136">上图中带圆圈的属性标识**FactResellerSales**表中的信息，这些信息可用作维度中的属性。</span><span class="sxs-lookup"><span data-stu-id="f87a9-136">The attributes circled in the previous diagram identify the information in the **FactResellerSales** table that could be used as attributes in a dimension.</span></span> <span data-ttu-id="f87a9-137">在本例中，CarrierTrackingNumber 和 CustomerPONumber 属性列表示两条附加信息，即承运人跟踪号以及分销商发出的采购订单号。</span><span class="sxs-lookup"><span data-stu-id="f87a9-137">In this case, two additional pieces of information, the carrier tracking number and the purchase order number issued by the reseller, are represented by the CarrierTrackingNumber and CustomerPONumber attribute columns.</span></span> <span data-ttu-id="f87a9-138">此信息非常有趣-例如，用户对于在单个跟踪号下发运的所有订单，用户肯定会有兴趣查看聚合信息，如总产品成本。</span><span class="sxs-lookup"><span data-stu-id="f87a9-138">This information is interesting-for example, users would definitely be interested in seeing aggregated information, such as the total product cost, for all the orders being shipped under a single tracking number.</span></span> <span data-ttu-id="f87a9-139">但是，如果没有维度，则无法组织或聚合这两个属性的数据。</span><span class="sxs-lookup"><span data-stu-id="f87a9-139">But, without a dimension data for these two attributes cannot be organized or aggregated.</span></span>  
  
 <span data-ttu-id="f87a9-140">理论上，您可以创建与 FactResellerSales 表使用相同密钥信息的维度表，并将另外两个属性列 CarrierTrackingNumber 和 CustomerPONumber 移到该维度表。</span><span class="sxs-lookup"><span data-stu-id="f87a9-140">In theory, you could create a dimension table that uses the same key information as the FactResellerSales table and move the other two attribute columns, CarrierTrackingNumber and CustomerPONumber, to that dimension table.</span></span> <span data-ttu-id="f87a9-141">但是，为了只将这两个属性作为单独的维度表示，您可能会复制大部分数据并为数据仓库增加不必要的复杂性。</span><span class="sxs-lookup"><span data-stu-id="f87a9-141">However, you would be duplicating a significant portion of data and adding unnecessary complexity to the data warehouse to represent just two attributes as a separate dimension.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f87a9-142">事实维度通常用于支持钻取操作。</span><span class="sxs-lookup"><span data-stu-id="f87a9-142">Fact dimensions are frequently used to support drillthrough actions.</span></span> <span data-ttu-id="f87a9-143">有关操作的详细信息，请参阅[操作（Analysis Services - 多维数据）](../multidimensional-models/actions-analysis-services-multidimensional-data.md)。</span><span class="sxs-lookup"><span data-stu-id="f87a9-143">For more information about actions, see [Actions &#40;Analysis Services - Multidimensional Data&#41;](../multidimensional-models/actions-analysis-services-multidimensional-data.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f87a9-144">每次对事实关系引用的度量值组进行更新之后，都必须增量更新事实维度。</span><span class="sxs-lookup"><span data-stu-id="f87a9-144">Fact dimensions must be incrementally updated after every update to the measure group that is referenced by the fact relationship.</span></span> <span data-ttu-id="f87a9-145">如果事实维度为 ROLAP 维度，则 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 处理引擎将删除所有缓存并增量处理度量值组。</span><span class="sxs-lookup"><span data-stu-id="f87a9-145">If the fact dimension is a ROLAP dimension, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] processing engine drops any caches and incrementally processes the measure group.</span></span>  
  
 <span data-ttu-id="f87a9-146">有关事实关系的详细信息，请参阅[定义事实关系和事实关系属性](../multidimensional-models/define-a-fact-relationship-and-fact-relationship-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="f87a9-146">For more information about fact relationships, see [Define a Fact Relationship and Fact Relationship Properties](../multidimensional-models/define-a-fact-relationship-and-fact-relationship-properties.md).</span></span>  
  
## <a name="many-to-many-dimension-relationships"></a><span data-ttu-id="f87a9-147">多对多维度关系</span><span class="sxs-lookup"><span data-stu-id="f87a9-147">Many to Many Dimension Relationships</span></span>  
 <span data-ttu-id="f87a9-148">在多数维度中，每个与一个且唯一的一个维度成员以及单个维度成员的事实联接都可以与多个事实数据进行关联。</span><span class="sxs-lookup"><span data-stu-id="f87a9-148">In most dimensions, each fact joins to one and only one dimension member, and a single dimension member can be associated with multiple facts.</span></span> <span data-ttu-id="f87a9-149">在关系数据库术语中，这称为“一对多关系”。</span><span class="sxs-lookup"><span data-stu-id="f87a9-149">In relational database terminology, this is referred to as a one-to-many relationship.</span></span> <span data-ttu-id="f87a9-150">但是，这种关系通常在将单个事实数据与多个维度成员联接时很有用。</span><span class="sxs-lookup"><span data-stu-id="f87a9-150">However, it is frequently useful to join a single fact to multiple dimension members.</span></span> <span data-ttu-id="f87a9-151">例如，银行客户可能具有多个帐户（现金帐户、储蓄帐户、信用卡帐户以及投资帐户），并且一个帐户也可以有两个所有者或多个所有者。</span><span class="sxs-lookup"><span data-stu-id="f87a9-151">For example, a bank customer might have multiple accounts (checking, saving, credit card, and investment accounts), and an account can also have joint or multiple owners.</span></span> <span data-ttu-id="f87a9-152">基于此类关系构造的“客户”维度中，可能会有多个成员与一个帐户事务相关联。</span><span class="sxs-lookup"><span data-stu-id="f87a9-152">The Customer dimension constructed from such relationships would then have multiple members that relate to a single account transaction.</span></span>  
  
 <span data-ttu-id="f87a9-153">![逻辑架构/多对多维度关系](../../analysis-services/dev-guide/media/as-many-dimension1.gif "逻辑架构/多对多维度关系")</span><span class="sxs-lookup"><span data-stu-id="f87a9-153">![Logical schema/many-to-many dimension relationship](../../analysis-services/dev-guide/media/as-many-dimension1.gif "Logical schema/many-to-many dimension relationship")</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="f87a9-154">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]允许您在维度和事实数据表之间定义多对多关系。</span><span class="sxs-lookup"><span data-stu-id="f87a9-154">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] lets you define a many-to-many relationship between a dimension and a fact table.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f87a9-155">为了支持多对多维度关系，数据源视图必须在所涉及的所有表之间建立外键关系，如上面的关系图所示。</span><span class="sxs-lookup"><span data-stu-id="f87a9-155">To support a many-to-many dimension relationship, the data source view must have established a foreign key relationship between all the tables involved, as shown in the previous diagram.</span></span> <span data-ttu-id="f87a9-156">否则，在维度设计器的 "**维度用法**" 选项卡中建立关系时，将无法选择正确的中间度量值组。</span><span class="sxs-lookup"><span data-stu-id="f87a9-156">Otherwise, you will be unable to select the correct intermediate measure group when establishing the relationship in the **Dimension Usage** tab of Dimension Designer.</span></span>  
  
 <span data-ttu-id="f87a9-157">有关多对多关系的详细信息，请参阅[定义多对多关系和多对多关系属性](../multidimensional-models/define-a-many-to-many-relationship-and-many-to-many-relationship-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="f87a9-157">For more information about many-to-many relationships, see [Define a Many-to-Many Relationship and Many-to-Many Relationship Properties](../multidimensional-models/define-a-many-to-many-relationship-and-many-to-many-relationship-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f87a9-158">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f87a9-158">See Also</span></span>  
 [<span data-ttu-id="f87a9-159">维度（Analysis Services - 多维数据）</span><span class="sxs-lookup"><span data-stu-id="f87a9-159">Dimensions &#40;Analysis Services - Multidimensional Data&#41;</span></span>](../multidimensional-models-olap-logical-dimension-objects/dimensions-analysis-services-multidimensional-data.md)  
  
  
