---
title: 计算 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692605"
---
# <a name="calculations"></a><span data-ttu-id="f2253-102">计算</span><span class="sxs-lookup"><span data-stu-id="f2253-102">Calculations</span></span>
  <span data-ttu-id="f2253-103">计算是用于在中的多维数据集中定义计算成员、命名集或范围分配的多维表达式 (MDX) 表达式或脚本 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f2253-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="f2253-104">使用计算，您可以添加不是由多维数据集的数据而是由特定表达式（这些表达式可以引用多维数据集的其他部分、其他多维数据集，或者甚至引用 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据库以外的信息）所定义的对象。</span><span class="sxs-lookup"><span data-stu-id="f2253-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="f2253-105">使用计算，您还可以扩展多维数据集的功能，提高商业智能应用程序的灵活性和能力。</span><span class="sxs-lookup"><span data-stu-id="f2253-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="f2253-106">有关脚本计算的详细信息，请参阅[Microsoft SQL Server 2005 中的 MDX 脚本介绍](https://go.microsoft.com/fwlink/?LinkId=81892)。</span><span class="sxs-lookup"><span data-stu-id="f2253-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="f2253-107">有关与 MDX 查询和计算相关的性能问题的详细信息，请参阅[SQL Server 2005 Analysis Services 性能指南](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide)。</span><span class="sxs-lookup"><span data-stu-id="f2253-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="f2253-108">计算成员</span><span class="sxs-lookup"><span data-stu-id="f2253-108">Calculated Members</span></span>  
 <span data-ttu-id="f2253-109">计算成员是在运行时使用对其进行定义时所指定的多维表达式 (MDX) 表达式来计算其值的成员。</span><span class="sxs-lookup"><span data-stu-id="f2253-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="f2253-110">计算成员就像其他任何成员一样，可用于商业智能应用程序。</span><span class="sxs-lookup"><span data-stu-id="f2253-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="f2253-111">计算成员不会增加多维数据集的大小，因为多维数据集中只存储定义；值的计算则在需要回答查询时才在内存中执行。</span><span class="sxs-lookup"><span data-stu-id="f2253-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="f2253-112">可以为任何维度（包括度量值维度）定义计算成员。</span><span class="sxs-lookup"><span data-stu-id="f2253-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="f2253-113">在度量值维度中创建的计算成员称为计算度量值。</span><span class="sxs-lookup"><span data-stu-id="f2253-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="f2253-114">尽管计算成员通常基于多维数据集中已存在的数据，但是可以通过将数据与算术运算符、数字和函数进行组合而创建复杂的表达式。</span><span class="sxs-lookup"><span data-stu-id="f2253-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="f2253-115">还可以使用 MDX 函数（例如，LookupCube）来访问 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据库内其他多维数据集中的数据。</span><span class="sxs-lookup"><span data-stu-id="f2253-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="f2253-116">包括标准化 Visual Studio 函数库，可以使用存储过程从除当前 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据库以外的源中检索数据。</span><span class="sxs-lookup"><span data-stu-id="f2253-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="f2253-117">有关存储过程的详细信息，请参阅[定义存储过程](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md)。</span><span class="sxs-lookup"><span data-stu-id="f2253-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="f2253-118">例如，假设货运公司的行政人员希望基于每体积单位的利润确定运输哪种类型的货物利润更高。</span><span class="sxs-lookup"><span data-stu-id="f2253-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="f2253-119">他们使用包含“货物”、“船队”和“时间”维度以及 Price_to_Ship、Cost_to_Ship 和 Volume_in_Cubic_Meters 度量值的“发运”多维数据集；但是，该多维数据集中未包含盈利率的度量值。</span><span class="sxs-lookup"><span data-stu-id="f2253-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="f2253-120">通过在下列表达式中合并现有度量值，可以在多维数据集中创建一个计算成员来作为度量值，并将它命名为 Profit_per_Cubic_Meter：</span><span class="sxs-lookup"><span data-stu-id="f2253-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="f2253-121">创建计算成员之后，下一次浏览“发运”多维数据集时，Profit_per_Cubic_Meter 将与其他度量值一起出现。</span><span class="sxs-lookup"><span data-stu-id="f2253-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="f2253-122">若要创建计算成员，请使用多维数据集设计器中的 "**计算**" 选项卡。</span><span class="sxs-lookup"><span data-stu-id="f2253-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="f2253-123">有关详细信息，请参阅[创建计算成员](../multidimensional-models/create-calculated-members.md)</span><span class="sxs-lookup"><span data-stu-id="f2253-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="f2253-124">命名集</span><span class="sxs-lookup"><span data-stu-id="f2253-124">Named Sets</span></span>  
 <span data-ttu-id="f2253-125">命名集是返回集的 CREATE SET MDX 语句表达式。</span><span class="sxs-lookup"><span data-stu-id="f2253-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="f2253-126">MDX 表达式作为多维数据集定义的一部分保存在中 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="f2253-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="f2253-127">创建命名集的目的是为了重用多维表达式 (MDX) 查询。</span><span class="sxs-lookup"><span data-stu-id="f2253-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="f2253-128">使用命名集，业务用户可以简化查询，并针对复杂、常用的集表达式使用集名称而不是集表达式。</span><span class="sxs-lookup"><span data-stu-id="f2253-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="f2253-129">**相关主题：** [创建命名集](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="f2253-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="f2253-130">脚本命令</span><span class="sxs-lookup"><span data-stu-id="f2253-130">Script Commands</span></span>  
 <span data-ttu-id="f2253-131">脚本命令是一个 MDX 脚本，是多维数据集定义的一部分。</span><span class="sxs-lookup"><span data-stu-id="f2253-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="f2253-132">使用脚本命令，您可以执行几乎所有的受多维数据集的 MDX 支持的操作，例如，确定将计算仅应用于多维数据集的一部分的作用域。</span><span class="sxs-lookup"><span data-stu-id="f2253-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="f2253-133">在中 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ，MDX 脚本可以应用于整个多维数据集，也可以应用于多维数据集的特定部分（在脚本执行过程中的特定点）。</span><span class="sxs-lookup"><span data-stu-id="f2253-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="f2253-134">默认脚本命令（CALCULATE 语句）会基于默认作用域使用聚合数据来填充多维数据集中的单元。</span><span class="sxs-lookup"><span data-stu-id="f2253-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="f2253-135">默认作用域为整个多维数据集，但是您可以定义更具限制的作用域（称为子多维数据集），然后将 MDX 脚本仅应用于该特定的多维数据集空间。</span><span class="sxs-lookup"><span data-stu-id="f2253-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="f2253-136">SCOPE 语句定义计算脚本中所有后续 MDX 表达式和语句的作用域，直到作用域终止或重新定义为止。</span><span class="sxs-lookup"><span data-stu-id="f2253-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="f2253-137">然后，使用 THIS 语句将 MDX 表达式应用于当前作用域。</span><span class="sxs-lookup"><span data-stu-id="f2253-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="f2253-138">可以使用 BACK_COLOR 语句为当前作用域中的单元指定背景单元颜色，以在调试期间提供帮助。</span><span class="sxs-lookup"><span data-stu-id="f2253-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="f2253-139">例如，您可以使用脚本命令并基于以前时间段销售额的加权值，跨时间和销售区域为雇员分配销售配额。</span><span class="sxs-lookup"><span data-stu-id="f2253-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f2253-140">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f2253-140">See Also</span></span>  
 [<span data-ttu-id="f2253-141">多维模型中的计算</span><span class="sxs-lookup"><span data-stu-id="f2253-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
