---
title: 使用 PowerPivot for SharePoint) 的数据馈送 (|Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 50140fdf-6fd1-41a1-9c14-8ecfb97ba2e1
author: minewiskan
ms.author: owend
ms.openlocfilehash: 19e3c5b448005314696f8167156a2326dc5009e1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87689615"
---
# <a name="use-data-feeds-powerpivot-for-sharepoint"></a><span data-ttu-id="63ac0-102">使用数据馈送 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="63ac0-102">Use Data Feeds (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="63ac0-103">数据馈送是从联机数据源生成并流向目标文档或应用程序的一个或多个数据流。</span><span class="sxs-lookup"><span data-stu-id="63ac0-103">Data feeds are one or more data streams that are generated from an online data source and streamed to a destination document or application.</span></span> <span data-ttu-id="63ac0-104">如果使用 PowerPivot for Excel，数据馈送可帮助您将任意数据源中的现有公司或业务数据提取到 Excel 2010 工作簿中的 PowerPivot 窗口中。</span><span class="sxs-lookup"><span data-stu-id="63ac0-104">If you are using PowerPivot for Excel, data feeds can help you get existing corporate or business data from arbitrary data sources into the PowerPivot window in your Excel 2010 workbook.</span></span> <span data-ttu-id="63ac0-105">将数据馈送导入工作簿后，以后可以在 SharePoint 服务器上计划的任何数据刷新操作中引用该数据馈送。</span><span class="sxs-lookup"><span data-stu-id="63ac0-105">After you import a data feed to a workbook, you can reference it later in any data refresh operations that you schedule on a SharePoint server.</span></span>  
  
 <span data-ttu-id="63ac0-106">数据馈送的使用方式取决于您使用的是支持 Atom 数据馈送的应用程序中的内置导出功能，还是创建并使用自定义数据服务。</span><span class="sxs-lookup"><span data-stu-id="63ac0-106">How you use a data feed depends on whether you are using built-in export features in applications that support Atom data feeds, or creating and using custom data services.</span></span> <span data-ttu-id="63ac0-107">能够发布并读取 Atom XML 数据的应用程序提供了无缝的数据传输，可对用户隐藏数据源和数据服务的机制。</span><span class="sxs-lookup"><span data-stu-id="63ac0-107">Applications that are able to publish and read Atom XML data provide seamless data transfer that hides the mechanics of data feeds and data services from users.</span></span> <span data-ttu-id="63ac0-108">对于用户而言，他或她只是将数据从一个应用程序移到另一个应用程序。</span><span class="sxs-lookup"><span data-stu-id="63ac0-108">To a user, he or she is simply moving data from one application to another.</span></span>  
  
 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="63ac0-109">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]和 Microsoft SharePoint 2010 提供可在 PowerPivot 工作簿中使用的数据馈送。</span><span class="sxs-lookup"><span data-stu-id="63ac0-109">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] and Microsoft SharePoint 2010 provide data feeds that can be used in PowerPivot workbooks.</span></span> <span data-ttu-id="63ac0-110">可以使用本主题中的信息了解如何从已有的报表和列表访问数据馈送。</span><span class="sxs-lookup"><span data-stu-id="63ac0-110">You can use the information in this topic to learn how to access data feeds from reports and lists that you already have.</span></span>  
  
 <span data-ttu-id="63ac0-111">本主题包含以下各节：</span><span class="sxs-lookup"><span data-stu-id="63ac0-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="63ac0-112">先决条件</span><span class="sxs-lookup"><span data-stu-id="63ac0-112">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="63ac0-113">从 SharePoint 列表创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-113">Create a Data Feed from a SharePoint List</span></span>](#sharepointlist)  
  
 [<span data-ttu-id="63ac0-114">从 Reporting Services 报表创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-114">Create a Data Feed from a Reporting Services Report</span></span>](#rsreport)  
  
 [<span data-ttu-id="63ac0-115">从数据服务文档创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-115">Create a Data Feed from a Data Service Document</span></span>](#dsdoc)  
  
##  <a name="prerequisites"></a><a name="prereq"></a><span data-ttu-id="63ac0-116">先决条件</span><span class="sxs-lookup"><span data-stu-id="63ac0-116">Prerequisites</span></span>  
 <span data-ttu-id="63ac0-117">您必须具有 PowerPivot for Excel 才能将数据馈送导入 Excel 2010。</span><span class="sxs-lookup"><span data-stu-id="63ac0-117">You must have the PowerPivot for Excel to import a data feed into Excel 2010.</span></span>  
  
 <span data-ttu-id="63ac0-118">您必须具有以 Atom 1.0 格式提供数据的 Web 服务或数据服务。</span><span class="sxs-lookup"><span data-stu-id="63ac0-118">You must have a Web service or a data service that provides data in the Atom 1.0 format.</span></span> <span data-ttu-id="63ac0-119">[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 和 SharePoint 2010 都可以提供此格式的数据。</span><span class="sxs-lookup"><span data-stu-id="63ac0-119">Both [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] and SharePoint 2010 can provide data in this format.</span></span>  
  
 <span data-ttu-id="63ac0-120">在将 SharePoint 列表导出为数据馈送之前，必须在该 SharePoint 服务器上安装 ADO.NET Data Services。</span><span class="sxs-lookup"><span data-stu-id="63ac0-120">Before you can export a SharePoint list as a data feed, you must install ADO.NET Data Services on the SharePoint server.</span></span> <span data-ttu-id="63ac0-121">有关详细信息，请参阅 [安装 ADO.NET Data Services 以支持 SharePoint 列表的数据馈送导出](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="63ac0-121">For more information, see [Install ADO.NET Data Services to support data feed exports of SharePoint lists](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-sharepoint-list"></a><a name="sharepointlist"></a><span data-ttu-id="63ac0-122">从 SharePoint 列表创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-122">Create a Data Feed from a SharePoint List</span></span>  
 <span data-ttu-id="63ac0-123">在 SharePoint 2010 场中，SharePoint 列表在列表功能区上有一个“作为数据馈送导出”按钮。</span><span class="sxs-lookup"><span data-stu-id="63ac0-123">In a SharePoint 2010 farm, a SharePoint list has an Export as Data Feed button on the List ribbon.</span></span> <span data-ttu-id="63ac0-124">可以单击此按钮将列表作为馈送导出。</span><span class="sxs-lookup"><span data-stu-id="63ac0-124">You can click this button to export the list as a feed.</span></span> <span data-ttu-id="63ac0-125">为了获得最佳结果，您的工作站上应装有 Excel 2010 以及 PowerPivot 客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="63ac0-125">For best results, you should have Excel 2010 with the PowerPivot client application on your workstation.</span></span> <span data-ttu-id="63ac0-126">PowerPivot 客户端应用程序将启动，以响应数据馈送导出操作，并创建包含该列表的新的 PowerPivot 表。</span><span class="sxs-lookup"><span data-stu-id="63ac0-126">The PowerPivot client application will launch in response to the data feed export, creating a new PowerPivot table that contains the list.</span></span>  
  
1.  <span data-ttu-id="63ac0-127">打开 SharePoint 站点上的列表。</span><span class="sxs-lookup"><span data-stu-id="63ac0-127">Open the list on your SharePoint site.</span></span>  
  
2.  <span data-ttu-id="63ac0-128">在“列表工具”中，单击 **“列表”**。</span><span class="sxs-lookup"><span data-stu-id="63ac0-128">In List Tools, click **List**.</span></span>  
  
3.  <span data-ttu-id="63ac0-129">在“连接和导出”中，单击 **“作为数据馈送导出”**。</span><span class="sxs-lookup"><span data-stu-id="63ac0-129">In Connect and Export, click **Export as Data Feed**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="63ac0-130">"**作为数据馈送导出**" 按钮通过 PowerPivot 添加到 SharePoint。</span><span class="sxs-lookup"><span data-stu-id="63ac0-130">The **Export as Data Feed** button is added to SharePoint by way of PowerPivot.</span></span> <span data-ttu-id="63ac0-131">如果您尚未安装 PowerPivot for SharePoint 或您未激活 PowerPivot 功能，则此按钮将不可用。</span><span class="sxs-lookup"><span data-stu-id="63ac0-131">If you do not have PowerPivot for SharePoint installed or you did not activate the PowerPivot feature, this button will not be available.</span></span>  
  
4.  <span data-ttu-id="63ac0-132">如果在本地安装了 PowerPivot for Excel，请单击 "**打开**"，或者单击 "**保存**" 将 .atomsvc 文档保存到硬盘，以便以后导入操作。</span><span class="sxs-lookup"><span data-stu-id="63ac0-132">Click **Open** if PowerPivot for Excel is installed locally, or click **Save** to save the .atomsvc document to your hard drive for import operations at a later time.</span></span>  
  
5.  <span data-ttu-id="63ac0-133">如果选择 **“打开”**，请使用表导入向导将数据馈送导入工作表。</span><span class="sxs-lookup"><span data-stu-id="63ac0-133">If you chose **Open**, use the Table Import Wizard to import the data feed to a worksheet.</span></span> <span data-ttu-id="63ac0-134">该数据馈送将作为新表添加到 PowerPivot 窗口中。</span><span class="sxs-lookup"><span data-stu-id="63ac0-134">The data feed will be added as a new table in the PowerPivot window.</span></span>  
  
 <span data-ttu-id="63ac0-135">如果在 SharePoint 服务器上未安装 ADO.NET Data Services 3.5.1，则将出现错误。</span><span class="sxs-lookup"><span data-stu-id="63ac0-135">An error will occur if ADO.NET Data Services 3.5.1 is not installed on the SharePoint server.</span></span> <span data-ttu-id="63ac0-136">有关此错误和如何纠正此错误的详细信息，请参阅 [安装 ADO.NET Data Services 以支持 SharePoint 列表的数据馈送导出](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="63ac0-136">For more information about the error and how to resolve it, see [Install ADO.NET Data Services to support data feed exports of SharePoint lists](../../sql-server/install/install-ado-net-data-services-to-support-data-feed-exports-of-sharepoint-lists.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-reporting-services-report"></a><a name="rsreport"></a> <span data-ttu-id="63ac0-137">从 Reporting Services 报表创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-137">Create a Data Feed from a Reporting Services Report</span></span>  
 <span data-ttu-id="63ac0-138">如果已部署 SQL Server 2008 R2 Reporting Services，则可以使用新的 Atom 呈现扩展插件从现有报表生成数据馈送。</span><span class="sxs-lookup"><span data-stu-id="63ac0-138">If you have a deployment of SQL Server 2008 R2 Reporting Services, you can use the new Atom rendering extension to generate a data feed from an existing report.</span></span> <span data-ttu-id="63ac0-139">为了获得最佳结果，您的工作站上应装有 Excel 2010 以及 PowerPivot for Excel。</span><span class="sxs-lookup"><span data-stu-id="63ac0-139">For best results, you should have Excel 2010 with the PowerPivot for Excel on your workstation.</span></span> <span data-ttu-id="63ac0-140">PowerPivot 客户端应用程序将启动，以响应数据馈送导出操作，并在表和列流入时自动添加和关联这些表和列。</span><span class="sxs-lookup"><span data-stu-id="63ac0-140">The PowerPivot client application will launch in response to the data feed export, automatically adding and relating the tables and columns as they are streamed in.</span></span>  
  
 <span data-ttu-id="63ac0-141">有关如何从报表导出数据馈送的说明，请参阅[报表生成器帮助文件](https://go.microsoft.com/fwlink/?LinkId=154494)中的[基于报表生成数据馈送（报表生成器和 SSRS）](../../reporting-services/report-builder/generate-data-feeds-from-a-report-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="63ac0-141">For instructions on how to export a data feed from a report, see [Generate Data Feeds from a Report &#40;Report Builder and SSRS&#41;](../../reporting-services/report-builder/generate-data-feeds-from-a-report-report-builder-and-ssrs.md) in the [Report Builder help file](https://go.microsoft.com/fwlink/?LinkId=154494).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="63ac0-142">若要设置重复执行的数据刷新计划，以便将报表数据重新导入到已发布到 SharePoint 库的 PowerPivot 工作簿中，必须将报表服务器配置为与 SharePoint 进行集成。</span><span class="sxs-lookup"><span data-stu-id="63ac0-142">To set up a recurring data refresh schedule that re-imports report data into a PowerPivot workbook that is published to a SharePoint library, the report server must be configured for SharePoint integration.</span></span> <span data-ttu-id="63ac0-143">有关将 PowerPivot for SharePoint 和 Reporting Services 一起使用的详细信息，请参阅[&#40;Reporting Services SharePoint 模式&#41;配置和管理报表服务器](../../reporting-services/configure-administer-report-server-reporting-services-sharepoint-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="63ac0-143">For more information about using PowerPivot for SharePoint and Reporting Services together, see [Configuration and Administration of a Report Server &#40;Reporting Services SharePoint Mode&#41;](../../reporting-services/configure-administer-report-server-reporting-services-sharepoint-mode.md).</span></span>  
  
##  <a name="create-a-data-feed-from-a-data-service-document"></a><a name="dsdoc"></a> <span data-ttu-id="63ac0-144">从数据服务文档创建数据馈送</span><span class="sxs-lookup"><span data-stu-id="63ac0-144">Create a Data Feed from a Data Service Document</span></span>  
 <span data-ttu-id="63ac0-145">如果具有生成 Atom 馈送的自定义数据服务，则可以设置数据服务文档，将其作为使数据对用户和应用程序可用的一种方式。</span><span class="sxs-lookup"><span data-stu-id="63ac0-145">If you have a custom data service that generates Atom feeds, you can set up a data service document as a way to make the data available to users and applications.</span></span> <span data-ttu-id="63ac0-146">“数据服务文档”(.atomsvc) 文件指定一个或多个连接，这些连接指向以 Atom 线路格式发布数据的联机源\*\*。</span><span class="sxs-lookup"><span data-stu-id="63ac0-146">A *data service document* (.atomsvc) file specifies one or more connections to online sources that publish data in the Atom wire format.</span></span> <span data-ttu-id="63ac0-147">可以在“数据馈送库”\*\* 中创建数据服务文档，该库是一个专用库，它可以为浏览已发布到 SharePoint 服务器的数据服务文档提供公共访问点。</span><span class="sxs-lookup"><span data-stu-id="63ac0-147">Data service documents can be created in a *data feed library*, which is a special-purpose library that provides a common access point for browsing data service documents that have been published to a SharePoint server.</span></span> <span data-ttu-id="63ac0-148">如果信息工作者有权访问数据馈送库中的数据服务文档，他们就可以通过引用该文档的 SharePoint URL 将数据馈送导入自己的工作簿和应用程序。</span><span class="sxs-lookup"><span data-stu-id="63ac0-148">Information workers who have permission to access data service documents in the data feed library can reference the document's SharePoint URL to import the data feeds to their workbooks and applications.</span></span>  
  
1.  <span data-ttu-id="63ac0-149">打开由您的站点管理员创建的数据馈送库。</span><span class="sxs-lookup"><span data-stu-id="63ac0-149">Open a data feed library that was created by your site administrator.</span></span> <span data-ttu-id="63ac0-150">有关详细信息，请参阅[创建或自定义数据馈送库 &#40;PowerPivot for SharePoint&#41;](create-or-customize-a-data-feed-library-power-pivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="63ac0-150">For more information, see [Create or Customize a Data Feed Library &#40;PowerPivot for SharePoint&#41;](create-or-customize-a-data-feed-library-power-pivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="63ac0-151">在“库工具”中，单击 **“文档”**。</span><span class="sxs-lookup"><span data-stu-id="63ac0-151">In Library Tools, click **Documents**.</span></span>  
  
3.  <span data-ttu-id="63ac0-152">单击 **“新建文档”**。</span><span class="sxs-lookup"><span data-stu-id="63ac0-152">Click **New Document**.</span></span>  
  
4.  <span data-ttu-id="63ac0-153">提供文件名和描述。</span><span class="sxs-lookup"><span data-stu-id="63ac0-153">Provide a file name and description.</span></span>  
  
5.  <span data-ttu-id="63ac0-154">指定一个或多个提供馈送的 URL：</span><span class="sxs-lookup"><span data-stu-id="63ac0-154">Specify one or more URLs that provide the feed:</span></span>  
  
    1.  <span data-ttu-id="63ac0-155">**“基本 URL”** 是可选的。</span><span class="sxs-lookup"><span data-stu-id="63ac0-155">**Base URL** is optional.</span></span> <span data-ttu-id="63ac0-156">如果数据服务文档提供多个馈送，则应该指定此选项。</span><span class="sxs-lookup"><span data-stu-id="63ac0-156">You should specify it if a data service document provides multiple feeds.</span></span> <span data-ttu-id="63ac0-157">基本 URL 应该指定所有馈送共有的 URL 部分（例如服务器名称和站点）。</span><span class="sxs-lookup"><span data-stu-id="63ac0-157">Base URL should specify the portion of the URL that is common to all the feeds (for example, the server name and site).</span></span> <span data-ttu-id="63ac0-158">如果按照 Reporting Services 报表创建数据服务文档，则基本 URL 将是报表服务器 URL 和报表。</span><span class="sxs-lookup"><span data-stu-id="63ac0-158">If you are creating a data service document to a Reporting Services report, the base URL would be the report server URL and report.</span></span>  
  
    2.  <span data-ttu-id="63ac0-159">**“Web 服务 URL”** 是必需的。</span><span class="sxs-lookup"><span data-stu-id="63ac0-159">**Web Service URL** is required.</span></span> <span data-ttu-id="63ac0-160">如果没有基本 URL，此值必须在地址中包含 http:// 或 https://。</span><span class="sxs-lookup"><span data-stu-id="63ac0-160">Without the Base URL, this value must include http:// or https:// in the address.</span></span> <span data-ttu-id="63ac0-161">如果指定了基本 URL，则 Web 服务 URL 为基本 URL 之后的部分。</span><span class="sxs-lookup"><span data-stu-id="63ac0-161">If you specified a Base URL, the Web service URL is the portion that follows the Base URL.</span></span> <span data-ttu-id="63ac0-162">例如，如果完整 URL 为 http://adventure-works/inventory/today.aspx ，则基 url 将为 http://adventure-works/inventory ，并且 WEB 服务 URL 将为/today.aspx。</span><span class="sxs-lookup"><span data-stu-id="63ac0-162">For example, if the full URL is http://adventure-works/inventory/today.aspx, the Base URL would be http://adventure-works/inventory, and the Web service URL would be /today.aspx.</span></span>  
  
         <span data-ttu-id="63ac0-163">Web 服务 URL 可以包括用来筛选或选择数据子集的参数。</span><span class="sxs-lookup"><span data-stu-id="63ac0-163">The Web service URL can include parameters that filter or select a subset of data.</span></span> <span data-ttu-id="63ac0-164">提供馈送的应用程序或服务必须支持您在 URL 中指定的参数。</span><span class="sxs-lookup"><span data-stu-id="63ac0-164">The application or service that provides the feed must support the parameters that you specify in the URL.</span></span>  
  
6.  <span data-ttu-id="63ac0-165">输入 **“表名”**，每个馈送对应一个表。</span><span class="sxs-lookup"><span data-stu-id="63ac0-165">Enter a **Table Name**, one table for each feed.</span></span> <span data-ttu-id="63ac0-166">此值是必需的。</span><span class="sxs-lookup"><span data-stu-id="63ac0-166">This value is required.</span></span> <span data-ttu-id="63ac0-167">表名由使用数据馈送的客户端应用程序使用。</span><span class="sxs-lookup"><span data-stu-id="63ac0-167">The table name is used by a client application that consumes the data feed.</span></span> <span data-ttu-id="63ac0-168">在 PowerPivot for Excel 中，表名用于在包含导入数据的 PowerPivot 窗口中对表命名。</span><span class="sxs-lookup"><span data-stu-id="63ac0-168">In PowerPivot for Excel, the table name is used to name tables in the PowerPivot window that will contain the imported data.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="63ac0-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="63ac0-169">See Also</span></span>  
 <span data-ttu-id="63ac0-170">[在管理中心中为网站集激活 PowerPivot 功能集成](activate-power-pivot-integration-for-site-collections-in-ca.md) </span><span class="sxs-lookup"><span data-stu-id="63ac0-170">[Activate PowerPivot Feature Integration for Site Collections in Central Administration](activate-power-pivot-integration-for-site-collections-in-ca.md) </span></span>  
 [<span data-ttu-id="63ac0-171">使用数据馈送库共享数据馈送 &#40;PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="63ac0-171">Share Data Feeds Using a Data Feed Library &#40;PowerPivot for SharePoint&#41;</span></span>](share-data-feeds-using-a-data-feed-library-power-pivot-for-sharepoint.md)  
  
  
