---
title: PowerPivot BI 语义模型连接 (. bism) |Microsoft Docs
ms.custom: ''
ms.date: 04/19/2015
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 08828eec-4f8c-4f34-a145-e442f7b7031d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 14a30128986a5ba23cb093be771c036c94fa25ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87589910"
---
# <a name="powerpivot-bi-semantic-model-connection-bism"></a><span data-ttu-id="bd877-102">PowerPivot BI 语义模型连接 (.bism)</span><span class="sxs-lookup"><span data-stu-id="bd877-102">PowerPivot BI Semantic Model Connection (.bism)</span></span>
  <span data-ttu-id="bd877-103">BI 语义模型连接 (.bism) 是可移植的连接，可在多维模式下将 Excel 或 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 报表连接到 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 表格模型数据库或 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例。</span><span class="sxs-lookup"><span data-stu-id="bd877-103">A BI semantic model connection (.bism) is a portable connection that connects Excel or [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports to an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] tabular model database or an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in multidimensional mode.</span></span> <span data-ttu-id="bd877-104">如果您熟悉 Office 数据连接 (.odc) 文件，则您会注意到定义和使用 .bism 连接文件的方式的相似性。</span><span class="sxs-lookup"><span data-stu-id="bd877-104">If you are familiar with office data connection (.odc) files, you will notice a similarity in how a .bism connection file is defined and used.</span></span>  
  
 <span data-ttu-id="bd877-105">BI 语义模型连接是通过 SharePoint 创建和访问的。</span><span class="sxs-lookup"><span data-stu-id="bd877-105">A BI semantic model connection is created and accessed via SharePoint.</span></span> <span data-ttu-id="bd877-106">创建 BI 语义模型连接后，您可以对库中的 BI 语义模型连接启用快速启动命令。</span><span class="sxs-lookup"><span data-stu-id="bd877-106">Creating BI semantic model connections enables quick launch commands on a BI semantic model connection in a library.</span></span> <span data-ttu-id="bd877-107">快速启动命令打开新的 Excel 工作簿或选项来供您编辑连接文件。</span><span class="sxs-lookup"><span data-stu-id="bd877-107">Quick launch commands open a new Excel workbook or options for editing the connection file.</span></span> <span data-ttu-id="bd877-108">如果已安装 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] ，你还会看到用于创建 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 报表的命令。</span><span class="sxs-lookup"><span data-stu-id="bd877-108">If [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] is installed, you will also see a command to create a [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] report.</span></span>  
  
 <span data-ttu-id="bd877-109">![BISM 快速启动命令的屏幕快照](../media/ssas-bism-quicklaunch.gif "BISM 快速启动命令的屏幕快照")</span><span class="sxs-lookup"><span data-stu-id="bd877-109">![Screenshot of BISM quick launch command](../media/ssas-bism-quicklaunch.gif "Screenshot of BISM quick launch command")</span></span>  
  
##  <a name="supported-databases"></a><a name="bkmk_prereq"></a><span data-ttu-id="bd877-110">支持的数据库</span><span class="sxs-lookup"><span data-stu-id="bd877-110">Supported databases</span></span>  
 <span data-ttu-id="bd877-111">BI 语义模型连接指向表格模型数据。</span><span class="sxs-lookup"><span data-stu-id="bd877-111">A BI semantic model connection points to tabular model data.</span></span> <span data-ttu-id="bd877-112">存在三种可用于此数据的数据源：</span><span class="sxs-lookup"><span data-stu-id="bd877-112">There are three sources for this data:</span></span>  
  
-   <span data-ttu-id="bd877-113">以表格服务器模式在独立的 Analysis Services 实例上运行的表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="bd877-113">A tabular model database running on a standalone Analysis Services instance in tabular server mode.</span></span> <span data-ttu-id="bd877-114">独立 Analysis Services 实例的部署位于场外部。</span><span class="sxs-lookup"><span data-stu-id="bd877-114">A deployment of a standalone Analysis Services instance is external to the farm.</span></span> <span data-ttu-id="bd877-115">访问场外部的数据源要求附加权限，您可在本主题中阅读相关信息： [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)。</span><span class="sxs-lookup"><span data-stu-id="bd877-115">Accessing data sources off the farm requires additional permissions, which you can read about in this topic: [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
-   <span data-ttu-id="bd877-116">保存到 SharePoint 的 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="bd877-116">PowerPivot workbooks saved to SharePoint.</span></span> <span data-ttu-id="bd877-117">Excel 工作簿内嵌入的 PowerPivot 数据库等效于在独立的 Analysis Services 表格模式服务器上运行的表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="bd877-117">Embedded PowerPivot databases inside Excel workbooks are equivalent to tabular model databases that run on a standalone Analysis Services tabular mode server.</span></span> <span data-ttu-id="bd877-118">如果您已经使用 PowerPivot for Excel 和 PowerPivot for SharePoint，则可以定义指向 SharePoint 库中 PowerPivot 工作簿的 BI 语义模型连接，并且使用现有 PowerPivot 数据生成 [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] 报表。</span><span class="sxs-lookup"><span data-stu-id="bd877-118">If you already use PowerPivot for Excel and PowerPivot for SharePoint, you can define a BI semantic model connection that points to PowerPivot workbooks in a SharePoint library and build [!INCLUDE[ssCrescent](../../includes/sscrescent-md.md)] reports using existing PowerPivot data.</span></span>  <span data-ttu-id="bd877-119">您可以使用在 PowerPivot for Excel 的 SQL Server 2008 R2 或 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 版本中创建的工作簿。</span><span class="sxs-lookup"><span data-stu-id="bd877-119">You can use workbooks created in either SQL Server 2008 R2 or [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] versions of PowerPivot for Excel.</span></span>  
  
-   <span data-ttu-id="bd877-120">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例的多维数据模型。</span><span class="sxs-lookup"><span data-stu-id="bd877-120">A multidimensional data model on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span>  
  
 <span data-ttu-id="bd877-121">有关数据源的比较，请参阅社区内容[了解 SQL Server 2012 BI 语义模型 (BISM) ](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/)。</span><span class="sxs-lookup"><span data-stu-id="bd877-121">For a comparison of the data sources, see the community  content [Understanding the SQL Server 2012 BI Semantic Model (BISM)](http://www.mssqltips.com/sqlservertip/2818/understanding-the-sql-server-2012-bi-semantic-model-bism/).</span></span>  
  
## <a name="understanding-the-connection-sequence-for-bi-semantic-connections"></a><span data-ttu-id="bd877-122">理解 BI 语义连接的连接顺序</span><span class="sxs-lookup"><span data-stu-id="bd877-122">Understanding the Connection Sequence for BI Semantic Connections</span></span>  
 <span data-ttu-id="bd877-123">本节介绍不同客户端应用程序（例如 Excel 桌面应用程序或 SharePoint 上的 Power View 报表客户端）与 SharePoint 场内部或外部的表格模型数据库之间的连接行为。</span><span class="sxs-lookup"><span data-stu-id="bd877-123">This section explains the connection behavior between various client applications, such as the Excel desktop application or the Power View reporting client on SharePoint, and a tabular model database inside or outside the SharePoint farm.</span></span>  
  
 <span data-ttu-id="bd877-124">与表格模型数据库的所有连接都是使用正请求数据的用户的凭据建立的。</span><span class="sxs-lookup"><span data-stu-id="bd877-124">All connections to a tabular model database are made using the credentials of the user who is requesting the data.</span></span> <span data-ttu-id="bd877-125">但是，该连接的机制将受到以下因素的影响：连接是否为场内连接、是单跃点还是双跃点连接以及是否启用了 Kerberos。</span><span class="sxs-lookup"><span data-stu-id="bd877-125">However, the mechanics of that connection will vary depending on whether the connection is an in-farm connection, a single or double-hop connection, and whether Kerberos is enabled.</span></span> <span data-ttu-id="bd877-126">有关 SharePoint 和后端数据源之间经身份验证的连接的详细信息，请参阅 [双跃点身份验证：NTLM 为什么失败以及 Kerberos 为什么有效](https://go.microsoft.com/fwlink/?LinkId=237137)。</span><span class="sxs-lookup"><span data-stu-id="bd877-126">For more information about authenticated connections between SharePoint and backend data sources, see [Double-hop authentication: Why NTLM fails and Kerberos works](https://go.microsoft.com/fwlink/?LinkId=237137).</span></span>  
  
 <span data-ttu-id="bd877-127">**从 Excel 连接到网络上的表格数据**</span><span class="sxs-lookup"><span data-stu-id="bd877-127">**Connecting from Excel to tabular data on a network**</span></span>  
  
 <span data-ttu-id="bd877-128">在某个 Excel 用户将 BI 语义模型连接指定为数据源时，.bism 文件中的连接信息将下载到客户端应用程序，然后将它自己的直接请求发布到 Analysis Services 上的表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="bd877-128">When an Excel user specifies a BI semantic model connection as a data source, the connection information inside the .bism file is downloaded to the client application, which then issues its own direct request to the tabular model database on Analysis Services.</span></span> <span data-ttu-id="bd877-129">若要访问该 .bism 连接，此 Excel 用户必须是对该 .bism 连接文件具有读取权限的 SharePoint 用户。</span><span class="sxs-lookup"><span data-stu-id="bd877-129">To access the .bism connection, the Excel user must be a SharePoint user with read permissions on the .bism connection file.</span></span> <span data-ttu-id="bd877-130">在下载了连接信息后，所有后续连接都将绕过 SharePoint，直接从 Excel 流到后端表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="bd877-130">Once the connection information is downloaded, all subsequent connections bypass SharePoint, flowing directly from Excel to the backend tabular model database.</span></span>  
  
 <span data-ttu-id="bd877-131">下图说明此连接顺序。</span><span class="sxs-lookup"><span data-stu-id="bd877-131">The following illustration shows this connection sequence.</span></span> <span data-ttu-id="bd877-132">它从针对此 .bism 连接的请求开始，随后是将连接信息下载到客户端，最后是与数据库的单跃点连接。</span><span class="sxs-lookup"><span data-stu-id="bd877-132">It starts with a request for the .bism connection, followed by the download of connection information to the client, and finally the single-hop connection to the database.</span></span> <span data-ttu-id="bd877-133">该连接是使用对 Analysis Services 数据库具有读取权限的 Excel 用户的 Windows 凭据建立的。</span><span class="sxs-lookup"><span data-stu-id="bd877-133">The connection is made using the Windows credentials of the Excel user, who has read permissions on the Analysis Services database.</span></span> <span data-ttu-id="bd877-134">该连接是单跃点连接；因此，即使启用了 Kerberos，在此环境下也不需要 Kerberos。</span><span class="sxs-lookup"><span data-stu-id="bd877-134">It is a single hop, so even if Kerberos is enabled, it is not required for this scenario.</span></span>  
  
 <span data-ttu-id="bd877-135">![从 Excel 连接到表格模型数据库](../media/ssas-powerpivotbismconnection-1.gif "从 Excel 连接到表格模型数据库")</span><span class="sxs-lookup"><span data-stu-id="bd877-135">![Connections from Excel to tabular model database](../media/ssas-powerpivotbismconnection-1.gif "Connections from Excel to tabular model database")</span></span>  
  
 <span data-ttu-id="bd877-136">**从 Power View 连接到网络上的表格数据**</span><span class="sxs-lookup"><span data-stu-id="bd877-136">**Connecting from Power View to tabular data on a network**</span></span>  
  
 <span data-ttu-id="bd877-137">在某一 SharePoint 用户在文档库中单击某一 BI 语义连接后，Power View（如果已安装）将立即启动并且打开与表格模型数据库的连接。</span><span class="sxs-lookup"><span data-stu-id="bd877-137">When a SharePoint user clicks on a BI semantic connection in a document library, Power View (if it is installed), starts immediately and opens a connection to the tabular model database.</span></span>  
  
 <span data-ttu-id="bd877-138">Power View 和表格模型数据库之间的连接遵循双跃点身份验证顺序，其中，用户标识从客户端流到 SharePoint，然后从 SharePoint 流到在场外运行的后端 Analysis Services 表格模型数据库。</span><span class="sxs-lookup"><span data-stu-id="bd877-138">Connections between Power View and a tabular model database follow a double-hop authentication sequence where the user identity is flowed from the client to SharePoint, and then from SharePoint to a back-end Analysis Services tabular model database that runs outside of the farm.</span></span> <span data-ttu-id="bd877-139">处理连接请求的 ADOMD.NET 客户端库在首次尝试时始终会尝试使用 Kerberos。</span><span class="sxs-lookup"><span data-stu-id="bd877-139">The ADOMD.NET client library that handles the connection request always tries Kerberos on the first attempt.</span></span> <span data-ttu-id="bd877-140">如果配置了 Kerberos，则在与表格模型数据库的连接上将模拟该用户标识，并且连接将成功。</span><span class="sxs-lookup"><span data-stu-id="bd877-140">If Kerberos is configured, the user identity is impersonated on the connection to the tabular model database, and the connection succeeds.</span></span>  
  
 <span data-ttu-id="bd877-141">如果未配置 Kerberos 并且请求失败，则 Reporting Services 将进行第二次尝试。</span><span class="sxs-lookup"><span data-stu-id="bd877-141">If Kerberos is not configured and the request fails, Reporting Services makes a second attempt.</span></span> <span data-ttu-id="bd877-142">在这种情况下，客户端库将使用 Reporting Services 服务标识和 NTLM 身份验证连接到 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="bd877-142">Under this scenario, the client library connects to Analysis Services using the Reporting Services service identity and NTLM authentication.</span></span> <span data-ttu-id="bd877-143">Power View 用户的标识使用 `effectiveusername` 参数传递到连接字符串上。</span><span class="sxs-lookup"><span data-stu-id="bd877-143">The identity of the Power View user is passed on the connection string using the `effectiveusername` parameter.</span></span>  
  
 <span data-ttu-id="bd877-144">在 Analysis Services 实例上，只有系统管理员角色的成员才有权使用 `effectiveusername` 参数进行连接和模拟该服务器实例上的其他用户。</span><span class="sxs-lookup"><span data-stu-id="bd877-144">Only a member of the system administrator role on the Analysis Services instance has permission to make a connection using the `effectiveusername` parameter and impersonate another user on the server instance.</span></span> <span data-ttu-id="bd877-145">因此，Reporting Services 共享服务的执行帐户必须对 Analysis Services 实例具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="bd877-145">For this reason, the execution account of the Reporting Services shared service must have administrative rights on the Analysis Services instance.</span></span>  <span data-ttu-id="bd877-146">主题 [创建与表格模型数据库的 BI 语义模型连接](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)中将提供有关向服务帐户授予管理权限的说明。</span><span class="sxs-lookup"><span data-stu-id="bd877-146">Instructions for granting administrative permissions to the service account is provided in this topic, [Create a BI Semantic Model Connection to a Tabular Model Database](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md).</span></span>  
  
 <span data-ttu-id="bd877-147">下图展示了将相同 Windows 用户标识用于每个连接的连接顺序。</span><span class="sxs-lookup"><span data-stu-id="bd877-147">The following illustration shows a connection sequence that uses the same Windows user identity for each connection.</span></span> <span data-ttu-id="bd877-148">在与 Analysis Services 的最后连接上，按 Reporting Services 服务应用程序标识进行连接，并且使用 `effectiveusername` 传递 Windows 用户标识。</span><span class="sxs-lookup"><span data-stu-id="bd877-148">On the last connection to Analysis Services, the connection is made by the Reporting Services service application identity, passing the Windows user identity using `effectiveusername`.</span></span>  
  
 <span data-ttu-id="bd877-149">![到表格数据库的模拟连接](../media/ssas-powerpivotbismconnection-2.gif "到表格数据库的模拟连接")</span><span class="sxs-lookup"><span data-stu-id="bd877-149">![Imersonated connection to tabular db](../media/ssas-powerpivotbismconnection-2.gif "Imersonated connection to tabular db")</span></span>  
  
 <span data-ttu-id="bd877-150">**从 Power View 连接到 SharePoint 中的 PowerPivot 数据**</span><span class="sxs-lookup"><span data-stu-id="bd877-150">**Connecting from Power View to PowerPivot data in SharePoint**</span></span>  
  
 <span data-ttu-id="bd877-151">在某一 SharePoint 用户单击解析为相同场中的 PowerPivot 工作簿的某一 BI 语义连接后，连接将在 SharePoint 环境的上下文内发生。</span><span class="sxs-lookup"><span data-stu-id="bd877-151">When a SharePoint user clicks on a BI semantic connection that resolves to a PowerPivot workbook in the same farm, the connections occur within the context of the SharePoint environment.</span></span> <span data-ttu-id="bd877-152">PowerPivot 服务应用程序将处理连接请求，将其转发到同一计算机上的 Analysis Services 实例。</span><span class="sxs-lookup"><span data-stu-id="bd877-152">A PowerPivot service application handles the connection request, which it forwards to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="bd877-153">该 Analysis Services 实例将从工作簿中提取 PowerPivot 数据并且加载这些数据。</span><span class="sxs-lookup"><span data-stu-id="bd877-153">The Analysis Services instance extracts the PowerPivot data from the workbook and loads it.</span></span> <span data-ttu-id="bd877-154">所有后续连接均由场中的 PowerPivot 服务应用程序进行管理。</span><span class="sxs-lookup"><span data-stu-id="bd877-154">All subsequent connections are managed by PowerPivot service applications in the farm.</span></span>  
  
 <span data-ttu-id="bd877-155">在这种情况下，所有连接都在同一个场中发生，因此，没有对 Kerberos 或约束委托的要求。</span><span class="sxs-lookup"><span data-stu-id="bd877-155">In this scenario, all connections occur within the same farm, so there is no requirement for Kerberos or constrained delegation.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel"></a> <span data-ttu-id="bd877-156">相关任务</span><span class="sxs-lookup"><span data-stu-id="bd877-156">Related Tasks</span></span>  
 [<span data-ttu-id="bd877-157">将 BI 语义模型连接内容类型添加到库 &#40;PowerPivot for SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="bd877-157">Add a BI Semantic Model Connection Content Type to a Library &#40;PowerPivot for SharePoint&#41;</span></span>](add-bi-semantic-model-connection-content-type-to-library.md)  
  
 [<span data-ttu-id="bd877-158">创建与 PowerPivot 工作簿的 BI 语义模型连接</span><span class="sxs-lookup"><span data-stu-id="bd877-158">Create a BI Semantic Model Connection to a PowerPivot Workbook</span></span>](create-a-bi-semantic-model-connection-to-a-power-pivot-workbook.md)  
  
 [<span data-ttu-id="bd877-159">Create a BI Semantic Model Connection to a Tabular Model Database</span><span class="sxs-lookup"><span data-stu-id="bd877-159">Create a BI Semantic Model Connection to a Tabular Model Database</span></span>](create-a-bi-semantic-model-connection-to-a-tabular-model-database.md)  
  
 [<span data-ttu-id="bd877-160">在 Excel 或 Reporting Services 中使用 BI 语义模型连接</span><span class="sxs-lookup"><span data-stu-id="bd877-160">Use a BI Semantic Model Connection in Excel or Reporting Services</span></span>](use-a-bi-semantic-model-connection-in-excel-or-reporting-services.md)  
  
## <a name="see-also"></a><span data-ttu-id="bd877-161">另请参阅</span><span class="sxs-lookup"><span data-stu-id="bd877-161">See Also</span></span>  
 <span data-ttu-id="bd877-162">[确定 Analysis Services 实例的服务器模式](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span><span class="sxs-lookup"><span data-stu-id="bd877-162">[Determine the Server Mode of an Analysis Services Instance](../instances/determine-the-server-mode-of-an-analysis-services-instance.md) </span></span>  
 [<span data-ttu-id="bd877-163">连接到 Analysis Services</span><span class="sxs-lookup"><span data-stu-id="bd877-163">Connect to Analysis Services</span></span>](../instances/connect-to-analysis-services.md)  
  
  
