---
title: 在管理中心中创建和配置 PowerPivot 服务应用程序 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b2e5693e-4af3-453f-83f3-07481ab1ac6a
author: minewiskan
ms.author: owend
ms.openlocfilehash: 8becac1ecce25b6798dc727a00a3f5b0afed572c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688312"
---
# <a name="create-and-configure-a-powerpivot-service-application-in-central-administration"></a><span data-ttu-id="dd637-102">在管理中心中创建和配置 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-102">Create and Configure a PowerPivot Service Application in Central Administration</span></span>
  <span data-ttu-id="dd637-103">PowerPivot 服务应用程序是 PowerPivot 系统服务的共享服务实例。</span><span class="sxs-lookup"><span data-stu-id="dd637-103">A PowerPivot service application is a shared service instance of the PowerPivot System Service.</span></span> <span data-ttu-id="dd637-104">每个服务应用程序都具有自己的应用程序标识、配置设置、属性和内部数据存储。</span><span class="sxs-lookup"><span data-stu-id="dd637-104">Each service application has its own application identity, configuration settings, properties, and internal data storage.</span></span>  
  
 <span data-ttu-id="dd637-105">本主题包含以下各节：</span><span class="sxs-lookup"><span data-stu-id="dd637-105">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="dd637-106">确定是否创建新的 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-106">Determine whether to create a new PowerPivot Service Application</span></span>](#determine)  
  
 [<span data-ttu-id="dd637-107">创建 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-107">Create a PowerPivot Service Application</span></span>](#CreateApp)  
  
 [<span data-ttu-id="dd637-108">配置 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-108">Configure the PowerPivot Service Application</span></span>](#ConfigApp)  
  
 [<span data-ttu-id="dd637-109">将 PowerPivot 服务应用程序分配给 Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-109">Assign a PowerPivot Service Application to a Web Application</span></span>](#AssignGSA)  
  
 [<span data-ttu-id="dd637-110">编辑服务应用程序属性</span><span class="sxs-lookup"><span data-stu-id="dd637-110">Edit Service Application Properties</span></span>](#EditGSA)  
  
##  <a name="determine-whether-to-create-a-new-powerpivot-service-application"></a><a name="determine"></a><span data-ttu-id="dd637-111">确定是否创建新的 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-111">Determine whether to create a new PowerPivot Service Application</span></span>  
 <span data-ttu-id="dd637-112">PowerPivot for SharePoint 安装必须在场中具有至少一个 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-112">A PowerPivot for SharePoint installation must have at least one PowerPivot service application in the farm.</span></span> <span data-ttu-id="dd637-113">如果您使用了 PowerPivot 配置工具来配置服务器，则会自动创建服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-113">A service application is created automatically if you used the PowerPivot Configuration Tool to configure the server.</span></span> <span data-ttu-id="dd637-114">否则，您必须在管理中心手动创建 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-114">Otherwise, you must create a PowerPivot service application manually in Central Administration.</span></span>  
  
 <span data-ttu-id="dd637-115">创建服务应用程序将使该服务可用并生成服务应用程序数据库。</span><span class="sxs-lookup"><span data-stu-id="dd637-115">Creating a service application makes the service available and generates the service application database.</span></span> <span data-ttu-id="dd637-116">根据您在创建服务应用程序时选择的选项，PowerPivot 服务连接将添加到默认的服务连接组中。</span><span class="sxs-lookup"><span data-stu-id="dd637-116">Depending on options you select when creating the service application, a PowerPivot service connection is added to the default service connection group.</span></span> <span data-ttu-id="dd637-117">订阅默认服务连接组的所有 SharePoint Web 应用程序都将自动获得对 PowerPivot 服务应用程序的直接访问权限。</span><span class="sxs-lookup"><span data-stu-id="dd637-117">All SharePoint Web applications that subscribe to the default service connection group will get immediate access to the PowerPivot service application automatically.</span></span>  
  
 <span data-ttu-id="dd637-118">您可以创建多个 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-118">You can create multiple PowerPivot service applications.</span></span> <span data-ttu-id="dd637-119">尽管一个服务应用程序对大多数部署方案就足够了，但如果您的业务具有如下要求，则可能要考虑创建附加的 PowerPivot 服务应用程序：</span><span class="sxs-lookup"><span data-stu-id="dd637-119">Although one service application is sufficient for most deployment scenarios, you might consider creating an additional PowerPivot service application if your business requirements include the following:</span></span>  
  
-   <span data-ttu-id="dd637-120">为每个应用程序使用不同的无人参与的 PowerPivot 数据刷新帐户。</span><span class="sxs-lookup"><span data-stu-id="dd637-120">Using a different unattended PowerPivot data refresh account for each application.</span></span>  
  
-   <span data-ttu-id="dd637-121">使用不同的超时、使用情况历史记录以及用于查询响应报告的阈值。</span><span class="sxs-lookup"><span data-stu-id="dd637-121">Using different timeouts, usage history, and thresholds for query response reporting.</span></span>  
  
-   <span data-ttu-id="dd637-122">将服务管理委托给不同的人士。</span><span class="sxs-lookup"><span data-stu-id="dd637-122">Delegating service administration to different people.</span></span> <span data-ttu-id="dd637-123">管理员将看到数据刷新历史记录、使用情况数据以及仅限于其管理的应用程序的其他属性。</span><span class="sxs-lookup"><span data-stu-id="dd637-123">An administrator will see data refresh history, usage data, and other properties only for the application he or she is administering.</span></span> <span data-ttu-id="dd637-124">如果要求您隔离 SharePoint Web 应用程序（例如，如果您的公司提供宿主服务，该服务必须确保为属于不同客户的 SharePoint Web 应用程序进行数据隔离），则创建单独的 PowerPivot 服务应用程序可通过确保每个服务管理员仅看到其所管理的应用程序的配置设置和属性，帮助满足隔离要求。</span><span class="sxs-lookup"><span data-stu-id="dd637-124">If you are required to isolate SharePoint web applications (for example, if your company is a hosting service that must guarantee data isolation for the SharePoint Web applications that belong to different customers), creating separate PowerPivot service applications can help meet isolation requirements by ensuring each service administrator sees only the configuration settings and properties for the application he or she manages.</span></span>  
  
 <span data-ttu-id="dd637-125">创建附加的服务应用程序为管理服务关联引入了新的要求。</span><span class="sxs-lookup"><span data-stu-id="dd637-125">Creating additional service application introduces new requirements for managing service associations.</span></span> <span data-ttu-id="dd637-126">也就是说，将要求您为您创建的每个附加的服务应用程序都创建和使用自定义的服务关联列表。</span><span class="sxs-lookup"><span data-stu-id="dd637-126">Namely, it will require that you create and use custom service association lists for each additional service application that you create.</span></span>  
  
 <span data-ttu-id="dd637-127">如果您没有明确的理由需要创建附加的 PowerPivot 服务应用程序，则应使用单个服务应用程序来用于场中的所有 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-127">If you do not have a specific reason for creating additional PowerPivot service application, you should use a single service application for all of the Web applications in the farm.</span></span>  
  
##  <a name="create-a-powerpivot-service-application"></a><a name="CreateApp"></a><span data-ttu-id="dd637-128">创建 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-128">Create a PowerPivot Service Application</span></span>  
  
1.  <span data-ttu-id="dd637-129">在“管理中心”的“应用程序管理”中，单击 **“管理服务应用程序”** 。</span><span class="sxs-lookup"><span data-stu-id="dd637-129">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="dd637-130">在 **“服务应用程序”** 功能区中，单击 **“新建”**。</span><span class="sxs-lookup"><span data-stu-id="dd637-130">In the **Service Applications** ribbon, click **New**.</span></span>  
  
3.  <span data-ttu-id="dd637-131">选择**SQL Server PowerPivot 服务应用程序**。</span><span class="sxs-lookup"><span data-stu-id="dd637-131">Select **SQL Server PowerPivot Service Application**.</span></span> <span data-ttu-id="dd637-132">如果该服务未在列表中出现，则表示 PowerPivot for SharePoint 未安装或者配置不正确。</span><span class="sxs-lookup"><span data-stu-id="dd637-132">If it does not appear in the list, PowerPivot for SharePoint is not installed or configured correctly.</span></span>  
  
4.  <span data-ttu-id="dd637-133">在 "**创建新的 PowerPivot 服务应用程序**" 页中，输入应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="dd637-133">In the **Create New PowerPivot Service Application** page, enter a name for the application.</span></span> <span data-ttu-id="dd637-134">默认值为 Get-powerpivotserviceapplication \<number> 。</span><span class="sxs-lookup"><span data-stu-id="dd637-134">The default is PowerPivotServiceApplication\<number>.</span></span> <span data-ttu-id="dd637-135">如果您创建多个 PowerPivot 服务应用程序，则说明性的名称将有助于其他管理员理解应用程序的使用方式。</span><span class="sxs-lookup"><span data-stu-id="dd637-135">If you are creating multiple PowerPivot service applications, a descriptive name will help other administrators understand how the application is used.</span></span>  
  
5.  <span data-ttu-id="dd637-136">在“应用程序池”中，为该应用程序创建一个新的应用程序池（推荐）。</span><span class="sxs-lookup"><span data-stu-id="dd637-136">In Application Pool, create a new application pool for the application (recommended).</span></span> <span data-ttu-id="dd637-137">为该应用程序池选择或创建一个托管帐户。</span><span class="sxs-lookup"><span data-stu-id="dd637-137">Select or create a managed account for the application pool.</span></span> <span data-ttu-id="dd637-138">请确保指定一个域用户帐户。</span><span class="sxs-lookup"><span data-stu-id="dd637-138">Be sure to specify a domain user account.</span></span> <span data-ttu-id="dd637-139">通过域用户帐户，可以使用 SharePoint 的托管帐户功能，从而使您可以在一个位置中更新密码和帐户信息。</span><span class="sxs-lookup"><span data-stu-id="dd637-139">A domain user account enables the use of SharePoint's managed account feature, which lets you update passwords and account information in one place.</span></span> <span data-ttu-id="dd637-140">如果您计划扩展部署以便包括将在同一标识下运行的附加服务实例，则域帐户是必需的。</span><span class="sxs-lookup"><span data-stu-id="dd637-140">Domain accounts are also required if you plan to scale out the deployment to include additional service instances that will run under the same identity.</span></span>  
  
6.  <span data-ttu-id="dd637-141">在 **“数据库服务器”** 中，默认值是承载场配置数据库的 SQL Server 数据库引擎实例。</span><span class="sxs-lookup"><span data-stu-id="dd637-141">In **Database Server**, the default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span> <span data-ttu-id="dd637-142">您可以使用该服务器或者选择其他的 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="dd637-142">You can use this server or choose a different SQL Server.</span></span>  
  
7.  <span data-ttu-id="dd637-143">在 "**数据库名称**" 中，默认值为 PowerPivotServiceApplication1_ \<guid> 。</span><span class="sxs-lookup"><span data-stu-id="dd637-143">In **Database Name**, the default value is PowerPivotServiceApplication1_\<guid>.</span></span> <span data-ttu-id="dd637-144">您必须为每个 PowerPivot 服务应用程序都创建唯一的数据库。</span><span class="sxs-lookup"><span data-stu-id="dd637-144">You must create a unique database for each PowerPivot service application.</span></span> <span data-ttu-id="dd637-145">默认数据库名称对应于服务应用程序的默认名称。</span><span class="sxs-lookup"><span data-stu-id="dd637-145">The default database name corresponds to the default name of the service application.</span></span> <span data-ttu-id="dd637-146">如果您输入了唯一的服务应用程序名称，则遵循您的数据库名称的类似命名约定，以便可以一起管理它们。</span><span class="sxs-lookup"><span data-stu-id="dd637-146">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>  
  
8.  <span data-ttu-id="dd637-147">在 **“数据库身份验证”** 中，默认值是 “Windows 身份验证”。</span><span class="sxs-lookup"><span data-stu-id="dd637-147">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="dd637-148">如果您选择 **“SQL 身份验证”**，请参考 SharePoint 管理员指南以便了解有关如何在 SharePoint 部署中使用此身份验证类型的最佳实践。</span><span class="sxs-lookup"><span data-stu-id="dd637-148">If you choose **SQL Authentication**, refer to the SharePoint administrator guide for best practices on how to use this authentication type in a SharePoint deployment.</span></span>  
  
9. <span data-ttu-id="dd637-149">（可选）选中 "**将此 PowerPivot 服务应用程序的代理添加到场的默认代理组**" 复选框。</span><span class="sxs-lookup"><span data-stu-id="dd637-149">Optionally, select the checkbox for **Add the proxy for this PowerPivot Service Application to the farm's default proxy group.**</span></span> <span data-ttu-id="dd637-150">这会将该服务应用程序连接添加到默认服务连接组。</span><span class="sxs-lookup"><span data-stu-id="dd637-150">This adds the service application connection to the default service connection group.</span></span>  
  
     <span data-ttu-id="dd637-151">如果您在创建第一个 PowerPivot 服务应用程序，则必须选中此复选框。</span><span class="sxs-lookup"><span data-stu-id="dd637-151">You must select this checkbox if you are creating your first PowerPivot service application.</span></span> <span data-ttu-id="dd637-152">默认连接组中必须有一个 PowerPivot 服务应用程序，以便确保 PowerPivot 管理面板正确工作。</span><span class="sxs-lookup"><span data-stu-id="dd637-152">There must be one PowerPivot service application in the default connection group in order for PowerPivot Management Dashboard to work properly.</span></span>  
  
     <span data-ttu-id="dd637-153">如果默认连接组中已存在一个 PowerPivot 服务应用程序，则不要再向其中添加 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-153">Do not add the PowerPivot service application to the default connection group if one already exists.</span></span> <span data-ttu-id="dd637-154">添加同一服务应用程序类型的多个条目是不支持的配置并且可能导致错误。</span><span class="sxs-lookup"><span data-stu-id="dd637-154">Adding multiple entries of the same service application type is not a supported configuration and might cause errors.</span></span> <span data-ttu-id="dd637-155">如果您在创建附加的服务应用程序，则应将它们保留在默认连接组外并且将它们添加到自定义列表中。</span><span class="sxs-lookup"><span data-stu-id="dd637-155">If you are creating additional service applications, leave them out of the default connection group and add them to custom lists instead.</span></span>  
  
     <span data-ttu-id="dd637-156">有关服务关联的详细信息，请参阅[将 PowerPivot 服务应用程序连接到管理中心中的 SharePoint Web 应用程序](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md)。</span><span class="sxs-lookup"><span data-stu-id="dd637-156">For more information about service associations, see [Connect a PowerPivot Service Application to a SharePoint Web Application in Central Administration](connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).</span></span>  
  
10. <span data-ttu-id="dd637-157">单击“确定” **。**</span><span class="sxs-lookup"><span data-stu-id="dd637-157">Click **OK.**</span></span> <span data-ttu-id="dd637-158">。该服务将在场的服务应用程序列表中与其他托管服务显示在一起。</span><span class="sxs-lookup"><span data-stu-id="dd637-158">The service will appear alongside other managed services in the farm's service application list.</span></span>  
  
##  <a name="configure-powerpivot-service-application"></a><a name="ConfigApp"></a><span data-ttu-id="dd637-159">配置 PowerPivot 服务应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-159">Configure PowerPivot Service Application</span></span>  
 <span data-ttu-id="dd637-160">PowerPivot 服务应用程序使用默认配置创建。</span><span class="sxs-lookup"><span data-stu-id="dd637-160">A PowerPivot service application is created using a default configuration.</span></span> <span data-ttu-id="dd637-161">对于大多数情况，建议您采用这些默认设置。</span><span class="sxs-lookup"><span data-stu-id="dd637-161">The default settings are recommended for most scenarios.</span></span> <span data-ttu-id="dd637-162">仅在您遇到响应时间较长或删除的连接时，或者您在为特定的 SharePoint Web 应用程序改变 PowerPivot 服务配置时，才更改这些默认设置。</span><span class="sxs-lookup"><span data-stu-id="dd637-162">Change them only if you encounter slow response time or dropped connections, or if you are varying PowerPivot service configuration for specific SharePoint Web applications.</span></span>  
  
1.  <span data-ttu-id="dd637-163">在“管理中心”的“应用程序管理”中，单击 **“管理服务应用程序”** 。</span><span class="sxs-lookup"><span data-stu-id="dd637-163">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
     <span data-ttu-id="dd637-164">在服务应用程序列表中，您应该看到刚创建和命名的服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-164">In the list of service applications, you should see the service application you just created and named.</span></span> <span data-ttu-id="dd637-165">默认名称是 **PowerPivotServiceApplication1**。</span><span class="sxs-lookup"><span data-stu-id="dd637-165">The default is **PowerPivotServiceApplication1**.</span></span>  
  
2.  <span data-ttu-id="dd637-166">单击 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-166">Click the PowerPivot service application.</span></span> <span data-ttu-id="dd637-167">这将打开 PowerPivot 管理面板。</span><span class="sxs-lookup"><span data-stu-id="dd637-167">This opens the PowerPivot Management Dashboard.</span></span>  
  
3.  <span data-ttu-id="dd637-168">在面板右上角的 **“操作”** 列表中，单击 **“配置服务应用程序设置”**。</span><span class="sxs-lookup"><span data-stu-id="dd637-168">In the **Actions** list on the top right corner of the dashboard, click **Configure service application settings**.</span></span>  
  
4.  <span data-ttu-id="dd637-169">在 "**数据库加载超时**" 中，增加或减少值可以更改 powerpivot 服务等待来自它将加载数据请求转发到的 SQL Server Analysis Services (powerpivot) 实例的响应的时间长度。</span><span class="sxs-lookup"><span data-stu-id="dd637-169">In **Database Load Timeout**, increase or decrease the value to change how long the PowerPivot service waits for a response from the SQL Server Analysis Services (PowerPivot) instance to which it forwarded a load data request.</span></span> <span data-ttu-id="dd637-170">因为非常大的数据集需要花时间在线路上移动，所以必须确保 PowerPivot 服务实例有充裕的时间检索 Excel 工作簿并将 PowerPivot 数据移到 Analysis Services 实例以便进行查询处理。</span><span class="sxs-lookup"><span data-stu-id="dd637-170">Because very large datasets take time to move over the wire, you must allow sufficient time for the PowerPivot service instance to retrieve the Excel workbook and move the PowerPivot data to an Analysis Services instance for query processing.</span></span> <span data-ttu-id="dd637-171">因为 PowerPivot 数据可能会非常大，所以默认值为 30 分钟。</span><span class="sxs-lookup"><span data-stu-id="dd637-171">Because PowerPivot data can be unusually large, the default value is 30 minutes.</span></span>  
  
5.  <span data-ttu-id="dd637-172">在 **“连接池超时”** 中，增加或减少值可以更改空闲数据连接保持打开状态的分钟数。</span><span class="sxs-lookup"><span data-stu-id="dd637-172">In **Connection Pool Timeout**, increase or decrease the value to change how many minutes an idle data connection will remain open.</span></span> <span data-ttu-id="dd637-173">默认值为 30 分钟。</span><span class="sxs-lookup"><span data-stu-id="dd637-173">The default value is 30 minutes.</span></span> <span data-ttu-id="dd637-174">在此期间中，对于来自相同 PowerPivot 数据的同一 SharePoint 用户的只读请求，PowerPivot 服务将重用空闲数据连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-174">During this period, the PowerPivot service will reuse an idle data connection for read-only requests from the same SharePoint user for the same PowerPivot data.</span></span> <span data-ttu-id="dd637-175">如果在指定的时段中没有收到针对该数据的进一步的请求，则从池中删除该连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-175">If no further requests are received for that data during the period specified, the connection is removed from the pool.</span></span> <span data-ttu-id="dd637-176">有效值为 1 至 3600 秒。</span><span class="sxs-lookup"><span data-stu-id="dd637-176">Valid values are 1 to 3600 seconds.</span></span> <span data-ttu-id="dd637-177">有关连接池的详细信息，请参阅[配置设置参考 &#40;PowerPivot for SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="dd637-177">For more information about connection pools, see [Configuration Setting Reference &#40;PowerPivot for SharePoint&#41;](configuration-setting-reference-power-pivot-for-sharepoint.md).</span></span>  
  
6.  <span data-ttu-id="dd637-178">在 "**最大用户连接池大小**" 中，增加或减少值可以更改 PowerPivot 服务将在单独的连接池中为每个 SharePoint 用户、PowerPivot 数据集和版本组合创建的空闲连接的最大数量。</span><span class="sxs-lookup"><span data-stu-id="dd637-178">In **Maximum User Connection Pool Size**, increase or decrease the value to change the maximum number of idle connections the PowerPivot service will create in individual connection pools for each SharePoint user, PowerPivot dataset, and version combinations.</span></span>  
  
     <span data-ttu-id="dd637-179">默认值为 1000 个空闲连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-179">The default value is 1000 idle connections.</span></span> <span data-ttu-id="dd637-180">有效值为 -1（无限制）、0（禁用用户连接池）或 1 到 10000。</span><span class="sxs-lookup"><span data-stu-id="dd637-180">Valid values are -1 (unlimited), 0 (disables user connection pooling), or 1 to 10000.</span></span>  
  
     <span data-ttu-id="dd637-181">这些连接池使服务能够更有效地支持由同一用户建立的与相同只读数据的持续连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-181">These connection pools enable the service to more efficiently support ongoing connections to the same read-only data by the same user.</span></span> <span data-ttu-id="dd637-182">如果您禁用了连接池，将重新创建每个连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-182">If you disable connection pooling, every connection will be created anew.</span></span>  
  
     <span data-ttu-id="dd637-183">请注意，更改对连接池大小的限制（包括将其设置为 0）不会导致删除连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-183">Note that changing the limit on connection pool size, including setting it to 0, will not result in dropped connections.</span></span> <span data-ttu-id="dd637-184">连接池存在的目的是减少连接数据时需要等待的时间。</span><span class="sxs-lookup"><span data-stu-id="dd637-184">Connection pools exist to reduce wait times when connecting to data.</span></span> <span data-ttu-id="dd637-185">PowerPivot 服务将永远不会拒绝基于连接池设置的连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-185">The PowerPivot service will never deny a connection based on connection pool settings.</span></span>  
  
7.  <span data-ttu-id="dd637-186">在 "**最大管理连接池大小**" 中，增加或减少值可以更改连接池中为 PowerPivot 服务连接创建的打开的连接数 Analysis Services。</span><span class="sxs-lookup"><span data-stu-id="dd637-186">In **Maximum Administrative Connection Pool Size**, increase or decrease the value to change the number of open connections in a connection pool created for a PowerPivot service connection to Analysis Services.</span></span> <span data-ttu-id="dd637-187">每个 PowerPivot 服务实例都打开与同一计算机上的 Analysis Services 实例的单独管理连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-187">Each PowerPivot service instance opens a separate administrative connection to the Analysis Services instance on the same computer.</span></span> <span data-ttu-id="dd637-188">PowerPivot 服务创建一个单独的池以便出于检查空闲连接和监视服务器运行状况的目的而重用管理连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-188">PowerPivot service creates a separate pool to reuse administrative connections for the purpose of checking for idle connections and monitoring server health.</span></span> <span data-ttu-id="dd637-189">默认值为 200 个连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-189">The default value is 200 connections.</span></span> <span data-ttu-id="dd637-190">有效值为 -1（无限制）、0（禁用管理连接池）或 1 到 100。</span><span class="sxs-lookup"><span data-stu-id="dd637-190">Valid values are -1 (unlimited), 0 (disables administrative connection pooling), or 1 to 10000.</span></span> <span data-ttu-id="dd637-191">如果您选择 0，将重新创建每个连接。</span><span class="sxs-lookup"><span data-stu-id="dd637-191">If you select 0, every connection will be created anew.</span></span>  
  
8.  <span data-ttu-id="dd637-192">在 "**分配方法**" 中，可以指定负载平衡架构，PowerPivot 系统服务使用该架构选择特定的 PowerPivot 服务应用程序，以便对初始请求进行负载平衡。</span><span class="sxs-lookup"><span data-stu-id="dd637-192">In **Allocation Method**, you can specify the load balancing schema that the PowerPivot System Service uses to select a specific PowerPivot service application for load balancing an initial request.</span></span> <span data-ttu-id="dd637-193">默认设置为 **“基于运行状况”**，可基于服务器状态分配请求，服务器状态根据可用内存量和处理器使用率进行度量。</span><span class="sxs-lookup"><span data-stu-id="dd637-193">The default is **Health Based**, which allocates requests based on server state, as measured by available memory and processor utilization.</span></span> <span data-ttu-id="dd637-194">或者，您可以选择 **“循环”** ，以便无论服务器是正忙还是空闲，都按相同的重复顺序分配对服务器的请求。</span><span class="sxs-lookup"><span data-stu-id="dd637-194">Alternatively, you can choose **Round Robin** to allocate requests to servers in the same repeating order, regardless of whether a server is busy or idle.</span></span>  
  
9. <span data-ttu-id="dd637-195">在“数据刷新”的 **“工作时间”** 中，您可以指定用于定义工作日的小时范围。</span><span class="sxs-lookup"><span data-stu-id="dd637-195">In Data Refresh, in **Business Hours**, you can specify a range of hours that defines a business day.</span></span> <span data-ttu-id="dd637-196">数据刷新计划可以在下班后运行，以便选取在正常工作时间中生成的事务数据。</span><span class="sxs-lookup"><span data-stu-id="dd637-196">Data refresh schedules can run after the close of a business day to pick up transactional data that was generated during normal business hours.</span></span>  
  
10. <span data-ttu-id="dd637-197">在**PowerPivot 无人参与的数据刷新帐户**中，可以指定一个预定义的 Secure Store Service 目标应用程序，该应用程序存储用于运行 PowerPivot 数据刷新作业的预定义帐户。</span><span class="sxs-lookup"><span data-stu-id="dd637-197">In **PowerPivot Unattended Data Refresh Account**, you can specify a predefined Secure Store Service target application that stores a predefined account for running PowerPivot data refresh jobs.</span></span> <span data-ttu-id="dd637-198">请确保指定目标应用程序名称而不是 ID。</span><span class="sxs-lookup"><span data-stu-id="dd637-198">Be sure to specify the target application name, and not the ID.</span></span> <span data-ttu-id="dd637-199">如果您在 SQL Server 安装程序中使用了“新服务器”选项来安装 PowerPivot for SharePoint，则会自动创建用于无人参与的数据刷新的目标应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-199">The target application for unattended data refresh is created automatically if you used the New Server option in SQL Server Setup to install PowerPivot for SharePoint.</span></span> <span data-ttu-id="dd637-200">否则，您必须手动创建目标应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-200">Otherwise, you must create the target application manually.</span></span> <span data-ttu-id="dd637-201">有关如何配置帐户的说明，请参阅[配置 PowerPivot 无人参与的数据刷新帐户 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="dd637-201">For instructions on how to configure the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
11. <span data-ttu-id="dd637-202">在 **“允许用户输入自定义 Windows 凭据”** 中，您可以选中或取消选中复选框以便指定计划所有者是否可以输入任意的 Windows 凭据以便运行数据刷新计划。</span><span class="sxs-lookup"><span data-stu-id="dd637-202">In **Allow users to enter custom Windows credentials**, you can select or clear the checkbox to specify whether schedule owners can enter arbitrary Windows credentials to run a data refresh schedule.</span></span> <span data-ttu-id="dd637-203">如果您选中此复选框，PowerPivot 服务应用程序将为每组存储凭据都创建和管理目标应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-203">If you select this checkbox, PowerPivot service application will create and manage a target application each set of stored credentials.</span></span> <span data-ttu-id="dd637-204">有关详细信息，请参阅为[PowerPivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="dd637-204">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
12. <span data-ttu-id="dd637-205">在 **“最大处理历史记录长度”** 中，您可以指定保留多长时间的数据刷新处理的历史记录。</span><span class="sxs-lookup"><span data-stu-id="dd637-205">In **Maximum Processing History Length**, you can specify how long to retain a historical record of data refresh processing.</span></span> <span data-ttu-id="dd637-206">此信息显示在为使用数据刷新的每个工作簿保留的数据刷新历史记录页中。</span><span class="sxs-lookup"><span data-stu-id="dd637-206">This information appears in data refresh history pages that are kept for each workbook that uses data refresh.</span></span> <span data-ttu-id="dd637-207">它还出现在 PowerPivot 管理面板中。</span><span class="sxs-lookup"><span data-stu-id="dd637-207">It also appears in the PowerPivot Management Dashboard.</span></span>  
  
13. <span data-ttu-id="dd637-208">在“使用情况数据收集”的 **“查询报告间隔”** 中，指定用于报告查询统计信息的时间间隔。</span><span class="sxs-lookup"><span data-stu-id="dd637-208">In Usage Data Collection, in **Query Reporting Interval**, specify an interval of time for reporting query statistics.</span></span> <span data-ttu-id="dd637-209">查询统计信息作为单个事件报告，以便将服务器到服务器的通信量降至最低。</span><span class="sxs-lookup"><span data-stu-id="dd637-209">Query statistics are reported as a single event to minimize server-to-server communication.</span></span>  
  
14. <span data-ttu-id="dd637-210">在“使用情况数据历史记录”中，指定要保留多长时间的使用情况数据的历史记录。</span><span class="sxs-lookup"><span data-stu-id="dd637-210">In Usage Data History, specify how long to keep a historical record of usage data.</span></span> <span data-ttu-id="dd637-211">使用情况信息将出现在 PowerPivot 管理面板中。</span><span class="sxs-lookup"><span data-stu-id="dd637-211">Usage information appears in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="dd637-212">如果为使用情况数据历史指定太低的值，则报告不是那么有效。</span><span class="sxs-lookup"><span data-stu-id="dd637-212">The reports will be less effective if you specify too low a value for usage data history.</span></span>  
  
15. <span data-ttu-id="dd637-213">在“使用情况数据收集”的各查询响应阈值中，指定确定一个类别从哪里结束、另一个类别从哪里开始的上限。</span><span class="sxs-lookup"><span data-stu-id="dd637-213">In Usage Data Collection, in each query response threshold, specify an upper limit that determines where one category stops and another begins.</span></span> <span data-ttu-id="dd637-214">这些类别建立对查询行为进行度量的基准。</span><span class="sxs-lookup"><span data-stu-id="dd637-214">These categories establish a baseline against which query behavior is measured.</span></span> <span data-ttu-id="dd637-215">您可以使用这些类别监视系统的查询响应时间中的趋势。</span><span class="sxs-lookup"><span data-stu-id="dd637-215">You can use these categories to monitor trends in query response times for your system.</span></span> <span data-ttu-id="dd637-216">此信息将出现在 PowerPivot 管理面板中。</span><span class="sxs-lookup"><span data-stu-id="dd637-216">This information appears in the PowerPivot Management Dashboard.</span></span>  
  
16. <span data-ttu-id="dd637-217">\*\*\*\* 单击“确定”以保存你的更改。</span><span class="sxs-lookup"><span data-stu-id="dd637-217">Click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="dd637-218">对加载超时或分配方法的更改只应用于新的传入请求。</span><span class="sxs-lookup"><span data-stu-id="dd637-218">Changes to the load timeout or allocation method are only applied to new incoming requests.</span></span> <span data-ttu-id="dd637-219">已在进行中的请求将受到接收请求时有效的值的影响。</span><span class="sxs-lookup"><span data-stu-id="dd637-219">Requests that are already in progress are subject to the values that were in effect when the request was received.</span></span>  
  
##  <a name="assign-a-powerpivot-service-application-to-a-web-application"></a><a name="AssignGSA"></a><span data-ttu-id="dd637-220">将 PowerPivot 服务应用程序分配给 Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="dd637-220">Assign a PowerPivot Service Application to a Web Application</span></span>  
 <span data-ttu-id="dd637-221">在您配置 PowerPivot 服务应用程序后，可以通过将其添加到 Web 应用程序的服务应用程序连接列表，将其分配给该 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-221">After you configure a PowerPivot service application, you can assign it to a Web application by adding it to the service application connection list for that Web application.</span></span> <span data-ttu-id="dd637-222">有两种方法可以实现此目的：</span><span class="sxs-lookup"><span data-stu-id="dd637-222">There are two ways to do this:</span></span>  
  
-   <span data-ttu-id="dd637-223">将它添加到“默认” \*\*\*\* 连接组。</span><span class="sxs-lookup"><span data-stu-id="dd637-223">Add it to the **Default** connection group.</span></span> <span data-ttu-id="dd637-224">“默认连接组” \*\* 是可用于引用它的任何 Web 应用程序的服务应用程序连接的集合。</span><span class="sxs-lookup"><span data-stu-id="dd637-224">The *default connection group* is a collection of service application connections that are available to any Web application that references it.</span></span> <span data-ttu-id="dd637-225">您必须将 PowerPivot 服务应用程序添加到此列表。</span><span class="sxs-lookup"><span data-stu-id="dd637-225">You must add a PowerPivot service application to this list.</span></span>  
  
-   <span data-ttu-id="dd637-226">为特定 Web 应用程序创建“自定义” \*\*\*\* 连接列表。</span><span class="sxs-lookup"><span data-stu-id="dd637-226">Create a **Custom** connection list for a specific Web application.</span></span> <span data-ttu-id="dd637-227">如果您创建了多个 PowerPivot 服务应用程序，则可以通过在自定义列表中选择它来选择要使用的应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-227">If you created multiple PowerPivot service applications, you can choose which one to use by selecting it in a custom list.</span></span>  
  
 <span data-ttu-id="dd637-228">默认的连接组将接受相同类型的多个服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-228">The default connection group will accept more than one service application of the same type.</span></span> <span data-ttu-id="dd637-229">但应注意，向此列表添加多个 PowerPivot 服务应用程序不是支持的配置。</span><span class="sxs-lookup"><span data-stu-id="dd637-229">Be aware, however, that adding more than one PowerPivot service applications to this list is not a supported configuration.</span></span>  
  
1.  <span data-ttu-id="dd637-230">在“管理中心”的 **“应用程序管理”** 中，单击 **“管理 Web 应用程序”**。</span><span class="sxs-lookup"><span data-stu-id="dd637-230">In Central Administration, in **Application Management**, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="dd637-231">选择要为其分配连接的应用程序（例如 SharePoint -80）。</span><span class="sxs-lookup"><span data-stu-id="dd637-231">Select the application for which you want to assign a connection (for example, SharePoint -80).</span></span>  
  
3.  <span data-ttu-id="dd637-232">单击 **“服务连接”**。</span><span class="sxs-lookup"><span data-stu-id="dd637-232">Click **Service Connections**.</span></span>  
  
4.  <span data-ttu-id="dd637-233">在“编辑以下关联组”\*\*\*\* 中，选择“默认值”\*\*\*\* 或“[自定义]”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="dd637-233">In **Edit the following group of associations**, select **default** or **[custom]**.</span></span>  
  
5.  <span data-ttu-id="dd637-234">对于“[自定义]”\*\*\*\*，选中要使用的每个服务应用程序连接旁边的复选框。</span><span class="sxs-lookup"><span data-stu-id="dd637-234">For **[custom]**, select the checkbox next to each service application connection you want to use.</span></span> <span data-ttu-id="dd637-235">如果有多个 PowerPivot 服务应用程序 (由设置为) 的类型指示 `PowerPivot Service Application Proxy` ），请确保仅选择一个。</span><span class="sxs-lookup"><span data-stu-id="dd637-235">If you have multiple PowerPivot service applications (indicated by Type set to `PowerPivot Service Application Proxy`), be sure to choose just one.</span></span>  
  
6.  <span data-ttu-id="dd637-236">单击“确定”  。</span><span class="sxs-lookup"><span data-stu-id="dd637-236">Click **OK**.</span></span>  
  
##  <a name="edit-service-application-properties"></a><a name="EditGSA"></a><span data-ttu-id="dd637-237">编辑服务应用程序属性</span><span class="sxs-lookup"><span data-stu-id="dd637-237">Edit Service Application Properties</span></span>  
 <span data-ttu-id="dd637-238">使用下面的说明可重新打开指定服务应用程序名称、应用程序池、数据库设置和服务关联的属性页。</span><span class="sxs-lookup"><span data-stu-id="dd637-238">Use the following instructions to re-open the property page that specifies the service application name, application pool, database settings, and service associations.</span></span>  
  
1.  <span data-ttu-id="dd637-239">在“管理中心”的“应用程序管理”中，单击 **“管理服务应用程序”** 。</span><span class="sxs-lookup"><span data-stu-id="dd637-239">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="dd637-240">选择但不要单击 PowerPivot 服务应用程序。</span><span class="sxs-lookup"><span data-stu-id="dd637-240">Select, but do not click, the PowerPivot service application.</span></span> <span data-ttu-id="dd637-241">您可以单击类型名称以便选择整行。</span><span class="sxs-lookup"><span data-stu-id="dd637-241">You can click the type name to select the entire row.</span></span>  
  
3.  <span data-ttu-id="dd637-242">在功能区上单击 **“属性”** 。</span><span class="sxs-lookup"><span data-stu-id="dd637-242">Click **Properties** on the ribbon.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dd637-243">另请参阅</span><span class="sxs-lookup"><span data-stu-id="dd637-243">See Also</span></span>  
 [<span data-ttu-id="dd637-244">在管理中心中管理和配置 PowerPivot 服务器</span><span class="sxs-lookup"><span data-stu-id="dd637-244">PowerPivot Server Administration and Configuration in Central Administration</span></span>](power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
