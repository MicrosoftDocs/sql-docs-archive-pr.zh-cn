---
title: 通过 SharePoint 2013 进行 PowerPivot 数据刷新 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587030"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="fbdaf-102">使用 SharePoint 2013 进行 PowerPivot 数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="fbdaf-103">在 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] sharepoint 2013 中刷新数据模型的设计使用 Excel Services 作为主要组件来在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] SharePoint 模式下运行的实例上加载和刷新数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="fbdaf-104">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器在 SharePoint 场的外部运行。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="fbdaf-105">以前的数据刷新体系结构专门依赖于 PowerPivot 系统服务在 SharePoint 模式 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例上加载和刷新数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="fbdaf-106">[!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例在 PowerPivot 应用程序服务器上在本地运行。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="fbdaf-107">这个新的体系结构还引入了一个新方法，以便将计划信息作为文档库中工作簿项的元数据维护。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="fbdaf-108">SharePoint 2013 Excel Services 中的体系结构支持“交互式数据刷新” \*\*\*\* 和“计划数据刷新” \*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="fbdaf-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="fbdaf-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="fbdaf-110">**本主题内容：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="fbdaf-111">交互式数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="fbdaf-112">带有工作簿数据连接和交互式数据刷新的 Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="fbdaf-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="fbdaf-113">计划的数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="fbdaf-114">SharePoint 2013 中计划的数据刷新体系结构</span><span class="sxs-lookup"><span data-stu-id="fbdaf-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="fbdaf-115">其他身份验证注意事项</span><span class="sxs-lookup"><span data-stu-id="fbdaf-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="fbdaf-116">详细信息</span><span class="sxs-lookup"><span data-stu-id="fbdaf-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="fbdaf-117">背景</span><span class="sxs-lookup"><span data-stu-id="fbdaf-117">Background</span></span>  
 <span data-ttu-id="fbdaf-118">SharePoint Server 2013 Excel Services 管理 Excel 2013 工作簿的数据刷新，并触发在 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] SharePoint 模式下运行的服务器上的数据模型处理。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="fbdaf-119">对于 Excel 2010 工作簿，Excel Services 还管理工作簿和数据模型的加载和保存。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="fbdaf-120">但是，Excel Services 依赖于 PowerPivot 系统服务将处理命令发送到数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="fbdaf-121">下表根据工作簿的版本总结了为数据刷新发送处理命令的组件。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="fbdaf-122">假定的环境是 SharePoint 2013 场，它配置为使用在 SharePoint 模式下运行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="fbdaf-123">Excel 2013 工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="fbdaf-124">Excel 2010 工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="fbdaf-125">触发数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-125">Trigger Data Refresh</span></span>|<span data-ttu-id="fbdaf-126">**交互：** 经过身份验证的用户</span><span class="sxs-lookup"><span data-stu-id="fbdaf-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="fbdaf-127">**计划：** PowerPivot 系统服务</span><span class="sxs-lookup"><span data-stu-id="fbdaf-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="fbdaf-128">PowerPivot 系统服务</span><span class="sxs-lookup"><span data-stu-id="fbdaf-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="fbdaf-129">从内容数据库加载工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="fbdaf-130">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fbdaf-131">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fbdaf-132">在 Analysis Services 实例上加载数据模型</span><span class="sxs-lookup"><span data-stu-id="fbdaf-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="fbdaf-133">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fbdaf-134">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fbdaf-135">将处理命令发送到 Analysis Services 实例</span><span class="sxs-lookup"><span data-stu-id="fbdaf-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="fbdaf-136">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fbdaf-137">PowerPivot 系统服务</span><span class="sxs-lookup"><span data-stu-id="fbdaf-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="fbdaf-138">更新工作簿数据</span><span class="sxs-lookup"><span data-stu-id="fbdaf-138">Update Workbook Data</span></span>|<span data-ttu-id="fbdaf-139">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fbdaf-140">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="fbdaf-141">将工作簿和数据模型保存到内容数据库</span><span class="sxs-lookup"><span data-stu-id="fbdaf-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="fbdaf-142">**交互：** 不适用</span><span class="sxs-lookup"><span data-stu-id="fbdaf-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="fbdaf-143">**计划：** SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="fbdaf-144">SharePoint 2013 Excel Services</span><span class="sxs-lookup"><span data-stu-id="fbdaf-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="fbdaf-145">下表总结了配置为使用在 SharePoint 模式下运行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server 的 SharePoint 2013 场中支持的刷新功能：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="fbdaf-146">工作簿的创建位置</span><span class="sxs-lookup"><span data-stu-id="fbdaf-146">Workbook created in</span></span>|<span data-ttu-id="fbdaf-147">计划的数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-147">Scheduled data refresh</span></span>|<span data-ttu-id="fbdaf-148">交互式刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="fbdaf-149">2008 R2 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="fbdaf-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="fbdaf-150">不支持。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-150">Not supported.</span></span> <span data-ttu-id="fbdaf-151">\*\* (\*) \*\*升级工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="fbdaf-152">不支持。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-152">Not supported.</span></span> <span data-ttu-id="fbdaf-153">\*\* (\*) \*\*升级工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="fbdaf-154">2012 PowerPivot for Excel</span><span class="sxs-lookup"><span data-stu-id="fbdaf-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="fbdaf-155">支持</span><span class="sxs-lookup"><span data-stu-id="fbdaf-155">Supported</span></span>|<span data-ttu-id="fbdaf-156">不支持。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-156">Not supported.</span></span> <span data-ttu-id="fbdaf-157">\*\* (\*) \*\*升级工作簿</span><span class="sxs-lookup"><span data-stu-id="fbdaf-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="fbdaf-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="fbdaf-158">Excel 2013</span></span>|<span data-ttu-id="fbdaf-159">支持</span><span class="sxs-lookup"><span data-stu-id="fbdaf-159">Supported</span></span>|<span data-ttu-id="fbdaf-160">支持</span><span class="sxs-lookup"><span data-stu-id="fbdaf-160">Supported</span></span>|  
  
 <span data-ttu-id="fbdaf-161">\*\* (\*) \*\*有关工作簿升级的详细信息，请参阅[&#40;SharePoint 2013&#41;升级工作簿和计划的数据刷新](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="fbdaf-162">交互式数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="fbdaf-163">SharePoint Server 2013 Excel Services 中的交互式或手动数据刷新可以使用原始数据源中的数据来刷新数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="fbdaf-164">在您通过注册 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器来配置 Excel Services 应用程序并在 SharePoint 模式下运行后，交互式数据刷新将可用。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="fbdaf-165">有关详细信息，请参阅 [管理 Excel Services 数据模型设置 (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fbdaf-166">交互式数据刷新仅可用于在 Excel 2013 中创建的工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="fbdaf-167">如果尝试刷新 Excel 2010 工作簿，Excel Services 将显示如下错误消息： "PowerPivot 操作失败：该工作簿是在较早版本的 Excel 和 PowerPivot 中创建的，在升级该文件之前无法进行刷新"。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="fbdaf-168">有关升级工作簿的详细信息，请参阅[升级工作簿和计划的数据刷新 (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="fbdaf-169">**交互式刷新的关键相关点：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="fbdaf-170">交互式数据刷新仅刷新当前用户会话中的数据。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="fbdaf-171">这些数据并不自动保存回 SharePoint 内容数据库中的工作簿项。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="fbdaf-172">**凭据：** 交互式数据刷新可将当前登录用户的标识作为凭据或存储的凭据来连接到数据源。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="fbdaf-173">所使用的凭据取决于为与外部数据源的工作簿连接而定义的 Excel Services 身份验证设置。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="fbdaf-174">**支持的工作簿：**  在 Excel 2013 中创建的工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="fbdaf-175">**刷新数据：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="fbdaf-176">请参阅这些步骤之后的图示。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="fbdaf-177">在 SharePoint 文档库中，在浏览器中打开一个 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="fbdaf-178">在浏览器窗口中，单击 **“数据”** 菜单，然后单击 **“刷新选定的连接”** 或 **“刷新所有连接”**。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="fbdaf-179">Excel Services 将加载 PowerPivot 数据库，对该数据库进行处理，然后查询该数据库以便刷新 Excel 工作簿缓存。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="fbdaf-180">**注意：** 已更新的工作簿并不自动保存回文档库。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="fbdaf-181">![交互式数据刷新](../media/as-interactive-datarefresh-sharepoint2013.gif "交互式数据刷新")</span><span class="sxs-lookup"><span data-stu-id="fbdaf-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="fbdaf-182">带有工作簿数据连接和交互式数据刷新的 Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="fbdaf-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="fbdaf-183">Excel Services 向 Analysis Services 服务器发送一个处理命令，该命令指示该服务器模拟某一用户帐户。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="fbdaf-184">为了获取足以执行用户模拟-委托进程的系统权限，该 Analysis Services 服务帐户要求对本地服务器具有“以操作系统方式执行”\*\*\*\* 特权。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="fbdaf-185">该 Analysis Services 服务器还需要能够将用户的凭据委托给数据源。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="fbdaf-186">查询结果被发送到 Excel Services。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="fbdaf-187">典型用户体验：当某个客户在包含 PowerPivot 模型的 Excel 2013 工作簿中选择 "刷新所有连接" 时，它们会看到如下错误消息：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="fbdaf-188">**外部数据刷新失败：** 处理工作簿中的数据模型时出错。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="fbdaf-189">请重试。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-189">Please try again.</span></span> <span data-ttu-id="fbdaf-190">无法刷新此工作簿中的一个或多个数据连接。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="fbdaf-191">根据您正在使用的数据访问接口，将会在 ULS 日志中看到如下消息。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="fbdaf-192">**对于 SQL Native Client：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="fbdaf-193">无法创建外部连接或执行查询。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fbdaf-194">提供程序消息：已指定了引用 ID“20102481-39c8-4d21-bf63-68f583ad22bb”的不当对象“DataSource”，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="fbdaf-195">OLE DB 或 ODBC 错误：与 SQL Server 建立连接时发生了与网络相关的或特定于实例的错误。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="fbdaf-196">找不到或无法访问服务器。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-196">Server is not found or not accessible.</span></span> <span data-ttu-id="fbdaf-197">请检查实例名称是否正确以及 SQL Server 是否配置为允许远程连接。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="fbdaf-198">有关详细信息，请参阅 SQL Server 联机丛书。08001；SSL 提供程序：要求的安全包不存在；08001；客户端无法建立连接；08001；客户端不支持加密；08001。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="fbdaf-199">，ConnectionName：ThisWorkbookDataModel，工作簿：book1.xlsx。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="fbdaf-200">**对于 Microsoft OLE DB Provider for SQL Server：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="fbdaf-201">无法创建外部连接或执行查询。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fbdaf-202">提供程序消息：已指定了引用 ID“6e711bfa-b62f-4879-a177-c5dd61d9c242”的不当对象“DataSource”，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="fbdaf-203">OLE DB 或 ODBC 错误。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="fbdaf-204">，ConnectionName：ThisWorkbookDataModel，作业簿：OLEDB Provider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="fbdaf-205">**对于 .NET Framework Data Provider for SQL Server：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="fbdaf-206">无法创建外部连接或执行查询。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="fbdaf-207">提供程序消息：已指定了引用 ID“f5fb916c-3eac-4d07-a542-531524c0d44a”的不当对象“DataSource”，但尚未使用。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="fbdaf-208">高级关系引擎中存在错误。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="fbdaf-209">在使用托管 IDbConnection 接口时，出现以下异常：未能加载文件或程序集“System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”或它的某一个依赖项。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="fbdaf-210">未提供所需的模拟级别，或提供的模拟级别无效。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="fbdaf-211">(HRESULT 异常: 0x80070542)”。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="fbdaf-212">，ConnectionName：ThisWorkbookDataModel，工作簿：NETProvider.xlsx。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="fbdaf-213">**配置步骤摘要** ：若要对本地服务器配置 **“以操作系统方式执行”** 特权，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="fbdaf-214">在 SharePoint 模式下运行的 Analysis Services 服务器上，将 Analysis Services 服务帐户添加到 "**作为操作系统的一部分**" 权限：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="fbdaf-215">运行 " `secpol.msc` "</span><span class="sxs-lookup"><span data-stu-id="fbdaf-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="fbdaf-216">依次单击 **“本地安全策略”**、 **“本地策略”** 和 **“用户权限分配”**。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="fbdaf-217">添加该服务帐户。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="fbdaf-218">重新启动 Excel Services 并且重新引导 Analysis Services 服务器。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="fbdaf-219">无需从 Excel Services 服务帐户或声明为 Windows 令牌服务 (C2WTS) 到 Analysis Services 实例的委托。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="fbdaf-220">因此，无需针对从 Excel Services 或 C2WTS 到 PowerPivot AS 服务的 KCD 的配置。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="fbdaf-221">如果数据源与 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 实例位于同一台服务器上，则不需要 Kerberos 约束委派。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="fbdaf-222">但是， [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务帐户需要“以操作系统方式执行”权限。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="fbdaf-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="fbdaf-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="fbdaf-224">有关详细信息，请参阅["作为操作系统的一部分"](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="fbdaf-225">计划的数据刷新</span><span class="sxs-lookup"><span data-stu-id="fbdaf-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="fbdaf-226">**计划的数据刷新的关键相关点：**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="fbdaf-227">要求部署 PowerPivot for SharePoint 外接程序。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="fbdaf-228">有关详细信息，请参阅[在 SharePoint 2013&#41;中安装或卸载 PowerPivot for SharePoint 外接程序 &#40;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="fbdaf-229">用户为工作簿配置刷新计划。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="fbdaf-230">在计划的时间，PowerPivot 系统服务将一个请求发送到 Excel Services 以便：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="fbdaf-231">加载和处理 PowerPivot 数据库。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="fbdaf-232">刷新工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="fbdaf-233">将该工作簿保存回内容数据库。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="fbdaf-234">**凭据：** 使用存储的凭据。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="fbdaf-235">不要使用当前用户的标识。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="fbdaf-236">**支持的工作簿：** 使用 2010 Excel 的 PowerPivot 外接程序创建的工作簿 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 或使用 excel 2013 创建的工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="fbdaf-237">不支持在具有 [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot 外接程序的 Excel 2010 中创建的工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="fbdaf-238">请将工作簿升级到至少是 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot 格式。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="fbdaf-239">有关升级工作簿的详细信息，请参阅[升级工作簿和计划的数据刷新 (SharePoint 2013)](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="fbdaf-240">要显示 **“管理数据刷新”** 页，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="fbdaf-241">请参阅这些步骤之后的图示。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="fbdaf-242">在 SharePoint 文档库中，为 PowerPivot 工作簿单击 "**打开" 菜单** (") **"。**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="fbdaf-243">单击第二个 **“打开菜单”** ，然后单击 **“管理 PowerPivot 数据刷新”**。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="fbdaf-244">在 **“管理数据刷新”** 页上，单击 **“启用”** ，然后配置刷新计划。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="fbdaf-245">在指定的时间，PowerPivot 系统服务将一个请求发送到 Excel Services 以便：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="fbdaf-246">加载和处理 PowerPivot 数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="fbdaf-247">刷新工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="fbdaf-248">将该工作簿保存回内容数据库。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="fbdaf-249">![管理数据刷新上下文菜单](../media/as-manage-datarefresh-sharepoint2013.gif "管理数据刷新上下文菜单")</span><span class="sxs-lookup"><span data-stu-id="fbdaf-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="fbdaf-250">有关从 SharePoint online 刷新工作簿的信息，请参阅[从 Sharepoint Online 刷新 Excel 工作簿 (白皮书) ](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="fbdaf-251">SharePoint 2013 中计划的数据刷新体系结构</span><span class="sxs-lookup"><span data-stu-id="fbdaf-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="fbdaf-252">下图总结了 SharePoint 2013 和 SQL Server 2012 SP1 中的数据刷新体系结构。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="fbdaf-253">![SQL Server 2012 SP1 数据刷新的体系结构](../media/as-scheduled-data-refresh2012sp1-architecture.gif "SQL Server 2012 SP1 数据刷新的体系结构")</span><span class="sxs-lookup"><span data-stu-id="fbdaf-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="fbdaf-254">说明</span><span class="sxs-lookup"><span data-stu-id="fbdaf-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="fbdaf-255">**(1)**</span><span class="sxs-lookup"><span data-stu-id="fbdaf-255">**(1)**</span></span>|<span data-ttu-id="fbdaf-256">Analysis Services 引擎</span><span class="sxs-lookup"><span data-stu-id="fbdaf-256">Analysis Services Engine</span></span>|<span data-ttu-id="fbdaf-257">在 SharePoint 模式下运行的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器上的数据模型处理。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="fbdaf-258">该服务器在 SharePoint 场的外部运行。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="fbdaf-259">\*\* (2) \*\*</span><span class="sxs-lookup"><span data-stu-id="fbdaf-259">**(2)**</span></span>|<span data-ttu-id="fbdaf-260">用户界面</span><span class="sxs-lookup"><span data-stu-id="fbdaf-260">User Interface</span></span>|<span data-ttu-id="fbdaf-261">该用户界面由两页构成。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="fbdaf-262">一页用于定义计划，另一页用于查看刷新历史记录。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="fbdaf-263">这两页并不直接访问 PowerPivot 服务应用程序数据库，但使用 PowerPivot 系统服务访问这些数据库。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="fbdaf-264">\*\* (3) \*\*</span><span class="sxs-lookup"><span data-stu-id="fbdaf-264">**(3)**</span></span>|<span data-ttu-id="fbdaf-265">PowerPivot 系统服务</span><span class="sxs-lookup"><span data-stu-id="fbdaf-265">PowerPivot System Service</span></span>|<span data-ttu-id="fbdaf-266">在您部署 PowerPivot for SharePoint 外接程序时安装该服务。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="fbdaf-267">该服务用于以下目的：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="fbdaf-268">该服务承载刷新计划引擎，该引擎调用 Excel Services API 以便进行 Excel 2013 工作簿的数据刷新。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="fbdaf-269">对于 Excel 2010 工作簿，该服务直接执行数据模型处理，但继续依赖 Excel Services 加载数据模型和更新工作簿。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="fbdaf-270">该服务为组件（例如用户界面页）提供与系统服务进行通信的方法。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="fbdaf-271">管理对作为数据源的工作簿的外部访问的请求，这些请求是通过 PowerPivot Web 服务接收的。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="fbdaf-272">对计时器作业和配置页的计划的数据刷新请求管理。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="fbdaf-273">该服务管理从服务应用程序数据库读入和读出数据的请求，并且使用 Excel Services 触发数据刷新。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="fbdaf-274">使用情况处理和相关计时器作业。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="fbdaf-275">\*\* (4) \*\*</span><span class="sxs-lookup"><span data-stu-id="fbdaf-275">**(4)**</span></span>|<span data-ttu-id="fbdaf-276">Excel 计算服务</span><span class="sxs-lookup"><span data-stu-id="fbdaf-276">Excel Calculation Services</span></span>|<span data-ttu-id="fbdaf-277">负责加载数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="fbdaf-278">\*\* (5) \*\*</span><span class="sxs-lookup"><span data-stu-id="fbdaf-278">**(5)**</span></span>|<span data-ttu-id="fbdaf-279">Secure Store Service</span><span class="sxs-lookup"><span data-stu-id="fbdaf-279">Secure Store Service</span></span>|<span data-ttu-id="fbdaf-280">如果将工作簿中的身份验证设置配置为**使用经过身份验证的用户帐户**或 "**无**"，则在安全存储区目标应用程序 ID 中存储的凭据将用于数据刷新。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="fbdaf-281">有关详细信息，参阅本主题中的 [其他身份验证注意事项](#datarefresh_additional_authentication) 部分。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="fbdaf-282">\*\* (6) \*\*</span><span class="sxs-lookup"><span data-stu-id="fbdaf-282">**(6)**</span></span>|<span data-ttu-id="fbdaf-283">PowerPivot 数据刷新计时器作业</span><span class="sxs-lookup"><span data-stu-id="fbdaf-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="fbdaf-284">指示 PowerPivot 系统服务与 Excel Services 进行连接以便刷新数据模型。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="fbdaf-285">要求适当的数据访问接口和客户端库，以便处于 SharePoint 模式下的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 服务器可以访问数据源。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fbdaf-286">因为 PowerPivot 系统服务不再加载或保存 PowerPivot 模型，所以，用于在应用程序服务器上缓存模型的大多数设置不适用于 SharePoint 2013 场。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="fbdaf-287">数据刷新日志数据</span><span class="sxs-lookup"><span data-stu-id="fbdaf-287">Data refresh log data</span></span>  
 <span data-ttu-id="fbdaf-288">**使用情况数据：** 您可以在 PowerPivot 管理面板中查看数据刷新使用情况数据。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="fbdaf-289">要查看使用情况数据，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="fbdaf-290">在 SharePoint 管理中心中，在 **“常规应用程序设置”** 组中单击 **“PowerPivot 管理面板”** 。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="fbdaf-291">在仪表板的底部，查看 "**数据刷新-最近的活动**" 和 "**数据刷新-最近的失败**"。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="fbdaf-292">有关使用情况数据以及如何启用它的详细信息，请参阅 [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="fbdaf-293">**诊断日志数据：** 您可以查看与数据刷新相关的 SharePoint 诊断日志数据。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="fbdaf-294">首先，在 SharePoint 管理中心的 **“监视”** 页中确认针对 **“PowerPivot 服务”** 的诊断日志记录的配置。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="fbdaf-295">可能需要将 "最小严重事件" 日志记录的级别提高到 "记录"。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="fbdaf-296">例如，暂时将该值设置为 **“详细”** ，然后重新运行数据刷新操作。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="fbdaf-297">日志项包含：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="fbdaf-298">“PowerPivot 服务” \*\*\*\* 的“区域” \*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="fbdaf-299">“数据刷新” \*\*\*\* 的类别。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="fbdaf-300">查看 **“配置诊断日志记录”**。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="fbdaf-301">有关详细信息，请参阅[配置和查看 SharePoint 日志文件和诊断日志记录 &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="fbdaf-302">其他身份验证注意事项</span><span class="sxs-lookup"><span data-stu-id="fbdaf-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="fbdaf-303">在 Excel 2013 中， **“Excel Services 身份验证设置”** 对话框中的设置确定 Excel Services 和 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 用于数据刷新的 Windows 标识。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="fbdaf-304">**使用已经过身份验证的用户的帐户**： Excel Services 在当前登录的用户的标识下执行数据刷新。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="fbdaf-305">**使用存储的帐户**：假定为 SharePoint Secure Store Service 应用程序 ID，Excel Services 使用该 ID 检索用户名和密码，以便对数据刷新进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="fbdaf-306">**无**：使用 Excel Services 的 **“无人参与服务帐户”** 。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="fbdaf-307">该服务帐户与某一安全存储区代理相关联。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="fbdaf-308">在 **“Excel Services 应用程序设置”** 页上配置 **“外部数据”** 部分中的设置。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="fbdaf-309">打开身份验证设置对话框：</span><span class="sxs-lookup"><span data-stu-id="fbdaf-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="fbdaf-310">在 Excel 2013 中单击 **“数据”** 选项卡。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="fbdaf-311">在功能区中单击 **“连接”** 。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="fbdaf-312">在 **“工作簿连接”** 对话框中，选择连接，然后单击 **“属性”**。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="fbdaf-313">在 "**连接属性**" 对话框中，单击 "**定义**"，然后单击 "**身份验证设置 ...** " 按钮。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="fbdaf-314">![“Excel Services 身份验证设置”](../media/as-authentication-settings-4-ecs-in-excel2013.gif "“Excel Services 身份验证设置”")</span><span class="sxs-lookup"><span data-stu-id="fbdaf-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="fbdaf-315">有关数据刷新身份验证和凭据的用法的详细信息，请参阅博客文章 [在 SharePoint 2013 中刷新 PowerPivot 数据](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="fbdaf-316">详细信息</span><span class="sxs-lookup"><span data-stu-id="fbdaf-316">More Information</span></span>  
 <span data-ttu-id="fbdaf-317">[PowerPivot 数据刷新故障排除](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="fbdaf-318">[SharePoint 2013 中的 Excel Services](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/)。</span><span class="sxs-lookup"><span data-stu-id="fbdaf-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="fbdaf-319">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fbdaf-319">See Also</span></span>  
 <span data-ttu-id="fbdaf-320">[&#40;SharePoint 2013&#41;升级工作簿和计划的数据刷新](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="fbdaf-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="fbdaf-321">PowerPivot for SharePoint 2013 安装</span><span class="sxs-lookup"><span data-stu-id="fbdaf-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
