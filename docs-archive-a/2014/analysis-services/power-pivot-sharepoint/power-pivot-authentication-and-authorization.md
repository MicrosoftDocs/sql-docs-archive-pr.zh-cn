---
title: PowerPivot 身份验证和授权 |Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 48230cc0-4037-4f99-8360-dadf4bc169bd
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cf777960b24d9c65c7e7f7d9651eeb48e0fe42b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87687272"
---
# <a name="powerpivot-authentication-and-authorization"></a><span data-ttu-id="9db41-102">PowerPivot 身份验证和授权</span><span class="sxs-lookup"><span data-stu-id="9db41-102">PowerPivot Authentication and Authorization</span></span>
  <span data-ttu-id="9db41-103">在 SharePoint 2010 场中运行的 PowerPivot for SharePoint 部署使用 SharePoint 服务器提供的身份验证子系统和授权模型。</span><span class="sxs-lookup"><span data-stu-id="9db41-103">A PowerPivot for SharePoint deployment that runs within a SharePoint 2010 farm uses the authentication subsystem and authorization model provided by SharePoint servers.</span></span> <span data-ttu-id="9db41-104">SharePoint 安全基础结构扩展至 PowerPivot 内容和操作，因为所有与 PowerPivot 相关的内容都存储在 SharePoint 内容数据库中，并且通过场中的 PowerPivot 共享服务执行所有与 PowerPivot 相关的操作。</span><span class="sxs-lookup"><span data-stu-id="9db41-104">SharePoint security infrastructure extends to PowerPivot content and operations because all PowerPivot-related content is stored in SharePoint content databases and all PowerPivot-related operations are performed by PowerPivot shared services in the farm.</span></span> <span data-ttu-id="9db41-105">使用基于对应 Windows 用户标识的 SharePoint 用户标识对请求包含 PowerPivot 数据的工作簿的用户进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="9db41-105">Users who request a workbook that contains PowerPivot data are authenticated using a SharePoint user identity that is based on their Windows user identity.</span></span> <span data-ttu-id="9db41-106">工作簿上的查看权限决定了是同意还是拒绝请求。</span><span class="sxs-lookup"><span data-stu-id="9db41-106">View permissions on the workbook determine whether the request is granted or denied.</span></span>  
  
 <span data-ttu-id="9db41-107">因为自助服务数据分析需要与 Excel Services 进行集成，所以，为了确保 PowerPivot 服务器的安全，您还需要了解 Excel Services 安全性。</span><span class="sxs-lookup"><span data-stu-id="9db41-107">Because integration with Excel Services is required for self-service data analytics, securing a PowerPivot server requires that you also understand Excel Services security.</span></span> <span data-ttu-id="9db41-108">当用户查询与 PowerPivot 数据具有数据连接的数据透视表时，Excel Services 将数据连接请求转发给场中的 PowerPivot 服务器以加载数据。</span><span class="sxs-lookup"><span data-stu-id="9db41-108">When a user queries a PivotTable that has a data connection to PowerPivot data, Excel Services forwards a data connection request to a PowerPivot server in the farm to load the data.</span></span> <span data-ttu-id="9db41-109">服务器之间的这种交互要求您了解如何配置两个服务器的安全设置。</span><span class="sxs-lookup"><span data-stu-id="9db41-109">This interaction between the servers requires that you understand how to configure security settings for both servers.</span></span>  
  
 <span data-ttu-id="9db41-110">单击下面的链接可阅读本主题中的特定部分：</span><span class="sxs-lookup"><span data-stu-id="9db41-110">Click the following links to read specific sections in this topic:</span></span>  
  
 [<span data-ttu-id="9db41-111">Windows 身份验证（使用经典模式登录）要求</span><span class="sxs-lookup"><span data-stu-id="9db41-111">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>](power-pivot-authentication-and-authorization.md#bkmk_auth)  
  
 [<span data-ttu-id="9db41-112">要求用户授权的 PowerPivot 操作</span><span class="sxs-lookup"><span data-stu-id="9db41-112">PowerPivot Operations Requiring User Authorization</span></span>](#UserConnections)  
  
 [<span data-ttu-id="9db41-113">用于 PowerPivot 数据访问的 SharePoint 权限</span><span class="sxs-lookup"><span data-stu-id="9db41-113">SharePoint Permissions for PowerPivot Data Access</span></span>](#Permissions)  
  
 [<span data-ttu-id="9db41-114">PowerPivot 工作簿的 Excel Services 安全注意事项</span><span class="sxs-lookup"><span data-stu-id="9db41-114">Excel Services security considerations for PowerPivot workbooks</span></span>](#excel)  
  
##  <a name="windows-authentication-using-classic-mode-sign-in-requirement"></a><a name="bkmk_auth"></a><span data-ttu-id="9db41-115">使用经典模式登录要求的 Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="9db41-115">Windows Authentication Using Classic Mode Sign-in Requirement</span></span>  
 <span data-ttu-id="9db41-116">PowerPivot for SharePoint 支持 SharePoint 中可用的一组简化的身份验证选项。</span><span class="sxs-lookup"><span data-stu-id="9db41-116">PowerPivot for SharePoint supports a reduced set of the authentication options that are available in SharePoint.</span></span> <span data-ttu-id="9db41-117">在这些可用的身份验证选项中，PowerPivot for SharePoint 部署只支持 Windows 身份验证。</span><span class="sxs-lookup"><span data-stu-id="9db41-117">Of the available authentication options, only Windows authentication is supported for a PowerPivot for SharePoint deployment.</span></span> <span data-ttu-id="9db41-118">此外，通过登录访问的 Web 应用程序必须配置为经典模式。</span><span class="sxs-lookup"><span data-stu-id="9db41-118">In addition, the web application through which sign-in occurs must be configured for classic mode.</span></span>  
  
 <span data-ttu-id="9db41-119">Windows 身份验证是必需的，因为 PowerPivot for SharePoint 部署中的 Analysis Services 数据引擎只支持 Windows 身份验证。</span><span class="sxs-lookup"><span data-stu-id="9db41-119">Windows authentication is required because the Analysis Services data engine in a PowerPivot for SharePoint deployment supports only Windows authentication.</span></span> <span data-ttu-id="9db41-120">Excel Services 使用 Windows 用户标识通过 MSOLAP OLE DB 访问接口建立到 Analysis Services 的连接，该标识已通过 NTLM 或 Kerberos 协议进行了身份验证。</span><span class="sxs-lookup"><span data-stu-id="9db41-120">Excel Services establishes connections to Analysis Services via the MSOLAP OLE DB provider using a Windows user identity that was authenticated via NTLM or the Kerberos protocol.</span></span>  
  
 <span data-ttu-id="9db41-121">第二个要求（针对 Web 应用程序的经典模式身份验证）用于确保 PowerPivot Web 服务的可操作性。</span><span class="sxs-lookup"><span data-stu-id="9db41-121">The second requirement, classic mode authentication on the web application, is required to ensure the operability of the PowerPivot web service.</span></span> <span data-ttu-id="9db41-122">Web 服务是在 Web 前端上运行并提供到场中 PowerPivot for SharePoint 服务器的 HTTP 重定向的组件。</span><span class="sxs-lookup"><span data-stu-id="9db41-122">The web service is a component that runs on a Web front-end and provides HTTP redirection to a PowerPivot for SharePoint server in the farm.</span></span> <span data-ttu-id="9db41-123">尽管 Web 服务声明可以识别服务到服务的通信，但是它不声明可以识别路由到场中 PowerPivot 共享服务的数据连接请求。</span><span class="sxs-lookup"><span data-stu-id="9db41-123">While the web service is claims aware for service-to-service communications, it is not claims aware for the data connection requests that it routes to a PowerPivot shared service in the farm.</span></span> <span data-ttu-id="9db41-124">仅对使用 Windows 标识来自 IIS 的经过身份验证的连接支持加载 PowerPivot 数据的请求。</span><span class="sxs-lookup"><span data-stu-id="9db41-124">Requests to load PowerPivot data are only supported for authenticated connections that come from IIS using a Windows identity.</span></span> <span data-ttu-id="9db41-125">Web 应用程序的经典模式登录确保成功从 PowerPivot Web 服务连接到场中的 PowerPivot 共享服务。</span><span class="sxs-lookup"><span data-stu-id="9db41-125">Classic mode sign-in on the web application is what enables a successful connection from the PowerPivot web service to PowerPivot shared services in the farm.</span></span>  
  
 <span data-ttu-id="9db41-126">尽管经典模式登录不是较常见的数据访问方案（其中，PowerPivot 数据提取自呈现它的同一 Excel 工作簿）所必需的，但不要尝试将 PowerPivot for SharePoint 与配置为使用其他身份验证访问接口的 SharePoint Web 应用程序一起使用。</span><span class="sxs-lookup"><span data-stu-id="9db41-126">Although classic mode sign-in is not required for the more common data access scenario (where PowerPivot data is extracted from the same Excel workbook that renders it) do not attempt to use PowerPivot for SharePoint with SharePoint web applications that are configured to use other authentication providers.</span></span> <span data-ttu-id="9db41-127">只要用户尝试连接到作为外部数据源的 PowerPivot 工作簿，上述操作就会导致连接失败。</span><span class="sxs-lookup"><span data-stu-id="9db41-127">Doing so will result in a connection failure whenever users try to connect to PowerPivot workbooks as an external data source.</span></span>  
  
 <span data-ttu-id="9db41-128">如果未使用经典模式登录，则 PowerPivot Web 服务处理的以下类型的请求将失败：</span><span class="sxs-lookup"><span data-stu-id="9db41-128">Without classic mode sign-in, the following types of requests that are handled by PowerPivot Web service will fail:</span></span>  
  
-   <span data-ttu-id="9db41-129">对来自场外的 PowerPivot 数据的任何请求（例如，在报表设计器或报表生成器中创建一个报表，其中数据源为指向 PowerPivot 工作簿的 SharePoint URL）</span><span class="sxs-lookup"><span data-stu-id="9db41-129">Any request for PowerPivot data that originates from outside the farm (for example, creating a report in Report Designer or Report Builder, where the data source is a SharePoint URL to a PowerPivot workbook)</span></span>  
  
-   <span data-ttu-id="9db41-130">来自客户端应用程序或报表的场内请求，该应用程序或报表使用 PowerPivot 工作簿作为外部数据源（例如，在 Excel 桌面应用程序中创建一个工作簿，将您的数据源作为包含 PowerPivot 数据的第二个发布的 Excel 工作簿）</span><span class="sxs-lookup"><span data-stu-id="9db41-130">In-farm requests from a client application or report that uses the PowerPivot workbook as an external data source (for example, creating a workbook in the Excel desktop application, using as your data source a second published Excel workbook containing PowerPivot data)</span></span>  
  
### <a name="how-to-check-the-authentication-provider-for-your-application"></a><span data-ttu-id="9db41-131">如何检查应用程序的身份验证访问接口</span><span class="sxs-lookup"><span data-stu-id="9db41-131">How to check the authentication provider for your application</span></span>  
 <span data-ttu-id="9db41-132">在创建新的 Web 应用程序时，请确保在“新建 Web 应用程序”页中选择 **“经典模式的身份验证”** 选项。</span><span class="sxs-lookup"><span data-stu-id="9db41-132">When creating new web applications, be sure to select the **Classic mode authentication** option in the Create New Web Application page.</span></span>  
  
 <span data-ttu-id="9db41-133">对于现有的 Web 应用程序，使用以下说明来验证 Web 应用程序配置为使用 Windows 身份验证。</span><span class="sxs-lookup"><span data-stu-id="9db41-133">For existing web applications, use the following instructions to verify the web application is configured to use Windows authentication.</span></span>  
  
1.  <span data-ttu-id="9db41-134">在管理中心的 "应用程序管理" 中，单击 "**管理 web 应用程序**"。</span><span class="sxs-lookup"><span data-stu-id="9db41-134">In Central Administration, in Application Management, click **Manage web applications**.</span></span>  
  
2.  <span data-ttu-id="9db41-135">选择 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="9db41-135">Select the web application.</span></span>  
  
3.  <span data-ttu-id="9db41-136">单击 **“身份验证访问接口”**。</span><span class="sxs-lookup"><span data-stu-id="9db41-136">Click **Authentication Providers**.</span></span>  
  
4.  <span data-ttu-id="9db41-137">验证您对于每个区域具有一个访问接口，默认区域设置为 Windows。</span><span class="sxs-lookup"><span data-stu-id="9db41-137">Verify that you have one provider for each zone, and the Default zone is set to Windows.</span></span>  
  
##  <a name="powerpivot-operations-requiring-user-authorization"></a><a name="UserConnections"></a><span data-ttu-id="9db41-138">需要用户授权的 PowerPivot 操作</span><span class="sxs-lookup"><span data-stu-id="9db41-138">PowerPivot Operations Requiring User Authorization</span></span>  
 <span data-ttu-id="9db41-139">对 PowerPivot 查询和数据处理的所有级别的访问都仅使用 SharePoint 授权。</span><span class="sxs-lookup"><span data-stu-id="9db41-139">SharePoint authorization is used exclusively for all levels of access to PowerPivot query and data processing.</span></span>  
  
 <span data-ttu-id="9db41-140">不支持基于 Analysis Services 角色的授权模型。</span><span class="sxs-lookup"><span data-stu-id="9db41-140">The Analysis Services role-based authorization model is not supported.</span></span> <span data-ttu-id="9db41-141">在单元、行或表级别对于 PowerPivot 数据没有基于角色的授权。</span><span class="sxs-lookup"><span data-stu-id="9db41-141">There is no role-based authorization for PowerPivot data at the cell, row, or table level.</span></span> <span data-ttu-id="9db41-142">您不能保护工作簿的不同部分，以授予或拒绝特定用户对其中敏感数据的访问权限。</span><span class="sxs-lookup"><span data-stu-id="9db41-142">You cannot secure different parts of the workbook to grant or deny access to sensitive data within it for specific users.</span></span> <span data-ttu-id="9db41-143">嵌入的 PowerPivot 数据全部可供对 SharePoint 库中的 Excel 工作簿具有查看权限的用户使用。</span><span class="sxs-lookup"><span data-stu-id="9db41-143">Embedded PowerPivot data is wholly available to users who have View permissions on the Excel workbook in a SharePoint library.</span></span>  
  
 <span data-ttu-id="9db41-144">PowerPivot for SharePoint 在以下情况下将模拟 SharePoint 用户：</span><span class="sxs-lookup"><span data-stu-id="9db41-144">PowerPivot for SharePoint will impersonate a SharePoint user in the following cases:</span></span>  
  
-   <span data-ttu-id="9db41-145">针对与 PowerPivot 数据库具有数据连接的数据透视表或数据透视图执行的查询，其中，某个 PowerPivot 服务应用程序代表用户与处理数据的特定 PowerPivot 共享服务实例之间建立连接。</span><span class="sxs-lookup"><span data-stu-id="9db41-145">Queries to PivotTables or PivotCharts that have data connections to a PowerPivot database, where a PowerPivot service application establishes connections on behalf of a user to a specific PowerPivot shared service instance that processes the data.</span></span>  
  
-   <span data-ttu-id="9db41-146">在数据无法以其他方式可用的情况下从缓存或库加载 PowerPivot 数据。</span><span class="sxs-lookup"><span data-stu-id="9db41-146">Loading PowerPivot data from cache or a library if the data is not otherwise available.</span></span> <span data-ttu-id="9db41-147">如果对尚未加载到系统中的 PowerPivot 数据发出数据连接请求，[!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)]实例将使用 SharePoint 用户的标识来从内容库中检索数据源并将其加载到内存中。</span><span class="sxs-lookup"><span data-stu-id="9db41-147">If a data connection request is made for PowerPivot data that is not already loaded in the system, the [!INCLUDE[ssGeminiSrv](../../includes/ssgeminisrv-md.md)] instance will use the identity of the SharePoint user to retrieve the data source from a content library and load it into memory.</span></span>  
  
-   <span data-ttu-id="9db41-148">数据刷新操作，用于将数据源的已更新副本保存到内容库中的工作簿。</span><span class="sxs-lookup"><span data-stu-id="9db41-148">Data refresh operations that save an updated copy of the data source to the workbook in a content library.</span></span> <span data-ttu-id="9db41-149">在此情况下，将使用从安全存储区服务中的目标应用程序检索的用户名和密码执行实际登录操作。</span><span class="sxs-lookup"><span data-stu-id="9db41-149">In this case, an actual log on operation is performed using the user name and password that is retrieved from a target application in Secure Store Service.</span></span> <span data-ttu-id="9db41-150">凭据可以是 PowerPivot 无人参与的数据刷新帐户，也可以是在创建数据刷新计划时随其存储的凭据。</span><span class="sxs-lookup"><span data-stu-id="9db41-150">Credentials can be the PowerPivot unattended data refresh account, or credentials that were stored with the data refresh schedule when it was created.</span></span> <span data-ttu-id="9db41-151">有关详细信息，请参阅为[Powerpivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)并[配置 Powerpivot 无人参与的数据刷新帐户 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="9db41-151">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
##  <a name="sharepoint-permissions-for-powerpivot-data-access"></a><a name="Permissions"></a><span data-ttu-id="9db41-152">用于 PowerPivot 数据访问的 SharePoint 权限</span><span class="sxs-lookup"><span data-stu-id="9db41-152">SharePoint Permissions for PowerPivot Data Access</span></span>  
 <span data-ttu-id="9db41-153">只有通过 SharePoint 集成，才能支持发布、管理和保护 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="9db41-153">Publishing, managing, and securing a PowerPivot workbook is supported solely through SharePoint integration.</span></span> <span data-ttu-id="9db41-154">SharePoint 服务器提供身份验证和授权子系统，以确保合法访问数据。</span><span class="sxs-lookup"><span data-stu-id="9db41-154">SharePoint servers provide authentication and authorization subsystems that ensure legitimate access to data.</span></span> <span data-ttu-id="9db41-155">没有支持的方案可用于安全地在 SharePoint 场之外部署 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="9db41-155">There are no supported scenarios for securely deploying a PowerPivot workbook outside of a SharePoint farm.</span></span>  
  
 <span data-ttu-id="9db41-156">用户通过“查看”权限或更高权限对 PowerPivot 数据的访问在服务器上是只读的。</span><span class="sxs-lookup"><span data-stu-id="9db41-156">User access to PowerPivot data is read-only on the server through View permissions or higher.</span></span> <span data-ttu-id="9db41-157">“参与讨论”权限允许添加和编辑文件。</span><span class="sxs-lookup"><span data-stu-id="9db41-157">Contribute permissions allow for adding and editing the file.</span></span> <span data-ttu-id="9db41-158">更改 PowerPivot 数据要求您将工作簿下载到安装了 PowerPivot for Excel 的 Excel 桌面应用程序。</span><span class="sxs-lookup"><span data-stu-id="9db41-158">Changes to PowerPivot data require that you download the workbook to an Excel desktop application that has PowerPivot for Excel installed.</span></span> <span data-ttu-id="9db41-159">对文件的“参与讨论”权限将确定用户是否可在本地下载文件然后将更改保存回 SharePoint。</span><span class="sxs-lookup"><span data-stu-id="9db41-159">Contribute permissions on the file will determine whether the user can download the file locally and then save changes back to SharePoint.</span></span>  
  
 <span data-ttu-id="9db41-160">在这种情况下，“参与讨论”和“仅查看”权限级别确定用户对于 PowerPivot 数据的有效访问权限集。</span><span class="sxs-lookup"><span data-stu-id="9db41-160">As such, Contribute and View Only levels of permission define the effective set of permissions for user access to PowerPivot data.</span></span> <span data-ttu-id="9db41-161">其他权限级别的最大限度与“参与讨论”和“仅查看”的权限相同（例如，因为“读取”包含“仅查看”权限，所以，已分配了“读取”权限的用户将与“仅查看”具有相同的访问权限级别）。</span><span class="sxs-lookup"><span data-stu-id="9db41-161">Other permission levels work to the extent that they have the same permissions as Contribute and View Only (For example, because Read includes View Only permissions, a user who is assigned to Read will have same level of access as View Only).</span></span>  
  
 <span data-ttu-id="9db41-162">下表汇总了确定对 PowerPivot 数据和服务器操作的访问权限的权限级别：</span><span class="sxs-lookup"><span data-stu-id="9db41-162">The following table summarizes the permission levels that determine access to PowerPivot data and server operations:</span></span>  
  
|<span data-ttu-id="9db41-163">权限级别</span><span class="sxs-lookup"><span data-stu-id="9db41-163">Permission level</span></span>|<span data-ttu-id="9db41-164">允许这些任务</span><span class="sxs-lookup"><span data-stu-id="9db41-164">Allows these tasks</span></span>|  
|----------------------|------------------------|  
|<span data-ttu-id="9db41-165">场或服务管理员</span><span class="sxs-lookup"><span data-stu-id="9db41-165">Farm or service administrator</span></span>|<span data-ttu-id="9db41-166">安装、启用和配置服务和应用程序。</span><span class="sxs-lookup"><span data-stu-id="9db41-166">Install, enable, and configure services and applications.</span></span><br /><br /> <span data-ttu-id="9db41-167">使用 PowerPivot 管理面板和查看管理报表。</span><span class="sxs-lookup"><span data-stu-id="9db41-167">Use PowerPivot Management Dashboard and view administrative reports.</span></span>|  
|<span data-ttu-id="9db41-168">完全控制</span><span class="sxs-lookup"><span data-stu-id="9db41-168">Full control</span></span>|<span data-ttu-id="9db41-169">在网站集级别激活 PowerPivot 功能集成。</span><span class="sxs-lookup"><span data-stu-id="9db41-169">Activate PowerPivot feature integration at the site collection level.</span></span><br /><br /> <span data-ttu-id="9db41-170">创建 PowerPivot 库。</span><span class="sxs-lookup"><span data-stu-id="9db41-170">Create a PowerPivot Gallery library.</span></span><br /><br /> <span data-ttu-id="9db41-171">创建数据馈送库。</span><span class="sxs-lookup"><span data-stu-id="9db41-171">Create a data feed library.</span></span>|  
|<span data-ttu-id="9db41-172">参与</span><span class="sxs-lookup"><span data-stu-id="9db41-172">Contribute</span></span>|<span data-ttu-id="9db41-173">添加、编辑、删除和下载 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="9db41-173">Add, edit, delete, and download PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="9db41-174">配置数据刷新。</span><span class="sxs-lookup"><span data-stu-id="9db41-174">Configure data refresh.</span></span><br /><br /> <span data-ttu-id="9db41-175">基于 SharePoint 站点上的 PowerPivot 工作簿创建新的工作簿或报表。</span><span class="sxs-lookup"><span data-stu-id="9db41-175">Create new workbooks and reports based on PowerPivot workbooks on a SharePoint site.</span></span><br /><br /> <span data-ttu-id="9db41-176">在数据馈送库中创建数据服务文档</span><span class="sxs-lookup"><span data-stu-id="9db41-176">Create data service documents in a data feed library</span></span>|  
|<span data-ttu-id="9db41-177">读取</span><span class="sxs-lookup"><span data-stu-id="9db41-177">Read</span></span>|<span data-ttu-id="9db41-178">将 PowerPivot 工作簿作为外部数据源访问，其中，工作簿 URL 在连接对话框中显式输入 (例如，在 Excel 的数据连接向导) 中。</span><span class="sxs-lookup"><span data-stu-id="9db41-178">Access PowerPivot workbooks as an external data source, where the workbook URL is explicitly entered in a connection dialog box (for example, in Excel's Data Connection Wizard).</span></span>|  
|<span data-ttu-id="9db41-179">仅查看</span><span class="sxs-lookup"><span data-stu-id="9db41-179">View Only</span></span>|<span data-ttu-id="9db41-180">查看 PowerPivot 工作簿。</span><span class="sxs-lookup"><span data-stu-id="9db41-180">View PowerPivot workbooks.</span></span><br /><br /> <span data-ttu-id="9db41-181">查看数据刷新历史记录。</span><span class="sxs-lookup"><span data-stu-id="9db41-181">View data refresh history.</span></span><br /><br /> <span data-ttu-id="9db41-182">将本地工作簿连接到 SharePoint 站点上的 PowerPivot 工作簿，以其他方法重新设定其数据的作用。</span><span class="sxs-lookup"><span data-stu-id="9db41-182">Connect a local workbook to a PowerPivot workbook on a SharePoint site, to repurpose its data in other ways.</span></span><br /><br /> <span data-ttu-id="9db41-183">下载该工作簿的一个快照。</span><span class="sxs-lookup"><span data-stu-id="9db41-183">Download a snapshot of the workbook.</span></span> <span data-ttu-id="9db41-184">该快照是数据的静态副本，没有切片器、筛选器、公式或数据连接。</span><span class="sxs-lookup"><span data-stu-id="9db41-184">The snapshot is a static copy of the data, without slicers, filters, formulas, or data connections.</span></span> <span data-ttu-id="9db41-185">该快照的内容类似于从浏览器窗口复制单元值。</span><span class="sxs-lookup"><span data-stu-id="9db41-185">The contents of the snapshot are similar to copying cell values from the browser window.</span></span>|  
  
##  <a name="excel-services-security-considerations-for-powerpivot-workbooks"></a><a name="excel"></a><span data-ttu-id="9db41-186">PowerPivot 工作簿的 Excel Services 安全注意事项</span><span class="sxs-lookup"><span data-stu-id="9db41-186">Excel Services security considerations for PowerPivot workbooks</span></span>  
 <span data-ttu-id="9db41-187">PowerPivot 服务器端查询处理与 Excel Services 紧密耦合。</span><span class="sxs-lookup"><span data-stu-id="9db41-187">PowerPivot server-side query processing is tightly coupled with Excel services.</span></span> <span data-ttu-id="9db41-188">在文档级别开始产品集成，因为 PowerPivot 工作簿是包含或引用 PowerPivot 数据的 Excel 工作簿 (.xlsx) 文件。</span><span class="sxs-lookup"><span data-stu-id="9db41-188">Product integration begins at the document level, in that PowerPivot workbooks are Excel workbook (.xlsx) files that either contain or reference PowerPivot data.</span></span> <span data-ttu-id="9db41-189">PowerPivot 工作簿没有单独的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="9db41-189">There is no separate file extension for a PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="9db41-190">当在 SharePoint 站点中打开 PowerPivot 工作簿时，Excel Services 读取嵌入的 PowerPivot 数据连接字符串，并将请求转发到本地 SQL Server Analysis Services OLE DB 访问接口。</span><span class="sxs-lookup"><span data-stu-id="9db41-190">When a PowerPivot workbook is opened on a SharePoint site, Excel Services reads the embedded PowerPivot data connection string and forwards the request to the local SQL Server Analysis Services OLE DB provider.</span></span> <span data-ttu-id="9db41-191">然后，此访问接口将连接信息传递给场中的 PowerPivot 服务器。</span><span class="sxs-lookup"><span data-stu-id="9db41-191">The provider then passes the connection information to a PowerPivot server in the farm.</span></span> <span data-ttu-id="9db41-192">为了使请求在两个服务器之间无缝传递，必须将 Excel Services 配置为使用 PowerPivot for SharePoint 要求的设置。</span><span class="sxs-lookup"><span data-stu-id="9db41-192">In order for requests to flow seamlessly between the two servers, Excel Services must be configured to use settings that are required by PowerPivot for SharePoint.</span></span>  
  
 <span data-ttu-id="9db41-193">在 Excel Services 中，与安全性相关的配置设置在受信任位置、受信任的数据访问接口和受信任的数据连接库中指定。</span><span class="sxs-lookup"><span data-stu-id="9db41-193">In Excel Services, security-related configuration settings are specified on trusted locations, trusted data providers, and trusted data connection libraries.</span></span> <span data-ttu-id="9db41-194">下表介绍可实现或增强 PowerPivot 数据访问的设置。</span><span class="sxs-lookup"><span data-stu-id="9db41-194">The following table describes the settings that enable or enhance PowerPivot data access.</span></span> <span data-ttu-id="9db41-195">如果某个设置未在此处列出，则它对于 PowerPivot 服务器连接没有影响。</span><span class="sxs-lookup"><span data-stu-id="9db41-195">If a setting is not listed here, it has no effect on PowerPivot server connections.</span></span> <span data-ttu-id="9db41-196">有关如何逐步指定这些设置的说明，请参阅[PowerPivot for SharePoint&#41;的初始配置 &#40;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md)中的 "启用 Excel Services" 一节。</span><span class="sxs-lookup"><span data-stu-id="9db41-196">For instructions on how to specify these settings step by step, see the section "Enable Excel Services" in [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9db41-197">与安全性相关的大多数设置适用于受信任位置。</span><span class="sxs-lookup"><span data-stu-id="9db41-197">Most security-related settings apply to trusted locations.</span></span> <span data-ttu-id="9db41-198">如果您希望保留默认值或为不同站点使用不同值，则可以为包含 PowerPivot 数据的站点创建其他受信任位置，然后仅为该站点配置以下设置。</span><span class="sxs-lookup"><span data-stu-id="9db41-198">If you want to preserve default values or use different values for different sites, you can create an additional trusted location for sites that contain PowerPivot data, and then configure the following settings for just that site.</span></span> <span data-ttu-id="9db41-199">有关详细信息，请参阅 [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md)。</span><span class="sxs-lookup"><span data-stu-id="9db41-199">For more information, see [Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md).</span></span>  
  
|<span data-ttu-id="9db41-200">区域</span><span class="sxs-lookup"><span data-stu-id="9db41-200">Area</span></span>|<span data-ttu-id="9db41-201">设置</span><span class="sxs-lookup"><span data-stu-id="9db41-201">Setting</span></span>|<span data-ttu-id="9db41-202">说明</span><span class="sxs-lookup"><span data-stu-id="9db41-202">Description</span></span>|  
|----------|-------------|-----------------|  
|<span data-ttu-id="9db41-203">Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="9db41-203">Web application</span></span>|<span data-ttu-id="9db41-204">Windows 身份验证访问接口</span><span class="sxs-lookup"><span data-stu-id="9db41-204">Windows authentication provider</span></span>|<span data-ttu-id="9db41-205">PowerPivot 将它从 Excel Services 获得的声明标记转换为 Windows 用户标识。</span><span class="sxs-lookup"><span data-stu-id="9db41-205">PowerPivot converts a claims token that it gets from Excel Services to a Windows user identity.</span></span> <span data-ttu-id="9db41-206">任何使用 Excel Services 作为资源的 Web 应用程序都必须配置为使用 Windows 身份验证提供程序。</span><span class="sxs-lookup"><span data-stu-id="9db41-206">Any web application that uses Excel Services as a resource must be configured to use the Windows authentication provider.</span></span>|  
|<span data-ttu-id="9db41-207">受信任位置</span><span class="sxs-lookup"><span data-stu-id="9db41-207">Trusted location</span></span>|<span data-ttu-id="9db41-208">位置类型</span><span class="sxs-lookup"><span data-stu-id="9db41-208">Location Type</span></span>|<span data-ttu-id="9db41-209">此值必须设置为 **Microsoft SharePoint Foundation**。</span><span class="sxs-lookup"><span data-stu-id="9db41-209">This value must be set to **Microsoft SharePoint Foundation**.</span></span> <span data-ttu-id="9db41-210">PowerPivot 服务器检索 .xlsx 文件的副本，并将其加载到场中的 Analysis Services 服务器上。</span><span class="sxs-lookup"><span data-stu-id="9db41-210">PowerPivot servers retrieve a copy of the .xlsx file and load it on an Analysis Services server in the farm.</span></span> <span data-ttu-id="9db41-211">此服务器只能从内容库中检索 .xlsx 文件。</span><span class="sxs-lookup"><span data-stu-id="9db41-211">The server can only retrieve .xlsx files from a content library.</span></span>|  
||<span data-ttu-id="9db41-212">允许外部数据</span><span class="sxs-lookup"><span data-stu-id="9db41-212">Allow External Data</span></span>|<span data-ttu-id="9db41-213">此值必须设置为 **“受信任的数据连接库和嵌入连接”**。</span><span class="sxs-lookup"><span data-stu-id="9db41-213">This value must be set to **Trusted data connection libraries and embedded**.</span></span> <span data-ttu-id="9db41-214">PowerPivot 数据连接嵌入在工作簿中。</span><span class="sxs-lookup"><span data-stu-id="9db41-214">PowerPivot data connections are embedded in the workbook.</span></span> <span data-ttu-id="9db41-215">如果您不允许嵌入的连接，则用户可以查看数据透视表缓存，但将不能与 PowerPivot 数据交互。</span><span class="sxs-lookup"><span data-stu-id="9db41-215">If you disallow embedded connections, users can view the PivotTable cache, but they will not be able to interact with the PowerPivot data.</span></span>|  
||<span data-ttu-id="9db41-216">刷新时警告</span><span class="sxs-lookup"><span data-stu-id="9db41-216">Warn on Refresh</span></span>|<span data-ttu-id="9db41-217">如果您正在使用 PowerPivot 库来存储工作簿和报表，则应禁用此值。</span><span class="sxs-lookup"><span data-stu-id="9db41-217">This value should be disabled if you are using PowerPivot Gallery to store workbooks and reports.</span></span> <span data-ttu-id="9db41-218">PowerPivot 库包含一个文档预览功能，如果同时关闭“打开时刷新”和“刷新时警告”，则其效果最佳。</span><span class="sxs-lookup"><span data-stu-id="9db41-218">PowerPivot Gallery includes a document preview feature that works best if both refresh on open and Warn on Refresh are turned off.</span></span>|  
|<span data-ttu-id="9db41-219">受信任的数据访问接口</span><span class="sxs-lookup"><span data-stu-id="9db41-219">Trusted data providers</span></span>|<span data-ttu-id="9db41-220">MSOLAP.4</span><span class="sxs-lookup"><span data-stu-id="9db41-220">MSOLAP.4</span></span><br /><br /> <span data-ttu-id="9db41-221">MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="9db41-221">MSOLAP.5</span></span>|<span data-ttu-id="9db41-222">默认情况下包含 MSOLAP.4，但是 PowerPivot 数据访问要求 MSOLAP.4 访问接口为 SQL Server 2008 R2 版本。</span><span class="sxs-lookup"><span data-stu-id="9db41-222">MSOLAP.4 is included by default, but PowerPivot data access requires that the MSOLAP.4 provider be the SQL Server 2008 R2 version.</span></span><br /><br /> <span data-ttu-id="9db41-223">MSOLAP.5 随 PowerPivot for SharePoint 的 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版本一起安装。</span><span class="sxs-lookup"><span data-stu-id="9db41-223">MSOLAP.5 is installed with the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] version of PowerPivot for SharePoint.</span></span><br /><br /> <span data-ttu-id="9db41-224">请勿从受信任的数据访问接口列表中删除这些访问接口。</span><span class="sxs-lookup"><span data-stu-id="9db41-224">Do not remove these providers from the trusted data provider list.</span></span> <span data-ttu-id="9db41-225">在某些情况下，您可能需要在场中的其他 SharePoint 服务器上安装此访问接口的更多副本。</span><span class="sxs-lookup"><span data-stu-id="9db41-225">In some cases, you might need to install additional copies of this provider on other SharePoint servers in your farm.</span></span> <span data-ttu-id="9db41-226">有关详细信息，请参阅 [在 SharePoint 服务器上安装 Analysis Services OLE DB 提供程序](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)。</span><span class="sxs-lookup"><span data-stu-id="9db41-226">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>|  
|<span data-ttu-id="9db41-227">受信任的数据连接库</span><span class="sxs-lookup"><span data-stu-id="9db41-227">Trusted data connection libraries</span></span>|<span data-ttu-id="9db41-228">可选。</span><span class="sxs-lookup"><span data-stu-id="9db41-228">Optional.</span></span>|<span data-ttu-id="9db41-229">可以在 PowerPivot 工作簿中使用 Office 数据连接 (.odc) 文件。</span><span class="sxs-lookup"><span data-stu-id="9db41-229">You can use Office Data Connection (.odc) files in PowerPivot workbooks.</span></span> <span data-ttu-id="9db41-230">如果您使用 .odc 文件向本地 PowerPivot 工作簿提供连接信息，则可以将相同的 .odc 文件添加到此库。</span><span class="sxs-lookup"><span data-stu-id="9db41-230">If you use .odc files to provide connection information to local PowerPivot workbooks, you can add the same .odc files to this library.</span></span>|  
|<span data-ttu-id="9db41-231">用户定义函数程序集</span><span class="sxs-lookup"><span data-stu-id="9db41-231">User defined function assembly</span></span>|<span data-ttu-id="9db41-232">不适用。</span><span class="sxs-lookup"><span data-stu-id="9db41-232">Not applicable.</span></span>|<span data-ttu-id="9db41-233">PowerPivot for SharePoint 忽略您为 Excel Services 生成部署的用户定义函数程序集。</span><span class="sxs-lookup"><span data-stu-id="9db41-233">PowerPivot for SharePoint ignores user-defined function assemblies that you build deploy for Excel Services.</span></span> <span data-ttu-id="9db41-234">如果对于特定行为依赖于用户定义程序集，请注意 PowerPivot 查询处理将不使用您创建的用户定义函数。</span><span class="sxs-lookup"><span data-stu-id="9db41-234">If you rely on user-defined assemblies for a specific behavior, be aware that PowerPivot query processing will not use the user-defined functions you created.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9db41-235">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9db41-235">See Also</span></span>  
 <span data-ttu-id="9db41-236">[配置 PowerPivot 服务帐户](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="9db41-236">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 <span data-ttu-id="9db41-237">[将 PowerPivot 无人参与的数据刷新帐户配置 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="9db41-237">[Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md) </span></span>  
 <span data-ttu-id="9db41-238">[在管理中心中为 PowerPivot 站点创建受信任位置](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span><span class="sxs-lookup"><span data-stu-id="9db41-238">[Create a trusted location for PowerPivot sites in Central Administration](create-a-trusted-location-for-power-pivot-sites-in-central-administration.md) </span></span>  
 [<span data-ttu-id="9db41-239">PowerPivot 安全体系结构</span><span class="sxs-lookup"><span data-stu-id="9db41-239">PowerPivot Security Architecture</span></span>](https://go.microsoft.com/fwlink/?linkID=220970)  
  
  
