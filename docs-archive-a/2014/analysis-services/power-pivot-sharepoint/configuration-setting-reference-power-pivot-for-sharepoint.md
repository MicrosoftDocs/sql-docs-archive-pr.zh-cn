---
title: 配置设置引用 (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 3b57dd3f-7820-4ba8-b233-01dc68908273
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01a1c0d4c5273dccb6ba7057d1cd5c26a6f8890c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688315"
---
# <a name="configuration-setting-reference-powerpivot-for-sharepoint"></a><span data-ttu-id="9c936-102">配置设置参考 (PowerPivot for SharePoint)</span><span class="sxs-lookup"><span data-stu-id="9c936-102">Configuration Setting Reference (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="9c936-103">本主题提供有关 SharePoint 场中的 PowerPivot 服务应用程序使用的配置设置的参考文档。</span><span class="sxs-lookup"><span data-stu-id="9c936-103">This topic provides reference documentation for configuration settings used by PowerPivot service applications in a SharePoint farm.</span></span> <span data-ttu-id="9c936-104">如果您使用 PowerShell 脚本来配置服务器，或如果您要查找特定设置的信息，则本主题中的信息可提供详细的说明。</span><span class="sxs-lookup"><span data-stu-id="9c936-104">If you are using PowerShell script to configure a server, or if you want to look up information for a specific setting, the information in this topic provides detailed descriptions.</span></span>  
  
 <span data-ttu-id="9c936-105">配置设置是针对每个 PowerPivot 服务应用程序进行设置的。</span><span class="sxs-lookup"><span data-stu-id="9c936-105">Configuration settings are set for each PowerPivot service application.</span></span> <span data-ttu-id="9c936-106">在场中，可以创建多个服务应用程序，从而配置同一物理服务实例的独立逻辑实例。</span><span class="sxs-lookup"><span data-stu-id="9c936-106">Within a farm, you can create multiple service applications as a way to configure independent logical instances of the same physical service instance.</span></span> <span data-ttu-id="9c936-107">配置设置存储在为您配置的每个服务应用程序创建的 PowerPivot 应用程序数据库中。</span><span class="sxs-lookup"><span data-stu-id="9c936-107">Configuration settings are stored in the PowerPivot application database created for each service application that you configure.</span></span>  
  
 <span data-ttu-id="9c936-108">如果您更改配置设置，则所做的更改立即生效并用于后续请求和连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-108">If you change configuration settings, the changes are picked up immediately and used for subsequent requests and connections.</span></span> <span data-ttu-id="9c936-109">正在进行的操作由在操作开始时起作用的设置控制。</span><span class="sxs-lookup"><span data-stu-id="9c936-109">Operations that are in progress are governed by the settings that were in effect when the operation began.</span></span>  
  
 <span data-ttu-id="9c936-110">单击下面的链接可阅读特定的配置部分：</span><span class="sxs-lookup"><span data-stu-id="9c936-110">Click the following links to read about specific configuration areas:</span></span>  
  
 [<span data-ttu-id="9c936-111">数据加载超时</span><span class="sxs-lookup"><span data-stu-id="9c936-111">Data Load Timeout</span></span>](#LoadingData)  
  
 [<span data-ttu-id="9c936-112">连接池</span><span class="sxs-lookup"><span data-stu-id="9c936-112">Connection Pools</span></span>](#ConnectionPool)  
  
 [<span data-ttu-id="9c936-113">负载均衡</span><span class="sxs-lookup"><span data-stu-id="9c936-113">Load Balancing</span></span>](#AllocationScheme)  
  
 [<span data-ttu-id="9c936-114">数据刷新</span><span class="sxs-lookup"><span data-stu-id="9c936-114">Data Refresh</span></span>](#DataRefresh)  
  
 [<span data-ttu-id="9c936-115">使用情况数据收集</span><span class="sxs-lookup"><span data-stu-id="9c936-115">Usage Data Collection</span></span>](#UsageData)  
  
 <span data-ttu-id="9c936-116">有关如何创建 PowerPivot 服务应用程序的说明，请参阅[在管理中心中创建和配置 PowerPivot 服务应用程序](create-and-configure-power-pivot-service-application-in-ca.md)。</span><span class="sxs-lookup"><span data-stu-id="9c936-116">For instructions on how to create a PowerPivot service application, see [Create and Configure a PowerPivot Service Application in Central Administration](create-and-configure-power-pivot-service-application-in-ca.md).</span></span>  
  
##  <a name="data-load-timeout"></a><a name="LoadingData"></a> <span data-ttu-id="9c936-117">数据加载超时</span><span class="sxs-lookup"><span data-stu-id="9c936-117">Data Load Timeout</span></span>  
 <span data-ttu-id="9c936-118">PowerPivot 数据由场中的 Analysis Services 服务器实例检索并加载。</span><span class="sxs-lookup"><span data-stu-id="9c936-118">PowerPivot data is retrieved and loaded by Analysis Services server instances in the farm.</span></span> <span data-ttu-id="9c936-119">可以从内容库或从本地文件缓存加载数据，具体取决于上次访问数据的方式和时间。</span><span class="sxs-lookup"><span data-stu-id="9c936-119">Depending on how and when the data was last accessed, it will either be loaded from a content library or from a local file cache.</span></span> <span data-ttu-id="9c936-120">只要收到查询或处理请求，就会将数据加载到内存中。</span><span class="sxs-lookup"><span data-stu-id="9c936-120">Data is loaded into memory whenever a query or processing request is received.</span></span> <span data-ttu-id="9c936-121">若要最大限度地提高服务器的总体可用性，您可以设置一个超时值以指示服务器在分配的时间内无法完成加载时停止数据加载请求。</span><span class="sxs-lookup"><span data-stu-id="9c936-121">To maximize overall server availability, you can set a timeout value that instructs the server to stop a load data request if it cannot be completed within the allotted time.</span></span>  
  
|<span data-ttu-id="9c936-122">名称</span><span class="sxs-lookup"><span data-stu-id="9c936-122">Name</span></span>|<span data-ttu-id="9c936-123">默认</span><span class="sxs-lookup"><span data-stu-id="9c936-123">Default</span></span>|<span data-ttu-id="9c936-124">有效值</span><span class="sxs-lookup"><span data-stu-id="9c936-124">Valid Values</span></span>|<span data-ttu-id="9c936-125">说明</span><span class="sxs-lookup"><span data-stu-id="9c936-125">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="9c936-126">数据加载超时</span><span class="sxs-lookup"><span data-stu-id="9c936-126">Data Load Timeout</span></span>|<span data-ttu-id="9c936-127">1800（以秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-127">1800 (in seconds)</span></span>|<span data-ttu-id="9c936-128">1 到 3600</span><span class="sxs-lookup"><span data-stu-id="9c936-128">1 to 3600</span></span>|<span data-ttu-id="9c936-129">指定 PowerPivot 服务应用程序等待来自特定 Analysis Services 服务器实例的响应的时间量。</span><span class="sxs-lookup"><span data-stu-id="9c936-129">Specifies the amount of time a PowerPivot service application will wait for a response from a specific Analysis Services server instance.</span></span><br /><br /> <span data-ttu-id="9c936-130">默认情况下，当服务应用程序向引擎服务实例转发特定请求后，它将等待 30 分钟以便从该实例获得数据负载。</span><span class="sxs-lookup"><span data-stu-id="9c936-130">By default, the service application will wait 30 minutes for a data payload from the Engine service instance to which it forwarded a specific request.</span></span><br /><br /> <span data-ttu-id="9c936-131">如果在此时段内无法加载 PowerPivot 数据源，线程将停止，并将启动一个新进程。</span><span class="sxs-lookup"><span data-stu-id="9c936-131">If the PowerPivot data source cannot be loaded within this period of time, the thread will be stopped and a new one will be started.</span></span>|  
  
##  <a name="connection-pools"></a><a name="ConnectionPool"></a><span data-ttu-id="9c936-132">连接池</span><span class="sxs-lookup"><span data-stu-id="9c936-132">Connection Pools</span></span>  
 <span data-ttu-id="9c936-133">PowerPivot 服务应用程序创建并管理连接池，以便重复使用连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-133">The PowerPivot service application creates and manages connection pools to enable connection reuse.</span></span> <span data-ttu-id="9c936-134">连接池有两种类型：一种用于与只读数据建立数据连接；另一种用于建立服务器连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-134">There are two types of connection pools: one for data connections to read-only data, and a second for server connections.</span></span>  
  
 <span data-ttu-id="9c936-135">数据连接池包含 PowerPivot 数据源的缓存连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-135">Data connection pools contain cached connections for PowerPivot data source.</span></span> <span data-ttu-id="9c936-136">每个连接池都基于在加载数据库时设置的上下文。</span><span class="sxs-lookup"><span data-stu-id="9c936-136">Each connection pool is based on the context that was set when the database was loaded.</span></span> <span data-ttu-id="9c936-137">此上下文包括物理服务实例的标识、数据库 ID 和请求数据的 SharePoint 用户的标识。</span><span class="sxs-lookup"><span data-stu-id="9c936-137">This context includes the identity of the physical service instance, the database ID, and the identity of the SharePoint user who is requesting data.</span></span> <span data-ttu-id="9c936-138">将为每个组合创建一个单独的连接池。</span><span class="sxs-lookup"><span data-stu-id="9c936-138">A separate connection pool is created for each combination.</span></span> <span data-ttu-id="9c936-139">例如，来自在同一个服务器上运行的同一数据库的不同用户的请求将使用不同池中的连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-139">For example, requests from different users of the same database running on the same server will consume connections from different pools.</span></span>  
  
 <span data-ttu-id="9c936-140">连接池的作用是为同一 SharePoint 用户对于同一个 Analysis Services 数据库的只读请求使用缓存连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-140">The purpose of a connection pool is to use cached connections for read-only requests for the same Analysis Services database by the same SharePoint user.</span></span> <span data-ttu-id="9c936-141">PowerPivot 服务实例是已在内存中加载了数据的服务器。</span><span class="sxs-lookup"><span data-stu-id="9c936-141">The PowerPivot service instance is the server that has the data loaded in memory.</span></span> <span data-ttu-id="9c936-142">数据库 ID 是数据模型的内存中数据结构的内部标识符（模型实例化为 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 多维数据集数据库）。</span><span class="sxs-lookup"><span data-stu-id="9c936-142">The database ID is an internal identifier for the in-memory data structures of the data model (a model is instantiated as an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] cube database).</span></span> <span data-ttu-id="9c936-143">版本信息隐式包含在该标识符中。</span><span class="sxs-lookup"><span data-stu-id="9c936-143">Version information is implicitly incorporated in the identifier.</span></span>  
  
 <span data-ttu-id="9c936-144">服务器连接池包含从 PowerPivot 服务应用程序实例到 Analysis Services 服务器实例的缓存连接，其中，服务应用程序使用 Analysis Services 服务器上的 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Sysadmin 权限进行连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-144">Server connection pools contain cached connections from a PowerPivot service application instance to an Analysis Services server instance, where the service application is connecting with [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] Sysadmin permissions on the Analysis Services server.</span></span> <span data-ttu-id="9c936-145">这些连接用来发出加载数据库请求并监视系统运行状况。</span><span class="sxs-lookup"><span data-stu-id="9c936-145">These connections are used to issue a load database request and monitor system health.</span></span>  
  
 <span data-ttu-id="9c936-146">每种连接池类型都有上限，您可以设置此上限，以确保以最佳方式将系统内存用于连接管理。</span><span class="sxs-lookup"><span data-stu-id="9c936-146">Each type of connection pool has upper limits that you can set to ensure best use of system memory for connection management.</span></span>  
  
|<span data-ttu-id="9c936-147">名称</span><span class="sxs-lookup"><span data-stu-id="9c936-147">Name</span></span>|<span data-ttu-id="9c936-148">默认</span><span class="sxs-lookup"><span data-stu-id="9c936-148">Default</span></span>|<span data-ttu-id="9c936-149">有效值</span><span class="sxs-lookup"><span data-stu-id="9c936-149">Valid Values</span></span>|<span data-ttu-id="9c936-150">说明</span><span class="sxs-lookup"><span data-stu-id="9c936-150">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="9c936-151">连接池超时</span><span class="sxs-lookup"><span data-stu-id="9c936-151">Connection Pool Timeout</span></span>|<span data-ttu-id="9c936-152">1800（以秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-152">1800 (in seconds)</span></span>|<span data-ttu-id="9c936-153">1 到 3600。</span><span class="sxs-lookup"><span data-stu-id="9c936-153">1 to 3600.</span></span>|<span data-ttu-id="9c936-154">此设置适用于数据连接池。</span><span class="sxs-lookup"><span data-stu-id="9c936-154">This setting applies to data connection pools.</span></span><br /><br /> <span data-ttu-id="9c936-155">它指定空闲连接在被删除之前可以在连接池中保留多长时间。</span><span class="sxs-lookup"><span data-stu-id="9c936-155">It specifies how much time an idle connection can remain in a connection pool before it is removed.</span></span><br /><br /> <span data-ttu-id="9c936-156">默认情况下，如果某个连接处于非活动状态超过五分钟，服务应用程序将删除此连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-156">By default, the service application will remove a connection if it is inactive for more than five minutes.</span></span>|  
|<span data-ttu-id="9c936-157">最大用户连接池大小</span><span class="sxs-lookup"><span data-stu-id="9c936-157">Maximum User Connection Pool Size</span></span>|<span data-ttu-id="9c936-158">1000</span><span class="sxs-lookup"><span data-stu-id="9c936-158">1000</span></span>|<span data-ttu-id="9c936-159">-1、0 或 1 到 10000。</span><span class="sxs-lookup"><span data-stu-id="9c936-159">-1, 0, or 1 to 10000.</span></span><br /><br /> <span data-ttu-id="9c936-160">-1 指定空闲连接数量不受限制。</span><span class="sxs-lookup"><span data-stu-id="9c936-160">-1 specifies an unlimited number of idle connections.</span></span><br /><br /> <span data-ttu-id="9c936-161">0 表示不保持空闲连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-161">0 means no idle connections are kept.</span></span> <span data-ttu-id="9c936-162">每次必须创建到 PowerPivot 数据源的新连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-162">New connections to a PowerPivot data source must be created each time.</span></span>|<span data-ttu-id="9c936-163">此设置适用于为特定 PowerPivot 服务应用程序实例创建的所有数据连接池中的空闲连接数。</span><span class="sxs-lookup"><span data-stu-id="9c936-163">This setting applies to the number of idle connections in all data connection pools created for a specific PowerPivot service application instance.</span></span><br /><br /> <span data-ttu-id="9c936-164">将为 SharePoint 用户、PowerPivot 数据和服务实例的唯一组合创建单个连接池。</span><span class="sxs-lookup"><span data-stu-id="9c936-164">Individual connection pools are created for unique combinations of a SharePoint user, PowerPivot data, and service instance.</span></span> <span data-ttu-id="9c936-165">如果您有许多用户访问各种 PowerPivot 数据源，服务器性能可能会因连接池大小的增加而受益。</span><span class="sxs-lookup"><span data-stu-id="9c936-165">If you have many users accessing a variety of PowerPivot data sources, server performance might benefit from an increase in connection pool size.</span></span><br /><br /> <span data-ttu-id="9c936-166">如果与 PowerPivot 服务实例的空闲连接数目超过 100 个，将断开最新的空闲连接，而不是将其返回到池中。</span><span class="sxs-lookup"><span data-stu-id="9c936-166">If there are more than 100 idle connections to a PowerPivot service instance, newly idle connections are disconnected rather than returned to the pool.</span></span>|  
|<span data-ttu-id="9c936-167">最大管理连接池大小</span><span class="sxs-lookup"><span data-stu-id="9c936-167">Maximum Administrative Connection Pool Size</span></span>|<span data-ttu-id="9c936-168">200</span><span class="sxs-lookup"><span data-stu-id="9c936-168">200</span></span>|<span data-ttu-id="9c936-169">-1、0 或 1 到 10000。</span><span class="sxs-lookup"><span data-stu-id="9c936-169">-1, 0, or 1 to 10000.</span></span><br /><br /> <span data-ttu-id="9c936-170">-1 指定空闲连接数量不受限制。</span><span class="sxs-lookup"><span data-stu-id="9c936-170">-1 specifies an unlimited number of idle connections.</span></span>|<span data-ttu-id="9c936-171">为 PowerPivot 服务应用程序与 Analysis Services 服务器实例之间的连接创建的所有管理连接池中的最大空闲服务器连接数目。</span><span class="sxs-lookup"><span data-stu-id="9c936-171">The maximum number of idle server connections in all administrative connection pools created for PowerPivot service application connections to an Analysis Services server instance.</span></span> <span data-ttu-id="9c936-172">服务器连接用于请求加载数据库以及将更改保存回 SharePoint 数据库。</span><span class="sxs-lookup"><span data-stu-id="9c936-172">Server connections are used for requests to load databases and to save changes back to the SharePoint database.</span></span>|  
  
##  <a name="load-balancing"></a><a name="AllocationScheme"></a><span data-ttu-id="9c936-173">负载均衡</span><span class="sxs-lookup"><span data-stu-id="9c936-173">Load Balancing</span></span>  
 <span data-ttu-id="9c936-174">PowerPivot 服务执行的功能之一是确定在可用的 PowerPivot 服务实例之间加载 Analysis Services 数据的位置。</span><span class="sxs-lookup"><span data-stu-id="9c936-174">One of the functions that the PowerPivot service performs is to determine where Analysis Services data will be loaded among the available PowerPivot service instances.</span></span> <span data-ttu-id="9c936-175">`AllocationMethod` 设置指定选择服务实例时所依据的条件。</span><span class="sxs-lookup"><span data-stu-id="9c936-175">The `AllocationMethod` setting specifies the criteria against which a service instance is selected.</span></span>  
  
|<span data-ttu-id="9c936-176">名称</span><span class="sxs-lookup"><span data-stu-id="9c936-176">Name</span></span>|<span data-ttu-id="9c936-177">默认</span><span class="sxs-lookup"><span data-stu-id="9c936-177">Default</span></span>|<span data-ttu-id="9c936-178">有效值</span><span class="sxs-lookup"><span data-stu-id="9c936-178">Valid Values</span></span>|<span data-ttu-id="9c936-179">说明</span><span class="sxs-lookup"><span data-stu-id="9c936-179">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="9c936-180">分配方法</span><span class="sxs-lookup"><span data-stu-id="9c936-180">Allocation Method</span></span>|<span data-ttu-id="9c936-181">循环</span><span class="sxs-lookup"><span data-stu-id="9c936-181">RoundRobin</span></span>|<span data-ttu-id="9c936-182">循环</span><span class="sxs-lookup"><span data-stu-id="9c936-182">Round Robin</span></span><br /><br /> <span data-ttu-id="9c936-183">基于运行状况</span><span class="sxs-lookup"><span data-stu-id="9c936-183">Health Based</span></span>|<span data-ttu-id="9c936-184">用于在两个或更多 Analysis Services 服务器实例之间分配负载请求的方案。</span><span class="sxs-lookup"><span data-stu-id="9c936-184">A scheme for allocating load requests among two or more Analysis Services server instances.</span></span><br /><br /> <span data-ttu-id="9c936-185">默认情况下，PowerPivot 服务将基于服务器运行状况平均分配请求。</span><span class="sxs-lookup"><span data-stu-id="9c936-185">By default, the PowerPivot service will alternate requests based on server health.</span></span> <span data-ttu-id="9c936-186">“基于运行状况”选项基于可用内存和 CPU 利用率，将请求分配到具有最多可用系统资源的服务器。</span><span class="sxs-lookup"><span data-stu-id="9c936-186">Health based allocates requests to the server that has the most system resources available based on available memory and CPU utilization.</span></span><br /><br /> <span data-ttu-id="9c936-187">循环将按先后顺序在可用的服务器之间循环分配请求，而不考虑当前负载或服务器运行状况。</span><span class="sxs-lookup"><span data-stu-id="9c936-187">Round robin rotates requests amongst the available servers in sequential order, regardless of current load or server health.</span></span>|  
  
##  <a name="data-refresh"></a><a name="DataRefresh"></a> <span data-ttu-id="9c936-188">数据刷新</span><span class="sxs-lookup"><span data-stu-id="9c936-188">Data Refresh</span></span>  
 <span data-ttu-id="9c936-189">指定为组织定义正常或典型工作日的小时数范围。</span><span class="sxs-lookup"><span data-stu-id="9c936-189">Specify the range of hours that defines a normal or typical business day for your organization.</span></span> <span data-ttu-id="9c936-190">这些配置设置确定在工作时间后何时进行数据处理以便执行数据刷新操作。</span><span class="sxs-lookup"><span data-stu-id="9c936-190">These configuration settings determine when after-hours data processing occurs for data refresh operations.</span></span> <span data-ttu-id="9c936-191">工作时间后处理可在工作日结束时开始。</span><span class="sxs-lookup"><span data-stu-id="9c936-191">After-hours processing can begin at the end time of the business day.</span></span> <span data-ttu-id="9c936-192">对于希望使用在正常工作时间内生成的事务数据来刷新 PowerPivot 数据源的文档所有者而言，工作时间后处理是一个计划选项。</span><span class="sxs-lookup"><span data-stu-id="9c936-192">After-hours processing is a schedule option for document owners who want to refresh a PowerPivot data source with transactional data that was generated during normal business hours.</span></span>  
  
|<span data-ttu-id="9c936-193">名称</span><span class="sxs-lookup"><span data-stu-id="9c936-193">Name</span></span>|<span data-ttu-id="9c936-194">默认</span><span class="sxs-lookup"><span data-stu-id="9c936-194">Default</span></span>|<span data-ttu-id="9c936-195">有效值</span><span class="sxs-lookup"><span data-stu-id="9c936-195">Valid values</span></span>|<span data-ttu-id="9c936-196">说明</span><span class="sxs-lookup"><span data-stu-id="9c936-196">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="9c936-197">开始时间</span><span class="sxs-lookup"><span data-stu-id="9c936-197">Start time</span></span>|<span data-ttu-id="9c936-198">上午 04:00</span><span class="sxs-lookup"><span data-stu-id="9c936-198">04:00 a.m.</span></span>|<span data-ttu-id="9c936-199">1 至 12 小时，其中，该值为此范围内的有效整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-199">1 to 12 hours, where the value is a valid integer within that range.</span></span><br /><br /> <span data-ttu-id="9c936-200">类型为 Time。</span><span class="sxs-lookup"><span data-stu-id="9c936-200">Type is Time.</span></span>|<span data-ttu-id="9c936-201">设置工作时间范围的下限。</span><span class="sxs-lookup"><span data-stu-id="9c936-201">Sets the lower limit of a business hour range.</span></span>|  
|<span data-ttu-id="9c936-202">结束时间</span><span class="sxs-lookup"><span data-stu-id="9c936-202">End time</span></span>|<span data-ttu-id="9c936-203">晚上 08:00</span><span class="sxs-lookup"><span data-stu-id="9c936-203">08:00 p.m.</span></span>|<span data-ttu-id="9c936-204">1 至 12 小时，其中，该值为此范围内的有效整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-204">1 to 12 hours, where the value is a valid integer within that range.</span></span><br /><br /> <span data-ttu-id="9c936-205">类型为 Time。</span><span class="sxs-lookup"><span data-stu-id="9c936-205">Type is Time.</span></span>|<span data-ttu-id="9c936-206">设置工作时间范围的上限。</span><span class="sxs-lookup"><span data-stu-id="9c936-206">Sets the upper limit of a business hour range.</span></span>|  
|<span data-ttu-id="9c936-207">PowerPivot 无人参与的数据刷新帐户</span><span class="sxs-lookup"><span data-stu-id="9c936-207">PowerPivot Unattended Data Refresh Account</span></span>|<span data-ttu-id="9c936-208">无</span><span class="sxs-lookup"><span data-stu-id="9c936-208">None</span></span>|<span data-ttu-id="9c936-209">目标应用程序 ID</span><span class="sxs-lookup"><span data-stu-id="9c936-209">A target application ID</span></span>|<span data-ttu-id="9c936-210">此帐户用于代表计划所有者运行数据刷新作业。</span><span class="sxs-lookup"><span data-stu-id="9c936-210">This account is used to run data refresh jobs on behalf of a schedule owner.</span></span><br /><br /> <span data-ttu-id="9c936-211">无人参与的数据刷新帐户必须事先定义，然后才能在服务应用程序配置页中引用。</span><span class="sxs-lookup"><span data-stu-id="9c936-211">The unattended data refresh account must be defined in advance before it can be referenced in the service application configuration page.</span></span> <span data-ttu-id="9c936-212">有关详细信息，请参阅[配置 PowerPivot 无人参与的数据刷新帐户 &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="9c936-212">For more information, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](../configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>|  
|<span data-ttu-id="9c936-213">允许用户输入自定义 Windows 凭据</span><span class="sxs-lookup"><span data-stu-id="9c936-213">Allow users to enter custom Windows credentials</span></span>|<span data-ttu-id="9c936-214">已启用</span><span class="sxs-lookup"><span data-stu-id="9c936-214">Enabled</span></span>|<span data-ttu-id="9c936-215">Boolean</span><span class="sxs-lookup"><span data-stu-id="9c936-215">Boolean</span></span>|<span data-ttu-id="9c936-216">确定计划的数据刷新配置页是否显示一个选项，让计划所有者能够指定用于运行数据刷新作业的 Windows 用户帐户和密码。</span><span class="sxs-lookup"><span data-stu-id="9c936-216">Determines whether the scheduled data refresh configuration page shows an option that allows a schedule owner to specify Windows user account and password to run a data refresh job.</span></span><br /><br /> <span data-ttu-id="9c936-217">必须启用安全存储区服务才能使用此选项。</span><span class="sxs-lookup"><span data-stu-id="9c936-217">Secure Store Service must be enabled in order for this option to work.</span></span> <span data-ttu-id="9c936-218">有关详细信息，请参阅为[PowerPivot 数据刷新配置存储的凭据 &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)。</span><span class="sxs-lookup"><span data-stu-id="9c936-218">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](../configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>|  
|<span data-ttu-id="9c936-219">最大处理历史记录长度</span><span class="sxs-lookup"><span data-stu-id="9c936-219">Maximum Processing History Length</span></span>|<span data-ttu-id="9c936-220">365</span><span class="sxs-lookup"><span data-stu-id="9c936-220">365</span></span>|<span data-ttu-id="9c936-221">1 到 5000 天</span><span class="sxs-lookup"><span data-stu-id="9c936-221">1 to 5000 days</span></span>|<span data-ttu-id="9c936-222">确定数据刷新历史记录在 PowerPivot 服务应用程序数据库中保留多长的时间。</span><span class="sxs-lookup"><span data-stu-id="9c936-222">Determines how long data refresh history is retained in the PowerPivot service application database.</span></span> <span data-ttu-id="9c936-223">有关详细信息，请参阅 [PowerPivot Usage Data Collection](power-pivot-usage-data-collection.md)。</span><span class="sxs-lookup"><span data-stu-id="9c936-223">For more information, see [PowerPivot Usage Data Collection](power-pivot-usage-data-collection.md).</span></span>|  
  
##  <a name="usage-data-collection"></a><a name="UsageData"></a><span data-ttu-id="9c936-224">使用情况数据收集</span><span class="sxs-lookup"><span data-stu-id="9c936-224">Usage Data Collection</span></span>  
 <span data-ttu-id="9c936-225">PowerPivot 管理面板中显示的使用情况报表可以提供有关启用 PowerPivot 的工作簿使用情况的重要信息。</span><span class="sxs-lookup"><span data-stu-id="9c936-225">Usage reports that appear in the PowerPivot Management Dashboard can provide important information about how PowerPivot-enabled workbooks are used.</span></span> <span data-ttu-id="9c936-226">针对以后在使用状况或活动报表中使用的 PowerPivot 服务器事件，以下配置设置控制使用情况数据收集的各个方面。</span><span class="sxs-lookup"><span data-stu-id="9c936-226">The following configuration settings control aspects of usage data collection for PowerPivot server events that are subsequently presented in usage or activity reports.</span></span>  
  
|<span data-ttu-id="9c936-227">名称</span><span class="sxs-lookup"><span data-stu-id="9c936-227">Name</span></span>|<span data-ttu-id="9c936-228">默认</span><span class="sxs-lookup"><span data-stu-id="9c936-228">Default</span></span>|<span data-ttu-id="9c936-229">有效值</span><span class="sxs-lookup"><span data-stu-id="9c936-229">Valid values</span></span>|<span data-ttu-id="9c936-230">说明</span><span class="sxs-lookup"><span data-stu-id="9c936-230">Description</span></span>|  
|----------|-------------|------------------|-----------------|  
|<span data-ttu-id="9c936-231">查询报告间隔</span><span class="sxs-lookup"><span data-stu-id="9c936-231">Query Reporting Interval</span></span>|<span data-ttu-id="9c936-232">300（以秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-232">300 (in seconds)</span></span>|<span data-ttu-id="9c936-233">1 到 n 秒，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-233">1 to n seconds, where n is any valid integer.</span></span>|<span data-ttu-id="9c936-234">为了确保使用情况数据收集不消耗场的过多数据传输能力，将对每个连接收集查询统计信息并将其报告为单个事件。</span><span class="sxs-lookup"><span data-stu-id="9c936-234">To ensure that usage data collection does not consume too much of the data transfer capacity of the farm, query statistics are collected on each connection and reported as a single event.</span></span> <span data-ttu-id="9c936-235">“查询报告间隔”确定报告事件的频率。</span><span class="sxs-lookup"><span data-stu-id="9c936-235">The Query Reporting Interval determines how often an event is reported.</span></span> <span data-ttu-id="9c936-236">默认情况下，每 5 分钟报告一次查询统计信息。</span><span class="sxs-lookup"><span data-stu-id="9c936-236">By default, query statistics are reported every 5 minutes.</span></span><br /><br /> <span data-ttu-id="9c936-237">因为只要发送请求就会立即关闭连接，所以，系统甚至会为访问单个 PowerPivot 数据源的单个用户生成大量的连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-237">Because connections are immediately closed as soon as a request is sent, the system generates a very large number of connections for even a single user accessing a single PowerPivot data source.</span></span> <span data-ttu-id="9c936-238">因此，将为每个用户与 PowerPivot 数据源组合创建连接池，以便在创建连接后，相同数据的同一用户可以重复使用此连接。</span><span class="sxs-lookup"><span data-stu-id="9c936-238">For this reason, connection pools are created for each user and PowerPivot data source combination so that once a connection is created it can be reused by the same user for the same data.</span></span> <span data-ttu-id="9c936-239">按照通过此配置设置指定的间隔，PowerPivot 服务应用程序定期报告连接池中每个连接的使用情况数据。</span><span class="sxs-lookup"><span data-stu-id="9c936-239">Periodically, at intervals specified through this configuration setting, the PowerPivot service application reports the usage data for each connection in the connection pool.</span></span><br /><br /> <span data-ttu-id="9c936-240">增加生成报表的时间值将导致记录较少的事件。</span><span class="sxs-lookup"><span data-stu-id="9c936-240">Increasing the time-to-report value will cause fewer events to be logged.</span></span> <span data-ttu-id="9c936-241">但是，如果将值设置得过高，当服务器重新启动或连接关闭时，就存在丢失事件数据的风险。</span><span class="sxs-lookup"><span data-stu-id="9c936-241">However, if you set it too high, you risk losing event data if the server restarts or a connection is closed.</span></span><br /><br /> <span data-ttu-id="9c936-242">降低此值将导致以更高的频率记录更多的事件，同时将更多与 PowerPivot 相关的使用情况数据添加到 SharePoint 使用情况数据库中的数据收集系统。</span><span class="sxs-lookup"><span data-stu-id="9c936-242">Lowering the value will cause more events to be logged with greater frequency, adding more PowerPivot-related usage data to the data collection system in the SharePoint usage database.</span></span><br /><br /> <span data-ttu-id="9c936-243">一般而言，不要更改此配置设置，除非您试图解决特定问题（例如，如果使用情况数据库由于 PowerPivot 使用情况数据而增长过快）。</span><span class="sxs-lookup"><span data-stu-id="9c936-243">Generally, do not change this configuration setting unless you are trying to resolve a specific problem (for example, if the usage database is growing too quickly as a result of PowerPivot usage data).</span></span>|  
|<span data-ttu-id="9c936-244">使用情况数据历史记录</span><span class="sxs-lookup"><span data-stu-id="9c936-244">Usage Data History</span></span>|<span data-ttu-id="9c936-245">365（以天为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-245">365 (in days)</span></span>|<span data-ttu-id="9c936-246">0 或 1 到 n 天，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-246">0, or 1 to n days, where n is any valid integer.</span></span><br /><br /> <span data-ttu-id="9c936-247">0 意味着始终保留而不会删除历史记录。</span><span class="sxs-lookup"><span data-stu-id="9c936-247">0 means that history is always retained and never deleted.</span></span>|<span data-ttu-id="9c936-248">默认情况下，使用情况数据在 PowerPivot 服务应用数据库中保存一年时间。</span><span class="sxs-lookup"><span data-stu-id="9c936-248">By default, usage data is kept for one year in the PowerPivot service application database.</span></span> <span data-ttu-id="9c936-249">早于一年前的记录将从数据库中删除。</span><span class="sxs-lookup"><span data-stu-id="9c936-249">Records that are older than one year are dropped from the database.</span></span><br /><br /> <span data-ttu-id="9c936-250">每天以及当运行 Microsoft SharePoint Foundation 使用情况数据处理作业时，将检查过期的历史数据。</span><span class="sxs-lookup"><span data-stu-id="9c936-250">A check for expired historical data occurs daily, when the Microsoft SharePoint Foundation Usage Data Processing job runs.</span></span> <span data-ttu-id="9c936-251">该计时器作业将读取此设置，并对 PowerPivot 服务应用数据库中过期的历史记录触发数据删除命令。</span><span class="sxs-lookup"><span data-stu-id="9c936-251">The timer job will read this setting and trigger a data deletion command for expired history in the PowerPivot service application database.</span></span>|  
|<span data-ttu-id="9c936-252">一般响应上限</span><span class="sxs-lookup"><span data-stu-id="9c936-252">Trivial Response Upper Limit</span></span>|<span data-ttu-id="9c936-253">500（以毫秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-253">500 (in milliseconds)</span></span>|<span data-ttu-id="9c936-254">1 到 n 毫秒，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-254">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="9c936-255">默认情况下，一般请求的阈值为半秒。</span><span class="sxs-lookup"><span data-stu-id="9c936-255">By default, the threshold for trivial requests is half a second.</span></span><br /><br /> <span data-ttu-id="9c936-256">一般请求包括服务器 ping、对元数据的请求和启动会话。</span><span class="sxs-lookup"><span data-stu-id="9c936-256">Trivial requests include server pings, requests for metadata, and starting sessions.</span></span>|  
|<span data-ttu-id="9c936-257">快速响应上限</span><span class="sxs-lookup"><span data-stu-id="9c936-257">Quick Response Upper Limit</span></span>|<span data-ttu-id="9c936-258">1000（以毫秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-258">1000 (in milliseconds)</span></span>|<span data-ttu-id="9c936-259">1 到 n 毫秒，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-259">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="9c936-260">默认情况下，快速请求的阈值为一秒。</span><span class="sxs-lookup"><span data-stu-id="9c936-260">By default, the threshold for quick requests is one second.</span></span><br /><br /> <span data-ttu-id="9c936-261">快速请求指的是具有极小数据集的请求，或针对涵盖大型成员集的元数据的请求。</span><span class="sxs-lookup"><span data-stu-id="9c936-261">Quick requests are those that have an extremely small dataset, or requests for metadata that span large member sets.</span></span>|  
|<span data-ttu-id="9c936-262">“预期响应上限”</span><span class="sxs-lookup"><span data-stu-id="9c936-262">Expected Response Upper Limit</span></span>|<span data-ttu-id="9c936-263">3000（以毫秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-263">3000 (in milliseconds)</span></span>|<span data-ttu-id="9c936-264">1 到 n 毫秒，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-264">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="9c936-265">默认情况下，预期请求的阈值为三秒。</span><span class="sxs-lookup"><span data-stu-id="9c936-265">By default, the threshold for expected requests is three seconds.</span></span><br /><br /> <span data-ttu-id="9c936-266">此阈值设置预期查询时间的上限。</span><span class="sxs-lookup"><span data-stu-id="9c936-266">This threshold sets the upper limit of an expected query time.</span></span>|  
|<span data-ttu-id="9c936-267">长时间响应上限</span><span class="sxs-lookup"><span data-stu-id="9c936-267">Long Response Upper Limit</span></span>|<span data-ttu-id="9c936-268">10000（以毫秒为单位）</span><span class="sxs-lookup"><span data-stu-id="9c936-268">10000 (in milliseconds)</span></span>|<span data-ttu-id="9c936-269">1 到 n 毫秒，其中 n 是任何有效的整数。</span><span class="sxs-lookup"><span data-stu-id="9c936-269">1 to n milliseconds, where n is any valid integer.</span></span>|<span data-ttu-id="9c936-270">默认情况下，长请求的阈值为十秒。</span><span class="sxs-lookup"><span data-stu-id="9c936-270">By default, the threshold for long requests is ten seconds.</span></span><br /><br /> <span data-ttu-id="9c936-271">这些请求的运行时间比预期时间要长，但仍在可接受的范围内。</span><span class="sxs-lookup"><span data-stu-id="9c936-271">These are requests that run longer than expected, but still fall within an acceptable range.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="9c936-272">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9c936-272">See Also</span></span>  
 <span data-ttu-id="9c936-273">[在管理中心中创建和配置 PowerPivot 服务应用程序](create-and-configure-power-pivot-service-application-in-ca.md) </span><span class="sxs-lookup"><span data-stu-id="9c936-273">[Create and Configure a PowerPivot Service Application in Central Administration](create-and-configure-power-pivot-service-application-in-ca.md) </span></span>  
 <span data-ttu-id="9c936-274">[通过 SharePoint 2010 进行 PowerPivot 数据刷新](../powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="9c936-274">[PowerPivot Data Refresh with SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="9c936-275">[为 &#40;配置使用情况数据收集 PowerPivot for SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="9c936-275">[Configure Usage Data Collection for &#40;PowerPivot for SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="9c936-276">[配置 PowerPivot 服务帐户](configure-power-pivot-service-accounts.md) </span><span class="sxs-lookup"><span data-stu-id="9c936-276">[Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) </span></span>  
 [<span data-ttu-id="9c936-277">PowerPivot 管理面板和使用情况数据</span><span class="sxs-lookup"><span data-stu-id="9c936-277">PowerPivot Management Dashboard and Usage Data</span></span>](power-pivot-management-dashboard-and-usage-data.md)  
  
  
