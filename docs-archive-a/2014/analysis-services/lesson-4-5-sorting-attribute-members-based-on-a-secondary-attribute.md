---
title: 基于辅助属性对属性成员进行排序 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 67dacf68-9ab7-4524-8698-844d0f6e6c6d
author: minewiskan
ms.author: owend
ms.openlocfilehash: b90888c331a1ae1f8dd886e88d5c84afebd99cf5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87694149"
---
# <a name="sorting-attribute-members-based-on-a-secondary-attribute"></a><span data-ttu-id="e52a6-102">根据辅助属性对属性成员进行排序</span><span class="sxs-lookup"><span data-stu-id="e52a6-102">Sorting Attribute Members Based on a Secondary Attribute</span></span>
  <span data-ttu-id="e52a6-103">在第 3 课中，您已了解了如何根据属性成员的名称或键值对属性成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-103">In Lesson 3, you learned how to sort attribute members based on either their name or key value.</span></span> <span data-ttu-id="e52a6-104">您还了解了如何使用组合成员键影响属性成员和排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-104">You also learned how to use a composite member key to affect attribute members and sort order.</span></span> <span data-ttu-id="e52a6-105">有关详细信息，请参阅 [修改日期维度](lesson-3-4-modifying-the-date-dimension.md)。</span><span class="sxs-lookup"><span data-stu-id="e52a6-105">For more information, see [Modifying the Date Dimension](lesson-3-4-modifying-the-date-dimension.md).</span></span> <span data-ttu-id="e52a6-106">但是，如果属性的名称或键都无法提供所需的排序顺序时，您可以使用辅助属性来获取所需的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-106">However, if neither the name nor the key of the attribute provide the sort order that you want, you can use a secondary attribute to achieve the desired sort order.</span></span> <span data-ttu-id="e52a6-107">通过定义属性之间的关系，您可以使用第二个属性来对第一个属性的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-107">By defining a relationship between the attributes, you can use the second attribute to sort the members of the first attribute.</span></span>  
  
 <span data-ttu-id="e52a6-108">属性关系定义属性之间的关系或依赖关系。</span><span class="sxs-lookup"><span data-stu-id="e52a6-108">Attribute relationships define the relationships or dependencies between attributes.</span></span> <span data-ttu-id="e52a6-109">在基于单个关系表的维度中，通常所有属性都通过键属性彼此相关。</span><span class="sxs-lookup"><span data-stu-id="e52a6-109">In a dimension that is based on a single relational table, all attributes are typically related to each other through the key attribute.</span></span> <span data-ttu-id="e52a6-110">这是因为维度的所有属性均提供有关成员的信息，这些成员通过键属性链接到每个相关度量值组的事实数据表中的事实数据。</span><span class="sxs-lookup"><span data-stu-id="e52a6-110">This is because all the attributes for a dimension provide information about the members linked by the key attribute of the dimension to the facts in the fact table for each related measure group.</span></span> <span data-ttu-id="e52a6-111">在基于多个表的维度中，属性通常根据表之间的联接键进行链接。</span><span class="sxs-lookup"><span data-stu-id="e52a6-111">In a dimension that is based on multiple tables, attributes are typically linked based on the join key between the tables.</span></span> <span data-ttu-id="e52a6-112">如果基础数据支持，则可以使用相关属性来指定排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-112">If the underlying data supports it, related attributes can be used to specify a sort order.</span></span> <span data-ttu-id="e52a6-113">例如，您可以创建为相关属性提供排序逻辑的新属性。</span><span class="sxs-lookup"><span data-stu-id="e52a6-113">For example, you might create a new attribute that provides the sort logic for a related attribute.</span></span>  
  
 <span data-ttu-id="e52a6-114">通过维度设计器，您可以定义属性之间的其他关系，也可以更改默认关系以提高性能。</span><span class="sxs-lookup"><span data-stu-id="e52a6-114">Dimension Designer lets you define additional relationships between attributes or change the default relationships to increase performance.</span></span> <span data-ttu-id="e52a6-115">创建属性关系时的主要约束是，确保引用的属性对于与其相关的属性中的任何成员均只包含一个值。</span><span class="sxs-lookup"><span data-stu-id="e52a6-115">The main constraint when you create an attribute relationship is to make sure that the attribute referred to has no more than one value for any member in the attribute to which it is related.</span></span> <span data-ttu-id="e52a6-116">定义两个属性之间的关系时，可以根据成员之间的关系是否会随时间更改而将关系定义为刚性关系或灵活关系。</span><span class="sxs-lookup"><span data-stu-id="e52a6-116">When you define a relationship between two attributes, you can define the relationship as rigid or flexible, based on whether the relationships between members will change over time.</span></span> <span data-ttu-id="e52a6-117">例如，雇员可能移动到不同的销售区域，而市县不会移动到不同的州/省/自治区。</span><span class="sxs-lookup"><span data-stu-id="e52a6-117">For example, an employee might move to a different sales region, but a city will not move to a different state.</span></span> <span data-ttu-id="e52a6-118">如果将关系定义为刚性关系，则每次增量处理维度时不会重新计算属性聚合。</span><span class="sxs-lookup"><span data-stu-id="e52a6-118">If a relationship is defined as rigid, attribute aggregations are not recalculated every time the dimension is incrementally processed.</span></span> <span data-ttu-id="e52a6-119">但如果成员之间的关系确实发生更改，则必须对维度进行完全处理。</span><span class="sxs-lookup"><span data-stu-id="e52a6-119">However, if the relationship between members does change, the dimension must be fully processed.</span></span> <span data-ttu-id="e52a6-120">有关详细信息，请参阅 [属性关系](multidimensional-models-olap-logical-dimension-objects/attribute-relationships.md)、 [定义属性关系](multidimensional-models/attribute-relationships-define.md)、 [配置特性关系属性](multidimensional-models/attribute-relationships-configure-attribute-properties.md)和 [指定用户定义层次结构中属性之间的属性关系](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md)。</span><span class="sxs-lookup"><span data-stu-id="e52a6-120">For more information, see [Attribute Relationships](multidimensional-models-olap-logical-dimension-objects/attribute-relationships.md), [Define Attribute Relationships](multidimensional-models/attribute-relationships-define.md), [Configure Attribute Relationship Properties](multidimensional-models/attribute-relationships-configure-attribute-properties.md), and [Specifying Attribute Relationships Between Attributes in a User-Defined Hierarchy](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md).</span></span>  
  
 <span data-ttu-id="e52a6-121">在本主题的任务中，将根据基础维度表中的现有列在“日期”\*\*\*\* 维度中定义一个新属性。</span><span class="sxs-lookup"><span data-stu-id="e52a6-121">In the tasks in this topic, you will define a new attribute in the **Date** dimension based on an existing column in the underlying dimension table.</span></span> <span data-ttu-id="e52a6-122">您将使用这一新属性按时间顺序而不是字母顺序对日历月份成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-122">You will use this new attribute to sort calendar month members chronologically instead of alphabetically.</span></span> <span data-ttu-id="e52a6-123">还将根据命名计算在“客户”\*\*\*\* 维度中定义一个新属性，该新属性用于对“上下班路程”\*\*\*\* 属性成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-123">You will also define a new attribute in the **Customer** dimension based on the named calculation that you will use to sort the **Commute Distance** attribute members.</span></span> <span data-ttu-id="e52a6-124">在下一个主题的任务中，您将了解如何使用属性关系提高查询性能。</span><span class="sxs-lookup"><span data-stu-id="e52a6-124">In the tasks in the next topic, you will learn to use attribute relationships to increase query performance.</span></span>  
  
## <a name="defining-an-attribute-relationship-and-sort-order-in-the-date-dimension"></a><span data-ttu-id="e52a6-125">在“日期”维度中定义属性关系和排序顺序</span><span class="sxs-lookup"><span data-stu-id="e52a6-125">Defining an Attribute Relationship and Sort Order in the Date Dimension</span></span>  
  
1.  <span data-ttu-id="e52a6-126">打开“日期”\*\*\*\* 维度的维度设计器，然后在“属性”窗口中查看“月份名称”\*\*\*\* 特性的“OrderBy”\*\*\*\* 属性。</span><span class="sxs-lookup"><span data-stu-id="e52a6-126">Open Dimension Designer for the **Date** dimension, and then review the **OrderBy** property for the **Month Name** attribute in the Properties window.</span></span>  
  
     <span data-ttu-id="e52a6-127">注意，“月份名称”\*\*\*\* 特性成员按其键值进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-127">Notice that the **Month Name** attribute members are ordered by their key values.</span></span>  
  
2.  <span data-ttu-id="e52a6-128">切换到“浏览器”\*\*\*\* 选项卡，确保在“层次结构”\*\*\*\* 列表中选择“日历日期”\*\*\*\*，然后展开用户定义层次结构中的各级别以查看日历月份的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-128">Switch to the **Browser** tab, verify that **Calendar Date** is selected in the **Hierarchy** list, and then expand the levels in the user-defined hierarchy to review the sort order for the calendar months.</span></span>  
  
     <span data-ttu-id="e52a6-129">注意，属性层次结构的成员根据其成员键（即月份和年份）的 ASCII 值进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-129">Notice that the members of the attribute hierarchy are sorted based on the ASCII values of their member keys, which are month and year.</span></span> <span data-ttu-id="e52a6-130">在此情况下，按属性名或键进行的排序将不会按时间顺序对日历月份进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-130">In this case, sorting by the attribute name or key does not sort calendar months chronologically.</span></span> <span data-ttu-id="e52a6-131">为解决此问题，将根据新的属性（“MonthNumberOfYear”\*\*\*\* 属性）对属性层次结构的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-131">To solve this, you will sort the members of the attribute hierarchy based on a new attribute, the **MonthNumberOfYear** attribute.</span></span> <span data-ttu-id="e52a6-132">将根据“日期”\*\*\*\* 维度表中适当存在的列创建此属性。</span><span class="sxs-lookup"><span data-stu-id="e52a6-132">You will create this attribute based on a column that conveniently exists in the **Date** dimension table.</span></span>  
  
3.  <span data-ttu-id="e52a6-133">切换到“日期”维度的“维度结构”\*\*\*\* 选项卡，右键单击“数据源视图”\*\*\*\* 窗格中的“MonthNumberOfYear”\*\*\*\*，然后单击“从列新建属性”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-133">Switch to the **Dimension Structure** tab for the Date dimension, right-click **MonthNumberOfYear** in the **Data Source View** pane, and then click **New Attribute from Column**.</span></span>  
  
4.  <span data-ttu-id="e52a6-134">在“属性”\*\*\*\* 窗格中，选择“月份编号”\*\*\*\*，然后在“属性”窗口中，将“AttributeHierarchyEnabled”\*\*\*\* 属性设置为“False”\*\*\*\*，将“AttributeHierarchyOptimizedState”\*\*\*\* 属性设置为“NotOptimized”\*\*\*\*，并将“AttributeHierarchyOrdered”\*\*\*\* 属性设置为“False”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-134">In the **Attributes** pane, select **Month Number Of Year**, and then set the **AttributeHierarchyEnabled** property to **False** in the Properties window, set the **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set the **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="e52a6-135">这些设置将向用户隐藏该属性，并可节省处理时间。</span><span class="sxs-lookup"><span data-stu-id="e52a6-135">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="e52a6-136">此属性不用于浏览。</span><span class="sxs-lookup"><span data-stu-id="e52a6-136">This attribute will not be used for browsing.</span></span> <span data-ttu-id="e52a6-137">它将只用于对其他属性的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-137">It will only be used for ordering the members of another attribute.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e52a6-138">使“属性”窗口中的属性按字母顺序排列可以简化此任务，因为排序后这三个属性会彼此相邻。</span><span class="sxs-lookup"><span data-stu-id="e52a6-138">Sorting properties in the Properties window alphabetically will simplify this task as these three properties will be sorted adjacent to each other.</span></span>  
  
5.  <span data-ttu-id="e52a6-139">单击 **“属性关系”** 选项卡。</span><span class="sxs-lookup"><span data-stu-id="e52a6-139">Click the **Attribute Relationships** tab.</span></span>  
  
     <span data-ttu-id="e52a6-140">注意，“日期”\*\*\*\* 维度中的所有属性都与“日期”\*\*\*\* 属性直接相关，“日期”属性是将维度成员与相关度量值组中的事实数据关联的成员键。</span><span class="sxs-lookup"><span data-stu-id="e52a6-140">Notice that all the attributes in the **Date** dimension are related directly to the **Date** attribute, which is the member key that relates the dimension members to the facts in the related measure groups.</span></span> <span data-ttu-id="e52a6-141">在“月份名称”\*\*\*\* 属性与“月份编号”\*\*\*\* 属性之间未定义任何关系。</span><span class="sxs-lookup"><span data-stu-id="e52a6-141">There is no relationship defined between the **Month Name** attribute and the **Month Number Of Year** attribute.</span></span>  
  
6.  <span data-ttu-id="e52a6-142">在关系图中，右键单击“月份名称”属性，然后选择“新建属性关系”\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-142">In the diagram, right-click the **Month Name** attribute and then select **New Attribute Relationship**.</span></span>  
  
7.  <span data-ttu-id="e52a6-143">在“创建属性关系”对话框中，“源属性”是“月份名称”\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-143">In the **Create Attribute Relationship** dialog box, the **Source Attribute** is **Month Name**.</span></span> <span data-ttu-id="e52a6-144">将“相关属性”\*\*\*\* 设置为“月份编号”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-144">Set the **Related Attribute** to **Month Number Of Year**.</span></span>  
  
8.  <span data-ttu-id="e52a6-145">在“关系类型”列表中，将关系类型设置为“刚性”\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-145">In the **Relationship type** list, set the relationship type to **Rigid**.</span></span>  
  
     <span data-ttu-id="e52a6-146">“月份名称”\*\*\*\* 属性和“月份编号”\*\*\*\* 属性的成员之间的关系将不随时间而更改。</span><span class="sxs-lookup"><span data-stu-id="e52a6-146">The relationships between the members of the **Month Name** attribute and the **Month Number Of Year** attribute will not change over time.</span></span> <span data-ttu-id="e52a6-147">因此，Analysis Services 将不会在增量处理过程中删除此关系的聚合。</span><span class="sxs-lookup"><span data-stu-id="e52a6-147">As a result, Analysis Services will not drop aggregations for this relationship during incremental processing.</span></span> <span data-ttu-id="e52a6-148">如果确实发生更改，则会在增量处理过程中出现处理错误，您将需要对维度执行完整的过程。</span><span class="sxs-lookup"><span data-stu-id="e52a6-148">If a change does occur, a processing error will occur during incremental processing and you will need to perform a full process of the dimension.</span></span> <span data-ttu-id="e52a6-149">现已准备就绪，可以设置“月份名称”\*\*\*\* 的成员的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-149">You are now ready to set the sort order for the members of **Month Name**.</span></span>  
  
9. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
10. <span data-ttu-id="e52a6-150">单击“维度结构”\*\*\*\* 选项卡。</span><span class="sxs-lookup"><span data-stu-id="e52a6-150">Click the **Dimension Structure** tab.</span></span>  
  
11. <span data-ttu-id="e52a6-151">在“特性”\*\*\*\* 窗格中选择“月份名称”\*\*\*\*，然后将“属性”窗口中“OrderBy”\*\*\*\* 属性的值更改为“AttributeKey”\*\*\*\*，并将“OrderByAttribute”\*\*\*\* 属性的值更改为“月份编号”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-151">Select **Month Name** in the **Attributes** pane, and then change the value of the **OrderBy** property in the Properties window to **AttributeKey** and change the value of the **OrderByAttribute** property to **Month Number Of Year**.</span></span>  
  
12. <span data-ttu-id="e52a6-152">在“生成”\*\*\*\* 菜单上，单击“部署 Analysis Services 教程”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-152">On the **Build** menu, click **Deploy Analysis Services Tutorial**.</span></span>  
  
13. <span data-ttu-id="e52a6-153">成功完成部署时，切换到“日期”维度的“浏览器”\*\*\*\* 选项卡，单击“重新连接”\*\*\*\*，然后浏览“日历日期”\*\*\*\* 和“会计日期”\*\*\*\* 用户层次结构，以确保月份现在按时间顺序排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-153">When deployment has successfully completed, switch to the **Browser** tab for the Date dimension, click **Reconnect**, and then browse the **Calendar Date** and **Fiscal Date** user hierarchies to verify that months now sort in chronological order.</span></span>  
  
     <span data-ttu-id="e52a6-154">注意，月份现在按时间顺序排序，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="e52a6-154">Notice that the months are now sorted in chronological order, as shown in the following image.</span></span>  
  
     <span data-ttu-id="e52a6-155">![按时间顺序修改后的用户层次结构](../../2014/tutorials/media/l4-memberproperties-3.gif "按时间顺序修改后的用户层次结构")</span><span class="sxs-lookup"><span data-stu-id="e52a6-155">![Modified user hierarchy in chronological order](../../2014/tutorials/media/l4-memberproperties-3.gif "Modified user hierarchy in chronological order")</span></span>  
  
## <a name="defining-attribute-relationships-and-sort-order-in-the-customer-dimension"></a><span data-ttu-id="e52a6-156">在“客户”维度中定义属性关系和排序顺序</span><span class="sxs-lookup"><span data-stu-id="e52a6-156">Defining Attribute Relationships and Sort Order in the Customer Dimension</span></span>  
  
1.  <span data-ttu-id="e52a6-157">切换到“客户”维度的维度设计器的“浏览器”\*\*\*\* 选项卡，然后浏览“上下班路程”\*\*\*\* 属性层次结构的成员。</span><span class="sxs-lookup"><span data-stu-id="e52a6-157">Switch to the **Browser** tab in Dimension Designer for the Customer dimension, and then browse the members of the **Commute Distance** attribute hierarchy.</span></span>  
  
     <span data-ttu-id="e52a6-158">注意，该属性层次结构的成员基于成员键的 ASCII 值排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-158">Notice that the members of this attribute hierarchy are sorted based on the ASCII values of the member key.</span></span> <span data-ttu-id="e52a6-159">在此情况下，按属性名称或键排序不会按从小到大的顺序对通勤距离进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-159">In this case, sorting by the attribute name or key does not sort the commute distances from least to most.</span></span> <span data-ttu-id="e52a6-160">在此任务中，根据 **CommuteDistanceSort** 命名计算（将相应的排序号分配给列中的不同值）对属性层次结构的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-160">In this task, you sort the members of the attribute hierarchy based on the **CommuteDistanceSort** named calculation that ascribes the appropriate sort number to each distinct value in the column.</span></span> <span data-ttu-id="e52a6-161">为了节省时间，已将此命名计算添加到 **DW 数据源视图的** Customer [!INCLUDE[ssSampleDBCoShort](../includes/sssampledbcoshort-md.md)] 表中。</span><span class="sxs-lookup"><span data-stu-id="e52a6-161">To save time, this named calculation has already been added to the **Customer** table in the [!INCLUDE[ssSampleDBCoShort](../includes/sssampledbcoshort-md.md)] DW data source view.</span></span> <span data-ttu-id="e52a6-162">可以切换到此数据源视图中，以查看在此命名计算中使用的 SQL 脚本。</span><span class="sxs-lookup"><span data-stu-id="e52a6-162">You can switch to this data source view to view the SQL script that is used in this named calculation.</span></span> <span data-ttu-id="e52a6-163">有关详细信息，请参阅[在数据源视图中定义命名计算 &#40;Analysis Services&#41;](multidimensional-models/define-named-calculations-in-a-data-source-view-analysis-services.md)。</span><span class="sxs-lookup"><span data-stu-id="e52a6-163">For more information, see [Define Named Calculations in a Data Source View &#40;Analysis Services&#41;](multidimensional-models/define-named-calculations-in-a-data-source-view-analysis-services.md).</span></span>  
  
     <span data-ttu-id="e52a6-164">下图显示了“上下班路程”\*\*\*\* 属性层次结构的成员，这些成员按成员键的 ASCII 值进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-164">The following image shows the members of the **Commute Distance** attribute hierarchy, sorted by the ASCII values of the member key.</span></span>  
  
     <span data-ttu-id="e52a6-165">![Commute Distance 属性层次结构](../../2014/tutorials/media/l4-memberproperties-4.gif "Commute Distance 属性层次结构")</span><span class="sxs-lookup"><span data-stu-id="e52a6-165">![Commute Distance attribute hierarchy](../../2014/tutorials/media/l4-memberproperties-4.gif "Commute Distance attribute hierarchy")</span></span>  
  
2.  <span data-ttu-id="e52a6-166">在“客户”维度的维度设计器中，切换到“维度结构”\*\*\*\* 选项卡，右键单击“数据源视图”\*\*\*\* 窗格的 **Customer** 表中的“CommuteDistanceSort”\*\*\*\*，然后单击“从列新建属性”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-166">Switch to the **Dimension Structure** tab in Dimension Designer for the Customer dimension, right-click **CommuteDistanceSort** in the **Customer** table in the **Data Source View** pane, and then click **New Attribute from Column**.</span></span>  
  
3.  <span data-ttu-id="e52a6-167">在“特性”\*\*\*\* 窗格中，选择“上下班路程排序”\*\*\*\*，然后在“属性”窗口中，将此特性的“AttributeHierarchyEnabled”\*\*\*\* 属性设置为“False”\*\*\*\*，将“AttributeHierarchyOptimizedState”\*\*\*\* 属性设置为“NotOptimized”\*\*\*\*，并将“AttributeHierarchyOrdered”\*\*\*\* 属性设置为“False”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-167">In the **Attributes** pane, select **Commute Distance Sort**, and then set the **AttributeHierarchyEnabled** property for this attribute to **False** in the Properties window, set the **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set the **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="e52a6-168">这些设置将向用户隐藏该属性，并可节省处理时间。</span><span class="sxs-lookup"><span data-stu-id="e52a6-168">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="e52a6-169">此属性不用于浏览。</span><span class="sxs-lookup"><span data-stu-id="e52a6-169">This attribute will not be used for browsing.</span></span> <span data-ttu-id="e52a6-170">它将只用于对其他属性的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-170">It will only be used for ordering the members of another attribute.</span></span>  
  
4.  <span data-ttu-id="e52a6-171">选择“地域”\*\*\*\*，然后在“属性”窗口中将它的“AttributeHierarchyVisible”\*\*\*\* 属性设置为“False”\*\*\*\*，将“AttributeHierarchyOptimizedState”\*\*\*\* 属性设置为“NotOptimized”\*\*\*\*，并将“AttributeHierarchyOrdered”\*\*\*\* 属性设置为“False”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-171">Select **Geography**, and then set its **AttributeHierarchyVisible** property to **False** in the Properties window, set its **AttributeHierarchyOptimizedState** property to **NotOptimized**, and set its **AttributeHierarchyOrdered** property to **False**.</span></span>  
  
     <span data-ttu-id="e52a6-172">这些设置将向用户隐藏该属性，并可节省处理时间。</span><span class="sxs-lookup"><span data-stu-id="e52a6-172">These settings will hide the attribute from users and will improve processing time.</span></span> <span data-ttu-id="e52a6-173">此属性不用于浏览。</span><span class="sxs-lookup"><span data-stu-id="e52a6-173">This attribute will not be used for browsing.</span></span> <span data-ttu-id="e52a6-174">它将只用于对其他属性的成员进行排序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-174">It will be only be used for ordering the members of another attribute.</span></span> <span data-ttu-id="e52a6-175">因为“地域”\*\*\*\* 具有成员属性，所以必须将其“AttributeHierarchyEnabled”\*\*\*\* 属性设置为“True”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-175">Because **Geography** has member properties, its **AttributeHierarchyEnabled** property must be set to **True**.</span></span> <span data-ttu-id="e52a6-176">因此，要隐藏该属性，请将“AttributeHierarchyVisible”\*\*\*\* 属性设置为“False”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-176">Therefore, to hide the attribute, you set the **AttributeHierarchyVisible** property to **False**.</span></span>  
  
5.  <span data-ttu-id="e52a6-177">单击 **“属性关系”** 选项卡。</span><span class="sxs-lookup"><span data-stu-id="e52a6-177">Click the **Attribute Relationships** tab.</span></span>  
  
6.  <span data-ttu-id="e52a6-178">在属性列表中，右键单击“上下班路程”\*\*\*\* 属性，然后选择“新建属性关系”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-178">In the attributes list, right-click the **Commute Distance** attribute and then select **New Attribute Relationship**.</span></span>  
  
7.  <span data-ttu-id="e52a6-179">在“创建属性关系”\*\*\*\* 对话框中，“源属性”\*\*\*\* 是“上下班路程”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-179">In the **Create Attribute Relationship** dialog box, the **Source Attribute** is **Commute Distance**.</span></span> <span data-ttu-id="e52a6-180">将“相关属性”\*\*\*\* 设置为“上下班路程排序”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-180">Set the **Related Attribute** to **Commute Distance Sort**.</span></span>  
  
8.  <span data-ttu-id="e52a6-181">在“关系类型”列表中，将关系类型设置为“刚性”\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-181">In the **Relationship type** list, set the relationship type to **Rigid**.</span></span>  
  
     <span data-ttu-id="e52a6-182">“上下班路程”\*\*\*\* 属性和“上下班路程排序”\*\*\*\* 属性的成员之间的关系将不随时间而更改。</span><span class="sxs-lookup"><span data-stu-id="e52a6-182">The relationship between the members of the **Commute Distance** attribute and the **Commute Distance Sort** attribute will not change over time.</span></span>  
  
9. [!INCLUDE[clickOK](../includes/clickok-md.md)]  
  
     <span data-ttu-id="e52a6-183">现已准备就绪，可以设置“上下班路程”\*\*\*\* 属性的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="e52a6-183">You are now ready to set the sort order for the **Commute Distance** attribute.</span></span>  
  
10. <span data-ttu-id="e52a6-184">单击“维度结构”\*\*\*\* 选项卡。</span><span class="sxs-lookup"><span data-stu-id="e52a6-184">Click the **Dimension Structure** tab.</span></span>  
  
11. <span data-ttu-id="e52a6-185">在“特性”\*\*\*\* 窗格中选择“上下班路程”\*\*\*\*，然后将“属性”窗口中“OrderBy”\*\*\*\* 属性的值更改为“AttributeKey”\*\*\*\*，并将“OrderByAttribute”\*\*\*\* 属性的值更改为“上下班路程排序”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-185">In the **Attributes** pane, select **Commute Distance**, and then change the value of the **OrderBy** property in the Properties window to **AttributeKey**, and change the value of the **OrderByAttribute** property to **Commute Distance Sort**.</span></span>  
  
12. <span data-ttu-id="e52a6-186">在“生成”\*\*\*\* 菜单上，单击“部署 Analysis Services 教程”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="e52a6-186">On the **Build** menu, click **Deploy Analysis Services Tutorial**.</span></span>  
  
13. <span data-ttu-id="e52a6-187">当部署成功完成时，切换到“客户”维度的维度设计器的“浏览器”\*\*\*\* 选项卡，单击“重新连接”\*\*\*\*，然后浏览“上下班路程”\*\*\*\* 属性层次结构。</span><span class="sxs-lookup"><span data-stu-id="e52a6-187">When deployment has successfully completed, switch to the **Browser** tab of Dimension Designer for the Customer dimension, click **Reconnect**, and then browse the **Commute Distance** attribute hierarchy.</span></span>  
  
     <span data-ttu-id="e52a6-188">注意，属性层次结构成员现在根据不断增加的距离按逻辑顺序进行排序，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="e52a6-188">Notice that the attribute hierarchy members are now sorted in a logical order based on increasing distance, as shown in the following image.</span></span>  
  
     <span data-ttu-id="e52a6-189">![重新排序的 Commute Distance 属性层次结构](../../2014/tutorials/media/l4-memberproperties-5.gif "重新排序的 Commute Distance 属性层次结构")</span><span class="sxs-lookup"><span data-stu-id="e52a6-189">![Re-sorted Commute Distance attribute hierarchy](../../2014/tutorials/media/l4-memberproperties-5.gif "Re-sorted Commute Distance attribute hierarchy")</span></span>  
  
## <a name="next-task-in-lesson"></a><span data-ttu-id="e52a6-190">课程中的下一个任务</span><span class="sxs-lookup"><span data-stu-id="e52a6-190">Next Task in Lesson</span></span>  
 [<span data-ttu-id="e52a6-191">指定用户定义层次结构中属性之间的属性关系</span><span class="sxs-lookup"><span data-stu-id="e52a6-191">Specifying Attribute Relationships Between Attributes in a User-Defined Hierarchy</span></span>](4-6-specifying-attribute-relationships-in-user-defined-hierarchy.md)  
  
  
