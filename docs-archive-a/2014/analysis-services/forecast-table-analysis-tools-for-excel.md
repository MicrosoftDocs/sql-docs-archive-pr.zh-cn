---
title: 用于 Excel) 的预测 (表分析工具 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- Table Analysis tools
- forecasting
- mining model, time series
- time series [data mining]
ms.assetid: 22bb0b5e-78f5-484e-883d-2b5985a12749
author: minewiskan
ms.author: owend
ms.openlocfilehash: abca22dbcb9ae6426e839f92e391a658f5029e31
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579170"
---
# <a name="forecast-table-analysis-tools-for-excel"></a>预测（Excel 表分析工具）
  ![“表分析工具”功能区中的“预测”按钮](media/tat-forecast.gif "“表分析工具”功能区中的“预测”按钮")  
  
 **预测**工具可帮助您基于 Excel 数据表或其他数据源中的数据进行预测，并可选择查看与每个预测值相关联的概率。 例如，如果数据包含一个日期列，另外还包含一个显示该月每天总销售额的列，则您可以预测将来某些天的销售额。 还可以指定要进行的预测数。 例如，可以预测 5 天或 30 天。  
  
 该工具完成后，它将新预测追加到源数据表的末尾，并突出显示新值。 新的时序值不追加，这使您可以首先查看预测。  
  
 该工具还会创建一个名为 "**预测报表**" 的新工作表。 此工作表报告向导是否已成功创建预测。 新工作表还包含一个显示历史趋势的折线图。  
  
 当您将时序扩展为包含新的预测时，预测值将添加到折线图中。 历史值以实线显示，预测以点线显示。  
  
## <a name="using-the-forecast-tool"></a>使用预测工具  
  
1.  打开包含可预测数值数据的 Excel 表。  
  
2.  单击 "**分析**" 选项卡上的 "**预测**"。  
  
3.  指定要预测的列。 该工具会自动选择数据中具有可预测数据类型的列，即连续数值数据。 如果某些具有连续数值数据的列包含许多 null 值或零值，由于缺少数据可能影响结果，该工具可能不会选择这些列。 如果发生这种情况，可以使用 "重新[标记 &#40;SQL Server 数据挖掘外接程序"&#41;](relabel-sql-server-data-mining-add-ins.md)工具来修复数据。  
  
4.  指定包含日期、时间或其他序列标识符的列。 如果选择该选项 **\<no time stamp>** ，该工具将基于源数据中的行序列创建一个序列。  
  
5.  指定要进行的预测数。  
  
6.  或者，为算法提供关于您希望数据每周、每月还是按其他时间间隔重复的提示。 如果数据不符合任何给定模式，或者不知道任何模式，请选择 **\<detect automatically>** 使该工具查找重复的时间段。  
  
7.  向导将预测添加到源表中，并在新的工作表中创建预测报表。  
  
8.  若要将这些新值添加到预测图形中，请将时序扩展为包含预测值。  
  
### <a name="requirements"></a>要求  
 您预测的列必须包含连续的数值数据，如货币或其他数字。  
  
 如果可能，您的数据还应包含一列，该列的内容是时间或日期序列。 可以使用数字序列 (1，2，3 ... ) ，而不是日期和时间数据。 不过，序列列中的值必须是唯一的。 如果**预测**工具在序列列中发现重复值，则会发生错误。  
  
 不能使用**预测**工具预测日期。 虽然不会出现错误，但此算法没有设计为将日期用作可预测值。  
  
### <a name="understanding-time-stamps"></a>了解时间戳  
 必须标识要用作*时间戳*的列。 该时间戳具有两个用途。 第一，它唯一标识时序中的值。 例如，如果要跟踪每天的销售情况，则每天应只有一个销售值。 日历日期可以用作时间戳。 第二，时间戳列指示进行预测的单位。 如果要跟踪每天的销售情况，则预测也将以天为单位。  
  
 如果数据不包括日期或时间列，则工具将自动创建一个名为 _RowIndex 的临时序列键。 该序列键将基于数据集中行的顺序。  
  
 在指定预测数时，请输入一个整数来表示步骤数。 这些步骤的单位取决于数据中的时间和日期序列所使用的单位。 如果数据是按月列出销售结果，则预测将按照月份进行预测。 除非更改源数据，否则无法更改时间单位。  
  
### <a name="understanding-periodicity"></a>了解周期  
 预测以各时间段内的重复模式为基础。 因此，Microsoft 时序算法通过计算来确定具有最强模式的时间段。 *周期*指的是这些时间段。  
  
 一个时序可以包含很多潜在模式。 如果您确信数据中包含某种模式，则通过提供算法提示可能可以改善预测的质量。  
  
 例如，如果您希望数据每周重复，则可以选择“每周”来指示算法应查找每周模式。 不过，如果找不到较强的每周模式，算法将忽略该提示。  
  
## <a name="understanding-the-forecasting-report"></a>理解预测报表  
 在此图形中，数据表中的历史值以黑线显示。 预测值以点线显示。 可以单击线中的某个点来查看预测值。  
  
> [!NOTE]  
>  如果看不到关系图中预测值的时间轴上的标签，请打开包含预测值的工作表，并使用 Excel 中的 "**填充"、"序列**" 功能将时间戳列扩展为包含预测值。  
  
 在某些情况下，预测包含的时间段少于所请求的数量。 这通常意味着数据太少，不允许该算法对遥远的将来进行预测。 **预测**工具只会进行符合最小概率阈值的预测。  
  
## <a name="related-tools"></a>相关工具  
 Excel 数据挖掘客户端是一个独立的外接程序，它提供了更高级的数据挖掘功能，而且还包含一个用来进行预测的向导。  
  
 在 Excel 的 "数据挖掘客户端" 中，**预测**工具 (在 Excel 的表分析工具) 和**预测**向导 (，) 使用时序 [!INCLUDE[msCoName](../includes/msconame-md.md)] 算法。  
  
-   **预测**工具更易于使用，因为它会自动将算法配置为使用最适合您的数据的设置。  
  
-   Excel 数据挖掘客户端中的**预测**向导提供了自定义参数的功能。  
  
 有关**预测**向导的详细信息，请参阅用于[Excel 的数据挖掘外接程序的预测向导 &#40;&#41;](forecast-wizard-data-mining-add-ins-for-excel.md)。 有关用来进行预测的算法的详细信息，请参阅 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 联机丛书中的主题“Microsoft 时序算法”。  
  
## <a name="see-also"></a>另请参阅  
 [Excel 表分析工具](table-analysis-tools-for-excel.md)  
  
  
