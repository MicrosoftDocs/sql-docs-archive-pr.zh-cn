---
title: 参数集合引用（报表生成器和 SSRS）| Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: c4b47e15-0484-4c13-9182-898db825f01f
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 163fe7c93c61088e48d37d0567674d5cee1a79a0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691637"
---
# <a name="parameters-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="71f0a-102">Parameters 集合引用（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="71f0a-102">Parameters Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="71f0a-103">报表参数是可以在表达式中引用的内置集合之一。</span><span class="sxs-lookup"><span data-stu-id="71f0a-103">Report parameters are one of the built-in collections you can reference from an expression.</span></span> <span data-ttu-id="71f0a-104">通过在表达式中包含参数，您可以基于用户的选择来自定义报表的数据和外观。</span><span class="sxs-lookup"><span data-stu-id="71f0a-104">By including parameters in an expression, you can customize report data and appearance based on choices a user makes.</span></span> <span data-ttu-id="71f0a-105">表达式可用于提供 (*Fx*) 或选项的任何报表项属性或文本框属性 \<**Expression**> 。</span><span class="sxs-lookup"><span data-stu-id="71f0a-105">Expressions can be used for any report item property or text box property that provides the (*Fx*) or \<**Expression**> option.</span></span> <span data-ttu-id="71f0a-106">表达式还可用于以其他方式控制报表的内容和外观。</span><span class="sxs-lookup"><span data-stu-id="71f0a-106">Expressions are also used to control report content and appearance in other ways.</span></span> <span data-ttu-id="71f0a-107">有关详细信息，请参阅[表达式示例（报表生成器和 SSRS）](expression-examples-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="71f0a-107">For more information, see [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="71f0a-108">在运行时比较参数值和数据集字段值时，所比较的两个项的数据类型必须相同。</span><span class="sxs-lookup"><span data-stu-id="71f0a-108">When you compare parameter values with dataset field values at run time, the data types for the two items you are comparing must be the same.</span></span> <span data-ttu-id="71f0a-109">报表参数可以是下列类型之一：Boolean、DateTime、Integer、Float 或 Text，它们表示基础数据类型 String。</span><span class="sxs-lookup"><span data-stu-id="71f0a-109">Report parameters can be one of the following types: Boolean, DateTime, Integer, Float, or Text, which represents the underlying data type String.</span></span> <span data-ttu-id="71f0a-110">如有必要，您可能必须转换参数值的数据类型以与数据集值相匹配。</span><span class="sxs-lookup"><span data-stu-id="71f0a-110">If necessary, you might have to convert the data type of the parameter value to match the dataset value.</span></span> <span data-ttu-id="71f0a-111">有关详细信息，请参阅 [表达式中的数据类型（报表生成器和 SSRS）](expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="71f0a-111">For more information, see [Data Types in Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="71f0a-112">为了在表达式中包含参数引用，必须了解如何指定正确的参数引用语法，该语法会因参数是单值参数还是多值参数而有所不同。</span><span class="sxs-lookup"><span data-stu-id="71f0a-112">In order to include a parameter reference in an expression, you must understand how to specify the correct syntax for the parameter reference, which varies depending on whether the parameter is a single-value or multivalue parameter.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="using-a-single-valued-parameter-in-an-expression"></a><a name="Single"></a> <span data-ttu-id="71f0a-113">在表达式中使用单值参数</span><span class="sxs-lookup"><span data-stu-id="71f0a-113">Using a Single-Valued Parameter in an Expression</span></span>  
 <span data-ttu-id="71f0a-114">下表显示了在表达式中包含对任何数据类型单值参数的引用时所用的语法示例。</span><span class="sxs-lookup"><span data-stu-id="71f0a-114">The following table shows examples of the syntax to use when you include a reference to a single-value parameter of any data type in an expression.</span></span>  
  
|<span data-ttu-id="71f0a-115">示例</span><span class="sxs-lookup"><span data-stu-id="71f0a-115">Example</span></span>|<span data-ttu-id="71f0a-116">说明</span><span class="sxs-lookup"><span data-stu-id="71f0a-116">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="71f0a-117">`=Parameters!` *\<ParameterName>* `.IsMultiValue`</span><span class="sxs-lookup"><span data-stu-id="71f0a-117">`=Parameters!` *\<ParameterName>* `.IsMultiValue`</span></span>|<span data-ttu-id="71f0a-118">返回 `False`。</span><span class="sxs-lookup"><span data-stu-id="71f0a-118">Returns `False`.</span></span><br /><br /> <span data-ttu-id="71f0a-119">检查参数是否是多值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-119">Checks if a parameter is multivalue.</span></span> <span data-ttu-id="71f0a-120">如果为 `True` ，则参数为多值，并且是对象的集合。</span><span class="sxs-lookup"><span data-stu-id="71f0a-120">If `True`, the parameter is multivalue and it is a collection of objects.</span></span> <span data-ttu-id="71f0a-121">如果为 `False` ，则该参数是单值并且是单个对象。</span><span class="sxs-lookup"><span data-stu-id="71f0a-121">If `False`, the parameter is single-value and is a single object.</span></span>|  
|<span data-ttu-id="71f0a-122">`=Parameters!` *\<ParameterName>* `.Count`</span><span class="sxs-lookup"><span data-stu-id="71f0a-122">`=Parameters!` *\<ParameterName>* `.Count`</span></span>|<span data-ttu-id="71f0a-123">返回整数值 1。</span><span class="sxs-lookup"><span data-stu-id="71f0a-123">Returns the integer value 1.</span></span> <span data-ttu-id="71f0a-124">对于单值参数，该计数始终为 1。</span><span class="sxs-lookup"><span data-stu-id="71f0a-124">For a single-value parameter, the count is always 1.</span></span>|  
|<span data-ttu-id="71f0a-125">`=Parameters!` *\<ParameterName>* `.Label`</span><span class="sxs-lookup"><span data-stu-id="71f0a-125">`=Parameters!` *\<ParameterName>* `.Label`</span></span>|<span data-ttu-id="71f0a-126">返回参数标签，该参数标签通常用作可用值下拉列表中的显示名称。</span><span class="sxs-lookup"><span data-stu-id="71f0a-126">Returns the parameter label, frequently used as the display name in a drop-down list of available values.</span></span>|  
|<span data-ttu-id="71f0a-127">`=Parameters!` *\<ParameterName>* `.Value`</span><span class="sxs-lookup"><span data-stu-id="71f0a-127">`=Parameters!` *\<ParameterName>* `.Value`</span></span>|<span data-ttu-id="71f0a-128">返回参数值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-128">Returns the parameter value.</span></span> <span data-ttu-id="71f0a-129">如果尚未设置 Label 属性，则此值会显示在可用值的下拉列表中。</span><span class="sxs-lookup"><span data-stu-id="71f0a-129">If the Label property has not been set, this value appears in the drop-down list of available values.</span></span>|  
|<span data-ttu-id="71f0a-130">`=CStr(Parameters!`  *\<ParameterName>* `.Value)`</span><span class="sxs-lookup"><span data-stu-id="71f0a-130">`=CStr(Parameters!`  *\<ParameterName>* `.Value)`</span></span>|<span data-ttu-id="71f0a-131">返回该参数值作为字符串。</span><span class="sxs-lookup"><span data-stu-id="71f0a-131">Returns the parameter value as a string.</span></span>|  
|<span data-ttu-id="71f0a-132">`=Fields(Parameters!` *\<ParameterName>* `.Value).Value`</span><span class="sxs-lookup"><span data-stu-id="71f0a-132">`=Fields(Parameters!` *\<ParameterName>* `.Value).Value`</span></span>|<span data-ttu-id="71f0a-133">返回与参数同名的字段的值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-133">Returns the value for the field that has the same name as the parameter.</span></span>|  
  
 <span data-ttu-id="71f0a-134">有关在筛选器中使用参数的详细信息，请参阅[添加数据集筛选器、数据区域筛选器和组筛选器（报表生成器和 SSRS）](add-dataset-filters-data-region-filters-and-group-filters.md)。</span><span class="sxs-lookup"><span data-stu-id="71f0a-134">For more information about using parameters in a filter, see [Add Dataset Filters, Data Region Filters, and Group Filters &#40;Report Builder and SSRS&#41;](add-dataset-filters-data-region-filters-and-group-filters.md).</span></span>  
  
##  <a name="using-a-multivalue-parameter-in-an-expression"></a><a name="Multi"></a> <span data-ttu-id="71f0a-135">在表达式中使用多值参数</span><span class="sxs-lookup"><span data-stu-id="71f0a-135">Using a Multivalue Parameter in an Expression</span></span>  
 <span data-ttu-id="71f0a-136">下表显示了在表达式中包含对任何数据类型多值参数的引用时所用的语法示例。</span><span class="sxs-lookup"><span data-stu-id="71f0a-136">The following table shows examples of the syntax to use when you include a reference to a multivalue parameter of any data type in an expression.</span></span>  
  
|<span data-ttu-id="71f0a-137">示例</span><span class="sxs-lookup"><span data-stu-id="71f0a-137">Example</span></span>|<span data-ttu-id="71f0a-138">说明</span><span class="sxs-lookup"><span data-stu-id="71f0a-138">Description</span></span>|  
|-------------|-----------------|  
|<span data-ttu-id="71f0a-139">`=Parameters!` *\<MultivalueParameterName>* `.IsMultiValue`</span><span class="sxs-lookup"><span data-stu-id="71f0a-139">`=Parameters!` *\<MultivalueParameterName>* `.IsMultiValue`</span></span>|<span data-ttu-id="71f0a-140">返回 `True` 或 `False`。</span><span class="sxs-lookup"><span data-stu-id="71f0a-140">Returns `True` or `False`.</span></span><br /><br /> <span data-ttu-id="71f0a-141">检查参数是否是多值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-141">Checks if a parameter is multivalue.</span></span> <span data-ttu-id="71f0a-142">如果是 `True`，则该参数是多值并且是一个对象集合。</span><span class="sxs-lookup"><span data-stu-id="71f0a-142">If `True`, the parameter is multivalue and is a collection of objects.</span></span> <span data-ttu-id="71f0a-143">如果是 `False`，则该参数是单值并且是单个对象。</span><span class="sxs-lookup"><span data-stu-id="71f0a-143">If `False`, the parameter is single-valued and is a single object.</span></span>|  
|<span data-ttu-id="71f0a-144">`=Parameters!` *\<MultivalueParameterName>* `.Count`</span><span class="sxs-lookup"><span data-stu-id="71f0a-144">`=Parameters!` *\<MultivalueParameterName>* `.Count`</span></span>|<span data-ttu-id="71f0a-145">返回整数值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-145">Returns an integer value.</span></span><br /><br /> <span data-ttu-id="71f0a-146">表示值的数量。</span><span class="sxs-lookup"><span data-stu-id="71f0a-146">Refers to the number of values.</span></span> <span data-ttu-id="71f0a-147">对于单值参数，该计数始终为 1。</span><span class="sxs-lookup"><span data-stu-id="71f0a-147">For a single-value parameter, the count is always 1.</span></span> <span data-ttu-id="71f0a-148">对于多值参数，该计数为 0 或更多。</span><span class="sxs-lookup"><span data-stu-id="71f0a-148">For a multivalue parameter, the count is 0 or more.</span></span>|  
|<span data-ttu-id="71f0a-149">`=Parameters!` *\<MultivalueParameterName>* `.Value(0)`</span><span class="sxs-lookup"><span data-stu-id="71f0a-149">`=Parameters!` *\<MultivalueParameterName>* `.Value(0)`</span></span>|<span data-ttu-id="71f0a-150">返回多值参数中的第一个值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-150">Returns the first value in a multivalue parameter.</span></span>|  
|<span data-ttu-id="71f0a-151">`=Parameters!` *\<MultivalueParameterName>* `.Value(Parameters!` *\<MultivalueParameterName>* `.Count-1)`</span><span class="sxs-lookup"><span data-stu-id="71f0a-151">`=Parameters!` *\<MultivalueParameterName>* `.Value(Parameters!` *\<MultivalueParameterName>* `.Count-1)`</span></span>|<span data-ttu-id="71f0a-152">返回多值参数中的最后一个值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-152">Returns the last value in a multivalue parameter.</span></span>|  
|`=Split("Value1,Value2,Value3",",")`|<span data-ttu-id="71f0a-153">返回一组值。</span><span class="sxs-lookup"><span data-stu-id="71f0a-153">Returns an array of values.</span></span><br /><br /> <span data-ttu-id="71f0a-154">为多值 `String` 参数创建值数组。</span><span class="sxs-lookup"><span data-stu-id="71f0a-154">Create an array of values for a multivalue `String` parameter.</span></span> <span data-ttu-id="71f0a-155">可以在第二个参数中使用分隔符拆分。</span><span class="sxs-lookup"><span data-stu-id="71f0a-155">You can use any delimiter in the second parameter to Split.</span></span> <span data-ttu-id="71f0a-156">可以使用该表达式为多值参数设置默认值，或创建多值参数以发送至子报表或钻取报表。</span><span class="sxs-lookup"><span data-stu-id="71f0a-156">This expression can be used to set defaults for a multivalue parameter or to create a multivalue parameter to send to a subreport or drillthrough report.</span></span>|  
|<span data-ttu-id="71f0a-157">`=Join(Parameters!` *\<MultivalueParameterName>* `.Value,", ")`</span><span class="sxs-lookup"><span data-stu-id="71f0a-157">`=Join(Parameters!` *\<MultivalueParameterName>* `.Value,", ")`</span></span>|<span data-ttu-id="71f0a-158">返回一个 `String`，它包含以逗号分隔的多值参数中的值列表。</span><span class="sxs-lookup"><span data-stu-id="71f0a-158">Returns a `String` that consists of a comma-delimited list of values in a multivalue parameter.</span></span> <span data-ttu-id="71f0a-159">可以在第二个参数中使用任何分隔符进行联接。</span><span class="sxs-lookup"><span data-stu-id="71f0a-159">You can use any delimiter in the second parameter to Join.</span></span>|  
  
 <span data-ttu-id="71f0a-160">有关在筛选器中使用参数的详细信息，请参阅[报表参数（报表生成器和报表设计器）](report-parameters-report-builder-and-report-designer.md)。</span><span class="sxs-lookup"><span data-stu-id="71f0a-160">For more information about using parameters in a filter, see [Report Parameters &#40;Report Builder and Report Designer&#41;](report-parameters-report-builder-and-report-designer.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="71f0a-161">另请参阅</span><span class="sxs-lookup"><span data-stu-id="71f0a-161">See Also</span></span>  
 <span data-ttu-id="71f0a-162">[表达式（报表生成器和 SSRS）](expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="71f0a-162">[Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="71f0a-163">[常用筛选器（报表生成器和 SSRS）](commonly-used-filters-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="71f0a-163">[Commonly Used Filters &#40;Report Builder and SSRS&#41;](commonly-used-filters-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="71f0a-164">[添加、更改或删除报表参数（报表生成器和 SSRS）](add-change-or-delete-a-report-parameter-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="71f0a-164">[Add, Change, or Delete a Report Parameter &#40;Report Builder and SSRS&#41;](add-change-or-delete-a-report-parameter-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="71f0a-165">[教程：向报表添加参数（报表生成器）](../tutorial-add-a-parameter-to-your-report-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="71f0a-165">[Tutorial: Add a Parameter to Your Report &#40;Report Builder&#41;](../tutorial-add-a-parameter-to-your-report-report-builder.md) </span></span>  
 <span data-ttu-id="71f0a-166">[教程 &#40;报表生成器&#41;](../report-builder-tutorials.md) </span><span class="sxs-lookup"><span data-stu-id="71f0a-166">[Tutorials &#40;Report Builder&#41;](../report-builder-tutorials.md) </span></span>  
 [<span data-ttu-id="71f0a-167">表达式中的内置集合（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="71f0a-167">Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;</span></span>](built-in-collections-in-expressions-report-builder.md)  
  
  
