---
title: 表达式（报表生成器和 SSRS）| Microsoft Docs
ms.prod: sql-server-2014
ms.technology: reporting-services
ms.topic: conceptual
ms.assetid: 76d3ac86-650c-46fe-8086-8b3edcea3882
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.reviewer: ''
ms.custom: ''
ms.date: 06/13/2017
ms.openlocfilehash: afd1b21986d0400ec8861520f3e86d1a80269036
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580592"
---
# <a name="expressions-report-builder-and-ssrs"></a><span data-ttu-id="9f590-102">表达式（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-102">Expressions (Report Builder and SSRS)</span></span>

<span data-ttu-id="9f590-103">表达式在报表中被广泛使用，以便对数据进行检索、计算、显示、分组、排序、筛选、参数化和格式设置。</span><span class="sxs-lookup"><span data-stu-id="9f590-103">Expressions are widely used throughout a report to retrieve, calculate, display, group, sort, filter, parameterize, and format data.</span></span> <span data-ttu-id="9f590-104">许多报表项属性都可以设置为表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-104">Many report item properties can be set to an expression.</span></span> <span data-ttu-id="9f590-105">表达式可帮助您控制报表的内容、设计和交互。</span><span class="sxs-lookup"><span data-stu-id="9f590-105">Expressions help you control the content, design, and interactivity of your report.</span></span> <span data-ttu-id="9f590-106">表达式以 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 编写，保存在报表定义中，并且在运行报表时由报表处理器计算。</span><span class="sxs-lookup"><span data-stu-id="9f590-106">Expressions are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)], saved in the report definition, and evaluated by the report processor when you run the report.</span></span>  

<span data-ttu-id="9f590-107">与 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel 之类的应用程序（在此类应用程序中，直接在工作表中使用数据）不同，在报表中，您使用作为数据的占位符的表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-107">Unlike applications such as [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Office Excel where you work with data directly in a worksheet, in a report, you work with expressions that are placeholders for data.</span></span> <span data-ttu-id="9f590-108">若要查看来自已计算表达式的实际数据，您必须预览报表。</span><span class="sxs-lookup"><span data-stu-id="9f590-108">To see the actual data from the evaluated expressions, you must preview the report.</span></span> <span data-ttu-id="9f590-109">在运行报表时，报表处理器在合并报表数据和报表布局元素（例如表和图表）时对每个表达式进行计算。</span><span class="sxs-lookup"><span data-stu-id="9f590-109">When you run the report, the report processor evaluates each expression as it combines report data and report layout elements such as tables and charts.</span></span>  

<span data-ttu-id="9f590-110">在您设计报表时，系统将为您设置针对报表项的许多表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-110">As you design a report, many expressions for report items are set for you.</span></span> <span data-ttu-id="9f590-111">例如，将一个字段从数据窗格拖到报表设计图面上的表单元时，文本框值将设置为针对该字段的简单表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-111">For example, when you drag a field from the data pane to a table cell on the report design surface, the text box value is set to a simple expression for the field.</span></span> <span data-ttu-id="9f590-112">在下图中，“报表数据”窗格显示数据集字段 ID、Name、SalesTerritory、Code 和 Sales。</span><span class="sxs-lookup"><span data-stu-id="9f590-112">In the following figure, the Report Data pane displays the dataset fields ID, Name, SalesTerritory, Code, and Sales.</span></span> <span data-ttu-id="9f590-113">三个字段已添加到该表中：[Name]、[Code] 和 [Sales]。</span><span class="sxs-lookup"><span data-stu-id="9f590-113">Three fields have been added to the table: [Name], [Code], and [Sales].</span></span> <span data-ttu-id="9f590-114">设计图面上的标志 [Name] 表示基础表达式 `=Fields!Name.Value`。</span><span class="sxs-lookup"><span data-stu-id="9f590-114">The notation [Name] on the design surface represents the underlying expression `=Fields!Name.Value`.</span></span>  

<span data-ttu-id="9f590-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span><span class="sxs-lookup"><span data-stu-id="9f590-115">![rs_DataDesignandPreview](../media/rs-datadesignandpreview.gif "rs_DataDesignandPreview")</span></span>  

<span data-ttu-id="9f590-116">在您预览报表时，报表处理器将表数据区域和来自数据连接的实际数据相结合，并且为结果集中的每一行在表中显示一行。</span><span class="sxs-lookup"><span data-stu-id="9f590-116">When you preview the report, the report processor combines the table data region with the actual data from the data connection and displays a row in the table for every row in the result set.</span></span>  

<span data-ttu-id="9f590-117">若要手动输入表达式，请在设计图面上选择某个项，然后使用快捷菜单和对话框设置该项的属性。</span><span class="sxs-lookup"><span data-stu-id="9f590-117">To enter expressions manually, select an item on the design surface, and use shortcut menus and dialog boxes to set the properties of the item.</span></span> <span data-ttu-id="9f590-118">看到 ***(fx)*** 按钮或者在下拉列表中看到值 `<Expression>` 时，表明可以将该属性设置为表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-118">When you see the ***(fx)*** button or the value `<Expression>` in a drop-down list, you know that you can set the property to an expression.</span></span> <span data-ttu-id="9f590-119">有关详细信息，请参阅 [添加表达式（报表生成器和 SSRS）](add-an-expression-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9f590-119">For more information, see [Add an Expression &#40;Report Builder and SSRS&#41;](add-an-expression-report-builder-and-ssrs.md).</span></span>  

<span data-ttu-id="9f590-120">有关更多信息和示例，请参见以下主题：</span><span class="sxs-lookup"><span data-stu-id="9f590-120">For more information and examples, see the following topics:</span></span>  

-   [<span data-ttu-id="9f590-121">在报表中使用表达式（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-121">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="9f590-122">表达式示例（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-122">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="9f590-123">筛选器公式示例（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-123">Filter Equation Examples &#40;Report Builder and SSRS&#41;</span></span>](filter-equation-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="9f590-124">组表达式示例（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-124">Group Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](group-expression-examples-report-builder-and-ssrs.md)  

-   [<span data-ttu-id="9f590-125">教程 &#40;报表生成器&#41;</span><span class="sxs-lookup"><span data-stu-id="9f590-125">Tutorials &#40;Report Builder&#41;</span></span>](../report-builder-tutorials.md)  

-   [<span data-ttu-id="9f590-126">Reporting Services 教程 (SSRS)</span><span class="sxs-lookup"><span data-stu-id="9f590-126">Reporting Services Tutorials &#40;SSRS&#41;</span></span>](../reporting-services-tutorials-ssrs.md)  

-   [<span data-ttu-id="9f590-127">报表示例（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-127">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  

<span data-ttu-id="9f590-128">若要开发复杂表达式或使用自定义代码或自定义程序集的表达式，建议您使用 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的报表设计器。</span><span class="sxs-lookup"><span data-stu-id="9f590-128">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9f590-129">有关详细信息，请参阅 [报表设计器的表达式中的自定义代码和程序集引用 (SSRS)](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9f590-129">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  

##  <a name="understanding-simple-and-complex-expressions"></a><a name="Types"></a><span data-ttu-id="9f590-130">了解简单表达式和复杂表达式</span><span class="sxs-lookup"><span data-stu-id="9f590-130">Understanding Simple and Complex Expressions</span></span>  
<span data-ttu-id="9f590-131">表达式以等号开头 (=) 并写入 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9f590-131">Expressions begin with an equal sign (=) and are written in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="9f590-132">表达式可包含以下项的组合：常量、运算符、对内置值（字段、集合和函数）的引用以及对外部或自定义代码的引用。</span><span class="sxs-lookup"><span data-stu-id="9f590-132">Expressions can include a combination of constants, operators, and references to built-in values (fields, collections, and functions), and to external or custom code.</span></span>  

<span data-ttu-id="9f590-133">您可以使用表达式来指定许多报表项属性的值。</span><span class="sxs-lookup"><span data-stu-id="9f590-133">You can use expressions to specify the value of many report item properties.</span></span> <span data-ttu-id="9f590-134">最常见的属性是文本框和占位符文本的值。</span><span class="sxs-lookup"><span data-stu-id="9f590-134">The most common properties are values for text boxes and placeholder text.</span></span> <span data-ttu-id="9f590-135">通常，如果某一文本框只包含一个表达式，则该表达式是文本框属性的值。</span><span class="sxs-lookup"><span data-stu-id="9f590-135">Typically, if a text box contains only one expression, the expression is the value of the text box property.</span></span> <span data-ttu-id="9f590-136">如果某一文本框包含多个表达式，则每个表达式都是该文本框中占位符文本的值。</span><span class="sxs-lookup"><span data-stu-id="9f590-136">If a text box contains multiple expressions, each expression is the value of placeholder text in the text box.</span></span>  

<span data-ttu-id="9f590-137">默认情况下，表达式作为“简单表达式” \*\* 或“复杂表达式” \*\* 出现在报表设计图面上。</span><span class="sxs-lookup"><span data-stu-id="9f590-137">By default, expressions appear on the report design surface as *simple* or *complex expressions*.</span></span>  

-   <span data-ttu-id="9f590-138">**简单** ：包含对内置集合中单个项（例如，数据集字段、参数或内置字段）的引用的简单表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-138">**Simple** A simple expression contains a reference to a single item in a built-in collection, for example, a dataset field, a parameter, or a built-in field.</span></span> <span data-ttu-id="9f590-139">在设计图面上，简单表达式将出现在括号中。</span><span class="sxs-lookup"><span data-stu-id="9f590-139">On the design surface, a simple expression appears in brackets.</span></span> <span data-ttu-id="9f590-140">例如， `[FieldName]` 将对应于基础表达式 `=Fields!FieldName.Value`。</span><span class="sxs-lookup"><span data-stu-id="9f590-140">For example, `[FieldName]` corresponds to the underlying expression `=Fields!FieldName.Value`.</span></span> <span data-ttu-id="9f590-141">当您创建报表布局并且将项从“报表数据”窗格拖到设计图面时，系统将自动为您创建简单表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-141">Simple expressions are created for you automatically as you create the report layout and drag items from the Report Data pane to the design surface.</span></span> <span data-ttu-id="9f590-142">有关表示不同内置集合的符号的详细信息，请参阅 [了解简单表达式中的前缀符号](#DisplayText)。</span><span class="sxs-lookup"><span data-stu-id="9f590-142">For more information about the symbols that represent different built-in collections, see [Understanding Prefix Symbols for Simple Expressions](#DisplayText).</span></span>  

-   <span data-ttu-id="9f590-143">**复杂** ：复杂表达式包含对多个内置引用、运算符和函数调用的引用。</span><span class="sxs-lookup"><span data-stu-id="9f590-143">**Complex** A complex expression contains references to multiple built-in references, operators, and function calls.</span></span> <span data-ttu-id="9f590-144">\<Expr>当表达式值包括多个简单引用时，复杂表达式显示为 <>。</span><span class="sxs-lookup"><span data-stu-id="9f590-144">A complex expression appears as <\<Expr>> when the expression value includes more than a simple reference.</span></span> <span data-ttu-id="9f590-145">若要查看表达式，请将鼠标指针悬停在表达式上并使用工具提示。</span><span class="sxs-lookup"><span data-stu-id="9f590-145">To view the expression, hover over it and use the tooltip.</span></span> <span data-ttu-id="9f590-146">若要编辑表达式，请在 **“表达式”** 对话框中打开它。</span><span class="sxs-lookup"><span data-stu-id="9f590-146">To edit the expression, open it in the **Expression** dialog box.</span></span>  

<span data-ttu-id="9f590-147">下图显示针对文本框和占位符文本的典型的简单和复杂表达式。</span><span class="sxs-lookup"><span data-stu-id="9f590-147">The following figure shows typical simple and complex expressions for both text boxes and placeholder text.</span></span>  

<span data-ttu-id="9f590-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span><span class="sxs-lookup"><span data-stu-id="9f590-148">![rs_ExpressionDefaultFormat](../media/rs-expressiondefaultformat.gif "rs_ExpressionDefaultFormat")</span></span>  

<span data-ttu-id="9f590-149">若要显示简单值而非表达式文本，请将格式设置应用于文本框或占位符文本。</span><span class="sxs-lookup"><span data-stu-id="9f590-149">To display sample values instead of text for expressions, apply formatting to the text box or placeholder text.</span></span> <span data-ttu-id="9f590-150">下图显示了切换为显示简单值的报表设计图面：</span><span class="sxs-lookup"><span data-stu-id="9f590-150">The following figure shows the report design surface toggled to show sample values:</span></span>  

<span data-ttu-id="9f590-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span><span class="sxs-lookup"><span data-stu-id="9f590-151">![rs_ExpressionSampleValuesFormat](../media/rs-expressionsamplevaluesformat.gif "rs_ExpressionSampleValuesFormat")</span></span>  

<span data-ttu-id="9f590-152">有关详细信息，请参阅 [设置文本和占位符的格式（报表生成器和 SSRS）](formatting-text-and-placeholders-report-builder-and-ssrs.md)的详细信息。</span><span class="sxs-lookup"><span data-stu-id="9f590-152">For more information, see [Formatting Text and Placeholders &#40;Report Builder and SSRS&#41;](formatting-text-and-placeholders-report-builder-and-ssrs.md).</span></span>  

## <a name="understanding-prefix-symbols-in-simple-expressions"></a><a name="DisplayText"></a> <span data-ttu-id="9f590-153">了解简单表达式中的前缀符号</span><span class="sxs-lookup"><span data-stu-id="9f590-153">Understanding Prefix Symbols in Simple Expressions</span></span>  

<span data-ttu-id="9f590-154">简单表达式使用符号来指示引用是指向字段、参数、内置集合还是指向 ReportItems 集合。</span><span class="sxs-lookup"><span data-stu-id="9f590-154">Simple expressions use symbols to indicate whether the reference is to a field, a parameter, a built-in collection, or the ReportItems collection.</span></span> <span data-ttu-id="9f590-155">下表显示了显示文本和表达式文本的示例：</span><span class="sxs-lookup"><span data-stu-id="9f590-155">The following table shows examples of display and expression text:</span></span>  

|<span data-ttu-id="9f590-156">项</span><span class="sxs-lookup"><span data-stu-id="9f590-156">Item</span></span>|<span data-ttu-id="9f590-157">显示文本示例</span><span class="sxs-lookup"><span data-stu-id="9f590-157">Display text example</span></span>|<span data-ttu-id="9f590-158">表达式文本示例</span><span class="sxs-lookup"><span data-stu-id="9f590-158">Expression text example</span></span>|  
|----------|--------------------------|-----------------------------|  
|<span data-ttu-id="9f590-159">数据集字段</span><span class="sxs-lookup"><span data-stu-id="9f590-159">Dataset fields</span></span>|`[Sales]`<br /><br /> `[SUM(Sales)]`<br /><br /> `[FIRST(Store)]`|`=Fields!Sales.Value`<br /><br /> `=Sum(Fields!Sales.Value)`<br /><br /> `=First(Fields!Store.Value)`|  
|<span data-ttu-id="9f590-160">报表参数</span><span class="sxs-lookup"><span data-stu-id="9f590-160">Report parameters</span></span>|`[@Param]`<br /><br /> `[@Param.Label]`|`=Parameters!Param.Value`<br /><br /> `=Parameters!Param.Label`|  
|<span data-ttu-id="9f590-161">内置字段</span><span class="sxs-lookup"><span data-stu-id="9f590-161">Built-in fields</span></span>|`[&ReportName]`|`=Globals!ReportName.Value`|  
|<span data-ttu-id="9f590-162">用于显示文本的文字字符</span><span class="sxs-lookup"><span data-stu-id="9f590-162">Literal characters used for display text</span></span>|`\[Sales\]`|`[Sales]`|  



##  <a name="writing-complex-expressions"></a><a name="References"></a><span data-ttu-id="9f590-163">编写复杂表达式</span><span class="sxs-lookup"><span data-stu-id="9f590-163">Writing Complex Expressions</span></span>  
<span data-ttu-id="9f590-164">表达式可包括对函数、运算符、常量、字段、参数、内置集合中的项以及对嵌入的自定义代码或自定义程序集的引用。</span><span class="sxs-lookup"><span data-stu-id="9f590-164">Expressions can include references to functions, operators, constants, fields, parameters, items from built-in collections, and to embedded custom code or custom assemblies.</span></span>  

> [!NOTE]
>  <span data-ttu-id="9f590-165">若要开发复杂表达式或使用自定义代码或自定义程序集的表达式，建议您使用 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的报表设计器。</span><span class="sxs-lookup"><span data-stu-id="9f590-165">To develop complex expressions or expressions that use custom code or custom assemblies, we recommend that you use Report Designer in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9f590-166">有关详细信息，请参阅 [报表设计器的表达式中的自定义代码和程序集引用 (SSRS)](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9f590-166">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  

<span data-ttu-id="9f590-167">下表列出了可以包含在表达式中的引用类型：</span><span class="sxs-lookup"><span data-stu-id="9f590-167">The following table lists the kinds of references you can include in an expression:</span></span>  

|<span data-ttu-id="9f590-168">参考</span><span class="sxs-lookup"><span data-stu-id="9f590-168">References</span></span>|<span data-ttu-id="9f590-169">说明</span><span class="sxs-lookup"><span data-stu-id="9f590-169">Description</span></span>|<span data-ttu-id="9f590-170">示例</span><span class="sxs-lookup"><span data-stu-id="9f590-170">Example</span></span>|  
|----------------|-----------------|-------------|  
|[<span data-ttu-id="9f590-171">常量</span><span class="sxs-lookup"><span data-stu-id="9f590-171">Constants</span></span>](expressions-report-builder-and-ssrs.md)|<span data-ttu-id="9f590-172">介绍能以交互方式访问需要常量值的属性（例如字体颜色）的常量。</span><span class="sxs-lookup"><span data-stu-id="9f590-172">Describes the constants you can access interactively for properties that require constant values, such as font colors.</span></span>|`="Blue"`|  
|[<span data-ttu-id="9f590-173">运算符</span><span class="sxs-lookup"><span data-stu-id="9f590-173">Operators</span></span>](operators-in-expressions-report-builder-and-ssrs.md)|<span data-ttu-id="9f590-174">描述可用于合并表达式中的引用的运算符。</span><span class="sxs-lookup"><span data-stu-id="9f590-174">Describes the operators you can use to combine references in an expression.</span></span> <span data-ttu-id="9f590-175">例如，`&` 运算符用于串联字符串。</span><span class="sxs-lookup"><span data-stu-id="9f590-175">For example, the `&` operator is used for concatenating strings.</span></span>|`="The report ran at: " & Globals!ExecutionTime & "."`|  
|[<span data-ttu-id="9f590-176">内置集合</span><span class="sxs-lookup"><span data-stu-id="9f590-176">Built-in Collections</span></span>](built-in-collections-in-expressions-report-builder.md)|<span data-ttu-id="9f590-177">介绍可在表达式中包含的内置集合，例如 `Fields`、 `Parameters`和 `Variables`。</span><span class="sxs-lookup"><span data-stu-id="9f590-177">Describes the built-in collections that you can include in an expression, such as `Fields`, `Parameters`, and `Variables`.</span></span>|`=Fields!Sales.Value`<br /><br /> `=Parameters!Store.Value`<br /><br /> `=Variables!MyCalculation.Value`|  
|[<span data-ttu-id="9f590-178">内置报表函数和聚合函数</span><span class="sxs-lookup"><span data-stu-id="9f590-178">Built-in Report and Aggregate Functions</span></span>](report-builder-functions-aggregate-functions-reference.md)|<span data-ttu-id="9f590-179">介绍可从表达式中访问的内置函数，例如 `Sum` 或 `Previous`。</span><span class="sxs-lookup"><span data-stu-id="9f590-179">Describes the built-in functions, such as `Sum` or `Previous`, that you can access from an expression.</span></span>|`=Previous(Sum(Fields!Sales.Value))`|  
|[<span data-ttu-id="9f590-180">报表设计器的表达式中的自定义代码和程序集引用 (SSRS)</span><span class="sxs-lookup"><span data-stu-id="9f590-180">Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;</span></span>](custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)|<span data-ttu-id="9f590-181">介绍如何访问内置 CLR 类 <xref:System.Math> 和 <xref:System.Convert>、其他 CLR 类、 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] 运行时库函数或外部程序集中的方法。</span><span class="sxs-lookup"><span data-stu-id="9f590-181">Describes how you can access the built-in CLR classes <xref:System.Math> and <xref:System.Convert>, other CLR classes, [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)] run-time library functions, or methods from an external assembly.</span></span><br /><br /> <span data-ttu-id="9f590-182">介绍如何访问嵌入在报表中的自定义代码或已编译成自定义程序集并安装在报表客户端和报表服务器上的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="9f590-182">Describes how you can access custom code that is embedded in your report, or that you compile and install as a custom assembly on both the report client and the report server.</span></span>|`=Sum(Fields!Sales.Value)`<br /><br /> `=CDate(Fields!SalesDate.Value)`<br /><br /> `=DateAdd("d",3,Fields!BirthDate.Value)`<br /><br /> `=Code.ToUSD(Fields!StandardCost.Value)`|  



##  <a name="validating-expressions"></a><a name="Valid"></a><span data-ttu-id="9f590-183">验证表达式</span><span class="sxs-lookup"><span data-stu-id="9f590-183">Validating Expressions</span></span>  
<span data-ttu-id="9f590-184">创建用于特定报表项属性的表达式时，可包含在表达式中的引用取决于该报表项属性可接受的值以及对属性进行求值的作用域。</span><span class="sxs-lookup"><span data-stu-id="9f590-184">When you create an expression for a specific report item property, the references that you can include in an expression depend on the values that the report item property can accept and the scope in which the property is evaluated.</span></span> <span data-ttu-id="9f590-185">例如：</span><span class="sxs-lookup"><span data-stu-id="9f590-185">For example:</span></span>  

-   <span data-ttu-id="9f590-186">默认情况下，在对表达式进行求值时表达式 [Sum] 计算处于作用域中的数据的和。</span><span class="sxs-lookup"><span data-stu-id="9f590-186">By default, the expression [Sum] calculates the sum of data that is in scope at the time the expression is evaluated.</span></span> <span data-ttu-id="9f590-187">对于表单元，该作用域依赖于行和列组成员资格。</span><span class="sxs-lookup"><span data-stu-id="9f590-187">For a table cell, the scope depends on row and column group memberships.</span></span> <span data-ttu-id="9f590-188">有关详细信息，请参阅 [总计、聚合和内置集合的表达式作用域（报表生成器和 SSRS）](expression-scope-for-totals-aggregates-and-built-in-collections.md)。</span><span class="sxs-lookup"><span data-stu-id="9f590-188">For more information, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  

-   <span data-ttu-id="9f590-189">对于 Font 属性的值，该值的计算结果必须为字体名称。</span><span class="sxs-lookup"><span data-stu-id="9f590-189">For the value for a Font property, the value must evaluate to the name of a font.</span></span>  

-   <span data-ttu-id="9f590-190">在设计时验证表达式语法。</span><span class="sxs-lookup"><span data-stu-id="9f590-190">Expression syntax is validated at design time.</span></span> <span data-ttu-id="9f590-191">在您发布报表时进行表达式作用域验证。</span><span class="sxs-lookup"><span data-stu-id="9f590-191">Expression scope validation occurs when you publish the report.</span></span> <span data-ttu-id="9f590-192">对于依赖于实际数据的验证，只能在运行时检测到错误。</span><span class="sxs-lookup"><span data-stu-id="9f590-192">For validation that depends on the actual data, errors can only be detected at run-time.</span></span> <span data-ttu-id="9f590-193">其中的某些表达式将生成 #Error 作为呈现的报表中的错误消息。</span><span class="sxs-lookup"><span data-stu-id="9f590-193">Some of these expressions produce #Error as an error message in the rendered report.</span></span> <span data-ttu-id="9f590-194">为了帮助确定此类型的错误问题，您必须使用 [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)]中的报表设计器。</span><span class="sxs-lookup"><span data-stu-id="9f590-194">To help determine the issues for this kind of error, you must use Report Designer in [!INCLUDE[ssBIDevStudioFull](../../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="9f590-195">报表设计器提供一个“输出”窗口，该窗口提供有关这些错误的详细信息。</span><span class="sxs-lookup"><span data-stu-id="9f590-195">Report Designer provides an Output window that provides more information about these errors.</span></span>  

<span data-ttu-id="9f590-196">有关详细信息，请参阅 [表达式引用（报表生成器和 SSRS）](expression-reference-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="9f590-196">For more information, see [Expression Reference &#40;Report Builder and SSRS&#41;](expression-reference-report-builder-and-ssrs.md).</span></span>  

## <a name="in-this-section"></a><a name="Section"></a> <span data-ttu-id="9f590-197">本节内容</span><span class="sxs-lookup"><span data-stu-id="9f590-197">In This Section</span></span>

[<span data-ttu-id="9f590-198">添加表达式（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-198">Add an Expression &#40;Report Builder and SSRS&#41;</span></span>](add-an-expression-report-builder-and-ssrs.md)  

[<span data-ttu-id="9f590-199">在报表中使用表达式（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-199">Expression Uses in Reports &#40;Report Builder and SSRS&#41;</span></span>](expression-uses-in-reports-report-builder-and-ssrs.md)  

[<span data-ttu-id="9f590-200">总计、聚合和内置集合的表达式作用域（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-200">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  

[<span data-ttu-id="9f590-201">表达式引用（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="9f590-201">Expression Reference &#40;Report Builder and SSRS&#41;</span></span>](expression-reference-report-builder-and-ssrs.md)  

## <a name="see-also"></a><span data-ttu-id="9f590-202">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9f590-202">See Also</span></span>

- [<span data-ttu-id="9f590-203">“表达式”对话框</span><span class="sxs-lookup"><span data-stu-id="9f590-203">Expression Dialog Box</span></span>](../expression-dialog-box.md)   
- [<span data-ttu-id="9f590-204">“表达式”对话框（报表生成器）</span><span class="sxs-lookup"><span data-stu-id="9f590-204">Expression Dialog Box &#40;Report Builder&#41;</span></span>](../expression-dialog-box-report-builder.md)