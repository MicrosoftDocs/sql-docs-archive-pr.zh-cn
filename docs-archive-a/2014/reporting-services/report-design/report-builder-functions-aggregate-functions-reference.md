---
title: 聚合函数参考（报表生成器和 SSRS）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: db6542ee-02d0-4073-90e6-cba8f9510fbb
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: b7c88935b303d36e73741bee17e966ec6616a030
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691604"
---
# <a name="aggregate-functions-reference-report-builder-and-ssrs"></a><span data-ttu-id="6679c-102">聚合函数引用（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="6679c-102">Aggregate Functions Reference (Report Builder and SSRS)</span></span>
  <span data-ttu-id="6679c-103">若要在报表中包含聚合值，您可以在表达式中使用内置聚合函数。</span><span class="sxs-lookup"><span data-stu-id="6679c-103">To include aggregated values in your report, you can use built-in aggregate functions in expressions.</span></span> <span data-ttu-id="6679c-104">数值字段的默认聚合函数是 SUM。</span><span class="sxs-lookup"><span data-stu-id="6679c-104">The default aggregate function for numeric fields is SUM.</span></span> <span data-ttu-id="6679c-105">您可以编辑表达式，并使用其他内置聚合函数或指定不同的作用域。</span><span class="sxs-lookup"><span data-stu-id="6679c-105">You can edit the expression and use a different built-in aggregate function or specify a different scope.</span></span> <span data-ttu-id="6679c-106">作用域标识要用于计算的一组数据。</span><span class="sxs-lookup"><span data-stu-id="6679c-106">Scope identifies which set of data to use for the calculation.</span></span>  
  
 <span data-ttu-id="6679c-107">当报表处理器将报表数据和报表布局组合在一起时，将计算每个报表项的表达式。</span><span class="sxs-lookup"><span data-stu-id="6679c-107">As the report processor combines report data and the report layout, the expressions for each report item are evaluated.</span></span> <span data-ttu-id="6679c-108">当您查看每个报表页时，您将会在呈现的报表项中看到每个表达式的结果。</span><span class="sxs-lookup"><span data-stu-id="6679c-108">As you view each page of the report, you see the results for each expression in the rendered report items.</span></span>  
  
 <span data-ttu-id="6679c-109">下表列出了您可以包括在表达式中的内置函数的类别：</span><span class="sxs-lookup"><span data-stu-id="6679c-109">The following table lists categories of built-in functions that you can include in an expression:</span></span>  
  
-   [<span data-ttu-id="6679c-110">内置聚合函数</span><span class="sxs-lookup"><span data-stu-id="6679c-110">Built-in Aggregate Functions</span></span>](#CalculatingAggregates)  
  
-   [<span data-ttu-id="6679c-111">对内置字段、集合和聚合函数的限制</span><span class="sxs-lookup"><span data-stu-id="6679c-111">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>](#Restrictions)  
  
-   [<span data-ttu-id="6679c-112">对嵌套聚合的限制</span><span class="sxs-lookup"><span data-stu-id="6679c-112">Restrictions on Nested Aggregates</span></span>](#NestedRestrictions)  
  
-   [<span data-ttu-id="6679c-113">计算运行值</span><span class="sxs-lookup"><span data-stu-id="6679c-113">Calculating Running Values</span></span>](#CalculatingRunningValues)  
  
-   [<span data-ttu-id="6679c-114">检索行计数</span><span class="sxs-lookup"><span data-stu-id="6679c-114">Retrieving Row Counts</span></span>](#RetrievingRowCounts)  
  
-   [<span data-ttu-id="6679c-115">从另一个数据集中查找值</span><span class="sxs-lookup"><span data-stu-id="6679c-115">Looking Up Values from Another Dataset</span></span>](#LookupFunctions)  
  
-   [<span data-ttu-id="6679c-116">检索依赖排序的值</span><span class="sxs-lookup"><span data-stu-id="6679c-116">Retrieving Sort-Dependent Values</span></span>](#RetrievingPostsortValues)  
  
-   [<span data-ttu-id="6679c-117">检索服务器聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-117">Retrieving Server Aggregates</span></span>](#RetrievingServerAggregates)  
  
-   [<span data-ttu-id="6679c-118">检索递归级别</span><span class="sxs-lookup"><span data-stu-id="6679c-118">Retrieving Recursive Level</span></span>](#RetrievingRecursiveLevel)  
  
-   [<span data-ttu-id="6679c-119">测试作用域</span><span class="sxs-lookup"><span data-stu-id="6679c-119">Testing for Scope</span></span>](#TestingforScope)  
  
 <span data-ttu-id="6679c-120">若要确定函数的有效作用域，请参阅各个函数参考主题。</span><span class="sxs-lookup"><span data-stu-id="6679c-120">To determine the valid scopes for a function, see the individual function reference topic.</span></span> <span data-ttu-id="6679c-121">有关详细信息和示例，请参阅 [总计、聚合和内置集合的表达式作用域（报表生成器和 SSRS）](expression-scope-for-totals-aggregates-and-built-in-collections.md)。</span><span class="sxs-lookup"><span data-stu-id="6679c-121">For more information and for examples, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="built-in-aggregate-functions"></a><a name="CalculatingAggregates"></a> <span data-ttu-id="6679c-122">内置聚合函数</span><span class="sxs-lookup"><span data-stu-id="6679c-122">Built-in Aggregate Functions</span></span>  
 <span data-ttu-id="6679c-123">下列内置函数为默认作用域或命名作用域中的一组非 Null 数值数据计算汇总值。</span><span class="sxs-lookup"><span data-stu-id="6679c-123">The following built-in functions calculate summary values for a set of non-null numeric data in the default scope or the named scope.</span></span>  
  
|<span data-ttu-id="6679c-124">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-124">**Function**</span></span>|<span data-ttu-id="6679c-125">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-125">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-126">Avg</span><span class="sxs-lookup"><span data-stu-id="6679c-126">Avg</span></span>](report-builder-functions-avg-function.md)|<span data-ttu-id="6679c-127">返回在给定作用域中计算的、由表达式指定的所有非 Null 数值的平均值。</span><span class="sxs-lookup"><span data-stu-id="6679c-127">Returns the average of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="6679c-128">Count</span><span class="sxs-lookup"><span data-stu-id="6679c-128">Count</span></span>](report-builder-functions-count-function.md)|<span data-ttu-id="6679c-129">返回在给定作用域上下文中计算的，由表达式指定的非 Null 值的计数。</span><span class="sxs-lookup"><span data-stu-id="6679c-129">Returns a count of non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="6679c-130">CountDistinct</span><span class="sxs-lookup"><span data-stu-id="6679c-130">CountDistinct</span></span>](report-builder-functions-countdistinct-function.md)|<span data-ttu-id="6679c-131">返回在给定作用域上下文中计算的，由表达式指定的所有非重复的非 Null 值计数。</span><span class="sxs-lookup"><span data-stu-id="6679c-131">Returns a count of all distinct non-null values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="6679c-132">Max</span><span class="sxs-lookup"><span data-stu-id="6679c-132">Max</span></span>](report-builder-functions-max-function.md)|<span data-ttu-id="6679c-133">返回在给定作用域上下文中由表达式指定的所有非 Null 数值的最大值。</span><span class="sxs-lookup"><span data-stu-id="6679c-133">Returns the maximum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="6679c-134">可以使用此函数指定图表轴最大值以控制刻度。</span><span class="sxs-lookup"><span data-stu-id="6679c-134">You can use this for specifying a chart axis maximum value to control the scale.</span></span>|  
|[<span data-ttu-id="6679c-135">Min</span><span class="sxs-lookup"><span data-stu-id="6679c-135">Min</span></span>](report-builder-functions-min-function.md)|<span data-ttu-id="6679c-136">返回在给定作用域上下文中由表达式指定的所有非 Null 数值的最小值。</span><span class="sxs-lookup"><span data-stu-id="6679c-136">Returns the minimum value of all non-null numeric values specified by the expression, in the context of the given scope.</span></span> <span data-ttu-id="6679c-137">可以使用此函数指定图表轴最小值以控制刻度。</span><span class="sxs-lookup"><span data-stu-id="6679c-137">You can use this for specifying a chart axis minimum value to control the scale.</span></span>|  
|[<span data-ttu-id="6679c-138">StDev</span><span class="sxs-lookup"><span data-stu-id="6679c-138">StDev</span></span>](report-builder-functions-stdev-function.md)|<span data-ttu-id="6679c-139">返回在给定作用域中计算的，由表达式指定的所有非 Null 数值的标准偏差。</span><span class="sxs-lookup"><span data-stu-id="6679c-139">Returns the standard deviation of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="6679c-140">StDevP</span><span class="sxs-lookup"><span data-stu-id="6679c-140">StDevP</span></span>](report-builder-functions-stdevp-function.md)|<span data-ttu-id="6679c-141">返回在给定作用域上下文中计算的，由表达式指定的所有非 Null 数值的总体标准偏差。</span><span class="sxs-lookup"><span data-stu-id="6679c-141">Returns the population standard deviation of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
|[<span data-ttu-id="6679c-142">Sum</span><span class="sxs-lookup"><span data-stu-id="6679c-142">Sum</span></span>](report-builder-functions-sum-function.md)|<span data-ttu-id="6679c-143">返回在给定作用域中计算的、由表达式指定的所有非 Null 数值的和。</span><span class="sxs-lookup"><span data-stu-id="6679c-143">Returns the sum of all the non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="6679c-144">Union</span><span class="sxs-lookup"><span data-stu-id="6679c-144">Union</span></span>](report-builder-functions-union-function.md)|<span data-ttu-id="6679c-145">返回在给定作用域中计算的、由表达式指定的 `SqlGeometry` 类型或 `SqlGeography` 类型的所有非 Null 的空间数据值的联合。</span><span class="sxs-lookup"><span data-stu-id="6679c-145">Returns the union of all the non-null spatial data values of type `SqlGeometry` or `SqlGeography` that are specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="6679c-146">Var</span><span class="sxs-lookup"><span data-stu-id="6679c-146">Var</span></span>](report-builder-functions-var-function.md)|<span data-ttu-id="6679c-147">返回在给定作用域中计算的，由表达式指定的所有非 Null 数值的方差。</span><span class="sxs-lookup"><span data-stu-id="6679c-147">Returns the variance of all non-null numeric values specified by the expression, evaluated in the given scope.</span></span>|  
|[<span data-ttu-id="6679c-148">VarP</span><span class="sxs-lookup"><span data-stu-id="6679c-148">VarP</span></span>](report-builder-functions-varp-function.md)|<span data-ttu-id="6679c-149">返回在给定作用域上下文中计算的、由表达式指定的所有非 Null 数值的总体方差。</span><span class="sxs-lookup"><span data-stu-id="6679c-149">Returns the population variance of all non-null numeric values specified by the expression, evaluated in the context of the given scope.</span></span>|  
  
##  <a name="restrictions-on-built-in-fields-collections-and-aggregate-functions"></a><a name="Restrictions"></a><span data-ttu-id="6679c-150">对内置字段、集合和聚合函数的限制</span><span class="sxs-lookup"><span data-stu-id="6679c-150">Restrictions on Built-in Fields, Collections, and Aggregate Functions</span></span>  
 <span data-ttu-id="6679c-151">下表汇总了可以在其中添加表达式（包含对全局内置集合的引用）的报表位置的限制。</span><span class="sxs-lookup"><span data-stu-id="6679c-151">The following table summarizes restrictions in report locations on where you can add expressions that contain references to global built-in collections.</span></span>  
  
|<span data-ttu-id="6679c-152">报表中的位置</span><span class="sxs-lookup"><span data-stu-id="6679c-152">Location in Report</span></span>|<span data-ttu-id="6679c-153">字段</span><span class="sxs-lookup"><span data-stu-id="6679c-153">Fields</span></span>|<span data-ttu-id="6679c-154">参数</span><span class="sxs-lookup"><span data-stu-id="6679c-154">Parameters</span></span>|<span data-ttu-id="6679c-155">ReportItems</span><span class="sxs-lookup"><span data-stu-id="6679c-155">ReportItems</span></span>|<span data-ttu-id="6679c-156">PageNumber</span><span class="sxs-lookup"><span data-stu-id="6679c-156">PageNumber</span></span><br /><br /> <span data-ttu-id="6679c-157">TotalPages</span><span class="sxs-lookup"><span data-stu-id="6679c-157">TotalPages</span></span>|<span data-ttu-id="6679c-158">数据源</span><span class="sxs-lookup"><span data-stu-id="6679c-158">DataSource</span></span><br /><br /> <span data-ttu-id="6679c-159">数据集</span><span class="sxs-lookup"><span data-stu-id="6679c-159">DataSet</span></span>|<span data-ttu-id="6679c-160">变量</span><span class="sxs-lookup"><span data-stu-id="6679c-160">Variables</span></span>|<span data-ttu-id="6679c-161">RenderFormat</span><span class="sxs-lookup"><span data-stu-id="6679c-161">RenderFormat</span></span>|  
|------------------------|------------|----------------|-----------------|-------------------------------|----------------------------|---------------|------------------|  
|<span data-ttu-id="6679c-162">页眉</span><span class="sxs-lookup"><span data-stu-id="6679c-162">Page Header</span></span><br /><br /> <span data-ttu-id="6679c-163">页脚</span><span class="sxs-lookup"><span data-stu-id="6679c-163">Page Footer</span></span>|<span data-ttu-id="6679c-164">是</span><span class="sxs-lookup"><span data-stu-id="6679c-164">Yes</span></span>|<span data-ttu-id="6679c-165">是</span><span class="sxs-lookup"><span data-stu-id="6679c-165">Yes</span></span>|<span data-ttu-id="6679c-166">最多一个</span><span class="sxs-lookup"><span data-stu-id="6679c-166">At most one</span></span><br /><br /> <span data-ttu-id="6679c-167">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-167">Note 1</span></span>|<span data-ttu-id="6679c-168">是</span><span class="sxs-lookup"><span data-stu-id="6679c-168">Yes</span></span>|<span data-ttu-id="6679c-169">是</span><span class="sxs-lookup"><span data-stu-id="6679c-169">Yes</span></span>|<span data-ttu-id="6679c-170">是</span><span class="sxs-lookup"><span data-stu-id="6679c-170">Yes</span></span>|<span data-ttu-id="6679c-171">是</span><span class="sxs-lookup"><span data-stu-id="6679c-171">Yes</span></span>|  
|<span data-ttu-id="6679c-172">正文</span><span class="sxs-lookup"><span data-stu-id="6679c-172">Body</span></span>|<span data-ttu-id="6679c-173">是</span><span class="sxs-lookup"><span data-stu-id="6679c-173">Yes</span></span><br /><br /> <span data-ttu-id="6679c-174">注释 2</span><span class="sxs-lookup"><span data-stu-id="6679c-174">Note 2</span></span>|<span data-ttu-id="6679c-175">是</span><span class="sxs-lookup"><span data-stu-id="6679c-175">Yes</span></span>|<span data-ttu-id="6679c-176">仅限当前作用域或包含作用域中的项</span><span class="sxs-lookup"><span data-stu-id="6679c-176">Only items in the currnet scope or a containing scope</span></span><br /><br /> <span data-ttu-id="6679c-177">注释 3</span><span class="sxs-lookup"><span data-stu-id="6679c-177">Note 3</span></span>|<span data-ttu-id="6679c-178">否</span><span class="sxs-lookup"><span data-stu-id="6679c-178">No</span></span>|<span data-ttu-id="6679c-179">是</span><span class="sxs-lookup"><span data-stu-id="6679c-179">Yes</span></span>|<span data-ttu-id="6679c-180">是</span><span class="sxs-lookup"><span data-stu-id="6679c-180">Yes</span></span>|<span data-ttu-id="6679c-181">是</span><span class="sxs-lookup"><span data-stu-id="6679c-181">Yes</span></span>|  
|<span data-ttu-id="6679c-182">报表参数</span><span class="sxs-lookup"><span data-stu-id="6679c-182">Report Parameter</span></span>|<span data-ttu-id="6679c-183">否</span><span class="sxs-lookup"><span data-stu-id="6679c-183">No</span></span>|<span data-ttu-id="6679c-184">仅限列表中前面的参数</span><span class="sxs-lookup"><span data-stu-id="6679c-184">Only parameters earlier in the list</span></span><br /><br /> <span data-ttu-id="6679c-185">注释 4</span><span class="sxs-lookup"><span data-stu-id="6679c-185">Note 4</span></span>|<span data-ttu-id="6679c-186">否</span><span class="sxs-lookup"><span data-stu-id="6679c-186">No</span></span>|<span data-ttu-id="6679c-187">否</span><span class="sxs-lookup"><span data-stu-id="6679c-187">No</span></span>|<span data-ttu-id="6679c-188">否</span><span class="sxs-lookup"><span data-stu-id="6679c-188">No</span></span>|<span data-ttu-id="6679c-189">否</span><span class="sxs-lookup"><span data-stu-id="6679c-189">No</span></span>|<span data-ttu-id="6679c-190">否</span><span class="sxs-lookup"><span data-stu-id="6679c-190">No</span></span>|  
|<span data-ttu-id="6679c-191">字段</span><span class="sxs-lookup"><span data-stu-id="6679c-191">Field</span></span>|<span data-ttu-id="6679c-192">是</span><span class="sxs-lookup"><span data-stu-id="6679c-192">Yes</span></span>|<span data-ttu-id="6679c-193">是</span><span class="sxs-lookup"><span data-stu-id="6679c-193">Yes</span></span>|<span data-ttu-id="6679c-194">否</span><span class="sxs-lookup"><span data-stu-id="6679c-194">No</span></span>|<span data-ttu-id="6679c-195">否</span><span class="sxs-lookup"><span data-stu-id="6679c-195">No</span></span>|<span data-ttu-id="6679c-196">否</span><span class="sxs-lookup"><span data-stu-id="6679c-196">No</span></span>|<span data-ttu-id="6679c-197">否</span><span class="sxs-lookup"><span data-stu-id="6679c-197">No</span></span>|<span data-ttu-id="6679c-198">否</span><span class="sxs-lookup"><span data-stu-id="6679c-198">No</span></span>|  
|<span data-ttu-id="6679c-199">查询参数</span><span class="sxs-lookup"><span data-stu-id="6679c-199">Query Parameter</span></span>|<span data-ttu-id="6679c-200">否</span><span class="sxs-lookup"><span data-stu-id="6679c-200">No</span></span>|<span data-ttu-id="6679c-201">是</span><span class="sxs-lookup"><span data-stu-id="6679c-201">Yes</span></span>|<span data-ttu-id="6679c-202">否</span><span class="sxs-lookup"><span data-stu-id="6679c-202">No</span></span>|<span data-ttu-id="6679c-203">否</span><span class="sxs-lookup"><span data-stu-id="6679c-203">No</span></span>|<span data-ttu-id="6679c-204">否</span><span class="sxs-lookup"><span data-stu-id="6679c-204">No</span></span>|<span data-ttu-id="6679c-205">否</span><span class="sxs-lookup"><span data-stu-id="6679c-205">No</span></span>|<span data-ttu-id="6679c-206">否</span><span class="sxs-lookup"><span data-stu-id="6679c-206">No</span></span>|  
|<span data-ttu-id="6679c-207">组表达式</span><span class="sxs-lookup"><span data-stu-id="6679c-207">Group Expression</span></span>|<span data-ttu-id="6679c-208">是</span><span class="sxs-lookup"><span data-stu-id="6679c-208">Yes</span></span>|<span data-ttu-id="6679c-209">是</span><span class="sxs-lookup"><span data-stu-id="6679c-209">Yes</span></span>|<span data-ttu-id="6679c-210">否</span><span class="sxs-lookup"><span data-stu-id="6679c-210">No</span></span>|<span data-ttu-id="6679c-211">否</span><span class="sxs-lookup"><span data-stu-id="6679c-211">No</span></span>|<span data-ttu-id="6679c-212">是</span><span class="sxs-lookup"><span data-stu-id="6679c-212">Yes</span></span>|<span data-ttu-id="6679c-213">否</span><span class="sxs-lookup"><span data-stu-id="6679c-213">No</span></span>|<span data-ttu-id="6679c-214">否</span><span class="sxs-lookup"><span data-stu-id="6679c-214">No</span></span>|  
|<span data-ttu-id="6679c-215">排序表达式</span><span class="sxs-lookup"><span data-stu-id="6679c-215">Sort Expression</span></span>|<span data-ttu-id="6679c-216">是</span><span class="sxs-lookup"><span data-stu-id="6679c-216">Yes</span></span>|<span data-ttu-id="6679c-217">是</span><span class="sxs-lookup"><span data-stu-id="6679c-217">Yes</span></span>|<span data-ttu-id="6679c-218">否</span><span class="sxs-lookup"><span data-stu-id="6679c-218">No</span></span>|<span data-ttu-id="6679c-219">否</span><span class="sxs-lookup"><span data-stu-id="6679c-219">No</span></span>|<span data-ttu-id="6679c-220">是</span><span class="sxs-lookup"><span data-stu-id="6679c-220">Yes</span></span>|<span data-ttu-id="6679c-221">是</span><span class="sxs-lookup"><span data-stu-id="6679c-221">Yes</span></span><br /><br /> <span data-ttu-id="6679c-222">注释 5</span><span class="sxs-lookup"><span data-stu-id="6679c-222">Note 5</span></span>|<span data-ttu-id="6679c-223">否</span><span class="sxs-lookup"><span data-stu-id="6679c-223">No</span></span>|  
|<span data-ttu-id="6679c-224">筛选表达式</span><span class="sxs-lookup"><span data-stu-id="6679c-224">Filter Expression</span></span>|<span data-ttu-id="6679c-225">是</span><span class="sxs-lookup"><span data-stu-id="6679c-225">Yes</span></span>|<span data-ttu-id="6679c-226">是</span><span class="sxs-lookup"><span data-stu-id="6679c-226">Yes</span></span>|<span data-ttu-id="6679c-227">否</span><span class="sxs-lookup"><span data-stu-id="6679c-227">No</span></span>|<span data-ttu-id="6679c-228">否</span><span class="sxs-lookup"><span data-stu-id="6679c-228">No</span></span>|<span data-ttu-id="6679c-229">是</span><span class="sxs-lookup"><span data-stu-id="6679c-229">Yes</span></span>|<span data-ttu-id="6679c-230">是</span><span class="sxs-lookup"><span data-stu-id="6679c-230">Yes</span></span><br /><br /> <span data-ttu-id="6679c-231">注释 6</span><span class="sxs-lookup"><span data-stu-id="6679c-231">Note 6</span></span>|<span data-ttu-id="6679c-232">否</span><span class="sxs-lookup"><span data-stu-id="6679c-232">No</span></span>|  
|<span data-ttu-id="6679c-233">代码</span><span class="sxs-lookup"><span data-stu-id="6679c-233">Code</span></span>|<span data-ttu-id="6679c-234">否</span><span class="sxs-lookup"><span data-stu-id="6679c-234">No</span></span>|<span data-ttu-id="6679c-235">是</span><span class="sxs-lookup"><span data-stu-id="6679c-235">Yes</span></span><br /><br /> <span data-ttu-id="6679c-236">注释 7</span><span class="sxs-lookup"><span data-stu-id="6679c-236">Note 7</span></span>|<span data-ttu-id="6679c-237">否</span><span class="sxs-lookup"><span data-stu-id="6679c-237">No</span></span>|<span data-ttu-id="6679c-238">否</span><span class="sxs-lookup"><span data-stu-id="6679c-238">No</span></span>|<span data-ttu-id="6679c-239">否</span><span class="sxs-lookup"><span data-stu-id="6679c-239">No</span></span>|<span data-ttu-id="6679c-240">否</span><span class="sxs-lookup"><span data-stu-id="6679c-240">No</span></span>|<span data-ttu-id="6679c-241">否</span><span class="sxs-lookup"><span data-stu-id="6679c-241">No</span></span>|  
|<span data-ttu-id="6679c-242">报表语言</span><span class="sxs-lookup"><span data-stu-id="6679c-242">Report.Language</span></span>|<span data-ttu-id="6679c-243">否</span><span class="sxs-lookup"><span data-stu-id="6679c-243">No</span></span>|<span data-ttu-id="6679c-244">是</span><span class="sxs-lookup"><span data-stu-id="6679c-244">Yes</span></span>|<span data-ttu-id="6679c-245">否</span><span class="sxs-lookup"><span data-stu-id="6679c-245">No</span></span>|<span data-ttu-id="6679c-246">否</span><span class="sxs-lookup"><span data-stu-id="6679c-246">No</span></span>|<span data-ttu-id="6679c-247">否</span><span class="sxs-lookup"><span data-stu-id="6679c-247">No</span></span>|<span data-ttu-id="6679c-248">否</span><span class="sxs-lookup"><span data-stu-id="6679c-248">No</span></span>|<span data-ttu-id="6679c-249">否</span><span class="sxs-lookup"><span data-stu-id="6679c-249">No</span></span>|  
|<span data-ttu-id="6679c-250">变量</span><span class="sxs-lookup"><span data-stu-id="6679c-250">Variables</span></span>|<span data-ttu-id="6679c-251">是</span><span class="sxs-lookup"><span data-stu-id="6679c-251">Yes</span></span>|<span data-ttu-id="6679c-252">是</span><span class="sxs-lookup"><span data-stu-id="6679c-252">Yes</span></span>|<span data-ttu-id="6679c-253">否</span><span class="sxs-lookup"><span data-stu-id="6679c-253">No</span></span>|<span data-ttu-id="6679c-254">否</span><span class="sxs-lookup"><span data-stu-id="6679c-254">No</span></span>|<span data-ttu-id="6679c-255">是</span><span class="sxs-lookup"><span data-stu-id="6679c-255">Yes</span></span>|<span data-ttu-id="6679c-256">当前作用域或包含作用域</span><span class="sxs-lookup"><span data-stu-id="6679c-256">Current or containing scope</span></span>|<span data-ttu-id="6679c-257">否</span><span class="sxs-lookup"><span data-stu-id="6679c-257">No</span></span>|  
|<span data-ttu-id="6679c-258">聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-258">Aggregates</span></span>|<span data-ttu-id="6679c-259">是</span><span class="sxs-lookup"><span data-stu-id="6679c-259">Yes</span></span>|<span data-ttu-id="6679c-260">是</span><span class="sxs-lookup"><span data-stu-id="6679c-260">Yes</span></span>|<span data-ttu-id="6679c-261">仅在页眉/页脚中</span><span class="sxs-lookup"><span data-stu-id="6679c-261">Only in page header/page footer</span></span>|<span data-ttu-id="6679c-262">仅在报表项聚合中</span><span class="sxs-lookup"><span data-stu-id="6679c-262">Only in report item aggregates</span></span>|<span data-ttu-id="6679c-263">是</span><span class="sxs-lookup"><span data-stu-id="6679c-263">Yes</span></span>|<span data-ttu-id="6679c-264">否</span><span class="sxs-lookup"><span data-stu-id="6679c-264">No</span></span>|<span data-ttu-id="6679c-265">否</span><span class="sxs-lookup"><span data-stu-id="6679c-265">No</span></span>|  
|<span data-ttu-id="6679c-266">Lookup 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-266">Lookup functions</span></span>|<span data-ttu-id="6679c-267">是</span><span class="sxs-lookup"><span data-stu-id="6679c-267">Yes</span></span>|<span data-ttu-id="6679c-268">是</span><span class="sxs-lookup"><span data-stu-id="6679c-268">Yes</span></span>|<span data-ttu-id="6679c-269">是</span><span class="sxs-lookup"><span data-stu-id="6679c-269">Yes</span></span>|<span data-ttu-id="6679c-270">否</span><span class="sxs-lookup"><span data-stu-id="6679c-270">No</span></span>|<span data-ttu-id="6679c-271">是</span><span class="sxs-lookup"><span data-stu-id="6679c-271">Yes</span></span>|<span data-ttu-id="6679c-272">否</span><span class="sxs-lookup"><span data-stu-id="6679c-272">No</span></span>|<span data-ttu-id="6679c-273">否</span><span class="sxs-lookup"><span data-stu-id="6679c-273">No</span></span>|  
  
-   <span data-ttu-id="6679c-274">**备注1。**</span><span class="sxs-lookup"><span data-stu-id="6679c-274">**Note 1.**</span></span> <span data-ttu-id="6679c-275">ReportItems 必须存在于呈现的报表页中，否则其值为 Null。</span><span class="sxs-lookup"><span data-stu-id="6679c-275">ReportItems must exist in the rendered report page, or their value is Null.</span></span> <span data-ttu-id="6679c-276">如果报表项的可见性取决于计算结果为 False 的表达式，则该页不存在此报表项。</span><span class="sxs-lookup"><span data-stu-id="6679c-276">If the visibility of a report item depends on an expression that evaluates to False, the report item does not exist on the page.</span></span>  
  
-   <span data-ttu-id="6679c-277">**备注2。**</span><span class="sxs-lookup"><span data-stu-id="6679c-277">**Note 2.**</span></span> <span data-ttu-id="6679c-278">如果在组作用域中使用了字段引用，并且该字段引用不包含在组表达式中，则未定义该字段的值，除非在该作用域中只有一个值。</span><span class="sxs-lookup"><span data-stu-id="6679c-278">If a field reference is used in a group scope, and the field reference is not included in the group expression, then the value for the field is undefined, unless there is only one value in the scope.</span></span> <span data-ttu-id="6679c-279">若要指定值，请使用“First”或“Last”以及组作用域。</span><span class="sxs-lookup"><span data-stu-id="6679c-279">To specify a value, use First or Last and the group scope.</span></span>  
  
-   <span data-ttu-id="6679c-280">**备注3。**</span><span class="sxs-lookup"><span data-stu-id="6679c-280">**Note 3.**</span></span> <span data-ttu-id="6679c-281">包含对 ReportItems 的引用的表达式可以为相同组作用域或包含组作用域中的其他 ReportItems 指定值。</span><span class="sxs-lookup"><span data-stu-id="6679c-281">Expressions that include a reference to ReportItems can specify values for other ReportItems in the same group scope or in a containing group scope.</span></span>  
  
-   <span data-ttu-id="6679c-282">**注释 4。**</span><span class="sxs-lookup"><span data-stu-id="6679c-282">**Note 4.**</span></span> <span data-ttu-id="6679c-283">前面参数的属性值可能为 Null。</span><span class="sxs-lookup"><span data-stu-id="6679c-283">Property values for earlier parameters might be null.</span></span>  
  
-   <span data-ttu-id="6679c-284">**备注5。**</span><span class="sxs-lookup"><span data-stu-id="6679c-284">**Note 5.**</span></span> <span data-ttu-id="6679c-285">仅在成员排序中使用。</span><span class="sxs-lookup"><span data-stu-id="6679c-285">In Member sorts only.</span></span> <span data-ttu-id="6679c-286">不能在数据区域排序表达式中使用。</span><span class="sxs-lookup"><span data-stu-id="6679c-286">Cannot use in data region sort expressions.</span></span>  
  
-   <span data-ttu-id="6679c-287">**注释 6。**</span><span class="sxs-lookup"><span data-stu-id="6679c-287">**Note 6.**</span></span> <span data-ttu-id="6679c-288">仅在成员筛选器中使用。</span><span class="sxs-lookup"><span data-stu-id="6679c-288">In Member filters only.</span></span> <span data-ttu-id="6679c-289">不能在数据区域或数据集筛选表达式中使用。</span><span class="sxs-lookup"><span data-stu-id="6679c-289">Cannot use in data region or dataset filter expressions.</span></span>  
  
-   <span data-ttu-id="6679c-290">**注释 7。**</span><span class="sxs-lookup"><span data-stu-id="6679c-290">**Note 7.**</span></span> <span data-ttu-id="6679c-291">处理代码块后，才可以初始化参数集合，因此，这些方法不能用于控制初始化上的参数。</span><span class="sxs-lookup"><span data-stu-id="6679c-291">The Parameters collection is not initialized until after the Code block is processed, so methods cannot be used to control parameters on initialization.</span></span>  
  
-   <span data-ttu-id="6679c-292">**注释 8。**</span><span class="sxs-lookup"><span data-stu-id="6679c-292">**Note 8.**</span></span> <span data-ttu-id="6679c-293">除 Count 和 CountDistinct 之外的所有聚合数据类型都必须为相同的数据类型或者所有值都为 null。</span><span class="sxs-lookup"><span data-stu-id="6679c-293">Data type for all aggregates except Count and CountDistinct must be the same data type, or null, for all values.</span></span>  
  
##  <a name="restrictions-on-nested-aggregates"></a><a name="NestedRestrictions"></a> <span data-ttu-id="6679c-294">对嵌套聚合的限制</span><span class="sxs-lookup"><span data-stu-id="6679c-294">Restrictions on Nested Aggregates</span></span>  
 <span data-ttu-id="6679c-295">下表汇总了对可以将其他聚合函数指定为嵌套函数的聚合函数的限制。</span><span class="sxs-lookup"><span data-stu-id="6679c-295">The following table summarizes restrictions on which aggregates functions can specify other aggregate functions as nested aggregates.</span></span>  
  
|<span data-ttu-id="6679c-296">上下文</span><span class="sxs-lookup"><span data-stu-id="6679c-296">Context</span></span>|<span data-ttu-id="6679c-297">RunningValue</span><span class="sxs-lookup"><span data-stu-id="6679c-297">RunningValue</span></span>|<span data-ttu-id="6679c-298">RowNumber</span><span class="sxs-lookup"><span data-stu-id="6679c-298">RowNumber</span></span>|<span data-ttu-id="6679c-299">First</span><span class="sxs-lookup"><span data-stu-id="6679c-299">First</span></span><br /><br /> <span data-ttu-id="6679c-300">上一个</span><span class="sxs-lookup"><span data-stu-id="6679c-300">Last</span></span>|<span data-ttu-id="6679c-301">上一篇</span><span class="sxs-lookup"><span data-stu-id="6679c-301">Previous</span></span>|<span data-ttu-id="6679c-302">Sum 和其他预排序函数</span><span class="sxs-lookup"><span data-stu-id="6679c-302">Sum and Other Presort functions</span></span>|<span data-ttu-id="6679c-303">ReportItem 聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-303">ReportItem aggregates</span></span>|<span data-ttu-id="6679c-304">Lookup 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-304">Lookup functions</span></span>|<span data-ttu-id="6679c-305">Aggregate 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-305">Aggregate Function</span></span>|  
|-------------|------------------|---------------|--------------------|--------------|-------------------------------------|---------------------------|----------------------|------------------------|  
|<span data-ttu-id="6679c-306">运行值</span><span class="sxs-lookup"><span data-stu-id="6679c-306">Running Value</span></span>|<span data-ttu-id="6679c-307">否</span><span class="sxs-lookup"><span data-stu-id="6679c-307">No</span></span>|<span data-ttu-id="6679c-308">否</span><span class="sxs-lookup"><span data-stu-id="6679c-308">No</span></span>|<span data-ttu-id="6679c-309">否</span><span class="sxs-lookup"><span data-stu-id="6679c-309">No</span></span>|<span data-ttu-id="6679c-310">否</span><span class="sxs-lookup"><span data-stu-id="6679c-310">No</span></span>|<span data-ttu-id="6679c-311">是</span><span class="sxs-lookup"><span data-stu-id="6679c-311">Yes</span></span>|<span data-ttu-id="6679c-312">否</span><span class="sxs-lookup"><span data-stu-id="6679c-312">No</span></span>|<span data-ttu-id="6679c-313">是</span><span class="sxs-lookup"><span data-stu-id="6679c-313">Yes</span></span>|<span data-ttu-id="6679c-314">否</span><span class="sxs-lookup"><span data-stu-id="6679c-314">No</span></span>|  
|<span data-ttu-id="6679c-315">First</span><span class="sxs-lookup"><span data-stu-id="6679c-315">First</span></span><br /><br /> <span data-ttu-id="6679c-316">上一个</span><span class="sxs-lookup"><span data-stu-id="6679c-316">Last</span></span>|<span data-ttu-id="6679c-317">否</span><span class="sxs-lookup"><span data-stu-id="6679c-317">No</span></span>|<span data-ttu-id="6679c-318">否</span><span class="sxs-lookup"><span data-stu-id="6679c-318">No</span></span>|<span data-ttu-id="6679c-319">否</span><span class="sxs-lookup"><span data-stu-id="6679c-319">No</span></span>|<span data-ttu-id="6679c-320">否</span><span class="sxs-lookup"><span data-stu-id="6679c-320">No</span></span>|<span data-ttu-id="6679c-321">是</span><span class="sxs-lookup"><span data-stu-id="6679c-321">Yes</span></span>|<span data-ttu-id="6679c-322">否</span><span class="sxs-lookup"><span data-stu-id="6679c-322">No</span></span>|<span data-ttu-id="6679c-323">否</span><span class="sxs-lookup"><span data-stu-id="6679c-323">No</span></span>|<span data-ttu-id="6679c-324">否</span><span class="sxs-lookup"><span data-stu-id="6679c-324">No</span></span>|  
|<span data-ttu-id="6679c-325">上一篇</span><span class="sxs-lookup"><span data-stu-id="6679c-325">Previous</span></span>|<span data-ttu-id="6679c-326">是</span><span class="sxs-lookup"><span data-stu-id="6679c-326">Yes</span></span>|<span data-ttu-id="6679c-327">是</span><span class="sxs-lookup"><span data-stu-id="6679c-327">Yes</span></span>|<span data-ttu-id="6679c-328">是</span><span class="sxs-lookup"><span data-stu-id="6679c-328">Yes</span></span>|<span data-ttu-id="6679c-329">否</span><span class="sxs-lookup"><span data-stu-id="6679c-329">No</span></span>|<span data-ttu-id="6679c-330">是</span><span class="sxs-lookup"><span data-stu-id="6679c-330">Yes</span></span>|<span data-ttu-id="6679c-331">否</span><span class="sxs-lookup"><span data-stu-id="6679c-331">No</span></span>|<span data-ttu-id="6679c-332">是</span><span class="sxs-lookup"><span data-stu-id="6679c-332">Yes</span></span>|<span data-ttu-id="6679c-333">否</span><span class="sxs-lookup"><span data-stu-id="6679c-333">No</span></span>|  
|<span data-ttu-id="6679c-334">Sum 和其他预排序函数</span><span class="sxs-lookup"><span data-stu-id="6679c-334">Sum and other Presort functions</span></span>|<span data-ttu-id="6679c-335">否</span><span class="sxs-lookup"><span data-stu-id="6679c-335">No</span></span>|<span data-ttu-id="6679c-336">否</span><span class="sxs-lookup"><span data-stu-id="6679c-336">No</span></span>|<span data-ttu-id="6679c-337">否</span><span class="sxs-lookup"><span data-stu-id="6679c-337">No</span></span>|<span data-ttu-id="6679c-338">否</span><span class="sxs-lookup"><span data-stu-id="6679c-338">No</span></span>|<span data-ttu-id="6679c-339">是</span><span class="sxs-lookup"><span data-stu-id="6679c-339">Yes</span></span>|<span data-ttu-id="6679c-340">否</span><span class="sxs-lookup"><span data-stu-id="6679c-340">No</span></span>|<span data-ttu-id="6679c-341">是</span><span class="sxs-lookup"><span data-stu-id="6679c-341">Yes</span></span>|<span data-ttu-id="6679c-342">否</span><span class="sxs-lookup"><span data-stu-id="6679c-342">No</span></span>|  
|<span data-ttu-id="6679c-343">ReportItem 聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-343">ReportItem aggregates</span></span>|<span data-ttu-id="6679c-344">否</span><span class="sxs-lookup"><span data-stu-id="6679c-344">No</span></span>|<span data-ttu-id="6679c-345">否</span><span class="sxs-lookup"><span data-stu-id="6679c-345">No</span></span>|<span data-ttu-id="6679c-346">否</span><span class="sxs-lookup"><span data-stu-id="6679c-346">No</span></span>|<span data-ttu-id="6679c-347">否</span><span class="sxs-lookup"><span data-stu-id="6679c-347">No</span></span>|<span data-ttu-id="6679c-348">否</span><span class="sxs-lookup"><span data-stu-id="6679c-348">No</span></span>|<span data-ttu-id="6679c-349">否</span><span class="sxs-lookup"><span data-stu-id="6679c-349">No</span></span>|<span data-ttu-id="6679c-350">否</span><span class="sxs-lookup"><span data-stu-id="6679c-350">No</span></span>|<span data-ttu-id="6679c-351">否</span><span class="sxs-lookup"><span data-stu-id="6679c-351">No</span></span>|  
|<span data-ttu-id="6679c-352">Lookup 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-352">Lookup functions</span></span>|<span data-ttu-id="6679c-353">是</span><span class="sxs-lookup"><span data-stu-id="6679c-353">Yes</span></span>|<span data-ttu-id="6679c-354">是</span><span class="sxs-lookup"><span data-stu-id="6679c-354">Yes</span></span><br /><br /> <span data-ttu-id="6679c-355">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-355">Note 1</span></span>|<span data-ttu-id="6679c-356">是</span><span class="sxs-lookup"><span data-stu-id="6679c-356">Yes</span></span><br /><br /> <span data-ttu-id="6679c-357">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-357">Note 1</span></span>|<span data-ttu-id="6679c-358">是</span><span class="sxs-lookup"><span data-stu-id="6679c-358">Yes</span></span><br /><br /> <span data-ttu-id="6679c-359">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-359">Note 1</span></span>|<span data-ttu-id="6679c-360">是</span><span class="sxs-lookup"><span data-stu-id="6679c-360">Yes</span></span><br /><br /> <span data-ttu-id="6679c-361">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-361">Note 1</span></span>|<span data-ttu-id="6679c-362">是</span><span class="sxs-lookup"><span data-stu-id="6679c-362">Yes</span></span><br /><br /> <span data-ttu-id="6679c-363">注释 1</span><span class="sxs-lookup"><span data-stu-id="6679c-363">Note 1</span></span>|<span data-ttu-id="6679c-364">否</span><span class="sxs-lookup"><span data-stu-id="6679c-364">No</span></span>|<span data-ttu-id="6679c-365">否</span><span class="sxs-lookup"><span data-stu-id="6679c-365">No</span></span>|  
|<span data-ttu-id="6679c-366">Aggregate 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-366">Aggregate Function</span></span>|<span data-ttu-id="6679c-367">否</span><span class="sxs-lookup"><span data-stu-id="6679c-367">No</span></span>|<span data-ttu-id="6679c-368">否</span><span class="sxs-lookup"><span data-stu-id="6679c-368">No</span></span>|<span data-ttu-id="6679c-369">否</span><span class="sxs-lookup"><span data-stu-id="6679c-369">No</span></span>|<span data-ttu-id="6679c-370">否</span><span class="sxs-lookup"><span data-stu-id="6679c-370">No</span></span>|<span data-ttu-id="6679c-371">否</span><span class="sxs-lookup"><span data-stu-id="6679c-371">No</span></span>|<span data-ttu-id="6679c-372">否</span><span class="sxs-lookup"><span data-stu-id="6679c-372">No</span></span>|<span data-ttu-id="6679c-373">否</span><span class="sxs-lookup"><span data-stu-id="6679c-373">No</span></span>|<span data-ttu-id="6679c-374">否</span><span class="sxs-lookup"><span data-stu-id="6679c-374">No</span></span>|  
  
-   <span data-ttu-id="6679c-375">**备注1。**</span><span class="sxs-lookup"><span data-stu-id="6679c-375">**Note 1.**</span></span> <span data-ttu-id="6679c-376">如果 Lookup 函数未包含在聚合中，则聚合函数仅适用于 Lookup 函数的 *Source* 表达式中。</span><span class="sxs-lookup"><span data-stu-id="6679c-376">Aggregate functions are only allowed inside the *Source* expression of a Lookup function if the Lookup function is not contained in an aggregate.</span></span> <span data-ttu-id="6679c-377">聚合函数不适用于 Lookup 函数的 *Destination* 表达式或 *Result* 表达式中。</span><span class="sxs-lookup"><span data-stu-id="6679c-377">Aggregate functions are not allowed inside the *Destination* or *Result* expressions of a Lookup function.</span></span>  
  
##  <a name="calculating-running-values"></a><a name="CalculatingRunningValues"></a><span data-ttu-id="6679c-378">计算运行值</span><span class="sxs-lookup"><span data-stu-id="6679c-378">Calculating Running Values</span></span>  
 <span data-ttu-id="6679c-379">以下内置函数计算一组数据的运行值。</span><span class="sxs-lookup"><span data-stu-id="6679c-379">The following built-in functions calculate running values for a set of data.</span></span> <span data-ttu-id="6679c-380">`RowNumber` 类似于 `RunningValue`，它将返回计数的运行值，该计数针对包含作用域中的每一行进行递增。</span><span class="sxs-lookup"><span data-stu-id="6679c-380">`RowNumber` is like `RunningValue` in that it returns the running value of a count that increments for each row within the containing scope.</span></span> <span data-ttu-id="6679c-381">这些函数的作用域参数必须指定包含作用域，用于控制计数开始的时间。</span><span class="sxs-lookup"><span data-stu-id="6679c-381">The scope parameter for these functions must specify a containing scope, which controls when the count restarts.</span></span>  
  
|<span data-ttu-id="6679c-382">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-382">**Function**</span></span>|<span data-ttu-id="6679c-383">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-383">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-384">RowNumber</span><span class="sxs-lookup"><span data-stu-id="6679c-384">RowNumber</span></span>](report-builder-functions-rownumber-function.md)|<span data-ttu-id="6679c-385">返回指定作用域内行数的运行计数。</span><span class="sxs-lookup"><span data-stu-id="6679c-385">Returns a running count of the number of rows for the specified scope.</span></span> <span data-ttu-id="6679c-386">`RowNumber` 函数从 1 开始重新计数，而不是从 0 开始。</span><span class="sxs-lookup"><span data-stu-id="6679c-386">The `RowNumber` function restarts counting at 1, not 0.</span></span>|  
|[<span data-ttu-id="6679c-387">RunningValue</span><span class="sxs-lookup"><span data-stu-id="6679c-387">RunningValue</span></span>](report-builder-functions-runningvalue-function.md)|<span data-ttu-id="6679c-388">返回在给定作用域中计算的，由表达式指定的所有非 Null 数值的运行聚合。</span><span class="sxs-lookup"><span data-stu-id="6679c-388">Returns a running aggregate of all non-null numeric values specified by the expression, evaluated for the given scope.</span></span>|  
  
##  <a name="retrieving-row-counts"></a><a name="RetrievingRowCounts"></a><span data-ttu-id="6679c-389">检索行计数</span><span class="sxs-lookup"><span data-stu-id="6679c-389">Retrieving Row Counts</span></span>  
 <span data-ttu-id="6679c-390">下列内置函数计算给定作用域内的行数。</span><span class="sxs-lookup"><span data-stu-id="6679c-390">The following built-in function calculates the number of rows in the given scope.</span></span> <span data-ttu-id="6679c-391">使用此函数可以对所有行进行计数，包括含有 Null 值的行。</span><span class="sxs-lookup"><span data-stu-id="6679c-391">Use this function to count all rows, including rows with null values.</span></span>  
  
|<span data-ttu-id="6679c-392">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-392">**Function**</span></span>|<span data-ttu-id="6679c-393">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-393">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-394">CountRows</span><span class="sxs-lookup"><span data-stu-id="6679c-394">CountRows</span></span>](report-builder-functions-countrows-function.md)|<span data-ttu-id="6679c-395">返回指定作用域内的行数，包括含有 Null 值的行。</span><span class="sxs-lookup"><span data-stu-id="6679c-395">Returns the number of rows in the specified scope, including rows with null values.</span></span>|  
  
##  <a name="looking-up-values-from-another-dataset"></a><a name="LookupFunctions"></a><span data-ttu-id="6679c-396">从另一个数据集中查找值</span><span class="sxs-lookup"><span data-stu-id="6679c-396">Looking Up Values from Another Dataset</span></span>  
 <span data-ttu-id="6679c-397">下面的查找函数从指定数据集中检索值。</span><span class="sxs-lookup"><span data-stu-id="6679c-397">The following lookup functions retrieve values from a specified dataset.</span></span>  
  
|<span data-ttu-id="6679c-398">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-398">**Function**</span></span>|<span data-ttu-id="6679c-399">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-399">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-400">Lookup 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-400">Lookup Function</span></span>](report-builder-functions-lookup-function.md)|<span data-ttu-id="6679c-401">从数据集中返回指定表达式的值。</span><span class="sxs-lookup"><span data-stu-id="6679c-401">Returns a value from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="6679c-402">LookupSet 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-402">LookupSet Function</span></span>](report-builder-functions-lookupset-function.md)|<span data-ttu-id="6679c-403">从数据集中返回指定表达式的一组值。</span><span class="sxs-lookup"><span data-stu-id="6679c-403">Returns a set of values from a dataset for a specified expression.</span></span>|  
|[<span data-ttu-id="6679c-404">Multilookup 函数</span><span class="sxs-lookup"><span data-stu-id="6679c-404">Multilookup Function</span></span>](report-builder-functions-multilookup-function.md)|<span data-ttu-id="6679c-405">从包含名称/值对的数据集中返回一组名称的第一个匹配值的集合。</span><span class="sxs-lookup"><span data-stu-id="6679c-405">Returns the set of first-match values for a set of names from a dataset that contains name/value pairs.</span></span>|  
  
##  <a name="retrieving-sort-dependent-values"></a><a name="RetrievingPostsortValues"></a><span data-ttu-id="6679c-406">检索排序依赖值</span><span class="sxs-lookup"><span data-stu-id="6679c-406">Retrieving Sort-Dependent Values</span></span>  
 <span data-ttu-id="6679c-407">下列内置函数返回给定作用域内第一个、最后一个或以前的值。</span><span class="sxs-lookup"><span data-stu-id="6679c-407">The following built-in functions return the first, last, or previous value within a given scope.</span></span> <span data-ttu-id="6679c-408">这些函数依赖数据值的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="6679c-408">These functions depend on the sort order of the data values.</span></span> <span data-ttu-id="6679c-409">例如，可以使用这些函数查找页上的第一个和最后一个值来创建字典样式页眉。</span><span class="sxs-lookup"><span data-stu-id="6679c-409">Use these functions, for example, to find the first and last values on a page to create a dictionary-style page header.</span></span> <span data-ttu-id="6679c-410">使用 `Previous` 可以将指定作用域内某一行中的值与该行以前的值进行比较，例如，使用它可以查出表中的年度同比百分比值。</span><span class="sxs-lookup"><span data-stu-id="6679c-410">Use `Previous` to compare a value in one row to the previous row's value within a specific scope, for example, to find percentage year over year values in a table.</span></span>  
  
|<span data-ttu-id="6679c-411">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-411">**Function**</span></span>|<span data-ttu-id="6679c-412">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-412">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-413">First</span><span class="sxs-lookup"><span data-stu-id="6679c-413">First</span></span>](report-builder-functions-first-function.md)|<span data-ttu-id="6679c-414">返回指定表达式的给定作用域中的第一个值。</span><span class="sxs-lookup"><span data-stu-id="6679c-414">Returns the first value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="6679c-415">时间</span><span class="sxs-lookup"><span data-stu-id="6679c-415">Last</span></span>](report-builder-functions-last-function.md)|<span data-ttu-id="6679c-416">返回指定表达式的给定作用域中的最后一个值。</span><span class="sxs-lookup"><span data-stu-id="6679c-416">Returns the last value in the given scope of the specified expression.</span></span>|  
|[<span data-ttu-id="6679c-417">上一页</span><span class="sxs-lookup"><span data-stu-id="6679c-417">Previous</span></span>](report-builder-functions-previous-function.md)|<span data-ttu-id="6679c-418">返回指定作用域内某项的前一个实例的值或该实例的指定聚合值。</span><span class="sxs-lookup"><span data-stu-id="6679c-418">Returns the value or the specified aggregate value for the previous instance of an item within the specified scope.</span></span>|  
  
##  <a name="retrieving-server-aggregates"></a><a name="RetrievingServerAggregates"></a><span data-ttu-id="6679c-419">检索服务器聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-419">Retrieving Server Aggregates</span></span>  
 <span data-ttu-id="6679c-420">下列内置函数从数据访问接口中检索自定义聚合。</span><span class="sxs-lookup"><span data-stu-id="6679c-420">The following built-in function retrieves custom aggregates from the data provider.</span></span> <span data-ttu-id="6679c-421">例如，使用 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据源类型可以检索在用于组头的数据源服务器上计算的聚合。</span><span class="sxs-lookup"><span data-stu-id="6679c-421">For example, using an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data source type, you can retrieve aggregates calculated on the data source server for use in a group header.</span></span>  
  
|<span data-ttu-id="6679c-422">**Function**</span><span class="sxs-lookup"><span data-stu-id="6679c-422">**Function**</span></span>|<span data-ttu-id="6679c-423">**说明**</span><span class="sxs-lookup"><span data-stu-id="6679c-423">**Description**</span></span>|  
|------------------|---------------------|  
|[<span data-ttu-id="6679c-424">聚合</span><span class="sxs-lookup"><span data-stu-id="6679c-424">Aggregate</span></span>](report-builder-functions-aggregate-function.md)|<span data-ttu-id="6679c-425">按照数据访问接口的定义返回指定表达式的自定义聚合。</span><span class="sxs-lookup"><span data-stu-id="6679c-425">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>|  
  
##  <a name="testing-for-scope"></a><a name="TestingforScope"></a><span data-ttu-id="6679c-426">测试范围</span><span class="sxs-lookup"><span data-stu-id="6679c-426">Testing for Scope</span></span>  
 <span data-ttu-id="6679c-427">下列内置函数测试报表项的当前上下文，以确定该报表项是否为特定作用域的成员。</span><span class="sxs-lookup"><span data-stu-id="6679c-427">The following built-in function tests the current context of a report item to see if it is a member of a specific scope.</span></span>  
  
|<span data-ttu-id="6679c-428">函数</span><span class="sxs-lookup"><span data-stu-id="6679c-428">Function</span></span>|<span data-ttu-id="6679c-429">说明</span><span class="sxs-lookup"><span data-stu-id="6679c-429">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="6679c-430">InScope</span><span class="sxs-lookup"><span data-stu-id="6679c-430">InScope</span></span>](report-builder-functions-inscope-function.md)|<span data-ttu-id="6679c-431">指示项的当前实例是否在指定的作用域内。</span><span class="sxs-lookup"><span data-stu-id="6679c-431">Indicates whether the current instance of an item is within the specified scope.</span></span>|  
  
##  <a name="retrieving-recursive-level"></a><a name="RetrievingRecursiveLevel"></a><span data-ttu-id="6679c-432">正在检索递归级别</span><span class="sxs-lookup"><span data-stu-id="6679c-432">Retrieving Recursive Level</span></span>  
 <span data-ttu-id="6679c-433">下列内置函数检索处理递归层次结构时的当前级别。</span><span class="sxs-lookup"><span data-stu-id="6679c-433">The following built-in function retrieves the current level when a recursive hierarchy is processed.</span></span> <span data-ttu-id="6679c-434">此函数的结果与文本框中的 `Padding` 属性配合使用可以控制递归组可视层次结构的缩进级别。</span><span class="sxs-lookup"><span data-stu-id="6679c-434">Use the result of this function with the `Padding` property in a text box to control the indent level of a visual hierarchy for a recursive group.</span></span> <span data-ttu-id="6679c-435">有关详细信息，请参阅[创建递归层次结构组（报表生成器和 SSRS）](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="6679c-435">For more information, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
|<span data-ttu-id="6679c-436">函数</span><span class="sxs-lookup"><span data-stu-id="6679c-436">Function</span></span>|<span data-ttu-id="6679c-437">说明</span><span class="sxs-lookup"><span data-stu-id="6679c-437">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="6679c-438">级别</span><span class="sxs-lookup"><span data-stu-id="6679c-438">Level</span></span>](report-builder-functions-level-function.md)|<span data-ttu-id="6679c-439">返回在递归层次结构中的当前深度级别。</span><span class="sxs-lookup"><span data-stu-id="6679c-439">Returns the current level of depth in a recursive hierarchy.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="6679c-440">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6679c-440">See Also</span></span>  
 <span data-ttu-id="6679c-441">[表达式在报表中使用 &#40;报表生成器和 SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="6679c-441">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="6679c-442">[表达式示例（报表生成器和 SSRS）](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="6679c-442">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="6679c-443">总计、聚合和内置集合的表达式作用域（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="6679c-443">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
