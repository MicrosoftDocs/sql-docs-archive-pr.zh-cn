---
title: 页眉和页脚（报表生成器和 SSRS）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- sql12.rtp.rptdesigner.pagefooter.fill.f1
- "10125"
- "10121"
- "10120"
- "10122"
- "10123"
- sql12.rtp.rptdesigner.pageheader.border.f1
- sql12.rtp.rptdesigner.pageheader.general.f1
- sql12.rtp.rptdesigner.pagefooter.border.f1
- sql12.rtp.rptdesigner.pageheader.fill.f1
- sql12.rtp.rptdesigner.pagefooter.general.f1
- "10124"
ms.assetid: 4fb9faac-511e-404a-b8d7-1f2e3cb47b11
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d534833a6820c9924e69ae0575341d578b746732
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87586428"
---
# <a name="page-headers-and-footers-report-builder-and-ssrs"></a><span data-ttu-id="5258c-102">页眉和页脚（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="5258c-102">Page Headers and Footers (Report Builder and SSRS)</span></span>
  <span data-ttu-id="5258c-103">报表可以包含页眉和页脚，它们分别位于每一页的顶部和底部。</span><span class="sxs-lookup"><span data-stu-id="5258c-103">A report can contain a header and footer that run along the top and bottom of each page, respectively.</span></span> <span data-ttu-id="5258c-104">页眉和页脚可以包含静态文本、图像、线条、矩形、边框、背景色、背景图像和表达式。</span><span class="sxs-lookup"><span data-stu-id="5258c-104">Headers and footers can contain static text, images, lines, rectangles, borders, background color, background images, and expressions.</span></span> <span data-ttu-id="5258c-105">表达式包含只具有一个数据集的报表的数据集字段引用，以及作为作用域包括的数据集的聚合函数调用。</span><span class="sxs-lookup"><span data-stu-id="5258c-105">Expressions include dataset field references for reports with exactly one dataset and aggregate function calls that include the dataset as a scope.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5258c-106">各个呈现扩展插件对页的处理方式各不相同。</span><span class="sxs-lookup"><span data-stu-id="5258c-106">Each rendering extension processes pages differently.</span></span> <span data-ttu-id="5258c-107">有关报表分页和呈现扩展插件的详细信息，请参阅[Reporting Services 中的分页（报表生成器和 SSRS）](pagination-in-reporting-services-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-107">For more information about report pagination and rendering extensions, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="5258c-108">默认情况下，报表有页脚，但没有页眉。</span><span class="sxs-lookup"><span data-stu-id="5258c-108">By default, reports have page footers, but not page headers.</span></span> <span data-ttu-id="5258c-109">有关如何添加或删除它们的详细信息，请参阅[添加或删除页眉和页脚（报表生成器和 SSRS）](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-109">For more information about how to add or remove them, see [Add or Remove a Page Header or Footer &#40;Report Builder and SSRS&#41;](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="5258c-110">页眉和页脚通常包含页码、报表标题和其他报表属性。</span><span class="sxs-lookup"><span data-stu-id="5258c-110">Headers and footers commonly contain page numbers, report titles, and other report properties.</span></span> <span data-ttu-id="5258c-111">有关如何将这些项添加到报表报表头或报表尾的详细信息，请参阅[显示页码或其他报表属性（报表生成器和 SSRS）](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-111">For more information about how to add these items to your report header or footer, see [Display Page Numbers or Other Report Properties &#40;Report Builder and SSRS&#41;](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="5258c-112">创建页眉或页脚之后，即在每个报表页面上显示它们。</span><span class="sxs-lookup"><span data-stu-id="5258c-112">After you create a page header or footer, it is displayed on each report page.</span></span> <span data-ttu-id="5258c-113">有关如何在第一页和最后一页上隐藏页眉和页脚的详细信息，请参阅[隐藏第一页或最后一页的页眉和页脚（报表生成器和 SSRS）](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-113">For more information about how to suppress page headers and footers on the first and last pages, see [Hide a Page Header or Footer on the First or Last Page &#40;Report Builder and SSRS&#41;](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-headers-and-footers"></a><span data-ttu-id="5258c-114">报表表头和表尾</span><span class="sxs-lookup"><span data-stu-id="5258c-114">Report Headers and Footers</span></span>  
 <span data-ttu-id="5258c-115">页眉和页脚与报表表头和表尾有所不同。</span><span class="sxs-lookup"><span data-stu-id="5258c-115">Page headers and footers are not the same as report headers and footers.</span></span> <span data-ttu-id="5258c-116">报表没有特殊的报表表头或报表表尾区域。</span><span class="sxs-lookup"><span data-stu-id="5258c-116">Reports do not have a special report header or report footer area.</span></span> <span data-ttu-id="5258c-117">报表表头由放置在报表设计图面上的表体顶部的报表项组成。</span><span class="sxs-lookup"><span data-stu-id="5258c-117">A report header consists of the report items that are placed at the top of the report body on the report design surface.</span></span> <span data-ttu-id="5258c-118">它们在报表中作为第一项内容仅出现一次。</span><span class="sxs-lookup"><span data-stu-id="5258c-118">They appear only once as the first content in the report.</span></span> <span data-ttu-id="5258c-119">报表表尾由放置在表体底部的报表项组成。</span><span class="sxs-lookup"><span data-stu-id="5258c-119">A report footer consists of report items that are placed at the bottom of the report body.</span></span> <span data-ttu-id="5258c-120">它们在报表中作为最后一项内容仅出现一次。</span><span class="sxs-lookup"><span data-stu-id="5258c-120">They appear only once as the last content in the report.</span></span>  
  
## <a name="displaying-variable-data-in-a-page-header-or-footer"></a><span data-ttu-id="5258c-121">在页眉或页脚中显示变量数据</span><span class="sxs-lookup"><span data-stu-id="5258c-121">Displaying Variable Data in a Page Header or Footer</span></span>  
 <span data-ttu-id="5258c-122">页眉和页脚可以包含静态内容，不过它们更常用于显示变化的内容，例如页码或有关页面内容的信息。</span><span class="sxs-lookup"><span data-stu-id="5258c-122">Page headers and footers can contain static content, but they are more commonly used to display varying content like page numbers or information about the contents of a page.</span></span> <span data-ttu-id="5258c-123">若要在每个页上显示不同的变量数据，您必须使用表达式。</span><span class="sxs-lookup"><span data-stu-id="5258c-123">To display variable data that is different on each page, you must use an expression.</span></span>  
  
 <span data-ttu-id="5258c-124">如果报表中仅定义了一个数据集，则可以向页眉或页脚添加简单表达式，例如 `[FieldName]` 。</span><span class="sxs-lookup"><span data-stu-id="5258c-124">If there is only one dataset defined in the report, you can add simple expressions such as `[FieldName]` to a page header or footer.</span></span> <span data-ttu-id="5258c-125">将字段从“报表数据”窗格数据集字段集合或内置字段集合拖到页眉或页脚中。</span><span class="sxs-lookup"><span data-stu-id="5258c-125">Drag the field from the Report Data pane dataset field collection or the Built-in Fields collection to the page header or page footer.</span></span> <span data-ttu-id="5258c-126">系统会自动为您添加具有相应表达式的文本框。</span><span class="sxs-lookup"><span data-stu-id="5258c-126">A text box with the appropriate expression is automatically added for you.</span></span>  
  
 <span data-ttu-id="5258c-127">若要计算页面上各个值的总和或其他聚合，可以使用指定 ReportItems 或数据集名称的表达式。</span><span class="sxs-lookup"><span data-stu-id="5258c-127">To calculate sums or other aggregates for values on the page, you can use aggregate expressions that specify ReportItems or the name of a dataset.</span></span> <span data-ttu-id="5258c-128">ReportItems 集合是显示报表呈现之后每页上的文本框集合。</span><span class="sxs-lookup"><span data-stu-id="5258c-128">The ReportItems collection is the collection of text boxes on each page after report rendering occurs.</span></span> <span data-ttu-id="5258c-129">报表定义中必须包含数据集名称。</span><span class="sxs-lookup"><span data-stu-id="5258c-129">The dataset name must exist in the report definition.</span></span> <span data-ttu-id="5258c-130">下表显示了每种聚合表达式中所支持的项：</span><span class="sxs-lookup"><span data-stu-id="5258c-130">The following table displays which items are supported in each type of aggregate expression:</span></span>  
  
|<span data-ttu-id="5258c-131">提供支持的表达式</span><span class="sxs-lookup"><span data-stu-id="5258c-131">Supported in expression</span></span>|<span data-ttu-id="5258c-132">ReportItems 聚合</span><span class="sxs-lookup"><span data-stu-id="5258c-132">ReportItems aggregates</span></span>|<span data-ttu-id="5258c-133">数据集聚合（作用域必须是数据集名称）</span><span class="sxs-lookup"><span data-stu-id="5258c-133">Dataset aggregates (scope must be name of dataset)</span></span>|  
|-----------------------------|----------------------------|----------------------------------------------------------|  
|<span data-ttu-id="5258c-134">表体中的文本框</span><span class="sxs-lookup"><span data-stu-id="5258c-134">Text boxes in body of report</span></span>|<span data-ttu-id="5258c-135">是</span><span class="sxs-lookup"><span data-stu-id="5258c-135">Yes</span></span>|<span data-ttu-id="5258c-136">否</span><span class="sxs-lookup"><span data-stu-id="5258c-136">No</span></span>|  
|<span data-ttu-id="5258c-137">&PageNumber</span><span class="sxs-lookup"><span data-stu-id="5258c-137">&PageNumber</span></span>|<span data-ttu-id="5258c-138">是</span><span class="sxs-lookup"><span data-stu-id="5258c-138">Yes</span></span>|<span data-ttu-id="5258c-139">否</span><span class="sxs-lookup"><span data-stu-id="5258c-139">No</span></span>|  
|<span data-ttu-id="5258c-140">&TotalPages</span><span class="sxs-lookup"><span data-stu-id="5258c-140">&TotalPages</span></span>|<span data-ttu-id="5258c-141">是</span><span class="sxs-lookup"><span data-stu-id="5258c-141">Yes</span></span>|<span data-ttu-id="5258c-142">否</span><span class="sxs-lookup"><span data-stu-id="5258c-142">No</span></span>|  
|<span data-ttu-id="5258c-143">聚合函数</span><span class="sxs-lookup"><span data-stu-id="5258c-143">Aggregate function</span></span>|<span data-ttu-id="5258c-144">是的。</span><span class="sxs-lookup"><span data-stu-id="5258c-144">Yes.</span></span> <span data-ttu-id="5258c-145">例如，</span><span class="sxs-lookup"><span data-stu-id="5258c-145">For example,</span></span><br /><br /> `=First(ReportItems!TXT_LastName.Value)`|<span data-ttu-id="5258c-146">是的。</span><span class="sxs-lookup"><span data-stu-id="5258c-146">Yes.</span></span> <span data-ttu-id="5258c-147">例如，</span><span class="sxs-lookup"><span data-stu-id="5258c-147">For example,</span></span><br /><br /> `=Max(Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="5258c-148">页面上各个项的字段集合</span><span class="sxs-lookup"><span data-stu-id="5258c-148">Fields collection for items on the page</span></span>|<span data-ttu-id="5258c-149">间接支持。</span><span class="sxs-lookup"><span data-stu-id="5258c-149">Indirectly.</span></span> <span data-ttu-id="5258c-150">例如，</span><span class="sxs-lookup"><span data-stu-id="5258c-150">For example,</span></span><br /><br /> `=Sum(ReportItems!Textbox1.Value)`|<span data-ttu-id="5258c-151">是的。</span><span class="sxs-lookup"><span data-stu-id="5258c-151">Yes.</span></span> <span data-ttu-id="5258c-152">例如，</span><span class="sxs-lookup"><span data-stu-id="5258c-152">For example,</span></span><br /><br /> `=Sum(Fields!Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="5258c-153">数据绑定图像</span><span class="sxs-lookup"><span data-stu-id="5258c-153">Data-bound image</span></span>|<span data-ttu-id="5258c-154">间接支持。</span><span class="sxs-lookup"><span data-stu-id="5258c-154">Indirectly.</span></span> <span data-ttu-id="5258c-155">例如： `=ReportItems!TXT_Photo.Value`</span><span class="sxs-lookup"><span data-stu-id="5258c-155">For example, `=ReportItems!TXT_Photo.Value`</span></span>|<span data-ttu-id="5258c-156">是的。</span><span class="sxs-lookup"><span data-stu-id="5258c-156">Yes.</span></span> <span data-ttu-id="5258c-157">例如，</span><span class="sxs-lookup"><span data-stu-id="5258c-157">For example,</span></span><br /><br /> `=First(Fields!Photo.Value,"DataSet1")`|  
  
 <span data-ttu-id="5258c-158">本主题的以下部分介绍了在页眉和页脚中常用来获取变量数据的现成表达式。</span><span class="sxs-lookup"><span data-stu-id="5258c-158">The following sections in this topic show ready-to-use expressions that get variable data commonly used in headers and footers.</span></span> <span data-ttu-id="5258c-159">还有一部分介绍 Excel 呈现扩展插件如何处理页眉和页脚。</span><span class="sxs-lookup"><span data-stu-id="5258c-159">There is also a section on how the Excel rendering extension processes headers and footers.</span></span> <span data-ttu-id="5258c-160">有关表达式的详细信息，请参阅[表达式（报表生成器和 SSRS）](expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-160">For more information about expressions, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
### <a name="adding-calculated-page-totals-to-a-header-or-footer"></a><span data-ttu-id="5258c-161">向页眉或页脚中添加计算出的页总计</span><span class="sxs-lookup"><span data-stu-id="5258c-161">Adding Calculated Page Totals to a Header or Footer</span></span>  
 <span data-ttu-id="5258c-162">对于某些报表，在每个报表的页眉或页脚中包括计算出的值非常有用；例如，如果页包括数值，则在每页上显示总计和。</span><span class="sxs-lookup"><span data-stu-id="5258c-162">For some reports, it is useful to include a calculated value in the header or footer of each report; for example, a per-page sum total if the page includes numeric values.</span></span> <span data-ttu-id="5258c-163">由于无法直接引用字段，因此，放置到页眉或页脚中的表达式必须引用报表项（例如文本框）的名称，而不是引用数据字段：</span><span class="sxs-lookup"><span data-stu-id="5258c-163">Because you cannot reference the fields directly, the expression that you put in the header or footer must reference the name of the report item (for example, a text box) rather than the data field:</span></span>  
  
 `=Sum(ReportItems!Textbox1.Value)`  
  
 <span data-ttu-id="5258c-164">如果文本框位于包含重复数据行的表或列表中，则在运行时出现在页眉或页脚中的值将是当前页的表或列表中所有 `TextBox1` 实例数据的所有值之和。</span><span class="sxs-lookup"><span data-stu-id="5258c-164">If the text box is in a table or list that contains repeated rows of data, the value that appears in the header or footer at run time is a sum of all values of all `TextBox1` instance data in the table or list for the current page.</span></span>  
  
 <span data-ttu-id="5258c-165">在计算页总计时，使用不同的呈现扩展插件查看报表可能会显示不同的总计结果。</span><span class="sxs-lookup"><span data-stu-id="5258c-165">When calculating page totals, you can expect to see differences in the totals when you use different rendering extensions to view the report.</span></span> <span data-ttu-id="5258c-166">不同的呈现扩展插件会以不同的方式计算分页输出。</span><span class="sxs-lookup"><span data-stu-id="5258c-166">Paginated output is calculated differently for each rendering extension.</span></span> <span data-ttu-id="5258c-167">同一页在 HTML 中查看时可能会与在 PDF 中查看时显示不同的总计结果（如果 PDF 页上的数据量不同）。</span><span class="sxs-lookup"><span data-stu-id="5258c-167">The same page that you view in HTML might show different totals when viewed in PDF if the amount of data on the PDF page is different.</span></span> <span data-ttu-id="5258c-168">有关详细信息，请参阅[呈现行为（报表生成器和 SSRS）](rendering-behaviors-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-168">For more information, see [Rendering Behaviors &#40;Report Builder  and SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md).</span></span>  
  
### <a name="for-reports-with-multiple-datasets"></a><span data-ttu-id="5258c-169">对于具有多个数据集的报表</span><span class="sxs-lookup"><span data-stu-id="5258c-169">For Reports with Multiple Datasets</span></span>  
 <span data-ttu-id="5258c-170">对于具有多个数据集的报表，无法直接向页眉或页脚中添加字段或数据绑定图像。</span><span class="sxs-lookup"><span data-stu-id="5258c-170">For reports with more than one dataset, you cannot add fields or data-bound images directly to a header or footer.</span></span> <span data-ttu-id="5258c-171">但是，可以编写表达式来间接引用要在页眉或页脚中使用的字段或数据绑定图像。</span><span class="sxs-lookup"><span data-stu-id="5258c-171">However, you can write an expression that indirectly references a field or data-bound image that you want to use in a header or footer.</span></span>  
  
 <span data-ttu-id="5258c-172">若要在页眉或页脚中放入变量数据，请执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="5258c-172">To put variable data in a header or footer:</span></span>  
  
-   <span data-ttu-id="5258c-173">向页眉或页脚中添加文本框。</span><span class="sxs-lookup"><span data-stu-id="5258c-173">Add a text box to the header or footer.</span></span>  
  
-   <span data-ttu-id="5258c-174">在文本框中，编写生成要显示的变量数据的表达式。</span><span class="sxs-lookup"><span data-stu-id="5258c-174">In the text box, write an expression that produces the variable data that you want to appear.</span></span>  
  
-   <span data-ttu-id="5258c-175">在表达式中，包括对页上报表项的引用；例如，可以引用包含特定字段的数据的文本框。</span><span class="sxs-lookup"><span data-stu-id="5258c-175">In the expression, include references to report items on the page; for example, you can reference a text box that contains data from a particular field.</span></span> <span data-ttu-id="5258c-176">不要包括对数据集中的字段的直接引用。</span><span class="sxs-lookup"><span data-stu-id="5258c-176">Do not include a direct reference to fields in a dataset.</span></span> <span data-ttu-id="5258c-177">例如，不能使用表达式 `[LastName]`。</span><span class="sxs-lookup"><span data-stu-id="5258c-177">For example, you cannot use the expression `[LastName]`.</span></span> <span data-ttu-id="5258c-178">可以使用以下表达式显示名为 `TXT_LastName`的文本框的第一个实例的内容：</span><span class="sxs-lookup"><span data-stu-id="5258c-178">You can use the following expression to display the contents of the first instance of a text box named `TXT_LastName`:</span></span>  
  
     `=First(ReportItems!TXT_LastName.Value)`  
  
 <span data-ttu-id="5258c-179">不能在页眉或页脚中对字段使用聚合函数。</span><span class="sxs-lookup"><span data-stu-id="5258c-179">You cannot use aggregate functions on fields in the page header or footer.</span></span> <span data-ttu-id="5258c-180">只能对表体中的报表项使用聚合函数。</span><span class="sxs-lookup"><span data-stu-id="5258c-180">You can only use an aggregate function on report items in the report body.</span></span> <span data-ttu-id="5258c-181">有关页眉和页脚中常用的表达式，请参阅[表达式示例（报表生成器和 SSRS）](expression-examples-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-181">For common expressions in page headers and footers, see [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span></span>  
  
#### <a name="adding-a-data-bound-image-to-a-header-or-footer"></a><span data-ttu-id="5258c-182">向页眉或页脚中添加数据绑定图像</span><span class="sxs-lookup"><span data-stu-id="5258c-182">Adding a Data-Bound Image to a Header or Footer</span></span>  
 <span data-ttu-id="5258c-183">可以在页眉或页脚中使用存储在数据库中的图像数据。</span><span class="sxs-lookup"><span data-stu-id="5258c-183">You can use image data stored in a database in a header or footer.</span></span> <span data-ttu-id="5258c-184">但是，不能直接从图像报表项引用数据库字段。</span><span class="sxs-lookup"><span data-stu-id="5258c-184">However, you cannot reference database fields from the Image report item directly.</span></span> <span data-ttu-id="5258c-185">而是必须在表体中添加文本框，然后将文本框设置为包含图像的数据字段（注意，该值必须采用 base64 编码）。</span><span class="sxs-lookup"><span data-stu-id="5258c-185">Instead, you must add a text box in the body of the report and then set the text box to the data field that contains the image (note that the value must be base64 encoded).</span></span> <span data-ttu-id="5258c-186">可以在表体中隐藏该文本框以避免显示 base64 编码的图像。</span><span class="sxs-lookup"><span data-stu-id="5258c-186">You can hide the text box in the body of the report to avoid showing the base64-encoded image.</span></span> <span data-ttu-id="5258c-187">然后，可以从页眉或页脚中的图像报表项引用隐藏文本框的值。</span><span class="sxs-lookup"><span data-stu-id="5258c-187">Then, you can reference the value of the hidden text box from the Image report item in the page header or footer.</span></span>  
  
 <span data-ttu-id="5258c-188">例如，假设有一个由产品信息页组成的报表。</span><span class="sxs-lookup"><span data-stu-id="5258c-188">For example, suppose you have a report that consists of product information pages.</span></span> <span data-ttu-id="5258c-189">您希望在每个页的页眉中显示产品的照片。</span><span class="sxs-lookup"><span data-stu-id="5258c-189">In the header of each page, you want to display a photograph of the product.</span></span> <span data-ttu-id="5258c-190">若要在报表表头中输出存储的图像，请在表体中定义一个名为 `TXT_Photo` 的隐藏文本框，用于从数据库检索图像，并使用表达式为该文本框赋值：</span><span class="sxs-lookup"><span data-stu-id="5258c-190">To print a stored image in the report header, define a hidden text box named `TXT_Photo` in the body of the report that retrieves the image from the database and use an expression to give it a value:</span></span>  
  
 `=Convert.ToBase64String(Fields!Photo.Value)`  
  
 <span data-ttu-id="5258c-191">在页眉中，添加一个使用 `TXT_Photo` 文本框的图像报表项，解码后用于显示图像：</span><span class="sxs-lookup"><span data-stu-id="5258c-191">In the header, add an Image report item which uses the `TXT_Photo` text box, decoded to show the image:</span></span>  
  
 `=Convert.FromBase64String(ReportItems!TXT_Photo.Value)`  
  
## <a name="using-headers-and-footers-to-position-text"></a><span data-ttu-id="5258c-192">使用页眉和页脚放置文本</span><span class="sxs-lookup"><span data-stu-id="5258c-192">Using Headers and Footers to Position Text</span></span>  
 <span data-ttu-id="5258c-193">可以使用页眉和页脚在页上放置文本。</span><span class="sxs-lookup"><span data-stu-id="5258c-193">You can use headers and footers to position text on a page.</span></span> <span data-ttu-id="5258c-194">例如，假设正在创建要通过邮件发送给客户的报表。</span><span class="sxs-lookup"><span data-stu-id="5258c-194">For example, suppose you are creating a report that you want to mail out to customers.</span></span> <span data-ttu-id="5258c-195">可以使用页眉或页脚来放置客户地址，以便在折叠时该地址会出现在信封窗口中。</span><span class="sxs-lookup"><span data-stu-id="5258c-195">You can use a header or footer to position the customer address so that it appears in an envelope window when folded.</span></span>  
  
 <span data-ttu-id="5258c-196">如果文本框只用来填充页眉或页脚，则可以在表体中隐藏该文本框。</span><span class="sxs-lookup"><span data-stu-id="5258c-196">If you are only using the text box to populate a header or footer, you can hide the text box in the report body.</span></span> <span data-ttu-id="5258c-197">文本框在表体中的位置会影响该值是出现在报表的第一页的页眉或页脚中还是出现在最后一页的页眉或页脚中。</span><span class="sxs-lookup"><span data-stu-id="5258c-197">Placement of the text box in the report body can have an effect on whether the value appears on the header or footer of the first or last page of a report.</span></span> <span data-ttu-id="5258c-198">例如，如果有会导致报表跨越多页的表、矩阵或列表，则隐藏文本框的值将出现在最后一页上。</span><span class="sxs-lookup"><span data-stu-id="5258c-198">For example, if you have tables, matrices, or lists that cause the report to span multiple pages, the hidden text box value appears on the last page.</span></span> <span data-ttu-id="5258c-199">若要使其出现在第一页上，请将隐藏文本框放在表体的顶部。</span><span class="sxs-lookup"><span data-stu-id="5258c-199">If you want it to appear on the first page, place the hidden text box at the top of the report body.</span></span>  
  
## <a name="designing-reports-with-page-headers-and-footers-for-specific-renderers"></a><span data-ttu-id="5258c-200">设计带有特定呈现器的页眉和页脚的报表</span><span class="sxs-lookup"><span data-stu-id="5258c-200">Designing Reports with Page Headers and Footers for Specific Renderers</span></span>  
 <span data-ttu-id="5258c-201">处理报表时，数据和布局信息将组合在一起。</span><span class="sxs-lookup"><span data-stu-id="5258c-201">When a report is processed, data and layout information are combined.</span></span> <span data-ttu-id="5258c-202">查看报表时，组合信息被传递到呈现器，确定每个报表页面上能够容纳的报表数据量。</span><span class="sxs-lookup"><span data-stu-id="5258c-202">When you view a report, the combined information is passed to a renderer that determines how much report data fits on each report page.</span></span>  
  
 <span data-ttu-id="5258c-203">如果使用浏览器查看报表服务器上的报表，HTML 呈现器控制在每个报表页面上显示的内容。</span><span class="sxs-lookup"><span data-stu-id="5258c-203">If you view a report on the report server using a browser, the HTML renderer controls the content on the report pages that you see.</span></span> <span data-ttu-id="5258c-204">如果打算以不同于查看的格式来传递报表，或者如果打算以特定格式打印报表，可能需要优化用于最终报表格式的呈现器的报表布局。</span><span class="sxs-lookup"><span data-stu-id="5258c-204">If you plan to deliver reports in a different format than you use for viewing, or if you plan to print reports in a specific format, you may want to optimize the report layout for the renderer you plan to use for the final report format.</span></span> <span data-ttu-id="5258c-205">有关报表分页的详细信息，请参阅[Reporting Services 中的分页（报表生成器和 SSRS）](pagination-in-reporting-services-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="5258c-205">For more information about report pagination, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
### <a name="working-with-page-headers-and-footers-in-excel"></a><span data-ttu-id="5258c-206">在 Excel 中使用页眉和页脚</span><span class="sxs-lookup"><span data-stu-id="5258c-206">Working with Page Headers and Footers in Excel</span></span>  
 <span data-ttu-id="5258c-207">在为面向 Excel 呈现扩展插件的报表定义页眉和页脚时，请遵循以下原则以获得最佳的结果：</span><span class="sxs-lookup"><span data-stu-id="5258c-207">When defining page headers and footers for reports that target the Excel rendering extension, follow these guidelines to achieve best results:</span></span>  
  
-   <span data-ttu-id="5258c-208">使用页脚显示页码。</span><span class="sxs-lookup"><span data-stu-id="5258c-208">Use page footers to display page numbers.</span></span>  
  
-   <span data-ttu-id="5258c-209">使用页眉显示图像、标题或其他文本。</span><span class="sxs-lookup"><span data-stu-id="5258c-209">Use page headers to display images, titles, or other text.</span></span> <span data-ttu-id="5258c-210">不要将页码放在页眉中。</span><span class="sxs-lookup"><span data-stu-id="5258c-210">Do not put page numbers in the header.</span></span>  
  
 <span data-ttu-id="5258c-211">在 Excel 中，页脚的布局受到限制。</span><span class="sxs-lookup"><span data-stu-id="5258c-211">In Excel, page footers have a limited layout.</span></span> <span data-ttu-id="5258c-212">如果所定义的报表在页脚中包括复杂的报表项，则在 Excel 中查看报表时，页脚不会按您所期望的方式进行处理。</span><span class="sxs-lookup"><span data-stu-id="5258c-212">If you define a report that includes complex report items in the page footer, the page footer won't process as you expect when the report is viewed in Excel.</span></span>  
  
 <span data-ttu-id="5258c-213">Excel 呈现扩展插件可以在页眉中容纳图像并允许在页眉中对简单或复杂的报表项进行绝对定位。</span><span class="sxs-lookup"><span data-stu-id="5258c-213">The Excel rendering extension can accommodate images and absolute positioning of simple or complex report items in the page header.</span></span> <span data-ttu-id="5258c-214">支持更丰富的页眉布局的副作用是在页眉中不再支持计算页码。</span><span class="sxs-lookup"><span data-stu-id="5258c-214">A side effect of supporting a richer page header layout is reduced support for calculating page numbers in the header.</span></span> <span data-ttu-id="5258c-215">在 Excel 呈现扩展插件中，默认设置是根据工作表的数量来计算页码。</span><span class="sxs-lookup"><span data-stu-id="5258c-215">In the Excel rendering extension, default settings cause page numbers to be calculated based on the number of worksheets.</span></span> <span data-ttu-id="5258c-216">根据定义报表的方式，这可能产生错误的页码。</span><span class="sxs-lookup"><span data-stu-id="5258c-216">Depending on how you define the report, this might produce erroneous page numbers.</span></span> <span data-ttu-id="5258c-217">例如，假设一个报表呈现为可分四页打印的单个大型工作表。</span><span class="sxs-lookup"><span data-stu-id="5258c-217">For example, suppose you have a report that renders as a single large worksheet that prints on four pages.</span></span> <span data-ttu-id="5258c-218">如果在页眉中包括页码信息，则在打印的每个页的页眉中将显示“第 1 页，共 1 页”。</span><span class="sxs-lookup"><span data-stu-id="5258c-218">If you include page number information in the header, each printed page will show "Page 1 of 1" in the header.</span></span>  
  
 <span data-ttu-id="5258c-219">根据与打印页的尺寸相关的逻辑页数，可以生成更准确的页计数。</span><span class="sxs-lookup"><span data-stu-id="5258c-219">A more accurate page count is based on logical pages that correlate to the dimensions of a printed page.</span></span> <span data-ttu-id="5258c-220">在 Excel 中，页脚会自动使用逻辑页码。</span><span class="sxs-lookup"><span data-stu-id="5258c-220">In Excel, the page footer uses logical page numbers automatically.</span></span> <span data-ttu-id="5258c-221">若要将逻辑页计数放在页眉中，必须将设备信息设置配置为使用简单页眉。</span><span class="sxs-lookup"><span data-stu-id="5258c-221">To put the logical page count in the page header, you must configure the device information settings to use simple headers.</span></span> <span data-ttu-id="5258c-222">注意，使用简单页眉时，将删除在页眉区域中处理复杂报表布局的功能。</span><span class="sxs-lookup"><span data-stu-id="5258c-222">Be aware that when you use simple headers, you remove the capability of handling complex report layout in the header region.</span></span>  
  
 <span data-ttu-id="5258c-223">有关详细信息，请参阅 [导出到 Microsoft Excel（报表生成器和 SSRS）](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md)中处理数据。</span><span class="sxs-lookup"><span data-stu-id="5258c-223">For more information, see [Exporting to Microsoft Excel &#40;Report Builder and SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5258c-224">另请参阅</span><span class="sxs-lookup"><span data-stu-id="5258c-224">See Also</span></span>  
 <span data-ttu-id="5258c-225">[在报表中嵌入图像（报表生成器和 SSRS）](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="5258c-225">[Embed an Image in a Report &#40;Report Builder and SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="5258c-226">矩形和线条（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="5258c-226">Rectangles and Lines &#40;Report Builder and SSRS&#41;</span></span>](rectangles-and-lines-report-builder-and-ssrs.md)  
  
  
