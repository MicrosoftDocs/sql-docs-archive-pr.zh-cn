---
title: 表达式中的数据类型（报表生成器和 SSRS）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87691624"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="bde94-102">表达式中的数据类型（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="bde94-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="bde94-103">数据类型表示不同种类的数据，以便能够有效地进行存储和处理。</span><span class="sxs-lookup"><span data-stu-id="bde94-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="bde94-104">典型的数据类型包括文本（也称为字符串）、带有小数位和不带小数位的数字、日期和时间以及图像。</span><span class="sxs-lookup"><span data-stu-id="bde94-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="bde94-105">报表中的值必须是报表定义语言 (RDL) 数据类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="bde94-106">在报表中显示某个值时，您可以根据您的喜好设置该值的格式。</span><span class="sxs-lookup"><span data-stu-id="bde94-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="bde94-107">例如，表示货币的字段将以浮点数的形式存储在报表定义中，但是可以根据您所选择的格式属性以不同的格式显示该字段。</span><span class="sxs-lookup"><span data-stu-id="bde94-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="bde94-108">有关显示格式的详细信息，请参阅 [设置报表项的格式（报表生成器和 SSRS）](formatting-report-items-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="bde94-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="bde94-109">报表定义语言 (RDL) 数据类型和公共语言运行时 (CLR) 数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="bde94-110">在 RDL 文件中指定的值必须是 RDL 数据类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="bde94-111">在编译和处理该报表时，RDL 数据类型将转换为 CLR 数据类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="bde94-112">下表将显示标记为默认值的转换：</span><span class="sxs-lookup"><span data-stu-id="bde94-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="bde94-113">RDL 类型</span><span class="sxs-lookup"><span data-stu-id="bde94-113">RDL Type</span></span>|<span data-ttu-id="bde94-114">CLR 类型</span><span class="sxs-lookup"><span data-stu-id="bde94-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="bde94-115">String</span><span class="sxs-lookup"><span data-stu-id="bde94-115">String</span></span>|<span data-ttu-id="bde94-116">默认值：String</span><span class="sxs-lookup"><span data-stu-id="bde94-116">Default: String</span></span><br /><br /> <span data-ttu-id="bde94-117">图表、GUID、Timespan</span><span class="sxs-lookup"><span data-stu-id="bde94-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="bde94-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="bde94-118">Boolean</span></span>|<span data-ttu-id="bde94-119">默认值：Boolean</span><span class="sxs-lookup"><span data-stu-id="bde94-119">Default: Boolean</span></span>|  
|<span data-ttu-id="bde94-120">Integer</span><span class="sxs-lookup"><span data-stu-id="bde94-120">Integer</span></span>|<span data-ttu-id="bde94-121">默认值：Int64</span><span class="sxs-lookup"><span data-stu-id="bde94-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="bde94-122">Int16、Int32、Uint16、Uint64、Byte、Sbyte</span><span class="sxs-lookup"><span data-stu-id="bde94-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="bde94-123">DateTime</span><span class="sxs-lookup"><span data-stu-id="bde94-123">DateTime</span></span>|<span data-ttu-id="bde94-124">默认值：DateTime</span><span class="sxs-lookup"><span data-stu-id="bde94-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="bde94-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="bde94-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="bde94-126">Float</span><span class="sxs-lookup"><span data-stu-id="bde94-126">Float</span></span>|<span data-ttu-id="bde94-127">默认值：Double</span><span class="sxs-lookup"><span data-stu-id="bde94-127">Default: Double</span></span><br /><br /> <span data-ttu-id="bde94-128">Single、Decimal</span><span class="sxs-lookup"><span data-stu-id="bde94-128">Single, Decimal</span></span>|  
|<span data-ttu-id="bde94-129">Binary</span><span class="sxs-lookup"><span data-stu-id="bde94-129">Binary</span></span>|<span data-ttu-id="bde94-130">默认值：Byte[]</span><span class="sxs-lookup"><span data-stu-id="bde94-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="bde94-131">Variant</span><span class="sxs-lookup"><span data-stu-id="bde94-131">Variant</span></span>|<span data-ttu-id="bde94-132">除了 Byte[] 之外的上述任何值</span><span class="sxs-lookup"><span data-stu-id="bde94-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="bde94-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="bde94-133">VariantArray</span></span>|<span data-ttu-id="bde94-134">Variant 的数组</span><span class="sxs-lookup"><span data-stu-id="bde94-134">Array of Variant</span></span>|  
|<span data-ttu-id="bde94-135">可序列化</span><span class="sxs-lookup"><span data-stu-id="bde94-135">Serializable</span></span>|<span data-ttu-id="bde94-136">标记有“可序列化”或者实现 ISerializable 的变量或类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="bde94-137">理解数据类型和编写表达式</span><span class="sxs-lookup"><span data-stu-id="bde94-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="bde94-138">编写的表达式用于比较或组合值（例如，定义组或筛选表达式，或者计算聚合）时，了解数据类型是非常重要的。</span><span class="sxs-lookup"><span data-stu-id="bde94-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="bde94-139">比较和计算都只在数据类型相同的项之间才有效。</span><span class="sxs-lookup"><span data-stu-id="bde94-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="bde94-140">如果数据类型不匹配，必须使用表达式显式转换报表项中的数据类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="bde94-141">下面列出可能需要将数据转换为其他数据类型的情况：</span><span class="sxs-lookup"><span data-stu-id="bde94-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="bde94-142">将一种数据类型的报表参数值与另一种数据类型的数据集字段进行比较。</span><span class="sxs-lookup"><span data-stu-id="bde94-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="bde94-143">编写用于比较不同数据类型的值的筛选表达式。</span><span class="sxs-lookup"><span data-stu-id="bde94-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="bde94-144">编写用于组合不同数据类型的字段的排序表达式。</span><span class="sxs-lookup"><span data-stu-id="bde94-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="bde94-145">编写用于组合不同数据类型的字段的组表达式。</span><span class="sxs-lookup"><span data-stu-id="bde94-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="bde94-146">将从数据源检索的值从一种数据类型转换为另一种数据类型。</span><span class="sxs-lookup"><span data-stu-id="bde94-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="bde94-147">确定报表数据的数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="bde94-148">若要确定报表项的数据类型，可以编写一个返回报表项数据类型的表达式。</span><span class="sxs-lookup"><span data-stu-id="bde94-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="bde94-149">例如，若要显示字段 `MyField`的数据类型，可在表单元中添加以下表达式： `=Fields!MyField.Value.GetType().ToString()`。</span><span class="sxs-lookup"><span data-stu-id="bde94-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="bde94-150">结果将显示用于表示 `MyField` 的 CLR 数据类型，例如 `System.String` 或 `System.DateTime`。</span><span class="sxs-lookup"><span data-stu-id="bde94-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="bde94-151">将数据集字段转换为其他数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="bde94-152">在报表中使用数据集字段之前，还可以对这些字段进行转换。</span><span class="sxs-lookup"><span data-stu-id="bde94-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="bde94-153">下面列出可用于转换现有数据集字段的方法：</span><span class="sxs-lookup"><span data-stu-id="bde94-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="bde94-154">修改数据集查询，以添加含有已转换数据的新查询字段。</span><span class="sxs-lookup"><span data-stu-id="bde94-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="bde94-155">对于关系数据源或多维数据源，将使用数据源资源来执行转换。</span><span class="sxs-lookup"><span data-stu-id="bde94-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="bde94-156">基于现有报表数据集字段创建计算字段，方法是编写一个表达式，将一个结果集列中的所有数据都转换到具有另一数据类型的新列。</span><span class="sxs-lookup"><span data-stu-id="bde94-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="bde94-157">例如，以下表达式将字段 Year 从整数值转换为字符串值： `=CStr(Fields!Year.Value)`。</span><span class="sxs-lookup"><span data-stu-id="bde94-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="bde94-158">有关详细信息，请参阅[在“报表数据”窗格中添加、编辑和刷新字段（报表生成器和 SSRS）](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="bde94-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="bde94-159">检查所使用的数据处理扩展插件是否包括用于检索预先设定格式的数据的元数据。</span><span class="sxs-lookup"><span data-stu-id="bde94-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="bde94-160">例如，[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX 查询包括 FORMATTED_VALUE 扩展属性，用于已在处理多维数据集时设置了格式的多维数据集值。</span><span class="sxs-lookup"><span data-stu-id="bde94-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="bde94-161">有关详细信息，请参阅 [Analysis Services 数据库的扩展字段属性 (SSRS)](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="bde94-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="bde94-162">了解参数数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="bde94-163">报表参数必须是下列五种数据类型之一：Boolean、DateTime、Integer、Float 或 Text（也称为 String）。</span><span class="sxs-lookup"><span data-stu-id="bde94-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="bde94-164">数据集查询包含查询参数时，将会自动创建报表参数，并将其链接到查询参数。</span><span class="sxs-lookup"><span data-stu-id="bde94-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="bde94-165">报表参数的默认数据类型是 String。</span><span class="sxs-lookup"><span data-stu-id="bde94-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="bde94-166">若要更改报表参数的默认数据类型，请在“报表参数属性”对话框的“常规”页上，从“数据类型”下拉列表中选择正确的值    。</span><span class="sxs-lookup"><span data-stu-id="bde94-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bde94-167">DateTime 数据类型的报表参数不支持毫秒。</span><span class="sxs-lookup"><span data-stu-id="bde94-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="bde94-168">尽管可以创建基于包含毫秒值的参数，但是不能从包含具有毫秒的 Date 或 Time 值的可用值下拉列表中选择值。</span><span class="sxs-lookup"><span data-stu-id="bde94-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="bde94-169">编写用于转换数据类型或提取部分数据的表达式</span><span class="sxs-lookup"><span data-stu-id="bde94-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="bde94-170">使用连接操作符 (&) 组合文本和数据集字段时，公共语言运行时 (CLR) 通常提供默认格式。</span><span class="sxs-lookup"><span data-stu-id="bde94-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="bde94-171">需要将数据集字段或参数显式转换为特定数据类型时，必须使用 CLR 方法或 Visual Basic 运行时库函数来转换数据。</span><span class="sxs-lookup"><span data-stu-id="bde94-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="bde94-172">下表提供了转换数据类型的示例。</span><span class="sxs-lookup"><span data-stu-id="bde94-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="bde94-173">转换类型</span><span class="sxs-lookup"><span data-stu-id="bde94-173">Type of conversion</span></span>|<span data-ttu-id="bde94-174">示例</span><span class="sxs-lookup"><span data-stu-id="bde94-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="bde94-175">从 DateTime 到 String</span><span class="sxs-lookup"><span data-stu-id="bde94-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="bde94-176">从 String 到 DateTime</span><span class="sxs-lookup"><span data-stu-id="bde94-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="bde94-177">从 String 到 DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="bde94-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="bde94-178">提取 Year</span><span class="sxs-lookup"><span data-stu-id="bde94-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="bde94-179">从 Boolean 到 Integer</span><span class="sxs-lookup"><span data-stu-id="bde94-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="bde94-180">-1 为 True，0 为 False。</span><span class="sxs-lookup"><span data-stu-id="bde94-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="bde94-181">从 Boolean 到 Integer</span><span class="sxs-lookup"><span data-stu-id="bde94-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="bde94-182">1 为 True，0 为 False。</span><span class="sxs-lookup"><span data-stu-id="bde94-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="bde94-183">只需 DateTimeOffset 值的 DateTime 部分</span><span class="sxs-lookup"><span data-stu-id="bde94-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="bde94-184">只需 DateTimeOffset 值的 Offset 部分</span><span class="sxs-lookup"><span data-stu-id="bde94-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="bde94-185">还可以使用 Format 函数控制值的显示格式。</span><span class="sxs-lookup"><span data-stu-id="bde94-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="bde94-186">有关详细信息，请参阅 [函数 (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483)。</span><span class="sxs-lookup"><span data-stu-id="bde94-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="bde94-187">高级示例</span><span class="sxs-lookup"><span data-stu-id="bde94-187">Advanced Examples</span></span>  
 <span data-ttu-id="bde94-188">使用不对数据源中所有数据类型提供转换支持的数据访问接口连接到数据源时，不支持的数据源类型的默认数据类型为 String。</span><span class="sxs-lookup"><span data-stu-id="bde94-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="bde94-189">下面的示例提供针对作为字符串返回的特定数据类型的解决方案。</span><span class="sxs-lookup"><span data-stu-id="bde94-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="bde94-190">串联 String 和 CLR DateTimeOffset 数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="bde94-191">对于大多数数据类型，CLR 提供默认转换，因此您可以使用 & 运算符将不同数据类型的值串联到一个字符串中。</span><span class="sxs-lookup"><span data-stu-id="bde94-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="bde94-192">例如，下面的表达式将文本“The date and time are: ”与数据集字段 StartDate（这是一个 <xref:System.DateTime> 值）相串联： `="The date and time are: " & Fields!StartDate.Value`。</span><span class="sxs-lookup"><span data-stu-id="bde94-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="bde94-193">对于某些数据类型，可能需要包含 ToString 函数。</span><span class="sxs-lookup"><span data-stu-id="bde94-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="bde94-194">例如，下面的表达式使用 CLR 数据类型 <xref:System.DateTimeOffset>演示相同示例，该数据类型包括日期、时间和相对于 UTC 时区的时区偏移量： `="The time is: " & Fields!StartDate.Value.ToString()`。</span><span class="sxs-lookup"><span data-stu-id="bde94-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="bde94-195">将 String 数据类型转换为 CLR DateTime 数据类型</span><span class="sxs-lookup"><span data-stu-id="bde94-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="bde94-196">如果数据处理扩展插件不支持对某一数据源定义的所有数据类型，则其中的数据可能会作为文本来检索。</span><span class="sxs-lookup"><span data-stu-id="bde94-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="bde94-197">例如，`datetimeoffset(7)` 数据类型值可能会作为 String 数据类型来检索。</span><span class="sxs-lookup"><span data-stu-id="bde94-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="bde94-198">在澳大利亚的珀斯（Perth）市，2008 年 7 月 1 日上午 6:05:07.9999999 的字符串值</span><span class="sxs-lookup"><span data-stu-id="bde94-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="bde94-199">如下：</span><span class="sxs-lookup"><span data-stu-id="bde94-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="bde94-200">此示例演示的是日期（2008 年 7 月 1 日），后跟 7 位精度的时间（上午 6:05:07.9999999），再跟以小时和分钟表示的 UTC 时区偏移量（加 8 小时、0 分钟）。</span><span class="sxs-lookup"><span data-stu-id="bde94-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="bde94-201">对于以下示例，此值已放入名为 `MyDateTime.Value` 的 `String` 字段中。</span><span class="sxs-lookup"><span data-stu-id="bde94-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="bde94-202">可以使用下列策略之一将此数据转换为一个或多个 CLR 值：</span><span class="sxs-lookup"><span data-stu-id="bde94-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="bde94-203">在文本框中，使用表达式提取部分字符串。</span><span class="sxs-lookup"><span data-stu-id="bde94-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="bde94-204">例如：</span><span class="sxs-lookup"><span data-stu-id="bde94-204">For example:</span></span>  
  
    -   <span data-ttu-id="bde94-205">下面的表达式只提取 UTC 时区偏移量的小时部分，并将其转换为分钟： `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="bde94-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="bde94-206">结果为 `480`。</span><span class="sxs-lookup"><span data-stu-id="bde94-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="bde94-207">下面的表达式将该字符串转换为日期和时间值： `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="bde94-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="bde94-208">如果 `MyDateTime.Value` 字符串具有 UTC 偏移量，则 `DateTime.Parse` 函数将首先针对 UTC 偏移量进行调整（将上午 7 点</span><span class="sxs-lookup"><span data-stu-id="bde94-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="bde94-209">- [`+08:00`] 调整为 UTC 时间的前一天</span><span class="sxs-lookup"><span data-stu-id="bde94-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="bde94-210">晚上 11 点）。</span><span class="sxs-lookup"><span data-stu-id="bde94-210">the night before).</span></span> <span data-ttu-id="bde94-211">随后， `DateTime.Parse` 函数将应用本地报表服务器的 UTC 偏移量，如有必要，将针对夏时制再次调整时间。</span><span class="sxs-lookup"><span data-stu-id="bde94-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="bde94-212">例如，在华盛顿州的雷德蒙德（Redmond），针对夏时制调整的本地时间偏移量为 `[-07:00]`，即比晚上 11 点早 7 个小时。</span><span class="sxs-lookup"><span data-stu-id="bde94-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="bde94-213">结果为以下 `DateTime` 值：`2007-07-06 04:07:07 PM`（2007 年 7 月 6 日下午 4:07)。</span><span class="sxs-lookup"><span data-stu-id="bde94-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="bde94-214">有关将字符串转换为数据类型的详细信息 `DateTime` ，请参阅[分析日期和时间字符串](https://go.microsoft.com/fwlink/?LinkId=89703)、[设置特定区域性的日期和时间格式](https://go.microsoft.com/fwlink/?LinkId=89704)，以及在 MSDN 上的[DateTime、DateTimeOffset 和 TimeZoneInfo 之间进行选择](https://go.microsoft.com/fwlink/?linkid=110652)。</span><span class="sxs-lookup"><span data-stu-id="bde94-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="bde94-215">向报表数据集添加使用表达式提取部分字符串的新计算字段。</span><span class="sxs-lookup"><span data-stu-id="bde94-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="bde94-216">有关详细信息，请参阅[在“报表数据”窗格中添加、编辑和刷新字段（报表生成器和 SSRS）](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="bde94-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="bde94-217">将报表数据集查询改为使用 [!INCLUDE[tsql](../../includes/tsql-md.md)] 函数分别提取日期和时间值，从而创建单独的列。</span><span class="sxs-lookup"><span data-stu-id="bde94-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="bde94-218">下面的示例演示如何使用 `DatePart` 函数添加年度列和已转换为分钟的 UTC 时区列：</span><span class="sxs-lookup"><span data-stu-id="bde94-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="bde94-219">结果集包含三列。</span><span class="sxs-lookup"><span data-stu-id="bde94-219">The result set has three columns.</span></span> <span data-ttu-id="bde94-220">第一列是日期和时间，第二列是年度，第三列是以分钟表示的 UTC 偏移量。</span><span class="sxs-lookup"><span data-stu-id="bde94-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="bde94-221">下面一行显示了示例数据：</span><span class="sxs-lookup"><span data-stu-id="bde94-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="bde94-222">有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 数据库数据类型的详细信息，请参阅[数据类型 (Transact-SQL)](/sql/t-sql/data-types/data-types-transact-sql) 和 [SQL Server 联机丛书](https://go.microsoft.com/fwlink/?linkid=120955)中的[日期和时间数据类型及函数 (Transact-SQL)](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="bde94-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="bde94-223">有关 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] 数据类型的详细信息，请参阅 [SQL Server 联机丛书](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) 中的 [SQL Server Books Onl中的e](https://go.microsoft.com/fwlink/?linkid=120955)。</span><span class="sxs-lookup"><span data-stu-id="bde94-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bde94-224">另请参阅</span><span class="sxs-lookup"><span data-stu-id="bde94-224">See Also</span></span>  
 [<span data-ttu-id="bde94-225">设置报表项的格式（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="bde94-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
