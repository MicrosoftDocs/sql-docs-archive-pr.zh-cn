---
title: 矩阵 (报表生成器和 SSRS) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 493e63b9-ecd0-4054-97ec-92d84e9b8182
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0141a11b8c762e1272826566ab86e7f307b2f9e0
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580628"
---
# <a name="matrices-report-builder-and-ssrs"></a><span data-ttu-id="4b6cb-102">矩阵（报表生成器和 SSRS）</span><span class="sxs-lookup"><span data-stu-id="4b6cb-102">Matrices (Report Builder and SSRS)</span></span>
  <span data-ttu-id="4b6cb-103">使用矩阵可显示分组数据和摘要信息。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-103">Use a matrix to display grouped data and summary information.</span></span> <span data-ttu-id="4b6cb-104">您可以按行组和列组中的多个字段或表达式对数据进行分组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-104">You can group data by multiple fields or expressions in row and column groups.</span></span> <span data-ttu-id="4b6cb-105">矩阵所提供的功能与交叉表和透视表的功能类似。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-105">Matrices provide functionality similar to crosstabs and pivot tables.</span></span> <span data-ttu-id="4b6cb-106">在运行时，由于报表数据和数据区域是组合在一起的，所以矩阵在页面上沿水平和垂直方向增长。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-106">At run time, as the report data and data regions are combined, a matrix grows horizontally and vertically on the page.</span></span> <span data-ttu-id="4b6cb-107">矩阵单元中的值显示仅限于单元所属行组和列组的交集的聚合值。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-107">Values in matrix cells display aggregate values scoped to the intersection of the row and column groups to which the cell belongs.</span></span> <span data-ttu-id="4b6cb-108">您可以设置行和列的格式以突出显示要强调的数据。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-108">You can format the rows and columns to highlight the data you want to emphasize.</span></span> <span data-ttu-id="4b6cb-109">您也可以包括最初隐藏详细信息数据的明细切换，然后用户便可单击该切换以根据需要显示更多或更少的详细信息。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-109">You can also include drilldown toggles that initially hide detail data; the user can then click the toggles to display more or less detail as needed.</span></span>

 <span data-ttu-id="4b6cb-110">在最初设计之后，便可继续开发矩阵以改善用户的查看体验。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-110">After your initial design, you can continue to develop a matrix to improve the viewing experience for the user.</span></span> <span data-ttu-id="4b6cb-111">有关详细信息，请参阅 [控制 Tablix 数据区域在报表页上的显示（报表生成器和 SSRS）](controlling-the-tablix-data-region-display-on-a-report-page.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-111">For more information, see [Controlling the Tablix Data Region Display on a Report Page &#40;Report Builder and SSRS&#41;](controlling-the-tablix-data-region-display-on-a-report-page.md).</span></span>

 <span data-ttu-id="4b6cb-112">若要快速开始使用列表，请参阅[教程：创建矩阵报表（报表生成器）](../tutorial-creating-a-matrix-report-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-112">To quickly get started with matrices, see [Tutorial: Creating a Matrix Report &#40;Report Builder&#41;](../tutorial-creating-a-matrix-report-report-builder.md).</span></span>

 <span data-ttu-id="4b6cb-113">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 示例报表包括许多使用矩阵的报表。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-113">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] sample reports include a number of reports that use matrices.</span></span> <span data-ttu-id="4b6cb-114">您可以通过在报表生成器或报表设计器中浏览示例报表的报表定义，或者通过在报表生成器或报表设计器中预览呈现的报表，了解矩阵的有关情况。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-114">You can learn about matrices by exploring the report definition of a sample report in Report Builder or Report Designer or by previewing the rendered report in Report Builder or Report Designer.</span></span> <span data-ttu-id="4b6cb-115">有关下载示例报表的详细信息，请参阅 [(SSRS) Reporting Services 示例](https://go.microsoft.com/fwlink/?LinkID=198283)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-115">For more information about downloading the sample reports, see [(SSRS) Reporting Services Samples](https://go.microsoft.com/fwlink/?LinkID=198283).</span></span>

> [!NOTE]
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]

##  <a name="adding-a-matrix-to-your-report"></a><a name="AddingMatrix"></a><span data-ttu-id="4b6cb-116">向报表添加矩阵</span><span class="sxs-lookup"><span data-stu-id="4b6cb-116">Adding a Matrix to Your Report</span></span>
 <span data-ttu-id="4b6cb-117">从功能区上的“插入”选项卡向设计图面添加一个矩阵。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-117">Add a matrix to the design surface from the Insert tab on the ribbon.</span></span> <span data-ttu-id="4b6cb-118">您可以选择通过使用表或矩阵向导添加矩阵，包括创建数据源连接和数据集，以及基于矩阵模板配置矩阵或添加矩阵。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-118">You have the option to add a matrix by using the Table or Matrix Wizard, which includes creating a data source connection and dataset, and configuring the matrix or adding a matrix based on the matrix template.</span></span>

> [!NOTE]
>  <span data-ttu-id="4b6cb-119">该向导仅在 [!INCLUDE[ssRBDenali](../../includes/ssrbdenali-md.md)]中提供。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-119">The wizard is available only in [!INCLUDE[ssRBDenali](../../includes/ssrbdenali-md.md)].</span></span>

 <span data-ttu-id="4b6cb-120">为了从头至尾描述如何配置表，本主题使用矩阵模板。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-120">To describe how to configure a table from beginning to end, this topic uses the matrix template.</span></span>  <span data-ttu-id="4b6cb-121">矩阵最初具有行组、列组、角单元和数据单元，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-121">The matrix initially has a row group, a column group, a corner cell, and a data cell, as shown in the following figure.</span></span>

 <span data-ttu-id="4b6cb-122">![带有 1 行和 1 个列组的空矩阵](../media/rs-matrixtemplatenew.gif "带有 1 行和 1 个列组的空矩阵")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-122">![Blank Matrix with 1 row and 1 column group](../media/rs-matrixtemplatenew.gif "Blank Matrix with 1 row and 1 column group")</span></span>

 <span data-ttu-id="4b6cb-123">在设计图面上选择矩阵时，将显示行控点和列控点，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-123">When you select a matrix on the design surface, row and column handles appear, as shown in the following figure.</span></span>

 <span data-ttu-id="4b6cb-124">![从工具箱添加的新矩阵，选中](../media/rs-matrixtemplatenewselected.gif "从工具箱添加的新矩阵，选中")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-124">![New Matrix added from Toolbox, selected](../media/rs-matrixtemplatenewselected.gif "New Matrix added from Toolbox, selected")</span></span>

 <span data-ttu-id="4b6cb-125">通过将数据集字段拖动至“分组”面板的“行组”和“列组”区域来添加组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-125">Add groups by dragging dataset fields to the Row Groups and Column Groups areas of the Grouping pane.</span></span> <span data-ttu-id="4b6cb-126">您拖动至行组或列组窗格的第一个字段将替换最初的空默认组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-126">The first field that you drag to the row groups or column groups pane replaces the initial empty default group.</span></span> <span data-ttu-id="4b6cb-127">然后便可根据数据为每个单元应用格式设置。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-127">You can then apply formatting for each cell, depending on the data.</span></span>

 <span data-ttu-id="4b6cb-128">![矩阵、Category 行和 Geography 列组](../media/rs-basicmatrixdesign.gif "矩阵、Category 行和 Geography 列组")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-128">![Matrix, Category row and Geography column group](../media/rs-basicmatrixdesign.gif "Matrix, Category row and Geography column group")</span></span>

 <span data-ttu-id="4b6cb-129">在“预览”中，矩阵将扩展以显示行组和列组值。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-129">In Preview, the matrix expands to show the row group and column group values.</span></span> <span data-ttu-id="4b6cb-130">单元将显示汇总值，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-130">The cells display summary values, as shown in the following figure.</span></span>

 <span data-ttu-id="4b6cb-131">![呈现的矩阵（包含扩展组）预览](../media/rs-basicmatrixpreview.gif "呈现的矩阵（包含扩展组）预览")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-131">![Preview for rendered matrix with expanded groups](../media/rs-basicmatrixpreview.gif "Preview for rendered matrix with expanded groups")</span></span>

 <span data-ttu-id="4b6cb-132">您开始使用的矩阵为基于 Tablix 数据区域的模板。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-132">The matrix you start with is a template based on the tablix data region.</span></span> <span data-ttu-id="4b6cb-133">不过，您可以继续设计自己矩阵，例如，添加嵌套的或相邻的行组或列组，甚至可以添加详细信息组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-133">You can continue to develop your matrix design by adding nested or adjacent row groups or column groups, or even adding detail rows.</span></span> <span data-ttu-id="4b6cb-134">有关详细信息，请参阅[利用 Tablix 数据区域的灵活性（报表生成器和 SSRS）](exploring-the-flexibility-of-a-tablix-data-region-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-134">For more information, see [Exploring the Flexibility of a Tablix Data Region &#40;Report Builder and SSRS&#41;](exploring-the-flexibility-of-a-tablix-data-region-report-builder-and-ssrs.md).</span></span>

##  <a name="adding-a-parent-group-or-child-group-to-a-matrix"></a><a name="AddingParentGroupChild"></a> <span data-ttu-id="4b6cb-135">向矩阵添加父组或子组</span><span class="sxs-lookup"><span data-stu-id="4b6cb-135">Adding a Parent Group or Child Group to a Matrix</span></span>
 <span data-ttu-id="4b6cb-136">若要基于单个数据集字段添加组，请将该字段从“报表数据”窗格拖动至“分组”窗格的相应“行组”或“列组”区域。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-136">To add a group based on a single dataset field, drag the field from the Report Data pane to the appropriate Row Groups or Column Groups area of the Grouping pane.</span></span> <span data-ttu-id="4b6cb-137">将该字段放在组层次结构中可设置其与现有组的关系。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-137">Drop the field in the group hierarchy to set its relationship to existing groups.</span></span> <span data-ttu-id="4b6cb-138">将其放在现有组的上方可创建父组，或者将其放在现有组的下方可创建子组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-138">Drop it above an existing group to create a parent group, or drop it below an existing group to create a child group.</span></span>

 <span data-ttu-id="4b6cb-139">将字段放在 **“分组”** 窗格中时，将发生以下几种情况：</span><span class="sxs-lookup"><span data-stu-id="4b6cb-139">Several things happen when you drop a field in the **Grouping** pane:</span></span>

-   <span data-ttu-id="4b6cb-140">将自动创建具有基于字段名称的唯一名称的新组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-140">A new group with a unique name based on the field name is automatically created.</span></span> <span data-ttu-id="4b6cb-141">组表达式将设置为简单字段名称引用，例如 `[Category]`。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-141">The group expression is set to the simple field name reference, for example `[Category]`.</span></span>

-   <span data-ttu-id="4b6cb-142">相应行组或列组区域中将显示新行或新列。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-142">A new row or column appears in the corresponding row group or column group area.</span></span>

-   <span data-ttu-id="4b6cb-143">在新列中，将显示一个针对报表数据集中默认数据行的行组单元。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-143">In the new column, a row group cell appears for the default data rows from the report dataset.</span></span> <span data-ttu-id="4b6cb-144">Tablix 正文中此行的单元现在为该行组的成员。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-144">Cells in the tablix body for this row are now members of the row group.</span></span> <span data-ttu-id="4b6cb-145">如果定义了任何列组，则列中的单元为这些列组的成员。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-145">If there are any column groups defined, cells that are in the columns are members of those column groups.</span></span> <span data-ttu-id="4b6cb-146">组指示器为每个单元的组成员身份提供了视觉提示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-146">Group indicators provide visual cues for the group membership of each cell.</span></span>

 <span data-ttu-id="4b6cb-147">若要在创建组之后对其进行自定义，请使用 **“Tablix 组”** 对话框。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-147">To customize the group after it is created, use the **Tablix Group** dialog box.</span></span> <span data-ttu-id="4b6cb-148">您可以更改组名、在组定义中编辑或添加其他表达式。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-148">You can change the group name, and edit or add additional expressions to the group definition.</span></span> <span data-ttu-id="4b6cb-149">若要在表中添加或删除行，请参阅[插入或删除行（报表生成器和 SSRS）](insert-or-delete-a-row-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-149">To add or remove rows from the table, see [Insert or Delete a Row &#40;Report Builder and SSRS&#41;](insert-or-delete-a-row-report-builder-and-ssrs.md).</span></span>

 <span data-ttu-id="4b6cb-150">当报表运行时，动态列标题向右扩展（如果将矩阵的 Direction 属性设置为 RTL，则向左扩展），有多少唯一组值就扩展多少列。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-150">When the report runs, dynamic column headers expand right (or left, if the Direction property of the matrix is set to RTL) for as many columns as there are unique group values.</span></span> <span data-ttu-id="4b6cb-151">而动态行则沿页面方向纵向扩展。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-151">Dynamic rows expand down the page.</span></span> <span data-ttu-id="4b6cb-152">Tablix 正文单元中显示的数据是基于行组和列组的交集的聚合，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-152">The data that appears in the tablix body cells are aggregates based on the intersections of row and column groups, as shown in the following figure.</span></span>

 <span data-ttu-id="4b6cb-153">![带有总计的矩阵、嵌套行组和列组](../media/rs-basicmatrixnestedgroupstotalsdesign.gif "带有总计的矩阵、嵌套行组和列组")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-153">![Matrix, nested row and column groups with totals](../media/rs-basicmatrixnestedgroupstotalsdesign.gif "Matrix, nested row and column groups with totals")</span></span>

 <span data-ttu-id="4b6cb-154">在预览中，报表显示如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-154">In preview, the report displays as in the following figure.</span></span>

 <span data-ttu-id="4b6cb-155">![预览中的嵌套组](../media/rs-basicmatrixnestedgroupstotalspreview.gif "预览中的嵌套组")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-155">![Nested Groups in Preview](../media/rs-basicmatrixnestedgroupstotalspreview.gif "Nested Groups in Preview")</span></span>

 <span data-ttu-id="4b6cb-156">若要编写指定范围而不是使用默认范围的表达式，您必须在聚合函数 all 中指定数据集、数据区域或组的名称。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-156">To write expressions that specify a scope other than the default scope, you must specify the name of a dataset, data region, or group in the aggregate function all.</span></span> <span data-ttu-id="4b6cb-157">若要计算每个子类别在 Clothing 类别组值中所占的百分比，请在 Category 组内部 Total 列的旁边添加一列，设置文本框的格式以显示百分比，然后添加一个分子使用默认范围、分母使用 Category 组范围的表达式，如下例所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-157">To calculate the percentage each subcategory contributes to the Clothing category group values, add a column inside the Category group next to the Total column, format the text box to show percentage, and add an expression that uses the default scope in the numerator, and the Category group scope in the denominator, as shown in the following example.</span></span>

 `=SUM(Fields!Linetotal.Value)/SUM(Fields! Linetotal.Value,"Category")`

 <span data-ttu-id="4b6cb-158">有关详细信息，请参阅 [总计、聚合和内置集合的表达式作用域（报表生成器和 SSRS）](expression-scope-for-totals-aggregates-and-built-in-collections.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-158">For more information, see [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>

##  <a name="adding-an-adjacent-group-to-a-matrix"></a><a name="AddingAdjacentGroup"></a><span data-ttu-id="4b6cb-159">向矩阵添加相邻组</span><span class="sxs-lookup"><span data-stu-id="4b6cb-159">Adding an Adjacent Group to a Matrix</span></span>
 <span data-ttu-id="4b6cb-160">若要添加基于单个数据集字段的相邻组，请在“分组”窗格中使用快捷菜单。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-160">To add an adjacent group based on a single dataset field, use the shortcut menu in the Grouping pane.</span></span> <span data-ttu-id="4b6cb-161">有关详细信息，请参阅[在数据区域中添加或删除组 &#40;报表生成器和 SSRS&#41;](add-or-delete-a-group-in-a-data-region-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-161">For more information, see [Add or Delete a Group in a Data Region &#40;Report Builder and SSRS&#41;](add-or-delete-a-group-in-a-data-region-report-builder-and-ssrs.md).</span></span> <span data-ttu-id="4b6cb-162">下图显示了基于地域的组和基于年份的相邻组。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-162">The following figure shows a group based on geography and an adjacent group based on year.</span></span>

 <span data-ttu-id="4b6cb-163">![“地域”和“年份”相邻列组](../media/rs-basicmatrixadjacentgroupsdesign.gif "“地域”和“年份”相邻列组")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-163">![Adjacent Column Groups for Geography and Year](../media/rs-basicmatrixadjacentgroupsdesign.gif "Adjacent Column Groups for Geography and Year")</span></span>

 <span data-ttu-id="4b6cb-164">在此示例中，查询已对数据值进行了筛选，仅包括 2003 年和 2004 年欧洲地区的值。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-164">In this example, the query has filtered data values to only include those values for Europe and for the years 2003 and 2004.</span></span> <span data-ttu-id="4b6cb-165">然而，您可以单独为每个组设置筛选器。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-165">However, you can set filters on each group independently.</span></span> <span data-ttu-id="4b6cb-166">在预览中，报表显示如下图所示。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-166">In preview, the report displays as in the following figure.</span></span>

 <span data-ttu-id="4b6cb-167">![相邻列组预览](../media/rs-basicmatrixadjacentgroupspreview.gif "相邻列组预览")</span><span class="sxs-lookup"><span data-stu-id="4b6cb-167">![Preview of adjacent column groups](../media/rs-basicmatrixadjacentgroupspreview.gif "Preview of adjacent column groups")</span></span>

 <span data-ttu-id="4b6cb-168">若要为相邻列组添加一个总计列，请单击列组定义单元并使用 **“添加总计”** 命令。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-168">To add a total column for an adjacent column group, click in the column group definition cell and use the **Add Total** command.</span></span> <span data-ttu-id="4b6cb-169">将向列组旁添加一个新的静态列，包含现有行中每个数值字段的默认聚合总数。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-169">A new static column is added next to the column group, with a default aggregate sum for every numeric field in the existing rows.</span></span> <span data-ttu-id="4b6cb-170">若要更改表达式，请手动编辑默认聚合，例如 `Avg([Sales])`。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-170">To change the expression, manually edit the default aggregate, for example, `Avg([Sales])`.</span></span> <span data-ttu-id="4b6cb-171">有关详细信息，请参阅[向组或 Tablix 数据区域添加总计（报表生成器和 SSRS）](add-a-total-to-a-group-or-tablix-data-region-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4b6cb-171">For more information, see [Add a Total to a Group or Tablix Data Region &#40;Report Builder and SSRS&#41;](add-a-total-to-a-group-or-tablix-data-region-report-builder-and-ssrs.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="4b6cb-172">另请参阅</span><span class="sxs-lookup"><span data-stu-id="4b6cb-172">See Also</span></span>
 <span data-ttu-id="4b6cb-173">[聚合函数引用 &#40;报表生成器和 ssrs&#41;](report-builder-functions-aggregate-functions-reference.md) [表达式示例 &#40;报表生成器和 ssrs&#41;](expression-examples-report-builder-and-ssrs.md)</span><span class="sxs-lookup"><span data-stu-id="4b6cb-173">[Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md) [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md)</span></span>


