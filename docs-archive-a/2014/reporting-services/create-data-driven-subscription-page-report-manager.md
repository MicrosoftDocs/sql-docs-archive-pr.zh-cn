---
title: 创建数据驱动订阅页 (报表管理器) |Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 814b4653-572a-48c7-847f-b310ba0f3046
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 684575697202c26a6946e4bba6146a61342c130d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579523"
---
# <a name="create-data-driven-subscription-page-report-manager"></a><span data-ttu-id="6d68e-102">“创建数据驱动订阅”页（报表管理器）</span><span class="sxs-lookup"><span data-stu-id="6d68e-102">Create Data-driven Subscription Page (Report Manager)</span></span>
  <span data-ttu-id="6d68e-103">使用“创建数据驱动订阅”页可以生成或修改订阅，每次运行订阅时，都会在订阅服务器数据库中查询订阅信息。</span><span class="sxs-lookup"><span data-stu-id="6d68e-103">Use the Create Data-driven Subscription pages to build or modify a subscription that queries a subscriber database for subscription information each time the subscription runs.</span></span> <span data-ttu-id="6d68e-104">数据驱动订阅使用查询结果来确定订阅的收件人、传递设置和报表参数值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-104">Data-driven subscriptions use query results to determine the recipients of the subscription, delivery settings, and report parameter values.</span></span> <span data-ttu-id="6d68e-105">在运行时，报表服务器将运行一个查询，以获取订阅设置所需的值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-105">At run time, the report server runs a query to get values used for subscription settings.</span></span> <span data-ttu-id="6d68e-106">可以使用“创建数据驱动订阅”页来定义查询并将查询值赋予订阅设置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-106">You can use the Create Data-driven Subscription pages to define the query and assign query values to subscription settings.</span></span> <span data-ttu-id="6d68e-107">为数据驱动订阅指定的值和选项分别位于若干个页面上，类似于向导。</span><span class="sxs-lookup"><span data-stu-id="6d68e-107">The values and options that you specify for a data-driven subscription are divided among several pages, similar to a wizard.</span></span> <span data-ttu-id="6d68e-108">总共有七个页面。</span><span class="sxs-lookup"><span data-stu-id="6d68e-108">There are seven pages in all.</span></span>  
  
 <span data-ttu-id="6d68e-109">要创建数据驱动订阅，您必须了解如何编写查询或命令来获取订阅的数据。</span><span class="sxs-lookup"><span data-stu-id="6d68e-109">To create a data-driven subscription, you must know how to write a query or command that gets the data for the subscription.</span></span> <span data-ttu-id="6d68e-110">还必须有一个数据存储区包含要用于订阅的订阅服务器数据（例如，订阅服务器名称和电子邮件地址）。</span><span class="sxs-lookup"><span data-stu-id="6d68e-110">You must also have a data store that contains the subscriber data (for example, subscriber names and e-mail addresses) to use for the subscription.</span></span>  
  
 <span data-ttu-id="6d68e-111">具有高级权限的用户可以使用此页。</span><span class="sxs-lookup"><span data-stu-id="6d68e-111">This page is available to users with advanced permissions.</span></span> <span data-ttu-id="6d68e-112">如果使用的是默认的安全设置，则位于“我的报表”文件夹的报表将无法使用数据驱动订阅。</span><span class="sxs-lookup"><span data-stu-id="6d68e-112">If you are using default security, data-driven subscriptions cannot be used for reports located in a My Reports folder.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6d68e-113">并非在 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]的每个版本中均提供此功能。</span><span class="sxs-lookup"><span data-stu-id="6d68e-113">This feature is not available in every edition of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6d68e-114">有关各个版本支持的功能列表 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ，请参阅 SQL Server 2014 的各个[版本支持的功能](../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。</span><span class="sxs-lookup"><span data-stu-id="6d68e-114">For a list of features that are supported by the editions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2014](../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="navigation"></a><span data-ttu-id="6d68e-115">导航</span><span class="sxs-lookup"><span data-stu-id="6d68e-115">Navigation</span></span>  
 <span data-ttu-id="6d68e-116">使用以下过程导航到用户界面 (UI) 中的这一位置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-116">Use the following procedure to navigate to this location in the user interface (UI).</span></span>  
  
###### <a name="to-open-the-data-driven-subscription-page"></a><span data-ttu-id="6d68e-117">打开“数据驱动订阅”页</span><span class="sxs-lookup"><span data-stu-id="6d68e-117">To open the Data-driven Subscription page</span></span>  
  
1.  <span data-ttu-id="6d68e-118">打开报表管理器，找到要为其创建数据驱动订阅的报表。</span><span class="sxs-lookup"><span data-stu-id="6d68e-118">Open Report Manager, and locate the report for which you want to create a data-driven subscription.</span></span>  
  
2.  <span data-ttu-id="6d68e-119">悬停在该报表之上，然后单击下拉箭头。</span><span class="sxs-lookup"><span data-stu-id="6d68e-119">Hover over the report, and click the drop-down arrow.</span></span>  
  
3.  <span data-ttu-id="6d68e-120">在下拉菜单中，单击 **“管理”**。</span><span class="sxs-lookup"><span data-stu-id="6d68e-120">In the drop-down menu, click **Manage**.</span></span> <span data-ttu-id="6d68e-121">这会打开该报表的 "**常规**属性" 页。</span><span class="sxs-lookup"><span data-stu-id="6d68e-121">This opens the **General** properties page for the report.</span></span>  
  
4.  <span data-ttu-id="6d68e-122">选择 **“订阅”** 选项卡，然后单击 **“新建数据驱动订阅”**。</span><span class="sxs-lookup"><span data-stu-id="6d68e-122">Select the **Subscriptions** tab, and then click **New Data-driven Subscription**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6d68e-123">报表数据源必须使用存储的凭据，此按钮才可用。</span><span class="sxs-lookup"><span data-stu-id="6d68e-123">The report data source must use stored credentials in order for this button to be enabled.</span></span>  
  
## <a name="start-a-subscription-page-1"></a><span data-ttu-id="6d68e-124">开始创建订阅（第 1 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-124">Start a Subscription (Page 1)</span></span>  
 <span data-ttu-id="6d68e-125">**说明**</span><span class="sxs-lookup"><span data-stu-id="6d68e-125">**Description**</span></span>  
 <span data-ttu-id="6d68e-126">提供订阅的说明。</span><span class="sxs-lookup"><span data-stu-id="6d68e-126">Provide a description for the subscription.</span></span> <span data-ttu-id="6d68e-127">该说明将显示在 **“我的订阅”** 中的订阅列表内以及报表的 **“订阅”** 选项卡中。</span><span class="sxs-lookup"><span data-stu-id="6d68e-127">The description appears in subscription lists in **My Subscriptions** and in the **Subscriptions** tab of the report.</span></span>  
  
 <span data-ttu-id="6d68e-128">**指定通知收件人的方式**</span><span class="sxs-lookup"><span data-stu-id="6d68e-128">**Specify how recipients are notified**</span></span>  
 <span data-ttu-id="6d68e-129">选择用于分发报表的传递扩展插件。</span><span class="sxs-lookup"><span data-stu-id="6d68e-129">Select the delivery extension to use to distribute the report.</span></span> <span data-ttu-id="6d68e-130">每个订阅只能使用一个传递扩展插件。</span><span class="sxs-lookup"><span data-stu-id="6d68e-130">Only one delivery extension can be used for each subscription.</span></span> <span data-ttu-id="6d68e-131">提供了以下选项：</span><span class="sxs-lookup"><span data-stu-id="6d68e-131">The following options are available:</span></span>  
  
-   <span data-ttu-id="6d68e-132">选择 **“报表服务器文件共享”** 可以将报表传递到文件共享位置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-132">Select **Report Server File Share** to deliver reports to a file share.</span></span> <span data-ttu-id="6d68e-133">报表将作为静态文件传递，并断开与报表服务器的连接。</span><span class="sxs-lookup"><span data-stu-id="6d68e-133">The report will be delivered as a static file, disconnected from the report server.</span></span> <span data-ttu-id="6d68e-134">有关详细信息，请参阅 [File Share Delivery in Reporting Services](subscriptions/file-share-delivery-in-reporting-services.md)。</span><span class="sxs-lookup"><span data-stu-id="6d68e-134">For more information, see [File Share Delivery in Reporting Services](subscriptions/file-share-delivery-in-reporting-services.md).</span></span>  
  
-   <span data-ttu-id="6d68e-135">选择 **“报表服务器电子邮件”** 可以将报表传递到电子邮件收件箱。</span><span class="sxs-lookup"><span data-stu-id="6d68e-135">Select **Report Server E-Mail** to deliver reports to an e-mail inbox.</span></span> <span data-ttu-id="6d68e-136">有关详细信息，请参阅 [Reporting Services 中的电子邮件传递](subscriptions/e-mail-delivery-in-reporting-services.md)。</span><span class="sxs-lookup"><span data-stu-id="6d68e-136">For more information, see [E-Mail Delivery in Reporting Services](subscriptions/e-mail-delivery-in-reporting-services.md).</span></span>  
  
-   <span data-ttu-id="6d68e-137">选择 **“Null 传递提供程序”** 可以将报表传递到报表服务器数据库。</span><span class="sxs-lookup"><span data-stu-id="6d68e-137">Select **Null Delivery Provider** to deliver reports to the report server database.</span></span> <span data-ttu-id="6d68e-138">使用此选项可创建报表快照。</span><span class="sxs-lookup"><span data-stu-id="6d68e-138">This option creates report snapshots.</span></span> <span data-ttu-id="6d68e-139">如果希望按照特定计划将用户特定的报表快照或参数化报表快照预先上载到报表服务器，则可以使用此选项。</span><span class="sxs-lookup"><span data-stu-id="6d68e-139">Choose this option when you want to preload the report server with user-specific or parameterized report snapshots on a specific schedule.</span></span> <span data-ttu-id="6d68e-140">有关详细信息，请参阅 [缓存报表 (SSRS)](report-server/caching-reports-ssrs.md)版本中预加载缓存的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="6d68e-140">For more information, see [Caching Reports &#40;SSRS&#41;](report-server/caching-reports-ssrs.md).</span></span>  
  
 <span data-ttu-id="6d68e-141">**指定包含收件人信息的数据源**</span><span class="sxs-lookup"><span data-stu-id="6d68e-141">**Specify a data source that contains recipient information**</span></span>  
 <span data-ttu-id="6d68e-142">指定如何定义数据源连接。</span><span class="sxs-lookup"><span data-stu-id="6d68e-142">Specify how the data source connection is defined.</span></span> <span data-ttu-id="6d68e-143">您可以选择包含所需连接信息的共享数据源。</span><span class="sxs-lookup"><span data-stu-id="6d68e-143">You can choose a shared data source if you have one that contains the connection information you need.</span></span> <span data-ttu-id="6d68e-144">还可以直接在此订阅中指定连接信息。</span><span class="sxs-lookup"><span data-stu-id="6d68e-144">You can also specify connection information directly in this subscription.</span></span>  
  
 <span data-ttu-id="6d68e-145">数据源可提供订阅方数据。</span><span class="sxs-lookup"><span data-stu-id="6d68e-145">The data source provides subscriber data.</span></span> <span data-ttu-id="6d68e-146">这些数据可能包含雇员姓名、雇员 ID、电子邮件地址和导出格式的首选设置信息（如 HTML 或 PDF）等。</span><span class="sxs-lookup"><span data-stu-id="6d68e-146">This data might consist of employee names, employee IDs, e-mail addresses, and preferences for export formats (such as HTML or PDF).</span></span> <span data-ttu-id="6d68e-147">如果使用的是报表服务器电子邮件传递扩展插件，则该数据源应包含电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="6d68e-147">If you are using the report server e-mail delivery extension, the data source should contain e-mail addresses.</span></span>  
  
## <a name="specify-a-connection-page-2"></a><span data-ttu-id="6d68e-148">指定连接（第 2 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-148">Specify a Connection (Page 2)</span></span>  
 <span data-ttu-id="6d68e-149">如果指定了共享数据源，请使用此页来选择共享数据源项。</span><span class="sxs-lookup"><span data-stu-id="6d68e-149">If you specified a shared data source, use this page to select the shared data source item.</span></span> <span data-ttu-id="6d68e-150">可以使用树结构进行导航并选择项。</span><span class="sxs-lookup"><span data-stu-id="6d68e-150">You can use the tree control to navigate to and select the item.</span></span> <span data-ttu-id="6d68e-151">如果正在为此订阅定义连接，请使用此页来指定以下选项：</span><span class="sxs-lookup"><span data-stu-id="6d68e-151">If you are defining a connection for this subscription, use this page to specify the following options.</span></span>  
  
 <span data-ttu-id="6d68e-152">**连接类型**</span><span class="sxs-lookup"><span data-stu-id="6d68e-152">**Connection Type**</span></span>  
 <span data-ttu-id="6d68e-153">选择用于数据源的数据处理扩展插件。</span><span class="sxs-lookup"><span data-stu-id="6d68e-153">Select which data processing extension to use with the data source.</span></span>  
  
 <span data-ttu-id="6d68e-154">**连接字符串**</span><span class="sxs-lookup"><span data-stu-id="6d68e-154">**Connection String**</span></span>  
 <span data-ttu-id="6d68e-155">键入用于连接数据源的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="6d68e-155">Type a connection string to use to connect to the data source.</span></span>  
  
 <span data-ttu-id="6d68e-156">**连接使用**</span><span class="sxs-lookup"><span data-stu-id="6d68e-156">**Connect Using**</span></span>  
 <span data-ttu-id="6d68e-157">键入连接数据源时要使用的凭据。</span><span class="sxs-lookup"><span data-stu-id="6d68e-157">Type the credentials to use when connecting to the data source.</span></span> <span data-ttu-id="6d68e-158">这些凭据以加密值的形式存储在报表服务器数据库中。</span><span class="sxs-lookup"><span data-stu-id="6d68e-158">The credentials are stored as encrypted values in the report server database.</span></span>  
  
 <span data-ttu-id="6d68e-159">如果数据源使用 Windows 身份验证，请在指定连接时选择 **“用作 Windows 凭据”** 。</span><span class="sxs-lookup"><span data-stu-id="6d68e-159">If the data source uses Windows Authentication, select **Use as Windows credentials** when specifying the connection.</span></span>  
  
 <span data-ttu-id="6d68e-160">如果所使用的数据源不对用户连接进行身份验证（例如，如果数据源是 XML 文件），则无需选择“凭据”。</span><span class="sxs-lookup"><span data-stu-id="6d68e-160">If you are using a data source that does not authenticate user connections (for example, if the data source is an XML file), select Credentials are not required.</span></span> <span data-ttu-id="6d68e-161">此选项要求您以前配置过无人参与的执行帐户。</span><span class="sxs-lookup"><span data-stu-id="6d68e-161">This option requires that you previously configured the unattended execution account.</span></span> <span data-ttu-id="6d68e-162">有关详细信息，请参阅[配置无人参与的执行帐户（SSRS 配置管理器）](install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="6d68e-162">For more information, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span>  
  
## <a name="specify-a-query-page-3"></a><span data-ttu-id="6d68e-163">指定查询（第 3 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-163">Specify a Query (Page 3)</span></span>  
 <span data-ttu-id="6d68e-164">使用此页可以输入用来检索订阅服务器数据的查询。</span><span class="sxs-lookup"><span data-stu-id="6d68e-164">Use this page to enter the query that retrieves subscriber data.</span></span> <span data-ttu-id="6d68e-165">为了实现最佳效果，在数据驱动的订阅中使用该查询之前，请先在 SQL Server Management Studio 中运行该查询。</span><span class="sxs-lookup"><span data-stu-id="6d68e-165">For best result, run the query in SQL Server Management Studio first, before using it in the data-driven subscription.</span></span> <span data-ttu-id="6d68e-166">之后可以检查查询结果，验证它是否包含所需的信息。</span><span class="sxs-lookup"><span data-stu-id="6d68e-166">You can then examine the results to verify that it contains the information you require.</span></span> <span data-ttu-id="6d68e-167">对于查询结果，请注意下面的几个要点：</span><span class="sxs-lookup"><span data-stu-id="6d68e-167">Important points to recognize about the query results are:</span></span>  
  
-   <span data-ttu-id="6d68e-168">结果集内的列确定可以为传递选项和报表参数指定的值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-168">Columns in the result set determine the values that you can specify for delivery options and report parameters.</span></span> <span data-ttu-id="6d68e-169">例如，如果要为电子邮件传递创建数据驱动订阅，则应当拥有一列电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="6d68e-169">For example, if you are creating a data-driven subscription for e-mail delivery, you should have a column of e-mail addresses.</span></span>  
  
-   <span data-ttu-id="6d68e-170">结果集内的行决定了所生成的报表传递的数量。</span><span class="sxs-lookup"><span data-stu-id="6d68e-170">Rows in the result set determine the number of report deliveries that are generated.</span></span> <span data-ttu-id="6d68e-171">如果您有 10,000 行，则报表服务器将生成 10,000 个通知和传递。</span><span class="sxs-lookup"><span data-stu-id="6d68e-171">If you have 10,000 rows, the report server will generate 10,000 notifications and deliveries.</span></span>  
  
 <span data-ttu-id="6d68e-172">**查询**</span><span class="sxs-lookup"><span data-stu-id="6d68e-172">**Query**</span></span>  
 <span data-ttu-id="6d68e-173">指定检索为每个订阅收件人都包含一行相关信息的结果集的 SQL 查询或命令。</span><span class="sxs-lookup"><span data-stu-id="6d68e-173">Specify a SQL query or a command that retrieves a result set that contains one row for each recipient of the subscription.</span></span> <span data-ttu-id="6d68e-174">该结果集将在后续页上用于填充数据驱动扩展插件设置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-174">On subsequent pages, the result set is used to populate data-driven extension settings.</span></span>  
  
 <span data-ttu-id="6d68e-175">**超时**</span><span class="sxs-lookup"><span data-stu-id="6d68e-175">**Timeout**</span></span>  
 <span data-ttu-id="6d68e-176">指定查询超时值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-176">Specify a query time-out value.</span></span> <span data-ttu-id="6d68e-177">此值必须足够大才能完成查询处理。</span><span class="sxs-lookup"><span data-stu-id="6d68e-177">This value must be large enough to complete query processing.</span></span>  
  
 <span data-ttu-id="6d68e-178">**验证**</span><span class="sxs-lookup"><span data-stu-id="6d68e-178">**Validate**</span></span>  
 <span data-ttu-id="6d68e-179">单击 **“验证”** 可以验证该查询。</span><span class="sxs-lookup"><span data-stu-id="6d68e-179">Click **Validate** to verify the query.</span></span> <span data-ttu-id="6d68e-180">查询必须产生有效的结果才能继续。</span><span class="sxs-lookup"><span data-stu-id="6d68e-180">The query must produce valid results before you can continue.</span></span> <span data-ttu-id="6d68e-181">如果未单击 **“验证”**，查询将在您单击 **“下一步”** 时进行验证。</span><span class="sxs-lookup"><span data-stu-id="6d68e-181">If you do not click **Validate**, the query is validated when you click **Next**.</span></span>  
  
## <a name="set-delivery-options-page-4"></a><span data-ttu-id="6d68e-182">设置传递选项（第 4 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-182">Set Delivery Options (Page 4)</span></span>  
 <span data-ttu-id="6d68e-183">在第四页上，您可以指定传递扩展插件选项。</span><span class="sxs-lookup"><span data-stu-id="6d68e-183">On the fourth page, you specify delivery extension options.</span></span> <span data-ttu-id="6d68e-184">该页上出现的选项由传递扩展插件派生而来。</span><span class="sxs-lookup"><span data-stu-id="6d68e-184">The options that appear on the page are derived from the delivery extension.</span></span> <span data-ttu-id="6d68e-185">指定这些选项的方式可能随传递扩展插件显示选项的方式而有所不同。</span><span class="sxs-lookup"><span data-stu-id="6d68e-185">How you specify those options can vary considerably based on how the delivery extension presents them.</span></span> <span data-ttu-id="6d68e-186">如果尚未设置扩展插件，则此页上不会显示任何选项。</span><span class="sxs-lookup"><span data-stu-id="6d68e-186">If the extension has no settings, no options appear on this page.</span></span>  
  
|<span data-ttu-id="6d68e-187">选择此选项</span><span class="sxs-lookup"><span data-stu-id="6d68e-187">Select this</span></span>|<span data-ttu-id="6d68e-188">要执行此操作</span><span class="sxs-lookup"><span data-stu-id="6d68e-188">To do this</span></span>|  
|-----------------|----------------|  
|<span data-ttu-id="6d68e-189">**指定静态值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-189">**Specify a static value**</span></span>|<span data-ttu-id="6d68e-190">为传递设置指定常数值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-190">Use a constant value for the delivery setting.</span></span> <span data-ttu-id="6d68e-191">有些传递扩展插件提供可选的静态值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-191">Some delivery extensions provide static values that you can choose from.</span></span> <span data-ttu-id="6d68e-192">例如，报表服务器电子邮件传递扩展插件可为 **“包括报表”**、 **“呈现格式”**、 **“优先级”** 和 **“包括链接”** 提供值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-192">For example, report server e-mail delivery provides values for **IncludeReport**, **RenderFormat**, **Priority**, and **Include Link**.</span></span>|  
|<span data-ttu-id="6d68e-193">**从数据库获取值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-193">**Get the value from the database**</span></span>|<span data-ttu-id="6d68e-194">使用结果集中的值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-194">Use a value from the result set.</span></span> <span data-ttu-id="6d68e-195">结果集的列可用来提供订阅服务器数据和报表参数值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-195">The columns of the result set can be used to provide subscriber data and report parameter values.</span></span>|  
|<span data-ttu-id="6d68e-196">**无值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-196">**No value**</span></span>|<span data-ttu-id="6d68e-197">省略订阅设置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-197">Omit the setting from the subscription.</span></span>|  
  
#### <a name="set-delivery-options-for-file-share-delivery"></a><span data-ttu-id="6d68e-198">为文件共享传递设置传递选项</span><span class="sxs-lookup"><span data-stu-id="6d68e-198">Set Delivery Options for File Share Delivery</span></span>  
 <span data-ttu-id="6d68e-199">通常将使用文件共享传递扩展插件，因为它不需要预先配置。</span><span class="sxs-lookup"><span data-stu-id="6d68e-199">The file share delivery extension is often used because it requires no prior configuration.</span></span> <span data-ttu-id="6d68e-200">如果使用的是文件共享传递扩展插件，则可以通过下表来了解可以设置的选项：</span><span class="sxs-lookup"><span data-stu-id="6d68e-200">If you are using the file share delivery extension, the following table describes the options you can set:</span></span>  
  
 <span data-ttu-id="6d68e-201">**文件名**</span><span class="sxs-lookup"><span data-stu-id="6d68e-201">**File name**</span></span>  
 <span data-ttu-id="6d68e-202">指定报表的文件名。</span><span class="sxs-lookup"><span data-stu-id="6d68e-202">Specifies a file name for the report.</span></span> <span data-ttu-id="6d68e-203">文件共享传递扩展插件以静态应用程序文件形式将报表传递到共享文件夹。</span><span class="sxs-lookup"><span data-stu-id="6d68e-203">The file share delivery extension delivers a report as a static application file to a shared folder.</span></span> <span data-ttu-id="6d68e-204">在多数情况下，应当使用数据库中的值来创建文件名。</span><span class="sxs-lookup"><span data-stu-id="6d68e-204">In most cases, you should use a value from the database to create the file name.</span></span> <span data-ttu-id="6d68e-205">根据写入模式的设置方式，使用静态值将导致每个新传递覆盖上一个传递。</span><span class="sxs-lookup"><span data-stu-id="6d68e-205">Depending on how you set the write mode, using a static value will cause each new delivery to overwrite the previous delivery.</span></span>  
  
 <span data-ttu-id="6d68e-206">**路径**</span><span class="sxs-lookup"><span data-stu-id="6d68e-206">**Path**</span></span>  
 <span data-ttu-id="6d68e-207">指定一个可以通过网络连接访问的共享文件夹。</span><span class="sxs-lookup"><span data-stu-id="6d68e-207">Specify a shared folder that is accessible over a network connection.</span></span> <span data-ttu-id="6d68e-208">若要验证文件夹是否可访问，请在 "开始" 菜单上单击 "**运行**"，然后按以下格式输入文件夹路径： \\ \\<computername \> \\<共享 \> 。</span><span class="sxs-lookup"><span data-stu-id="6d68e-208">To verify that folder is accessible, click **Run** on the Start menu and enter the folder path in this format: \\\\<computername\>\\<sharedfoldername\>.</span></span>  
  
 <span data-ttu-id="6d68e-209">**呈现格式**</span><span class="sxs-lookup"><span data-stu-id="6d68e-209">**Render format**</span></span>  
 <span data-ttu-id="6d68e-210">指定文件的输出格式。</span><span class="sxs-lookup"><span data-stu-id="6d68e-210">Specify the output format of the file.</span></span> <span data-ttu-id="6d68e-211">报表服务器可以按照报表服务器上所安装的呈现扩展插件的应用程序格式来编写文件。</span><span class="sxs-lookup"><span data-stu-id="6d68e-211">The report server can write the file in application formats of the rendering extensions that are installed on the report server.</span></span>  
  
 <span data-ttu-id="6d68e-212">**写入模式**</span><span class="sxs-lookup"><span data-stu-id="6d68e-212">**Write mode**</span></span>  
 <span data-ttu-id="6d68e-213">指定在找到与某个文件同名的文件时，报表服务器是应当将该文件替换为较新的版本、将较新的版本追加到该文件后面还是放弃传递。</span><span class="sxs-lookup"><span data-stu-id="6d68e-213">Specify whether the report server should replace a file with a newer version, increment it, or drop the delivery if a file of the same name is found.</span></span>  
  
 <span data-ttu-id="6d68e-214">**文件扩展名**</span><span class="sxs-lookup"><span data-stu-id="6d68e-214">**File extension**</span></span>  
 <span data-ttu-id="6d68e-215">如果指定 True，则会追加一个与所选呈现格式相匹配的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="6d68e-215">Specify True to append a file extension that matches the render format you selected.</span></span>  
  
 <span data-ttu-id="6d68e-216">**用户名**</span><span class="sxs-lookup"><span data-stu-id="6d68e-216">**User name**</span></span>  
 <span data-ttu-id="6d68e-217">输入有权将文件添加到共享文件夹的域用户帐户，格式如下： " \<domain> \\<用户名" \> 。</span><span class="sxs-lookup"><span data-stu-id="6d68e-217">Enter the domain user account that has permission to add files to the shared folder in this format: \<domain>\\<username\>.</span></span>  
  
 <span data-ttu-id="6d68e-218">**密码**</span><span class="sxs-lookup"><span data-stu-id="6d68e-218">**Password**</span></span>  
 <span data-ttu-id="6d68e-219">输入帐户的密码。</span><span class="sxs-lookup"><span data-stu-id="6d68e-219">Enter the password for the account.</span></span>  
  
## <a name="set-parameters-page-5"></a><span data-ttu-id="6d68e-220">设置参数（第 5 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-220">Set Parameters (Page 5)</span></span>  
 <span data-ttu-id="6d68e-221">如果报表中含有参数，您必须指定报表要使用的参数值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-221">If a report includes parameters, you must specify which parameter values to use with the report.</span></span> <span data-ttu-id="6d68e-222">可以从订阅服务器数据源中获取参数值（例如，如果您的区域销售报表基于区域代码进行参数化，并且员工数据库中存储了区域信息，您就可以获取每个员工的区域信息）。</span><span class="sxs-lookup"><span data-stu-id="6d68e-222">Parameter values can be obtained from the subscriber data source (for example, if you have a regional sales report that is parameterized based on a regional code, you can obtain region information for each employee if that information is stored in the employee database).</span></span>  
  
|<span data-ttu-id="6d68e-223">选择此选项</span><span class="sxs-lookup"><span data-stu-id="6d68e-223">Select this</span></span>|<span data-ttu-id="6d68e-224">要执行此操作</span><span class="sxs-lookup"><span data-stu-id="6d68e-224">To do this</span></span>|  
|-----------------|----------------|  
|<span data-ttu-id="6d68e-225">**指定静态值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-225">**Specify a static value**</span></span>|<span data-ttu-id="6d68e-226">如果所有订阅服务器要使用相同的参数，则为该参数指定常数值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-226">Use a constant value for the parameter if you want to use the same parameter for all subscribers.</span></span> <span data-ttu-id="6d68e-227">对于多值参数，可以从列表中选择一个值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-227">If the parameter is multi-valued, you can choose a value from the list.</span></span>|  
|<span data-ttu-id="6d68e-228">**使用默认值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-228">**Use Default**</span></span>|<span data-ttu-id="6d68e-229">某些报表中包含了全部或部分参数的默认值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-229">Some reports contain a default value for all or some of the parameters.</span></span> <span data-ttu-id="6d68e-230">如果报表参数具有默认值，请单击此复选框以使用默认值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-230">If the report parameter has a default value, click this checkbox to use it.</span></span>|  
|<span data-ttu-id="6d68e-231">**从数据库获取值**</span><span class="sxs-lookup"><span data-stu-id="6d68e-231">**Get the value from the database**</span></span>|<span data-ttu-id="6d68e-232">使用结果集中的值。</span><span class="sxs-lookup"><span data-stu-id="6d68e-232">Use a value from the result set.</span></span> <span data-ttu-id="6d68e-233">可以选择结果集的列作为数据值的来源，用于每个订阅实例。</span><span class="sxs-lookup"><span data-stu-id="6d68e-233">The columns of the result set can be selected as a source of a data value to use with each subscription instance.</span></span>|  
  
## <a name="specify-a-trigger-page-6"></a><span data-ttu-id="6d68e-234">指定触发器（第 6 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-234">Specify a Trigger (Page 6)</span></span>  
 <span data-ttu-id="6d68e-235">选择一个用来启动订阅处理的事件。</span><span class="sxs-lookup"><span data-stu-id="6d68e-235">Select an event that initiates subscription processing.</span></span>  
  
|<span data-ttu-id="6d68e-236">选择此选项</span><span class="sxs-lookup"><span data-stu-id="6d68e-236">Select this</span></span>|<span data-ttu-id="6d68e-237">要执行此操作</span><span class="sxs-lookup"><span data-stu-id="6d68e-237">To do this</span></span>|  
|-----------------|----------------|  
|<span data-ttu-id="6d68e-238">**在报表服务器上更新报表数据时**</span><span class="sxs-lookup"><span data-stu-id="6d68e-238">**When the report data is updated on the report server**</span></span>|<span data-ttu-id="6d68e-239">如果将报表配置为作为报表执行快照运行，您可以指定在快照刷新时运行订阅。</span><span class="sxs-lookup"><span data-stu-id="6d68e-239">If the report is configured to run as a report execution snapshot, you can specify that the subscription runs when the snapshot is refreshed.</span></span>|  
|<span data-ttu-id="6d68e-240">**根据为此订阅创建的计划**</span><span class="sxs-lookup"><span data-stu-id="6d68e-240">**On a schedule created for this subscription**</span></span>|<span data-ttu-id="6d68e-241">在具体的日期和时间运行该订阅。</span><span class="sxs-lookup"><span data-stu-id="6d68e-241">Run the subscription at a specific date and time.</span></span>|  
|<span data-ttu-id="6d68e-242">**根据共享计划**</span><span class="sxs-lookup"><span data-stu-id="6d68e-242">**On a shared schedule**</span></span>|<span data-ttu-id="6d68e-243">使用通过共享计划提供的计划信息运行该订阅。</span><span class="sxs-lookup"><span data-stu-id="6d68e-243">Run the subscription using schedule information provided through a shared schedule.</span></span>|  
  
## <a name="schedule-a-subscription-page-7"></a><span data-ttu-id="6d68e-244">计划订阅（第 7 页）</span><span class="sxs-lookup"><span data-stu-id="6d68e-244">Schedule a Subscription (Page 7)</span></span>  
 <span data-ttu-id="6d68e-245">要安排订阅，您必须指定报表传递的频率。</span><span class="sxs-lookup"><span data-stu-id="6d68e-245">If you schedule the subscription, you must specify the frequency with which the report is delivered.</span></span> <span data-ttu-id="6d68e-246">第一组选项指定频率的类别（每小时、每天、每周等）。</span><span class="sxs-lookup"><span data-stu-id="6d68e-246">The first set of options specifies a category of frequency (hourly, daily, weekly, and so on).</span></span> <span data-ttu-id="6d68e-247">第二组选项的显示方式由最初的选择决定。</span><span class="sxs-lookup"><span data-stu-id="6d68e-247">The second set of option that appears is based on your initial selection.</span></span>  
  
 <span data-ttu-id="6d68e-248">**每小时**</span><span class="sxs-lookup"><span data-stu-id="6d68e-248">**Hourly**</span></span>  
 <span data-ttu-id="6d68e-249">将计划定义为每小时运行一次。</span><span class="sxs-lookup"><span data-stu-id="6d68e-249">Define a schedule that runs at hourly intervals.</span></span>  
  
 <span data-ttu-id="6d68e-250">**每日**</span><span class="sxs-lookup"><span data-stu-id="6d68e-250">**Daily**</span></span>  
 <span data-ttu-id="6d68e-251">可以将计划定义为在所选日期的具体时间运行。</span><span class="sxs-lookup"><span data-stu-id="6d68e-251">Define a schedule that runs on the days you select at a specific hour and minute.</span></span> <span data-ttu-id="6d68e-252">您可以按以下方式指定日期：每日 *\<day>* 、每个工作日和 *\<number>* 每天。</span><span class="sxs-lookup"><span data-stu-id="6d68e-252">You can specify days in the following ways: Every *\<day>*, Every weekday, and Every *\<number>* day.</span></span> <span data-ttu-id="6d68e-253">选择一个选项会禁用其他选项，即使其他天已显示为选中状态也是如此。</span><span class="sxs-lookup"><span data-stu-id="6d68e-253">Choosing one approach voids the others, even if the other days appear to be selected.</span></span>  
  
 <span data-ttu-id="6d68e-254">**每周**</span><span class="sxs-lookup"><span data-stu-id="6d68e-254">**Weekly**</span></span>  
 <span data-ttu-id="6d68e-255">将计划定义为在每周的具体时间运行。</span><span class="sxs-lookup"><span data-stu-id="6d68e-255">Define a schedule that runs at weekly intervals at a specific hour and minute.</span></span> <span data-ttu-id="6d68e-256">时间间隔可以是完整的周（例如，每两周）或一周中的几天。</span><span class="sxs-lookup"><span data-stu-id="6d68e-256">The interval can be in complete weeks (for example, every two weeks) or days within a week.</span></span>  
  
 <span data-ttu-id="6d68e-257">**每月**</span><span class="sxs-lookup"><span data-stu-id="6d68e-257">**Monthly**</span></span>  
 <span data-ttu-id="6d68e-258">将计划定义为每月运行一次。</span><span class="sxs-lookup"><span data-stu-id="6d68e-258">Define a schedule that runs on a monthly basis.</span></span> <span data-ttu-id="6d68e-259">在一个月中，您可以基于某种模式选择一天（如每个月最后一个星期日）或选择特定日期（如 1 和 15，表示每个月的第 1 天和第 15 天）。</span><span class="sxs-lookup"><span data-stu-id="6d68e-259">Within a month, you can choose a day based on a pattern (for example, the last Sunday of every month) or specific calendar dates (such as 1 and 15 to indicate the first and fifteenth day of every month).</span></span> <span data-ttu-id="6d68e-260">可以通过使用逗号和连字符指定多个日期和范围，例如 1, 5, 7-12, 21。</span><span class="sxs-lookup"><span data-stu-id="6d68e-260">Using commas and hyphens, you can specify multiple days and ranges, for example, 1, 5, 7-12, 21.</span></span>  
  
 <span data-ttu-id="6d68e-261">**曾经**</span><span class="sxs-lookup"><span data-stu-id="6d68e-261">**Once**</span></span>  
 <span data-ttu-id="6d68e-262">定义只运行一次的计划。</span><span class="sxs-lookup"><span data-stu-id="6d68e-262">Define a schedule that runs only once.</span></span> <span data-ttu-id="6d68e-263">使用 **“开始日期和结束日期”** 部分可以指定运行计划的日期。</span><span class="sxs-lookup"><span data-stu-id="6d68e-263">Use the **Start and end dates** section to specify the day on which to run the schedule.</span></span> <span data-ttu-id="6d68e-264">计划处理完后即过期。</span><span class="sxs-lookup"><span data-stu-id="6d68e-264">This schedule expires as soon as it is processed.</span></span>  
  
 <span data-ttu-id="6d68e-265">**“开始日期和结束日期”**</span><span class="sxs-lookup"><span data-stu-id="6d68e-265">**Start and end dates**</span></span>  
 <span data-ttu-id="6d68e-266">通过此选项可以指定开始日期（确定计划何时生效）和结束日期（确定计划何时过期）。</span><span class="sxs-lookup"><span data-stu-id="6d68e-266">Specify a start date that determines when the schedule takes effect and an end date that determines when the schedule expires.</span></span> <span data-ttu-id="6d68e-267">计划过期时并无通知。</span><span class="sxs-lookup"><span data-stu-id="6d68e-267">Schedules expire without notification.</span></span> <span data-ttu-id="6d68e-268">结束日期后，计划将不再运行。</span><span class="sxs-lookup"><span data-stu-id="6d68e-268">After the end date, a schedule no longer runs.</span></span>  
  
## <a name="saving-the-subscription"></a><span data-ttu-id="6d68e-269">保存订阅</span><span class="sxs-lookup"><span data-stu-id="6d68e-269">Saving the Subscription</span></span>  
 <span data-ttu-id="6d68e-270">如果提供了必需的订阅信息， **“完成”** 按钮将为启用状态。</span><span class="sxs-lookup"><span data-stu-id="6d68e-270">The **Finish** button is enabled when there is enough information for the subscription.</span></span> <span data-ttu-id="6d68e-271">单击 **“完成”** 即可完成创建订阅。</span><span class="sxs-lookup"><span data-stu-id="6d68e-271">Click **Finish** to complete the subscription.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6d68e-272">另请参阅</span><span class="sxs-lookup"><span data-stu-id="6d68e-272">See Also</span></span>  
 <span data-ttu-id="6d68e-273">[报表管理器（SSRS 本机模式）](../../2014/reporting-services/report-manager-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="6d68e-273">[Report Manager  &#40;SSRS Native Mode&#41;](../../2014/reporting-services/report-manager-ssrs-native-mode.md) </span></span>  
 <span data-ttu-id="6d68e-274">[Data-Driven Subscriptions](subscriptions/data-driven-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="6d68e-274">[Data-Driven Subscriptions](subscriptions/data-driven-subscriptions.md) </span></span>  
 <span data-ttu-id="6d68e-275">[创建数据驱动订阅（SSRS 教程）](create-a-data-driven-subscription-ssrs-tutorial.md) </span><span class="sxs-lookup"><span data-stu-id="6d68e-275">[Create a Data-Driven Subscription &#40;SSRS Tutorial&#41;](create-a-data-driven-subscription-ssrs-tutorial.md) </span></span>  
 <span data-ttu-id="6d68e-276">[为报表数据源指定凭据和连接信息](report-data/specify-credential-and-connection-information-for-report-data-sources.md) </span><span class="sxs-lookup"><span data-stu-id="6d68e-276">[Specify Credential and Connection Information for Report Data Sources](report-data/specify-credential-and-connection-information-for-report-data-sources.md) </span></span>  
 <span data-ttu-id="6d68e-277">[订阅和传递 (Reporting Services)](subscriptions/subscriptions-and-delivery-reporting-services.md) </span><span class="sxs-lookup"><span data-stu-id="6d68e-277">[Subscriptions and Delivery &#40;Reporting Services&#41;](subscriptions/subscriptions-and-delivery-reporting-services.md) </span></span>  
 [<span data-ttu-id="6d68e-278">报表管理器的 F1 帮助</span><span class="sxs-lookup"><span data-stu-id="6d68e-278">Report Manager F1 Help</span></span>](../../2014/reporting-services/report-manager-f1-help.md)  
  
  
