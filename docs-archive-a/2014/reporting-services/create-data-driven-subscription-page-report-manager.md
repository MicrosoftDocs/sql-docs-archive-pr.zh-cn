---
title: 创建数据驱动订阅页 (报表管理器) |Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 814b4653-572a-48c7-847f-b310ba0f3046
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 684575697202c26a6946e4bba6146a61342c130d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579523"
---
# <a name="create-data-driven-subscription-page-report-manager"></a>“创建数据驱动订阅”页（报表管理器）
  使用“创建数据驱动订阅”页可以生成或修改订阅，每次运行订阅时，都会在订阅服务器数据库中查询订阅信息。 数据驱动订阅使用查询结果来确定订阅的收件人、传递设置和报表参数值。 在运行时，报表服务器将运行一个查询，以获取订阅设置所需的值。 可以使用“创建数据驱动订阅”页来定义查询并将查询值赋予订阅设置。 为数据驱动订阅指定的值和选项分别位于若干个页面上，类似于向导。 总共有七个页面。  
  
 要创建数据驱动订阅，您必须了解如何编写查询或命令来获取订阅的数据。 还必须有一个数据存储区包含要用于订阅的订阅服务器数据（例如，订阅服务器名称和电子邮件地址）。  
  
 具有高级权限的用户可以使用此页。 如果使用的是默认的安全设置，则位于“我的报表”文件夹的报表将无法使用数据驱动订阅。  
  
> [!NOTE]  
>  并非在 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]的每个版本中均提供此功能。 有关各个版本支持的功能列表 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ，请参阅 SQL Server 2014 的各个[版本支持的功能](../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md)。  
  
## <a name="navigation"></a>导航  
 使用以下过程导航到用户界面 (UI) 中的这一位置。  
  
###### <a name="to-open-the-data-driven-subscription-page"></a>打开“数据驱动订阅”页  
  
1.  打开报表管理器，找到要为其创建数据驱动订阅的报表。  
  
2.  悬停在该报表之上，然后单击下拉箭头。  
  
3.  在下拉菜单中，单击 **“管理”**。 这会打开该报表的 "**常规**属性" 页。  
  
4.  选择 **“订阅”** 选项卡，然后单击 **“新建数据驱动订阅”**。  
  
    > [!NOTE]  
    >  报表数据源必须使用存储的凭据，此按钮才可用。  
  
## <a name="start-a-subscription-page-1"></a>开始创建订阅（第 1 页）  
 **说明**  
 提供订阅的说明。 该说明将显示在 **“我的订阅”** 中的订阅列表内以及报表的 **“订阅”** 选项卡中。  
  
 **指定通知收件人的方式**  
 选择用于分发报表的传递扩展插件。 每个订阅只能使用一个传递扩展插件。 提供了以下选项：  
  
-   选择 **“报表服务器文件共享”** 可以将报表传递到文件共享位置。 报表将作为静态文件传递，并断开与报表服务器的连接。 有关详细信息，请参阅 [File Share Delivery in Reporting Services](subscriptions/file-share-delivery-in-reporting-services.md)。  
  
-   选择 **“报表服务器电子邮件”** 可以将报表传递到电子邮件收件箱。 有关详细信息，请参阅 [Reporting Services 中的电子邮件传递](subscriptions/e-mail-delivery-in-reporting-services.md)。  
  
-   选择 **“Null 传递提供程序”** 可以将报表传递到报表服务器数据库。 使用此选项可创建报表快照。 如果希望按照特定计划将用户特定的报表快照或参数化报表快照预先上载到报表服务器，则可以使用此选项。 有关详细信息，请参阅 [缓存报表 (SSRS)](report-server/caching-reports-ssrs.md)版本中预加载缓存的唯一方法。  
  
 **指定包含收件人信息的数据源**  
 指定如何定义数据源连接。 您可以选择包含所需连接信息的共享数据源。 还可以直接在此订阅中指定连接信息。  
  
 数据源可提供订阅方数据。 这些数据可能包含雇员姓名、雇员 ID、电子邮件地址和导出格式的首选设置信息（如 HTML 或 PDF）等。 如果使用的是报表服务器电子邮件传递扩展插件，则该数据源应包含电子邮件地址。  
  
## <a name="specify-a-connection-page-2"></a>指定连接（第 2 页）  
 如果指定了共享数据源，请使用此页来选择共享数据源项。 可以使用树结构进行导航并选择项。 如果正在为此订阅定义连接，请使用此页来指定以下选项：  
  
 **连接类型**  
 选择用于数据源的数据处理扩展插件。  
  
 **连接字符串**  
 键入用于连接数据源的连接字符串。  
  
 **连接使用**  
 键入连接数据源时要使用的凭据。 这些凭据以加密值的形式存储在报表服务器数据库中。  
  
 如果数据源使用 Windows 身份验证，请在指定连接时选择 **“用作 Windows 凭据”** 。  
  
 如果所使用的数据源不对用户连接进行身份验证（例如，如果数据源是 XML 文件），则无需选择“凭据”。 此选项要求您以前配置过无人参与的执行帐户。 有关详细信息，请参阅[配置无人参与的执行帐户（SSRS 配置管理器）](install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。  
  
## <a name="specify-a-query-page-3"></a>指定查询（第 3 页）  
 使用此页可以输入用来检索订阅服务器数据的查询。 为了实现最佳效果，在数据驱动的订阅中使用该查询之前，请先在 SQL Server Management Studio 中运行该查询。 之后可以检查查询结果，验证它是否包含所需的信息。 对于查询结果，请注意下面的几个要点：  
  
-   结果集内的列确定可以为传递选项和报表参数指定的值。 例如，如果要为电子邮件传递创建数据驱动订阅，则应当拥有一列电子邮件地址。  
  
-   结果集内的行决定了所生成的报表传递的数量。 如果您有 10,000 行，则报表服务器将生成 10,000 个通知和传递。  
  
 **查询**  
 指定检索为每个订阅收件人都包含一行相关信息的结果集的 SQL 查询或命令。 该结果集将在后续页上用于填充数据驱动扩展插件设置。  
  
 **超时**  
 指定查询超时值。 此值必须足够大才能完成查询处理。  
  
 **验证**  
 单击 **“验证”** 可以验证该查询。 查询必须产生有效的结果才能继续。 如果未单击 **“验证”**，查询将在您单击 **“下一步”** 时进行验证。  
  
## <a name="set-delivery-options-page-4"></a>设置传递选项（第 4 页）  
 在第四页上，您可以指定传递扩展插件选项。 该页上出现的选项由传递扩展插件派生而来。 指定这些选项的方式可能随传递扩展插件显示选项的方式而有所不同。 如果尚未设置扩展插件，则此页上不会显示任何选项。  
  
|选择此选项|要执行此操作|  
|-----------------|----------------|  
|**指定静态值**|为传递设置指定常数值。 有些传递扩展插件提供可选的静态值。 例如，报表服务器电子邮件传递扩展插件可为 **“包括报表”**、 **“呈现格式”**、 **“优先级”** 和 **“包括链接”** 提供值。|  
|**从数据库获取值**|使用结果集中的值。 结果集的列可用来提供订阅服务器数据和报表参数值。|  
|**无值**|省略订阅设置。|  
  
#### <a name="set-delivery-options-for-file-share-delivery"></a>为文件共享传递设置传递选项  
 通常将使用文件共享传递扩展插件，因为它不需要预先配置。 如果使用的是文件共享传递扩展插件，则可以通过下表来了解可以设置的选项：  
  
 **文件名**  
 指定报表的文件名。 文件共享传递扩展插件以静态应用程序文件形式将报表传递到共享文件夹。 在多数情况下，应当使用数据库中的值来创建文件名。 根据写入模式的设置方式，使用静态值将导致每个新传递覆盖上一个传递。  
  
 **路径**  
 指定一个可以通过网络连接访问的共享文件夹。 若要验证文件夹是否可访问，请在 "开始" 菜单上单击 "**运行**"，然后按以下格式输入文件夹路径： \\ \\<computername \> \\<共享 \> 。  
  
 **呈现格式**  
 指定文件的输出格式。 报表服务器可以按照报表服务器上所安装的呈现扩展插件的应用程序格式来编写文件。  
  
 **写入模式**  
 指定在找到与某个文件同名的文件时，报表服务器是应当将该文件替换为较新的版本、将较新的版本追加到该文件后面还是放弃传递。  
  
 **文件扩展名**  
 如果指定 True，则会追加一个与所选呈现格式相匹配的文件扩展名。  
  
 **用户名**  
 输入有权将文件添加到共享文件夹的域用户帐户，格式如下： " \<domain> \\<用户名" \> 。  
  
 **密码**  
 输入帐户的密码。  
  
## <a name="set-parameters-page-5"></a>设置参数（第 5 页）  
 如果报表中含有参数，您必须指定报表要使用的参数值。 可以从订阅服务器数据源中获取参数值（例如，如果您的区域销售报表基于区域代码进行参数化，并且员工数据库中存储了区域信息，您就可以获取每个员工的区域信息）。  
  
|选择此选项|要执行此操作|  
|-----------------|----------------|  
|**指定静态值**|如果所有订阅服务器要使用相同的参数，则为该参数指定常数值。 对于多值参数，可以从列表中选择一个值。|  
|**使用默认值**|某些报表中包含了全部或部分参数的默认值。 如果报表参数具有默认值，请单击此复选框以使用默认值。|  
|**从数据库获取值**|使用结果集中的值。 可以选择结果集的列作为数据值的来源，用于每个订阅实例。|  
  
## <a name="specify-a-trigger-page-6"></a>指定触发器（第 6 页）  
 选择一个用来启动订阅处理的事件。  
  
|选择此选项|要执行此操作|  
|-----------------|----------------|  
|**在报表服务器上更新报表数据时**|如果将报表配置为作为报表执行快照运行，您可以指定在快照刷新时运行订阅。|  
|**根据为此订阅创建的计划**|在具体的日期和时间运行该订阅。|  
|**根据共享计划**|使用通过共享计划提供的计划信息运行该订阅。|  
  
## <a name="schedule-a-subscription-page-7"></a>计划订阅（第 7 页）  
 要安排订阅，您必须指定报表传递的频率。 第一组选项指定频率的类别（每小时、每天、每周等）。 第二组选项的显示方式由最初的选择决定。  
  
 **每小时**  
 将计划定义为每小时运行一次。  
  
 **每日**  
 可以将计划定义为在所选日期的具体时间运行。 您可以按以下方式指定日期：每日 *\<day>* 、每个工作日和 *\<number>* 每天。 选择一个选项会禁用其他选项，即使其他天已显示为选中状态也是如此。  
  
 **每周**  
 将计划定义为在每周的具体时间运行。 时间间隔可以是完整的周（例如，每两周）或一周中的几天。  
  
 **每月**  
 将计划定义为每月运行一次。 在一个月中，您可以基于某种模式选择一天（如每个月最后一个星期日）或选择特定日期（如 1 和 15，表示每个月的第 1 天和第 15 天）。 可以通过使用逗号和连字符指定多个日期和范围，例如 1, 5, 7-12, 21。  
  
 **曾经**  
 定义只运行一次的计划。 使用 **“开始日期和结束日期”** 部分可以指定运行计划的日期。 计划处理完后即过期。  
  
 **“开始日期和结束日期”**  
 通过此选项可以指定开始日期（确定计划何时生效）和结束日期（确定计划何时过期）。 计划过期时并无通知。 结束日期后，计划将不再运行。  
  
## <a name="saving-the-subscription"></a>保存订阅  
 如果提供了必需的订阅信息， **“完成”** 按钮将为启用状态。 单击 **“完成”** 即可完成创建订阅。  
  
## <a name="see-also"></a>另请参阅  
 [报表管理器（SSRS 本机模式）](../../2014/reporting-services/report-manager-ssrs-native-mode.md)   
 [Data-Driven Subscriptions](subscriptions/data-driven-subscriptions.md)   
 [创建数据驱动订阅（SSRS 教程）](create-a-data-driven-subscription-ssrs-tutorial.md)   
 [为报表数据源指定凭据和连接信息](report-data/specify-credential-and-connection-information-for-report-data-sources.md)   
 [订阅和传递 (Reporting Services)](subscriptions/subscriptions-and-delivery-reporting-services.md)   
 [报表管理器的 F1 帮助](../../2014/reporting-services/report-manager-f1-help.md)  
  
  
