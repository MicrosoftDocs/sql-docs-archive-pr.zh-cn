---
title: Reporting Services 针对验证的扩展保护 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: eb5c6f4a-3ed5-430b-a712-d5ed4b6b9b2b
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 66a3cf551b70fa564da3fa47eec015a5bbca7e43
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87688503"
---
# <a name="extended-protection-for-authentication-with-reporting-services"></a><span data-ttu-id="9e2bd-102">Reporting Services 针对验证的扩展保护</span><span class="sxs-lookup"><span data-stu-id="9e2bd-102">Extended Protection for Authentication with Reporting Services</span></span>
  <span data-ttu-id="9e2bd-103">扩展保护是针对最新版本的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 操作系统的一组增强功能。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-103">Extended Protection is a set of enhancements to recent versions of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows operating system.</span></span> <span data-ttu-id="9e2bd-104">扩展保护增强了应用程序可用来保护凭据和身份验证的方式。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-104">Extended protection enhances how credentials and authentication can be protected by applications.</span></span> <span data-ttu-id="9e2bd-105">此功能自身并不直接提供保护机制来防止特定攻击（如凭据转发），但它为诸如 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 的应用程序提供了一种基础结构来实施针对验证的扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-105">The feature itself does not directly provide protection against specific attacks such as credential forwarding, but it provides an infrastructure for applications such as [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] to enforce Extended Protection for Authentication.</span></span>

 <span data-ttu-id="9e2bd-106">作为扩展保护一部分的主要身份验证增强功能是服务绑定和渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-106">The main authentication enhancements that are part of extended protection are service binding and channel binding.</span></span> <span data-ttu-id="9e2bd-107">渠道绑定使用渠道绑定标记 (CBT)，以验证在两个端点之间建立的渠道不会受到危害。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-107">Channel binding uses a channel binding token (CBT), to verify that the channel established between two end points was not compromised.</span></span> <span data-ttu-id="9e2bd-108">服务绑定使用服务器主体名称 (SPN) 来验证身份验证标记的预期目的地。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-108">Service binding uses Service Principal Names (SPN) to validate the intended destination of authentication tokens.</span></span> <span data-ttu-id="9e2bd-109">有关扩展保护的详细背景信息，请参阅 [Integrated Windows Authentication with Extended Protection（将 Windows 身份验证与扩展保护相集成）](https://go.microsoft.com/fwlink/?LinkId=179922)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-109">For more background information about extended protection, see [Integrated Windows Authentication with Extended Protection](https://go.microsoft.com/fwlink/?LinkId=179922).</span></span>

 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]<span data-ttu-id="9e2bd-110">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]支持并强制实施已在操作系统中启用并在中配置的扩展保护 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-110">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] supports and enforces Extended Protection that has been enabled in the operating system and configured in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="9e2bd-111">默认情况下， [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 接受指定 Negotiate 或 NTLM 身份验证的请求，因此，可能因操作系统中支持扩展保护以及 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 扩展保护功能而受益。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-111">By default, [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] accepts requests that specify Negotiate or NTLM authentication and could therefore benefit from Extended Protection support in the operating system and the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] extended protection features.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="9e2bd-112">默认情况下，Windows 不启用扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-112">By default, Windows does not enable Extended Protection.</span></span> <span data-ttu-id="9e2bd-113">有关如何在 Windows 中启用扩展保护的信息，请参阅 [身份验证的扩展保护](https://go.microsoft.com/fwlink/?LinkID=178431)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-113">For information about how to enable Extended Protection in Windows, see [Extended Protection for Authentication](https://go.microsoft.com/fwlink/?LinkID=178431).</span></span> <span data-ttu-id="9e2bd-114">操作系统和客户端身份验证堆栈必须同时支持扩展保护，身份验证才能成功。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-114">Both the operating system and client authentication stack must support Extended Protection so that authentication succeeds.</span></span> <span data-ttu-id="9e2bd-115">对于较早的操作系统，您可能需要安装多个更新，才能获得完整的支持扩展保护功能的计算机。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-115">For older operating systems you may need to install more than one update for a complete, Extended Protection ready computer.</span></span> <span data-ttu-id="9e2bd-116">有关扩展保护的最新开发动态的信息，请参阅 [updated information with Extended Protection（扩展保护的更新信息）](https://go.microsoft.com/fwlink/?LinkId=183362)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-116">For information on recent developments with Extended Protection, see [updated information with Extended Protection](https://go.microsoft.com/fwlink/?LinkId=183362).</span></span>

## <a name="reporting-services-extended-protection-overview"></a><span data-ttu-id="9e2bd-117">Reporting Services 扩展保护概述</span><span class="sxs-lookup"><span data-stu-id="9e2bd-117">Reporting Services Extended Protection Overview</span></span>
 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]<span data-ttu-id="9e2bd-118">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]支持并强制实施已在操作系统中启用的扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-118">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] supports and enforces extended protection that has been enabled in the operating system.</span></span> <span data-ttu-id="9e2bd-119">如果操作系统不支持扩展保护或者尚未启用操作系统中的此功能， [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 扩展保护功能将无法进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-119">If the operating system does not support extended protection or the feature in the operating system has not been enabled, the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] extended protection feature will fail authentication.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="9e2bd-120">扩展保护还需要 SSL 证书。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-120">Extended Protection also requires an SSL Certificate.</span></span> <span data-ttu-id="9e2bd-121">有关详细信息，请参阅 [配置本机模式报表服务器上的 SSL 连接](configure-ssl-connections-on-a-native-mode-report-server.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-121">For more information, see [Configure SSL Connections on a Native Mode Report Server](configure-ssl-connections-on-a-native-mode-report-server.md)</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="9e2bd-122">默认情况下， [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 不启用扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-122">By default, [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] does not enable Extended Protection.</span></span> <span data-ttu-id="9e2bd-123">可以通过修改 `rsreportserver.config` 配置文件或使用 WMI API 来更新此配置文件，以便启用此功能。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-123">The feature can be enabled by modifying the `rsreportserver.config` configuration file or using WMI APIs to update the configuration file.</span></span> [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]<span data-ttu-id="9e2bd-124">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 不能提供用于修改或查看扩展保护设置的用户界面。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-124">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] does not provide a user interface to modify or view extended protection settings.</span></span> <span data-ttu-id="9e2bd-125">有关详细信息，请参阅本主题中的 [配置设置](#ConfigurationSettings) 部分。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-125">For more information, see the [configuration settings](#ConfigurationSettings) section in this topic.</span></span>

 <span data-ttu-id="9e2bd-126">因更改扩展保护设置或所配置的设置不正确而导致的共同问题并不显示明显的错误消息或对话框窗口。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-126">Common issues that occur because of changes in extended protection settings or incorrectly configured settings are not be exposed with obvious error messages or dialog windows.</span></span> <span data-ttu-id="9e2bd-127">与扩展保护配置和兼容性相关的问题会导致身份验证失败并在 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 跟踪日志中记录错误。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-127">Issues related to extended protection configuration and compatibility result in authentication failures and errors in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] trace logs.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="9e2bd-128">某些数据访问技术可能不支持扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-128">Some data access technologies may not support extended protection.</span></span> <span data-ttu-id="9e2bd-129">数据访问技术用于连接到 SQL Server 数据源和 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 目录数据库。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-129">A data access technology is used to connect to SQL Server data sources and to the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] catalog database.</span></span> <span data-ttu-id="9e2bd-130">未能实现支持扩展保护的数据访问技术将在以下方面影响 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] ：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-130">Failure of a data access technology to support extended protection impacts [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] in the following ways:</span></span>
> 
>  -   <span data-ttu-id="9e2bd-131">运行 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 目录数据库的 SQL Server 无法启用扩展保护，或者，报表服务器将无法成功地连接到目录数据库并且将返回身份验证错误。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-131">The SQL Server that runs the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] catalog database cannot have extended protection enabled or the report server will not successfully connect to the catalog database and return authentication errors.</span></span>
> -   <span data-ttu-id="9e2bd-132">所有用作 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 报表数据源的 SQL Server 都无法启用扩展保护，或者报表服务器尝试连接到报表数据源时将失败并且返回身份验证错误。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-132">SQL Servers that are used as [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] report data sources cannot have extended protection enabled or tries by the report server to connect to the report data source will fail and return authentication errors.</span></span>
> 
>  <span data-ttu-id="9e2bd-133">用于数据访问技术的文档应该具有与支持扩展保护有关的信息。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-133">The documentation for a data access technology should have information about support for extended protection.</span></span>

### <a name="upgrade"></a><span data-ttu-id="9e2bd-134">升级</span><span class="sxs-lookup"><span data-stu-id="9e2bd-134">Upgrade</span></span>

-   <span data-ttu-id="9e2bd-135">通过将 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 服务器升级到 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]，可将具有默认值的配置设置添加到 `rsreportserver.config` 文件。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-135">Upgrading a [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] server to [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] adds configuration settings with default values to the `rsreportserver.config` file.</span></span> <span data-ttu-id="9e2bd-136">如果设置已经存在，则 [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] 安装会将它们保留在文件中 `rsreportserver.config` 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-136">If the settings were already present, the [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] installation will preserve them in the `rsreportserver.config` file.</span></span>

-   <span data-ttu-id="9e2bd-137">将配置设置添加到 `rsreportserver.config` 配置文件时，默认行为是将 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 扩展保护功能设置为关闭，您必须启用此功能，如本主题中所述。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-137">When the configuration settings are added to the `rsreportserver.config` configuration file, the default behavior is for the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] extended protection feature to be off and you must enable the feature as described in this topic.</span></span> <span data-ttu-id="9e2bd-138">有关详细信息，请参阅本主题中的 [配置设置](#ConfigurationSettings) 部分。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-138">For more information, see the [configuration settings](#ConfigurationSettings) section in this topic.</span></span>

-   <span data-ttu-id="9e2bd-139"> 设置的默认值为 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-139">The default value for the setting `RSWindowsExtendedProtectionLevel` is `Off`.</span></span>

-   <span data-ttu-id="9e2bd-140"> 设置的默认值为 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-140">The default value for the setting `RSWindowsExtendedProtectionScenario` is `Proxy`.</span></span>

-   [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="9e2bd-141">升级顾问不验证操作系统或 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 的当前安装是否启用了扩展保护支持。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-141">Upgrade Advisor does not verify that the operating system or the current installation of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] has Extended Protection support enabled.</span></span>

### <a name="what-reporting-services-extended-protection-does-not-cover"></a><span data-ttu-id="9e2bd-142">Reporting Services 扩展保护不涵盖的内容</span><span class="sxs-lookup"><span data-stu-id="9e2bd-142">What Reporting Services extended protection does not cover</span></span>
 <span data-ttu-id="9e2bd-143">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 扩展保护功能不支持以下功能区和方案：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-143">The following feature areas and scenarios are not supported by the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] extended protection feature:</span></span>

-   <span data-ttu-id="9e2bd-144">[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 自定义安全扩展插件的作者必须将对于扩展保护的支持添加到其自定义安全扩展插件。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-144">Authors of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] custom security extensions must add support for extended protection to their custom security extension.</span></span>

-   <span data-ttu-id="9e2bd-145">添加到 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 安装或它使用的第三方组件必须由第三方供应商进行更新以支持扩展保护功能。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-145">Third-party components added to or used by a [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] installation must be updated by the third-party vendor, to support extended protection.</span></span> <span data-ttu-id="9e2bd-146">有关详细信息，请与第三方供应商联系。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-146">For more information, contact the third-party vendor.</span></span>

## <a name="deployment-scenarios-and-recommendations"></a><span data-ttu-id="9e2bd-147">部署方案和建议</span><span class="sxs-lookup"><span data-stu-id="9e2bd-147">Deployment Scenarios and recommendations</span></span>
 <span data-ttu-id="9e2bd-148">以下各方案说明各种不同部署和拓扑，以及使用 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 扩展保护来对它们进行保护的建议配置。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-148">The following scenarios illustrate different deployments and topologies and the recommended configuration to secure them with [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] Extended Protection.</span></span>

### <a name="direct"></a><span data-ttu-id="9e2bd-149">直接</span><span class="sxs-lookup"><span data-stu-id="9e2bd-149">Direct</span></span>
 <span data-ttu-id="9e2bd-150">此方案介绍直接连接到报表服务器（例如 Intranet 环境）。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-150">This scenario describes directly connecting to a report server, for example, an intranet environment.</span></span>

|<span data-ttu-id="9e2bd-151">场景</span><span class="sxs-lookup"><span data-stu-id="9e2bd-151">Scenario</span></span>|<span data-ttu-id="9e2bd-152">方案图</span><span class="sxs-lookup"><span data-stu-id="9e2bd-152">Scenario Diagram</span></span>|<span data-ttu-id="9e2bd-153">保护方式</span><span class="sxs-lookup"><span data-stu-id="9e2bd-153">How to secure</span></span>|
|--------------|----------------------|-------------------|
|<span data-ttu-id="9e2bd-154">直接 SSL 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-154">Direct SSL communication.</span></span><br /><br /> <span data-ttu-id="9e2bd-155">报表服务器将实行“客户端到报表服务器”渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-155">The report server will enforce client to report server Channel Binding.</span></span>|<span data-ttu-id="9e2bd-156">![RS_ExtendedProtection_DirectSSL](../media/rs-extendedprotection-directssl.gif "RS_ExtendedProtection_DirectSSL")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-156">![RS_ExtendedProtection_DirectSSL](../media/rs-extendedprotection-directssl.gif "RS_ExtendedProtection_DirectSSL")</span></span><br /><br /> <span data-ttu-id="9e2bd-157">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-157">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-158">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-158">2) Report server</span></span>|<span data-ttu-id="9e2bd-159">服务绑定不是必需的，因为将使用 SSL 渠道来进行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-159">Service Binding is not necessary because the SSL channel will be used for Channel Binding.</span></span><br /><br /> <span data-ttu-id="9e2bd-160">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-160">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-161">将 `RSWindowsExtendedProtectionScenario` 设置为 `Direct`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-161">Set `RSWindowsExtendedProtectionScenario` to `Direct`.</span></span>|
|<span data-ttu-id="9e2bd-162">直接 HTTP 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-162">Direct HTTP communication.</span></span> <span data-ttu-id="9e2bd-163">报表服务器将实行“客户端到报表服务器”服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-163">The report server will enforce Client to report server Service Binding.</span></span>|<span data-ttu-id="9e2bd-164">![RS_ExtendedProtection_Direct](../media/rs-extendedprotection-direct.gif "RS_ExtendedProtection_Direct")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-164">![RS_ExtendedProtection_Direct](../media/rs-extendedprotection-direct.gif "RS_ExtendedProtection_Direct")</span></span><br /><br /> <span data-ttu-id="9e2bd-165">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-165">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-166">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-166">2) Report server</span></span>|<span data-ttu-id="9e2bd-167">没有 SSL 渠道，因此可能不实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-167">There is no SSL Channel therefore no enforcement of Channel Binding is possible.</span></span><br /><br /> <span data-ttu-id="9e2bd-168">然而，可以使服务绑定生效，否则，由于没有渠道绑定，它将成为不完善的防御机制，服务绑定本身只防止基本威胁。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-168">Service Binding can be validated, however, it is not a complete defense without Channel binding and Service Binding on its own will only protect from basic threats.</span></span><br /><br /> <span data-ttu-id="9e2bd-169">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-169">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-170">将 `RSWindowsExtendedProtectionScenario` 设置为 `Any`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-170">Set `RSWindowsExtendedProtectionScenario` to `Any`.</span></span>|

### <a name="proxy-and-network-load-balancing"></a><span data-ttu-id="9e2bd-171">代理和网络负载平衡</span><span class="sxs-lookup"><span data-stu-id="9e2bd-171">Proxy and Network Load Balancing</span></span>
 <span data-ttu-id="9e2bd-172">客户端应用程序连接到执行 SSL 并向服务器传递凭据以进行身份验证的设备或软件，例如，Extranet、Internet 或安全 Intranet。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-172">Client applications connect to a device or software that performs SSL and passes through the credentials to the server for authentication, for example, an extranet, Internet, or Secure Intranet.</span></span> <span data-ttu-id="9e2bd-173">客户端连接到代理，或者所有客户端都使用代理。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-173">The client connects to a Proxy or all clients use a proxy.</span></span>

 <span data-ttu-id="9e2bd-174">当您使用网络负载平衡 (NLB) 设备时，情形是相同的。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-174">The situation is the same when you are using a Network Load Balancing (NLB) device.</span></span>

|<span data-ttu-id="9e2bd-175">场景</span><span class="sxs-lookup"><span data-stu-id="9e2bd-175">Scenario</span></span>|<span data-ttu-id="9e2bd-176">方案图</span><span class="sxs-lookup"><span data-stu-id="9e2bd-176">Scenario Diagram</span></span>|<span data-ttu-id="9e2bd-177">保护方式</span><span class="sxs-lookup"><span data-stu-id="9e2bd-177">How to secure</span></span>|
|--------------|----------------------|-------------------|
|<span data-ttu-id="9e2bd-178">HTTP 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-178">HTTP communication.</span></span> <span data-ttu-id="9e2bd-179">报表服务器将实行“客户端到报表服务器”服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-179">The report server will enforce client to report server Service Binding.</span></span>|<span data-ttu-id="9e2bd-180">![RS_ExtendedProtection_Indirect](../media/rs-extendedprotection-indirect.gif "RS_ExtendedProtection_Indirect")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-180">![RS_ExtendedProtection_Indirect](../media/rs-extendedprotection-indirect.gif "RS_ExtendedProtection_Indirect")</span></span><br /><br /> <span data-ttu-id="9e2bd-181">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-181">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-182">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-182">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-183">3) 代理</span><span class="sxs-lookup"><span data-stu-id="9e2bd-183">3) Proxy</span></span>|<span data-ttu-id="9e2bd-184">没有 SSL 渠道，因此可能不实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-184">There is no SSL Channel therefore no enforcement of Channel Binding is possible.</span></span><br /><br /> <span data-ttu-id="9e2bd-185">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-185">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-186">将 `RSWindowsExtendedProtectionScenario` 设置为 `Any`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-186">Set `RSWindowsExtendedProtectionScenario` to `Any`.</span></span><br /><br /> <span data-ttu-id="9e2bd-187">请注意，Report Server 必须配置为知道代理服务器的名称，以确保正确地强制执行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-187">Note that the report server must be configured to know the name of the proxy server to make sure that the service binding is correctly enforced.</span></span>|
|<span data-ttu-id="9e2bd-188">HTTP 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-188">HTTP communication.</span></span><br /><br /> <span data-ttu-id="9e2bd-189">报表服务器将实行“客户端到代理”渠道绑定和“客户端到报表服务器”服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-189">The report server will enforce client to Proxy Channel Binding and client to report server Service Binding.</span></span>|<span data-ttu-id="9e2bd-190">![RS_ExtendedProtection_Indirect_SSL](../media/rs-extendedprotection-indirect-ssl.gif "RS_ExtendedProtection_Indirect_SSL")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-190">![RS_ExtendedProtection_Indirect_SSL](../media/rs-extendedprotection-indirect-ssl.gif "RS_ExtendedProtection_Indirect_SSL")</span></span><br /><br /> <span data-ttu-id="9e2bd-191">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-191">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-192">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-192">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-193">3) 代理</span><span class="sxs-lookup"><span data-stu-id="9e2bd-193">3) Proxy</span></span>|<span data-ttu-id="9e2bd-194">到代理的 SSL 渠道是可用的，因此，可以与代理之间实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-194">SSL channel to proxy is available therefore channel binding to the proxy can be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-195">还可以实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-195">Service Binding can also be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-196">报表服务器必须了解代理名称，报表服务器管理员应使用主机标头为代理创建一个 URL 预留，或在 Windows 注册表项 `BackConnectionHostNames` 中配置代理名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-196">The Proxy name must be known to the report server and the report server administrator should either create a URL reservation for it, with a host header or configure the Proxy name in the Windows registry entry `BackConnectionHostNames`.</span></span><br /><br /> <span data-ttu-id="9e2bd-197">`RSWindowsExtendedProtectionLevel`为 `Allow` 或 `Require` 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-197">`RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-198">将 `RSWindowsExtendedProtectionScenario` 设置为 `Proxy`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-198">Set `RSWindowsExtendedProtectionScenario` to `Proxy`.</span></span>|
|<span data-ttu-id="9e2bd-199">与安全代理之间的间接 HTTPS 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-199">Indirect HTTPS communication with a secure proxy.</span></span> <span data-ttu-id="9e2bd-200">报表服务器将实行“客户端到代理”渠道绑定和“客户端到报表服务器”服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-200">Report server will enforce client to proxy Channel Binding and Client to report server Service Binding.</span></span>|<span data-ttu-id="9e2bd-201">![RS_ExtendedProtection_IndirectSSLandHTTPS](../media/rs-extendedprotection-indirectsslandhttps.gif "RS_ExtendedProtection_IndirectSSLandHTTPS")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-201">![RS_ExtendedProtection_IndirectSSLandHTTPS](../media/rs-extendedprotection-indirectsslandhttps.gif "RS_ExtendedProtection_IndirectSSLandHTTPS")</span></span><br /><br /> <span data-ttu-id="9e2bd-202">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-202">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-203">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-203">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-204">3) 代理</span><span class="sxs-lookup"><span data-stu-id="9e2bd-204">3) Proxy</span></span>|<span data-ttu-id="9e2bd-205">到代理的 SSL 渠道是可用的，因此，可以与代理之间实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-205">SSL channel to proxy is available therefore channel binding to the proxy can be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-206">还可以实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-206">Service Binding can also be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-207">报表服务器必须了解代理名称，报表服务器管理员应使用主机标头为代理创建一个 URL 预留，或在 Windows 注册表项 `BackConnectionHostNames` 中配置代理名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-207">The Proxy name must be known to the report server and the report server administrator should either create a URL reservation for it, with a host header or configure the Proxy name in the Windows registry entry `BackConnectionHostNames`.</span></span><br /><br /> <span data-ttu-id="9e2bd-208">`RSWindowsExtendedProtectionLevel`为 `Allow` 或 `Require` 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-208">`RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-209">将 `RSWindowsExtendedProtectionScenario` 设置为 `Proxy`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-209">Set `RSWindowsExtendedProtectionScenario` to `Proxy`.</span></span>|

### <a name="gateway"></a><span data-ttu-id="9e2bd-210">网关</span><span class="sxs-lookup"><span data-stu-id="9e2bd-210">Gateway</span></span>
 <span data-ttu-id="9e2bd-211">此方案介绍连接到执行 SSL 和对用户进行身份验证的设备或软件的客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-211">This scenario describes Client applications connecting to a device or software that performs SSL and authenticates the user.</span></span> <span data-ttu-id="9e2bd-212">接着，此设备或软件模拟用户上下文或其他用户上下文，之后对报表服务器发出请求。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-212">Then the device or software impersonates the user context or a different user context before it makes a request to the report server.</span></span>

|<span data-ttu-id="9e2bd-213">场景</span><span class="sxs-lookup"><span data-stu-id="9e2bd-213">Scenario</span></span>|<span data-ttu-id="9e2bd-214">方案图</span><span class="sxs-lookup"><span data-stu-id="9e2bd-214">Scenario Diagram</span></span>|<span data-ttu-id="9e2bd-215">保护方式</span><span class="sxs-lookup"><span data-stu-id="9e2bd-215">How to secure</span></span>|
|--------------|----------------------|-------------------|
|<span data-ttu-id="9e2bd-216">间接 HTTP 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-216">Indirect HTTP communication.</span></span><br /><br /> <span data-ttu-id="9e2bd-217">网关将实行“客户端到网关”渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-217">Gateway will enforce Client to Gateway channel binding.</span></span> <span data-ttu-id="9e2bd-218">此时具有“网关到报表服务器”服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-218">There is a Gateway to report server Service Binding.</span></span>|<span data-ttu-id="9e2bd-219">![RS_ExtendedProtection_Indirect_SSL](../media/rs-extendedprotection-indirect-ssl.gif "RS_ExtendedProtection_Indirect_SSL")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-219">![RS_ExtendedProtection_Indirect_SSL](../media/rs-extendedprotection-indirect-ssl.gif "RS_ExtendedProtection_Indirect_SSL")</span></span><br /><br /> <span data-ttu-id="9e2bd-220">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-220">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-221">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-221">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-222">3) 网关设备</span><span class="sxs-lookup"><span data-stu-id="9e2bd-222">3) Gateway device</span></span>|<span data-ttu-id="9e2bd-223">从客户端到报表服务器的渠道绑定是不可能的，因为网关模拟上下文，并因此创建一个新的 NTLM 标记。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-223">Channel Binding from client to report server is not possible because the gateway impersonates a context and therefore creates a new NTLM token.</span></span><br /><br /> <span data-ttu-id="9e2bd-224">此时，从网关到报表服务器没有 SSL，因此，无法实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-224">There is no SSL from the Gateway to report server therefore channel binding cannot be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-225">可以实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-225">Service Binding can be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-226">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-226">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-227">将 `RSWindowsExtendedProtectionScenario` 设置为 `Any`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-227">Set `RSWindowsExtendedProtectionScenario` to `Any`.</span></span><br /><br /> <span data-ttu-id="9e2bd-228">应由管理员配置网关设备以实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-228">The Gateway device should be configured by your administrator to enforce channel binding.</span></span>|
|<span data-ttu-id="9e2bd-229">与安全网关之间的间接 HTTPS 通信。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-229">Indirect HTTPS communication with a Secure Gateway.</span></span> <span data-ttu-id="9e2bd-230">网关将实行“客户端到网关”渠道绑定，报表服务器将实行“网关到报表服务器”渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-230">The Gateway will enforce Client to Gateway Channel Binding and the report server will enforce Gateway to report server Channel Binding.</span></span>|<span data-ttu-id="9e2bd-231">![RS_ExtendedProtection_IndirectSSLandHTTPS](../media/rs-extendedprotection-indirectsslandhttps.gif "RS_ExtendedProtection_IndirectSSLandHTTPS")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-231">![RS_ExtendedProtection_IndirectSSLandHTTPS](../media/rs-extendedprotection-indirectsslandhttps.gif "RS_ExtendedProtection_IndirectSSLandHTTPS")</span></span><br /><br /> <span data-ttu-id="9e2bd-232">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-232">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-233">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-233">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-234">3) 网关设备</span><span class="sxs-lookup"><span data-stu-id="9e2bd-234">3) Gateway device</span></span>|<span data-ttu-id="9e2bd-235">从客户端到报表服务器的渠道绑定是不可能的，因为网关模拟上下文，并因此创建一个新的 NTLM 标记。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-235">Channel Binding from client to report server is not possible because the gateway impersonates a context and therefore creates a new NTLM token.</span></span><br /><br /> <span data-ttu-id="9e2bd-236">从网关到 Report Server 的 SSL 表示可以强制实施通道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-236">SSL from Gateway to the report server means channel binding can be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-237">不需要服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-237">Service Binding is not required.</span></span><br /><br /> <span data-ttu-id="9e2bd-238">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-238">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-239">将 `RSWindowsExtendedProtectionScenario` 设置为 `Direct`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-239">Set `RSWindowsExtendedProtectionScenario` to `Direct`.</span></span><br /><br /> <span data-ttu-id="9e2bd-240">应由管理员配置网关设备以实行渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-240">The Gateway device should be configured by your administrator to enforce channel binding.</span></span>|

### <a name="combination"></a><span data-ttu-id="9e2bd-241">组合</span><span class="sxs-lookup"><span data-stu-id="9e2bd-241">Combination</span></span>
 <span data-ttu-id="9e2bd-242">此方案介绍客户端连接到代理的 Extranet 或 Internet 环境。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-242">This scenario describes Extranet or Internet environments where the client connects a Proxy.</span></span> <span data-ttu-id="9e2bd-243">这种环境与客户端在其中连接到报表服务器的 Intranet 环境相结合。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-243">This is in combination with an intranet environment where a client connects to report server.</span></span>

|<span data-ttu-id="9e2bd-244">场景</span><span class="sxs-lookup"><span data-stu-id="9e2bd-244">Scenario</span></span>|<span data-ttu-id="9e2bd-245">方案图</span><span class="sxs-lookup"><span data-stu-id="9e2bd-245">Scenario Diagram</span></span>|<span data-ttu-id="9e2bd-246">保护方式</span><span class="sxs-lookup"><span data-stu-id="9e2bd-246">How to secure</span></span>|
|--------------|----------------------|-------------------|
|<span data-ttu-id="9e2bd-247">从客户端间接和直接访问报表服务器服务，在客户端到代理或客户端到报表服务器连接中均没有 SSL。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-247">Indirect and direct access from client to report server service without SSL on either of the client to proxy or client to report server connections.</span></span>|<span data-ttu-id="9e2bd-248">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-248">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-249">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-249">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-250">3) 代理</span><span class="sxs-lookup"><span data-stu-id="9e2bd-250">3) Proxy</span></span><br /><br /> <span data-ttu-id="9e2bd-251">4) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-251">4) Client application</span></span>|<span data-ttu-id="9e2bd-252">可以实行从客户端到报表服务器的服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-252">Service Binding from client to report server can be enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-253">报表服务器必须了解代理名称，报表服务器管理员应使用主机标头为代理创建一个 URL 预留，或在 Windows 注册表项 `BackConnectionHostNames` 中配置代理名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-253">The Proxy name must be known to the report server and the report server administrator should either create a URL reservation for it, with a host header or configure the Proxy name in the Windows registry entry `BackConnectionHostNames`.</span></span><br /><br /> <span data-ttu-id="9e2bd-254">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-254">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-255">将 `RSWindowsExtendedProtectionScenario` 设置为 `Any`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-255">Set `RSWindowsExtendedProtectionScenario` to `Any`.</span></span>|
|<span data-ttu-id="9e2bd-256">从客户端间接和直接访问报表服务器，其中，客户端与代理或报表服务器建立 SSL 连接。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-256">Indirect and direct access from client to report server where the client establishes an SSL connection to the proxy or report server.</span></span>|<span data-ttu-id="9e2bd-257">![RS_ExtendedProtection_CombinationSSL](../media/rs-extendedprotection-combinationssl.gif "RS_ExtendedProtection_CombinationSSL")</span><span class="sxs-lookup"><span data-stu-id="9e2bd-257">![RS_ExtendedProtection_CombinationSSL](../media/rs-extendedprotection-combinationssl.gif "RS_ExtendedProtection_CombinationSSL")</span></span><br /><br /> <span data-ttu-id="9e2bd-258">1) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-258">1) Client application</span></span><br /><br /> <span data-ttu-id="9e2bd-259">2) 报表服务器</span><span class="sxs-lookup"><span data-stu-id="9e2bd-259">2) Report server</span></span><br /><br /> <span data-ttu-id="9e2bd-260">3) 代理</span><span class="sxs-lookup"><span data-stu-id="9e2bd-260">3) Proxy</span></span><br /><br /> <span data-ttu-id="9e2bd-261">4) 客户端应用程序</span><span class="sxs-lookup"><span data-stu-id="9e2bd-261">4) Client application</span></span>|<span data-ttu-id="9e2bd-262">可以使用渠道绑定</span><span class="sxs-lookup"><span data-stu-id="9e2bd-262">Channel Binding can be used</span></span><br /><br /> <span data-ttu-id="9e2bd-263">报表服务器必须了解代理名称，报表服务器管理员应使用主机标头为代理创建一个 URL 预留，或在 Windows 注册表项 `BackConnectionHostNames` 中配置代理名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-263">The Proxy name must be known to the report server and the report server administrator should either create a URL reservation for the proxy, with a host header or configure the Proxy name in the Windows registry entry `BackConnectionHostNames`.</span></span><br /><br /> <span data-ttu-id="9e2bd-264">将 `RSWindowsExtendedProtectionLevel` 设置为 `Allow` 或 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-264">Set `RSWindowsExtendedProtectionLevel` to `Allow` or `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-265">将 `RSWindowsExtendedProtectionScenario` 设置为 `Proxy`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-265">Set `RSWindowsExtendedProtectionScenario` to `Proxy`.</span></span>|

## <a name="configuring-reporting-rervices-extended-protection"></a><span data-ttu-id="9e2bd-266">配置 Reporting Rervices 扩展保护</span><span class="sxs-lookup"><span data-stu-id="9e2bd-266">Configuring Reporting Rervices extended protection</span></span>
 <span data-ttu-id="9e2bd-267">`rsreportserver.config`文件包含控制扩展保护行为的配置值 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-267">The `rsreportserver.config` file contains the configuration values that control the behavior of [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] extended protection.</span></span>

 <span data-ttu-id="9e2bd-268">有关使用和编辑文件的详细信息 `rsreportserver.config` ，请参阅[Rsreportserver.config 配置文件](../report-server/rsreportserver-config-configuration-file.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-268">For more information on using and editing the `rsreportserver.config` file, see [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md).</span></span> <span data-ttu-id="9e2bd-269">还可以使用 WMI API 更改和检查扩展保护设置。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-269">The extended protection settings can also be changed and inspected using WMI APIs.</span></span> <span data-ttu-id="9e2bd-270">有关详细信息，请参阅 [SetExtendedProtectionSettings 方法 (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-setextendedprotectionsettings.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-270">For more information, see [SetExtendedProtectionSettings Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-setextendedprotectionsettings.md).</span></span>

 <span data-ttu-id="9e2bd-271">当对配置设置进行验证失败时，将在报表服务器上禁用身份验证类型 `RSWindowsNTLM`、`RSWindowsKerberos` 和 `RSWindowsNegotiate`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-271">When validation of the configuration settings fail, the authentication types `RSWindowsNTLM`, `RSWindowsKerberos` and `RSWindowsNegotiate` are disabled on the report server.</span></span>

###  <a name="configuration-settings-for-reporting-services-extended-protection"></a><a name="ConfigurationSettings"></a> <span data-ttu-id="9e2bd-272">Reporting Services 扩展保护的配置设置</span><span class="sxs-lookup"><span data-stu-id="9e2bd-272">Configuration Settings for reporting services extended protection</span></span>
 <span data-ttu-id="9e2bd-273">下表提供有关在 `rsreportserver.config` 中显示的扩展保护配置设置的信息。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-273">The following table provides information about configuration settings that appear in the `rsreportserver.config` for extended protection.</span></span>

|<span data-ttu-id="9e2bd-274">设置</span><span class="sxs-lookup"><span data-stu-id="9e2bd-274">Setting</span></span>|<span data-ttu-id="9e2bd-275">说明</span><span class="sxs-lookup"><span data-stu-id="9e2bd-275">Description</span></span>|
|-------------|-----------------|
|`RSWindowsExtendedProtectionLevel`|<span data-ttu-id="9e2bd-276">指定扩展保护的实行程度。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-276">Specifies the degree of enforcement of extended protection.</span></span> <span data-ttu-id="9e2bd-277">有效值为 `Off`、`Allow` 和 `Require`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-277">Valid values are `Off`, `Allow`, and `Require`.</span></span><br /><br /> <span data-ttu-id="9e2bd-278">默认值为 `Off`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-278">The default value is `Off`.</span></span><br /><br /> <span data-ttu-id="9e2bd-279">值为 `Off` 指定没有渠道绑定或服务绑定验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-279">The value `Off` specifies no channel binding or service binding verification.</span></span><br /><br /> <span data-ttu-id="9e2bd-280">值为 `Allow` 支持扩展保护，但并不需要此功能。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-280">The value `Allow` supports extended protection but does not require it.</span></span> <span data-ttu-id="9e2bd-281">值为 Allow 时指定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-281">The value Allow specifies:</span></span><br /><br /> <span data-ttu-id="9e2bd-282">将为在支持扩展保护的操作系统上运行的客户端应用程序实行扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-282">Extended protection will be enforced for client applications that are running on operating systems that support extended protection.</span></span> <span data-ttu-id="9e2bd-283">实行保护的方式通过设置 `RsWindowsExtendedProtectionScenario` 来确定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-283">How protection is enforced is determined by setting `RsWindowsExtendedProtectionScenario`.</span></span><br /><br /> <span data-ttu-id="9e2bd-284">对于在不支持扩展保护的操作系统上运行的应用程序而言，将允许进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-284">Authentication will be allowed for applications that are running on operating systems which do not support extended protection.</span></span><br /><br /> <span data-ttu-id="9e2bd-285">值为 `Require` 时指定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-285">The value `Require` specifies:</span></span><br /><br /> <span data-ttu-id="9e2bd-286">将为在支持扩展保护的操作系统上运行的客户端应用程序实行扩展保护。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-286">Extended protection will be enforced for client applications that are running on operating systems that support extended protection.</span></span><br /><br /> <span data-ttu-id="9e2bd-287">对于在不支持扩展保护的操作系统上运行的应用程序，将**不**允许进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-287">Authentication will **not** be allowed for applications that are running on operating systems which do not support extended protection.</span></span>|
|`RsWindowsExtendedProtectionScenario`|<span data-ttu-id="9e2bd-288">指定要验证哪些形式的扩展保护：渠道绑定、服务绑定，或两者。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-288">Specifies what forms of extended protection are validated: Channel binding, Service Binding, or both.</span></span> <span data-ttu-id="9e2bd-289">有效值为 `Any`、`Proxy` 和 `Direct`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-289">Valid values are `Any`, `Proxy`, and `Direct`.</span></span><br /><br /> <span data-ttu-id="9e2bd-290">默认值为 `Proxy`。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-290">The default value is `Proxy`.</span></span><br /><br /> <span data-ttu-id="9e2bd-291">值为 `Any` 时指定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-291">The value `Any` specifies:</span></span><br /><br /> <span data-ttu-id="9e2bd-292">\- 不要求 Windows NTLM、Kerberos 和 Negotiate 身份验证以及渠道绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-292">-Windows NTLM, Kerberos, and Negotiate authentication and a channel binding are not required.</span></span><br /><br /> <span data-ttu-id="9e2bd-293">\- 实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-293">-Service binding is enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-294">值为 `Proxy` 时指定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-294">The value `Proxy` specifies:</span></span><br /><br /> <span data-ttu-id="9e2bd-295">\- 当存在渠道绑定标记时，使用 Windows NTLM、Kerberos 和 Negotiate 身份验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-295">-Windows NTLM, Kerberos, and Negotiate authentication when a channel binding token is present.</span></span><br /><br /> <span data-ttu-id="9e2bd-296">\- 实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-296">-Service Binding is enforced.</span></span><br /><br /> <span data-ttu-id="9e2bd-297">值为 `Direct` 时指定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-297">The value `Direct` specifies:</span></span><br /><br /> <span data-ttu-id="9e2bd-298">- 当 CBT 存在、与当前服务之间存在 SSL 连接并且用于 SSL 连接的 CBT 与 NTLM、Kerberos 或 Negotiate 标记的 CBT 匹配时，应使用 Windows NTLM、Kerberos 和 Negotiate 身份验证。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-298">-Windows NTLM, Kerberos, and Negotiate authentication when a CBT is present, an SSL connection to the current service is present, and the CBT for the SSL connection matches the CBT of the NTLM, Kerberos or negotiate token.</span></span><br /><br /> <span data-ttu-id="9e2bd-299">\- 不实行服务绑定。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-299">-Service Binding is not enforced.</span></span><br /><br /> <br /><br /> <span data-ttu-id="9e2bd-300">注意：如果将设置为，则忽略此设置 `RsWindowsExtendedProtectionLevel` `OFF` 。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-300">Note: This setting is ignored if `RsWindowsExtendedProtectionLevel` is set to `OFF`.</span></span>|

 <span data-ttu-id="9e2bd-301">`rsreportserver.config` 配置文件中的示例条目：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-301">Example entries in the `rsreportserver.config` configuration file:</span></span>

```
<Authentication>
         <RSWindowsExtendedProtectionLevel>Allow</RSWindowsExtendedProtectionLevel>
         <RSWindowsExtendedProtectionScenario>Proxy</RSWindowsExtendedProtectionLevel>
</Authentication>
```

## <a name="service-binding-and-included-spns"></a><span data-ttu-id="9e2bd-302">服务绑定和所包含的 SPN</span><span class="sxs-lookup"><span data-stu-id="9e2bd-302">Service Binding and included SPNs</span></span>
 <span data-ttu-id="9e2bd-303">服务绑定使用服务器主体名称或 SPN 来验证身份验证标记的预期目标。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-303">Service binding uses Service Principal Names or SPN to validate the intended destination of authentication tokens.</span></span> [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] <span data-ttu-id="9e2bd-304">使用现有的 URL 预留信息来生成视为有效的 SPN 的列表。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-304">uses the existing URL reservation information to build a list of SPNs that are considered valid.</span></span> <span data-ttu-id="9e2bd-305">使用 URL 预留信息来验证 SPN 和 URL 预留使系统管理员能够从单个位置管理这两者。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-305">Using the URL reservation information for validation of both SPN and URL reservations enables system administrators to manage both from a single location.</span></span>

 <span data-ttu-id="9e2bd-306">当报表服务器启动、扩展保护的配置设置更改或回收应用程序域时，将更新有效 SPN 的列表。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-306">The list of valid SPNs is updated when the report server starts, the configuration settings for extended protection are changed, or when the application domain is recycled.</span></span>

 <span data-ttu-id="9e2bd-307">SPN 的有效列表特定于每个应用程序。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-307">The valid list of SPNs is specific for each application.</span></span> <span data-ttu-id="9e2bd-308">例如，报表管理器和报表服务器每个都将计算不同的有效 SPN 列表。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-308">For example, Report Manager and Report Server will each have a different list of valid SPNs calculated.</span></span>

 <span data-ttu-id="9e2bd-309">为应用程序计算的有效 SPN 列表由以下元素确定：</span><span class="sxs-lookup"><span data-stu-id="9e2bd-309">The list of valid SPNs calculated for an application is determined by the following factors:</span></span>

-   <span data-ttu-id="9e2bd-310">每个 URL 预留。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-310">Each URL reservation.</span></span>

-   <span data-ttu-id="9e2bd-311">从域控制器为 Reporting Services 服务帐户检索的每个 SPN。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-311">Each SPN retrieved from the domain controller for the reporting services service account.</span></span>

-   <span data-ttu-id="9e2bd-312">如果 URL 预留包含通配符（“\*”或“+”），则报表服务器将从 Hosts 集合添加每个条目。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-312">If a URL reservation includes wildcard characters ('\*' or '+'), then Report Server will add each entry from the hosts collection.</span></span>

### <a name="hosts-collection-sources"></a><span data-ttu-id="9e2bd-313">Hosts 集合来源。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-313">Hosts collection sources.</span></span>
 <span data-ttu-id="9e2bd-314">下表列出了 Hosts 集合的潜在来源。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-314">The following table lists the potential sources for the Hosts collection.</span></span>

|<span data-ttu-id="9e2bd-315">源类型</span><span class="sxs-lookup"><span data-stu-id="9e2bd-315">Type of source</span></span>|<span data-ttu-id="9e2bd-316">说明</span><span class="sxs-lookup"><span data-stu-id="9e2bd-316">Description</span></span>|
|--------------------|-----------------|
|<span data-ttu-id="9e2bd-317">ComputerNameDnsDomain</span><span class="sxs-lookup"><span data-stu-id="9e2bd-317">ComputerNameDnsDomain</span></span>|<span data-ttu-id="9e2bd-318">分配给本地计算机的 DNS 域的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-318">The name of the DNS domain assigned to the local computer.</span></span> <span data-ttu-id="9e2bd-319">如果本地计算机为群集中的节点，则将使用群集虚拟服务器的 DNS 域名。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-319">If the local computer is a node in a cluster, the DNS domain name of the cluster virtual server is used.</span></span>|
|<span data-ttu-id="9e2bd-320">ComputerNameDnsFullyQualified</span><span class="sxs-lookup"><span data-stu-id="9e2bd-320">ComputerNameDnsFullyQualified</span></span>|<span data-ttu-id="9e2bd-321">唯一标识本地计算机的完全限定 DNS 名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-321">The fully qualified DNS name that uniquely identifies the local computer.</span></span> <span data-ttu-id="9e2bd-322">此名称是 DNS 主机名和 DNS 域名的组合，格式为 *HostName*.*DomainName*。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-322">This name is a combination of the DNS host name and the DNS domain name, using the form *HostName*.*DomainName*.</span></span> <span data-ttu-id="9e2bd-323">如果本地计算机为群集中的节点，则将使用群集虚拟服务器的完全限定 DNS 名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-323">If the local computer is a node in a cluster, the fully qualified DNS name of the cluster virtual server is used.</span></span>|
|<span data-ttu-id="9e2bd-324">ComputerNameDnsHostname</span><span class="sxs-lookup"><span data-stu-id="9e2bd-324">ComputerNameDnsHostname</span></span>|<span data-ttu-id="9e2bd-325">本地计算机的 DNS 主机名。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-325">The DNS host name of the local computer.</span></span> <span data-ttu-id="9e2bd-326">如果本地计算机为群集中的节点，则将使用群集虚拟服务器的 DNS 主机名。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-326">If the local computer is a node in a cluster, the DNS host name of the cluster virtual server is used.</span></span>|
|<span data-ttu-id="9e2bd-327">ComputerNameNetBIOS</span><span class="sxs-lookup"><span data-stu-id="9e2bd-327">ComputerNameNetBIOS</span></span>|<span data-ttu-id="9e2bd-328">本地计算机的 NetBIOS 名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-328">The NetBIOS name of the local computer.</span></span> <span data-ttu-id="9e2bd-329">如果本地计算机为群集中的节点，则将使用群集虚拟服务器的 NetBIOS 主机名。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-329">If the local computer is a node in a cluster, the NetBIOS name of the cluster virtual server is used.</span></span>|
|<span data-ttu-id="9e2bd-330">ComputerNamePhysicalDnsDomain</span><span class="sxs-lookup"><span data-stu-id="9e2bd-330">ComputerNamePhysicalDnsDomain</span></span>|<span data-ttu-id="9e2bd-331">分配给本地计算机的 DNS 域的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-331">The name of the DNS domain assigned to the local computer.</span></span> <span data-ttu-id="9e2bd-332">如果本地计算机为群集中的节点，则将使用本地计算机的 DNS 域名，而不使用群集虚拟服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-332">If the local computer is a node in a cluster, the DNS domain name of the local computer is used, not the name of the cluster virtual server.</span></span>|
|<span data-ttu-id="9e2bd-333">ComputerNamePhysicalDnsFullyQualified</span><span class="sxs-lookup"><span data-stu-id="9e2bd-333">ComputerNamePhysicalDnsFullyQualified</span></span>|<span data-ttu-id="9e2bd-334">唯一标识计算机的完全限定 DNS 名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-334">The fully qualified DNS name that uniquely identifies the computer.</span></span> <span data-ttu-id="9e2bd-335">如果本地计算机为群集中的节点，则将使用本地计算机的完全限定 DNS 名称，而不使用群集虚拟服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-335">If the local computer is a node in a cluster, the fully qualified DNS name of the local computer, is used not the name of the cluster virtual server.</span></span><br /><br /> <span data-ttu-id="9e2bd-336">此完全限定的 DNS 名称是 DNS 主机名和 DNS 域名的组合，格式为 *HostName*.*DomainName*。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-336">The fully qualified DNS name is a combination of the DNS host name and the DNS domain name, using the form *HostName*.*DomainName*.</span></span>|
|<span data-ttu-id="9e2bd-337">ComputerNamePhysicalDnsHostname</span><span class="sxs-lookup"><span data-stu-id="9e2bd-337">ComputerNamePhysicalDnsHostname</span></span>|<span data-ttu-id="9e2bd-338">本地计算机的 DNS 主机名。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-338">The DNS host name of the local computer.</span></span> <span data-ttu-id="9e2bd-339">如果本地计算机为群集中的节点，则将使用本地计算机的 DNS 主机名，而不使用群集虚拟服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-339">If the local computer is a node in a cluster, the DNS host name of the local computer is used, not the name of the cluster virtual server.</span></span>|
|<span data-ttu-id="9e2bd-340">ComputerNamePhysicalNetBIOS</span><span class="sxs-lookup"><span data-stu-id="9e2bd-340">ComputerNamePhysicalNetBIOS</span></span>|<span data-ttu-id="9e2bd-341">本地计算机的 NetBIOS 名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-341">The NetBIOS name of the local computer.</span></span> <span data-ttu-id="9e2bd-342">如果本地计算机为群集中的节点，则将使用本地计算机的 NetBIOS 主机名，而不使用群集虚拟服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-342">If the local computer is a node in a cluster, the NetBIOS name of the local computer, not the name of the cluster virtual server.</span></span>|

 <span data-ttu-id="9e2bd-343">有关详细信息，请参阅[为报表服务器注册服务主体名称 (SPN)](../report-server/register-a-service-principal-name-spn-for-a-report-server.md)和[关于 URL 预留和注册（SSRS 配置管理器）](../install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2bd-343">For more information, see [Register a Service Principal Name &#40;SPN&#41; for a Report Server](../report-server/register-a-service-principal-name-spn-for-a-report-server.md) and [About URL Reservations and Registration  &#40;SSRS Configuration Manager&#41;](../install-windows/about-url-reservations-and-registration-ssrs-configuration-manager.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="9e2bd-344">另请参阅</span><span class="sxs-lookup"><span data-stu-id="9e2bd-344">See Also</span></span>
 <span data-ttu-id="9e2bd-345">[使用扩展保护连接到数据库引擎](../../database-engine/configure-windows/connect-to-the-database-engine-using-extended-protection.md)[针对验证的扩展保护概述](https://go.microsoft.com/fwlink/?LinkID=177943)[具有扩展保护的集成 Windows 身份验证](https://go.microsoft.com/fwlink/?LinkId=179922) [Microsoft 安全公告：针对身份验证的扩展保护](https://go.microsoft.com/fwlink/?LinkId=179923)[报表服务器服务跟踪日志](../report-server/report-server-service-trace-log.md) [rsreportserver.config 配置文件](../report-server/rsreportserver-config-configuration-file.md) [SetExtendedProtectionSettings 方法 &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-setextendedprotectionsettings.md)</span><span class="sxs-lookup"><span data-stu-id="9e2bd-345">[Connect to the Database Engine Using Extended Protection](../../database-engine/configure-windows/connect-to-the-database-engine-using-extended-protection.md) [Extended Protection for Authentication Overview](https://go.microsoft.com/fwlink/?LinkID=177943) [Integrated Windows Authentication with Extended Protection](https://go.microsoft.com/fwlink/?LinkId=179922) [Microsoft Security Advisory: Extended protection for authentication](https://go.microsoft.com/fwlink/?LinkId=179923) [Report Server Service Trace Log](../report-server/report-server-service-trace-log.md) [RSReportServer Configuration File](../report-server/rsreportserver-config-configuration-file.md) [SetExtendedProtectionSettings Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-setextendedprotectionsettings.md)</span></span>


