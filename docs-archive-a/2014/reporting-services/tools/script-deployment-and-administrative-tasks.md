---
title: 为部署和管理任务编写脚本 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- scripts [Reporting Services]
- moving reports
- report servers [Reporting Services], duplicating settings
- deploying [Reporting Services], scripts
- copying report server settings
- administrative tasks [Reporting Services]
- duplicating report server environment
- migrating reports [Reporting Services]
- scripts [Reporting Services], deployments
- transferrng reports
- reports [Reporting Services], migrating
ms.assetid: d0416c9e-e3f9-456d-9870-2cfd2c49039b
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 7562bec3211824d5e84441434b4696a44d51fa9b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87587723"
---
# <a name="script-deployment-and-administrative-tasks"></a><span data-ttu-id="28ddb-102">为部署和管理任务编写脚本</span><span class="sxs-lookup"><span data-stu-id="28ddb-102">Script Deployment and Administrative Tasks</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="28ddb-103">支持使用脚本来自动执行日常安装、部署任务和管理任务。</span><span class="sxs-lookup"><span data-stu-id="28ddb-103">supports the use of scripts to automate routine installation, deployment, and administrative tasks.</span></span> <span data-ttu-id="28ddb-104">部署报表服务器的过程包括多个步骤。</span><span class="sxs-lookup"><span data-stu-id="28ddb-104">Deploying a report server is a multi-step process.</span></span> <span data-ttu-id="28ddb-105">必须使用多个工具和过程来配置部署；没有任何单个程序或方法可用于自动执行所有任务。</span><span class="sxs-lookup"><span data-stu-id="28ddb-105">You must use several tools and processes to configure a deployment; there is no single program or approach that can be used to automate all the tasks.</span></span>  
  
 <span data-ttu-id="28ddb-106">并非每个步骤都应自动执行。</span><span class="sxs-lookup"><span data-stu-id="28ddb-106">Not every step should be automated.</span></span> <span data-ttu-id="28ddb-107">在某些情况下，手动或通过图形工具执行步骤是最简单且最有效的方法。</span><span class="sxs-lookup"><span data-stu-id="28ddb-107">In some cases, performing a step manually or through a graphical tool is the simplest and most effective approach.</span></span> <span data-ttu-id="28ddb-108">例如，如果要部署大量报表和模型，最好复制报表服务器数据库，而不是编写用于重新创建报表服务器环境的代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-108">For example, if you want to deploy a large number of reports and models, it is better to copy the report server databases rather than write code that recreates report server environment.</span></span>  
  
 <span data-ttu-id="28ddb-109">某些步骤需要自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-109">Some steps require custom code.</span></span> <span data-ttu-id="28ddb-110">例如，可以自动为 Web 服务和报表管理器配置 URL，但是只有在编写用于对报表服务器 Windows Management Instrumentation (WMI) 提供程序进行调用的自定义代码时才能这样做。</span><span class="sxs-lookup"><span data-stu-id="28ddb-110">For example, configuring the URLs for the Web service and Report Manager can be automated, but only if you write custom code that makes calls into the Report Server Windows Management Instrumentation (WMI) provider.</span></span> <span data-ttu-id="28ddb-111">如果不想编写代码，则必须使用 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置工具执行该步骤。</span><span class="sxs-lookup"><span data-stu-id="28ddb-111">If you do not want to write code, you must use the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool to perform the step.</span></span>  
  
 <span data-ttu-id="28ddb-112">若要运行配置报表服务器的脚本，您必须是要配置的计算机上的本地管理员。</span><span class="sxs-lookup"><span data-stu-id="28ddb-112">To run script that configures a report server, you must be a local administrator on the computer that you are configuring.</span></span> <span data-ttu-id="28ddb-113">有关详细信息，请参阅 [配置报表服务器以进行远程管理](../report-server/configure-a-report-server-for-remote-administration.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-113">For more information, see [Configure a Report Server for Remote Administration](../report-server/configure-a-report-server-for-remote-administration.md).</span></span>  
  
 <span data-ttu-id="28ddb-114">本主题说明自动执行特定步骤的推荐方法。</span><span class="sxs-lookup"><span data-stu-id="28ddb-114">This topic describes recommended approaches for automating specific steps.</span></span> <span data-ttu-id="28ddb-115">介绍了几个程序和编程接口，本主题的稍后部分中提供了针对每一种方法的说明。</span><span class="sxs-lookup"><span data-stu-id="28ddb-115">Several programs and programmatic interfaces are mentioned; descriptions of each one are provided later in this topic.</span></span>  
  
## <a name="deployment-tasks-and-how-to-automate-them"></a><span data-ttu-id="28ddb-116">部署任务及自动执行这些任务的方式</span><span class="sxs-lookup"><span data-stu-id="28ddb-116">Deployment Tasks and How to Automate Them</span></span>  
 <span data-ttu-id="28ddb-117">下表总结了部署报表服务器所需的安装和配置任务。</span><span class="sxs-lookup"><span data-stu-id="28ddb-117">The following table summarizes the installation and configuration tasks that are necessary for deploying a report server.</span></span> <span data-ttu-id="28ddb-118">您可以使用该表将特定任务与用于自动执行任务或在无人参与的情况下执行任务的方法相匹配。</span><span class="sxs-lookup"><span data-stu-id="28ddb-118">You can use the table to match a specific task to an approach that allows you to automate or perform the task unattended.</span></span>  
  
|<span data-ttu-id="28ddb-119">任务</span><span class="sxs-lookup"><span data-stu-id="28ddb-119">Task</span></span>|<span data-ttu-id="28ddb-120">方法</span><span class="sxs-lookup"><span data-stu-id="28ddb-120">Approach</span></span>|  
|----------|--------------|  
|<span data-ttu-id="28ddb-121">安装 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="28ddb-121">Install [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span>|<span data-ttu-id="28ddb-122">可以从命令行运行安装程序以执行无人参与的安装。</span><span class="sxs-lookup"><span data-stu-id="28ddb-122">You can run setup from the command line to perform an unattended installation.</span></span><br /><br /> <span data-ttu-id="28ddb-123">可以使用安装程序安装和配置报表服务器，但是只有在指定默认配置选项且系统满足此安装类型的所有要求时才能这样做。</span><span class="sxs-lookup"><span data-stu-id="28ddb-123">You can use Setup to both install and configure a report server, but only if you specify the default configuration option and your system meets all the requirements for this installation type.</span></span> <span data-ttu-id="28ddb-124">如果不能安装默认配置，则必须执行“仅文件”安装。</span><span class="sxs-lookup"><span data-stu-id="28ddb-124">If you cannot install the default configuration, you must perform a files-only installation.</span></span>|  
|<span data-ttu-id="28ddb-125">配置服务帐户。</span><span class="sxs-lookup"><span data-stu-id="28ddb-125">Configure the service account.</span></span>|<span data-ttu-id="28ddb-126">服务帐户最初是在安装过程中配置的。</span><span class="sxs-lookup"><span data-stu-id="28ddb-126">The service account is initially configured through Setup.</span></span> <span data-ttu-id="28ddb-127">若要将更改服务帐户作为安装后任务自动执行，必须编写可对报表服务器 WMI 接口进行调用的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-127">To automate changes to the service account as a post-Setup task, you must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="28ddb-128">没有用于以编程方式配置服务帐户的命令提示实用工具或脚本模板。</span><span class="sxs-lookup"><span data-stu-id="28ddb-128">There are no command-prompt utilities or script templates for configuring the service account programmatically.</span></span><br /><br /> <span data-ttu-id="28ddb-129">如果编码要求阻止您自动执行此步骤，则可通过运行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置工具轻松地手动配置帐户。</span><span class="sxs-lookup"><span data-stu-id="28ddb-129">If coding requirements prevent you from automating this step, you can easily configure the account manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="28ddb-130">有关详细信息，请参阅[配置服务帐户（SSRS 配置管理器）](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-130">For more information, see [Configure a Service Account &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-service-account-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="28ddb-131">配置报表服务器 Web 服务和报表管理器 URL。</span><span class="sxs-lookup"><span data-stu-id="28ddb-131">Configure the Report Server Web service and Report Manager URLs.</span></span>|<span data-ttu-id="28ddb-132">必须编写用于对报表服务器 WMI 提供程序进行调用的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-132">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="28ddb-133">没有用来配置 URL 的命令行实用工具或脚本模板。</span><span class="sxs-lookup"><span data-stu-id="28ddb-133">There are no command line utilities or script templates for configuring the URLs.</span></span><br /><br /> <span data-ttu-id="28ddb-134">如果希望避免编写代码，则可以通过运行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置工具来手动配置 URL。</span><span class="sxs-lookup"><span data-stu-id="28ddb-134">If you want to avoid writing code, you can configure the URLs manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="28ddb-135">有关详细信息，请参阅[配置 URL（SSRS 配置管理器）](../install-windows/configure-a-url-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-135">For more information, see [Configure a URL  &#40;SSRS Configuration Manager&#41;](../install-windows/configure-a-url-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="28ddb-136">创建报表服务器数据库。</span><span class="sxs-lookup"><span data-stu-id="28ddb-136">Create the report server database.</span></span>|<span data-ttu-id="28ddb-137">必须编写用于对报表服务器 WMI 提供程序进行调用的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-137">You must write custom code that makes calls into the Report Server WMI provider.</span></span> <span data-ttu-id="28ddb-138">没有用来创建报表服务器数据库和 RSExecRole 的命令提示实用工具或脚本模板。</span><span class="sxs-lookup"><span data-stu-id="28ddb-138">There are no command-prompt utilities or script templates for creating the report server databases and RSExecRole.</span></span><br /><br /> <span data-ttu-id="28ddb-139">如果希望避免编写代码，则可以通过运行 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 配置工具来手动创建数据库。</span><span class="sxs-lookup"><span data-stu-id="28ddb-139">If you want to avoid writing code, you can create the database manually by running the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Configuration tool.</span></span> <span data-ttu-id="28ddb-140">有关详细信息，请参阅[创建本机模式报表服务器数据库（SSRS 配置管理器）](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-140">For more information, see [Create a Native Mode Report Server Database  &#40;SSRS Configuration Manager&#41;](../install-windows/ssrs-report-server-create-a-native-mode-report-server-database.md).</span></span>|  
|<span data-ttu-id="28ddb-141">配置报表服务器数据库连接。</span><span class="sxs-lookup"><span data-stu-id="28ddb-141">Configure the report server database connection.</span></span>|<span data-ttu-id="28ddb-142">如果要更改连接字符串、帐户、密码或身份验证类型，请通过运行 **rsconfig** 实用工具来配置连接。</span><span class="sxs-lookup"><span data-stu-id="28ddb-142">If you are changing the connection string, account or password, or the authentication type, run the **rsconfig** utility to configure the connection.</span></span> <span data-ttu-id="28ddb-143">有关详细信息，请参阅[配置报表服务器数据库连接（SSRS 配置管理器）](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md)和 [rsconfig 实用工具 (SSRS)](rsconfig-utility-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-143">For more information, see [Configure a Report Server Database Connection  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md) and [rsconfig Utility &#40;SSRS&#41;](rsconfig-utility-ssrs.md).</span></span><br /><br /> <span data-ttu-id="28ddb-144">不能使用 rsconfig.exe 来创建或升级数据库。</span><span class="sxs-lookup"><span data-stu-id="28ddb-144">You cannot use rsconfig.exe to create or upgrade the database.</span></span> <span data-ttu-id="28ddb-145">数据库和 RSExecRole 必须已经存在。</span><span class="sxs-lookup"><span data-stu-id="28ddb-145">The database and RSExecRole must already exist.</span></span>|  
|<span data-ttu-id="28ddb-146">配置扩展部署。</span><span class="sxs-lookup"><span data-stu-id="28ddb-146">Configure a scale-out deployment.</span></span>|<span data-ttu-id="28ddb-147">从以下用于自动执行扩展部署的方法中进行选择：</span><span class="sxs-lookup"><span data-stu-id="28ddb-147">Choose from the following approaches to automate scale-out deployment:</span></span><br /><br /> <span data-ttu-id="28ddb-148">运行 rskeymgmt.exe 实用工具以将报表服务器实例联接到现有安装。</span><span class="sxs-lookup"><span data-stu-id="28ddb-148">Run the rskeymgmt.exe utility to join report server instances to an existing installation.</span></span> <span data-ttu-id="28ddb-149">有关详细信息，请参阅[添加和删除扩展部署的加密密钥（SSRS 配置管理器）](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-149">For more information, see [Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md).</span></span><br /><br /> <span data-ttu-id="28ddb-150">编写针对报表服务器 WMI 提供程序运行的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-150">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="28ddb-151">备份加密密钥。</span><span class="sxs-lookup"><span data-stu-id="28ddb-151">Backup encryption keys.</span></span>|<span data-ttu-id="28ddb-152">从以下用于自动备份加密密钥的方法中进行选择：</span><span class="sxs-lookup"><span data-stu-id="28ddb-152">Choose from the following approaches to automate encryption key backup:</span></span><br /><br /> <span data-ttu-id="28ddb-153">运行 rskeymgmt.exe 实用工具以备份密钥。</span><span class="sxs-lookup"><span data-stu-id="28ddb-153">Run the rskeymgmt.exe utility to back up the keys.</span></span> <span data-ttu-id="28ddb-154">有关详细信息，请参阅 [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-154">For more information, see [Back Up and Restore Reporting Services Encryption Keys](../install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md).</span></span><br /><br /> <span data-ttu-id="28ddb-155">编写针对报表服务器 WMI 提供程序运行的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-155">Write custom code that runs against the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="28ddb-156">配置报表服务器电子邮件。</span><span class="sxs-lookup"><span data-stu-id="28ddb-156">Configure Report Server E-mail.</span></span>|<span data-ttu-id="28ddb-157">编写针对 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供程序运行的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-157">Write custom code that runs against the [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider.</span></span> <span data-ttu-id="28ddb-158">该提供程序支持部分电子邮件配置设置。</span><span class="sxs-lookup"><span data-stu-id="28ddb-158">The provider supports a subset of the e-mail configuration settings.</span></span><br /><br /> <span data-ttu-id="28ddb-159">虽然 RSReportServer.config 文件包含所有设置，但是不要以自动执行的方式使用该文件。</span><span class="sxs-lookup"><span data-stu-id="28ddb-159">Although the RSReportServer.config file includes all the settings, do not use the file in an automated manner.</span></span> <span data-ttu-id="28ddb-160">具体来说，不要使用批处理文件将该文件复制到另一个报表服务器。</span><span class="sxs-lookup"><span data-stu-id="28ddb-160">Specifically, do not use a batch file to copy the file to another report server.</span></span> <span data-ttu-id="28ddb-161">每个配置文件都包含特定于当前实例的值。</span><span class="sxs-lookup"><span data-stu-id="28ddb-161">Each configuration file includes values that are specific to the current instance.</span></span> <span data-ttu-id="28ddb-162">这些值对于其他报表服务器实例将是无效的。</span><span class="sxs-lookup"><span data-stu-id="28ddb-162">Those values will not be valid on other report server instances.</span></span><br /><br /> <span data-ttu-id="28ddb-163">有关这些设置的详细信息，请参阅[为电子邮件传递配置报表服务器 &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-163">For more information about the settings, see [Configure a Report Server for E-Mail Delivery &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-for-e-mail-delivery-ssrs-configuration-manager.md).</span></span>|  
|<span data-ttu-id="28ddb-164">配置无人参与的执行帐户。</span><span class="sxs-lookup"><span data-stu-id="28ddb-164">Configure the unattended execution account.</span></span>|<span data-ttu-id="28ddb-165">从以下用于自动配置无人参与处理帐户的方法中进行选择：</span><span class="sxs-lookup"><span data-stu-id="28ddb-165">Choose from the following approaches to automate unattended processing account configuration:</span></span><br /><br /> <span data-ttu-id="28ddb-166">运行 rsconfig.exe 实用工具以配置帐户。</span><span class="sxs-lookup"><span data-stu-id="28ddb-166">Run the rsconfig.exe utility to configure the account.</span></span> <span data-ttu-id="28ddb-167">有关详细信息，请参阅[配置无人参与的执行帐户（SSRS 配置管理器）](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-167">For more information, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](../install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span><br /><br /> <span data-ttu-id="28ddb-168">编写用于对报表服务器 WMI 提供程序进行调用的自定义代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-168">Write custom code that makes calls into the Report Server WMI provider.</span></span>|  
|<span data-ttu-id="28ddb-169">将现有的内容（包括文件夹层次结构、角色分配、报表、订阅、计划、数据源和资源）部署到另一台报表服务器上。</span><span class="sxs-lookup"><span data-stu-id="28ddb-169">Deploy existing content on another report server, including the folder hierarchy, role assignments, reports, subscriptions, schedules, data sources, and resources.</span></span>|<span data-ttu-id="28ddb-170">重新创建现有报表服务器环境的最佳方式是将报表服务器数据库复制到新的报表服务器实例中。</span><span class="sxs-lookup"><span data-stu-id="28ddb-170">The best way to re-create an existing report server environment is to copy the report server database to a new report server instance.</span></span><br /><br /> <span data-ttu-id="28ddb-171">替代方法是编写自定义代码，以编程方式重新创建现有的报表服务器内容。</span><span class="sxs-lookup"><span data-stu-id="28ddb-171">An alternative approach is to write custom code that recreates existing report server content programmatically.</span></span> <span data-ttu-id="28ddb-172">但应注意，订阅、报表快照和报表历史记录无法以编程方式重新创建。</span><span class="sxs-lookup"><span data-stu-id="28ddb-172">However, be aware that subscriptions, report snapshots, and report history cannot be recreated programmatically.</span></span><br /><br /> <span data-ttu-id="28ddb-173">某些部署受益于以上两项技术的结合使用（也就是说，还原报表服务器数据库，然后运行自定义代码以便为特定安装修改报表服务器数据库）。</span><span class="sxs-lookup"><span data-stu-id="28ddb-173">Some deployments can benefit from using both techniques together (that is, restore a report server database, and then run custom code that modifies the report server database for a specific installation).</span></span><br /><br /> <span data-ttu-id="28ddb-174"> 有关详细示例，请参阅 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-174">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span><br /><br /> <span data-ttu-id="28ddb-175">有关重新定位报表服务器数据库的详细信息，请参阅[将报表服务器数据库移至其他计算机（SSRS 本机模式）](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-175">For more information about relocating a report server database, see [Moving the Report Server Databases to Another Computer &#40;SSRS Native Mode&#41;](../report-server/moving-the-report-server-databases-to-another-computer-ssrs-native-mode.md).</span></span> <span data-ttu-id="28ddb-176">有关以编程方式创建报表服务器环境的详细信息，请参阅本主题中的“使用脚本迁移报表服务器内容和文件夹”一节。</span><span class="sxs-lookup"><span data-stu-id="28ddb-176">For more information about creating report serer environment programmatically, see the section "Using Script to Migrate Report Server Content and Folders" in this topic.</span></span>|  
  
## <a name="tools-and-technologies-for-automating-server-deployment"></a><span data-ttu-id="28ddb-177">用于自动执行服务器部署的工具和技术</span><span class="sxs-lookup"><span data-stu-id="28ddb-177">Tools and Technologies for Automating Server deployment</span></span>  
 <span data-ttu-id="28ddb-178">以下列表总结了可用于自动执行部署和维护任务的程序和接口：</span><span class="sxs-lookup"><span data-stu-id="28ddb-178">The following list summarizes the programs and interfaces that can be used to automate deployment and maintenance tasks:</span></span>  
  
-   <span data-ttu-id="28ddb-179">可以在无人参与模式下运行安装程序，以安装和配置（有时）报表服务器组件。</span><span class="sxs-lookup"><span data-stu-id="28ddb-179">The Setup program can be run in unattended mode to install and sometimes configure report server components.</span></span> <span data-ttu-id="28ddb-180">必须使用“仅文件”安装选项，才能让安装程序配置报表服务器实例。</span><span class="sxs-lookup"><span data-stu-id="28ddb-180">You must use the Files-Only installation option to have Setup configure a report server instance.</span></span>  
  
-   <span data-ttu-id="28ddb-181">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供程序和 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 命令行实用工具可用于本地和远程服务器配置。</span><span class="sxs-lookup"><span data-stu-id="28ddb-181">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider and [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] command line utilities can be used for local and remote server configuration.</span></span>  
  
     <span data-ttu-id="28ddb-182">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI 提供程序公开了用于对 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安装的各个方面（包括指定服务帐户、配置 URL、创建和配置报表服务器数据库或者为电子邮件传递配置报表服务器）进行配置的类、属性和方法。</span><span class="sxs-lookup"><span data-stu-id="28ddb-182">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] WMI provider exposes classes, properties, and methods that allow you to configure all aspects of a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation including specifying the service account, configuring URLs, creating and configuring the report server database, or configuring a report server for e-mail delivery.</span></span> <span data-ttu-id="28ddb-183">必须编写自定义代码或脚本，才能使用 WMI 提供程序。</span><span class="sxs-lookup"><span data-stu-id="28ddb-183">You must write custom code or script to use the WMI provider.</span></span> <span data-ttu-id="28ddb-184">有关详细信息，请参阅 [访问 Reporting Services WMI 提供程序](access-the-reporting-services-wmi-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-184">For more information, see [Access the Reporting Services WMI Provider](access-the-reporting-services-wmi-provider.md).</span></span>  
  
     <span data-ttu-id="28ddb-185">除了编写代码以外，还可以使用命令行实用工具（rsconfig.exe 和 rskeymgmt.exe）。</span><span class="sxs-lookup"><span data-stu-id="28ddb-185">An alternative to writing code is to use the command line utilities (rsconfig.exe and rskeymgmt.exe).</span></span> <span data-ttu-id="28ddb-186">可以编写运行实用工具的批处理文件。</span><span class="sxs-lookup"><span data-stu-id="28ddb-186">You can write batch files that run the utilities.</span></span> <span data-ttu-id="28ddb-187">可以使用实用工具来自动执行某些但不是所有配置任务。</span><span class="sxs-lookup"><span data-stu-id="28ddb-187">You can use the utilities to automate some but not all configuration tasks.</span></span>  
  
-   <span data-ttu-id="28ddb-188">报表服务器脚本主机工具 (rs.exe) 可以运行为了重新创建现有内容或将现有内容从一个报表服务器移至另一个报表服务器而编写的自定义 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 代码。</span><span class="sxs-lookup"><span data-stu-id="28ddb-188">The report server script host tool (rs.exe) can run custom [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] code that you might write to re-create or move existing content from one report server to another.</span></span> <span data-ttu-id="28ddb-189">使用此方法，可以在 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]中编写脚本，将其另存为 .rss 文件，并使用 rs.exe 在目标报表服务器上运行该脚本。</span><span class="sxs-lookup"><span data-stu-id="28ddb-189">With this approach, you write script in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], save it as an .rss file, and use rs.exe to run the script on the target report server.</span></span> <span data-ttu-id="28ddb-190">所编写的脚本可以调用 SOAP 接口，以访问报表服务器 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="28ddb-190">The script you write can call the SOAP interface to the Report Server Web service.</span></span> <span data-ttu-id="28ddb-191">应使用此方法编写部署脚本，因为通过此方法可以重新创建报表服务器文件夹命名空间和内容，以及重新创建基于角色的安全性。</span><span class="sxs-lookup"><span data-stu-id="28ddb-191">Deployment scripts are written using this approach because it allows you to re-create a report server folder namespace and content, and re-create role-based security.</span></span>  
  
-   <span data-ttu-id="28ddb-192">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 版本引入了用于 SharePoint 集成模式的 PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="28ddb-192">The [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] release introduced PowerShell cmdlets for SharePoint integrated mode.</span></span> <span data-ttu-id="28ddb-193">您可以使用 PowerShell 配置和管理 SharePoint 集成。</span><span class="sxs-lookup"><span data-stu-id="28ddb-193">You can use PowerShell to configure and administer the SharePoint integration.</span></span>  <span data-ttu-id="28ddb-194">有关详细信息，请参阅 [用于 Reporting Services SharePoint 模式的 PowerShell cmdlet](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-194">For more information, see [PowerShell cmdlets for Reporting Services SharePoint Mode](../powershell-cmdlets-for-reporting-services-sharepoint-mode.md).</span></span>  
  
## <a name="use-scripts-to-migrate-report-server-content-and-folders"></a><span data-ttu-id="28ddb-195">使用脚本迁移报表服务器内容和文件夹</span><span class="sxs-lookup"><span data-stu-id="28ddb-195">Use Scripts to Migrate Report Server Content and Folders</span></span>  
 <span data-ttu-id="28ddb-196">可以编写用于在其他报表服务器实例中复制报表服务器环境的脚本。</span><span class="sxs-lookup"><span data-stu-id="28ddb-196">You can write scripts that duplicate a report server environment on another report server instance.</span></span> <span data-ttu-id="28ddb-197">通常会使用 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 编写部署脚本，然后使用报表服务器脚本主机实用工具处理这些脚本。</span><span class="sxs-lookup"><span data-stu-id="28ddb-197">Deployment scripts are generally written in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and then processed using the report server script host utility.</span></span>  
  
 <span data-ttu-id="28ddb-198"> 有关详细示例，请参阅 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-198">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
 <span data-ttu-id="28ddb-199">使用脚本可以在服务器之间复制文件夹、共享数据源、资源、报表、角色分配和设置。</span><span class="sxs-lookup"><span data-stu-id="28ddb-199">Use scripts to copy folders, shared data sources, resources, reports, role assignments, and settings from one server to another.</span></span> <span data-ttu-id="28ddb-200">为报表服务器实例编写脚本，然后在其他服务器上运行该脚本以重新创建报表服务器命名空间。</span><span class="sxs-lookup"><span data-stu-id="28ddb-200">You write a script for one report server instance, and then run it on another server to re-create the report server namespace.</span></span> <span data-ttu-id="28ddb-201">如果在 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 部署中有多个报表服务器，则可以在每台服务器上分别运行该脚本，以便通过同一种方式配置所有的服务器。</span><span class="sxs-lookup"><span data-stu-id="28ddb-201">If you have multiple report servers in your [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] deployment, you can run the script on each server individually to configure all servers in the same way.</span></span>  
  
 <span data-ttu-id="28ddb-202">下面是在服务器之间迁移报表的步骤：</span><span class="sxs-lookup"><span data-stu-id="28ddb-202">The following list describes the steps for migrating reports from one server to another.</span></span>  
  
1.  <span data-ttu-id="28ddb-203">将脚本变量设置为源报表服务器的 URL。</span><span class="sxs-lookup"><span data-stu-id="28ddb-203">Set your script variable to the URL of the source report server.</span></span>  
  
2.  <span data-ttu-id="28ddb-204">使用 <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> 和 <xref:ReportService2010.ReportingService2010.GetProperties%2A> 方法检索报表定义和报表的属性。</span><span class="sxs-lookup"><span data-stu-id="28ddb-204">Use the <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A> and <xref:ReportService2010.ReportingService2010.GetProperties%2A> methods to retrieve the report definition and the properties of the report.</span></span>  
  
3.  <span data-ttu-id="28ddb-205">将 URL 设置为指向目标服务器。</span><span class="sxs-lookup"><span data-stu-id="28ddb-205">Set the URL to point to the destination server.</span></span>  
  
4.  <span data-ttu-id="28ddb-206">使用 <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> 方法，传递从 <xref:ReportService2010.ReportingService2010.GetProperties%2A> 返回的属性和由 <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>。</span><span class="sxs-lookup"><span data-stu-id="28ddb-206">Use <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> method, passing the properties returned from <xref:ReportService2010.ReportingService2010.GetProperties%2A> and the report definition returned by <xref:ReportService2010.ReportingService2010.GetItemDefinition%2A>.</span></span>  
  
 <span data-ttu-id="28ddb-207">通过结合使用 get 方法和 create 方法，您可以执行类似的步骤以迁移设置、文件夹、共享数据源和资源。</span><span class="sxs-lookup"><span data-stu-id="28ddb-207">By using a combination of get and create methods, you can perform similar steps to migrate settings, folders, shared data sources, and resources.</span></span> <span data-ttu-id="28ddb-208">有关可用方法的详细信息，请参阅[技术参考 (SSRS)](../technical-reference-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-208">For more information about the methods available to you, see [Technical Reference &#40;SSRS&#41;](../technical-reference-ssrs.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="28ddb-209">除非已显示设置凭据，否则脚本将使用运行脚本的用户的 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 凭据运行。</span><span class="sxs-lookup"><span data-stu-id="28ddb-209">Scripts run under the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials of the user running the script unless credentials are explicitly set.</span></span>  
  
 <span data-ttu-id="28ddb-210">有关如何设置格式并运行脚本文件的详细信息，请参阅 [使用 rs.exe 实用工具和 Web 服务编写脚本](script-with-the-rs-exe-utility-and-the-web-service.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-210">For more information about how to format and run a script file, see [Script with the rs.exe Utility and the Web Service](script-with-the-rs-exe-utility-and-the-web-service.md).</span></span>  
  
## <a name="using-scripts-to-set-server-properties"></a><span data-ttu-id="28ddb-211">使用脚本设置服务器属性</span><span class="sxs-lookup"><span data-stu-id="28ddb-211">Using Scripts to Set Server Properties</span></span>  
 <span data-ttu-id="28ddb-212">可以编写脚本以针对报表服务器设置系统属性。</span><span class="sxs-lookup"><span data-stu-id="28ddb-212">You can write scripts that set system properties on the report server.</span></span> <span data-ttu-id="28ddb-213">下面的 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET 脚本显示了一种设置属性的方法。</span><span class="sxs-lookup"><span data-stu-id="28ddb-213">The following [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] .NET script shows one way to set properties.</span></span> <span data-ttu-id="28ddb-214">该示例禁用了 RSClientPrint ActiveX 控件，但可以用任意有效的属性名称和值来替换 `EnableClientPrinting` 和 `False`。</span><span class="sxs-lookup"><span data-stu-id="28ddb-214">This example disables the RSClientPrint ActiveX control, but you can replace `EnableClientPrinting` and `False` with any valid property name and value.</span></span> <span data-ttu-id="28ddb-215">若要查看服务器属性的完整列表，请参阅 [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-215">To view a complete list of server properties, see [Report Server System Properties](../report-server-web-service/net-framework/reporting-services-properties-report-server-system-properties.md).</span></span>  
  
 <span data-ttu-id="28ddb-216">若要使用该脚本，则将其保存至扩展名为 .rss 的文件，然后使用 rs.exe 命令提示实用工具在报表服务器上运行该文件。</span><span class="sxs-lookup"><span data-stu-id="28ddb-216">To use the script, save it to a file that has an .rss extension, and then use the rs.exe command prompt utility to run the file on the report server.</span></span> <span data-ttu-id="28ddb-217">由于没有编译该脚本，因此不需要安装 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="28ddb-217">The script is not compiled, so it is not necessary to have an installation of [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)].</span></span> <span data-ttu-id="28ddb-218">该示例假定您对承载报表服务器的本地计算机拥有权限。</span><span class="sxs-lookup"><span data-stu-id="28ddb-218">This example assumes that you have permissions on the local computer that hosts the report server.</span></span> <span data-ttu-id="28ddb-219">如果未使用拥有权限的帐户进行登录，则必须通过其他命令行参数来指定帐户信息。</span><span class="sxs-lookup"><span data-stu-id="28ddb-219">If you are not logged on under an account that has permissions, you must specify account information through additional command line arguments.</span></span> <span data-ttu-id="28ddb-220">有关详细信息，请参阅 [RS.exe 实用工具 (SSRS)](rs-exe-utility-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-220">For more information, see [RS.exe Utility &#40;SSRS&#41;](rs-exe-utility-ssrs.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="28ddb-221"> 有关详细示例，请参阅 [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md)。</span><span class="sxs-lookup"><span data-stu-id="28ddb-221">For a detailed example, see [Sample Reporting Services rs.exe Script to Migrate Content between Report Servers](sample-reporting-services-rs-exe-script-to-copy-content-between-report-servers.md).</span></span>  
  
```vb
Public Sub Main()  
        Dim props(0) As [Property]  
        Dim setProp As New [Property]  
        setProp.Name = "EnableClientPrinting"  
        setProp.Value = "False"   
        props(0) = setProp  
        Try  
            rs.SetSystemProperties(props)  
        Catch ex As System.Web.Services.Protocols.SoapException  
            Console.Write(ex.Detail.InnerXml)  
        Catch e as Exception  
            Console.Write(e.Message)  
        End Try  
End Sub  
```  
  
## <a name="see-also"></a><span data-ttu-id="28ddb-222">另请参阅</span><span class="sxs-lookup"><span data-stu-id="28ddb-222">See Also</span></span>  
 <span data-ttu-id="28ddb-223">[GenerateDatabaseCreationScript 方法 (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-223">[GenerateDatabaseCreationScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabasecreationscript.md) </span></span>  
 <span data-ttu-id="28ddb-224">[GenerateDatabaseRightsScript 方法 (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-224">[GenerateDatabaseRightsScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaserightsscript.md) </span></span>  
 <span data-ttu-id="28ddb-225">[GenerateDatabaseUpgradeScript 方法 (WMI MSReportServer_ConfigurationSetting)](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-225">[GenerateDatabaseUpgradeScript Method &#40;WMI MSReportServer_ConfigurationSetting&#41;](../wmi-provider-library-reference/configurationsetting-method-generatedatabaseupgradescript.md) </span></span>  
 <span data-ttu-id="28ddb-226">[从命令提示符安装 SQL Server 2014](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-226">[Install SQL Server 2014 from the Command Prompt](../../database-engine/install-windows/install-sql-server-from-the-command-prompt.md) </span></span>  
 <span data-ttu-id="28ddb-227">[安装 Reporting Services 本机模式报表服务器](../install-windows/install-reporting-services-native-mode-report-server.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-227">[Install Reporting Services Native Mode Report Server](../install-windows/install-reporting-services-native-mode-report-server.md) </span></span>  
 <span data-ttu-id="28ddb-228">[Reporting Services 报表服务器（本机模式）](../report-server/reporting-services-report-server-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-228">[Reporting Services Report Server &#40;Native Mode&#41;](../report-server/reporting-services-report-server-native-mode.md) </span></span>  
 <span data-ttu-id="28ddb-229">[报表服务器命令提示实用工具 (SSRS)](report-server-command-prompt-utilities-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-229">[Report Server Command Prompt Utilities &#40;SSRS&#41;](report-server-command-prompt-utilities-ssrs.md) </span></span>  
 <span data-ttu-id="28ddb-230">[规划 Reporting Services 和 Power View 浏览器支持 &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span><span class="sxs-lookup"><span data-stu-id="28ddb-230">[Planning for Reporting Services and Power View Browser Support &#40;Reporting Services 2014&#41;](../browser-support-for-reporting-services-and-power-view.md) </span></span>  
 [<span data-ttu-id="28ddb-231">Reporting Services 工具</span><span class="sxs-lookup"><span data-stu-id="28ddb-231">Reporting Services Tools</span></span>](reporting-services-tools.md)  
