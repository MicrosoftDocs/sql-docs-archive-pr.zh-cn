---
title: 在自定义应用程序中使用 RSClientPrint 控件 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- RSPrintClient control
- print controls [Reporting Services]
- custom printing [Reporting Services]
- client-side printing
ms.assetid: 8c0bdd18-8905-4e22-9774-a240fc81a8a7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 2a1f8f5e4be20289d7afbee4cb044bcdec475123
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87692682"
---
# <a name="using-the-rsclientprint-control-in-custom-applications"></a><span data-ttu-id="3e45c-102">在自定义应用程序中使用 RSClientPrint 控件</span><span class="sxs-lookup"><span data-stu-id="3e45c-102">Using the RSClientPrint Control in Custom Applications</span></span>
  <span data-ttu-id="3e45c-103">对于在 HTML 查看器中查看的报表，[!INCLUDE[msCoName](../../../includes/msconame-md.md)] ActiveX 控件 RSPrintClient 为其提供了客户端打印功能\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-103">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] ActiveX control, **RSPrintClient**, provides client-side printing for reports viewed in HTML Viewer.</span></span> <span data-ttu-id="3e45c-104">通过该控件提供的“打印”对话框，用户可以启动打印作业、预览报表、指定要打印的页面以及更改边距\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-104">It provides a **Print** dialog box so that a user can initiate a print job, preview a report, specify pages to print, and change the margins.</span></span> <span data-ttu-id="3e45c-105">在客户端打印操作过程中，报表服务器通过图像 (EMF) 呈现扩展插件呈现报表，使用操作系统的打印功能创建打印作业并将作业发送到打印机。</span><span class="sxs-lookup"><span data-stu-id="3e45c-105">During a client-side print operation, the report server renders the report in the Image (EMF) rendering extension and uses the print capabilities of the operating system to create the print job and send it to a printer.</span></span>  
  
 <span data-ttu-id="3e45c-106">通过客户端打印功能，可以避开用户计算机上的浏览器打印设置，改用报表的页面尺寸、边距、表头文本和表尾文本来创建打印输出，从而控制和提高 HTML 报表的打印输出质量。</span><span class="sxs-lookup"><span data-stu-id="3e45c-106">Client-side printing provides a way to control and improve the quality of a printout for an HTML report by side-stepping browser print settings on the user's computer, and instead using the page dimensions, margins, header, and footer text of the report to create the print output.</span></span> <span data-ttu-id="3e45c-107">该打印控件通过读取报表的属性值来设置页大小和边距。</span><span class="sxs-lookup"><span data-stu-id="3e45c-107">The print control reads property values of the report to set page size and margins.</span></span>  
  
 <span data-ttu-id="3e45c-108">开发人员如果想要在第三方工具栏或查看器中启用客户端打印功能，可以通过 RSClientPrint COM 对象访问该 ActiveX 控件\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-108">Developers who want to enable the client-side printing feature in third-party toolbars or viewers can access the ActiveX control through the **RSClientPrint** COM object.</span></span> <span data-ttu-id="3e45c-109">该控件可以自由分发。</span><span class="sxs-lookup"><span data-stu-id="3e45c-109">The control can be distributed freely.</span></span> <span data-ttu-id="3e45c-110">下表列出了使用该控件的建议：</span><span class="sxs-lookup"><span data-stu-id="3e45c-110">The following list provides recommendations for using the control:</span></span>  
  
-   <span data-ttu-id="3e45c-111">使用该控件提高基于 Web 的报表的打印质量。</span><span class="sxs-lookup"><span data-stu-id="3e45c-111">Use the control to improve printing for Web-based reports.</span></span> <span data-ttu-id="3e45c-112">可以用任何 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 兼容的编程语言或在脚本中指定该对象。</span><span class="sxs-lookup"><span data-stu-id="3e45c-112">You can specify the object in any of the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]-compatible programming languages or in script.</span></span> <span data-ttu-id="3e45c-113">该控件不用于 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] 窗体应用程序。</span><span class="sxs-lookup"><span data-stu-id="3e45c-113">The control is not intended for [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows Forms applications.</span></span>  
  
-   <span data-ttu-id="3e45c-114">从 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 程序文件复制 .cab 文件，并将其添加到自定义应用程序基本代码中。</span><span class="sxs-lookup"><span data-stu-id="3e45c-114">Copy the .cab file from the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] program files and add it to your custom application code base.</span></span>  
  
-   <span data-ttu-id="3e45c-115">使用 \<OBJECT> 标记来指定控件。</span><span class="sxs-lookup"><span data-stu-id="3e45c-115">Use an \<OBJECT> tag to specify the control.</span></span>  
  
-   <span data-ttu-id="3e45c-116">在 OBJECT CODEBASE 属性中为 .cab 文件指定相对 URL 或完全限定的 URL。</span><span class="sxs-lookup"><span data-stu-id="3e45c-116">Specify a relative or fully qualified URL to the .cab file in the OBJECT CODEBASE attribute.</span></span>  
  
-   <span data-ttu-id="3e45c-117">为 .cab 文件指定您自己的应用程序版本信息，以跟踪在您的应用程序中使用的版本。</span><span class="sxs-lookup"><span data-stu-id="3e45c-117">Specify your own application version information for the .cab file to track which version is used in your application.</span></span>  
  
-   <span data-ttu-id="3e45c-118">查阅有关图像 (EMF) 呈现的联机丛书主题，以了解如何呈现页面以供打印预览和输出。</span><span class="sxs-lookup"><span data-stu-id="3e45c-118">Review the Books Online topics about Image (EMF) rendering to understand how pages are rendered for print preview and output.</span></span>  
  
## <a name="rsprintclient-overview"></a><span data-ttu-id="3e45c-119">RSPrintClient 概述</span><span class="sxs-lookup"><span data-stu-id="3e45c-119">RSPrintClient Overview</span></span>  
 <span data-ttu-id="3e45c-120">该控件显示一个自定义打印对话框，它支持其他打印对话框常见的功能，包括打印预览、指定特定页和范围的页面选择、页边距和打印方向等功能。</span><span class="sxs-lookup"><span data-stu-id="3e45c-120">The control displays a custom print dialog box that supports features common to other print dialog boxes, including print preview, page selections for specifying specific pages and ranges, page margins, and orientation.</span></span> <span data-ttu-id="3e45c-121">该控件打包为 CAB 文件。</span><span class="sxs-lookup"><span data-stu-id="3e45c-121">The control is packaged as a CAB file.</span></span> <span data-ttu-id="3e45c-122">“打印”对话框中的文本已本地化为 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 中支持的所有语言\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-122">The text in the **Print** dialog box is localized into all of the languages supported in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3e45c-123">RSPrintClient ActiveX 控件使用图像呈现扩展插件 (EMF) 打印报表\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-123">**RSPrintClient** ActiveX control uses the Image rendering extension (EMF) to print the report.</span></span> <span data-ttu-id="3e45c-124">使用的 EMF 设备信息包括：StartPage、EndPage、MarginBottom、MarginLeft、MarginTop、MarginRight、PageHeight 和 PageWidth。</span><span class="sxs-lookup"><span data-stu-id="3e45c-124">The following EMF device information is used: StartPage, EndPage, MarginBottom, MarginLeft, MarginTop, MarginRight, PageHeight, and PageWidth.</span></span> <span data-ttu-id="3e45c-125">不支持图像呈现的其他设备信息设置。</span><span class="sxs-lookup"><span data-stu-id="3e45c-125">Other device information settings for image rendering are not supported.</span></span>  
  
### <a name="language-support"></a><span data-ttu-id="3e45c-126">语言支持</span><span class="sxs-lookup"><span data-stu-id="3e45c-126">Language Support</span></span>  
 <span data-ttu-id="3e45c-127">该打印控件可以提供不同语言的用户界面文本，接受符合不同度量系统标准的输入值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-127">The print control provides user interface text in different languages, and accepts input values calibrated to different measurement systems.</span></span> <span data-ttu-id="3e45c-128">所用的语言和度量系统由 Culture 和 UICulture 属性确定\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-128">The language and measurement system used are determined by the **Culture** and **UICulture** properties.</span></span> <span data-ttu-id="3e45c-129">这两个属性都接受 LCID 值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-129">Both properties accept LCID values.</span></span> <span data-ttu-id="3e45c-130">如果为所支持语言的变体语言指定 LCID，则会应用最接近的匹配语言。</span><span class="sxs-lookup"><span data-stu-id="3e45c-130">If you specify an LCID for a language that is a variation on a supported language, you will get the language that provides the closest match.</span></span> <span data-ttu-id="3e45c-131">如果不支持指定的 LCID，并且没有最接近的匹配 LCID，则会应用英语（美国）。</span><span class="sxs-lookup"><span data-stu-id="3e45c-131">If you specify an LCID that is not supported and for which no other LCID is a close match, you will get English (United States).</span></span>  
  
## <a name="using-rsclientprint-in-code"></a><span data-ttu-id="3e45c-132">在代码中使用 RSClientPrint</span><span class="sxs-lookup"><span data-stu-id="3e45c-132">Using RSClientPrint in Code</span></span>  
 <span data-ttu-id="3e45c-133">RSClientPrint 对象用于以编程方式获取对 ActiveX 控件及其方法和属性的访问权\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-133">The **RSClientPrint** object is used to gain access programmatically to the ActiveX control and its methods and properties.</span></span> <span data-ttu-id="3e45c-134">该控件为打印预览提供了一个模式对话框。</span><span class="sxs-lookup"><span data-stu-id="3e45c-134">The control provides a modal dialog for print preview.</span></span>  
  
### <a name="specifying-default-values"></a><span data-ttu-id="3e45c-135">指定默认值</span><span class="sxs-lookup"><span data-stu-id="3e45c-135">Specifying Default Values</span></span>  
 <span data-ttu-id="3e45c-136">可使用报表的边距和页值初始化“打印”对话框\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-136">You can initialize the **Print** dialog box with margin and page values of the report.</span></span> <span data-ttu-id="3e45c-137">默认情况下，使用报表定义中的值初始化“打印”对话框\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-137">By default, the **Print** dialog box is initialized with values from the report definition.</span></span> <span data-ttu-id="3e45c-138">您可以使用这些默认值，也可以通过设置对象属性来指定不同的值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-138">You can use the defaults, or specify different values by setting properties on the object.</span></span>  
  
 <span data-ttu-id="3e45c-139">所有尺寸都是以毫米为单位进行设置的。</span><span class="sxs-lookup"><span data-stu-id="3e45c-139">All dimensions are set in millimeters.</span></span> <span data-ttu-id="3e45c-140">如果将 Culture 和 UICulture 设置为不使用公制度量单位的区域，则在运行时会进行度量换算\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-140">Measurement conversion occurs at run time if the **Culture** and **UICulture** are set to locales that do not use metric measurements.</span></span>  
  
 <span data-ttu-id="3e45c-141">若要了解哪些值用于页面尺寸和边距，可以使用 GetProperties 方法检索默认值\*\*\*\*：</span><span class="sxs-lookup"><span data-stu-id="3e45c-141">To understand which values are used for page dimensions and margins, you can use the **GetProperties** method to retrieve the default values:</span></span>  
  
-   <span data-ttu-id="3e45c-142">PageHeight 和 PageWidth 用于指定默认的页高和页宽\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-142">**PageHeight** and **PageWidth** specify the default page height and width.</span></span> <span data-ttu-id="3e45c-143">在启动该打印控件时，将使用这些属性值选择可用于当前所选打印机的最接近的纸张大小。</span><span class="sxs-lookup"><span data-stu-id="3e45c-143">When the print control is launched, these property values are used to select the closest paper size available for the currently selected printer.</span></span> <span data-ttu-id="3e45c-144">如果 PageWidth 大于 PageHeight，方向将设置为“横向”\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-144">If **PageWidth** is great than **PageHeight**, the orientation is set to Landscape.</span></span> <span data-ttu-id="3e45c-145">否则，方向设置为“纵向”。</span><span class="sxs-lookup"><span data-stu-id="3e45c-145">Otherwise, it is set to Portrait.</span></span>  
  
-   <span data-ttu-id="3e45c-146">默认情况下，LeftMargin、RightMargin、TopMargin 和 BottomMargin 均设置为 12.2 毫米\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-146">**LeftMargin**, **RightMargin**, **TopMargin**, and **BottomMargin** are all set to 12.2 millimeters by default.</span></span>  
  
 <span data-ttu-id="3e45c-147">这些属性存储在报表服务器上的 Item 属性集合中\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-147">These properties are stored in the **Item** properties collection on the report server.</span></span> <span data-ttu-id="3e45c-148">每次更新报表定义时，都将覆盖这些值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-148">The values are overwritten each time a report definition is updated.</span></span>  
  
### <a name="rsclientprint-properties"></a><span data-ttu-id="3e45c-149">RSClientPrint 属性</span><span class="sxs-lookup"><span data-stu-id="3e45c-149">RSClientPrint Properties</span></span>  
  
|<span data-ttu-id="3e45c-150">属性</span><span class="sxs-lookup"><span data-stu-id="3e45c-150">Property</span></span>|<span data-ttu-id="3e45c-151">类型</span><span class="sxs-lookup"><span data-stu-id="3e45c-151">Type</span></span>|<span data-ttu-id="3e45c-152">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-152">RW</span></span>|<span data-ttu-id="3e45c-153">默认</span><span class="sxs-lookup"><span data-stu-id="3e45c-153">Default</span></span>|<span data-ttu-id="3e45c-154">说明</span><span class="sxs-lookup"><span data-stu-id="3e45c-154">Description</span></span>|  
|--------------|----------|--------|-------------|-----------------|  
|<span data-ttu-id="3e45c-155">MarginLeft</span><span class="sxs-lookup"><span data-stu-id="3e45c-155">MarginLeft</span></span>|<span data-ttu-id="3e45c-156">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-156">Double</span></span>|<span data-ttu-id="3e45c-157">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-157">RW</span></span>|<span data-ttu-id="3e45c-158">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-158">report setting</span></span>|<span data-ttu-id="3e45c-159">获取或设置左边距。</span><span class="sxs-lookup"><span data-stu-id="3e45c-159">Gets or sets the left margin.</span></span> <span data-ttu-id="3e45c-160">如果开发人员没有设置或报表中未指定，则默认值为 12.2 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-160">The default value if not set by the developer or specified in the report is 12.2 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-161">MarginRight</span><span class="sxs-lookup"><span data-stu-id="3e45c-161">MarginRight</span></span>|<span data-ttu-id="3e45c-162">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-162">Double</span></span>|<span data-ttu-id="3e45c-163">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-163">RW</span></span>|<span data-ttu-id="3e45c-164">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-164">report setting</span></span>|<span data-ttu-id="3e45c-165">获取或设置右边距。</span><span class="sxs-lookup"><span data-stu-id="3e45c-165">Gets or sets the right margin.</span></span> <span data-ttu-id="3e45c-166">如果开发人员没有设置或报表中未指定，则默认值为 12.2 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-166">The default value if not set by the developer or specified in the report is 12.2 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-167">MarginTop</span><span class="sxs-lookup"><span data-stu-id="3e45c-167">MarginTop</span></span>|<span data-ttu-id="3e45c-168">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-168">Double</span></span>|<span data-ttu-id="3e45c-169">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-169">RW</span></span>|<span data-ttu-id="3e45c-170">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-170">report setting</span></span>|<span data-ttu-id="3e45c-171">获取或设置上边距。</span><span class="sxs-lookup"><span data-stu-id="3e45c-171">Gets or sets the top margin.</span></span> <span data-ttu-id="3e45c-172">如果开发人员没有设置或报表中未指定，则默认值为 12.2 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-172">The default value if not set by the developer or specified in the report is 12.2 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-173">MarginBottom</span><span class="sxs-lookup"><span data-stu-id="3e45c-173">MarginBottom</span></span>|<span data-ttu-id="3e45c-174">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-174">Double</span></span>|<span data-ttu-id="3e45c-175">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-175">RW</span></span>|<span data-ttu-id="3e45c-176">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-176">report setting</span></span>|<span data-ttu-id="3e45c-177">获取或设置下边距。</span><span class="sxs-lookup"><span data-stu-id="3e45c-177">Gets or sets the bottom margin.</span></span> <span data-ttu-id="3e45c-178">如果开发人员没有设置或报表中未指定，则默认值为 12.2 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-178">The default value if not set by the developer or specified in the report is 12.2 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-179">PageWidth</span><span class="sxs-lookup"><span data-stu-id="3e45c-179">PageWidth</span></span>|<span data-ttu-id="3e45c-180">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-180">Double</span></span>|<span data-ttu-id="3e45c-181">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-181">RW</span></span>|<span data-ttu-id="3e45c-182">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-182">report setting</span></span>|<span data-ttu-id="3e45c-183">获取或设置页宽。</span><span class="sxs-lookup"><span data-stu-id="3e45c-183">Gets or sets the page width.</span></span> <span data-ttu-id="3e45c-184">如果开发人员或报表定义中未进行设置，则默认值为 215.9 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-184">The default value if not set by the developer or the report definition is 215.9 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-185">PageHeight</span><span class="sxs-lookup"><span data-stu-id="3e45c-185">PageHeight</span></span>|<span data-ttu-id="3e45c-186">Double</span><span class="sxs-lookup"><span data-stu-id="3e45c-186">Double</span></span>|<span data-ttu-id="3e45c-187">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-187">RW</span></span>|<span data-ttu-id="3e45c-188">报表设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-188">report setting</span></span>|<span data-ttu-id="3e45c-189">获取或设置页高。</span><span class="sxs-lookup"><span data-stu-id="3e45c-189">Gets or sets the page height.</span></span> <span data-ttu-id="3e45c-190">如果开发人员或报表定义中未进行设置，则默认值为 279.4 毫米。</span><span class="sxs-lookup"><span data-stu-id="3e45c-190">The default value if not set by the developer or the report definition is 279.4 millimeters.</span></span>|  
|<span data-ttu-id="3e45c-191">文化</span><span class="sxs-lookup"><span data-stu-id="3e45c-191">Culture</span></span>|<span data-ttu-id="3e45c-192">Int32</span><span class="sxs-lookup"><span data-stu-id="3e45c-192">Int32</span></span>|<span data-ttu-id="3e45c-193">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-193">RW</span></span>|<span data-ttu-id="3e45c-194">浏览器区域设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-194">Browser locale</span></span>|<span data-ttu-id="3e45c-195">指定区域设置标识符 (LCID)。</span><span class="sxs-lookup"><span data-stu-id="3e45c-195">Specifies the locale identifier (LCID).</span></span> <span data-ttu-id="3e45c-196">此值将确定用户输入的度量单位。</span><span class="sxs-lookup"><span data-stu-id="3e45c-196">This value determines the unit of measurement for user input.</span></span> <span data-ttu-id="3e45c-197">例如，如果用户键入，则 `3` 该值将以毫米为单位，如果语言为英语 (美国) 。</span><span class="sxs-lookup"><span data-stu-id="3e45c-197">For example, if a user types `3`, the value will be measured in millimeters if the language is French or inches if the language is English (United States).</span></span> <span data-ttu-id="3e45c-198">有效值包括：1028、1031、1033、1036、1040、1041、1042、2052、3082。</span><span class="sxs-lookup"><span data-stu-id="3e45c-198">Valid values include: 1028, 1031, 1033, 1036, 1040, 1041, 1042, 2052, 3082.</span></span>|  
|<span data-ttu-id="3e45c-199">UICulture</span><span class="sxs-lookup"><span data-stu-id="3e45c-199">UICulture</span></span>|<span data-ttu-id="3e45c-200">String</span><span class="sxs-lookup"><span data-stu-id="3e45c-200">String</span></span>|<span data-ttu-id="3e45c-201">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-201">RW</span></span>|<span data-ttu-id="3e45c-202">客户端区域性</span><span class="sxs-lookup"><span data-stu-id="3e45c-202">Client culture</span></span>|<span data-ttu-id="3e45c-203">指定对话框字符串的本地化语言。</span><span class="sxs-lookup"><span data-stu-id="3e45c-203">Specifies string localization of the dialog box.</span></span> <span data-ttu-id="3e45c-204">“打印”对话框中的文本已本地化为以下语言：简体中文、繁体中文、英语、法语、德语、意大利语、日语、朝鲜语和西班牙语。</span><span class="sxs-lookup"><span data-stu-id="3e45c-204">Text in the Print dialog is localized into these languages: Chinese-Simplified, Chinese Traditional, English, French, German, Italian, Japanese, Korean, and Spanish.</span></span> <span data-ttu-id="3e45c-205">有效值包括：1028、1031、1033、1036、1040、1041、1042、2052、3082。</span><span class="sxs-lookup"><span data-stu-id="3e45c-205">Valid values include: 1028, 1031, 1033, 1036, 1040, 1041, 1042, 2052, 3082.</span></span>|  
|<span data-ttu-id="3e45c-206">Authenticate</span><span class="sxs-lookup"><span data-stu-id="3e45c-206">Authenticate</span></span>|<span data-ttu-id="3e45c-207">Boolean</span><span class="sxs-lookup"><span data-stu-id="3e45c-207">Boolean</span></span>|<span data-ttu-id="3e45c-208">RW</span><span class="sxs-lookup"><span data-stu-id="3e45c-208">RW</span></span>|<span data-ttu-id="3e45c-209">错误</span><span class="sxs-lookup"><span data-stu-id="3e45c-209">False</span></span>|<span data-ttu-id="3e45c-210">指定控件是否向报表服务器发出 GET 命令，以启动无会话打印连接。</span><span class="sxs-lookup"><span data-stu-id="3e45c-210">Specifies whether the control issues a GET command against the report server to initiate a connection for out-of-session printing.</span></span>|  
  
### <a name="when-to-set-the-authenticate-property"></a><span data-ttu-id="3e45c-211">何时设置 Authenticate 属性</span><span class="sxs-lookup"><span data-stu-id="3e45c-211">When to Set the Authenticate Property</span></span>  
 <span data-ttu-id="3e45c-212">从浏览器会话中进行打印时，无需设置 `Authenticate` 属性。</span><span class="sxs-lookup"><span data-stu-id="3e45c-212">When you print from within a browser session, you do not need to set the `Authenticate` property.</span></span> <span data-ttu-id="3e45c-213">在活动会话的上下文中，打印控件对报表服务器的所有请求都是通过浏览器来处理的。</span><span class="sxs-lookup"><span data-stu-id="3e45c-213">Within the context of an active session, all requests from the print control to the report server are handled through the browser.</span></span> <span data-ttu-id="3e45c-214">浏览器会设置与报表服务器通信所需的会话变量。</span><span class="sxs-lookup"><span data-stu-id="3e45c-214">The browser sets the session variables necessary for communication to the report server.</span></span>  
  
 <span data-ttu-id="3e45c-215">如果进行无会话打印（例如，将报表直接发送至打印机，而不是首先打开该报表），打印控件必须发出 HTTP `GET` 请求，以便与报表服务器建立会话。</span><span class="sxs-lookup"><span data-stu-id="3e45c-215">If you print out-of-session (for example, sending a report directly to a printer without first opening it), the print control must issue an HTTP `GET` request to set up the session with the report server.</span></span> <span data-ttu-id="3e45c-216">若要发出 `GET` 请求，请将 `Authenticate` 设置为 `True`。</span><span class="sxs-lookup"><span data-stu-id="3e45c-216">To issue the `GET` request, you set `Authenticate` to `True`.</span></span>  
  
 <span data-ttu-id="3e45c-217">仅当使用 Windows 集成安全性或基本身份验证时，才需要发出 `GET` 请求。</span><span class="sxs-lookup"><span data-stu-id="3e45c-217">You only need to issue the `GET` request if you are using Windows integrated security or Basic authentication.</span></span> <span data-ttu-id="3e45c-218">如果使用的是窗体身份验证，将忽略 `Authenticate` 属性。</span><span class="sxs-lookup"><span data-stu-id="3e45c-218">If you are using forms authentication, the `Authenticate` property is ignored.</span></span> <span data-ttu-id="3e45c-219">此时，应用程序代码必须使用您提供的自定义安全扩展插件来设置会话及验证用户身份。</span><span class="sxs-lookup"><span data-stu-id="3e45c-219">Your application code must set the session and authenticate the user using the custom security extension that you provide.</span></span> <span data-ttu-id="3e45c-220">如果使用窗体身份验证，请确保针对身份验证 cookie 设置的过期值可使会话保留一段合理的时间。</span><span class="sxs-lookup"><span data-stu-id="3e45c-220">If you are using forms authentication, be sure to set the expiration value on the authentication cookie to a value that preserves sessions for a reasonable interval.</span></span> <span data-ttu-id="3e45c-221">如果该值过低，每当 cookie 过期时，系统都将提示用户提供登录凭据。</span><span class="sxs-lookup"><span data-stu-id="3e45c-221">If the value is too low, users will be prompted to provide logon credentials each time the cookie expires.</span></span>  
  
### <a name="clsids"></a><span data-ttu-id="3e45c-222">CLSID</span><span class="sxs-lookup"><span data-stu-id="3e45c-222">CLSIDs</span></span>  
 <span data-ttu-id="3e45c-223">当在内部运行报表时，使用以下 CLSID 值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-223">When you are running the report on-premises, you use the following CLSID values.</span></span>  
  
-   <span data-ttu-id="3e45c-224">41861299-EAB2-4DCC-986C-802AE12AC499</span><span class="sxs-lookup"><span data-stu-id="3e45c-224">41861299-EAB2-4DCC-986C-802AE12AC499</span></span>  
  
-   <span data-ttu-id="3e45c-225">5554DCB0-700B-498D-9B58-4E40E5814405</span><span class="sxs-lookup"><span data-stu-id="3e45c-225">5554DCB0-700B-498D-9B58-4E40E5814405</span></span>  
  
-   <span data-ttu-id="3e45c-226">60677965-AB8B-464f-9B04-4BA871A2F17F</span><span class="sxs-lookup"><span data-stu-id="3e45c-226">60677965-AB8B-464f-9B04-4BA871A2F17F</span></span>  
  
 <span data-ttu-id="3e45c-227">当在 Azure SQL 报告中运行报表时，使用以下 CLSID 值。</span><span class="sxs-lookup"><span data-stu-id="3e45c-227">When you are running the report in Azure SQL Reporting, you use the following CLSID values.</span></span>  
  
-   <span data-ttu-id="3e45c-228">3DD32426-554D-48C0-A200-65D3BF880E38</span><span class="sxs-lookup"><span data-stu-id="3e45c-228">3DD32426-554D-48C0-A200-65D3BF880E38</span></span>  
  
-   <span data-ttu-id="3e45c-229">05662494-ACF9-446A-BE4C-7D3F7EA7F62F</span><span class="sxs-lookup"><span data-stu-id="3e45c-229">05662494-ACF9-446A-BE4C-7D3F7EA7F62F</span></span>  
  
### <a name="rsprintclient-support-for-the-print-method"></a><span data-ttu-id="3e45c-230">RSPrintClient 对 Print 方法的支持</span><span class="sxs-lookup"><span data-stu-id="3e45c-230">RSPrintClient Support for the Print Method</span></span>  
 <span data-ttu-id="3e45c-231">RSClientPrint 对象支持用于启动“打印”对话框的 Print 方法\*\*\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-231">The **RSClientPrint** object supports the **Print** method used to launch the Print dialog box.</span></span> <span data-ttu-id="3e45c-232">Print 方法具有以下参数\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="3e45c-232">The **Print** method has the following arguments.</span></span>  
  
|<span data-ttu-id="3e45c-233">参数</span><span class="sxs-lookup"><span data-stu-id="3e45c-233">Argument</span></span>|<span data-ttu-id="3e45c-234">I/O</span><span class="sxs-lookup"><span data-stu-id="3e45c-234">I/O</span></span>|<span data-ttu-id="3e45c-235">类型</span><span class="sxs-lookup"><span data-stu-id="3e45c-235">Type</span></span>|<span data-ttu-id="3e45c-236">说明</span><span class="sxs-lookup"><span data-stu-id="3e45c-236">Description</span></span>|  
|--------------|----------|----------|-----------------|  
|<span data-ttu-id="3e45c-237">ServerPath</span><span class="sxs-lookup"><span data-stu-id="3e45c-237">ServerPath</span></span>|<span data-ttu-id="3e45c-238">在</span><span class="sxs-lookup"><span data-stu-id="3e45c-238">In</span></span>|<span data-ttu-id="3e45c-239">String</span><span class="sxs-lookup"><span data-stu-id="3e45c-239">String</span></span>|<span data-ttu-id="3e45c-240">指定 Report Server 虚拟目录 (例如， https://adventure-works/reportserver) 。</span><span class="sxs-lookup"><span data-stu-id="3e45c-240">Specifies the report server virtual directory (for example, https://adventure-works/reportserver).</span></span>|  
|<span data-ttu-id="3e45c-241">ReportPathParameters</span><span class="sxs-lookup"><span data-stu-id="3e45c-241">ReportPathParameters</span></span>|<span data-ttu-id="3e45c-242">在</span><span class="sxs-lookup"><span data-stu-id="3e45c-242">In</span></span>|<span data-ttu-id="3e45c-243">String</span><span class="sxs-lookup"><span data-stu-id="3e45c-243">String</span></span>|<span data-ttu-id="3e45c-244">指定报表在报表服务器文件夹命名空间中的全名，包括参数。</span><span class="sxs-lookup"><span data-stu-id="3e45c-244">Specifies the full name to the report in the report server folder namespace, including parameters.</span></span> <span data-ttu-id="3e45c-245">对报表的检索是通过 URL 访问进行的。</span><span class="sxs-lookup"><span data-stu-id="3e45c-245">Reports are retrieved through URL access.</span></span> <span data-ttu-id="3e45c-246">例如：“/AdventureWorks Sample Reports/Employee Sales Summary&EmpID=1234”</span><span class="sxs-lookup"><span data-stu-id="3e45c-246">For example: "/AdventureWorks Sample Reports/Employee Sales Summary&EmpID=1234"</span></span>|  
|<span data-ttu-id="3e45c-247">ReportName</span><span class="sxs-lookup"><span data-stu-id="3e45c-247">ReportName</span></span>|<span data-ttu-id="3e45c-248">在</span><span class="sxs-lookup"><span data-stu-id="3e45c-248">In</span></span>|<span data-ttu-id="3e45c-249">String</span><span class="sxs-lookup"><span data-stu-id="3e45c-249">String</span></span>|<span data-ttu-id="3e45c-250">报表的简称（在上面的示例中，简称为 Employee Sales Summary）。</span><span class="sxs-lookup"><span data-stu-id="3e45c-250">The short name of the report (in the example above, the short name is Employee Sales Summary).</span></span> <span data-ttu-id="3e45c-251">它显示在“打印”对话框和打印队列中。</span><span class="sxs-lookup"><span data-stu-id="3e45c-251">It appears in the Print dialog box and in the print queue.</span></span>|  
  
### <a name="example"></a><span data-ttu-id="3e45c-252">示例</span><span class="sxs-lookup"><span data-stu-id="3e45c-252">Example</span></span>  
 <span data-ttu-id="3e45c-253">下面的 HTML 示例显示如何在 JavaScript 中指定 .cab 文件、Print 方法和属性\*\*\*\*：</span><span class="sxs-lookup"><span data-stu-id="3e45c-253">The following HTML example shows how to specify the .cab file, **Print** method, and properties in JavaScript:</span></span>  
  
 `<BODY onload="Print()">`  
  
 `<OBJECT ID="RSClientPrint" CLASSID="CLSID: 5554DCB0-700B-498D-9B58-4E40E5814405D3" CODEBASE="<URL to the .CAB file>#Version=<your application version information>" VIEWASTEXT></OBJECT>`  
  
 `<script language="javascript">`  
  
 `function Print()`  
  
 `{`  
  
 `RSClientPrint.MarginLeft = 12.7;`  
  
 `RSClientPrint.MarginTop = 12.7;`  
  
 `RSClientPrint.MarginRight = 12.7;`  
  
 `RSClientPrint.MarginBottom = 12.7;`  
  
 `RSClientPrint.Culture = 1033;`  
  
 `RSClientPrint.UICulture = 9;`  
  
 `RSClientPrint.Print('http://localhost/rtm', '%2fEmployee_Sales_Summary&ReportMonth=6&ReportYear=2004&EmpID=20', 'Employee_Sales_Summary')`  
  
 `}`  
  
 `</script>`  
  
 `</BODY>`  
  
## <a name="see-also"></a><span data-ttu-id="3e45c-254">另请参阅</span><span class="sxs-lookup"><span data-stu-id="3e45c-254">See Also</span></span>  
 <span data-ttu-id="3e45c-255">[使用打印控件从浏览器打印报表 &#40;报表生成器和 SSRS&#41;](../../report-builder/print-reports-from-a-browser-with-the-print-control-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="3e45c-255">[Print Reports from a Browser with the Print Control &#40;Report Builder and SSRS&#41;](../../report-builder/print-reports-from-a-browser-with-the-print-control-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="3e45c-256">[&#40;报表生成器和 SSRS 打印报表&#41;](../../report-builder/print-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="3e45c-256">[Print Reports &#40;Report Builder and SSRS&#41;](../../report-builder/print-reports-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="3e45c-257">图像设备信息设置</span><span class="sxs-lookup"><span data-stu-id="3e45c-257">Image Device Information Settings</span></span>](../../image-device-information-settings.md)  
  
  
