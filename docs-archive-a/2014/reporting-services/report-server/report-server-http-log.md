---
title: 报表服务器 HTTP 日志 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- HTTP [Reporting Services]
ms.assetid: 6cc433b7-165c-4b16-9034-79256dd6735f
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 46adee4fb65361bb9b338c89b6e370ce1da68f9a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579491"
---
# <a name="report-server-http-log"></a><span data-ttu-id="33ba0-102">报表服务器 HTTP 日志</span><span class="sxs-lookup"><span data-stu-id="33ba0-102">Report Server HTTP Log</span></span>
  <span data-ttu-id="33ba0-103">[!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 报表服务器 HTTP 日志文件记录报表服务器所处理的所有 HTTP 请求和响应。</span><span class="sxs-lookup"><span data-stu-id="33ba0-103">The [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] Report Server HTTP log files keep a record of every HTTP request and response handled by the report server.</span></span> <span data-ttu-id="33ba0-104">由于请求溢出和超时错误不会到达报表服务器，因此这些错误不会记录在日志文件中。</span><span class="sxs-lookup"><span data-stu-id="33ba0-104">Because request overflow and timeout errors do not reach the report server, they are not recorded in the log file.</span></span>  
  
 <span data-ttu-id="33ba0-105">默认情况下，不启用 HTTP 日志记录。</span><span class="sxs-lookup"><span data-stu-id="33ba0-105">HTTP logging is not enabled by default.</span></span> <span data-ttu-id="33ba0-106">若要启用 HTTP 日志记录，请修改**ReportingServicesService.exe.config**配置文件以在安装中使用此功能。</span><span class="sxs-lookup"><span data-stu-id="33ba0-106">To enable the HTTP logging, modify the **ReportingServicesService.exe.config** configuration file to use this feature in your installation.</span></span>  
  
## <a name="viewing-log-information"></a><span data-ttu-id="33ba0-107">查看日志信息</span><span class="sxs-lookup"><span data-stu-id="33ba0-107">Viewing Log Information</span></span>  
 <span data-ttu-id="33ba0-108">该日志为 ASCII 文本文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-108">The log is an ASCII text file.</span></span> <span data-ttu-id="33ba0-109">可以使用任何文本编辑器查看该文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-109">You can use any text editor to view the file.</span></span> <span data-ttu-id="33ba0-110">报表服务器 HTTP 日志文件等同于 IIS 中的 W3C 扩展日志文件，并且使用与其类似的字段，因此可以使用现有的 IIS 日志文件查看器来读取报表服务器 HTTP 日志文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-110">The Report Server HTTP log file is equivalent to the W3C extended log file in IIS and uses similar fields so that you can use existing IIS log file viewers to read the report server HTTP log file.</span></span> <span data-ttu-id="33ba0-111">下表提供有关 HTTP 日志文件的其他信息：</span><span class="sxs-lookup"><span data-stu-id="33ba0-111">The following table provides additional information about the HTTP log file:</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="33ba0-112">**文件名**</span><span class="sxs-lookup"><span data-stu-id="33ba0-112">**File name**</span></span>|<span data-ttu-id="33ba0-113">默认情况下，日志文件名是</span><span class="sxs-lookup"><span data-stu-id="33ba0-113">By default, the log file name(s) are</span></span><br /><br /> `ReportServerService_HTTP_<timestamp>.log.`<br /><br /> <span data-ttu-id="33ba0-114">您可以通过在 ReportingServicesService.exe.config 文件中修改 HttpTraceFileName 属性来自定义文件名的前缀。</span><span class="sxs-lookup"><span data-stu-id="33ba0-114">You can customize the prefix of the file name by modifying the HttpTraceFileName attribute in the ReportingServicesService.exe.config file.</span></span> <span data-ttu-id="33ba0-115">时间戳基于协调世界时 (UTC)。</span><span class="sxs-lookup"><span data-stu-id="33ba0-115">The timestamp is based on Coordinated Universal Time (UTC).</span></span>|  
|<span data-ttu-id="33ba0-116">**文件位置**</span><span class="sxs-lookup"><span data-stu-id="33ba0-116">**File location**</span></span>|<span data-ttu-id="33ba0-117">文件被写入以下位置：</span><span class="sxs-lookup"><span data-stu-id="33ba0-117">The files are written to the following location:</span></span><br /><br /> `\Microsoft SQL Server\<SQL Server Instance>\Reporting Services\LogFiles`|  
|<span data-ttu-id="33ba0-118">**文件格式**</span><span class="sxs-lookup"><span data-stu-id="33ba0-118">**File format**</span></span>|<span data-ttu-id="33ba0-119">该文件是 EN-US 格式。</span><span class="sxs-lookup"><span data-stu-id="33ba0-119">The file is in EN-US format.</span></span> <span data-ttu-id="33ba0-120">它是 ASCII 文本文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-120">It is an ASCII text file.</span></span>|  
|<span data-ttu-id="33ba0-121">**创建和保留文件**</span><span class="sxs-lookup"><span data-stu-id="33ba0-121">**File creation and retention**</span></span>|<span data-ttu-id="33ba0-122">当您在配置文件中启用了日志、重新启动服务以及报表服务器处理 HTTP 请求时，会创建 HTTP 日志。</span><span class="sxs-lookup"><span data-stu-id="33ba0-122">The HTTP log is created after you enable it in the configuration file, restart the service, and the report server handles an HTTP request.</span></span> <span data-ttu-id="33ba0-123">如果您配置了相应的设置但并未看到日志文件，请打开报表或启动报表服务器应用程序（如报表管理器）以生成 HTTP 请求从而创建日志文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-123">If you configure the settings but do not see the log file, open a report or start a report server application (such as Report Manager) to generate an HTTP request to create the file.</span></span><br /><br /> <span data-ttu-id="33ba0-124">在各服务重新启动并且随后发生对报表服务器的 HTTP 请求时，会创建日志文件的新实例。</span><span class="sxs-lookup"><span data-stu-id="33ba0-124">A new instance of the log file will be created after each service restart and subsequent HTTP request to the report server.</span></span><br /><br /> <span data-ttu-id="33ba0-125">默认情况下，跟踪日志大小限制为 32 MB，并在 14 天后删除。</span><span class="sxs-lookup"><span data-stu-id="33ba0-125">By default, trace logs are limited to 32 megabytes and deleted after 14 days.</span></span>|  
  
## <a name="configuration-settings-for-report-server-http-log"></a><span data-ttu-id="33ba0-126">报表服务器 HTTP 日志的配置设置</span><span class="sxs-lookup"><span data-stu-id="33ba0-126">Configuration Settings for Report Server HTTP Log</span></span>  
 <span data-ttu-id="33ba0-127">若要配置报表服务器 HTTP 日志，请使用记事本修改**ReportingServicesService.exe.config**文件。</span><span class="sxs-lookup"><span data-stu-id="33ba0-127">To configure the Report Server HTTP log, use Notepad to modify the **ReportingServicesService.exe.config** file.</span></span> <span data-ttu-id="33ba0-128">此配置文件位于 \Program Files\Microsoft SQL Server\MSSQL.n\Reporting Services\ReportServer\Bin 文件夹。</span><span class="sxs-lookup"><span data-stu-id="33ba0-128">The configuration file is located in the \Program Files\Microsoft SQL Server\MSSQL.n\Reporting Services\ReportServer\Bin folder.</span></span>  
  
 <span data-ttu-id="33ba0-129">若要启用 HTTP 服务器，请将 `http:4` 添加到 ReportingServicesService.exe.config 文件的 RStrace 部分。</span><span class="sxs-lookup"><span data-stu-id="33ba0-129">To enable the HTTP server, add `http:4` to the RStrace section of the ReportingServicesService.exe.config file.</span></span> <span data-ttu-id="33ba0-130">所有其他 HTTP 日志文件项都是可选的。</span><span class="sxs-lookup"><span data-stu-id="33ba0-130">All other HTTP log file entries are optional.</span></span> <span data-ttu-id="33ba0-131">下面的示例包括所有设置，因此您可以将整个内容都粘贴到 RStrace 部分，然后删除您不需要的设置。</span><span class="sxs-lookup"><span data-stu-id="33ba0-131">The following example includes all settings so that you can paste the whole section over the RStrace section, and then delete the settings you do not need.</span></span>  
  
```  
   <RStrace>  
         <add name="FileName" value="ReportServerService_" />  
         <add name="FileSizeLimitMb" value="32" />  
         <add name="KeepFilesForDays" value="14" />  
         <add name="Prefix" value="tid, time" />  
         <add name="TraceListeners" value="debugwindow, file" />  
         <add name="TraceFileMode" value="unique" />  
         <add name="HttpTraceFileName" value="ReportServerService_HTTP_" />  
         <add name="HttpTraceSwitches" value="date,time, clientip,username,serverip,serverport,host,method,uristem,uriquery,protocolstatus,bytesreceived,timetaken,protocolversion,useragent,cookiereceived,cookiesent,referrer" />  
         <add name="Components" value="all:3,http:4" />  
   </RStrace>  
```  
  
## <a name="log-file-fields"></a><span data-ttu-id="33ba0-132">日志文件字段</span><span class="sxs-lookup"><span data-stu-id="33ba0-132">Log File Fields</span></span>  
 <span data-ttu-id="33ba0-133">下表对在日志中可用的字段进行了说明：</span><span class="sxs-lookup"><span data-stu-id="33ba0-133">The following table describes the fields that are available in the log.</span></span> <span data-ttu-id="33ba0-134">该字段列表是可配置的；您可以通过 `HTTPTraceSwitches` 配置设置来指定要包括哪些字段。</span><span class="sxs-lookup"><span data-stu-id="33ba0-134">The field list is configurable; you can specify which fields to include through the `HTTPTraceSwitches` configuration setting.</span></span> <span data-ttu-id="33ba0-135">如果未指定，则**默认**列指定是否将自动包含在日志文件中的字段 `HTTPTraceSwitches` 。</span><span class="sxs-lookup"><span data-stu-id="33ba0-135">The **Default** column specifies whether the field will be included in the log file automatically if you do not specify `HTTPTraceSwitches`.</span></span>  
  
|<span data-ttu-id="33ba0-136">字段</span><span class="sxs-lookup"><span data-stu-id="33ba0-136">Field</span></span>|<span data-ttu-id="33ba0-137">说明</span><span class="sxs-lookup"><span data-stu-id="33ba0-137">Description</span></span>|<span data-ttu-id="33ba0-138">默认</span><span class="sxs-lookup"><span data-stu-id="33ba0-138">Default</span></span>|  
|-----------|-----------------|-------------|  
|<span data-ttu-id="33ba0-139">HttpTraceFileName</span><span class="sxs-lookup"><span data-stu-id="33ba0-139">HttpTraceFileName</span></span>|<span data-ttu-id="33ba0-140">此值是可选的。</span><span class="sxs-lookup"><span data-stu-id="33ba0-140">This value is optional.</span></span> <span data-ttu-id="33ba0-141">默认值为 ReportServerServiceHTTP_。</span><span class="sxs-lookup"><span data-stu-id="33ba0-141">The default value is ReportServerServiceHTTP_.</span></span> <span data-ttu-id="33ba0-142">如果您想要使用其他文件命名约定（例如，在将日志文件保存到中央位置时要包括服务器名），则可指定不同的值。</span><span class="sxs-lookup"><span data-stu-id="33ba0-142">You can specify a different value if want to use a different file naming convention (for example, to include the server name if you are saving log files to a central location).</span></span>|<span data-ttu-id="33ba0-143">是</span><span class="sxs-lookup"><span data-stu-id="33ba0-143">Yes</span></span>|  
|<span data-ttu-id="33ba0-144">HTTPTraceSwitches</span><span class="sxs-lookup"><span data-stu-id="33ba0-144">HttpTraceSwitches</span></span>|<span data-ttu-id="33ba0-145">此值是可选的。</span><span class="sxs-lookup"><span data-stu-id="33ba0-145">This value is optional.</span></span> <span data-ttu-id="33ba0-146">如果指定该字段，则可以逗号分隔的格式配置要在日志文件中使用的字段。</span><span class="sxs-lookup"><span data-stu-id="33ba0-146">If you specify it, you can configure the fields used in the log file in comma-delimited format.</span></span>|<span data-ttu-id="33ba0-147">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-147">No</span></span>|  
|<span data-ttu-id="33ba0-148">Date</span><span class="sxs-lookup"><span data-stu-id="33ba0-148">Date</span></span>|<span data-ttu-id="33ba0-149">活动发生的日期。</span><span class="sxs-lookup"><span data-stu-id="33ba0-149">The date when the activity occurred.</span></span>|<span data-ttu-id="33ba0-150">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-150">No</span></span>|  
|<span data-ttu-id="33ba0-151">时间</span><span class="sxs-lookup"><span data-stu-id="33ba0-151">Time</span></span>|<span data-ttu-id="33ba0-152">活动发生的时间。</span><span class="sxs-lookup"><span data-stu-id="33ba0-152">The time when the activity occurred.</span></span>|<span data-ttu-id="33ba0-153">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-153">No</span></span>|  
|<span data-ttu-id="33ba0-154">ClientIp</span><span class="sxs-lookup"><span data-stu-id="33ba0-154">ClientIp</span></span>|<span data-ttu-id="33ba0-155">访问报表服务器的客户端的 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="33ba0-155">The IP address of the client accessing the report server.</span></span>|<span data-ttu-id="33ba0-156">是</span><span class="sxs-lookup"><span data-stu-id="33ba0-156">Yes</span></span>|  
|<span data-ttu-id="33ba0-157">UserName</span><span class="sxs-lookup"><span data-stu-id="33ba0-157">UserName</span></span>|<span data-ttu-id="33ba0-158">访问报表服务器的用户的名称。</span><span class="sxs-lookup"><span data-stu-id="33ba0-158">The name of the user who accessed the report server.</span></span>|<span data-ttu-id="33ba0-159">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-159">No</span></span>|  
|<span data-ttu-id="33ba0-160">ServerPort</span><span class="sxs-lookup"><span data-stu-id="33ba0-160">ServerPort</span></span>|<span data-ttu-id="33ba0-161">连接使用的端口号。</span><span class="sxs-lookup"><span data-stu-id="33ba0-161">The port number used for the connection.</span></span>|<span data-ttu-id="33ba0-162">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-162">No</span></span>|  
|<span data-ttu-id="33ba0-163">主机</span><span class="sxs-lookup"><span data-stu-id="33ba0-163">Host</span></span>|<span data-ttu-id="33ba0-164">主机标头的内容。</span><span class="sxs-lookup"><span data-stu-id="33ba0-164">The content of the host header.</span></span>|<span data-ttu-id="33ba0-165">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-165">No</span></span>|  
|<span data-ttu-id="33ba0-166">方法</span><span class="sxs-lookup"><span data-stu-id="33ba0-166">Method</span></span>|<span data-ttu-id="33ba0-167">从客户端调用的操作或 SOAP 方法。</span><span class="sxs-lookup"><span data-stu-id="33ba0-167">The action or SOAP method called from the client.</span></span>|<span data-ttu-id="33ba0-168">是</span><span class="sxs-lookup"><span data-stu-id="33ba0-168">Yes</span></span>|  
|<span data-ttu-id="33ba0-169">UriStem</span><span class="sxs-lookup"><span data-stu-id="33ba0-169">UriStem</span></span>|<span data-ttu-id="33ba0-170">访问的资源。</span><span class="sxs-lookup"><span data-stu-id="33ba0-170">The resource accessed.</span></span>|<span data-ttu-id="33ba0-171">是</span><span class="sxs-lookup"><span data-stu-id="33ba0-171">Yes</span></span>|  
|<span data-ttu-id="33ba0-172">UriQuery</span><span class="sxs-lookup"><span data-stu-id="33ba0-172">UriQuery</span></span>|<span data-ttu-id="33ba0-173">用于访问资源的查询。</span><span class="sxs-lookup"><span data-stu-id="33ba0-173">The query used to access the resource.</span></span>|<span data-ttu-id="33ba0-174">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-174">No</span></span>|  
|<span data-ttu-id="33ba0-175">ProtocolStatus</span><span class="sxs-lookup"><span data-stu-id="33ba0-175">ProtocolStatus</span></span>|<span data-ttu-id="33ba0-176">HTTP 状态代码。</span><span class="sxs-lookup"><span data-stu-id="33ba0-176">The HTTP status code.</span></span>|<span data-ttu-id="33ba0-177">是</span><span class="sxs-lookup"><span data-stu-id="33ba0-177">Yes</span></span>|  
|<span data-ttu-id="33ba0-178">BytesReceived</span><span class="sxs-lookup"><span data-stu-id="33ba0-178">BytesReceived</span></span>|<span data-ttu-id="33ba0-179">服务器接收的字节数。</span><span class="sxs-lookup"><span data-stu-id="33ba0-179">The number of bytes received by the server.</span></span>|<span data-ttu-id="33ba0-180">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-180">No</span></span>|  
|<span data-ttu-id="33ba0-181">TimeTaken</span><span class="sxs-lookup"><span data-stu-id="33ba0-181">TimeTaken</span></span>|<span data-ttu-id="33ba0-182">从即时 HTTP.SYS 返回请求数据到服务器完成最后一次发送所用的时间（以毫秒计），不包括网络传输时间。</span><span class="sxs-lookup"><span data-stu-id="33ba0-182">The time (in milliseconds) from the instant HTTP.SYS returns request data until the server finishes the last send, excluding network transmission time.</span></span>|<span data-ttu-id="33ba0-183">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-183">No</span></span>|  
|<span data-ttu-id="33ba0-184">ProtocolVersion</span><span class="sxs-lookup"><span data-stu-id="33ba0-184">ProtocolVersion</span></span>|<span data-ttu-id="33ba0-185">客户端使用的协议版本。</span><span class="sxs-lookup"><span data-stu-id="33ba0-185">The protocol version used by the client.</span></span>|<span data-ttu-id="33ba0-186">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-186">No</span></span>|  
|<span data-ttu-id="33ba0-187">UserAgent</span><span class="sxs-lookup"><span data-stu-id="33ba0-187">UserAgent</span></span>|<span data-ttu-id="33ba0-188">客户端使用的浏览器类型。</span><span class="sxs-lookup"><span data-stu-id="33ba0-188">The browser type used by the client.</span></span>|<span data-ttu-id="33ba0-189">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-189">No</span></span>|  
|<span data-ttu-id="33ba0-190">CookieReceived</span><span class="sxs-lookup"><span data-stu-id="33ba0-190">CookieReceived</span></span>|<span data-ttu-id="33ba0-191">服务器接收的 cookie 的内容。</span><span class="sxs-lookup"><span data-stu-id="33ba0-191">The content of the cookie received by the server.</span></span>|<span data-ttu-id="33ba0-192">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-192">No</span></span>|  
|<span data-ttu-id="33ba0-193">CookieSent</span><span class="sxs-lookup"><span data-stu-id="33ba0-193">CookieSent</span></span>|<span data-ttu-id="33ba0-194">服务器发送的 cookie 的内容。</span><span class="sxs-lookup"><span data-stu-id="33ba0-194">The content of the cookie sent by the server.</span></span>|<span data-ttu-id="33ba0-195">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-195">No</span></span>|  
|<span data-ttu-id="33ba0-196">Referrer</span><span class="sxs-lookup"><span data-stu-id="33ba0-196">Referrer</span></span>|<span data-ttu-id="33ba0-197">客户端以前访问过的站点。</span><span class="sxs-lookup"><span data-stu-id="33ba0-197">The previous site visited by the client.</span></span>|<span data-ttu-id="33ba0-198">否</span><span class="sxs-lookup"><span data-stu-id="33ba0-198">No</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="33ba0-199">另请参阅</span><span class="sxs-lookup"><span data-stu-id="33ba0-199">See Also</span></span>  
 <span data-ttu-id="33ba0-200">[报表服务器服务跟踪日志](report-server-service-trace-log.md) </span><span class="sxs-lookup"><span data-stu-id="33ba0-200">[Report Server Service Trace Log](report-server-service-trace-log.md) </span></span>  
 <span data-ttu-id="33ba0-201">[Reporting Services 日志文件和来源](../report-server/reporting-services-log-files-and-sources.md) </span><span class="sxs-lookup"><span data-stu-id="33ba0-201">[Reporting Services Log Files and Sources](../report-server/reporting-services-log-files-and-sources.md) </span></span>  
 [<span data-ttu-id="33ba0-202">错误和事件参考 (Reporting Services)</span><span class="sxs-lookup"><span data-stu-id="33ba0-202">Errors and Events Reference &#40;Reporting Services&#41;</span></span>](../troubleshooting/errors-and-events-reference-reporting-services.md)  
  
  
