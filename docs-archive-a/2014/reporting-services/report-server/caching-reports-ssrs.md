---
title: 缓存报表 (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- report execution properties [Reporting Services]
- cache [Reporting Services]
- report processing [Reporting Services], caching
- cached instances [Reporting Services]
- refreshing cache
- cached reports [Reporting Services]
- preloading cache
- invalid cached reports [Reporting Services]
- performance [Reporting Services]
- expiration [Reporting Services]
- snapshots [Reporting Services], caching
ms.assetid: 146542c3-8efd-4b89-a8d8-77d22896630e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: e1af19dd3848ba39f91c2fc640a57ca53c35a4fb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87588311"
---
# <a name="caching-reports-ssrs"></a><span data-ttu-id="7c6ab-102">缓存报表 (SSRS)</span><span class="sxs-lookup"><span data-stu-id="7c6ab-102">Caching Reports (SSRS)</span></span>
  <span data-ttu-id="7c6ab-103">报表服务器可以缓存已处理报表的副本，并在用户打开此报表时返回该副本。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-103">A report server can cache a copy of a processed report and return that copy when a user opens the report.</span></span> <span data-ttu-id="7c6ab-104">对用户而言，可指示报表为缓存副本的唯一证据是报表的运行日期和时间。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-104">To a user, the only evidence available to indicate the report is a cached copy is the date and time that the report ran.</span></span> <span data-ttu-id="7c6ab-105">如果日期或时间不是当前的日期或时间，并且报表不是快照，则说明该报表是从缓存中检索的。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-105">If the date or time is not current and the report is not a snapshot, the report was retrieved from cache.</span></span>  
  
 <span data-ttu-id="7c6ab-106">在报表很大或需要频繁访问的情况下，缓存报表可以缩短检索该报表所需的时间。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-106">Caching can shorten the time required to retrieve a report if the report is large or accessed frequently.</span></span> <span data-ttu-id="7c6ab-107">如果重新启动服务器，则当报表服务器 Web 服务重新联机时，会恢复所有缓存的实例。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-107">If the server is rebooted, all cached instances are reinstated when the Report Server Web service comes back online.</span></span>  
  
 <span data-ttu-id="7c6ab-108">缓存是一种性能增强技术。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-108">Caching is a performance-enhancement technique.</span></span> <span data-ttu-id="7c6ab-109">缓存的内容是非永久性的，会随着报表的添加、替换或删除而发生更改。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-109">The contents of the cache are volatile and can change as reports are added, replaced, or removed.</span></span> <span data-ttu-id="7c6ab-110">如果需要可预测性更高的缓存策略，则应创建报表快照。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-110">If you require a more predictable caching strategy, you should create a report snapshot.</span></span> <span data-ttu-id="7c6ab-111">有关详细信息，请参阅 [设置报表处理属性](set-report-processing-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-111">For more information, see [Set Report Processing Properties](set-report-processing-properties.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="7c6ab-112">可以在数据库中存储临时文件以支持用户会话和报表处理。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-112">stores temporary files in a database to support user sessions and report processing.</span></span> <span data-ttu-id="7c6ab-113">缓存这些文件是为了供内部使用，以便在单一浏览器会话内保持一致的查看体验。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-113">These files are cached for internal use and to support a consistent viewing experience during a single browser session.</span></span> <span data-ttu-id="7c6ab-114">有关如何缓存内部使用的临时文件的详细信息，请参阅[报表服务器数据库（SSRS 本机模式）](report-server-database-ssrs-native-mode.md)。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-114">For more information about how internal-use temporary files are cached, see [Report Server Database &#40;SSRS Native Mode&#41;](report-server-database-ssrs-native-mode.md).</span></span>  
  
## <a name="cached-instances"></a><span data-ttu-id="7c6ab-115">缓存实例</span><span class="sxs-lookup"><span data-stu-id="7c6ab-115">Cached Instances</span></span>  
 <span data-ttu-id="7c6ab-116">报表的缓存实例基于报表的中间格式。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-116">A cached instance of a report is based on the intermediate format of a report.</span></span> <span data-ttu-id="7c6ab-117">报表服务器通常根据报表名称来缓存报表的单个实例。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-117">The report server generally caches one instance of a report based on the report name.</span></span> <span data-ttu-id="7c6ab-118">但是，如果报表可以基于查询参数包含不同数据，则可以在任何给定的时间缓存该报表的多个版本。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-118">However, if a report can contain different data based on query parameters, multiple versions of the report may be cached at any given time.</span></span> <span data-ttu-id="7c6ab-119">例如，假设有一个参数化报表以区域代码作为参数值。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-119">For example, suppose you have a parameterized report that takes a region code as a parameter value.</span></span> <span data-ttu-id="7c6ab-120">如果四个不同用户指定了四个唯一的区域代码，则将创建四个缓存副本。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-120">If four different users specify four unique region codes, four cached copies are created.</span></span>  
  
 <span data-ttu-id="7c6ab-121">用某个唯一区域代码运行报表的第一个用户将创建一个包含该区域的数据的缓存报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-121">The first user who runs the report with a unique region code creates a cached report that contains data for that region.</span></span> <span data-ttu-id="7c6ab-122">使用同一区域代码请求报表的后续用户将获取缓存副本。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-122">Subsequent users who request the report using the same region code get the cached copy.</span></span>  
  
 <span data-ttu-id="7c6ab-123">并非所有报表都可以缓存。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-123">Not all reports can be cached.</span></span> <span data-ttu-id="7c6ab-124">如果报表包括用户相关数据，提示用户输入凭据或使用 Windows 身份验证，则不能缓存该报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-124">If a report includes user-dependent data, prompts users for credentials, or uses Windows Authentication, it cannot be cached.</span></span>  
  
## <a name="refreshing-the-cache"></a><span data-ttu-id="7c6ab-125">刷新缓存</span><span class="sxs-lookup"><span data-stu-id="7c6ab-125">Refreshing the Cache</span></span>  
 <span data-ttu-id="7c6ab-126">如果用户在以前缓存的副本过期后选择该报表，则将使用更新的版本替换缓存报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-126">A cached report is replaced with a newer version when a user selects the report after the previously cached copy has expired.</span></span> <span data-ttu-id="7c6ab-127">配置为作为缓存实例运行的报表将根据过期设置按固定间隔从缓存中删除。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-127">Reports that are configured to run as cached instances are removed from the cache at regular intervals based on expiration settings.</span></span> <span data-ttu-id="7c6ab-128">可以根据数据的即时性要求，以分钟为单位或按计划时间设置报表的过期时间。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-128">You can set a report's expiration in minutes or at a scheduled time, as determined by the data's immediacy requirement.</span></span> <span data-ttu-id="7c6ab-129">除非使用 SOAP API，否则，不能直接从缓存中删除报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-129">You cannot delete reports from the cache directly unless you use the SOAP API.</span></span>  
  
 <span data-ttu-id="7c6ab-130">若要配置缓存过期时间，可以使用共享计划或报表特定计划。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-130">To configure cache expiration, you can use a shared schedule or report-specific schedule.</span></span> <span data-ttu-id="7c6ab-131">如果使用共享计划，但随后又暂停了该计划，那么在计划暂停期间缓存不会过期。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-131">If you use a shared schedule and it is subsequently paused, the cache does not expire while the schedule is inoperative.</span></span> <span data-ttu-id="7c6ab-132">如果后来删除了共享计划，该计划设置的副本将另存为报表特定计划。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-132">If the shared schedule is subsequently deleted, a copy of the schedule settings is saved as a report-specific schedule.</span></span>  
  
 <span data-ttu-id="7c6ab-133">如果计划过期，或者如果计划引擎在缓存过期的那一日不可用，则报表服务器在计划的操作恢复（通过延长计划或启动计划服务）之前将运行实时报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-133">If a schedule expires or if the scheduling engine is unavailable at a cache expiration date, the report server runs a live report until scheduled operations can be resumed (by either extending the schedule or starting the scheduling service).</span></span>  
  
## <a name="preloading-the-cache"></a><span data-ttu-id="7c6ab-134">预加载缓存</span><span class="sxs-lookup"><span data-stu-id="7c6ab-134">Preloading the Cache</span></span>  
 <span data-ttu-id="7c6ab-135">为了提高服务器性能，可以预加载缓存。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-135">To improve server performance, you can preload the cache.</span></span> <span data-ttu-id="7c6ab-136">可以通过两种方式使用一组参数化报表实例预加载缓存：</span><span class="sxs-lookup"><span data-stu-id="7c6ab-136">You can preload the cache with a collection of parameterized report instances in two ways:</span></span>  
  
1.  <span data-ttu-id="7c6ab-137">创建缓存刷新计划。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-137">Create a cache refresh plan.</span></span> <span data-ttu-id="7c6ab-138">当您创建刷新计划时，可以为单个报表指定计划或指定共享计划。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-138">When you create a refresh plan, you can specify a schedule for a single report or specify a shared schedule.</span></span>  
  
2.  <span data-ttu-id="7c6ab-139">创建使用 Null 传递提供程序的数据驱动订阅。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-139">Create a data-driven subscription that uses the Null Delivery Provider.</span></span> <span data-ttu-id="7c6ab-140">当将 Null 传递提供程序指定为订阅中的传递方法时，报表服务器会将报表服务器数据库当作传递目标，并使用称为空呈现扩展插件的专用呈现扩展插件。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-140">When you specify the Null Delivery Provider as the method of delivery in the subscription, the report server targets the report server database as the delivery destination and uses a specialized rendering extension called the null rendering extension.</span></span> <span data-ttu-id="7c6ab-141">与其他传递扩展插件相比，Null 传递提供程序没有可通过订阅定义配置的传递设置。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-141">In contrast with other delivery extensions, the Null Delivery Provider does not have delivery settings that you can configure through a subscription definition.</span></span>  
  
 <span data-ttu-id="7c6ab-142">对于使用不同参数值生成不同报表实例的参数化报表，若要缓存该报表的多个实例，则更改报表将非常有用。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-142">Caching a report is especially useful if you want to cache multiple instances of a parameterized report where different parameter values are used to produce different report instances.</span></span> <span data-ttu-id="7c6ab-143">注意，只能对报表指定基于查询的参数。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-143">Note that you can only specify query-based parameters on the report.</span></span>  
  
 <span data-ttu-id="7c6ab-144">当您指定计划或当您创建数据驱动订阅时，应安排向缓存传递报表的频率。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-144">When you specify a schedule or when you create the data-driven subscription, you schedule how often the reports are delivered to the cache.</span></span> <span data-ttu-id="7c6ab-145">为了将新副本传递到缓存，旧副本必须已过期。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-145">In order for new copies to be delivered to the cache, the old copies must have expired.</span></span> <span data-ttu-id="7c6ab-146">因此，必须对报表的执行属性进行配置以包括缓存过期设置。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-146">Therefore, the Execution properties of the report must be configured to include cache expiration settings.</span></span> <span data-ttu-id="7c6ab-147">过期设置必须与定义的订阅计划一致。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-147">The expiration setting must be consistent with the subscription schedule that you define.</span></span> <span data-ttu-id="7c6ab-148">例如，如果创建一个每天晚上运行的订阅，则每天晚上在该订阅运行之前，缓存也应过期。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-148">For example, if you create a subscription that runs every night, the cache should also expire every night prior to the subscription's run time.</span></span> <span data-ttu-id="7c6ab-149">如果执行属性不包括过期时间，则将忽略后续的传递。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-149">If the Execution properties do not include expiration times, newer deliveries are disregarded.</span></span> <span data-ttu-id="7c6ab-150">有关缓存刷新计划的详细信息，请参阅 [计划](../subscriptions/schedules.md)。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-150">For more information about cache refresh plans, see [Schedules](../subscriptions/schedules.md).</span></span> <span data-ttu-id="7c6ab-151">有关设置属性的详细信息，请参阅 [设置报表处理属性](set-report-processing-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-151">For more information about setting properties, see [Set Report Processing Properties](set-report-processing-properties.md).</span></span> <span data-ttu-id="7c6ab-152">有关使用数据驱动订阅的详细信息，请参阅 [数据驱动订阅](../subscriptions/data-driven-subscriptions.md)。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-152">For more information about using data-driven subscriptions, see [Data-Driven Subscriptions](../subscriptions/data-driven-subscriptions.md).</span></span>  
  
## <a name="conditions-that-cause-cache-expiration"></a><span data-ttu-id="7c6ab-153">导致缓存过期的条件</span><span class="sxs-lookup"><span data-stu-id="7c6ab-153">Conditions That Cause Cache Expiration</span></span>  
 <span data-ttu-id="7c6ab-154">响应下列事件时会导致缓存报表失效：修改报表定义，修改报表参数，更改数据源凭据或者更改报表执行选项。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-154">A cached report is invalidated in response to the following events: the report definition is modified, report parameters are modified, data source credentials change, or report execution options change.</span></span> <span data-ttu-id="7c6ab-155">如果删除缓存中存储的报表，则也将删除该报表的缓存版本。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-155">If you delete a report that is stored in the cache, the cached version is also deleted.</span></span>  
  
 <span data-ttu-id="7c6ab-156">如果出于任何原因（例如，如果用户指定的参数值与生成缓存报表所用的参数值不同）无法从缓存实例呈现报表，则报表服务器将重新运行该报表。</span><span class="sxs-lookup"><span data-stu-id="7c6ab-156">If a report cannot be rendered from a cached instance for any reason (for example, if the parameter values that a user specifies are different from those used to produce the cached report), the report server reruns the report.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c6ab-157">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7c6ab-157">See Also</span></span>  
 <span data-ttu-id="7c6ab-158">[设置处理选项（SharePoint 集成模式下的 Reporting Services）](../set-processing-options-reporting-services-in-sharepoint-integrated-mode.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-158">[Set Processing Options &#40;Reporting Services in SharePoint Integrated Mode&#41;](../set-processing-options-reporting-services-in-sharepoint-integrated-mode.md) </span></span>  
 <span data-ttu-id="7c6ab-159">[设置报表处理属性](set-report-processing-properties.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-159">[Set Report Processing Properties](set-report-processing-properties.md) </span></span>  
 <span data-ttu-id="7c6ab-160">[Reporting Services 概念 (SSRS)](../reporting-services-concepts-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-160">[Reporting Services Concepts &#40;SSRS&#41;](../reporting-services-concepts-ssrs.md) </span></span>  
 <span data-ttu-id="7c6ab-161">[报表管理器预加载缓存 &#40;&#41;](preload-the-cache-report-manager.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-161">[Preload the Cache &#40;Report Manager&#41;](preload-the-cache-report-manager.md) </span></span>  
 <span data-ttu-id="7c6ab-162">[“计划”](../subscriptions/schedules.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-162">[Schedules](../subscriptions/schedules.md) </span></span>  
 <span data-ttu-id="7c6ab-163">[&#40;SSRS&#41;缓存共享数据集](cache-shared-datasets-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="7c6ab-163">[Cache Shared Datasets &#40;SSRS&#41;](cache-shared-datasets-ssrs.md) </span></span>  
 [<span data-ttu-id="7c6ab-164">缓存刷新选项（报表管理器）</span><span class="sxs-lookup"><span data-stu-id="7c6ab-164">Cache Refresh Options &#40;Report Manager&#41;</span></span>](../cache-refresh-options-report-manager.md)  
  
  
