---
title: 报表和快照的大小限制 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- large reports
- maximum report size
- size [SQL Server], reports
- report size [Reporting Services]
- reports [Reporting Services], size
- denial of service attacks [Reporting Services]
ms.assetid: 1e3be259-d453-4802-b2f5-6b81ef607edf
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: a009f725d83d00e5015817a03d43b7c98ab7afbc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87591128"
---
# <a name="report-and-snapshot-size-limits"></a><span data-ttu-id="d215f-102">报表和快照的大小限制</span><span class="sxs-lookup"><span data-stu-id="d215f-102">Report and Snapshot Size Limits</span></span>
  <span data-ttu-id="d215f-103">管理 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 部署的管理员可以通过本主题提供的信息了解在将报表发布到报表服务器、运行时呈现报表以及将报表保存到文件系统时报表的大小限制。</span><span class="sxs-lookup"><span data-stu-id="d215f-103">Administrators who manage a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] deployment can use the information in this topic to understand report size limits when the report is published to a report server, rendered at run time, and saved to the file system.</span></span> <span data-ttu-id="d215f-104">本主题还提供了有关如何度量报表服务器数据库大小的实践指南，并介绍了快照大小对服务器性能的影响。</span><span class="sxs-lookup"><span data-stu-id="d215f-104">This topic also provides practical guidance on how to measure the size of a report server database, and describes the effect of snapshot size on server performance.</span></span>  
  
## <a name="maximum-size-for-published-reports-and-models"></a><span data-ttu-id="d215f-105">已发布报表和模型的最大大小</span><span class="sxs-lookup"><span data-stu-id="d215f-105">Maximum Size for Published Reports and Models</span></span>  
 <span data-ttu-id="d215f-106">在报表服务器上，报表和模型的大小基于发布到报表服务器的报表定义 (.rdl) 和报表模型 (.smdl) 文件的大小。</span><span class="sxs-lookup"><span data-stu-id="d215f-106">On the report server, report and model size is based on the size of the report definition (.rdl) and report model (.smdl) files that you publish to a report server.</span></span> <span data-ttu-id="d215f-107">报表服务器不限制发布的报表或模型的大小。</span><span class="sxs-lookup"><span data-stu-id="d215f-107">The report server does not limit the size of a report or model that you publish.</span></span> <span data-ttu-id="d215f-108">不过，[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] 规定了发布到服务器的项的大小上限。</span><span class="sxs-lookup"><span data-stu-id="d215f-108">However, [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] imposes a maximum size for items that are posted to the server.</span></span> <span data-ttu-id="d215f-109">默认情况下，大小限制为 4 MB。</span><span class="sxs-lookup"><span data-stu-id="d215f-109">By default, this limit is 4 megabytes (MB).</span></span> <span data-ttu-id="d215f-110">如果将超出此限制的文件上载或发布到报表服务器，就会收到 HTTP 异常。</span><span class="sxs-lookup"><span data-stu-id="d215f-110">If you upload or publish a file that exceeds this limit to a report server, you receive an HTTP exception.</span></span> <span data-ttu-id="d215f-111">在这种情况下，可以通过增大 Machine.config 文件中 `maxRequestLength` 元素的值来修改该默认值。</span><span class="sxs-lookup"><span data-stu-id="d215f-111">In this case, you can modify the default by increasing the value of the `maxRequestLength` element in the Machine.config file.</span></span>  
  
 <span data-ttu-id="d215f-112">尽管报表模型可能很大，但报表定义很少超过 4 MB。</span><span class="sxs-lookup"><span data-stu-id="d215f-112">Although a report model might be very large, report definitions rarely exceed 4 MB.</span></span> <span data-ttu-id="d215f-113">比较常见的报表大小以千字节 (KB) 为单位。</span><span class="sxs-lookup"><span data-stu-id="d215f-113">A more typical report size is in the order of kilobytes (KB).</span></span> <span data-ttu-id="d215f-114">但是，如果包括嵌入的图像，则这些图像的编码可能会造成报表定义过大（超过 4 MB 的默认值）。</span><span class="sxs-lookup"><span data-stu-id="d215f-114">However, if you include embedded images, the encoding of those images can result in large report definitions that exceed the 4 MB default.</span></span>  
  
 [!INCLUDE[vstecasp](../../includes/vstecasp-md.md)] <span data-ttu-id="d215f-115">对发布的文件实施最大限制，以减小拒绝服务攻击对服务器的威胁。</span><span class="sxs-lookup"><span data-stu-id="d215f-115">imposes a maximum limit on posted files to reduce the threat of denial-of-service attacks against the server.</span></span> <span data-ttu-id="d215f-116">增大上限的值会破坏此限制所提供的某些保护。</span><span class="sxs-lookup"><span data-stu-id="d215f-116">Increasing the value of the upper limit undermines some of the protection that this limit provides.</span></span> <span data-ttu-id="d215f-117">请在确信增大该值所获得的好处大于任何其他安全隐患时才这样做。</span><span class="sxs-lookup"><span data-stu-id="d215f-117">Increase the value only if you are confident that the benefit of doing so outweighs any additional security risk.</span></span>  
  
 <span data-ttu-id="d215f-118">请记住，为 `maxRequestLength` 元素设置的值必须大于要强制实施的实际大小限制。</span><span class="sxs-lookup"><span data-stu-id="d215f-118">Keep in mind that the value you set for the `maxRequestLength` element must be larger than the actual size limits you want to enforce.</span></span> <span data-ttu-id="d215f-119">当在 SOAP 信封中封装所有参数，以及对某些参数（如 <xref:ReportService2010.ReportingService2010.CreateReportEditSession%2A> 和 <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> 方法中的 Definition 参数）应用 Base64 编码之后，HTTP 请求大小会不可避免地增加，因此您需要设置较大的值以考虑这种情况。</span><span class="sxs-lookup"><span data-stu-id="d215f-119">You need to make the value larger to account for the inevitable increase to the HTTP request size that occurs after all the parameters are encapsulated in a SOAP envelop, and the Base64 encoding is applied to certain parameters such as the Definition parameter in the <xref:ReportService2010.ReportingService2010.CreateReportEditSession%2A> and <xref:ReportService2010.ReportingService2010.CreateCatalogItem%2A> methods.</span></span> <span data-ttu-id="d215f-120">Base64 编码会将原始数据增大约 33%。</span><span class="sxs-lookup"><span data-stu-id="d215f-120">Base64 encoding increases the size of the original data by approximately 33%.</span></span> <span data-ttu-id="d215f-121">因此，为 `maxRequestLength` 元素指定的值需要比实际可用项目大小高出约 33%。</span><span class="sxs-lookup"><span data-stu-id="d215f-121">Consequently, the value you specify for the `maxRequestLength` element needs to be approximately 33% larger than the actual usable item size.</span></span> <span data-ttu-id="d215f-122">例如，如果为 `maxRequestLength` 指定 64 MB 的值，则实际上可以预计发布到报表服务器的报表文件的最大大小约为 48 MB。</span><span class="sxs-lookup"><span data-stu-id="d215f-122">For example, if you specify a value of 64 MB for `maxRequestLength`, realistically you can expect the maximum size for report files that are posted to the report server to be approximately 48 MB.</span></span>  
  
## <a name="report-size-in-memory"></a><span data-ttu-id="d215f-123">内存中的报表大小</span><span class="sxs-lookup"><span data-stu-id="d215f-123">Report Size in Memory</span></span>  
 <span data-ttu-id="d215f-124">运行报表时，报表大小等于报表中返回的数据量加上输出流的大小。</span><span class="sxs-lookup"><span data-stu-id="d215f-124">When you run a report, report size is equal to the amount of data that is returned in the report plus the size of the output stream.</span></span> [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="d215f-125">对呈现报表的大小无最大限制。</span><span class="sxs-lookup"><span data-stu-id="d215f-125">does not impose a maximum limit on the size of a rendered report.</span></span> <span data-ttu-id="d215f-126">系统内存决定大小的上限（默认情况下，在呈现报表时，报表服务器将使用所有可用的已配置内存），但您可以指定配置设置以设置内存阈值和内存管理策略。</span><span class="sxs-lookup"><span data-stu-id="d215f-126">System memory determines the upper limit on size (by default, a report server uses all available configured memory when rendering a report), but you can specify configuration settings to set memory thresholds and memory management policies.</span></span> <span data-ttu-id="d215f-127">有关详细信息，请参阅 [为报表服务器应用程序配置可用内存](../report-server/configure-available-memory-for-report-server-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="d215f-127">For more information, see [Configure Available Memory for Report Server Applications](../report-server/configure-available-memory-for-report-server-applications.md).</span></span>  
  
 <span data-ttu-id="d215f-128">任何报表的大小都会因返回的数据量以及对报表使用的呈现格式而存在很大的差异。</span><span class="sxs-lookup"><span data-stu-id="d215f-128">For any report, size can vary considerably depending on how much data is returned and which rendering format you use for the report.</span></span> <span data-ttu-id="d215f-129">参数化报表可能较大也可能较小，具体取决于参数值对查询结果的影响方式。</span><span class="sxs-lookup"><span data-stu-id="d215f-129">A parameterized report might be larger or smaller depending on how parameter values affect the query results.</span></span> <span data-ttu-id="d215f-130">您选择的报表输出格式将通过以下方式影响报表大小：</span><span class="sxs-lookup"><span data-stu-id="d215f-130">The report output format you choose effects report size in the following ways:</span></span>  
  
-   <span data-ttu-id="d215f-131">HTML 每次处理一页报表。</span><span class="sxs-lookup"><span data-stu-id="d215f-131">HTML processes the report one page at a time.</span></span> <span data-ttu-id="d215f-132">由于报表以较小的单元来进行处理，因此处理特定块区所需的内存也更少。</span><span class="sxs-lookup"><span data-stu-id="d215f-132">Because the report is processed in smaller units, less memory is required to process specific chunks.</span></span>  
  
-   <span data-ttu-id="d215f-133">在向用户显示报表之前，PDF、Excel、TIFF、XML 和 CSV 会在内存中处理整个报表。</span><span class="sxs-lookup"><span data-stu-id="d215f-133">PDF, Excel, TIFF, XML, and CSV process the entire report in memory before displaying the report to the user.</span></span>  
  
 <span data-ttu-id="d215f-134">若要度量所呈现报表的大小，可以查看报表执行日志。</span><span class="sxs-lookup"><span data-stu-id="d215f-134">To measure the size of a rendered report, you can view the report execution log.</span></span> <span data-ttu-id="d215f-135">有关详细信息，请参阅[报表服务器执行日志和 ExecutionLog3 视图](report-server-executionlog-and-the-executionlog3-view.md)。</span><span class="sxs-lookup"><span data-stu-id="d215f-135">For more information, see [Report Server Execution Log and the ExecutionLog3 View](report-server-executionlog-and-the-executionlog3-view.md).</span></span>  
  
 <span data-ttu-id="d215f-136">若要计算所呈现报表在磁盘中的大小，可以导出该报表，然后将其保存到文件系统（保存的文件包括数据和报表格式信息）。</span><span class="sxs-lookup"><span data-stu-id="d215f-136">To calculate the size of a rendered report on disk, you can export and then save the report to the file system (the saved file includes data and report formatting information).</span></span>  
  
 <span data-ttu-id="d215f-137">仅在呈现到 Excel 格式时，才对报表大小有严格限制。</span><span class="sxs-lookup"><span data-stu-id="d215f-137">The only hard limit on report size is when rendering to Excel format.</span></span> <span data-ttu-id="d215f-138">工作表不能超过 65536 行或 256 列。</span><span class="sxs-lookup"><span data-stu-id="d215f-138">Worksheets cannot exceed 65536 rows or 256 columns.</span></span> <span data-ttu-id="d215f-139">其他呈现格式没有这些限制，因此大小仅受服务器上资源量的限制。</span><span class="sxs-lookup"><span data-stu-id="d215f-139">Other rendering formats do not have these limits so size is limited only by the amount of resources on your server.</span></span> <span data-ttu-id="d215f-140">有关 Excel 文件限制的详细信息，请参阅[将报表导出为其他文件类型 &#40;报表生成器和 SSRS&#41;](../export-a-report-as-another-file-type-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="d215f-140">For more information about Excel file limits, see [Export a Report as Another File Type &#40;Report Builder and SSRS&#41;](../export-a-report-as-another-file-type-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d215f-141">报表处理和呈现都在内存中进行。</span><span class="sxs-lookup"><span data-stu-id="d215f-141">Report processing and rendering occur in memory.</span></span> <span data-ttu-id="d215f-142">如果您具有大型报表或大量用户，则务必进行某种容量规划，确保您执行的报表服务器部署令用户满意。</span><span class="sxs-lookup"><span data-stu-id="d215f-142">If you have large reports or large number of users, be sure to do some kind of capacity planning to make sure your report server deployment performs at a level that is satisfactory for your users.</span></span> <span data-ttu-id="d215f-143">有关工具和指南的详细信息，请参阅 MSDN 上的以下发布内容： [Planning for Scalability and Performance with Reporting Services](http://spmarchitecture.com/ssrs-architecture/planning-for-scalability-and-performance-reporting-services-70744/) （规划 Reporting Services 的扩展性和性能）和 [Using Visual Studio 2005 to Perform Load Testing on a SQL Server 2005 Reporting Services Report Server](https://go.microsoft.com/fwlink/?LinkID=77519)（使用 Visual Studio 2005 在 SQL Server 2005 Reporting Services 报表服务器上执行负载测试）。</span><span class="sxs-lookup"><span data-stu-id="d215f-143">For more information about tools and guidelines, see the following publications on MSDN: [Planning for Scalability and Performance with Reporting Services](http://spmarchitecture.com/ssrs-architecture/planning-for-scalability-and-performance-reporting-services-70744/) and [Using Visual Studio 2005 to Perform Load Testing on a SQL Server 2005 Reporting Services Report Server](https://go.microsoft.com/fwlink/?LinkID=77519).</span></span>  
  
## <a name="measuring-snapshot-storage"></a><span data-ttu-id="d215f-144">度量快照存储</span><span class="sxs-lookup"><span data-stu-id="d215f-144">Measuring Snapshot Storage</span></span>  
 <span data-ttu-id="d215f-145">任何给定快照的大小都与报表中的数据量成正比。</span><span class="sxs-lookup"><span data-stu-id="d215f-145">The size of any given snapshot is directly proportional to the amount of data in the report.</span></span> <span data-ttu-id="d215f-146">快照通常比报表服务器上存储的其他项大得多。</span><span class="sxs-lookup"><span data-stu-id="d215f-146">Snapshots are typically much larger than other items that are stored on a report server.</span></span> <span data-ttu-id="d215f-147">快照大小通常在几 MB 到几十 MB 之间。</span><span class="sxs-lookup"><span data-stu-id="d215f-147">Snapshot size can typically range from a few megabytes to tens of megabytes.</span></span> <span data-ttu-id="d215f-148">如果报表非常大，则可能会看到更大的快照。</span><span class="sxs-lookup"><span data-stu-id="d215f-148">If you have very large reports, you can expect to see snapshots that are even larger.</span></span> <span data-ttu-id="d215f-149">根据使用快照的频率以及配置报表历史记录的方式，报表服务器数据库所需的磁盘空间量可能会在短期内迅速增加。</span><span class="sxs-lookup"><span data-stu-id="d215f-149">Depending on how frequently you use snapshots and how you configure report history, the amount of disk space that the report server database requires can increase rapidly over a short period of time.</span></span>  
  
 <span data-ttu-id="d215f-150">默认情况下， **reportserver** 和 **reportservertempdb** 数据库设置为自动增长。</span><span class="sxs-lookup"><span data-stu-id="d215f-150">By default, both the **reportserver** and **reportservertempdb** databases are set to autogrow.</span></span> <span data-ttu-id="d215f-151">尽管数据库大小会自动增大，但绝不会自动减小。</span><span class="sxs-lookup"><span data-stu-id="d215f-151">Although the database size can increase automatically, it is never decreased automatically.</span></span> <span data-ttu-id="d215f-152">如果 **reportserver** 数据库由于您删除了快照而具有多余容量，则必须手动减少容量，以恢复磁盘空间。</span><span class="sxs-lookup"><span data-stu-id="d215f-152">If the **reportserver** database has excess capacity because you deleted snapshots, you must manually reduce it to recover disk space.</span></span> <span data-ttu-id="d215f-153">同样，如果 **reportservertempdb** 增大以容纳超高的交互式报表量，则减少容量之前，磁盘空间分配将始终保持此设置。</span><span class="sxs-lookup"><span data-stu-id="d215f-153">Similarly, if the **reportservertempdb** grew to accommodate an unusually high volume of interactive reporting, the disk space allocation will remain at that setting until you reduce it.</span></span>  
  
 <span data-ttu-id="d215f-154">若要度量报表服务器数据库的大小，可以运行以下 [!INCLUDE[tsql](../../includes/tsql-md.md)] 命令。</span><span class="sxs-lookup"><span data-stu-id="d215f-154">To measure the size of the report server databases, you can run the following [!INCLUDE[tsql](../../includes/tsql-md.md)] commands.</span></span> <span data-ttu-id="d215f-155">定期计算数据库总大小有助于合理估计在一段时间内如何为报表服务器数据库分配空间。</span><span class="sxs-lookup"><span data-stu-id="d215f-155">Calculating total database size at regular intervals can help you develop reasonable estimates of how to allocate space for the report server database over time.</span></span> <span data-ttu-id="d215f-156">下面的语句用于测量当前使用的空间量（这些语句假设你使用的是默认数据库名称）：</span><span class="sxs-lookup"><span data-stu-id="d215f-156">The following statements measure the amount of space that is currently used (the statements assume you are using default database names):</span></span>  
  
```  
USE ReportServer  
EXEC sp_spaceused  
```  
  
## <a name="snapshot-size-and-report-server-performance"></a><span data-ttu-id="d215f-157">快照大小和报表服务器性能</span><span class="sxs-lookup"><span data-stu-id="d215f-157">Snapshot Size and Report Server Performance</span></span>  
 <span data-ttu-id="d215f-158">快照大小会影响处理和呈现报表时的服务器性能。</span><span class="sxs-lookup"><span data-stu-id="d215f-158">Snapshot size affects server performance when the report is processed and rendered.</span></span> <span data-ttu-id="d215f-159">呈现操作对服务器性能的影响最大，因此如果您具有大型快照，则在用户请求报表时可能会出现延迟。</span><span class="sxs-lookup"><span data-stu-id="d215f-159">Server performance is most affected by rendering operations, so if you have a large snapshot you can expect some delay when users request the report.</span></span> <span data-ttu-id="d215f-160">当快照大小超过 100 MB 时，根据用户的数量，可能会遇到延迟情况。</span><span class="sxs-lookup"><span data-stu-id="d215f-160">Depending on the number of users, you can expect to encounter delays when snapshot size is over 100 megabytes.</span></span>  
  
 <span data-ttu-id="d215f-161">若要最大程度地降低因大型快照造成的性能延迟，可以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="d215f-161">To minimize performance delays due to large snapshots, you can do the following:</span></span>  
  
-   <span data-ttu-id="d215f-162">在不同的计算机上部署报表服务器和 [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="d215f-162">Deploy the report server and the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] on separate computers.</span></span>  
  
-   <span data-ttu-id="d215f-163">添加更多系统内存。</span><span class="sxs-lookup"><span data-stu-id="d215f-163">Add more system memory.</span></span>  
  
-   <span data-ttu-id="d215f-164">查阅 MSDN 网站上的“Reporting Services 的伸缩性和性能表现规划”文档，以了解如何为企业配置报表服务器的最佳实践。</span><span class="sxs-lookup"><span data-stu-id="d215f-164">Review the "Planning for Scalability and Performance with Reporting Services" document on the MSDN Web site for best practices on how to configure a report server for the enterprise.</span></span>  
  
 <span data-ttu-id="d215f-165">报表服务器数据库中存储的快照数量本身并不是一个性能因素。</span><span class="sxs-lookup"><span data-stu-id="d215f-165">The quantity of snapshots that are stored in a report server database is, by itself, not a performance factor.</span></span> <span data-ttu-id="d215f-166">可以存储大量快照，而不对服务器性能产生任何影响。</span><span class="sxs-lookup"><span data-stu-id="d215f-166">You can store a large number of snapshots without affecting server performance.</span></span> <span data-ttu-id="d215f-167">可以无限期地保留快照。</span><span class="sxs-lookup"><span data-stu-id="d215f-167">You can keep snapshots indefinitely.</span></span> <span data-ttu-id="d215f-168">但应注意，报表历史记录是可配置的。</span><span class="sxs-lookup"><span data-stu-id="d215f-168">However, be aware that report history is configurable.</span></span> <span data-ttu-id="d215f-169">如果报表服务器管理员降低了报表历史记录限制，您可能会丢失要保留的历史报表。</span><span class="sxs-lookup"><span data-stu-id="d215f-169">If a report server administrator lowers the report history limit, you might lose historical reports that you intended to keep.</span></span> <span data-ttu-id="d215f-170">如果删除报表，则所有的报表历史记录也将随之删除。</span><span class="sxs-lookup"><span data-stu-id="d215f-170">If you delete the report, all report history is deleted with it.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d215f-171">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d215f-171">See Also</span></span>  
 <span data-ttu-id="d215f-172">[设置报表处理属性](set-report-processing-properties.md) </span><span class="sxs-lookup"><span data-stu-id="d215f-172">[Set Report Processing Properties](set-report-processing-properties.md) </span></span>  
 <span data-ttu-id="d215f-173">[报表服务器数据库 &#40;SSRS 本机模式&#41;](report-server-database-ssrs-native-mode.md) </span><span class="sxs-lookup"><span data-stu-id="d215f-173">[Report Server Database &#40;SSRS Native Mode&#41;](report-server-database-ssrs-native-mode.md) </span></span>  
 [<span data-ttu-id="d215f-174">处理大型报表</span><span class="sxs-lookup"><span data-stu-id="d215f-174">Process Large Reports</span></span>](process-large-reports.md)  
  
  
