---
title: 存储加密的报表服务器数据（SSRS 配置管理器）| Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- report servers [Reporting Services], encryption
- credentials [Reporting Services]
- cryptography [Reporting Services]
- confidential reports [Reporting Services]
- encryption [Reporting Services]
- databases [Reporting Services], encryption
ms.assetid: ac0f4d4d-fc4b-4c62-a693-b86e712e75f2
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0cbc414918a15d19f0f211a572878dc7f93ca277
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87694302"
---
# <a name="store-encrypted-report-server-data-ssrs-configuration-manager"></a><span data-ttu-id="89692-102">存储加密的报表服务器数据（SSRS 配置管理器）</span><span class="sxs-lookup"><span data-stu-id="89692-102">Store Encrypted Report Server Data (SSRS Configuration Manager)</span></span>
  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="89692-103">将加密值存储在报表服务器数据库和配置文件中。</span><span class="sxs-lookup"><span data-stu-id="89692-103">stores encrypted values in the report server database and in configuration files.</span></span> <span data-ttu-id="89692-104">大多数加密值都是用于访问向报表提供数据的外部数据源的凭据。</span><span class="sxs-lookup"><span data-stu-id="89692-104">Most encrypted values are credentials that are used for accessing external data sources that provide data to reports.</span></span> <span data-ttu-id="89692-105">本主题介绍对哪些值进行了加密、 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]中使用的加密功能以及您应当了解的其他类型的已存储机密数据。</span><span class="sxs-lookup"><span data-stu-id="89692-105">This topic describes which values are encrypted, the encryption functionality used in [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], and other kinds of stored confidential data that you should know about.</span></span>  
  
## <a name="encrypted-values"></a><span data-ttu-id="89692-106">加密值</span><span class="sxs-lookup"><span data-stu-id="89692-106">Encrypted Values</span></span>  
 <span data-ttu-id="89692-107">下面列出了 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 安装中所存储的值。</span><span class="sxs-lookup"><span data-stu-id="89692-107">The following list describes the values that are stored in a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] installation.</span></span>  
  
-   <span data-ttu-id="89692-108">报表服务器用于连接到报表服务器数据库（存储内部服务器数据）的连接信息和凭据。</span><span class="sxs-lookup"><span data-stu-id="89692-108">Connection information and credentials used by a report server to connect to a report server database that stores internal server data.</span></span>  
  
     <span data-ttu-id="89692-109">这些值是在安装过程中或报表服务器配置期间指定和加密的。</span><span class="sxs-lookup"><span data-stu-id="89692-109">These values are specified and encrypted during setup or report server configuration.</span></span> <span data-ttu-id="89692-110">您可以在任何时候使用 Reporting Services 配置工具或 **rsconfig** 实用工具更新连接信息。</span><span class="sxs-lookup"><span data-stu-id="89692-110">You can update the connection information at any time using the Reporting Services Configuration tool or the **rsconfig** utility.</span></span> <span data-ttu-id="89692-111">对配置设置的加密则是使用对所有用户都可用的本地计算机的计算机级密钥来执行的。</span><span class="sxs-lookup"><span data-stu-id="89692-111">Encryption of configuration settings is performed by using the machine-level key of the local computer that is available to all users.</span></span> <span data-ttu-id="89692-112">加密的报表服务器连接信息存储在 rsreportserver.config 文件中（其他任何配置文件都不会包含加密设置）。</span><span class="sxs-lookup"><span data-stu-id="89692-112">Encrypted report server connection information is stored in the rsreportserver.config file (no other configuration file contains encrypted settings).</span></span> <span data-ttu-id="89692-113">有关详细信息，请参阅 [配置报表服务器数据库连接（SSRS 配置管理器）](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md)中支持的版本。</span><span class="sxs-lookup"><span data-stu-id="89692-113">For more information, see [Configure a Report Server Database Connection  &#40;SSRS Configuration Manager&#41;](../../sql-server/install/configure-a-report-server-database-connection-ssrs-configuration-manager.md).</span></span>  
  
-   <span data-ttu-id="89692-114">报表服务器用于连接到向报表提供数据的外部数据源的存储凭据。</span><span class="sxs-lookup"><span data-stu-id="89692-114">Stored credentials that are used by a report server to connect to external data sources that provide data to a report.</span></span>  
  
     <span data-ttu-id="89692-115">这些值是在您为报表配置数据源信息时定义的，随后会以加密值的形式存储在报表服务器数据库中。</span><span class="sxs-lookup"><span data-stu-id="89692-115">These values are defined when you configure data source information for a report, and then stored as encrypted values in a report server database.</span></span> <span data-ttu-id="89692-116">报表服务器使用对称密钥对这些数据进行加密和解密。</span><span class="sxs-lookup"><span data-stu-id="89692-116">The report server uses a symmetric key to encrypt and decrypt this data.</span></span> <span data-ttu-id="89692-117">有关存储的凭据的详细信息，请参阅 [联机丛书中的](../../integration-services/connection-manager/data-sources.md) 为报表数据源指定凭据和连接信息 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="89692-117">For more information about stored credentials, see [Specify Credential and Connection Information for Report Data Sources](../../integration-services/connection-manager/data-sources.md) in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
-   <span data-ttu-id="89692-118">报表服务器用于连接到其他计算机以检索报表中使用的外部图像文件或外部数据的无人参与用户帐户。</span><span class="sxs-lookup"><span data-stu-id="89692-118">An unattended user account used by the report server to connect to other computers to retrieve external images files or external data that is used in a report.</span></span>  
  
     <span data-ttu-id="89692-119">当需要连接到远程计算机且没有其他可用于连接的凭据时，可使用此帐户。</span><span class="sxs-lookup"><span data-stu-id="89692-119">This account is used when a connection to a remote computer is required and no other credentials are available to make the connection.</span></span> <span data-ttu-id="89692-120">此帐户主要用于支持对不使用凭据即可访问数据源的报表进行无人参与处理。</span><span class="sxs-lookup"><span data-stu-id="89692-120">This account is primarily used to support unattended report processing for reports that do not use credentials to access a data source.</span></span> <span data-ttu-id="89692-121">如果创建报表所依据的数据源在访问数据时不要求或使用凭据，则必须配置此帐户才能使用报表服务器。</span><span class="sxs-lookup"><span data-stu-id="89692-121">If you create reports based on data sources that do not require or use credentials when accessing data, you must configure this account for the report server to use.</span></span>  
  
     <span data-ttu-id="89692-122">此帐户在某些环境下是必需的，并且只能通过 Reporting Services 配置工具或 **rsconfig**进行创建。</span><span class="sxs-lookup"><span data-stu-id="89692-122">This account is required under certain circumstances and can only be created through the Reporting Services Configuration tool or **rsconfig**.</span></span> <span data-ttu-id="89692-123">此值还会存储在 rsreportserver.config 文件中。</span><span class="sxs-lookup"><span data-stu-id="89692-123">This value is also stored in the rsreportserver.config file.</span></span> <span data-ttu-id="89692-124">您必须手动创建此帐户。</span><span class="sxs-lookup"><span data-stu-id="89692-124">You must create this account manually.</span></span> <span data-ttu-id="89692-125">有关此帐户及其使用方式的详细信息，请参阅[配置无人参与的执行帐户（SSRS 配置管理器）](configure-the-unattended-execution-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="89692-125">For more information about this account and how it is used, see [Configure the Unattended Execution Account &#40;SSRS Configuration Manager&#41;](configure-the-unattended-execution-account-ssrs-configuration-manager.md).</span></span>  
  
-   <span data-ttu-id="89692-126">用于加密的对称密钥。</span><span class="sxs-lookup"><span data-stu-id="89692-126">The symmetric key used for encryption.</span></span>  
  
     <span data-ttu-id="89692-127">此值是在安装过程中或服务器配置期间创建的，随后会以加密值的形式存储在报表服务器数据库中。</span><span class="sxs-lookup"><span data-stu-id="89692-127">This value is created during setup or server configuration, and then stored as an encrypted value in the report server database.</span></span> <span data-ttu-id="89692-128">报表服务器 Windows 服务使用此密钥对存储在报表服务器数据库中的数据进行加密和解密。</span><span class="sxs-lookup"><span data-stu-id="89692-128">The Report Server Windows service uses this key to encrypt and decrypt data that is stored in the report server database.</span></span>  
  
## <a name="encryption-functionality-in-reporting-services"></a><span data-ttu-id="89692-129">Reporting Services 中的加密功能</span><span class="sxs-lookup"><span data-stu-id="89692-129">Encryption Functionality in Reporting Services</span></span>  
 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="89692-130">使用 Windows 操作系统提供的加密功能。</span><span class="sxs-lookup"><span data-stu-id="89692-130">uses cryptographic functions that are part of the Windows operating system.</span></span> <span data-ttu-id="89692-131">包括对称加密和非对称加密。</span><span class="sxs-lookup"><span data-stu-id="89692-131">Both symmetric and asymmetric encryption are used.</span></span>  
  
 <span data-ttu-id="89692-132">报表服务器数据库中的数据使用对称密钥进行加密。</span><span class="sxs-lookup"><span data-stu-id="89692-132">Data in the report server database is encrypted using a symmetric key.</span></span> <span data-ttu-id="89692-133">每个报表服务器数据库只有一个对称密钥。</span><span class="sxs-lookup"><span data-stu-id="89692-133">There is a single symmetric key for each report server database.</span></span> <span data-ttu-id="89692-134">此对称密钥使用 Windows 生成的非对称密钥对的公钥进行自加密。</span><span class="sxs-lookup"><span data-stu-id="89692-134">This symmetric key is itself encrypted using the public key of an asymmetric key pair generated by Windows.</span></span> <span data-ttu-id="89692-135">私钥由 Report Server Windows 服务帐户持有。</span><span class="sxs-lookup"><span data-stu-id="89692-135">The private key is held by the Report Server Windows service account.</span></span>  
  
 <span data-ttu-id="89692-136">在多个报表服务器实例共享同一个报表服务器数据库的报表服务器扩展部署中，所有报表服务器节点都使用一个对称密钥。</span><span class="sxs-lookup"><span data-stu-id="89692-136">In a report server scale-out deployment where multiple report server instances share the same report server database, a single symmetric key is used by all report server nodes.</span></span> <span data-ttu-id="89692-137">每个节点必须具有一个共享对称密钥的副本。</span><span class="sxs-lookup"><span data-stu-id="89692-137">Each node must have a copy of the shared symmetric key.</span></span> <span data-ttu-id="89692-138">配置扩展部署时，将为每个节点自动创建一个对称密钥副本。</span><span class="sxs-lookup"><span data-stu-id="89692-138">A copy of the symmetric key is created for each node automatically when the scale-out deployment is configured.</span></span> <span data-ttu-id="89692-139">每个节点都使用 Windows 服务帐户专有密钥对的公钥来加密对称密钥的副本。</span><span class="sxs-lookup"><span data-stu-id="89692-139">Each node encrypts its copy of the symmetric key using the public key of a key pair specific to its Windows service account.</span></span> <span data-ttu-id="89692-140">若要详细了解如何为单个实例和扩展部署创建对称密钥，请参阅[初始化报表服务器（SSRS 配置管理器）](ssrs-encryption-keys-initialize-a-report-server.md)。</span><span class="sxs-lookup"><span data-stu-id="89692-140">To learn more about how the symmetric key is created for both single instance and scale-out deployments, see [Initialize a Report Server &#40;SSRS Configuration Manager&#41;](ssrs-encryption-keys-initialize-a-report-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="89692-141">如果更改 Report Server Windows 服务帐户，则非对称密钥将变为无效，从而中断服务器操作。</span><span class="sxs-lookup"><span data-stu-id="89692-141">When you change the Report Server Windows service account, the asymmetric keys can become invalid, which will disrupt server operations.</span></span> <span data-ttu-id="89692-142">为了避免此类故障，请始终使用 Reporting Services 配置工具来修改服务帐户设置。</span><span class="sxs-lookup"><span data-stu-id="89692-142">To avoid this problem, always use the Reporting Services Configuration tool to modify service account settings.</span></span> <span data-ttu-id="89692-143">使用配置工具时，密钥会自动更新。</span><span class="sxs-lookup"><span data-stu-id="89692-143">When you use the configuration tool, the keys are updated for you automatically.</span></span> <span data-ttu-id="89692-144">有关详细信息，请参阅 [配置报表服务器服务帐户（SSRS 配置管理器）](configure-the-report-server-service-account-ssrs-configuration-manager.md)。</span><span class="sxs-lookup"><span data-stu-id="89692-144">For more information, see [Configure the Report Server Service Account &#40;SSRS Configuration Manager&#41;](configure-the-report-server-service-account-ssrs-configuration-manager.md).</span></span>  
  
## <a name="other-sources-of-confidential-data"></a><span data-ttu-id="89692-145">其他机密数据源</span><span class="sxs-lookup"><span data-stu-id="89692-145">Other Sources of Confidential Data</span></span>  
 <span data-ttu-id="89692-146">报表服务器中还存储有其他可能包含需保护的敏感信息的未加密数据。</span><span class="sxs-lookup"><span data-stu-id="89692-146">A report server stores other data that is not encrypted, yet may contain sensitive information that you want to protect.</span></span> <span data-ttu-id="89692-147">具体来说，报表历史记录快照和报表执行快照包含的查询结果可能包括仅供授权用户使用的数据。</span><span class="sxs-lookup"><span data-stu-id="89692-147">Specifically, report history snapshots and report execution snapshots contain query results that may include data that is intended for authorized users.</span></span> <span data-ttu-id="89692-148">因此，对包含机密数据的报表使用快照功能时，需要注意，有权打开报表服务器数据库中的表的用户也能通过检查表的内容来查看所存储报表的部分内容。</span><span class="sxs-lookup"><span data-stu-id="89692-148">If you are using snapshot functionality for reports that contain confidential data, be aware that users who can open tables in a report server database may be able to view portions of a stored report by inspecting the contents of the table.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="89692-149">对于所用参数基于用户安全标识的报表，不支持缓存或报表历史记录。</span><span class="sxs-lookup"><span data-stu-id="89692-149">does not support caching or report history for reports that use parameters based on the security identify of the user.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="89692-150">另请参阅</span><span class="sxs-lookup"><span data-stu-id="89692-150">See Also</span></span>  
 [<span data-ttu-id="89692-151">配置和管理加密密钥（SSRS 配置管理器）</span><span class="sxs-lookup"><span data-stu-id="89692-151">Configure and Manage Encryption Keys &#40;SSRS Configuration Manager&#41;</span></span>](ssrs-encryption-keys-manage-encryption-keys.md)  
  
  
