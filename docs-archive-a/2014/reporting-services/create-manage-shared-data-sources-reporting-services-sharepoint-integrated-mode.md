---
title: 在 SharePoint 集成模式下创建和管理共享数据源 (Reporting Services) |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- SharePoint integration [Reporting Services], shared data sources
- shared data sources [Reporting Services]
ms.assetid: 2d3428e4-a810-4e66-a287-ff18e57fad76
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5eedb74dd5a24f40469b3ee6a4a24e97e6e59174
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87579524"
---
# <a name="create-and-manage-shared-data-sources-reporting-services-in-sharepoint-integrated-mode"></a><span data-ttu-id="7c362-102">创建和管理共享数据源（SharePoint 集成模式下的 Reporting Services）</span><span class="sxs-lookup"><span data-stu-id="7c362-102">Create and Manage Shared Data Sources (Reporting Services in SharePoint Integrated Mode)</span></span>
  <span data-ttu-id="7c362-103">从 SharePoint 库运行报表时，可以在报表或链接至报表的外部文件中定义连接信息。</span><span class="sxs-lookup"><span data-stu-id="7c362-103">When you run a report from a SharePoint library, connection information can be defined inside the report or in an external file that is linked to the report.</span></span> <span data-ttu-id="7c362-104">如果连接信息嵌入在报表中，则该信息称为自定义数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-104">If the connection information is embedded within the report, it is called a custom data source.</span></span> <span data-ttu-id="7c362-105">如果连接信息在外部文件中进行定义，则该信息称为共享数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-105">If the connection information is defined in an external file, it is called a shared data source.</span></span> <span data-ttu-id="7c362-106">外部文件可以是报表服务器数据源 (.rsds) 文件，也可以是 Office 数据连接 (.odc) 文件。</span><span class="sxs-lookup"><span data-stu-id="7c362-106">The external file can be a report server data source (.rsds) file or an Office Data Connection (.odc) file.</span></span>  
  
 <span data-ttu-id="7c362-107">.rsds 文件与 .rds 文件类似，但它具有不同的架构。</span><span class="sxs-lookup"><span data-stu-id="7c362-107">An .rsds file is similar to an .rds file, but it has a different schema.</span></span> <span data-ttu-id="7c362-108">若要创建 .rsds 文件，可以从报表设计器或模型设计器向 SharePoint 库发布一个 .rds 文件（将从该原始 .rds 文件创建一个新的 .rsds 文件）。</span><span class="sxs-lookup"><span data-stu-id="7c362-108">To create an .rsds file, you can publish an .rds from Report Designer or Model Designer to a SharePoint library (a new .rsds file is created from the original .rds file).</span></span> <span data-ttu-id="7c362-109">也可以在 SharePoint 站点上的库中创建新文件。</span><span class="sxs-lookup"><span data-stu-id="7c362-109">Or, you can create a new file in a library on a SharePoint Site.</span></span>  
  
 <span data-ttu-id="7c362-110">在创建或发布共享数据源后，可以编辑连接属性或者在不再使用共享数据源时删除此文件。</span><span class="sxs-lookup"><span data-stu-id="7c362-110">After you create or publish a shared data source, you can edit connection properties or delete the file if it is no longer used.</span></span> <span data-ttu-id="7c362-111">删除共享数据源之前，您应该确定是否有报表和报表模型在使用该数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-111">Before you delete a shared data source, you should determine whether it is used by reports and report models.</span></span> <span data-ttu-id="7c362-112">可以通过查看引用共享数据源的依赖项来进行确定。</span><span class="sxs-lookup"><span data-stu-id="7c362-112">You can do this by viewing dependent items that reference the shared data source.</span></span>  
  
 <span data-ttu-id="7c362-113">虽然依赖项列表会告诉您是否引用了共享数据源，但它不会告诉您数据源是否正在使用。</span><span class="sxs-lookup"><span data-stu-id="7c362-113">Although the list of dependent items tells you whether the shared data source is referenced, it does not tell you whether the item is actively used.</span></span> <span data-ttu-id="7c362-114">若要确定共享数据源或模型是否正在使用，您可以在报表服务器计算机上查看日志文件。</span><span class="sxs-lookup"><span data-stu-id="7c362-114">To determine whether the shared data source or model is actively used, you can review the log files on the report server computer.</span></span> <span data-ttu-id="7c362-115">如果您无权访问日志文件，或者这些文件不包含您想要的信息，请考虑在确定报表的实际状态时将其移动到不可访问的文件夹。</span><span class="sxs-lookup"><span data-stu-id="7c362-115">If you do not have access to the log files or if the files do not contain the information you want, consider moving the report to an inaccessible folder while you determine its actual status.</span></span>  
  
### <a name="to-create-a-shared-data-source-rsds-file-sharepoint-2010"></a><span data-ttu-id="7c362-116">创建共享数据源 (.rsds) 文件 (SharePoint 2010)</span><span class="sxs-lookup"><span data-stu-id="7c362-116">To create a shared data source (.rsds) file (SharePoint 2010)</span></span>  
  
1.  <span data-ttu-id="7c362-117">在库功能区上单击 **“文档”** 选项卡。</span><span class="sxs-lookup"><span data-stu-id="7c362-117">Click the **Documents** tab on the library ribbon.</span></span>  
  
2.  <span data-ttu-id="7c362-118">在 **“新建文档”** 菜单上，单击 **“报表数据源”**。</span><span class="sxs-lookup"><span data-stu-id="7c362-118">On the **New Document** menu, click **Report Data Source**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7c362-119">如果在菜单上没有看到 **“报表数据源”** 项，说明报表数据源内容类型尚未启用。</span><span class="sxs-lookup"><span data-stu-id="7c362-119">If you do not see the **Report Data Source** item on the menu, the report data source content type has not been enabled.</span></span> <span data-ttu-id="7c362-120">有关详细信息，请参阅[将报表服务器内容类型添加到库 &#40;Reporting Services 在 SharePoint 集成模式下&#41;" ](../../2014/reporting-services/add-reporting-services-content-types-to-a-sharepoint-library.md)。</span><span class="sxs-lookup"><span data-stu-id="7c362-120">For more information, see [Add Report Server Content Types to a Library &#40;Reporting Services in SharePoint Integrated Mode&#41;](../../2014/reporting-services/add-reporting-services-content-types-to-a-sharepoint-library.md).</span></span>  
  
3.  <span data-ttu-id="7c362-121">在 **“名称”** 中，为 .rsds 文件输入一个说明性名称。</span><span class="sxs-lookup"><span data-stu-id="7c362-121">In **Name**, enter a descriptive name for the .rsds file.</span></span>  
  
4.  <span data-ttu-id="7c362-122">在 **“数据源类型”** 中，从列表中选择数据源的类型。</span><span class="sxs-lookup"><span data-stu-id="7c362-122">In **Data Source Type**, select the type of data source from the list.</span></span> <span data-ttu-id="7c362-123">有关详细信息，请参阅 [Reporting Services 支持的数据源 (SSRS)](create-deploy-and-manage-mobile-and-paginated-reports.md)。</span><span class="sxs-lookup"><span data-stu-id="7c362-123">For more information, see [Data Sources Supported by Reporting Services &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md).</span></span>  
  
5.  <span data-ttu-id="7c362-124">在 **“连接字符串”** 中，指定指向数据源的指针和建立外部数据源连接所必需的任何其他设置。</span><span class="sxs-lookup"><span data-stu-id="7c362-124">In **Connection String**, specify a pointer to the data source and any other settings that are necessary for establishing a connection to the external data source.</span></span> <span data-ttu-id="7c362-125">您所使用的数据源类型决定了连接字符串的语法。</span><span class="sxs-lookup"><span data-stu-id="7c362-125">The type of data source you are using determines the syntax of the connection string.</span></span> <span data-ttu-id="7c362-126">有关详细信息和示例，请参阅[Reporting Services 中的数据连接、数据源和连接字符串](../../2014/reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md)。</span><span class="sxs-lookup"><span data-stu-id="7c362-126">For more information and examples, see [Data Connections, Data Sources, and Connection Strings in Reporting Services](../../2014/reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md).</span></span>  
  
6.  <span data-ttu-id="7c362-127">在 **“凭据”** 中，指定报表服务器如何获取访问外部数据源的凭据。</span><span class="sxs-lookup"><span data-stu-id="7c362-127">In **Credentials**, specify how the report server obtains credentials to access the external data source.</span></span> <span data-ttu-id="7c362-128">凭据可通过存储、提示、集成或配置方式用于无人参与的报表处理。</span><span class="sxs-lookup"><span data-stu-id="7c362-128">Credentials can be stored, prompted, integrated, or configured for unattended report processing.</span></span>  
  
    -   <span data-ttu-id="7c362-129">若要使用打开报表的用户凭据访问数据，请选择“Windows 身份验证(集成)”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7c362-129">Select **Windows authentication (integrated)** if you want to access the data using the credentials of the user who opened the report.</span></span> <span data-ttu-id="7c362-130">如果 SharePoint 站点或场使用窗体身份验证或通过可信帐户连接至报表服务器，请不要选择此选项。</span><span class="sxs-lookup"><span data-stu-id="7c362-130">Do not select this option if the SharePoint site or farm uses forms authentication or connects to the report server through a trusted account.</span></span> <span data-ttu-id="7c362-131">若要为此报表计划订阅或数据处理，请不要选择此选项。</span><span class="sxs-lookup"><span data-stu-id="7c362-131">Do not select this option if you want to schedule subscription or data processing for this report.</span></span> <span data-ttu-id="7c362-132">如果您的域启用了 Kerberos 身份验证或者数据源与报表服务器位于同一台计算机上，则此选项最为有效。</span><span class="sxs-lookup"><span data-stu-id="7c362-132">This option works best when Kerberos authentication is enabled for your domain, or when the data source is on the same computer as the report server.</span></span> <span data-ttu-id="7c362-133">如果未启用 Kerberos 身份验证，则只能将 Windows 凭据传递到另一台计算机。</span><span class="sxs-lookup"><span data-stu-id="7c362-133">If Kerberos authentication is not enabled, Windows credentials can only be passed to one other computer.</span></span> <span data-ttu-id="7c362-134">也就是说，如果外部数据源位于需要另行连接的其他计算机上，则会出现错误而不会获得期望的数据。</span><span class="sxs-lookup"><span data-stu-id="7c362-134">This means that if the external data source is on another computer, requiring an additional connection, you will get an error instead of the data you expect.</span></span>  
  
    -   <span data-ttu-id="7c362-135">若要使用户在每次运行报表时都输入其凭据，请选择 **“凭据提示”** 。</span><span class="sxs-lookup"><span data-stu-id="7c362-135">Select **Prompt for credentials** if you want the user to enter his or her credentials each time he or she runs the report.</span></span> <span data-ttu-id="7c362-136">若要为此报表计划订阅或数据处理，请不要选择此选项。</span><span class="sxs-lookup"><span data-stu-id="7c362-136">Do not select this option if you want to schedule subscription or data processing for this report.</span></span>  
  
    -   <span data-ttu-id="7c362-137">若要使用一组凭据访问数据，请选择 **“已存储凭据”** 。</span><span class="sxs-lookup"><span data-stu-id="7c362-137">Select **Stored credentials** if you want to access the data using a single set of credentials.</span></span> <span data-ttu-id="7c362-138">凭据在存储之前是加密的。</span><span class="sxs-lookup"><span data-stu-id="7c362-138">The credentials are encrypted before they are stored.</span></span> <span data-ttu-id="7c362-139">您可以选择用于确定如何对已存储凭据进行身份验证的选项。</span><span class="sxs-lookup"><span data-stu-id="7c362-139">You can select options that determine how the stored credentials are authenticated.</span></span> <span data-ttu-id="7c362-140">如果已存储的凭据属于 Windows 用户帐户，请选择“用作 Windows 凭据”。</span><span class="sxs-lookup"><span data-stu-id="7c362-140">Select Use as Windows credentials if the stored credentials belong to a Windows user account.</span></span> <span data-ttu-id="7c362-141">如果要设置数据库服务器的执行上下文，请选择 **“设置此帐户的执行上下文”** 。</span><span class="sxs-lookup"><span data-stu-id="7c362-141">Select **Set execution context to this account** if you want to set the execution context on the database server.</span></span> <span data-ttu-id="7c362-142">对于 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 数据库，此选项将设置 SETUSER 函数。</span><span class="sxs-lookup"><span data-stu-id="7c362-142">For [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] databases, this option sets the SETUSER function.</span></span> <span data-ttu-id="7c362-143">有关详细信息，请参阅 [SETUSER (Transact-SQL)](/sql/t-sql/statements/setuser-transact-sql)。</span><span class="sxs-lookup"><span data-stu-id="7c362-143">For more information, see [SETUSER &#40;Transact-SQL&#41;](/sql/t-sql/statements/setuser-transact-sql).</span></span>  
  
    -   <span data-ttu-id="7c362-144">如果要在连接字符串中指定凭据，或者如果要使用在报表服务器上配置的最低特权帐户运行报表，请选择“不需要提供凭据”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="7c362-144">Select **Credentials are not required** if you want to specify credentials in the connection string, or if you want to run the report using a least-privilege account that is configured on the report server.</span></span> <span data-ttu-id="7c362-145">如果未在报表服务器上配置此帐户，系统将提示用户输入凭据，并且不会运行您为报表定义的任何计划操作。</span><span class="sxs-lookup"><span data-stu-id="7c362-145">If this account is not configured on the report server, users will be prompted for credentials and any scheduled operations that you define for the report will not run.</span></span>  
  
7.  <span data-ttu-id="7c362-146">如果您想要数据源处于活动状态，则选择 **“启用此数据源”** 。</span><span class="sxs-lookup"><span data-stu-id="7c362-146">Select **Enable this data source** if you want the data source to be active.</span></span> <span data-ttu-id="7c362-147">如果配置了数据源但该数据源未处于活动状态，则在用户尝试基于该数据源使用某一报表时，系统将会显示错误消息。</span><span class="sxs-lookup"><span data-stu-id="7c362-147">If the data source is configured but not active, users will see an error message when they attempt to use a report based on the data source.</span></span>  
  
8.  <span data-ttu-id="7c362-148">单击 **“测试连接”** 按钮可验证数据源配置。</span><span class="sxs-lookup"><span data-stu-id="7c362-148">Click the **Test Connection** button to validate the data source configuration.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7c362-149">对于 XML 数据源类型，不支持“测试连接”按钮。</span><span class="sxs-lookup"><span data-stu-id="7c362-149">The Test Connection button is not supported for the XML data source type.</span></span>  
  
9. <span data-ttu-id="7c362-150">单击 **“确定”** 保存共享的数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-150">Click **OK** to save create the shared data source.</span></span>  
  
### <a name="to-view-dependent-items"></a><span data-ttu-id="7c362-151">查看依赖项</span><span class="sxs-lookup"><span data-stu-id="7c362-151">To view dependent items</span></span>  
  
1.  <span data-ttu-id="7c362-152">打开包含 .rsds 文件的库。</span><span class="sxs-lookup"><span data-stu-id="7c362-152">Open the library that contains the .rsds file.</span></span>  
  
2.  <span data-ttu-id="7c362-153">指向共享数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-153">Point to the shared data source.</span></span>  
  
3.  <span data-ttu-id="7c362-154">单击以显示向下箭头，然后选择 **“查看依赖项”**。</span><span class="sxs-lookup"><span data-stu-id="7c362-154">Click to display a down arrow, and select **View Dependent Items**.</span></span>  
  
     <span data-ttu-id="7c362-155">对于报表模型，依赖项列表将显示在报表生成器中创建的报表。</span><span class="sxs-lookup"><span data-stu-id="7c362-155">For report models, the list of dependent items shows the reports that were created in Report Builder.</span></span> <span data-ttu-id="7c362-156">对于共享数据源，依赖项列表可以包括报表和报表模型。</span><span class="sxs-lookup"><span data-stu-id="7c362-156">For shared data sources, the dependent items list can include both reports and report models.</span></span>  
  
### <a name="to-delete-a-shared-data-source-rsds-file"></a><span data-ttu-id="7c362-157">删除共享数据源 (.rsds) 文件</span><span class="sxs-lookup"><span data-stu-id="7c362-157">To delete a shared data source (.rsds) file</span></span>  
  
1.  <span data-ttu-id="7c362-158">打开包含 .rsds 文件的库。</span><span class="sxs-lookup"><span data-stu-id="7c362-158">Open the library that contains the .rsds file.</span></span>  
  
2.  <span data-ttu-id="7c362-159">指向共享数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-159">Point to the shared data source.</span></span>  
  
3.  <span data-ttu-id="7c362-160">单击以显示向下箭头，然后单击 **“删除”**。</span><span class="sxs-lookup"><span data-stu-id="7c362-160">Click to display a down arrow, and click **Delete**.</span></span>  
  
 <span data-ttu-id="7c362-161">如果错删了要保留的共享数据源，则可以创建一个包含相同连接信息的新共享数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-161">If you mistakenly delete a shared data source that you meant to keep, you can create a new one that contains the same connection information.</span></span> <span data-ttu-id="7c362-162">重新创建共享数据源后，必须打开使用该数据源的每个报表和模型，并选择该共享数据源。</span><span class="sxs-lookup"><span data-stu-id="7c362-162">After you recreate the shared data source, you must open each report and model that used that data source and select the shared data source.</span></span> <span data-ttu-id="7c362-163">新的共享数据源项可以有不同于已删除数据源的名称、凭据或连接字符串语法。</span><span class="sxs-lookup"><span data-stu-id="7c362-163">The new shared data source item can have a different name, credentials, or connection string syntax from the one you delete.</span></span> <span data-ttu-id="7c362-164">在连接解析到相同数据源时，数据源属性可能与原始值不同。</span><span class="sxs-lookup"><span data-stu-id="7c362-164">As long as the connection resolves to the same data source, data source properties can vary from the original values.</span></span>  
  
 <span data-ttu-id="7c362-165">删除报表模型时要特别小心。</span><span class="sxs-lookup"><span data-stu-id="7c362-165">Use caution when deleting a report model.</span></span> <span data-ttu-id="7c362-166">如果删除模型，则将无法在报表生成器中打开和修改任何基于该模型的报表。</span><span class="sxs-lookup"><span data-stu-id="7c362-166">If you delete a model, you can no longer open and modify any reports that are based on that model in Report Builder.</span></span> <span data-ttu-id="7c362-167">如果由于疏忽删除了现有报表使用的模型，则必须重新生成该模型、重新创建和保存使用该模型的任何报表，并重新指定要使用的任何模型项安全性。</span><span class="sxs-lookup"><span data-stu-id="7c362-167">If you inadvertently delete a model that is used by existing reports, you must regenerate the model, re-create and save any reports that use the model, and re-specify any model item security that you want to use.</span></span> <span data-ttu-id="7c362-168">不能仅重新生成模型然后将其附加到现有报表。</span><span class="sxs-lookup"><span data-stu-id="7c362-168">You cannot simply regenerate the model and then attach it to an existing report.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c362-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="7c362-169">See Also</span></span>  
 [<span data-ttu-id="7c362-170">为报表数据源指定凭据和连接信息</span><span class="sxs-lookup"><span data-stu-id="7c362-170">Specify Credential and Connection Information for Report Data Sources</span></span>](report-data/specify-credential-and-connection-information-for-report-data-sources.md)  
  
  
