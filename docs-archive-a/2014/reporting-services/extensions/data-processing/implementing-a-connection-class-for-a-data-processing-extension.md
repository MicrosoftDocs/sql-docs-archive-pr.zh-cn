---
title: 为数据处理扩展插件实现 Connection 类 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- connections [Reporting Services], data processing extensions
- Connection class
- data processing extensions [Reporting Services], connections
ms.assetid: 7047d29e-a2c9-4e6f-ad02-635851a38ed7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 84caac40ec8df198d5c26ed89bf35fad71ad914f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87693632"
---
# <a name="implementing-a-connection-class-for-a-data-processing-extension"></a><span data-ttu-id="3317b-102">为数据处理扩展插件实现 Connection 类</span><span class="sxs-lookup"><span data-stu-id="3317b-102">Implementing a Connection Class for a Data Processing Extension</span></span>
  <span data-ttu-id="3317b-103">Connection  对象表示数据库连接或类似的资源，它是 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 数据处理扩展插件的用户的起点。</span><span class="sxs-lookup"><span data-stu-id="3317b-103">The **Connection** object represents a database connection or similar resource and is the starting point for users of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="3317b-104">它表示与数据库服务器的连接，尽管可以将任何具有类似行为的实体公开为 Connection  。</span><span class="sxs-lookup"><span data-stu-id="3317b-104">It represents connections to database servers, though any entity with similar behavior can be exposed as a **Connection**.</span></span>  
  
 <span data-ttu-id="3317b-105">若要实现 Connection 对象，请创建一个实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 并可选实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 的类。</span><span class="sxs-lookup"><span data-stu-id="3317b-105">To implement a **Connection** object, create a class that implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and optionally implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span>  
  
 <span data-ttu-id="3317b-106">在实现中，您必须确保先创建和打开一个连接，然后才能执行命令。</span><span class="sxs-lookup"><span data-stu-id="3317b-106">In your implementation, you must ensure that a connection is created and opened before commands can be executed.</span></span> <span data-ttu-id="3317b-107">确保您的实现要求客户端显式打开和关闭连接，而不是让实现为客户端隐式打开和关闭连接。</span><span class="sxs-lookup"><span data-stu-id="3317b-107">Ensure that your implementation requires clients to open and close connections explicitly, rather than having your implementation open and close connections implicitly for the client.</span></span> <span data-ttu-id="3317b-108">在获取连接时，将执行安全检查。</span><span class="sxs-lookup"><span data-stu-id="3317b-108">Perform your security checks when the connection is obtained.</span></span> <span data-ttu-id="3317b-109">如果在 [!INCLUDE[ssRS](../../../includes/ssrs.md)] 数据处理扩展插件中要求将某个现有连接用于其他类，则可以确保在使用数据源时始终执行安全检查。</span><span class="sxs-lookup"><span data-stu-id="3317b-109">Requiring an existing connection for the other classes in your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension will then ensure that security checks are always performed when working with your data source.</span></span>  
  
 <span data-ttu-id="3317b-110">所需连接的属性表示为一个连接字符串。</span><span class="sxs-lookup"><span data-stu-id="3317b-110">The properties of the desired connection are represented as a connection string.</span></span> <span data-ttu-id="3317b-111">强烈建议 [!INCLUDE[ssRS](../../../includes/ssrs.md)] 数据处理扩展插件使用由 OLE DB 定义的所熟悉的名称/值对系统支持 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="3317b-111">It is strongly recommended that [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions support the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> property using the familiar name/value pair system defined by OLE DB.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3317b-112">获取 Connection 对象通常需要消耗大量的资源，因此，可能需要考虑通过池连接或其他方法来减轻资源的占用  。</span><span class="sxs-lookup"><span data-stu-id="3317b-112">**Connection** objects are often resource-intensive to obtain, so you may want to consider pooling connections or other techniques to mitigate this.</span></span>  
  
 <span data-ttu-id="3317b-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 从 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 继承。</span><span class="sxs-lookup"><span data-stu-id="3317b-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> inherits from <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="3317b-114">您必须将 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 接口作为连接类实现的一部分而实现。</span><span class="sxs-lookup"><span data-stu-id="3317b-114">You must implement the <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface as part of your connection class implementation.</span></span> <span data-ttu-id="3317b-115">借助于 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 接口，类可以实现本地化的扩展插件名称并处理存储在 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 配置文件中的扩展插件特定的配置信息。</span><span class="sxs-lookup"><span data-stu-id="3317b-115">The <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface enables a class to implement a localized extension name and to process extension-specific configuration information stored in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] configuration file.</span></span>  
  
 <span data-ttu-id="3317b-116">Connection 对象通过其 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 的实现包含 <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="3317b-116">Your **Connection** object contains the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property through its implementation of <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="3317b-117">强烈建议 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 数据处理扩展插件支持 <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> 属性，以便用户在用户界面（如报表管理器）中对于该扩展插件看到熟悉的本地化名称。</span><span class="sxs-lookup"><span data-stu-id="3317b-117">It is strongly recommended that [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extensions support the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property, so that users encounter a familiar, localized name for the extension in a user interface, such as Report Manager.</span></span>  
  
 <span data-ttu-id="3317b-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> 还使 Connection 对象能够检索和处理存储在 RSReportServer.config 文件中的自定义配置数据  。</span><span class="sxs-lookup"><span data-stu-id="3317b-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> also enables your **Connection** object to retrieve and process custom configuration data stored in the RSReportServer.config file.</span></span> <span data-ttu-id="3317b-119">有关处理自定义配置数据的详细信息，请参阅 <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3317b-119">For more information about processing custom configuration data, see the <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> method.</span></span>  
  
 <span data-ttu-id="3317b-120">对于实现 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 的类，当卸载其他数据处理扩展插件类时，不会从内存中卸载该类。</span><span class="sxs-lookup"><span data-stu-id="3317b-120">The class that implements <xref:Microsoft.ReportingServices.Interfaces.IExtension> is not unloaded from memory when the rest of your data processing extension classes are unloaded.</span></span> <span data-ttu-id="3317b-121">因此，可以使用 Extension 类存储跨连接状态信息或存储内存中可能缓存的数据  。</span><span class="sxs-lookup"><span data-stu-id="3317b-121">Because of this, you can use your **Extension** class to store cross-connection state information or to store data that can be cached in memory.</span></span> <span data-ttu-id="3317b-122">只要报表服务器正在运行，Extension 类就保持在内存中  。</span><span class="sxs-lookup"><span data-stu-id="3317b-122">Your **Extension** class remains in memory as long as the report server is running.</span></span>  
  
 <span data-ttu-id="3317b-123">可以通过实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 来扩展 Connection 类，以便在 [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] 中包含对于凭据的支持。</span><span class="sxs-lookup"><span data-stu-id="3317b-123">You can extend your **Connection** class to include support for credentials in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] by implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span> <span data-ttu-id="3317b-124">当实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 接口的 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>、<xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A> 和 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> 属性时，就在报表设计器的“数据源”对话框中启用了“集成安全性”复选框以及“用户名”和“密码”文本框。</span><span class="sxs-lookup"><span data-stu-id="3317b-124">When you implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>, and <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> properties of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> interface, you enable the **Integrated Security** check box and **Username** and **Password** text boxes of the **Data Source** dialog in Report Designer.</span></span> <span data-ttu-id="3317b-125">这使报表设计器能够针对支持身份验证的数据源存储和检索凭据。</span><span class="sxs-lookup"><span data-stu-id="3317b-125">This enables Report Designer to store and retrieve credentials for data sources that support authentication.</span></span> <span data-ttu-id="3317b-126">将以安全的方式存储凭据，当以预览模式呈现报表时将使用这些凭据。</span><span class="sxs-lookup"><span data-stu-id="3317b-126">The credentials are stored securely and used when rendering reports in preview mode.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3317b-127">隐式实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> 要求您实现 <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> 和 <xref:Microsoft.ReportingServices.Interfaces.IExtension> 接口的成员。</span><span class="sxs-lookup"><span data-stu-id="3317b-127">Implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implicitly requires you to implement the members of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and <xref:Microsoft.ReportingServices.Interfaces.IExtension> interfaces.</span></span>  
>   
>  <span data-ttu-id="3317b-128">有关示例 Connection 类实现，请参阅 [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889)（SQL Server Reporting Services 产品示例）。</span><span class="sxs-lookup"><span data-stu-id="3317b-128">For a sample **Connection** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3317b-129">另请参阅</span><span class="sxs-lookup"><span data-stu-id="3317b-129">See Also</span></span>  
 <span data-ttu-id="3317b-130">[Reporting Services 扩展插件](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="3317b-130">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="3317b-131">[实现数据处理扩展插件](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="3317b-131">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="3317b-132">Reporting Services 扩展插件库</span><span class="sxs-lookup"><span data-stu-id="3317b-132">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
