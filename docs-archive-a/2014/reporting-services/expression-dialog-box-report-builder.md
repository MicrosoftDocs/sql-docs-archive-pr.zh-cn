---
title: "\"表达式\" 对话框 (报表生成器) |Microsoft Docs"
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10040"
helpviewer_keywords:
- expressions
ms.assetid: e89c4d97-5d41-4b55-8695-79329edac15d
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: b608d59841722af4d9578dad445cbabbca9aa150
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/04/2020
ms.locfileid: "87580056"
---
# <a name="expression-dialog-box-report-builder"></a><span data-ttu-id="4d341-102">“表达式”对话框（报表生成器）</span><span class="sxs-lookup"><span data-stu-id="4d341-102">Expression Dialog Box (Report Builder)</span></span>
  <span data-ttu-id="4d341-103">使用 "**表达式**" 对话框可以编写 [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 报表项属性的表达式。</span><span class="sxs-lookup"><span data-stu-id="4d341-103">Use the **Expression** dialog box to write [!INCLUDE[msCoName](../includes/msconame-md.md)] [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] expressions for report item properties.</span></span> <span data-ttu-id="4d341-104">您可以使用表达式来设置多个属性，包括颜色、字体和边框。</span><span class="sxs-lookup"><span data-stu-id="4d341-104">You can use expressions to set many properties, including color, font, and borders.</span></span> <span data-ttu-id="4d341-105">在运行时，报表处理器对表达式进行计算，然后用结果替代属性的值。</span><span class="sxs-lookup"><span data-stu-id="4d341-105">At run time, the report processor evaluates expressions and substitutes the result for the value of the property.</span></span>  
  
 <span data-ttu-id="4d341-106">**“表达式”** 对话框包含代码窗口、类别树、类别项、说明窗格和示例窗格。</span><span class="sxs-lookup"><span data-stu-id="4d341-106">The **Expression** dialog box includes a code window, category tree, category items, description pane, and example pane.</span></span> <span data-ttu-id="4d341-107">"**表达式**" 对话框是上下文相关的;类别项和说明会更改，以响应您正在使用的表达式类别。</span><span class="sxs-lookup"><span data-stu-id="4d341-107">The **Expression** dialog box is context-sensitive; the category items and descriptions change in response to the expression category you are working with.</span></span> <span data-ttu-id="4d341-108">有关详细信息，请参阅[表达式示例 &#40;报表生成器和 ssrs&#41;](report-design/expression-examples-report-builder-and-ssrs.md)，[表达式 &#40;报表生成器和 ssrs&#41;](report-design/expressions-report-builder-and-ssrs.md)</span><span class="sxs-lookup"><span data-stu-id="4d341-108">For more information, see [Expression Examples &#40;Report Builder and SSRS&#41;](report-design/expression-examples-report-builder-and-ssrs.md), [Expressions &#40;Report Builder and SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md)</span></span>  
  
## <a name="expression-constructs"></a><span data-ttu-id="4d341-109">表达式构造</span><span class="sxs-lookup"><span data-stu-id="4d341-109">Expression Constructs</span></span>  
 <span data-ttu-id="4d341-110">表达式以等号 (=) 开头，可以包含常量、文字、运算符以及对内置字段、内置集合、内置函数、 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 运行库函数、 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] 公共语言运行时类和自定义函数的引用。</span><span class="sxs-lookup"><span data-stu-id="4d341-110">Expressions begin with an equal sign (=) and can include constants, literals, operators, and references to built-in fields, built-in collections, built-in functions, [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] run-time library functions, [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] common language runtime classes, and custom functions.</span></span> <span data-ttu-id="4d341-111">以下列表介绍了可添加到表达式中的类别和值。</span><span class="sxs-lookup"><span data-stu-id="4d341-111">The following list describes the categories and values you can add to an expression.</span></span>  
  
 <span data-ttu-id="4d341-112">**设置表达式：**  _\<PropertyName>_</span><span class="sxs-lookup"><span data-stu-id="4d341-112">**Set expression for:**  _\<PropertyName>_</span></span>  
 <span data-ttu-id="4d341-113">要为其定义表达式的属性的名称。</span><span class="sxs-lookup"><span data-stu-id="4d341-113">The name of the property that you are defining an expression for.</span></span> <span data-ttu-id="4d341-114">此外，还可以在“属性”窗格中按名称设置此属性。</span><span class="sxs-lookup"><span data-stu-id="4d341-114">You can also set this property, by name, in the Properties pane.</span></span>  
  
 <span data-ttu-id="4d341-115">**常量**</span><span class="sxs-lookup"><span data-stu-id="4d341-115">**Constants**</span></span>  
 <span data-ttu-id="4d341-116">为基于常量的属性提供了对该属性有效的预定义值列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-116">Provides a list of predefined values valid for this property for properties that are based on constants.</span></span> <span data-ttu-id="4d341-117">例如，基于颜色的属性会显示有效的颜色名称。</span><span class="sxs-lookup"><span data-stu-id="4d341-117">For example, a property based on color shows valid color names.</span></span> <span data-ttu-id="4d341-118">对于一个数据类型是布尔型的属性来说，值为 `True` 和 `False`。</span><span class="sxs-lookup"><span data-stu-id="4d341-118">For a property that is a Boolean data type, values are `True` and `False`.</span></span>  
  
 <span data-ttu-id="4d341-119">并不是所有支持表达式的项都可设置为常量。</span><span class="sxs-lookup"><span data-stu-id="4d341-119">Not all items that support expressions can be set to a constant.</span></span> <span data-ttu-id="4d341-120">如果某属性不能设置为常量值，说明窗格将会提供此信息。</span><span class="sxs-lookup"><span data-stu-id="4d341-120">If a property cannot be set to constant value, the description pane provides this information.</span></span>  
  
 <span data-ttu-id="4d341-121">**内置字段**</span><span class="sxs-lookup"><span data-stu-id="4d341-121">**Built-in Fields**</span></span>  
 <span data-ttu-id="4d341-122">提供的列表包含可以在表达式中使用的全局集合中的项。</span><span class="sxs-lookup"><span data-stu-id="4d341-122">Provides a list of the items in the global collection that you can use in an expression.</span></span> <span data-ttu-id="4d341-123">某些集合只有在报表发布到服务器后才受支持。</span><span class="sxs-lookup"><span data-stu-id="4d341-123">Some collections are only supported after the report is published to the server.</span></span> <span data-ttu-id="4d341-124">有关详细信息，请参阅[表达式中的内置集合（报表生成器和 SSRS）](report-design/built-in-collections-in-expressions-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="4d341-124">For more information, see [Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-in-expressions-report-builder.md).</span></span>  
  
 <span data-ttu-id="4d341-125">**参数**</span><span class="sxs-lookup"><span data-stu-id="4d341-125">**Parameters**</span></span>  
 <span data-ttu-id="4d341-126">提供报表参数的列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-126">Provides a list of report parameters.</span></span>  
  
 <span data-ttu-id="4d341-127">**字段 (** _\<selected Dataset>_\*\*) \*\*</span><span class="sxs-lookup"><span data-stu-id="4d341-127">**Fields(** _\<selected Dataset>_ **)**</span></span>  
 <span data-ttu-id="4d341-128">显示在数据集类别中选择的数据集的字段列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-128">Displays the list of fields for the dataset selected in the Datasets category.</span></span> <span data-ttu-id="4d341-129">双击某字段可将该字段复制到“表达式”\*\*\*\* 框。</span><span class="sxs-lookup"><span data-stu-id="4d341-129">Double-click a field to copy the field to the **Expression** box.</span></span>  
  
 <span data-ttu-id="4d341-130">**数据集**</span><span class="sxs-lookup"><span data-stu-id="4d341-130">**Datasets**</span></span>  
 <span data-ttu-id="4d341-131">提供可用数据集的列表并显示数据集的成员字段。</span><span class="sxs-lookup"><span data-stu-id="4d341-131">Provides a list of available datasets and shows the fields that are members of the dataset.</span></span>  
  
 <span data-ttu-id="4d341-132">**变量**</span><span class="sxs-lookup"><span data-stu-id="4d341-132">**Variables**</span></span>  
 <span data-ttu-id="4d341-133">显示报表变量的列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-133">Displays a list of report variables.</span></span> <span data-ttu-id="4d341-134">有关详细信息，请参阅[报表和组变量集合引用（报表生成器和 SSRS）](report-design/built-in-collections-report-and-group-variables-references-report-builder.md)。</span><span class="sxs-lookup"><span data-stu-id="4d341-134">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="4d341-135">**运算符**</span><span class="sxs-lookup"><span data-stu-id="4d341-135">**Operators**</span></span>  
 <span data-ttu-id="4d341-136">显示可包含在计算或字符串操作中的运算符。</span><span class="sxs-lookup"><span data-stu-id="4d341-136">Displays the operators you can include in a calculation or string manipulation.</span></span> <span data-ttu-id="4d341-137">有关详细信息，请参阅[表达式中的运算符（报表生成器和 SSRS）](report-design/operators-in-expressions-report-builder-and-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4d341-137">For more information, see [Operators in Expressions &#40;Report Builder and SSRS&#41;](report-design/operators-in-expressions-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="4d341-138">**常见函数**</span><span class="sxs-lookup"><span data-stu-id="4d341-138">**Common Functions**</span></span>  
 <span data-ttu-id="4d341-139">显示按类型分组后的常见函数。</span><span class="sxs-lookup"><span data-stu-id="4d341-139">Displays common functions, grouped by type.</span></span> <span data-ttu-id="4d341-140">当您在“项”窗格中选择函数时，相应的说明和示例会显示出来。</span><span class="sxs-lookup"><span data-stu-id="4d341-140">When you select a function in the Item pane, a description and example appear.</span></span>  
  
 <span data-ttu-id="4d341-141">常见函数包括内置报表和聚合函数、 [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] 运行时库函数以及 [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] <xref:System.Math> 和命名空间中 (CLR) 的公共语言运行时类 <xref:System.Convert> 。</span><span class="sxs-lookup"><span data-stu-id="4d341-141">Common functions include built-in report and aggregate functions, [!INCLUDE[vbprvb](../includes/vbprvb-md.md)] run-time library functions, and [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] common language runtime classes (CLR) in the <xref:System.Math> and <xref:System.Convert> namespace.</span></span> <span data-ttu-id="4d341-142">你还可以添加对没有显示在类别列表中的 CLR 类和外部程序集的引用。</span><span class="sxs-lookup"><span data-stu-id="4d341-142">You can also add references to CLR classes and external assemblies that do not appear in the category list.</span></span> <span data-ttu-id="4d341-143">有关详细信息，请参阅 [报表设计器的表达式中的自定义代码和程序集引用 (SSRS)](report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md)。</span><span class="sxs-lookup"><span data-stu-id="4d341-143">For more information, see [Custom Code and Assembly References in Expressions in Report Designer &#40;SSRS&#41;](report-design/custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs.md).</span></span>  
  
## <a name="options"></a><span data-ttu-id="4d341-144">选项</span><span class="sxs-lookup"><span data-stu-id="4d341-144">Options</span></span>  
 <span data-ttu-id="4d341-145">代码窗口</span><span class="sxs-lookup"><span data-stu-id="4d341-145">Code window</span></span>  
 <span data-ttu-id="4d341-146">使用顶部窗格中的代码窗口可以键入表达式。</span><span class="sxs-lookup"><span data-stu-id="4d341-146">Use the code window in the top pane to type an expression.</span></span> <span data-ttu-id="4d341-147">在打开 **“表达式”** 对话框时，代码窗口将包含该表达式。</span><span class="sxs-lookup"><span data-stu-id="4d341-147">When you open the **Expression** dialog box, the code window contains the expression.</span></span> <span data-ttu-id="4d341-148">您可替换或修改该表达式。</span><span class="sxs-lookup"><span data-stu-id="4d341-148">You can replace or revise the expression.</span></span> <span data-ttu-id="4d341-149">您可以添加函数调用、运算符、常量、字段、参数、全局集合中的项以及对自定义代码的引用。</span><span class="sxs-lookup"><span data-stu-id="4d341-149">You can add function calls, operators, constants, fields, parameters, items from the global collections, and references to custom code.</span></span> <span data-ttu-id="4d341-150">在您进行更改时，代码窗口会显示您所做的更改。</span><span class="sxs-lookup"><span data-stu-id="4d341-150">The code window displays your changes as you make them.</span></span>  
  
 <span data-ttu-id="4d341-151">红色波浪下划线指示语法错误。</span><span class="sxs-lookup"><span data-stu-id="4d341-151">A wavy red underline indicates a syntax error.</span></span> <span data-ttu-id="4d341-152">将光标悬停在带有下划线的文本上查看错误消息。</span><span class="sxs-lookup"><span data-stu-id="4d341-152">Hover over the underlined text to see the error message.</span></span>  
  
 <span data-ttu-id="4d341-153">当键入跟有标点分隔符的全局集合字词时，您将看到可用成员或属性的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-153">When you type in global collection terms followed by a punctuation separator, you will see a drop-down list of available members or properties.</span></span> <span data-ttu-id="4d341-154">在下拉列表中，可以键入前几个字符以及制表符来自动填充选项。</span><span class="sxs-lookup"><span data-stu-id="4d341-154">From the drop-down list, you can type the first few characters followed by a tab to automatically fill the selection.</span></span>  
  
 <span data-ttu-id="4d341-155">当键入跟有左括号的函数名时，您将看到一个提供关于参数和函数返回值信息的工具提示。</span><span class="sxs-lookup"><span data-stu-id="4d341-155">When you type in a function name followed by a left parenthesis, you will see a tooltip that provides information about the parameters and function return values.</span></span>  
  
 <span data-ttu-id="4d341-156">**类别**</span><span class="sxs-lookup"><span data-stu-id="4d341-156">**Category**</span></span>  
 <span data-ttu-id="4d341-157">显示表达式的不同类别。</span><span class="sxs-lookup"><span data-stu-id="4d341-157">Displays categories of expressions.</span></span> <span data-ttu-id="4d341-158">选择一个类别将建立用于创建表达式的上下文，并更改“项”窗格中的有效值列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-158">Choosing a category establishes a context for creating an expression and changes the list of valid values in the Item pane.</span></span> <span data-ttu-id="4d341-159">例如，对于文本框值的表达式，展开 "常见函数" 并选择 "聚合函数 `Avg` `Count` " 可以在 "**项**" 窗格中显示、和其他函数。</span><span class="sxs-lookup"><span data-stu-id="4d341-159">For example, for an expression for a text box value, expand Common functions and select Aggregate functions to display `Avg`, `Count`, and other functions in the **Item** pane.</span></span>  
  
 <span data-ttu-id="4d341-160">**项目**</span><span class="sxs-lookup"><span data-stu-id="4d341-160">**Item**</span></span>  
 <span data-ttu-id="4d341-161">显示所选类别的有效值列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-161">Displays the list of valid values for the selected category.</span></span> <span data-ttu-id="4d341-162">双击一个项可以将此项的表达式文本添加到代码窗口中的插入点处。</span><span class="sxs-lookup"><span data-stu-id="4d341-162">Double-click on an item to add the expression text for this item at the insertion point in the code window.</span></span>  
  
 <span data-ttu-id="4d341-163">**值**</span><span class="sxs-lookup"><span data-stu-id="4d341-163">**Values**</span></span>  
 <span data-ttu-id="4d341-164">根据所选的类别和项，第三个窗格将包含说明、示例表达式或有效值列表。</span><span class="sxs-lookup"><span data-stu-id="4d341-164">Depending on the category and item you select, the third pane contains a description, a sample expression, or a list of valid values.</span></span> <span data-ttu-id="4d341-165">拖动该对话框的边缘可以加宽示例区域。</span><span class="sxs-lookup"><span data-stu-id="4d341-165">Drag the edge of the dialog box to widen the sample area.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4d341-166">另请参阅</span><span class="sxs-lookup"><span data-stu-id="4d341-166">See Also</span></span>  
 <span data-ttu-id="4d341-167">[表达式（报表生成器和 SSRS）](report-design/expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-167">[Expressions &#40;Report Builder and SSRS&#41;](report-design/expressions-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4d341-168">[&#40;报表生成器和 SSRS 的格式设置报表项&#41;](report-design/formatting-report-items-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-168">[Formatting Report Items &#40;Report Builder and SSRS&#41;](report-design/formatting-report-items-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4d341-169">[设置数字和日期格式 &#40;报表生成器和 SSRS&#41;](report-design/formatting-numbers-and-dates-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-169">[Formatting Numbers and Dates &#40;Report Builder and SSRS&#41;](report-design/formatting-numbers-and-dates-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4d341-170">[参数集合引用 &#40;报表生成器和 SSRS&#41;](report-design/built-in-collections-parameters-collection-references-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-170">[Parameters Collection References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-parameters-collection-references-report-builder.md) </span></span>  
 <span data-ttu-id="4d341-171">[组表达式示例 &#40;报表生成器和 SSRS&#41;](report-design/group-expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-171">[Group Expression Examples &#40;Report Builder and SSRS&#41;](report-design/group-expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4d341-172">[筛选器公式示例 &#40;报表生成器和 SSRS&#41;](report-design/filter-equation-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-172">[Filter Equation Examples &#40;Report Builder and SSRS&#41;](report-design/filter-equation-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="4d341-173">[数据集字段集合引用 &#40;报表生成器和 SSRS&#41;](report-design/built-in-collections-dataset-fields-collection-references-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-173">[Dataset Fields Collection References &#40;Report Builder and SSRS&#41;](report-design/built-in-collections-dataset-fields-collection-references-report-builder.md) </span></span>  
 <span data-ttu-id="4d341-174">[聚合函数引用（报表生成器和 SSRS）](report-design/report-builder-functions-aggregate-functions-reference.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-174">[Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-design/report-builder-functions-aggregate-functions-reference.md) </span></span>  
 <span data-ttu-id="4d341-175">[表达式中的数据类型 &#40;报表生成器和 SSRS&#41;](report-design/data-types-in-expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="4d341-175">[Data Types in Expressions &#40;Report Builder and SSRS&#41;](report-design/data-types-in-expressions-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="4d341-176">"选择颜色" 对话框 &#40;报表生成器和 SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="4d341-176">Select Color Dialog Box &#40;Report Builder and SSRS&#41;</span></span>](../../2014/reporting-services/select-color-dialog-box-report-builder-and-ssrs.md)  
  
  
